GEODE-2012: always write stat types to archive

* refactor classes to make testing easier
* write additional tests for stat archive rolling
* expose bug GEODE-2012 in StatTypesAreRolledOverRegressionTest
* fix bug exposed by StatTypesAreRolledOverRegressionTest

-  static final String ENABLE_MONITOR_THREAD =
+  protected static final String ENABLE_MONITOR_THREAD =
-  static final boolean enableMonitorThread = Boolean.getBoolean(ENABLE_MONITOR_THREAD);
+
+  private final boolean enableMonitorThread;
-  public StatMonitorHandler() {}
+  public StatMonitorHandler() {
+    this.enableMonitorThread = Boolean.getBoolean(ENABLE_MONITOR_THREAD);
+  }
-      if (enableMonitorThread && !this.monitors.isEmpty() && this.notifier == null) {
-        this.notifier = new StatMonitorNotifier();
-        this.notifier.start();
+      if (!this.monitors.isEmpty()) {
+        startNotifier_IfEnabledAndNotRunning();
-      if (enableMonitorThread && this.monitors.isEmpty() && this.notifier != null) {
-        this.notifier.stop();
-        this.notifier = null;
+      if (this.monitors.isEmpty()) {
+        stopNotifier_IfEnabledAndRunning();
-      if (enableMonitorThread && this.notifier != null) {
-        this.notifier.stop();
-      }
+      stopNotifier_IfEnabledAndRunning();
-      if (enableMonitorThread) {
+      if (this.enableMonitorThread) {
+  private void startNotifier_IfEnabledAndNotRunning() {
+    if (this.enableMonitorThread && this.notifier == null) {
+      this.notifier = new StatMonitorNotifier();
+      this.notifier.start();
+    }
+  }
+
+  private void stopNotifier_IfEnabledAndRunning() {
+    if (this.enableMonitorThread && this.notifier != null) {
+      this.notifier.stop();
+      this.notifier = null;
+    }
+  }
+

INS31 INS31 INS83 UPD83 INS83 INS39 INS42 INS8 INS83 INS39 INS42 INS8 INS21 MOV25 MOV25 INS7 INS8 INS22 MOV32 INS25 INS25 MOV21 INS22 INS22 MOV27 INS52 INS42 MOV38 INS8 MOV32 INS8 INS22 INS52 INS42 INS52 INS42 INS21 INS21 INS42 INS52 INS42 MOV52 MOV42 INS32 INS32 INS42 INS42 DEL52 DEL42 DEL22 DEL42 DEL42 DEL27 DEL8 DEL25 DEL8 DEL42 DEL42 DEL42