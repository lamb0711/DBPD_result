GEODE-2012: always write stat types to archive

* refactor classes to make testing easier
* write additional tests for stat archive rolling
* expose bug GEODE-2012 in StatTypesAreRolledOverRegressionTest
* fix bug exposed by StatTypesAreRolledOverRegressionTest

+import edu.umd.cs.findbugs.annotations.SuppressWarnings;
+
+import org.apache.geode.internal.io.RollingFileHandler;
+   * @param rollingFileHandler provides file rolling behavior
-  @edu.umd.cs.findbugs.annotations.SuppressWarnings(
-      value = "ST_WRITE_TO_STATIC_FROM_INSTANCE_METHOD",
+  @SuppressWarnings(value = "ST_WRITE_TO_STATIC_FROM_INSTANCE_METHOD",
-  public void initialize(StatArchiveHandlerConfig config, long nanosTimeStamp) {
+  public void initialize(final StatArchiveHandlerConfig config, final long nanosTimeStamp,
+      final RollingFileHandler rollingFileHandler) {
-        StatArchiveHandler newStatArchiveHandler = new StatArchiveHandler(config, this);
+        StatArchiveHandler newStatArchiveHandler =
+            new StatArchiveHandler(config, this, rollingFileHandler);
-    notifyNewHandlersOfResources(handlers, this.resourceInstMap.values());
+    notifyNewHandlersOfResources(handlers, this.resourceTypeMap.values(),
+        this.resourceInstMap.values());
-      Collection<ResourceInstance> resources) {
+      Collection<ResourceType> types, Collection<ResourceInstance> resources) {
+        for (ResourceType resourceType : types) {
+          if (!allocatedResourceTypes.contains(resourceType)) {
+            handler.allocatedResourceType(resourceType);
+          }
+        }

INS26 INS26 INS40 INS40 INS44 INS44 INS65 INS42 INS83 INS83 INS83 INS43 INS42 INS74 INS42 INS42 INS66 INS42 INS43 INS43 INS32 INS42 INS42 INS22 INS42 INS52 INS42 INS70 MOV43 INS44 INS42 INS8 INS43 INS42 INS25 MOV43 INS42 INS42 INS38 INS8 INS32 INS21 INS42 INS42 INS42 INS32 INS42 INS42 INS42 DEL40