GEODE-7004: Optimized ResourcePermission constructor (#3839)


Co-authored-by: Kamilla Aslami <kaslami@pivotal.io>
Co-authored-by: Jacob Barrett <jbarrett@pivotal.io>

+import java.util.Collections;
+import org.apache.shiro.util.CollectionUtils;
-    setParts(this.resource + ":" + this.operation + ":" + this.target + ":" + this.key, true);
+    setParts(Arrays.asList(
+        Collections.singleton(this.resource),
+        Collections.singleton(this.operation),
+        Collections.singleton(this.target),
+        Collections.singleton(this.key)));
-    this(resource == null ? null : resource.getName(),
-        operation == null ? null : operation.getName(), target == null ? null : target.getName(),
+    init(resource == null ? NULL : resource.getName(),
+        operation == null ? NULL : operation.getName(), target == null ? null : target.getName(),
-    this(resource == null ? null : resource.getName(),
-        operation == null ? null : operation.getName(), target, key);
+    init(resource == null ? NULL : resource.getName(),
+        operation == null ? NULL : operation.getName(), parseTarget(target), key);
+  }
+
+  private String parseTarget(String target) {
+    return target == null ? null : StringUtils.stripStart(target, Region.SEPARATOR);
-    this.resource = parsePart(resource, r -> Resource.valueOf(r).getName());
-    this.operation = parsePart(operation, o -> Operation.valueOf(o).getName());
+    init(parsePart(resource, r -> Resource.valueOf(r).getName()),
+        parsePart(operation, o -> Operation.valueOf(o).getName()), parseTarget(target), key);
+  }
+
+  private void init(String resource, String operation, String target, String key) {
+    this.resource = resource;
+    this.operation = operation;
-      this.target = StringUtils.stripStart(target, Region.SEPARATOR);
+      this.target = target;
+
-    setParts(this.resource + ":" + this.operation + ":" + this.target + ":" + this.key, true);
+    setParts(Arrays.asList(
+        Collections.singleton(this.resource),
+        Collections.singleton(this.operation),
+        CollectionUtils.asSet(this.target.split(SUBPART_DIVIDER_TOKEN)),
+        CollectionUtils.asSet(this.key.split(SUBPART_DIVIDER_TOKEN))));

INS26 INS26 INS40 INS40 INS31 INS31 INS83 INS43 INS42 INS44 INS8 INS83 INS42 MOV44 MOV44 MOV44 MOV44 INS8 UPD83 INS39 INS42 INS44 INS44 INS44 INS44 INS21 INS21 INS42 INS43 INS42 INS41 MOV21 INS43 INS42 INS43 INS42 INS43 INS42 INS43 INS42 INS21 INS21 INS21 INS32 INS32 INS32 INS42 INS16 INS32 INS42 INS42 INS42 INS42 INS7 INS7 INS32 INS42 MOV32 INS42 MOV16 MOV16 MOV16 INS42 INS42 MOV16 MOV16 INS32 INS42 INS27 INS33 MOV32 INS42 MOV32 MOV32 INS32 INS42 MOV22 INS42 MOV22 INS42 INS42 INS32 UPD42 INS42 INS32 INS32 INS32 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS33 INS42 INS42 INS42 INS42 INS32 INS32 MOV32 INS32 INS42 INS42 MOV22 INS42 INS42 MOV22 INS42 INS42 MOV22 INS42 INS42 MOV22 INS42 INS42 INS42 MOV22 INS42 INS42 MOV22 UPD42 UPD42 INS32 UPD42 MOV42 INS42 INS32 INS32 INS42 MOV22 UPD42 MOV42 INS42 MOV22 UPD42 MOV42 INS42 INS42 INS42 INS42 DEL45 DEL45 DEL45 DEL27 DEL9 DEL33 DEL33 DEL42 DEL17 DEL33 DEL33 DEL42 DEL42 DEL17 DEL7 DEL42 DEL7 DEL21 DEL45 DEL45 DEL45 DEL27 DEL9 DEL32 DEL21