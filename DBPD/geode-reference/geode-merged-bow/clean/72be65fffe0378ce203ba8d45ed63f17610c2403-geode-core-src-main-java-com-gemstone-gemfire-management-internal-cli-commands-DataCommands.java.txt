Merge branch 'feature/GEODE-17-2' into develop

+import static com.gemstone.gemfire.cache.operations.OperationContext.*;
+
-import java.util.concurrent.CancellationException;
-import org.springframework.shell.core.CommandMarker;
-import org.springframework.shell.core.annotation.CliAvailabilityIndicator;
-import org.springframework.shell.core.annotation.CliCommand;
-import org.springframework.shell.core.annotation.CliOption;
-
-import com.gemstone.gemfire.management.internal.security.Resource;
-import com.gemstone.gemfire.management.internal.security.ResourceConstants;
-import com.gemstone.gemfire.management.internal.security.ResourceOperationContext.ResourceOperationCode;
+import com.gemstone.gemfire.internal.security.GeodeSecurityUtil;
+
+import org.springframework.shell.core.CommandMarker;
+import org.springframework.shell.core.annotation.CliAvailabilityIndicator;
+import org.springframework.shell.core.annotation.CliCommand;
+import org.springframework.shell.core.annotation.CliOption;
-  @ResourceOperation(resource = Resource.DISTRIBUTED_SYSTEM, operation= ResourceConstants.REBALANCE)
+  @ResourceOperation(resource = Resource.DATA, operation = OperationCode.MANAGE)
+
-  @ResourceOperation(resource = Resource.REGION, operation= ResourceConstants.EXPORT_DATA)
+    GeodeSecurityUtil.authorizeRegionRead(regionName);
-  @ResourceOperation(resource = Resource.REGION, operation= ResourceConstants.IMPORT_DATA)
+    GeodeSecurityUtil.authorizeRegionWrite(regionName);
+
-  @ResourceOperation(resource = Resource.REGION, operation= ResourceConstants.PUT)
+    GeodeSecurityUtil.authorizeRegionWrite(regionPath);
+    GeodeSecurityUtil.authorizeRegionRead(regionPath);
-  @ResourceOperation(resource = Resource.REGION, operation= ResourceConstants.LOCATE_ENTRY)
+    GeodeSecurityUtil.authorizeRegionRead(regionPath);
+  @ResourceOperation(resource=Resource.DATA, operation = OperationCode.MANAGE)
-
-  @ResourceOperation(resource = Resource.DISTRIBUTED_SYSTEM, operation= ResourceConstants.QUERYDATA_DS)
+  @ResourceOperation(resource = Resource.DATA, operation = OperationCode.READ)
-      @CliOption(key = CliStrings.QUERY__STEPNAME, mandatory = false, help = "Stpe name", unspecifiedDefaultValue = CliStrings.QUERY__STEPNAME__DEFAULTVALUE) String stepName,
+      @CliOption(key = CliStrings.QUERY__STEPNAME, mandatory = false, help = "Step name", unspecifiedDefaultValue = CliStrings.QUERY__STEPNAME__DEFAULTVALUE) String stepName,

MOV26 MOV26 MOV26 MOV26 MOV26 MOV26 UPD40 UPD40 INS77 INS21 INS21 INS21 INS21 INS21 INS42 INS80 INS80 UPD40 UPD40 INS32 INS32 INS32 INS32 INS32 INS42 INS40 INS42 INS40 UPD40 UPD40 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 UPD45 DEL40 DEL26 DEL40 DEL26 DEL42 DEL42 DEL40 DEL80 DEL42 DEL40 DEL80 DEL77 DEL42 DEL42 DEL40 DEL80 DEL42 DEL40 DEL80 DEL77 DEL42 DEL42 DEL40 DEL80 DEL42 DEL40 DEL80 DEL77 DEL42 DEL42 DEL40 DEL80 DEL42 DEL40 DEL80 DEL77