Merge branch 'release/1.5.0'

-import org.apache.geode.distributed.internal.DM;
+import org.apache.geode.distributed.internal.ClusterDistributionManager;
-  private TXStateProxy prepForTransaction(DistributionManager dm) throws InterruptedException {
+  private TXStateProxy prepForTransaction(ClusterDistributionManager dm)
+      throws InterruptedException {
-  protected void process(final DistributionManager dm) {
+  protected void process(final ClusterDistributionManager dm) {
-            thr =
-                new CacheClosedException(LocalizedStrings.PartitionMessage_REMOTE_CACHE_IS_CLOSED_0
-                    .toLocalizedString(dm.getId()));
+            if (dm.getCache() == null) {
+              thr = new CacheClosedException(
+                  LocalizedStrings.PartitionMessage_REMOTE_CACHE_IS_CLOSED_0
+                      .toLocalizedString(dm.getId()));
+            } else {
+              dm.getCache().getCacheClosedException(
+                  LocalizedStrings.PartitionMessage_REMOTE_CACHE_IS_CLOSED_0
+                      .toLocalizedString(dm.getId()));
+            }
-  private void replyWithException(DistributionManager dm, ReplyException rex) {
+  private void replyWithException(ClusterDistributionManager dm, ReplyException rex) {
-  public synchronized boolean sendReplyForOneResult(DM dm, Object oneResult, boolean lastResult,
-      boolean sendResultsInOrder)
+  public synchronized boolean sendReplyForOneResult(DistributionManager dm, Object oneResult,
+      boolean lastResult, boolean sendResultsInOrder)
-  protected void sendReply(InternalDistributedMember member, int procId, DM dm, Object oneResult,
-      int msgNum, boolean lastResult, boolean sendResultsInOrder) {
+  protected void sendReply(InternalDistributedMember member, int procId, DistributionManager dm,
+      Object oneResult, int msgNum, boolean lastResult, boolean sendResultsInOrder) {
-    return DistributionManager.REGION_FUNCTION_EXECUTION_EXECUTOR;
+    return ClusterDistributionManager.REGION_FUNCTION_EXECUTION_EXECUTOR;
-  private boolean checkCacheClosing(DistributionManager dm) {
+  private boolean checkCacheClosing(ClusterDistributionManager dm) {
-  private boolean checkDSClosing(DistributionManager dm) {
+  private boolean checkDSClosing(ClusterDistributionManager dm) {

UPD40 UPD43 UPD43 UPD43 UPD43 UPD43 UPD43 UPD43 UPD42 UPD42 UPD42 UPD42 UPD42 UPD40 UPD42 UPD42 INS8 INS25 INS41 INS27 MOV8 INS8 INS32 INS33 INS21 INS42 INS42 INS32 INS32 INS42 INS32 INS42 INS42 INS40 INS42 INS32 INS42 INS42 DEL41