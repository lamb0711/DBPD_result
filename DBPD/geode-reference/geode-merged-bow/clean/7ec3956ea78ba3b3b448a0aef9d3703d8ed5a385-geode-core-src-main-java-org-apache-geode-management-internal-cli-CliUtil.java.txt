GEODE-4517: Remove getAnyInstancce call from CliUtil.

* CliUtil.getCacheIfExists now takes supplier, but will squelch error and return null as before.
* LogWriter.getInstance now explicitly takes a Cache, to hook into the cache's LogWriter.  This perhaps should be replaced by the LogService logger in a future commit.
* GfshExecutionStrategy adopts the Gfsh shell's LogWriter, since the shell will necessarily have finished instantiating the LogWriter's singleton before GfshExecutionStrategy can instantiate.
* In some instances, the LogWriter has been replaced with the Log4j LogService logger.
* Launcher explicitly passes a null Cache, since it does not yet exist.
* Other minor improvements: visibility, typo corrections, etc.
+import java.util.function.Supplier;
-import org.apache.commons.lang.StringUtils;
+import org.apache.geode.cache.Cache;
-import org.apache.geode.cache.CacheFactory;
+import org.apache.geode.internal.lang.StringUtils;
-  public static InternalCache getCacheIfExists() {
-    InternalCache cache;
+  /**
+   * Returns the InternalCache returned by the provided method.
+   * If the provided method would raise a CacheClosedException, returns null instead.
+   */
+  public static InternalCache getCacheIfExists(Supplier<InternalCache> getCacheMethod) {
+    InternalCache cache = null;
-      cache = getInternalCache();
-    } catch (CacheClosedException e) {
-      // ignore & return null
-      cache = null;
+      cache = getCacheMethod.get();
+    } catch (CacheClosedException ignored) {
-
+
-    Set<DistributedMember> members = findMembers(null, null);
+    Set<DistributedMember> members = findMembers(null, null, cache);
-  public static Set<String> getAllRegionNames() {
-    InternalCache cache = getInternalCache();
+  public static Set<String> getAllRegionNames(Cache cache) {
-      String[] members) {
-    InternalCache cache = getInternalCache();
+      String[] members, InternalCache cache) {
-
-  public static Set<DistributedMember> findMembers(String[] groups, String[] members) {
-    InternalCache cache = getInternalCache();
+  public static Set<DistributedMember> findMembers(String[] groups, String[] members,
+      InternalCache cache) {
-  public static DistributedMember getDistributedMemberByNameOrId(String memberNameOrId) {
-    DistributedMember memberFound = null;
-
-    if (memberNameOrId != null) {
-      InternalCache cache = getInternalCache();
-      Set<DistributedMember> memberSet = CliUtil.getAllMembers(cache);
-      for (DistributedMember member : memberSet) {
-        if (memberNameOrId.equalsIgnoreCase(member.getId())
-            || memberNameOrId.equalsIgnoreCase(member.getName())) {
-          memberFound = member;
-          break;
-        }
-      }
+  public static DistributedMember getDistributedMemberByNameOrId(String memberNameOrId,
+      InternalCache cache) {
+    if (memberNameOrId == null) {
+      return null;
-    return memberFound;
+
+    Set<DistributedMember> memberSet = CliUtil.getAllMembers(cache);
+    return memberSet.stream().filter(member -> memberNameOrId.equalsIgnoreCase(member.getId())
+        || memberNameOrId.equalsIgnoreCase(member.getName())).findFirst().orElse(null);
+
-
-
-
-
-
-    private final int dataLength;
+    private final int dataLength;
-
-  // Methods that will be removed by the next commit:
-
-  private static InternalCache getInternalCache() {
-    return (InternalCache) CacheFactory.getAnyInstance();
-  }

MOV26 MOV26 INS26 UPD40 UPD40 INS40 INS29 INS44 INS44 INS44 INS44 INS44 MOV8 INS65 INS74 INS42 INS43 INS42 INS43 INS42 INS43 INS42 INS43 INS42 INS25 INS41 INS66 INS66 INS43 MOV43 INS42 INS42 INS42 UPD42 MOV42 INS27 INS8 INS32 INS42 INS33 INS42 INS33 INS41 INS32 INS42 INS33 UPD42 INS42 INS33 INS32 INS42 INS32 INS42 INS86 UPD42 INS42 INS42 UPD42 MOV42 INS59 MOV27 INS42 DEL42 DEL33 DEL7 DEL21 DEL42 DEL43 DEL42 DEL42 DEL32 DEL59 DEL60 DEL42 DEL43 DEL42 DEL42 DEL32 DEL59 DEL60 DEL42 DEL43 DEL42 DEL42 DEL32 DEL59 DEL60 DEL42 DEL43 DEL42 DEL32 DEL59 DEL60 DEL42 DEL43 DEL42 DEL44 DEL42 DEL42 DEL42 DEL7 DEL21 DEL10 DEL8 DEL25 DEL8 DEL70 DEL43 DEL42 DEL33 DEL59 DEL60 DEL42 DEL33 DEL27 DEL25 DEL42 DEL41 DEL8 DEL83 DEL83 DEL42 DEL42 DEL43 DEL42 DEL42 DEL32 DEL11 DEL41 DEL8 DEL31