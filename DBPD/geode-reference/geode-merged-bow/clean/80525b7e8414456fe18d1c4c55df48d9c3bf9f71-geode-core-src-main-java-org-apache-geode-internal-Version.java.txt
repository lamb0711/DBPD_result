[GEODE-2144] Improve error message when no security credentials are provided.

- Improve error message when no security credentials are provided.
- Add tests for the code paths exposing this message.
- Refactor making those code paths more testable.

This closes #310

+  public boolean isPre65() {
+    return compareTo(Version.GFE_65) < 0;
+  }

INS31 INS83 INS39 INS42 INS8 INS41 INS27 INS32 INS34 INS42 INS40