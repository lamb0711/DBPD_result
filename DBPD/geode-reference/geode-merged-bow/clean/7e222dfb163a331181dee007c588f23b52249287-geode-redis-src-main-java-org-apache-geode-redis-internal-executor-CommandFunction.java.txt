GEODE-8147: change redis DELETE and EXISTS to use Function+Delta (#5128)

Co-authored-by: Sarah <mboxwala@pivotal.io>
Co-authored-by: Sarah <sabbey@pivotal.io>
-import org.apache.geode.redis.internal.RedisDataType;
+import org.apache.geode.redis.internal.RegionProvider;
+  private RegionProvider regionProvider;
-  public static void register() {
+  public static void register(RegionProvider regionProvider) {
-    FunctionService.registerFunction(new CommandFunction(stripedExecutor));
+    FunctionService.registerFunction(new CommandFunction(stripedExecutor, regionProvider));
-  public CommandFunction(StripedExecutor stripedExecutor) {
+  public CommandFunction(StripedExecutor stripedExecutor,
+      RegionProvider regionProvider) {
+    this.regionProvider = regionProvider;
-        RedisDataType delType = (RedisDataType) args[1];
-        callable = executeDel(key, localRegion, delType);
+        callable = () -> new RedisKeyInRegion(localRegion, regionProvider).del(key);
+        break;
+      case EXISTS:
+        callable = () -> new RedisKeyInRegion(localRegion, regionProvider).exists(key);
-
-  private Callable<Object> executeDel(ByteArrayWrapper key, Region localRegion,
-      RedisDataType delType) {
-    switch (delType) {
-      case REDIS_SET:
-        return () -> new RedisSetInRegion(localRegion).del(key);
-      case REDIS_HASH:
-        return () -> new RedisHashInRegion(localRegion).del(key);
-      default:
-        throw new UnsupportedOperationException("DEL does not support " + delType);
-    }
-  }
-

UPD40 INS23 INS83 INS43 INS59 INS44 INS44 UPD42 MOV42 INS42 INS43 INS42 INS43 INS42 INS21 INS42 INS42 INS7 INS21 INS10 INS49 INS22 INS42 INS7 INS42 INS42 INS52 INS42 INS42 INS86 INS86 INS32 INS32 INS14 INS42 INS42 INS14 UPD42 MOV42 INS42 INS43 INS42 INS42 INS43 INS42 INS42 UPD42 MOV42 INS42 DEL43 DEL42 DEL42 DEL43 DEL42 DEL34 DEL2 DEL11 DEL59 DEL60 DEL42 DEL42 DEL42 DEL32 DEL83 DEL42 DEL43 DEL42 DEL43 DEL74 DEL42 DEL42 DEL43 DEL42 DEL44 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL44 DEL42 DEL42 DEL49 DEL42 DEL43 DEL42 DEL14 DEL42 DEL42 DEL32 DEL86 DEL41 DEL42 DEL49 DEL42 DEL43 DEL42 DEL14 DEL42 DEL42 DEL32 DEL86 DEL41 DEL49 DEL42 DEL43 DEL45 DEL42 DEL27 DEL14 DEL53 DEL50 DEL8 DEL31