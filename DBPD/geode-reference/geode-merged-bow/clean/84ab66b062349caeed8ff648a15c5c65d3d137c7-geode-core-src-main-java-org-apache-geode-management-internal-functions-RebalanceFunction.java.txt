GEODE-8272 Refactor Restore Redundancy Command (#5249)

Co-authored-by: Jinmei Liao <jiliao@pivotal.io>
Co-authored-by: Mark Hanson <mhanson@pivotal.io>

* Reimplement the RestoreRedundancyCommand using OperationPerformer
-public class RebalanceFunction implements InternalFunction {
+public class RebalanceFunction implements InternalFunction<Object[]> {
-  public void execute(FunctionContext context) {
-
-    RebalanceOperation op = null;
-    String[] str = new String[0];
-
+  public void execute(FunctionContext<Object[]> context) {
+    RebalanceOperation op;
-    Object[] args = (Object[]) context.getArguments();
+    Object[] args = context.getArguments();
-    RebalanceResults results = null;
+    RebalanceResults results;
-      str1.append(results.getTotalBucketCreateBytes() + "," + results.getTotalBucketCreateTime()
-          + "," + results.getTotalBucketCreatesCompleted() + ","
-          + results.getTotalBucketTransferBytes() + "," + results.getTotalBucketTransferTime() + ","
-          + results.getTotalBucketTransfersCompleted() + "," + results.getTotalPrimaryTransferTime()
-          + "," + results.getTotalPrimaryTransfersCompleted() + "," + results.getTotalTime() + ","
-          + results.getTotalMembersExecutedOn() + "," + String.join(",", includeRegionNames));
+      str1.append(results.getTotalBucketCreateBytes()).append(",")
+          .append(results.getTotalBucketCreateTime()).append(",")
+          .append(results.getTotalBucketCreatesCompleted()).append(",")
+          .append(results.getTotalBucketTransferBytes()).append(",")
+          .append(results.getTotalBucketTransferTime()).append(",")
+          .append(results.getTotalBucketTransfersCompleted()).append(",")
+          .append(results.getTotalPrimaryTransferTime()).append(",")
+          .append(results.getTotalPrimaryTransfersCompleted()).append(",")
+          .append(results.getTotalTime()).append(",").append(results.getTotalMembersExecutedOn())
+          .append(",").append(String.join(",", includeRegionNames));
-      logger.info("Starting RebalanceFunction CancellationException: ", e.getMessage(), e);
+      logger.info("Starting RebalanceFunction CancellationException: {} {}", e.getMessage(), e);

INS74 MOV43 INS5 INS43 INS85 INS74 INS42 MOV43 MOV5 MOV5 MOV32 INS32 INS42 MOV32 INS32 INS42 INS45 UPD45 INS32 INS42 MOV32 INS32 INS42 INS45 INS32 INS42 MOV32 INS32 INS42 INS45 INS32 INS42 MOV32 INS32 INS42 INS45 INS32 INS42 MOV32 INS32 INS42 INS45 INS32 INS42 MOV32 INS32 INS42 INS45 INS32 INS42 MOV32 INS32 INS42 INS45 INS32 INS42 MOV32 INS32 INS42 INS45 INS32 INS42 MOV32 INS32 INS42 INS45 INS32 INS42 MOV32 INS32 INS42 INS45 MOV42 MOV42 MOV32 DEL33 DEL42 DEL43 DEL85 DEL5 DEL42 DEL42 DEL43 DEL85 DEL5 DEL34 DEL3 DEL59 DEL60 DEL11 DEL33 DEL45 DEL45 DEL45 DEL45 DEL45 DEL45 DEL45 DEL45 DEL45 DEL45 DEL27