GEODE-8372: Configure CMS to send UTF-8 regardless of JVM default (#5411)


+import java.nio.charset.StandardCharsets;
+import org.springframework.http.converter.HttpMessageConverter;
+
+    // configur the rest template to use a speciic jackson converter
+    List<HttpMessageConverter<?>> messageConverters = restTemplate.getMessageConverters();
+    MappingJackson2HttpMessageConverter jackson2HttpMessageConverter = messageConverters.stream()
+        .filter(MappingJackson2HttpMessageConverter.class::isInstance)
+        .map(MappingJackson2HttpMessageConverter.class::cast)
+        .findFirst().orElse(null);
+
+    if (jackson2HttpMessageConverter == null) {
+      jackson2HttpMessageConverter = new MappingJackson2HttpMessageConverter();
+      messageConverters.add(jackson2HttpMessageConverter);
+    }
+
+    jackson2HttpMessageConverter.setPrettyPrint(false);
+    // the client should use a mapper that would ignore unknown properties in case the server
+    // is a newer version than the client
+    jackson2HttpMessageConverter
+        .setObjectMapper(GeodeJsonMapper.getMapperIgnoringUnknownProperties());
+    // if we don't set the default charset here, the request will use ServletRequest's default
+    // charset which may not be UTF-8
+    jackson2HttpMessageConverter.setDefaultCharset(StandardCharsets.UTF_8);
-
-    // configure our own ObjectMapper
-    MappingJackson2HttpMessageConverter messageConverter =
-        new MappingJackson2HttpMessageConverter();
-    messageConverter.setPrettyPrint(false);
-    // the client should use a mapper that would ignore unknown properties in case the server
-    // is a newer version than the client
-    messageConverter.setObjectMapper(GeodeJsonMapper.getMapperIgnoringUnknownProperties());
-    restTemplate.getMessageConverters().removeIf(
-        m -> m.getClass().getName().equals(MappingJackson2HttpMessageConverter.class.getName()));
-    restTemplate.getMessageConverters().add(messageConverter);

INS26 INS26 INS40 INS40 INS8 MOV21 MOV21 INS60 INS60 INS25 INS21 MOV21 INS21 INS74 INS59 MOV43 INS59 INS27 INS8 INS32 INS32 INS43 INS74 INS42 MOV32 INS42 INS32 INS42 INS33 INS21 INS21 INS42 INS42 INS9 UPD42 INS42 INS42 INS40 INS42 INS43 INS76 INS32 INS42 INS33 INS7 INS32 INS42 INS32 INS42 INS42 MOV14 INS42 INS42 INS42 INS32 INS42 INS90 INS32 INS42 INS90 MOV57 INS42 INS42 INS42 INS57 INS42 INS43 INS42 DEL8 DEL42 DEL59 DEL60 DEL42 DEL42 DEL9 DEL32 DEL21 DEL42 DEL42 DEL59 DEL42 DEL42 DEL32 DEL42 DEL32 DEL42 DEL42 DEL32 DEL32 DEL86 DEL32 DEL21 DEL42 DEL42 DEL32 DEL42 DEL42 DEL32 DEL21