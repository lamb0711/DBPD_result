GEODE-6984: Make OQL Security API Public (#4030)

- Addded javadocs for MethodInvocationAuthorizer.
- Fixed warnings and added Unit Tests for MethodDispatch.
- Fixed warnings and added Unit Tests for AttributeDescriptor.
- Moved 'MethodInvocationAuthorizer' and 'RestrictedMethodAuthorizer'
  from an internal package to a public one,
  'org.apache.geode.cache.query.security'.
-package org.apache.geode.cache.query.internal;
+package org.apache.geode.cache.query.security;
-public class RestrictedMethodInvocationAuthorizer implements MethodInvocationAuthorizer {
-
+public class RestrictedMethodAuthorizer implements MethodInvocationAuthorizer {
-  public RestrictedMethodInvocationAuthorizer(SecurityService securityService) {
+  public RestrictedMethodAuthorizer(SecurityService securityService) {
-    HashMap<String, Set> acceptListMap = new HashMap();
-    Set<Class> objectCallers = new HashSet();
+    HashMap<String, Set> acceptListMap = new HashMap<>();
+    Set<Class> objectCallers = new HashSet<>();
-    Set<Class> booleanCallers = new HashSet();
+    Set<Class> booleanCallers = new HashSet<>();
-    Set<Class> numericCallers = new HashSet();
+    Set<Class> numericCallers = new HashSet<>();
-    Set<Class> mapCallers = new HashSet();
+    Set<Class> mapCallers = new HashSet<>();
-    Set<Class> mapEntryCallers = new HashSet();
+    Set<Class> mapEntryCallers = new HashSet<>();
-  public void authorizeMethodInvocation(Method method, Object target) {
+  public boolean authorize(Method method, Object target) {
-      throw new NotAuthorizedException(UNAUTHORIZED_STRING + method.getName());
+      return false;
-    authorizeRegionAccess(securityService, target);
+
+    try {
+      authorizeRegionAccess(securityService, target);
+    } catch (NotAuthorizedException noAuthorizedException) {
+      return false;
+    }
+
+    return true;

UPD40 UPD42 UPD42 UPD39 UPD42 INS54 INS41 INS8 INS12 INS9 INS41 MOV21 INS44 INS8 INS74 INS74 INS74 INS74 INS74 INS74 INS9 MOV43 INS42 INS41 MOV43 MOV43 MOV43 MOV43 MOV43 MOV43 INS9 DEL42 DEL42 DEL42 DEL32 DEL27 DEL14 DEL53