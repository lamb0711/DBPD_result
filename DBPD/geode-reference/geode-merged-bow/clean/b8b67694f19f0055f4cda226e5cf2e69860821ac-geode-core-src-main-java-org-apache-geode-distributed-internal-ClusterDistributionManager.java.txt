Merge branch 'develop' into feature/GEODE-7049

-import org.apache.geode.distributed.internal.membership.DistributedMembershipListener;
-import org.apache.geode.distributed.internal.membership.MemberFactory;
-import org.apache.geode.distributed.internal.membership.NetView;
+import org.apache.geode.distributed.internal.membership.MembershipView;
+import org.apache.geode.distributed.internal.membership.adapter.ServiceConfig;
+import org.apache.geode.distributed.internal.membership.gms.api.MembershipBuilder;
+import org.apache.geode.internal.InternalDataSerializer;
-import org.apache.geode.internal.Version;
+import org.apache.geode.internal.serialization.Version;
-      DMListener l = new DMListener(this);
-      membershipManager = MemberFactory.newMembershipManager(l, transport,
-          stats,
-          new GMSAuthenticator(system.getSecurityProperties(), system.getSecurityService(),
-              system.getSecurityLogWriter(), system.getInternalLogWriter()),
-          system.getConfig());
+      DMListener listener = new DMListener(this);
+      membershipManager = MembershipBuilder.newMembershipBuilder(this)
+          .setAuthenticator(
+              new GMSAuthenticator(system.getSecurityProperties(), system.getSecurityService(),
+                  system.getSecurityLogWriter(), system.getInternalLogWriter()))
+          .setStatistics(stats)
+          .setMessageListener(this::handleIncomingDMsg)
+          .setMembershipListener(listener)
+          .setConfig(new ServiceConfig(transport, system.getConfig()))
+          .setSerializer(InternalDataSerializer.getDSFIDSerializer())
+          .create();
-      NetView v = membershipManager.getView();
+      MembershipView v = membershipManager.getView();
-  public long getMembershipPort() {
-    return localAddress.getPort();
-  }
-
-  @Override
-  private void handleViewInstalled(NetView view) {
+  private void handleViewInstalled(MembershipView view) {
-    return membershipManager.send(destinations, content, stats);
+    return membershipManager.send(destinations, content);
-  private class DMListener implements DistributedMembershipListener {
+  private class DMListener implements
+      org.apache.geode.distributed.internal.membership.gms.api.MembershipListener {
-    public void messageReceived(DistributionMessage message) {
-      handleIncomingDMsg(message);
-    }
-
-    @Override
-    public void newMemberConnected(InternalDistributedMember member) {
+    public void newMemberConnected(DistributedMember member) {
-      dm.addNewMember(member);
+      dm.addNewMember((InternalDistributedMember) member);
-    public void viewInstalled(NetView view) {
+    public void viewInstalled(MembershipView view) {
-    public ClusterDistributionManager getDM() {
-      return dm;
-    }
-
-    @Override
-    NetView view;
+    MembershipView view;
-    ViewInstalledEvent(NetView view) {
+    ViewInstalledEvent(MembershipView view) {

MOV26 MOV26 MOV26 MOV26 INS26 UPD40 UPD40 UPD40 INS40 UPD40 UPD43 INS31 UPD43 INS40 MOV78 MOV83 MOV39 UPD42 MOV42 MOV44 MOV8 UPD43 UPD42 UPD43 UPD42 UPD43 UPD42 UPD43 UPD42 UPD42 UPD42 UPD43 INS11 UPD42 INS32 UPD42 MOV43 INS42 INS32 INS42 INS32 INS42 INS32 INS32 INS42 INS14 INS42 INS42 INS32 INS42 INS42 INS43 INS42 MOV32 INS32 INS42 INS90 INS42 MOV32 INS42 INS42 INS52 INS42 INS32 UPD42 UPD42 MOV42 UPD42 MOV42 INS52 DEL42 DEL42 DEL42 DEL78 DEL83 DEL39 DEL42 DEL42 DEL42 DEL32 DEL41 DEL8 DEL31 DEL42 DEL42 DEL42 DEL42 DEL78 DEL42 DEL42 DEL32 DEL21 DEL8 DEL31 DEL83 DEL39 DEL42 DEL42 DEL44 DEL31 DEL42 DEL78 DEL83 DEL42 DEL43 DEL42 DEL42 DEL41 DEL8 DEL31