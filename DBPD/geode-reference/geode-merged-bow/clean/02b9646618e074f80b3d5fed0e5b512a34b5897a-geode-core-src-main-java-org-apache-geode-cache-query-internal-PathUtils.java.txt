GEODE-3247:Improve OQL expression execution (#837)

* GEODE-3247: Restrict method invocation in OQL when new security service is enabled

* GEODE-3248: Regions being passed in through bind parameters should have authorized access

* GEODE-3247: MethodInvocationAuthorizer is created at start up

  * MethodInvocationAuthorizer can now be passed down from InternalCache
  * Broke apart new tests into smaller files and removed complex query maps from UserPerms
  * Modified Customer Test Object for Rest Security tests


-import java.lang.reflect.*;
-import java.util.*;
+import java.lang.reflect.Field;
+import java.lang.reflect.Member;
+import java.lang.reflect.Method;
+import java.util.ArrayList;
+import java.util.List;
+import java.util.StringTokenizer;
+import org.apache.geode.cache.query.NameNotFoundException;
-import org.apache.geode.cache.query.NameNotFoundException;
-import org.apache.geode.cache.query.types.*;
-import org.apache.geode.cache.query.internal.types.*;
+import org.apache.geode.cache.query.internal.types.TypeUtils;
+import org.apache.geode.cache.query.types.ObjectType;
-  public static Object evaluateAttribute(Object target, String attribute)
+  public static Object evaluateAttribute(ExecutionContext context, Object target, String attribute)
-      return new AttributeDescriptor(attribute).read(target);
+      return new AttributeDescriptor(
+          context.getCache().getQueryService().getMethodInvocationAuthorizer(), attribute)
+              .read(target);
-  public static ObjectType[] calculateTypesAlongPath(ObjectType initialType, String[] pathArray)
-      throws NameNotFoundException {
+  public static ObjectType[] calculateTypesAlongPath(ExecutionContext context,
+      ObjectType initialType, String[] pathArray) throws NameNotFoundException {
-      Member member = new AttributeDescriptor(pathArray[i - 1]).getReadMember(currentType);
+      Member member = new AttributeDescriptor(
+          context.getCache().getQueryService().getMethodInvocationAuthorizer(), pathArray[i - 1])
+              .getReadMember(currentType.resolveClass());
+
-            member = new AttributeDescriptor(stepStr).getReadMember(clazz);
+            member = new AttributeDescriptor(
+                context.getCache().getQueryService().getMethodInvocationAuthorizer(), stepStr)
+                    .getReadMember(clazz);

MOV26 INS26 INS26 INS26 INS26 UPD40 INS40 INS40 INS40 UPD40 INS40 UPD40 UPD40 INS44 INS44 INS43 INS42 INS43 INS42 INS42 INS42 INS32 INS32 INS32 INS42 INS32 MOV42 INS42 INS32 INS42 INS32 INS42 INS42 INS42 INS32 INS42 INS42 INS42 INS32 INS32 INS42 INS32 INS42 INS42 INS42