GEODE-5925 locks are not released in shutdown hook

If the cache is closed because the JVM is exiting we aren't releasing
locks until the DistributedSystem disconnects.  This alters the behavior
of shutdown and, in particular, causes long delays in designating new
primary bucket owners and reestablishing redundancy.

This commit enables unlocking during shutdown.

This closes #2725

-  private void assignStartingBucketAdvisor() {
+  private void assignStartingBucketAdvisorIfFixedPartitioned() {
+    if (startingBucketAdvisor != null) {
+      // already assigned
+      return;
+    }
-    if (startingBucketAdvisor == null) {
-      assignStartingBucketAdvisor();
-      if (startingBucketAdvisor != null) {
-        return;
-      }
-    } else {
+    assignStartingBucketAdvisorIfFixedPartitioned();
+    if (startingBucketAdvisor != null) {
-    // TODO fix this method to not release any locks if the
-    // redundancy is zero, since no locks are grabbed.
-      } else {
-        // InternalDistributedSystem.isDisconnecting probably prevented us from
-        // creating the DLS... hope there's a thread closing this advisor but
-        // it's probably not safe to assert that it already happened
-              // the advisor, becuase that might deadlock with a user thread.
+              // the advisor, because that might deadlock with a user thread.
-              if (startingBucketAdvisor == null) {
-                assignStartingBucketAdvisor();
-              }
+              assignStartingBucketAdvisorIfFixedPartitioned();

UPD42 INS25 MOV21 MOV25 INS27 INS8 INS42 INS33 INS41 UPD42 MOV21 UPD42 DEL42 DEL33 DEL27 DEL8 DEL41 DEL8 DEL25 DEL8 DEL42 DEL33 DEL27 DEL8 DEL25