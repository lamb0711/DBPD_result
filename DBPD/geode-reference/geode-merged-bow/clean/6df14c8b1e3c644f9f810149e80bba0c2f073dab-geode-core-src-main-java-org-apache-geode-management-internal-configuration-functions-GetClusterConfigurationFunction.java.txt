GEODE-3974: Core function security improvement (#1310)



-import static org.apache.geode.management.internal.security.ResourcePermissions.CLUSTER_MANAGE;
-import static org.apache.geode.management.internal.security.ResourcePermissions.CLUSTER_READ;
-import static org.apache.geode.management.internal.security.ResourcePermissions.CLUSTER_WRITE;
-import static org.apache.geode.management.internal.security.ResourcePermissions.DATA_MANAGE;
-import static org.apache.geode.management.internal.security.ResourcePermissions.DATA_READ;
-import static org.apache.geode.management.internal.security.ResourcePermissions.DATA_WRITE;
-
+import java.util.Collections;
-import java.util.stream.Collectors;
-import java.util.stream.Stream;
+import org.apache.geode.management.internal.security.ResourcePermissions;
+  /**
+   * this function will return all cluster config which will potentially leak security information.
+   * Thus we require all permissions to execute this function
+   **/
-    return Stream
-        .of(DATA_READ, DATA_WRITE, DATA_MANAGE, CLUSTER_READ, CLUSTER_WRITE, CLUSTER_MANAGE)
-        .collect(Collectors.toSet());
+    return Collections.singleton(ResourcePermissions.ALL);

MOV26 MOV26 UPD40 UPD40 INS29 INS65 INS66 INS66 INS32 UPD42 MOV42 UPD42 MOV42 INS40 DEL40 DEL26 DEL40 DEL26 DEL40 DEL26 DEL40 DEL26 DEL40 DEL26 DEL40 DEL26 DEL42 DEL42 DEL42 DEL42 DEL42 DEL42 DEL42 DEL42 DEL32 DEL42 DEL32 DEL32