Merge branch 'release/1.4.0'

-import org.apache.geode.cache.CacheFactory;
-import org.apache.geode.cache.execute.FunctionAdapter;
+import org.apache.geode.cache.execute.Function;
-public class DataCommandFunction extends FunctionAdapter implements InternalEntity {
+public class DataCommandFunction implements Function, InternalEntity {
-      InternalCache cache = getCache();
+      InternalCache cache = (InternalCache) functionContext.getCache();
-        result = get(request, cache.getSecurityService());
+        result = get(request, cache);
-        result = locateEntry(request);
+        result = locateEntry(request, cache);
-        result = put(request);
+        result = put(request, cache);
-        result = remove(request);
+        result = remove(request, cache);
-        result = select(request);
+        result = select(request, cache);
-  private InternalCache getCache() {
-    return (InternalCache) CacheFactory.getAnyInstance();
-  }
-
-  public DataCommandResult remove(DataCommandRequest request) {
+  public DataCommandResult remove(DataCommandRequest request, InternalCache cache) {
-    return remove(key, keyClass, regionName, removeAllKeys);
+    return remove(key, keyClass, regionName, removeAllKeys, cache);
-  public DataCommandResult get(DataCommandRequest request, SecurityService securityService) {
+  public DataCommandResult get(DataCommandRequest request, InternalCache cache) {
-        securityService);
+        cache);
-  public DataCommandResult locateEntry(DataCommandRequest request) {
+  public DataCommandResult locateEntry(DataCommandRequest request, InternalCache cache) {
-    return locateEntry(key, keyClass, valueClass, regionName, recursive);
+    return locateEntry(key, keyClass, valueClass, regionName, recursive, cache);
-  public DataCommandResult put(DataCommandRequest request) {
+  public DataCommandResult put(DataCommandRequest request, InternalCache cache) {
-    return put(key, value, putIfAbsent, keyClass, valueClass, regionName);
+    return put(key, value, putIfAbsent, keyClass, valueClass, regionName, cache);
-  public DataCommandResult select(DataCommandRequest request) {
+  public DataCommandResult select(DataCommandRequest request, InternalCache cache) {
-    return select(request.getPrincipal(), query);
+    return select(cache, request.getPrincipal(), query);
-  private DataCommandResult select(Object principal, String queryString) {
+  private DataCommandResult select(InternalCache cache, Object principal, String queryString) {
-    InternalCache cache = getCache();
-        select_SelectResults((SelectResults) results, principal, list, nestedObjectCount);
+        select_SelectResults((SelectResults) results, principal, list, nestedObjectCount, cache);
-      List<SelectResultRow> list, AtomicInteger nestedObjectCount) throws GfJsonException {
+      List<SelectResultRow> list, AtomicInteger nestedObjectCount, InternalCache cache)
+      throws GfJsonException {
-      object = getCache().getSecurityService().postProcess(principal, null, null, object, false);
+      object = cache.getSecurityService().postProcess(principal, null, null, object, false);
-      String removeAllKeys) {
-
-    InternalCache cache = getCache();
+      String removeAllKeys, InternalCache cache) {
-      String regionName, Boolean loadOnCacheMiss, SecurityService securityService) {
+      String regionName, Boolean loadOnCacheMiss, InternalCache cache) {
-    InternalCache cache = getCache();
+    SecurityService securityService = cache.getSecurityService();
-      String regionPath, boolean recursive) {
-
-    InternalCache cache = getCache();
+      String regionPath, boolean recursive, InternalCache cache) {
-      String valueClass, String regionName) {
+      String valueClass, String regionName, InternalCache cache) {
-    InternalCache cache = getCache();
-   * 
+   *

UPD40 UPD43 UPD42 INS44 INS44 INS44 INS44 INS44 INS44 INS44 INS44 INS44 MOV43 INS42 MOV43 INS42 INS43 INS42 INS43 INS42 INS43 INS42 MOV43 INS42 INS43 INS42 MOV43 INS42 MOV43 UPD42 MOV43 INS42 MOV43 INS42 INS42 INS42 INS42 INS42 MOV43 INS42 UPD42 INS42 INS42 INS42 UPD42 INS43 UPD42 INS42 INS42 INS11 MOV43 INS32 MOV32 INS42 MOV42 INS42 INS42 INS42 INS42 INS42 INS42 DEL40 DEL26 DEL32 DEL83 DEL42 DEL42 DEL42 DEL32 DEL11 DEL41 DEL8 DEL31 DEL42 DEL43 DEL42 DEL42 DEL42 DEL32 DEL59 DEL60 DEL42 DEL32 DEL42 DEL32 DEL42 DEL42 DEL32 DEL59 DEL60 DEL42 DEL42 DEL32 DEL59 DEL60 DEL42 DEL42 DEL32 DEL59 DEL60