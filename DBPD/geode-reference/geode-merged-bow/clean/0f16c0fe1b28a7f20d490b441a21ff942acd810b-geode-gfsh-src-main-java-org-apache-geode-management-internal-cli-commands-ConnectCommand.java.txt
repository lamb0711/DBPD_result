GEODE-8331: allow GFSH to connect to other versions of cluster (#5375)


-    String gfshVersion = gfsh.getVersion();
+    // since 1.14, only allow gfsh to connect to cluster that's older than 1.10
+    String gfshVersion = gfsh.getVersion();
-      String gfshGeodeSerializationVersion = gfsh.getGeodeSerializationVersion();
-      String remoteGeodeSerializationVersion = invoker.getRemoteGeodeSerializationVersion();
-      if (hasSameMajorMinor(gfshGeodeSerializationVersion, remoteGeodeSerializationVersion)) {
+      remoteVersion = invoker.getRemoteVersion();
+      int minorVersion = Integer.parseInt(versionComponent(remoteVersion, VERSION_MINOR));
+      if (versionComponent(remoteVersion, VERSION_MAJOR).equals("1") && minorVersion >= 10 ||
+          versionComponent(remoteVersion, VERSION_MAJOR).equals("9") && minorVersion >= 9) {
+        InfoResultModel versionInfo = result.addInfo("versionInfo");
+        versionInfo.addLine("You are connected to a cluster of version: " + remoteVersion);
-    } catch (Exception e) {
-      // we failed to get the remote geode serialization version; get remote product version for
-      // error message
-      try {
-        remoteVersion = invoker.getRemoteVersion();
-      } catch (Exception ex) {
-        gfsh.logInfo("failed to get the the remote version.", ex);
-      }
+    } catch (Exception ex) {
+      // if unable to get the remote version, we are certainly talking to
+      // a pre-1.5 cluster
+      gfsh.logInfo("failed to get the the remote version.", ex);
-  private static boolean hasSameMajorMinor(String gfshVersion, String remoteVersion) {
-    return versionComponent(remoteVersion, VERSION_MAJOR)
-        .equalsIgnoreCase(versionComponent(gfshVersion, VERSION_MAJOR))
-        && versionComponent(remoteVersion, VERSION_MINOR)
-            .equalsIgnoreCase(versionComponent(gfshVersion, VERSION_MINOR));
-  }
-

MOV60 MOV12 MOV21 INS25 INS39 INS27 INS8 UPD42 INS32 INS27 INS27 MOV60 INS21 MOV41 INS42 INS42 MOV32 INS32 INS27 INS32 INS27 UPD43 INS32 INS32 INS42 INS45 INS42 INS34 MOV32 INS42 INS45 INS42 INS34 UPD42 UPD42 UPD42 MOV42 UPD42 MOV42 INS27 INS42 INS42 INS42 UPD42 UPD42 INS45 INS45 INS42 DEL42 DEL43 DEL32 DEL42 DEL32 DEL8 DEL25 DEL42 DEL43 DEL42 DEL44 DEL8 DEL54 DEL8 DEL12 DEL83 DEL83 DEL39 DEL42 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL44 DEL42 DEL42 DEL42 DEL42 DEL32 DEL32 DEL42 DEL42 DEL42 DEL42 DEL32 DEL32 DEL27 DEL41 DEL8 DEL31