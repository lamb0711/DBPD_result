Merge pull request #3141 from apache/feature/GEODE-6344

GEODE-6344: should revert GEODE-1183 before a better fix
-      boolean toCreateNewProxy = true;
-        if (staleClientProxy.isConnected() && staleClientProxy.getSocket().isConnected()) {
-          successful = false;
-          toCreateNewProxy = false;
+        // A proxy exists for this non-durable client. It must be closed.
+        if (logger.isDebugEnabled()) {
+          logger.debug(
+              "CacheClientNotifier: A proxy exists for this non-durable client. It must be closed.");
+        }
+        if (staleClientProxy.startRemoval()) {
+          staleClientProxy.waitRemoval();
-          // A proxy exists for this non-durable client. It must be closed.
-          if (logger.isDebugEnabled()) {
-            logger.debug(
-                "CacheClientNotifier: A proxy exists for this non-durable client. It must be closed.");
-          }
-          if (staleClientProxy.startRemoval()) {
-            staleClientProxy.waitRemoval();
-          } else {
-            staleClientProxy.close(false, false); // do not check for queue, just close it
-            removeClientProxy(staleClientProxy); // remove old proxy from proxy set
-          }
+          staleClientProxy.close(false, false); // do not check for queue, just close it
+          removeClientProxy(staleClientProxy); // remove old proxy from proxy set
-      if (toCreateNewProxy) {
-        // Create the new proxy for this non-durable client
-        l_proxy =
-            new CacheClientProxy(this, socket, proxyId, isPrimary, clientConflation, clientVersion,
-                acceptorId, notifyBySubscription, this.cache.getSecurityService(), subject);
-        successful = this.initializeProxy(l_proxy);
-      }
+      // Create the new proxy for this non-durable client
+      l_proxy =
+          new CacheClientProxy(this, socket, proxyId, isPrimary, clientConflation, clientVersion,
+              acceptorId, notifyBySubscription, this.cache.getSecurityService(), subject);
+      successful = this.initializeProxy(l_proxy);

MOV8 MOV60 MOV21 MOV21 MOV27 DEL42 DEL42 DEL32 DEL42 DEL42 DEL32 DEL42 DEL32 DEL27 DEL42 DEL9 DEL7 DEL21 DEL42 DEL9 DEL7 DEL21 DEL8 DEL39 DEL42 DEL9 DEL59 DEL60 DEL25 DEL42 DEL8 DEL25 DEL8