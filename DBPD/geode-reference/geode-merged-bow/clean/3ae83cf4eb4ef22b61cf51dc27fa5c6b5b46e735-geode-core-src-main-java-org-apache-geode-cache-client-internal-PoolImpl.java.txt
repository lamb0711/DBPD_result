Feature/geode 7258 2 (#4250)

GEODE-7258: The function retry logic is modified to handle exception
thrown, while trying to connect to a server thats shutdown/closed.

    Co-authored-by: Anil <agingade@pivotal.io>
    Co-authored-by: Xiaojian Zhou <gzhou@pivotal.io>

+import org.apache.geode.cache.client.PoolFactory;
+
+  public int calculateRetryAttempts(Throwable cause) {
+
+    int maxRetryAttempts = getRetryAttempts();
+
+    if (maxRetryAttempts == PoolFactory.DEFAULT_RETRY_ATTEMPTS) {
+      // If the retryAttempt is set to default(-1). Try executing on all servers once.
+      // As calculating number of servers involves sending message to locator, it is
+      // done only when there is an exception.
+      if (cause instanceof ServerConnectivityException
+          && cause.getMessage().contains(ConnectionManagerImpl.SOCKET_TIME_OUT_MSG)) {
+        // The request was sent once.
+        maxRetryAttempts = getConnectionSource().getAllServers().size() - 1;
+      } else {
+        // The client was unable to establish a connection before sending the
+        // request.
+        maxRetryAttempts = getConnectionSource().getAllServers().size();
+      }
+    }
+
+    return maxRetryAttempts;
+  }
+

INS26 INS40 INS31 INS83 INS39 INS42 INS44 INS8 INS43 INS42 INS60 INS25 INS41 INS42 INS39 INS59 INS27 INS8 INS42 INS42 INS32 INS42 INS40 INS25 INS42 INS27 INS8 INS8 INS62 INS32 INS21 INS21 INS42 INS43 INS32 INS42 INS40 INS7 INS7 INS42 INS42 INS42 INS42 INS27 INS42 INS32 INS32 INS34 INS32 INS42 INS32 INS42 INS32 INS42 INS32 INS42 INS42 INS42