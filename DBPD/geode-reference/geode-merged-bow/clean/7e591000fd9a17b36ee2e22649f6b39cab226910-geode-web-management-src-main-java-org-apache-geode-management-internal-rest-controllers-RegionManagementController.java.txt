GEODE-6744: list index rest api (#3550)

Co-authored-by: Owen Nichols <onichols@pivotal.io>


+import java.util.List;
+
+import org.springframework.web.bind.annotation.PathVariable;
+import org.springframework.web.bind.annotation.ResponseBody;
+import org.apache.geode.management.configuration.RuntimeIndex;
+import org.apache.geode.management.configuration.RuntimeRegionConfig;
+import org.apache.geode.management.internal.exceptions.EntityNotFoundException;
+import org.apache.geode.security.ResourcePermission.Operation;
+import org.apache.geode.security.ResourcePermission.Resource;
-  public ResponseEntity<ClusterManagementResult> listRegion(
+  @ResponseBody
+  public ClusterManagementResult listRegion(
-    ClusterManagementResult result = clusterManagementService.list(filter);
-    return new ResponseEntity<>(result,
-        result.isSuccessful() ? HttpStatus.OK : HttpStatus.INTERNAL_SERVER_ERROR);
+    return clusterManagementService.list(filter);
+  }
+
+  @RequestMapping(method = RequestMethod.GET, value = REGION_CONFIG_ENDPOINT + "/{id}")
+  @ResponseBody
+  public ClusterManagementResult getRegion(
+      @PathVariable(name = "id") String id) {
+    securityService.authorize(Resource.CLUSTER, Operation.READ, id);
+    RegionConfig config = new RegionConfig();
+    config.setName(id);
+    return clusterManagementService.get(config);
+  }
+
+  @RequestMapping(method = RequestMethod.GET,
+      value = REGION_CONFIG_ENDPOINT + "/{regionName}/indexes")
+  @ResponseBody
+  public ClusterManagementResult listIndex(
+      @PathVariable String regionName,
+      @RequestParam(required = false) String id) {
+
+    ClusterManagementResult result = getRegion(regionName);
+    RuntimeRegionConfig runtimeRegion = result.getResult(RuntimeRegionConfig.class).get(0);
+
+    // only send the index information back
+    List<RuntimeIndex> runtimeIndexes = runtimeRegion.getRuntimeIndexes(id);
+    result.setResult(runtimeIndexes);
+
+    return result;
+  }
+
+  @RequestMapping(method = RequestMethod.GET,
+      value = REGION_CONFIG_ENDPOINT + "/{regionName}/indexes/{id}")
+  @ResponseBody
+  public ClusterManagementResult getIndex(
+      @PathVariable String regionName,
+      @PathVariable String id) {
+    ClusterManagementResult result = listIndex(regionName, id);
+    List<RuntimeIndex> indexList = result.getResult(RuntimeIndex.class);
+
+    if (indexList.size() == 0) {
+      throw new EntityNotFoundException("Index " + id + " not found.");
+    }
+
+    if (indexList.size() > 1) {
+      throw new IllegalStateException("More than one entity found.");
+    }
+
+    result.setResult(indexList);
+    return result;

INS26 INS26 INS26 INS26 INS26 INS26 INS26 INS26 INS40 INS40 INS40 INS40 INS40 INS40 INS40 INS40 INS31 INS31 INS31 INS78 MOV43 INS77 INS78 INS83 INS43 INS42 INS44 INS8 INS77 INS78 INS83 MOV43 INS42 INS44 INS44 INS8 INS77 INS78 INS83 INS43 INS42 INS44 INS44 INS8 INS42 INS42 INS80 INS80 INS42 INS42 INS77 INS43 INS42 INS21 INS60 INS21 INS41 INS42 INS80 INS80 INS42 INS78 INS43 INS42 INS77 INS43 INS42 INS60 INS60 INS60 INS21 INS41 INS42 INS80 INS80 INS42 INS42 INS78 INS43 INS42 INS78 INS43 INS42 INS60 INS60 INS25 INS25 INS21 INS41 MOV32 INS42 INS40 INS42 INS27 INS42 INS80 INS42 INS32 INS43 INS59 INS32 INS32 INS42 INS40 INS42 INS27 INS42 INS42 INS42 INS80 INS42 INS43 INS59 INS43 INS59 INS74 INS59 INS32 INS42 INS42 INS40 INS42 INS27 INS42 INS42 INS42 INS42 INS43 INS59 INS74 INS59 INS27 INS8 INS27 INS8 INS32 INS42 INS42 INS45 INS42 INS45 INS42 INS42 INS40 INS40 INS42 INS42 INS42 INS14 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS45 INS42 INS9 INS42 INS42 INS32 INS42 INS42 INS32 INS43 INS43 INS42 INS32 INS42 INS42 INS42 INS42 INS45 INS42 INS42 INS32 INS43 INS43 INS42 INS32 INS32 INS34 INS53 INS32 INS34 INS53 INS42 INS42 INS42 INS43 INS42 INS42 INS32 INS42 INS34 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS57 INS42 INS42 INS14 INS42 INS42 INS14 INS42 INS42 INS42 INS57 INS43 INS43 INS27 INS43 INS45 INS43 INS42 INS42 INS45 INS42 INS45 INS42 INS42 DEL42 DEL43 DEL74 DEL42 DEL59 DEL60 DEL42 DEL43 DEL74 DEL42 DEL42 DEL42 DEL32 DEL40 DEL40 DEL16 DEL14