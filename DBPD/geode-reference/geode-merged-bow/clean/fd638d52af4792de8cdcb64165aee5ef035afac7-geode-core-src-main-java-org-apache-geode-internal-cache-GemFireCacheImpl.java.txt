Revert "GEODE-2632: use immutable SecurityService impls to improve performance"

This reverts commit 5eca6f0393c1a05804a4c4b7f97203ee2ec226a2.

-import org.apache.geode.internal.security.SecurityServiceFactory;
-  private final SecurityService securityService;
+  private final SecurityService securityService = SecurityService.getSecurityService();
-  public static GemFireCacheImpl createClient(InternalDistributedSystem system, PoolFactory pf,
+  public static GemFireCacheImpl createClient(DistributedSystem system, PoolFactory pf,
-  public static GemFireCacheImpl create(InternalDistributedSystem system, CacheConfig cacheConfig) {
+  public static GemFireCacheImpl create(DistributedSystem system, CacheConfig cacheConfig) {
-  static GemFireCacheImpl createWithAsyncEventListeners(InternalDistributedSystem system,
+  static GemFireCacheImpl createWithAsyncEventListeners(DistributedSystem system,
-  public static Cache create(InternalDistributedSystem system, boolean existingOk,
+  public static Cache create(DistributedSystem system, boolean existingOk,
-  private static GemFireCacheImpl basicCreate(InternalDistributedSystem system, boolean existingOk,
+  private static GemFireCacheImpl basicCreate(DistributedSystem system, boolean existingOk,
-  private GemFireCacheImpl(boolean isClient, PoolFactory pf, InternalDistributedSystem system,
+  private GemFireCacheImpl(boolean isClient, PoolFactory pf, DistributedSystem system,
-      this.system = system;
+      this.system = (InternalDistributedSystem) system;
-
-      this.securityService = this.system.getSecurityService();
-
-  public SecurityService getSecurityService() {
-    return this.securityService;
-  }
-
-  @Override
+    // first initialize the security service using the security properties
+    this.securityService.initSecurity(this.system.getConfig().getSecurityProps());
+    // secondly if cacheConfig has a securityManager, use that instead
+    if (this.cacheConfig.getSecurityManager() != null) {
+      this.securityService.setSecurityManager(this.cacheConfig.getSecurityManager());
+    }
+    // if cacheConfig has a postProcessor, use that instead
+    if (this.cacheConfig.getPostProcessor() != null) {
+      this.securityService.setPostProcessor(this.cacheConfig.getPostProcessor());
+    }
+

INS23 MOV83 MOV83 MOV43 INS59 MOV42 INS32 UPD43 UPD43 UPD43 UPD43 UPD43 INS43 MOV21 INS25 INS25 INS42 INS42 UPD42 UPD42 UPD42 UPD42 UPD42 INS42 INS32 INS27 INS8 INS27 INS8 MOV22 INS42 INS32 INS32 INS33 INS21 INS32 INS33 INS21 MOV32 INS42 INS22 INS42 INS32 INS22 INS42 INS32 INS11 UPD42 INS52 INS42 MOV22 INS42 INS32 INS52 INS42 INS22 INS42 INS32 MOV43 INS42 INS22 INS42 INS52 INS42 INS22 INS42 INS52 INS42 INS52 INS42 DEL40 DEL26 DEL59 DEL23 DEL42 DEL42 DEL78 DEL83 DEL42 DEL43 DEL42 DEL41 DEL8 DEL31 DEL7