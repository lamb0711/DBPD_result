GEODE-3578: Only DATA:READ permissions are required for creating/closing a cq from a client

  * As part of this commit GEODE-3576: Moved security check earlier in cq process

-    securityService.authorize(Resource.CLUSTER, Operation.MANAGE, Target.QUERY);
-
-      AuthorizeRequest authzRequest = serverConnection.getAuthzRequest();
-      if (authzRequest != null) {
+      if (cqQuery != null) {
+        securityService.authorize(Resource.DATA, Operation.READ, cqQuery.getRegionName());
-        if (cqQuery != null) {
-          String queryStr = cqQuery.getQueryString();
-          Set cqRegionNames = new HashSet();
-          cqRegionNames.add(cqQuery.getRegionName());
-          authzRequest.closeCQAuthorize(cqName, queryStr, cqRegionNames);
+        AuthorizeRequest authzRequest = serverConnection.getAuthzRequest();
+        if (authzRequest != null) {
+
+          if (cqQuery != null) {
+            String queryStr = cqQuery.getQueryString();
+            Set cqRegionNames = new HashSet();
+            cqRegionNames.add(cqQuery.getRegionName());
+            authzRequest.closeCQAuthorize(cqName, queryStr, cqRegionNames);
+          }
+
+        cqService.closeCq(cqName, id);
-
-      cqService.closeCq(cqName, id);

INS25 INS27 INS8 INS42 INS33 INS21 MOV60 MOV25 MOV21 INS32 INS42 INS42 INS40 INS40 INS32 INS42 INS42 DEL42 DEL42 DEL40 DEL40 DEL40 DEL32 DEL21