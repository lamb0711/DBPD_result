GEODE-5971: Refactor ShowMetricsCommand to extend GfshCommand and retâ€¦ (#2928)

* GEODE-5971: Refactor ShowMetricsCommand to extend GfshCommand and return ResultModel
   * Applied updates from reviews

Signed-off-by: Jens Deppe <jdeppe@pivotal.io>

-import org.apache.geode.management.cli.Result;
+import org.apache.geode.management.cli.GfshCommand;
-import org.apache.geode.management.internal.cli.result.CompositeResultData;
-import org.apache.geode.management.internal.cli.result.ErrorResultData;
-import org.apache.geode.management.internal.cli.result.ResultBuilder;
-import org.apache.geode.management.internal.cli.result.ResultData;
-import org.apache.geode.management.internal.cli.result.TabularResultData;
+import org.apache.geode.management.internal.cli.result.model.ResultModel;
+import org.apache.geode.management.internal.cli.result.model.TabularResultModel;
-public class ShowMetricsCommand extends InternalGfshCommand {
+public class ShowMetricsCommand extends GfshCommand {
-  public Result showMetrics(
+  public ResultModel showMetrics(
-    ResultData resultData;
+    ResultModel result;
-      resultData = getRegionMetricsFromMember(regionName, member, export_to_report_to, categories,
+      result = getRegionMetricsFromMember(regionName, member, export_to_report_to, categories,
-      resultData =
+      result =
-      resultData =
+      result =
-      resultData = getSystemWideMetrics(export_to_report_to, categories, csvBuilder);
+      result = getSystemWideMetrics(export_to_report_to, categories, csvBuilder);
-    return ResultBuilder.buildResult(resultData);
+    return result;
-  private ResultData getSystemWideMetrics(String export_to_report_to, String[] categoriesArr,
+  private ResultModel getSystemWideMetrics(String export_to_report_to, String[] categoriesArr,
-      return ResultBuilder.createErrorResultData().addLine(errorMessage);
+      return ResultModel.createError(errorMessage);
-    CompositeResultData crd = ResultBuilder.createCompositeResultData();
-    CompositeResultData.SectionResultData section = crd.addSection();
-    TabularResultData metricsTable = section.addTable();
+    ResultModel result = new ResultModel();
+    TabularResultModel metricsTable = result.addTable("cluster-metrics");
-      crd.addAsFile(export_to_report_to, csvBuilder.toString(),
-          "Cluster wide metrics exported to {0}.", false);
+      result.addFile(export_to_report_to, csvBuilder.toString());
-    return crd;
+    return result;
-  private ResultData getMemberMetrics(DistributedMember distributedMember,
+  private ResultModel getMemberMetrics(DistributedMember distributedMember,
-      return ResultBuilder.createErrorResultData().addLine(errorMessage);
+      return ResultModel.createError(errorMessage);
-        ErrorResultData erd = ResultBuilder.createErrorResultData();
-        erd.addLine(CliStrings.format(CliStrings.SHOW_METRICS__CACHE__SERVER__NOT__FOUND,
-            cacheServerPort, MBeanJMXAdapter.getMemberNameOrId(distributedMember)));
-        return erd;
+        return ResultModel.createError(
+            CliStrings.format(CliStrings.SHOW_METRICS__CACHE__SERVER__NOT__FOUND,
+                cacheServerPort, MBeanJMXAdapter.getMemberNameOrId(distributedMember)));
-    CompositeResultData crd = ResultBuilder.createCompositeResultData();
-    CompositeResultData.SectionResultData section = crd.addSection();
-    TabularResultData metricsTable = section.addTable();
+    ResultModel result = new ResultModel();
+    TabularResultModel metricsTable = result.addTable("member-metrics");
-      crd.addAsFile(export_to_report_to, csvBuilder != null ? csvBuilder.toString() : null,
-          "Member metrics exported to {0}.", false);
+      result.addFile(export_to_report_to, csvBuilder != null ? csvBuilder.toString() : null);
-    return crd;
+    return result;
-  private ResultData getDistributedRegionMetrics(String regionName, String export_to_report_to,
+  private ResultModel getDistributedRegionMetrics(String regionName, String export_to_report_to,
-      ErrorResultData erd = ResultBuilder.createErrorResultData();
-      erd.addLine(errorMessage);
-      return erd;
+      return ResultModel.createError(errorMessage);
-    CompositeResultData crd = ResultBuilder.createCompositeResultData();
-    CompositeResultData.SectionResultData section = crd.addSection();
-    TabularResultData metricsTable = section.addTable();
+    ResultModel result = new ResultModel();
+    TabularResultModel metricsTable = result.addTable("metrics");
-      crd.addAsFile(export_to_report_to, csvBuilder != null ? csvBuilder.toString() : null,
-          "Aggregate Region Metrics exported to {0}.", false);
+      result.addFile(export_to_report_to, csvBuilder != null ? csvBuilder.toString() : null);
-    return crd;
+    return result;
-  private ResultData getRegionMetricsFromMember(String regionName,
+  private ResultModel getRegionMetricsFromMember(String regionName,
-    final SystemManagementService managementService =
-        (SystemManagementService) getManagementService();
+    final SystemManagementService managementService = getManagementService();
-      ErrorResultData erd = ResultBuilder.createErrorResultData();
-      erd.addLine(errorMessage);
-      return erd;
+      return ResultModel.createError(errorMessage);
-    CompositeResultData crd = ResultBuilder.createCompositeResultData();
-    CompositeResultData.SectionResultData section = crd.addSection();
-    TabularResultData metricsTable = section.addTable();
+    ResultModel result = new ResultModel();
+    TabularResultModel metricsTable = result.addTable("metrics");
-      crd.addAsFile(export_to_report_to, csvBuilder != null ? csvBuilder.toString() : null,
-          "Region Metrics exported to {0}.", false);
+      result.addFile(export_to_report_to, csvBuilder != null ? csvBuilder.toString() : null);
-    return crd;
+    return result;
-      StringBuilder csvBuilder, TabularResultData metricsTable, Set<Category> categoriesToDisplay) {
+      StringBuilder csvBuilder, TabularResultModel metricsTable,
+      Set<Category> categoriesToDisplay) {
-      TabularResultData metricsTable, StringBuilder csvBuilder, Set<Category> categoriesToDisplay) {
+      TabularResultModel metricsTable, StringBuilder csvBuilder,
+      Set<Category> categoriesToDisplay) {
-      TabularResultData metricsTable, StringBuilder csvBuilder, Set<Category> categoriesToDisplay) {
+      TabularResultModel metricsTable, StringBuilder csvBuilder,
+      Set<Category> categoriesToDisplay) {
-      TabularResultData metricsTable, StringBuilder csvBuilder, Set<Category> categoriesToDisplay) {
+      TabularResultModel metricsTable, StringBuilder csvBuilder,
+      Set<Category> categoriesToDisplay) {
-  private void writeRegionMetricValues(RegionMXBean regionMxBean, TabularResultData metricsTable,
+  private void writeRegionMetricValues(RegionMXBean regionMxBean, TabularResultModel metricsTable,
-  private void writeToTableAndCsv(TabularResultData metricsTable, String type, String metricName,
+  private void writeToTableAndCsv(TabularResultModel metricsTable, String type, String metricName,
-  private void writeToTableAndCsv(TabularResultData metricsTable, String type, String metricName,
+  private void writeToTableAndCsv(TabularResultModel metricsTable, String type, String metricName,
-  private void writeToTableAndCsv(TabularResultData metricsTable, String type, String metricName,
+  private void writeToTableAndCsv(TabularResultModel metricsTable, String type, String metricName,
-  private void writeToTableAndCsv(TabularResultData metricsTable, String type, String metricName,
+  private void writeToTableAndCsv(TabularResultModel metricsTable, String type, String metricName,

MOV26 UPD40 UPD40 UPD40 UPD43 UPD42 UPD43 UPD43 UPD43 UPD43 UPD43 UPD42 UPD42 UPD42 UPD42 UPD42 UPD43 UPD43 UPD43 UPD43 UPD43 UPD43 UPD43 UPD43 UPD43 UPD43 INS42 UPD43 UPD43 UPD42 UPD43 UPD43 UPD42 UPD43 UPD43 UPD42 UPD43 UPD43 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 INS42 INS14 UPD42 UPD42 INS42 INS14 UPD42 INS41 UPD42 INS42 INS14 UPD42 INS32 INS41 UPD42 INS42 INS14 UPD42 INS43 UPD42 INS45 INS43 UPD42 INS45 INS32 INS43 UPD42 INS45 MOV42 INS32 INS43 UPD42 INS45 UPD42 UPD42 MOV42 UPD42 MOV42 INS42 UPD42 UPD42 UPD42 MOV42 UPD42 MOV42 INS42 UPD42 UPD42 UPD42 MOV42 UPD42 MOV42 MOV42 INS42 UPD42 UPD42 UPD42 MOV42 UPD42 MOV42 MOV42 INS42 UPD42 UPD42 UPD42 MOV32 UPD42 UPD42 UPD42 UPD42 DEL40 DEL26 DEL40 DEL26 DEL40 DEL26 DEL42 DEL42 DEL42 DEL32 DEL32 DEL42 DEL42 DEL42 DEL42 DEL32 DEL40 DEL43 DEL42 DEL42 DEL42 DEL32 DEL59 DEL60 DEL45 DEL9 DEL32 DEL42 DEL42 DEL43 DEL42 DEL42 DEL42 DEL32 DEL59 DEL60 DEL21 DEL42 DEL42 DEL42 DEL42 DEL32 DEL40 DEL43 DEL42 DEL42 DEL42 DEL32 DEL59 DEL60 DEL45 DEL9 DEL42 DEL43 DEL42 DEL32 DEL59 DEL60 DEL42 DEL42 DEL32 DEL21 DEL42 DEL41 DEL42 DEL42 DEL42 DEL32 DEL40 DEL43 DEL42 DEL42 DEL42 DEL32 DEL59 DEL60 DEL45 DEL9 DEL42 DEL43 DEL32 DEL11 DEL42 DEL43 DEL42 DEL32 DEL59 DEL60 DEL42 DEL42 DEL32 DEL21 DEL42 DEL41 DEL42 DEL42 DEL42 DEL32 DEL40 DEL43 DEL42 DEL42 DEL42 DEL32 DEL59 DEL60 DEL45 DEL9