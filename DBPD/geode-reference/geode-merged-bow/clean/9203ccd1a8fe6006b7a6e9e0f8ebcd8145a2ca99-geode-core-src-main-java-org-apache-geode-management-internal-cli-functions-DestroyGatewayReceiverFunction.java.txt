GEODE-4858: Refactor destroy gateway-receiver command (#1968)

* GEODE-4858: Refactor destroy gateway-receiver command

Refactored to use SingleGfshCommand and ResultModel

Added tests for more complete unit test coverage of
DestroyGatewayReceiverFuntion

+
-import org.apache.geode.internal.cache.execute.InternalFunction;
+import org.apache.geode.management.cli.CliFunction;
+import org.apache.geode.management.internal.cli.functions.CliFunctionResult.StatusState;
-public class DestroyGatewayReceiverFunction implements InternalFunction {
+public class DestroyGatewayReceiverFunction extends CliFunction {
-  public void execute(FunctionContext context) {
+  public CliFunctionResult executeFunction(FunctionContext context) {
-    boolean ifExists = (boolean) context.getArguments();
-    if (gatewayReceivers == null || gatewayReceivers.isEmpty()) {
-      String message = "Gateway receiver not found.";
-      if (ifExists) {
-        resultSender
-            .lastResult(new CliFunctionResult(memberNameOrId, true, "Skipping: " + message));
-      } else {
-        resultSender.lastResult(new CliFunctionResult(memberNameOrId, false, message));
-      }
-      return;
-    }
-    for (GatewayReceiver receiver : cache.getGatewayReceivers()) {
-      try {
-        if (receiver.isRunning()) {
-          receiver.stop();
+    if (gatewayReceivers != null && !gatewayReceivers.isEmpty()) {
+      for (GatewayReceiver receiver : gatewayReceivers) {
+        try {
+          if (receiver.isRunning()) {
+            receiver.stop();
+          }
+          receiver.destroy();
+          return new CliFunctionResult(memberNameOrId, StatusState.OK,
+              String.format("GatewayReceiver destroyed on \"%s\"", memberNameOrId));
+        } catch (Exception e) {
+          logger.error(e.getMessage(), e);
+          return new CliFunctionResult(memberNameOrId, e, "");
-        receiver.destroy();
-        resultSender.sendResult(new CliFunctionResult(memberNameOrId, true,
-            String.format("GatewayReceiver destroyed on \"%s\"", memberNameOrId)));
-      } catch (Exception e) {
-        logger.error(e.getMessage(), e);
-        resultSender.sendResult(new CliFunctionResult(memberNameOrId, e, ""));
-      resultSender.lastResult(-1);
+    return new CliFunctionResult(memberNameOrId, StatusState.IGNORED,
+        "Gateway receiver not found.");

MOV26 INS26 UPD40 INS40 UPD43 UPD42 MOV43 UPD42 INS25 INS41 UPD27 MOV27 INS8 INS14 UPD27 INS38 MOV70 MOV43 MOV42 INS40 INS45 MOV32 INS42 INS41 MOV14 INS41 INS40 MOV14 DEL39 DEL39 DEL42 DEL39 DEL42 DEL42 DEL32 DEL11 DEL59 DEL60 DEL42 DEL42 DEL32 DEL9 DEL42 DEL42 DEL32 DEL21 DEL42 DEL42 DEL32 DEL21 DEL42 DEL42 DEL34 DEL38 DEL32 DEL21 DEL42 DEL43 DEL42 DEL45 DEL59 DEL60 DEL42 DEL42 DEL42 DEL9 DEL45 DEL42 DEL27 DEL14 DEL32 DEL21 DEL8 DEL42 DEL42 DEL42 DEL9 DEL42 DEL14 DEL32 DEL21 DEL8 DEL25 DEL41 DEL8 DEL25