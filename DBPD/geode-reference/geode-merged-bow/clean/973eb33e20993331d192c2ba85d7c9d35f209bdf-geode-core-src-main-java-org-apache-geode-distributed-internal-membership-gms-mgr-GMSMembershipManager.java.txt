GEODE-2915 Messages rejected due to unknown "vmkind"

The fix for GEODE_2875 has exacerbated this problem, which we used to only
see in cases where disable-tcp=true or when multicast was enabled.

The problem is that JGroupsMessenger is not sending the "vmkind" of the
sender in message headers.  This part of the header comes from
GMSMember.writeEssentialData().  I've changed it here to include the
vmKind if the recipient isn't using geode 1.0, which doesn't expect
the version byte.

-        // newborn set
-        boolean wasSurprise = surpriseMembers.remove(m) != null;
-
-        // bug #45155 - membership view processing was slow, causing a member to connect as
-        // "surprise"
-        // and the surprise timeout removed the member and shunned it, keeping it from being
-        // recognized as a valid member when it was finally seen in a view
-        // if (isShunned(m)) {
-        // warnShuns.add(m);
-        // continue;
-        // }
+        // newborn set. Replace the netmember of the surpriseMember ID
+        // in case it was a partial ID and is being retained by DistributionManager
+        // or some other object
+        boolean wasSurprise = surpriseMembers.containsKey(m);
+        if (wasSurprise) {
+          for (Iterator<Map.Entry<InternalDistributedMember, Long>> iterator =
+              surpriseMembers.entrySet().iterator(); iterator.hasNext();) {
+            Entry<InternalDistributedMember, Long> entry = iterator.next();
+            if (entry.getKey().equals(m)) {
+              entry.getKey().setNetMember(m.getNetMember());
+              iterator.remove();
+              break;
+            }
+          }
+        }
-        // ARB: unblock any waiters for this particular member.
+        // unblock any waiters for this particular member.

INS25 INS42 INS8 INS32 INS24 MOV42 UPD42 MOV42 MOV42 INS58 INS32 INS8 INS74 INS59 INS42 INS42 INS60 INS25 INS43 INS74 INS42 INS32 INS74 INS59 INS32 INS8 INS42 INS43 INS43 INS43 INS32 INS42 INS43 INS43 INS43 INS42 INS32 INS32 INS42 INS42 INS21 INS21 INS10 INS40 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS32 INS32 INS32 INS42 INS32 INS42 INS42 INS42 INS42 INS42 INS42 DEL32 DEL33 DEL27