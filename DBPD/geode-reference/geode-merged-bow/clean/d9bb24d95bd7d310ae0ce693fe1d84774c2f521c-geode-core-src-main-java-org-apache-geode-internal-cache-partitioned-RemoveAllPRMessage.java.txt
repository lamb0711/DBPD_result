GEODE-5605: After removeAll/PutAll messages are processed on replicas, check for cache close is done. (#2450)

GEODE-5605: After removeAll/PutAll messages are processed on replicas, check for cache close is done.

-            try {
-              // Only RemoveAllPRMessage knows if the thread id is fake. Event has no idea.
-              // So we have to manually set useFakeEventId for this op
-              op.setUseFakeEventId(true);
-              r.checkReadiness();
-              bucketRegion.getDataView().postRemoveAll(op, this.versions, bucketRegion);
-            } finally {
-              if (lockedForPrimary) {
-                bucketRegion.doUnlockForPrimary();
-              }
-            }
+            doPostRemoveAll(r, op, bucketRegion, lockedForPrimary);
+  void doPostRemoveAll(PartitionedRegion r, DistributedRemoveAllOperation op,
+      BucketRegion bucketRegion, boolean lockedForPrimary) {
+    try {
+      // Only RemoveAllPRMessage knows if the thread id is fake. Event has no idea.
+      // So we have to manually set useFakeEventId for this op
+      op.setUseFakeEventId(true);
+      r.checkReadiness();
+      bucketRegion.getDataView().postRemoveAll(op, this.versions, bucketRegion);
+      r.checkReadiness();
+    } finally {
+      if (lockedForPrimary) {
+        bucketRegion.doUnlockForPrimary();
+      }
+    }
+  }
+

INS31 INS39 INS42 INS44 INS44 INS44 INS44 MOV8 INS43 INS42 INS43 INS42 INS43 INS42 INS39 INS42 INS42 INS42 INS42 INS21 INS32 INS42 INS42 INS8 INS21 INS32 INS42 INS42 INS42 INS42 INS42