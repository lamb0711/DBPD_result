GEODE-8048: change redis sets to use functions and deltas (#5009)


Co-authored-by: Darrel Schneider <dschneider@pivotal.io>
Co-authored-by: Sarah Abbey <sabbey@pivotal.io>
Co-authored-by: John Hutchison <jhutchison@pivotal.io>
Co-authored-by: Jens Deppe <jdeppe@pivotal.io>
-import java.util.Set;
+import org.apache.geode.redis.internal.executor.set.DeltaSet;
+import org.apache.geode.redis.internal.executor.set.GeodeRedisSetWithFunctions;
+import org.apache.geode.redis.internal.executor.set.RedisSet;
-  private final Region<ByteArrayWrapper, Set<ByteArrayWrapper>> setRegion;
+  private final Region<ByteArrayWrapper, DeltaSet> setRegion;
-      Region<ByteArrayWrapper, Set<ByteArrayWrapper>> setRegion) {
+      Region<ByteArrayWrapper, DeltaSet> setRegion) {
-      Region<ByteArrayWrapper, Set<ByteArrayWrapper>> setRegion, Cache cache) {
+      Region<ByteArrayWrapper, DeltaSet> setRegion, Cache cache) {
-          // remove the set
-          setRegion.remove(key);
-          return true;
+          RedisSet geodeRedisSet =
+              new GeodeRedisSetWithFunctions(key, setRegion);
+          return geodeRedisSet.del();
-  public Region<ByteArrayWrapper, Set<ByteArrayWrapper>> getSetRegion() {
+  public Region<ByteArrayWrapper, DeltaSet> getSetRegion() {

MOV26 INS26 INS26 UPD40 INS40 INS40 UPD74 UPD74 MOV43 UPD43 MOV43 UPD74 UPD74 UPD43 MOV43 UPD42 UPD43 MOV43 UPD43 MOV43 UPD42 UPD42 UPD42 INS60 INS43 INS59 INS32 INS42 INS42 INS14 INS42 INS42 INS43 INS42 INS42 INS42 DEL42 DEL43 DEL74 DEL42 DEL43 DEL74 DEL42 DEL43 DEL74 DEL42 DEL42 DEL42 DEL32 DEL21 DEL9 DEL42 DEL43 DEL74