GEODE-5041: Adding post processing to the new protocol


+import org.apache.geode.internal.protocol.protobuf.security.NoSecurity;
+import org.apache.geode.internal.protocol.protobuf.security.NotLoggedInSecurity;
+import org.apache.geode.internal.protocol.protobuf.security.SecureCache;
+import org.apache.geode.internal.protocol.protobuf.security.SecureCacheImpl;
+import org.apache.geode.internal.protocol.protobuf.security.SecureLocator;
+import org.apache.geode.internal.protocol.protobuf.security.Security;
+import org.apache.geode.internal.protocol.protobuf.security.ShiroSecurity;
-import org.apache.geode.internal.protocol.protobuf.v1.authentication.Authorizer;
-import org.apache.geode.internal.protocol.protobuf.v1.authentication.AuthorizingCache;
-import org.apache.geode.internal.protocol.protobuf.v1.authentication.AuthorizingCacheImpl;
-import org.apache.geode.internal.protocol.protobuf.v1.authentication.AuthorizingLocator;
-import org.apache.geode.internal.protocol.protobuf.v1.authentication.NoSecurityAuthorizer;
-import org.apache.geode.internal.protocol.protobuf.v1.authentication.NotLoggedInAuthorizer;
-import org.apache.geode.internal.protocol.protobuf.v1.authentication.ShiroAuthorizer;
-  private AuthorizingCache authorizingCache;
+  private SecureCache secureCache;
-    Authorizer authorizer = securityService.isIntegratedSecurity() ? new NotLoggedInAuthorizer()
-        : new NoSecurityAuthorizer();
-    this.authorizingCache = new AuthorizingCacheImpl(cache, authorizer);
+    Security security =
+        securityService.isIntegratedSecurity() ? new NotLoggedInSecurity() : new NoSecurity();
+    this.secureCache = new SecureCacheImpl(cache, security);
-  public AuthorizingCache getAuthorizingCache() {
-    return this.authorizingCache;
+  public SecureCache getSecureCache() {
+    return this.secureCache;
-  public AuthorizingLocator getAuthorizingLocator() throws InvalidExecutionContextException {
+  public SecureLocator getSecureLocator() throws InvalidExecutionContextException {
-    this.authorizingCache =
-        new AuthorizingCacheImpl(cache, new ShiroAuthorizer(securityService, subject));
+    this.secureCache = new SecureCacheImpl(cache, new ShiroSecurity(securityService, subject));

MOV26 UPD40 UPD40 UPD40 UPD40 UPD40 UPD40 UPD40 UPD43 UPD43 UPD42 UPD43 UPD42 UPD42 UPD42 UPD42 UPD42 UPD43 UPD42 UPD42 UPD42 UPD42 UPD43 UPD42 UPD42 UPD43 UPD43 UPD43 UPD42 UPD42 UPD43 UPD42 UPD42 UPD42