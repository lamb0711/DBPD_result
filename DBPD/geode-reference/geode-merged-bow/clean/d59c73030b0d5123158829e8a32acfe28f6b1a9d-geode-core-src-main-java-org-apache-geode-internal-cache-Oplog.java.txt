Merge pull request #1053 from apache/feature/GEODE-3940

Feature/geode 3940
-import java.io.SyncFailedException;
-import org.apache.commons.io.FileUtils;
+import org.apache.geode.internal.cache.backup.BackupManager;
+  public Object getLock() {
+    return lock;
+  }
+
-  File getOplogFile() throws SyncFailedException, IOException {
+  File getOplogFileForTest() throws IOException {
+  public File getCrfFile() {
+    return this.crf.f;
+  }
+
+  public File getDrfFile() {
+    return this.drf.f;
+  }
+
-  Set<String> gatherMatchingOplogFiles(Set<String> oplogFileNames) {
+  public Set<String> gatherMatchingOplogFiles(Set<String> oplogFileNames) {
-  Map<File, File> mapBaseline(Collection<File> baselineOplogFiles) {
+  public Map<File, File> mapBaseline(Collection<File> baselineOplogFiles) {
-  private File getKrfFile() {
+  public File getKrfFile() {
-  public void copyTo(File targetDir) throws IOException {
-    if (this.crf.f != null && this.crf.f.exists()) {
-      FileUtils.copyFileToDirectory(this.crf.f, targetDir);
-    }
-    if (this.drf.f.exists()) {
-      FileUtils.copyFileToDirectory(this.drf.f, targetDir);
-    }
-
-    // this krf existence check fixes 45089
-    // TODO: should we wait for the async KRF creation to finish by calling this.finishKrf?
-    if (getParent().getDiskInitFile().hasKrf(this.oplogId)) {
-      if (this.getKrfFile().exists()) {
-        FileUtils.copyFileToDirectory(this.getKrfFile(), targetDir);
-      }
-    }
-  }
-
-  DirectoryHolder getDirectoryHolder() {
+  public DirectoryHolder getDirectoryHolder() {
-  void finishKrf() {
+  public void finishKrf() {

MOV26 UPD40 INS31 INS31 INS31 MOV83 UPD43 MOV43 INS42 INS8 UPD42 INS83 INS43 INS42 INS8 INS83 MOV43 INS42 INS8 INS83 INS83 UPD83 INS83 INS83 UPD42 INS41 INS42 INS41 INS41 INS42 MOV22 MOV22 DEL40 DEL26 DEL42 DEL43 DEL39 DEL42 DEL42 DEL44 DEL33 DEL27 DEL52 DEL42 DEL22 DEL42 DEL22 DEL42 DEL32 DEL27 DEL42 DEL42 DEL52 DEL42 DEL22 DEL42 DEL22 DEL42 DEL32 DEL21 DEL8 DEL25 DEL42 DEL32 DEL42 DEL42 DEL52 DEL42 DEL22 DEL42 DEL22 DEL42 DEL32 DEL21 DEL8 DEL25 DEL42 DEL32 DEL42 DEL32 DEL42 DEL52 DEL42 DEL22 DEL32 DEL52 DEL42 DEL32 DEL42 DEL32 DEL42 DEL42 DEL52 DEL42 DEL32 DEL42 DEL32 DEL21 DEL8 DEL25 DEL8 DEL25 DEL8 DEL31