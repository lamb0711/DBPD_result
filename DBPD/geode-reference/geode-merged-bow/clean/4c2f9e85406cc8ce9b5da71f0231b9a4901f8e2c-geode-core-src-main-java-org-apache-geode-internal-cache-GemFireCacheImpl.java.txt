GEODE-5078: provide API that does not allow access to internal regions (#1815)

The InternalCache interface now has a method named getCacheForProcessingClientRequests
that will return an InternalCache that throws a NotAuthorizedException if an attempt is made using
this cache to access or create an internal region.

-    if (isClient()) {
-      throw new UnsupportedOperationException("operation is not supported on a client cache");
-    }
+    throwIfClient();
-        if (internalRegion.isSecret() || internalRegion.isUsedForMetaRegion()
-            || internalRegion instanceof HARegion
-            || internalRegion.isUsedForPartitionedRegionAdmin() || internalRegion
-                .isInternalRegion()/* internalRegion.isUsedForPartitionedRegionBucket() */) {
-          continue; // Skip administrative PartitionedRegions
+        if (internalRegion.isInternalRegion()) {
+          continue; // Skip internal regions
-        if (region.isSecret() || region.isUsedForMetaRegion() || region instanceof HARegion
+        if (region.isSecret() || region.isUsedForMetaRegion()
-    if (isClient()) {
-      throw new UnsupportedOperationException("operation is not supported on a client cache");
-    }
+    throwIfClient();
-    if (isClient()) {
-      throw new UnsupportedOperationException("operation is not supported on a client cache");
-    }
+    throwIfClient();
-    if (isClient()) {
-      throw new UnsupportedOperationException("operation is not supported on a client cache");
-    }
+    throwIfClient();
-    if (isClient()) {
-      throw new UnsupportedOperationException("operation is not supported on a client cache");
-    }
+    throwIfClient();
-    if (isClient()) {
-      throw new UnsupportedOperationException("operation is not supported on a client cache");
-    }
+    throwIfClient();
-    if (isClient()) {
-      throw new UnsupportedOperationException("operation is not supported on a client cache");
-    }
+    throwIfClient();
-    if (isClient()) {
-      throw new UnsupportedOperationException("operation is not supported on a client cache");
-    }
+    throwIfClient();
-    if (isClient()) {
-      throw new UnsupportedOperationException("operation is not supported on a client cache");
-    }
+    throwIfClient();
-    if (isClient()) {
-      throw new UnsupportedOperationException("operation is not supported on a client cache");
-    }
+    throwIfClient();
-    if (isClient()) {
-      throw new UnsupportedOperationException("operation is not supported on a client cache");
-    }
+    throwIfClient();
-    if (isClient()) {
-      throw new UnsupportedOperationException("operation is not supported on a client cache");
-    }
+    throwIfClient();
-    if (isClient()) {
-      throw new UnsupportedOperationException("operation is not supported on a client cache");
-    } else {
-      return new RegionFactoryImpl<>(this, shortcut);
-    }
+    throwIfClient();
+    return new RegionFactoryImpl<>(this, shortcut);
-    if (isClient()) {
-      throw new UnsupportedOperationException("operation is not supported on a client cache");
-    }
+    throwIfClient();
-    if (isClient()) {
-      throw new UnsupportedOperationException("operation is not supported on a client cache");
-    }
+    throwIfClient();
-    if (isClient()) {
-      throw new UnsupportedOperationException("operation is not supported on a client cache");
-    }
+    throwIfClient();
+
+  private void throwIfClient() {
+    if (isClient()) {
+      throw new UnsupportedOperationException("operation is not supported on a client cache");
+    }
+  }
+
+  private final InternalCacheForClientAccess cacheForClients =
+      new InternalCacheForClientAccess(this);
+
+  @Override
+  public InternalCache getCacheForProcessingClientRequests() {
+    return cacheForClients;
+  }
+

INS31 INS23 INS31 MOV8 INS8 INS83 INS39 INS42 MOV8 INS83 INS83 INS43 INS59 INS78 INS83 INS43 INS42 INS8 INS21 INS21 INS21 INS21 INS21 INS21 INS21 INS21 INS21 INS21 INS21 INS21 INS21 INS21 INS21 INS21 MOV41 INS42 INS42 INS14 INS42 INS42 INS41 INS32 INS32 INS32 INS32 INS32 INS32 INS32 INS32 INS32 INS32 INS32 INS32 INS32 INS32 INS32 INS32 INS43 INS52 INS42 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 INS42 UPD42 MOV42 UPD42 MOV42 INS42 INS42 MOV32 DEL32 DEL42 DEL43 DEL45 DEL14 DEL53 DEL8 DEL25 DEL42 DEL42 DEL32 DEL42 DEL42 DEL32 DEL42 DEL42 DEL43 DEL62 DEL42 DEL42 DEL32 DEL27 DEL42 DEL42 DEL43 DEL62 DEL32 DEL42 DEL43 DEL45 DEL14 DEL53 DEL8 DEL25 DEL32 DEL42 DEL43 DEL45 DEL14 DEL53 DEL8 DEL25 DEL32 DEL42 DEL43 DEL45 DEL14 DEL53 DEL8 DEL25 DEL32 DEL42 DEL43 DEL45 DEL14 DEL53 DEL8 DEL25 DEL32 DEL42 DEL43 DEL45 DEL14 DEL53 DEL8 DEL25 DEL32 DEL42 DEL43 DEL45 DEL14 DEL53 DEL8 DEL25 DEL32 DEL42 DEL43 DEL45 DEL14 DEL53 DEL8 DEL25 DEL32 DEL42 DEL43 DEL45 DEL14 DEL53 DEL8 DEL25 DEL32 DEL42 DEL43 DEL45 DEL14 DEL53 DEL8 DEL25 DEL32 DEL42 DEL43 DEL45 DEL14 DEL53 DEL8 DEL25 DEL32 DEL42 DEL43 DEL45 DEL14 DEL53 DEL8 DEL25 DEL42 DEL32 DEL42 DEL43 DEL45 DEL14 DEL53 DEL8 DEL25 DEL8 DEL32 DEL42 DEL43 DEL45 DEL14 DEL53 DEL8 DEL25 DEL32 DEL42 DEL43 DEL45 DEL14 DEL53 DEL8 DEL25