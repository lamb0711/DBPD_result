Revert "GEODE-3007: Simplify support for custom GFSH commands (#1042)" (#1072)

This reverts commit 0e5dd6ba45519463147337c8265db15e8f1840fc.
-import static java.util.stream.Collectors.joining;
-
+import java.util.ArrayList;
-import org.springframework.shell.core.CommandMarker;
-  private final Map<String, MethodTarget> availabilityIndicators = new HashMap<>();
+  private final Map<String, MethodTarget> availabilityIndicators =
+      new HashMap<String, MethodTarget>();
-  public void registerCommand(CommandMarker commandMarker) {
-    for (Method method : commandMarker.getClass().getMethods()) {
-      CliCommand cliCommand = method.getAnnotation(CliCommand.class);
-      CliAvailabilityIndicator availability = method.getAnnotation(CliAvailabilityIndicator.class);
-      if (cliCommand == null && availability == null) {
-        continue;
-      }
-
-      if (cliCommand != null) {
-        addCommand(cliCommand, method);
-      }
-
-      if (availability != null) {
-        addAvailabilityIndicator(availability, new MethodTarget(method, commandMarker));
-      }
-    }
-  }
-
-  protected void addCommand(CliCommand command, Method commandMethod) {
+  public void addCommand(CliCommand command, Method commandMethod) {
-  private void addAvailabilityIndicator(CliAvailabilityIndicator availability,
-      MethodTarget target) {
+  public void addAvailabilityIndicator(CliAvailabilityIndicator availability, MethodTarget target) {
-      topics.keySet().stream().sorted()
+      List<String> sortedTopics = new ArrayList<>(topics.keySet());
+      Collections.sort(sortedTopics);
+      sortedTopics.stream()
-    topic.relatedCommands.stream().sorted().forEach(command -> builder.append(command.command)
+    Collections.sort(topic.relatedCommands);
+    topic.relatedCommands.stream().forEachOrdered(command -> builder.append(command.command)
-  private boolean isAvailable(String command) {
+  boolean isAvailable(String command) {
-
-    String synonyms = getSynonyms(cliOption).stream().collect(joining(","));
-    if (StringUtils.isNotEmpty(synonyms)) {
-      optionNode.addChild(new HelpBlock(SYNONYMS_SUB_NAME + synonyms));
+    if (getSynonyms(cliOption).size() > 0) {
+      StringBuilder builder = new StringBuilder();
+      for (String string : getSynonyms(cliOption)) {
+        if (builder.length() > 0) {
+          builder.append(",");
+        }
+        builder.append(string);
+      }
+      optionNode.addChild(new HelpBlock(SYNONYMS_SUB_NAME + builder.toString()));
-
+    List<String> synonyms = new ArrayList<>();
-      return Collections.emptyList();
+      return synonyms;
-      return Collections.emptyList();
+      return synonyms;
-    return Arrays.asList(keys).subList(1, keys.length);
+    for (int i = 1; i < keys.length; i++) {
+      synonyms.add(keys[i]);
+    }
+    return synonyms;

MOV26 UPD40 UPD83 UPD83 INS21 INS25 INS60 INS24 INS41 UPD74 INS32 INS27 INS8 INS74 INS59 INS58 INS27 INS37 INS8 INS42 INS43 MOV43 INS60 INS21 INS42 INS42 INS40 MOV32 UPD42 MOV32 INS34 INS60 INS70 MOV21 INS43 INS43 INS42 INS14 INS42 INS42 INS39 INS59 INS42 INS40 INS42 INS21 INS42 INS74 INS59 INS32 UPD42 INS43 INS59 INS44 INS32 INS8 INS42 INS42 INS74 INS42 INS34 INS32 INS43 INS43 INS42 INS14 INS42 INS42 INS42 INS42 INS42 INS14 MOV43 INS42 INS42 UPD42 MOV42 INS25 INS21 INS43 INS42 INS42 INS2 INS42 INS42 INS74 MOV32 UPD42 MOV42 UPD42 INS43 INS27 INS8 INS32 INS42 INS42 INS42 INS43 INS42 INS32 INS34 INS21 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 INS32 INS42 INS42 INS42 INS32 INS42 INS42 UPD42 MOV42 INS42 MOV45 DEL40 DEL26 DEL83 DEL39 DEL42 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL44 DEL42 DEL42 DEL32 DEL42 DEL32 DEL42 DEL43 DEL42 DEL42 DEL42 DEL42 DEL43 DEL57 DEL32 DEL59 DEL60 DEL42 DEL43 DEL42 DEL42 DEL42 DEL42 DEL43 DEL57 DEL32 DEL59 DEL60 DEL42 DEL33 DEL27 DEL42 DEL33 DEL27 DEL27 DEL18 DEL8 DEL25 DEL42 DEL33 DEL27 DEL42 DEL42 DEL42 DEL32 DEL21 DEL8 DEL25 DEL42 DEL33 DEL27 DEL42 DEL42 DEL42 DEL42 DEL14 DEL32 DEL21 DEL8 DEL25 DEL8 DEL70 DEL8 DEL31 DEL32 DEL42 DEL32 DEL83 DEL42 DEL42 DEL32 DEL32 DEL59 DEL60 DEL32 DEL8 DEL25 DEL42 DEL42 DEL32 DEL42 DEL42 DEL32 DEL42 DEL42 DEL42 DEL32 DEL42 DEL34 DEL40 DEL32 DEL41