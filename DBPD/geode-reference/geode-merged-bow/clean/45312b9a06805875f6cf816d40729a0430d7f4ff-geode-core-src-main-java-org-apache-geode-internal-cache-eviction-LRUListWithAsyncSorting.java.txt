GEODE-4621: Schedule scans only if list is above max eviction attemptâ€¦ (#1408)


  * The number of eviction attempts can now be configured at list creation
    to enable testability.

-  private static final int MAX_EVICTION_ATTEMPTS = 10;
+  private static final int DEFAULT_MAX_EVICTION_ATTEMPTS = 10;
+  private final int maxEvictionAttempts;
-    this(controller, SINGLETON_EXECUTOR);
+    this(controller, SINGLETON_EXECUTOR, DEFAULT_MAX_EVICTION_ATTEMPTS);
-  LRUListWithAsyncSorting(EvictionController controller, ExecutorService executor) {
+  LRUListWithAsyncSorting(EvictionController controller, ExecutorService executor,
+      int maxEvictionAttempts) {
+    this.maxEvictionAttempts = maxEvictionAttempts;
-      if (evictionNode.isRecentlyUsed() && evictionAttempts < MAX_EVICTION_ATTEMPTS) {
+      if (evictionNode.isRecentlyUsed() && evictionAttempts < maxEvictionAttempts) {
-    return size() > 0 && (double) recentlyUsedCount / size() >= this.scanThreshold;
+    return size() >= maxEvictionAttempts
+        && (double) recentlyUsedCount / size() >= this.scanThreshold;

INS23 INS83 INS83 INS39 INS59 INS44 UPD42 INS42 INS39 INS42 INS21 INS42 INS7 INS22 INS42 UPD27 INS52 INS42 INS42 UPD42 DEL34