GEODE-1809: Improve error handling

+import java.util.Optional;
-    private final String error;
+    private final Optional<String> error;
-        error = LocalizedStrings.GemFireVersion_COULD_NOT_FIND_RESOURCE_COM_GEMSTONE_GEMFIRE_INTERNAL_0.toLocalizedString(RESOURCE_NAME);
+        error = Optional.of(LocalizedStrings.GemFireVersion_COULD_NOT_FIND_RESOURCE_COM_GEMSTONE_GEMFIRE_INTERNAL_0.toLocalizedString(name));
-        error = LocalizedStrings.GemFireVersion_COULD_NOT_READ_PROPERTIES_FROM_RESOURCE_COM_GEMSTONE_GEMFIRE_INTERNAL_0_BECAUSE_1.toLocalizedString(new Object[] {RESOURCE_NAME, ex});
+        error = Optional.of(LocalizedStrings.GemFireVersion_COULD_NOT_READ_PROPERTIES_FROM_RESOURCE_COM_GEMSTONE_GEMFIRE_INTERNAL_0_BECAUSE_1.toLocalizedString(new Object[] {name, ex}));
-      error = validate();
+
+      error = validate(description);
-      if (error != null) {
-        return error;
-      }
-      return description.getProperty(key);
+      return error.orElse(description.getProperty(key));
-    private void print(PrintWriter pw) {
-      for (Entry<?,?> props : description.entrySet()) {
-        pw.println(props.getKey() + ": " + props.getValue());
+    void print(PrintWriter pw) {
+      if (error.isPresent()) {
+        pw.println(error.get());
+      } else {
+        for (Entry<?,?> props : description.entrySet()) {
+          pw.println(props.getKey() + ": " + props.getValue());
+        }
-    private String validate() {
-      if (getProperty(PRODUCT_NAME) == null) {
-        return LocalizedStrings.GemFireVersion_MISSING_PROPERTY_0_FROM_RESOURCE_COM_GEMSTONE_GEMFIRE_INTERNAL_1.toLocalizedString(new Object[] {PRODUCT_NAME, RESOURCE_NAME});
+    private Optional<String> validate(Properties props) {
+      if (props.get(PRODUCT_NAME) == null) {
+        return Optional.of(LocalizedStrings.GemFireVersion_MISSING_PROPERTY_0_FROM_RESOURCE_COM_GEMSTONE_GEMFIRE_INTERNAL_1.toLocalizedString(new Object[] {PRODUCT_NAME, RESOURCE_NAME}));
-      if (getProperty(GEMFIRE_VERSION) == null) {
-        return LocalizedStrings.GemFireVersion_MISSING_PROPERTY_0_FROM_RESOURCE_COM_GEMSTONE_GEMFIRE_INTERNAL_1.toLocalizedString(new Object[] {GEMFIRE_VERSION, RESOURCE_NAME});
+      if (props.get(GEMFIRE_VERSION) == null) {
+        return Optional.of(LocalizedStrings.GemFireVersion_MISSING_PROPERTY_0_FROM_RESOURCE_COM_GEMSTONE_GEMFIRE_INTERNAL_1.toLocalizedString(new Object[] {GEMFIRE_VERSION, RESOURCE_NAME}));
-      if (getProperty(SOURCE_DATE) == null) {
-        return LocalizedStrings.GemFireVersion_MISSING_PROPERTY_0_FROM_RESOURCE_COM_GEMSTONE_GEMFIRE_INTERNAL_1.toLocalizedString(new Object[] {SOURCE_DATE, RESOURCE_NAME});
+      if (props.get(SOURCE_DATE) == null) {
+        return Optional.of(LocalizedStrings.GemFireVersion_MISSING_PROPERTY_0_FROM_RESOURCE_COM_GEMSTONE_GEMFIRE_INTERNAL_1.toLocalizedString(new Object[] {SOURCE_DATE, RESOURCE_NAME}));
-      if (getProperty(SOURCE_REVISION) == null) {
-        return LocalizedStrings.GemFireVersion_MISSING_PROPERTY_0_FROM_RESOURCE_COM_GEMSTONE_GEMFIRE_INTERNAL_1.toLocalizedString(new Object[] {SOURCE_REVISION, RESOURCE_NAME});
+      if (props.get(SOURCE_REVISION) == null) {
+        return Optional.of(LocalizedStrings.GemFireVersion_MISSING_PROPERTY_0_FROM_RESOURCE_COM_GEMSTONE_GEMFIRE_INTERNAL_1.toLocalizedString(new Object[] {SOURCE_REVISION, RESOURCE_NAME}));
-      if (getProperty(SOURCE_REPOSITORY) == null) {
-        return LocalizedStrings.GemFireVersion_MISSING_PROPERTY_0_FROM_RESOURCE_COM_GEMSTONE_GEMFIRE_INTERNAL_1.toLocalizedString(new Object[] {SOURCE_REPOSITORY, RESOURCE_NAME});
+      if (props.get(SOURCE_REPOSITORY) == null) {
+        return Optional.of(LocalizedStrings.GemFireVersion_MISSING_PROPERTY_0_FROM_RESOURCE_COM_GEMSTONE_GEMFIRE_INTERNAL_1.toLocalizedString(new Object[] {SOURCE_REPOSITORY, RESOURCE_NAME}));
-      if (getProperty(BUILD_DATE) == null) {
-        return LocalizedStrings.GemFireVersion_MISSING_PROPERTY_0_FROM_RESOURCE_COM_GEMSTONE_GEMFIRE_INTERNAL_1.toLocalizedString(new Object[] {BUILD_DATE, RESOURCE_NAME});
+      if (props.get(BUILD_DATE) == null) {
+        return Optional.of(LocalizedStrings.GemFireVersion_MISSING_PROPERTY_0_FROM_RESOURCE_COM_GEMSTONE_GEMFIRE_INTERNAL_1.toLocalizedString(new Object[] {BUILD_DATE, RESOURCE_NAME}));
-      if (getProperty(BUILD_ID) == null) {
-        return LocalizedStrings.GemFireVersion_MISSING_PROPERTY_0_FROM_RESOURCE_COM_GEMSTONE_GEMFIRE_INTERNAL_1.toLocalizedString(new Object[] {BUILD_ID, RESOURCE_NAME});
+      if (props.get(BUILD_ID) == null) {
+        return Optional.of(LocalizedStrings.GemFireVersion_MISSING_PROPERTY_0_FROM_RESOURCE_COM_GEMSTONE_GEMFIRE_INTERNAL_1.toLocalizedString(new Object[] {BUILD_ID, RESOURCE_NAME}));
-      if (getProperty(BUILD_PLATFORM) == null) {
-        return LocalizedStrings.GemFireVersion_MISSING_PROPERTY_0_FROM_RESOURCE_COM_GEMSTONE_GEMFIRE_INTERNAL_1.toLocalizedString(new Object[] {BUILD_PLATFORM, RESOURCE_NAME});
+      if (props.get(BUILD_PLATFORM) == null) {
+        return Optional.of(LocalizedStrings.GemFireVersion_MISSING_PROPERTY_0_FROM_RESOURCE_COM_GEMSTONE_GEMFIRE_INTERNAL_1.toLocalizedString(new Object[] {BUILD_PLATFORM, RESOURCE_NAME}));
-      if (getProperty(BUILD_JAVA_VERSION) == null) {
-        return LocalizedStrings.GemFireVersion_MISSING_PROPERTY_0_FROM_RESOURCE_COM_GEMSTONE_GEMFIRE_INTERNAL_1.toLocalizedString(new Object[] {BUILD_JAVA_VERSION, RESOURCE_NAME});
+      if (props.get(BUILD_JAVA_VERSION) == null) {
+        return Optional.of(LocalizedStrings.GemFireVersion_MISSING_PROPERTY_0_FROM_RESOURCE_COM_GEMSTONE_GEMFIRE_INTERNAL_1.toLocalizedString(new Object[] {BUILD_JAVA_VERSION, RESOURCE_NAME}));
-      return null;
+      return Optional.empty();

INS26 INS40 INS74 INS74 INS44 INS43 MOV43 INS25 INS43 MOV43 INS43 INS42 INS42 INS32 INS32 INS8 INS8 INS42 INS42 INS32 INS42 INS42 MOV32 INS42 INS42 INS21 MOV70 INS42 INS42 INS42 INS32 INS42 UPD42 INS32 INS42 UPD42 INS32 INS42 UPD42 INS32 INS42 UPD42 INS32 INS42 UPD42 INS32 INS42 UPD42 INS32 INS42 UPD42 INS32 INS42 UPD42 INS32 INS42 UPD42 INS32 INS32 INS42 INS42 INS32 INS42 INS42 MOV32 INS42 INS42 MOV32 INS42 INS42 MOV32 INS42 INS42 MOV32 INS42 INS42 MOV32 INS42 INS42 MOV32 INS42 INS42 MOV32 INS42 INS42 MOV32 INS42 INS42 MOV32 INS42 INS42 INS32 INS32 INS42 INS42 MOV40 MOV42 UPD42 MOV42 INS42 INS42 MOV32 UPD42 DEL32 DEL42 DEL33 DEL27 DEL42 DEL41 DEL8 DEL25 DEL83 DEL33