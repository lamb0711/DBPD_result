GEODE-2632: change dependencies on GemFireCacheImpl to InternalCache

* misc cleanup of code where possible

-import java.nio.ByteBuffer;
-import org.apache.geode.internal.tcp.ByteBufferInputStream.ByteSourceFactory;
+import org.apache.geode.internal.cache.InternalCache;
-import org.apache.geode.pdx.PdxUnreadFields;
- *
+
-    PdxOutputStream os = new PdxOutputStream();
-    PdxType pt = new PdxType(name, expectDomainClass);
-    GemFireCacheImpl gfc = GemFireCacheImpl
+    PdxOutputStream pdxOutputStream = new PdxOutputStream();
+    PdxType pdxType = new PdxType(name, expectDomainClass);
+    InternalCache internalCache = GemFireCacheImpl
-    TypeRegistry tr = gfc.getPdxRegistry();
-    this.writer = new PdxWriterImpl(pt, tr, os);
+    TypeRegistry pdxRegistry = internalCache.getPdxRegistry();
+    this.writer = new PdxWriterImpl(pdxType, pdxRegistry, pdxOutputStream);
+  @Override
+  @Override
+  @Override
+  @Override
+  @Override
+  @Override
+  @Override
+  @Override
+  @Override
-  public PdxInstanceFactory writeDate(String fieldName, Date date) {
-    this.writer.writeDate(fieldName, date);
+  @Override
+  public PdxInstanceFactory writeDate(String fieldName, Date value) {
+    this.writer.writeDate(fieldName, value);
+  @Override
-  public PdxInstanceFactory writeObject(String fieldName, Object object) {
-    return writeObject(fieldName, object, false);
+  @Override
+  public PdxInstanceFactory writeObject(String fieldName, Object value) {
+    return writeObject(fieldName, value, false);
-  public PdxInstanceFactory writeBooleanArray(String fieldName, boolean[] array) {
-    this.writer.writeBooleanArray(fieldName, array);
+  @Override
+  public PdxInstanceFactory writeBooleanArray(String fieldName, boolean[] value) {
+    this.writer.writeBooleanArray(fieldName, value);
-  public PdxInstanceFactory writeCharArray(String fieldName, char[] array) {
-    this.writer.writeCharArray(fieldName, array);
+  @Override
+  public PdxInstanceFactory writeCharArray(String fieldName, char[] value) {
+    this.writer.writeCharArray(fieldName, value);
-  public PdxInstanceFactory writeByteArray(String fieldName, byte[] array) {
-    this.writer.writeByteArray(fieldName, array);
+  @Override
+  public PdxInstanceFactory writeByteArray(String fieldName, byte[] value) {
+    this.writer.writeByteArray(fieldName, value);
-  public PdxInstanceFactory writeShortArray(String fieldName, short[] array) {
-    this.writer.writeShortArray(fieldName, array);
+  @Override
+  public PdxInstanceFactory writeShortArray(String fieldName, short[] value) {
+    this.writer.writeShortArray(fieldName, value);
-  public PdxInstanceFactory writeIntArray(String fieldName, int[] array) {
-    this.writer.writeIntArray(fieldName, array);
+  @Override
+  public PdxInstanceFactory writeIntArray(String fieldName, int[] value) {
+    this.writer.writeIntArray(fieldName, value);
-  public PdxInstanceFactory writeLongArray(String fieldName, long[] array) {
-    this.writer.writeLongArray(fieldName, array);
+  @Override
+  public PdxInstanceFactory writeLongArray(String fieldName, long[] value) {
+    this.writer.writeLongArray(fieldName, value);
-  public PdxInstanceFactory writeFloatArray(String fieldName, float[] array) {
-    this.writer.writeFloatArray(fieldName, array);
+  @Override
+  public PdxInstanceFactory writeFloatArray(String fieldName, float[] value) {
+    this.writer.writeFloatArray(fieldName, value);
-  public PdxInstanceFactory writeDoubleArray(String fieldName, double[] array) {
-    this.writer.writeDoubleArray(fieldName, array);
+  @Override
+  public PdxInstanceFactory writeDoubleArray(String fieldName, double[] value) {
+    this.writer.writeDoubleArray(fieldName, value);
-  public PdxInstanceFactory writeStringArray(String fieldName, String[] array) {
-    this.writer.writeStringArray(fieldName, array);
+  @Override
+  public PdxInstanceFactory writeStringArray(String fieldName, String[] value) {
+    this.writer.writeStringArray(fieldName, value);
-  public PdxInstanceFactory writeObjectArray(String fieldName, Object[] array) {
-    return writeObjectArray(fieldName, array, false);
+  @Override
+  public PdxInstanceFactory writeObjectArray(String fieldName, Object[] value) {
+    return writeObjectArray(fieldName, value, false);
-  public PdxInstanceFactory writeUnreadFields(PdxUnreadFields unread) {
-    this.writer.writeUnreadFields(unread);
+  @Override
+  public PdxInstanceFactory writeArrayOfByteArrays(String fieldName, byte[][] value) {
+    this.writer.writeArrayOfByteArrays(fieldName, value);
-  public PdxInstanceFactory writeRaw(PdxField field, ByteBuffer rawData) {
-    this.writer.writeRawField(field, ByteSourceFactory.create(rawData));
-    return this;
-  }
-
-
-  public PdxInstanceFactory writeArrayOfByteArrays(String fieldName, byte[][] array) {
-    this.writer.writeArrayOfByteArrays(fieldName, array);
-    return this;
-  }
-
+  @Override
+  @Override
+  @Override
+  @Override
+  @Override
-      GemFireCacheImpl gfc) {
+      InternalCache internalCache) {
-    TypeRegistry tr = gfc.getPdxRegistry();
+    TypeRegistry tr = internalCache.getPdxRegistry();

UPD40 INS78 INS78 INS78 INS78 INS78 INS78 INS78 INS78 INS78 INS78 INS78 INS78 INS78 MOV8 INS78 MOV8 INS78 MOV8 INS78 MOV8 INS78 MOV8 INS78 MOV8 INS78 MOV8 INS78 MOV8 INS78 INS8 INS78 MOV43 INS78 INS78 INS78 INS78 INS78 INS78 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 UPD42 INS42 INS42 UPD42 INS42 UPD42 INS42 UPD42 INS42 UPD42 INS42 UPD42 INS42 UPD42 INS42 UPD42 INS42 UPD42 INS42 UPD42 INS42 UPD42 INS21 MOV41 INS42 UPD42 INS42 UPD42 INS42 INS42 INS42 INS42 INS42 UPD43 UPD42 UPD43 INS32 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 MOV22 INS42 INS42 INS42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 DEL40 DEL26 DEL40 DEL26 DEL52 DEL42 DEL22 DEL42 DEL42 DEL42 DEL32 DEL21 DEL52 DEL41 DEL8 DEL42 DEL43 DEL83 DEL42 DEL43 DEL42 DEL42 DEL43 DEL42 DEL44 DEL42 DEL42 DEL32 DEL21 DEL8 DEL31 DEL83 DEL42 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL44 DEL52 DEL42 DEL22 DEL42 DEL42 DEL42 DEL42 DEL42 DEL32 DEL32 DEL21 DEL52 DEL41 DEL8 DEL31