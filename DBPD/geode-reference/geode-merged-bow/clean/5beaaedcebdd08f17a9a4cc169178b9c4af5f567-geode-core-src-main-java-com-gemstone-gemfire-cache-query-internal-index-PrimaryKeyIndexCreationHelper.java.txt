Merge remote-tracking branch 'origin/develop' into feature/GEODE-917

-import com.gemstone.gemfire.internal.i18n.LocalizedStrings;
+import java.util.List;
+
-import com.gemstone.gemfire.cache.query.internal.*;
+import com.gemstone.gemfire.cache.query.internal.CompiledIteratorDef;
+import com.gemstone.gemfire.cache.query.internal.CompiledValue;
+import com.gemstone.gemfire.cache.query.internal.ExecutionContext;
+import com.gemstone.gemfire.cache.query.internal.RuntimeIterator;
-import java.util.List;
+import com.gemstone.gemfire.internal.cache.PartitionedRegion;
+import com.gemstone.gemfire.internal.i18n.LocalizedStrings;
-      //    Asif: Bind the Index_Internal_ID to the RuntimeIterator
-      String name = imgr.putCanonicalizedIteratorNameIfAbsent(definition);
+      //    Asif: Bind the Index_Internal_ID to the RuntimeIterator      
+      PartitionedRegion pr = this.context.getPartitionedRegion();
+      this.canonicalizedIteratorNames = new String[1];
+      String name = null;
+      if (pr != null) {
+        name = pr.getIndexManager().putCanonicalizedIteratorNameIfAbsent(definition);
+      } else {
+        name = imgr.putCanonicalizedIteratorNameIfAbsent(definition);
+      }
-      this.fromClause = new StringBuffer(definition).append(' ').append(name)
-          .toString();
+      this.fromClause = new StringBuffer(definition).append(' ').append(name).toString();

MOV26 MOV26 INS26 INS26 INS26 INS26 INS40 UPD40 INS40 INS40 INS40 MOV21 INS60 INS25 INS21 INS43 INS59 INS27 INS8 INS8 INS7 INS42 INS42 INS32 INS33 INS42 INS33 INS21 INS21 INS22 INS3 INS22 INS42 INS7 INS7 INS52 INS42 INS5 INS34 INS52 INS42 INS42 INS32 INS42 MOV32 INS43 INS85 INS32 INS42 INS42 INS42 INS42 INS42