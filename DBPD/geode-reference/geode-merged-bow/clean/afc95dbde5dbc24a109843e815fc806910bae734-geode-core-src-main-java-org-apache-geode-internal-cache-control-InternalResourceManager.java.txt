Revert "Merge pull request #3878 from aaronlindsey/server-online-uses-startup-tasks"

This reverts commit d9a9e30275ae21e33212a48ca72762bacdf37d67, reversing
changes made to f0db209e0508a313e1095a99d3e6009c1d229ce0.

-import java.util.Objects;
+import java.util.function.Consumer;
-  /**
-   * Adds a task that represents an asynchronous action during startup
-   *
-   * @param startupTask the CompletableFuture startup task
-   */
-    Objects.requireNonNull(startupTask);
-  /**
-   * Clears the startup tasks and returns a CompletableFuture that completes when all of the startup
-   * tasks complete.
-   *
-   * @return a CompletableFuture that completes when all of the startup tasks complete
-   */
-  public CompletableFuture<Void> allOfStartupTasks() {
-    CompletableFuture[] completableFutures = startupTasks.toArray(new CompletableFuture[0]);
+  public void runWhenStartupTasksComplete(Runnable runnable, Consumer<Throwable> exceptionAction) {
+    CompletableFuture.allOf(startupTasks.toArray(new CompletableFuture[0]))
+        .thenRun(runnable)
+        .exceptionally((throwable) -> {
+          exceptionAction.accept(throwable);
+          return null;
+        });
+
-    return CompletableFuture.allOf(completableFutures);

MOV26 UPD40 INS39 INS42 INS44 INS44 INS43 INS42 INS74 INS42 INS21 INS42 UPD43 MOV43 UPD43 MOV43 INS32 UPD42 UPD42 INS32 INS42 INS86 INS32 INS42 INS42 INS59 INS8 INS42 INS42 MOV32 UPD42 MOV42 INS21 INS41 INS32 INS33 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 DEL66 DEL65 DEL42 DEL66 DEL65 DEL29 DEL42 DEL42 DEL42 DEL32 DEL21 DEL66 DEL66 DEL65 DEL66 DEL65 DEL29 DEL74 DEL42 DEL42 DEL43 DEL85 DEL5 DEL59 DEL60 DEL32 DEL41