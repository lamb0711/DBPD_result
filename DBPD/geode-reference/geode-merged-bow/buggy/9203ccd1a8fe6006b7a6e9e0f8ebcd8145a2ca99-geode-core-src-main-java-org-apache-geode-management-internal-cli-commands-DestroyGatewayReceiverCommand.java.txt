GEODE-4858: Refactor destroy gateway-receiver command (#1968)

* GEODE-4858: Refactor destroy gateway-receiver command

Refactored to use SingleGfshCommand and ResultModel

Added tests for more complete unit test coverage of
DestroyGatewayReceiverFuntion

-import java.util.Arrays;
+import org.apache.geode.cache.configuration.CacheConfig;
-import org.apache.geode.distributed.internal.InternalConfigurationPersistenceService;
-import org.apache.geode.management.cli.Result;
+import org.apache.geode.management.cli.SingleGfshCommand;
-import org.apache.geode.management.internal.cli.result.CommandResult;
-import org.apache.geode.management.internal.cli.result.ResultBuilder;
+import org.apache.geode.management.internal.cli.result.model.ResultModel;
-public class DestroyGatewayReceiverCommand extends InternalGfshCommand {
+public class DestroyGatewayReceiverCommand extends SingleGfshCommand {
-  public Result destroyGatewayReceiver(
+  public ResultModel destroyGatewayReceiver(
-        executeAndGetFunctionResult(DestroyGatewayReceiverFunction.INSTANCE, ifExists, members);
+        executeAndGetFunctionResult(DestroyGatewayReceiverFunction.INSTANCE, null, members);
-    CommandResult result = ResultBuilder.buildResult(functionResults);
+    ResultModel result = ResultModel.createMemberStatusResult(functionResults, ifExists);
+    result.setConfigObject(new CacheConfig.GatewayReceiver());
-    // Only update the cluster config if the command is not executed on specific members.
-    InternalConfigurationPersistenceService service =
-        (InternalConfigurationPersistenceService) getConfigurationPersistenceService();
-    if (onMember != null || service == null) {
-      persisted = false;
-    } else if (result.getStatus().equals(Result.Status.OK) && service != null) {
-      if (onGroups == null) {
-        onGroups = new String[] {"cluster"};
-      }
-      Arrays.stream(onGroups).forEach(group -> service.updateCacheConfig(group, cc -> {
-        if (cc == null || cc.getGatewayReceiver() == null) {
-          if (!ifExists) {
-            result.setStatus(Result.Status.ERROR);
-          }
-        } else {
-          cc.setGatewayReceiver(null);
-        }
-        return cc;
-      }));
-    }
-    result.setCommandPersisted(persisted);
+
+  @Override
+  public void updateClusterConfig(String group, CacheConfig config, Object element) {
+    if (config.getGatewayReceiver() != null) {
+      config.setGatewayReceiver(null);
+    }
+  }

MOV26 UPD40 UPD40 UPD40 UPD43 INS31 UPD42 UPD43 INS78 INS83 INS39 INS42 INS44 INS44 INS44 INS8 UPD42 MOV21 INS42 MOV43 INS42 INS43 INS42 INS43 INS42 INS25 UPD43 INS42 INS42 INS27 INS8 UPD42 UPD42 INS14 INS32 INS33 INS21 INS33 UPD42 UPD42 INS42 INS43 INS42 INS42 INS32 INS40 INS42 INS42 INS33 DEL40 DEL26 DEL40 DEL26 DEL42 DEL40 DEL42 DEL43 DEL42 DEL42 DEL43 DEL42 DEL32 DEL11 DEL59 DEL60 DEL42 DEL33 DEL27 DEL42 DEL33 DEL27 DEL27 DEL42 DEL9 DEL7 DEL21 DEL8 DEL42 DEL42 DEL32 DEL42 DEL40 DEL32 DEL42 DEL33 DEL27 DEL27 DEL42 DEL33 DEL27 DEL42 DEL85 DEL5 DEL45 DEL4 DEL3 DEL7 DEL21 DEL8 DEL25 DEL42 DEL42 DEL42 DEL32 DEL42 DEL42 DEL59 DEL42 DEL42 DEL42 DEL42 DEL59 DEL42 DEL33 DEL27 DEL42 DEL42 DEL32 DEL33 DEL27 DEL27 DEL42 DEL38 DEL8 DEL25 DEL8 DEL42 DEL42 DEL33 DEL32 DEL21 DEL8 DEL25 DEL42 DEL41 DEL8 DEL86 DEL32 DEL86 DEL32 DEL21 DEL8 DEL25 DEL25 DEL42 DEL42 DEL42 DEL32 DEL21