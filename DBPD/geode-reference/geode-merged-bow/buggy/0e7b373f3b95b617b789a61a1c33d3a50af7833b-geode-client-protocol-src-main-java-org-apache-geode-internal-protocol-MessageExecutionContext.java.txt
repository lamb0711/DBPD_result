GEODE-3894: Create HandshakeRequest

added connection state processors to inject protocol state specific
functionality refactored existing authentication and authorization flows to use
connection state processors added new handshake message, handler, and state
processor

Signed-off-by: Bruce Schuchardt <bschuchardt@pivotal.io>

-import org.apache.geode.internal.protocol.security.processors.AuthorizationSecurityProcessor;
-import org.apache.geode.internal.protocol.security.processors.NoAuthenticationSecurityProcessor;
-import org.apache.geode.internal.protocol.security.Authenticator;
-import org.apache.geode.internal.protocol.security.NoOpAuthenticator;
-import org.apache.geode.internal.protocol.security.SecurityProcessor;
+import org.apache.geode.internal.protocol.state.ConnectionStateProcessor;
-import org.apache.geode.internal.protocol.security.Authorizer;
-import org.apache.geode.internal.protocol.security.NoOpAuthorizer;
-  private final Authorizer authorizer;
-  private Object authenticatedToken;
-  private SecurityProcessor securityProcessor;
-  private final Authenticator authenticator;
+  private ConnectionStateProcessor connectionStateProcessor;
-
-  public MessageExecutionContext(Cache cache, Authenticator authenticator,
-      Authorizer streamAuthorizer, Object authenticatedToken, ProtocolClientStatistics statistics,
-      SecurityProcessor securityProcessor) {
+  public MessageExecutionContext(Cache cache, ProtocolClientStatistics statistics,
+      ConnectionStateProcessor initialConnectionStateProcessor) {
-    this.authorizer = streamAuthorizer;
-    this.authenticatedToken = authenticatedToken;
-    this.securityProcessor = securityProcessor;
-    this.authenticator = authenticator;
+    this.connectionStateProcessor = initialConnectionStateProcessor;
-  public MessageExecutionContext(InternalLocator locator, ProtocolClientStatistics statistics) {
+  public MessageExecutionContext(InternalLocator locator, ProtocolClientStatistics statistics,
+      ConnectionStateProcessor initialConnectionStateProcessor) {
-    // set a no-op authorizer until such time as locators implement authentication
-    // and authorization checks
-    this.authorizer = new NoOpAuthorizer();
-    this.authenticator = new NoOpAuthenticator();
-    this.securityProcessor = new NoAuthenticationSecurityProcessor();
+    connectionStateProcessor = initialConnectionStateProcessor;
+  }
+
+  public ConnectionStateProcessor getConnectionStateProcessor() {
+    return connectionStateProcessor;
-   * Return the authorizer associated with this execution
-   */
-  public Authorizer getAuthorizer() {
-    return authorizer;
-  }
-
-  /**
-   * Returns the authentication token associated with this execution
-   */
-  public Object getAuthenticationToken() {
-    return authenticatedToken;
-  }
-
-
-  /**
-  public Authenticator getAuthenticator() {
-    return authenticator;
-  }
-
-  public SecurityProcessor getSecurityProcessor() {
-    return securityProcessor;
-  }
-
-  public void setSecurityProcessor(AuthorizationSecurityProcessor securityProcessor) {
-    this.securityProcessor = securityProcessor;
-  }
-
-  public void setAuthenticationToken(Object authenticationToken) {
-    this.authenticatedToken = authenticationToken;
+  public void setConnectionStateProcessor(ConnectionStateProcessor connectionStateProcessor) {
+    this.connectionStateProcessor = connectionStateProcessor;

MOV31 UPD40 UPD43 INS44 UPD43 UPD42 UPD42 UPD42 UPD42 UPD43 UPD42 INS43 INS42 UPD42 UPD43 UPD42 UPD42 INS42 UPD42 UPD42 UPD42 INS42 INS42 UPD42 UPD42 UPD42 DEL40 DEL26 DEL40 DEL26 DEL40 DEL26 DEL40 DEL26 DEL40 DEL26 DEL40 DEL26 DEL83 DEL83 DEL42 DEL43 DEL42 DEL59 DEL23 DEL83 DEL42 DEL43 DEL42 DEL59 DEL23 DEL83 DEL83 DEL42 DEL43 DEL42 DEL59 DEL23 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL44 DEL52 DEL42 DEL22 DEL42 DEL7 DEL21 DEL52 DEL42 DEL22 DEL42 DEL7 DEL21 DEL52 DEL42 DEL22 DEL42 DEL7 DEL21 DEL52 DEL42 DEL22 DEL42 DEL43 DEL14 DEL7 DEL21 DEL52 DEL42 DEL22 DEL42 DEL43 DEL14 DEL7 DEL21 DEL52 DEL42 DEL22 DEL42 DEL43 DEL14 DEL66 DEL65 DEL29 DEL83 DEL42 DEL43 DEL42 DEL42 DEL41 DEL8 DEL31 DEL66 DEL65 DEL29 DEL83 DEL42 DEL43 DEL42 DEL42 DEL41 DEL8 DEL31 DEL83 DEL42 DEL43 DEL42 DEL42 DEL41 DEL8 DEL31 DEL83 DEL39 DEL42 DEL42 DEL43 DEL42 DEL44 DEL52 DEL42 DEL22 DEL42 DEL7 DEL21 DEL8 DEL31