GEODE-6522 Server hangs during shutdown after becoming membership coordinator

Schedule removal of members that have failed availability checks before
becoming coordinator.  Do not shut down the View Creator thread if the
view was created locally, even if it seems to have a different
coordinator.

-      logger.info(
-          "View with removed and left members removed is {}; removed members: {}; left members: {}; suspect members: {}",
-          check, removedMembers, leftMembers, suspectMembers);
+      logger.info("View with removed and left members removed is {}", check);
+        for (InternalDistributedMember suspect : suspectMembers) {
+          recordViewRequest(
+              new RemoveMemberMessage(localAddress, suspect, "Failed availability check"));
+        }
+      ViewCreator thread = this.viewCreator;
-          && getViewCreator() != null) {
-        getViewCreator().markViewCreatorForShutdown();
+          && !localAddress.equals(view.getCreator())
+          && thread != null) {
+        thread.markViewCreatorForShutdown(view.getCoordinator());
-    private void markViewCreatorForShutdown() {
+    private void markViewCreatorForShutdown(InternalDistributedMember viewCreator) {
+      logger.info(
+          "Marking view creator for shutdown because {} is now the coordinator.  My address is {}."
+              + "  Net member IDs are {} and {} respectively",
+          viewCreator, localAddress, viewCreator.getNetMember(), localAddress.getNetMember());
+        logger.info("View Creator thread is exiting");
+        markViewCreatorForShutdown = false;

INS44 INS43 INS42 INS21 INS60 INS42 INS32 INS43 INS59 INS42 INS42 INS27 INS42 INS42 INS32 INS32 INS21 INS21 UPD45 INS70 INS42 INS42 INS22 INS38 INS45 INS45 INS42 INS42 INS42 INS42 INS32 INS7 INS44 INS42 INS8 INS52 INS42 INS32 INS42 INS42 INS42 INS45 INS42 INS9 INS43 INS42 INS21 INS42 INS42 INS32 UPD42 MOV42 INS32 INS42 INS32 INS42 INS42 INS42 INS42 INS42 INS14 INS43 INS42 INS42 INS45 INS42 DEL42 DEL42 DEL42 DEL42 DEL32 DEL32