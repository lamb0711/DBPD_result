GEODE-5568: Rewrite QueryMonitor to use ScheduledThreadPoolExecutor (#2744)

* GEODE-5568: Rewrite QueryMonitor to use ScheduledThreadPoolExecutor

Eliminate notify/wait bugs and improve hot-path performance.

Co-authored-by: Bill Burcham <bburcham@pivotal.io>
Co-authored-by: Ryan McMahon <rmcmahon@pivotal.io>
+import java.util.concurrent.Executors;
+import java.util.concurrent.ScheduledThreadPoolExecutor;
+
+  /**
+   * The number of threads that the QueryMonitor will use to mark queries as cancelled
+   * (see QueryMonitor class for reasons why a query might be cancelled).
+   * That processing is very efficient, so we don't foresee needing to raise this above 1.
+   */
+  private static final int QUERY_MONITOR_THREAD_POOL_SIZE = 1;
+
-          this.queryMonitor = new QueryMonitor(this, maxTime);
-          Thread qmThread = new LoggingThread("QueryMonitor Thread", this.queryMonitor);
-          qmThread.start();
+          this.queryMonitor =
+              new QueryMonitor(() -> (ScheduledThreadPoolExecutor) Executors.newScheduledThreadPool(
+                  QUERY_MONITOR_THREAD_POOL_SIZE,
+                  (runnable) -> new LoggingThread("QueryMonitor Thread", runnable)),
+                  this,
+                  maxTime);

INS26 INS26 INS40 INS40 INS23 INS29 INS83 INS83 INS83 INS39 INS59 INS65 INS42 INS34 INS66 INS66 INS66 INS21 INS7 MOV22 INS14 MOV43 INS86 INS52 INS42 INS11 INS43 INS32 INS42 INS42 INS42 INS42 INS86 INS59 INS14 INS42 MOV43 MOV45 INS42 DEL52 DEL42 DEL22 DEL52 DEL42 DEL14 DEL7 DEL21 DEL42 DEL43 DEL42 DEL14 DEL59 DEL60 DEL42 DEL42 DEL32 DEL21