GEODE-2817: Add new function security callback

This closes #801.

+import java.util.Collection;
+import java.util.Collections;
+import java.util.Optional;
+
+import org.apache.geode.management.internal.security.ResourcePermissions;
+import org.apache.geode.security.ResourcePermission;
- *
+ * 
-  public default boolean hasResult() {
+  default boolean hasResult() {
-  public void execute(FunctionContext<T> context);
+  void execute(FunctionContext<T> context);
-  public default String getId() {
+  default String getId() {
-   *
+   * 
-   * @since GemFire 6.0
+   * @since GemFire 6.0
-  public default boolean optimizeForWrite() {
+  default boolean optimizeForWrite() {
-   * 
-  public default boolean isHA() {
+  default boolean isHA() {
+  /**
+   * Returns the list of ResourcePermission this function requires.
+   *
+   * By default, functions require DATA:WRITE permission. If your function requires other
+   * permissions, you will need to override this method.
+   *
+   * Please be as specific as possible when you set the required permissions for your function e.g.
+   * if your function reads from a region, it would be good to include the region name in your
+   * permission. It's better to return "DATA:READ:regionName" as the required permission other than
+   * "DATA:READ", because the latter means only users with read permission on ALL regions can
+   * execute your function.
+   *
+   * All the permissions returned from this method will be ANDed together.
+   *
+   * @param regionName the region this function will be executed on. the regionName optional will be
+   *        present only when the function is executed by onRegion() executor.
+   */
+  default Collection<ResourcePermission> getRequiredPermissions(Optional<String> regionName) {
+    return Collections.singletonList(ResourcePermissions.DATA_WRITE);
+  }

INS26 INS26 INS26 INS26 INS26 INS40 INS40 INS40 INS40 INS40 INS31 MOV65 INS29 INS83 INS74 INS42 INS44 INS8 INS65 INS65 INS43 INS43 INS74 INS42 INS41 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS42 INS66 INS66 INS42 INS42 INS43 INS43 INS32 INS42 INS42 INS42 INS42 INS40 DEL83 DEL83 DEL83 DEL83 DEL83