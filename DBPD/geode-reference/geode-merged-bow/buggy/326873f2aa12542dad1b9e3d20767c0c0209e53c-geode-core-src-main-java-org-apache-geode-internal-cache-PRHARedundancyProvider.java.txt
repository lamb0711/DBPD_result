GEODE-6517: Fix a race by counting down the latch. (#3297)



+
-    allBucketsRecoveredFromDisk = new CountDownLatch(proxyBucketArray.length);
-    try {
-      if (proxyBucketArray.length > 0) {
-        this.redundancyLogger = new RedundancyLogger(this);
-        Thread loggingThread = new LoggingThread(
-            "RedundancyLogger for region " + this.prRegion.getName(), false, this.redundancyLogger);
-        loggingThread.start();
-      }
-    } catch (RuntimeException e) {
-      allBucketsRecoveredFromDisk = null;
-      throw e;
-    }
+    startRedundancyLogger(proxyBucketArray.length);
+    allBucketsRecoveredFromDisk = new CountDownLatch(proxyBucketArray.length);
+  void startRedundancyLogger(int proxyBuckets) {
+    if (proxyBuckets > 0) {
+      redundancyLogger = new RedundancyLogger(this);
+      Thread loggingThread = new LoggingThread(
+          "RedundancyLogger for region " + this.prRegion.getName(), false, this.redundancyLogger);
+      loggingThread.start();
+    }
+  }
+

INS31 INS39 INS42 INS44 MOV8 MOV21 INS39 INS42 INS32 INS42 INS40 INS42 INS42 DEL42 DEL33 DEL7 DEL42 DEL43 DEL42 DEL44 DEL42 DEL53 DEL8 DEL12 DEL54 DEL40 DEL52 DEL42 DEL22