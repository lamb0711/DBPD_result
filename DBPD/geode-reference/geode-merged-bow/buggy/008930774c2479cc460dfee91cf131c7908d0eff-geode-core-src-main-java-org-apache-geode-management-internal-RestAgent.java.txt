GEODE-6492: Ensure that starting HttpService can fail gracefully in the face of errors (#3275)

- If the HttpService (or war deployment) fails, simply log a warning
  message and continue.
- Add a simple gradle building test which ensures that 'geode-core' is
  the only module required to start a basic Cache.



-
-      } catch (RuntimeException e) {
-        logger.debug(e.getMessage(), e);
+      } catch (Throwable e) {
+        logger.warn("Unable to start dev REST API: {}", e.toString());
-  public void startHttpService(InternalCache cache) {
+  public void startHttpService(InternalCache cache) throws Exception {
-    try {
-      // Check if we're already running inside Tomcat
-      if (isRunningInTomcat()) {
-        logger.warn(
-            "Detected presence of catalina system properties. HTTP service will not be started. To enable the GemFire Developer REST API, please deploy the /geode-web-api WAR file in your application server.");
-      } else if (agentUtil.isAnyWarFileAvailable(gemfireAPIWar)) {
+    // Check if we're already running inside Tomcat
+    if (isRunningInTomcat()) {
+      logger.warn(
+          "Detected presence of catalina system properties. HTTP service will not be started. To enable the GemFire Developer REST API, please deploy the /geode-web-api WAR file in your application server.");
+    } else if (agentUtil.isAnyWarFileAvailable(gemfireAPIWar)) {
-        Pair<String, Object> securityServiceAttr =
-            new ImmutablePair<>(HttpService.SECURITY_SERVICE_SERVLET_CONTEXT_PARAM,
-                securityService);
+      Pair<String, Object> securityServiceAttr =
+          new ImmutablePair<>(HttpService.SECURITY_SERVICE_SERVLET_CONTEXT_PARAM,
+              securityService);
-        HttpService httpService = cache.getHttpService();
-        httpService
-            .addWebApplication("/gemfire-api", gemfireAPIWar, securityServiceAttr);
+      if (cache.getHttpService().isPresent()) {
+        HttpService httpService = cache.getHttpService().get();
+        httpService.addWebApplication("/gemfire-api", gemfireAPIWar, securityServiceAttr);
+      } else {
+        logger.warn("HttpService is not available - could not start Dev REST API");
-    } catch (Exception e) {
-      throw new RuntimeException("HTTP service failed to start due to " + e.getMessage());

MOV43 MOV8 MOV60 MOV25 INS25 INS32 INS8 INS8 UPD43 MOV32 INS42 MOV60 MOV21 MOV21 INS21 UPD42 INS32 UPD42 INS45 INS32 INS42 INS42 INS45 UPD42 INS32 INS42 INS42 INS42 DEL42 DEL42 DEL44 DEL42 DEL43 DEL45 DEL42 DEL42 DEL32 DEL27 DEL14 DEL53 DEL8 DEL12 DEL54 DEL8