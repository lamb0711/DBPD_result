GEODE-4867: Added query time expiration checks. (#1624)

* Along with low memory checks, the query execution time limit is also checked.
+import org.apache.geode.cache.query.QueryExecutionTimeoutException;
-      if (!QueryMonitor.isLowMemory()) {
+      if (!QueryMonitor.isLowMemory() && !this.query.isCanceled()) {
-        String reason =
-            LocalizedStrings.QueryMonitor_LOW_MEMORY_WHILE_GATHERING_RESULTS_FROM_PARTITION_REGION
-                .toLocalizedString();
-        query.setCanceled(true, new QueryExecutionLowMemoryException(reason));
+        if (QueryMonitor.isLowMemory()) {
+          String reason =
+              LocalizedStrings.QueryMonitor_LOW_MEMORY_WHILE_GATHERING_RESULTS_FROM_PARTITION_REGION
+                  .toLocalizedString();
+          query.setCanceled(true, new QueryExecutionLowMemoryException(reason));
+        } else {
+          if (logger.isDebugEnabled()) {
+            logger.debug("query cancelled while gathering results, aborting due to exception "
+                + query.getQueryCanceledException());
+          }
+        }
-      checkLowMemory();
+      checkIfQueryShouldBeCancelled();
-          checkLowMemory();
+          checkIfQueryShouldBeCancelled();
-              checkLowMemory();
+              checkIfQueryShouldBeCancelled();
-  private void checkLowMemory() {
+  private void checkIfQueryShouldBeCancelled() {
+    } else if (query.isCanceled()) {
+      throw query.getQueryCanceledException();

INS26 INS40 UPD42 INS25 INS32 INS8 INS27 INS42 INS42 INS53 MOV38 INS38 INS25 UPD42 INS32 INS32 INS32 INS8 INS8 INS42 INS42 INS22 INS42 INS42 INS42 MOV60 MOV21 INS25 INS52 INS42 INS32 INS8 INS42 INS42 INS21 UPD42 INS32 INS42 INS42 INS27 INS45 INS32 INS42 INS42 UPD42