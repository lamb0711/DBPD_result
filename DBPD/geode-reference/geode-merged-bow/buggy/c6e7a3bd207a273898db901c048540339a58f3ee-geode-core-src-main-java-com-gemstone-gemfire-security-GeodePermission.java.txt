client server

client server

+  public static String ALL_KEYS = "*";
+  public String getKey() {
+    return key;
+  }
+
+  private String key = ALL_KEYS;
-    this(Resource.valueOf(resource), Operation.valueOf(operation));
+    this(resource, operation, ALL_REGIONS);
+  }
+
+  public GeodePermission(String resource, String operation, String regionName) {
+    this(resource, operation, regionName, ALL_KEYS);
+  }
+
+  public GeodePermission(String resource, String operation, String regionName, String key) {
+    this((resource==null) ? Resource.NULL : Resource.valueOf(resource),
+      (operation == null) ? Operation.NULL : Operation.valueOf(operation),
+      regionName,
+      key);
-  public GeodePermission(String resource, String operation, String regionName) {
-    if(resource != null) this.resource = Resource.valueOf(resource);
-    if(operation != null) this.operation = Operation.valueOf(operation);
-    if(regionName != null) this.regionName = regionName;
-
-    setParts(this.resource+":"+this.operation+":"+this.regionName, true);
+  public GeodePermission(Resource resource, Operation operation, String regionName){
+    this(resource, operation, regionName, ALL_KEYS);
-  public GeodePermission(Resource resource, Operation operation, String regionName){
+  public GeodePermission(Resource resource, Operation operation, String regionName, String key){
+    if(key != null) this.key = key;
-    setParts(this.resource+":"+this.operation+":"+this.regionName, true);
+    setParts(this.resource+":"+this.operation+":"+this.regionName+":"+this.key, true);
-    if (ALL_REGIONS.equals(getRegionName())) {
+    if (ALL_REGIONS.equals(regionName)) {
-    } else {
-      return getResource() + ":" + getOperation() + ":" + getRegionName();
+    } else if(ALL_KEYS.equals(key)) {
+      return resource + ":" + operation + ":" + regionName;
+    }
+    else{
+      return resource + ":" + operation + ":" + regionName + ":" + key;

INS23 INS31 INS23 INS31 INS31 INS31 INS83 INS83 INS43 INS59 INS83 INS43 INS42 INS8 INS83 INS43 INS59 INS83 INS42 MOV44 MOV44 INS8 MOV44 MOV44 MOV44 MOV83 MOV42 INS44 INS44 INS44 INS44 INS8 INS83 INS42 INS44 INS44 INS44 INS8 INS44 INS42 INS42 INS45 INS42 INS41 INS42 INS42 INS42 INS17 INS43 INS42 INS43 INS42 INS43 INS42 INS43 INS42 INS17 INS43 INS42 INS43 INS42 INS43 INS42 INS17 INS43 INS42 INS25 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS16 INS16 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS27 INS21 INS25 INS36 INS40 MOV32 INS36 INS40 MOV32 INS42 INS33 INS7 UPD42 MOV42 INS32 MOV8 INS8 INS27 INS27 INS22 INS42 INS45 INS22 INS42 INS42 INS42 INS41 MOV42 MOV33 MOV42 MOV33 INS52 INS42 INS52 INS42 INS27 INS42 INS42 INS42 INS42 INS45 INS42 INS45 INS42 INS45 INS42 DEL42 DEL42 DEL42 DEL32 DEL42 DEL42 DEL42 DEL32 DEL27 DEL52 DEL42 DEL22 DEL7 DEL21 DEL25 DEL27 DEL52 DEL42 DEL22 DEL7 DEL21 DEL25 DEL42 DEL33 DEL27 DEL52 DEL42 DEL22 DEL42 DEL7 DEL21 DEL25 DEL42 DEL52 DEL42 DEL22 DEL45 DEL52 DEL42 DEL22 DEL45 DEL52 DEL42 DEL22 DEL27 DEL9 DEL32 DEL21 DEL8 DEL31 DEL32 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32