GEODE-4833: JdbcWriter and JdbcAsyncWriter may fail to write null fields to database (#1636)

Null values are now supported. Meta-data read from the database is now used to determine the
column type and used to call setNull.

* Renamed TableKeyColumnManager to TableMetaDataManager
* registerPdxMetaData will now throw an exception if the instance is not serialized with PDX

-  private final TableKeyColumnManager tableKeyColumnManager;
+  private final TableMetaDataManager tableMetaDataManager;
-  public SqlHandler(DataSourceManager manager, TableKeyColumnManager tableKeyColumnManager,
+  public SqlHandler(DataSourceManager manager, TableMetaDataManager tableMetaDataManager,
-    this.tableKeyColumnManager = tableKeyColumnManager;
+    this.tableMetaDataManager = tableMetaDataManager;
-    return this.tableKeyColumnManager.getKeyColumnName(connection, tableName);
+    return this.tableMetaDataManager.getTableMetaDataView(connection, tableName).getKeyColumnName();
-      statement.setObject(index, value);
+      if (value == null) {
+        statement.setNull(index, columnValue.getDataType());
+      } else {
+        statement.setObject(index, value);
+      }
-    String keyColumnName = getKeyColumnName(connection, tableName);
-    ColumnValue keyColumnValue = new ColumnValue(true, keyColumnName, key);
+    TableMetaDataView tableMetaData =
+        this.tableMetaDataManager.getTableMetaDataView(connection, tableName);
+    String keyColumnName = tableMetaData.getKeyColumnName();
+    ColumnValue keyColumnValue =
+        new ColumnValue(true, keyColumnName, key, tableMetaData.getColumnDataType(keyColumnName));
-    List<ColumnValue> result = createColumnValueList(regionMapping, value, keyColumnName);
+    List<ColumnValue> result =
+        createColumnValueList(tableMetaData, regionMapping, value, keyColumnName);
-  private List<ColumnValue> createColumnValueList(RegionMapping regionMapping, PdxInstance value,
-      String keyColumnName) {
+  private List<ColumnValue> createColumnValueList(TableMetaDataView tableMetaData,
+      RegionMapping regionMapping, PdxInstance value, String keyColumnName) {
-      ColumnValue columnValue = new ColumnValue(false, columnName, value.getField(fieldName));
+      ColumnValue columnValue = new ColumnValue(false, columnName, value.getField(fieldName),
+          tableMetaData.getColumnDataType(columnName));

UPD43 INS44 UPD42 UPD42 UPD43 UPD42 INS60 INS43 INS42 UPD42 INS32 INS43 MOV43 INS59 MOV43 INS42 UPD42 INS32 INS42 INS25 INS42 UPD42 INS42 INS32 UPD42 MOV22 UPD42 MOV42 MOV42 MOV42 INS27 INS8 INS8 INS22 UPD42 INS42 INS42 MOV43 INS32 INS42 UPD42 INS42 INS33 INS21 MOV21 INS52 INS42 INS42 INS42 INS42 INS32 INS32 INS42 INS42 INS42 INS32 INS42 INS42 INS42 INS42 INS42 DEL32