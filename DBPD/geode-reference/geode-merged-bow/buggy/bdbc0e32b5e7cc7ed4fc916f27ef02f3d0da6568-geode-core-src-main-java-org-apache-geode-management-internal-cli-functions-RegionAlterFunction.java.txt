GEODE-4919: Update the PRConfig (#1666)

        * Before adding any gateway sender or AEQ now do the following
	* Assign buckets to the partition region
	* Update the PartitionRegionConfig for the region with the updated set of gateway senders
	* For Lucene reindex AEQs will be created at this point.
	* Mutators then add the gateway senders to the internal region attributes.
+import java.util.HashSet;
+import org.apache.geode.internal.cache.PartitionedRegion;
+import org.apache.geode.internal.cache.partitioned.PRLocallyDestroyedException;
-    // Alter Gateway Sender Ids
-    if (newGatewaySenderIds != null) {
+    final Set<String> newAsyncEventQueueIds = regionAlterArgs.getAsyncEventQueueIds();
+
+    if (region instanceof PartitionedRegion) {
+      Set<String> senderIds = new HashSet<>();
+      if (newGatewaySenderIds != null) {
+        validateParallelGatewaySenderIDs((PartitionedRegion) region, newGatewaySenderIds);
+        senderIds.addAll(newGatewaySenderIds);
+      } else if (region.getGatewaySenderIds() != null) {
+        senderIds.addAll(region.getAllGatewaySenderIds());
+      }
+      if (newAsyncEventQueueIds != null) {
+        validateParallelGatewaySenderIDs((PartitionedRegion) region, newAsyncEventQueueIds);
+        senderIds.addAll(newAsyncEventQueueIds);
+      } else if (region.getAsyncEventQueueIds() != null) {
+        senderIds.addAll(region.getAsyncEventQueueIds());
+      }
+      ((PartitionedRegion) region).updatePRConfigWithNewSetOfGatewaySenders(senderIds);
+    }
+
+    // Alter Gateway Sender Ids
+    if (newGatewaySenderIds != null) {
-    final Set<String> newAsyncEventQueueIds = regionAlterArgs.getAsyncEventQueueIds();
+  private void validateParallelGatewaySenderIDs(PartitionedRegion region,
+      Set<String> newGatewaySenderIds) {
+    try {
+      Set<String> parallelSenders = region.filterOutNonParallelGatewaySenders(newGatewaySenderIds);
+      region.validateParallelGatewaySenderIds(parallelSenders);
+    } catch (PRLocallyDestroyedException e) {
+      throw new IllegalStateException("Partitioned Region not found registered", e);
+    }
+  }
+

INS26 INS26 INS26 INS40 INS40 INS40 INS31 MOV25 INS83 INS39 INS42 INS44 INS44 INS8 INS25 INS43 INS42 INS74 INS42 INS54 INS62 INS8 INS42 INS43 INS43 INS8 INS12 INS42 INS43 INS60 INS25 INS25 INS21 INS42 INS42 INS60 INS21 INS44 INS8 INS42 INS74 INS59 INS27 INS8 INS25 INS27 INS8 INS25 INS32 INS74 INS59 INS32 INS43 INS42 INS53 INS43 INS43 INS42 INS14 INS42 INS33 INS21 INS21 INS27 INS8 INS42 INS33 INS21 INS21 INS27 INS8 INS36 INS42 INS42 INS43 INS43 INS42 INS32 INS42 INS42 INS42 INS42 INS14 INS42 INS42 INS74 INS32 INS32 INS32 INS33 INS21 INS32 INS32 INS32 INS33 INS21 INS11 INS42 INS42 INS42 INS42 INS42 INS43 INS45 INS42 INS43 INS42 INS11 INS42 INS42 INS42 INS42 INS42 INS42 INS32 INS42 INS11 INS42 INS42 INS42 INS42 INS42 INS42 INS32 INS43 INS42 INS42 INS42 INS43 INS42 INS42 INS42 INS32 INS43 INS42 INS42 INS42 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS42