GEODE-17: Integrated Security Related Changes for Pulse and Refactor interface

+import com.gemstone.gemfire.distributed.internal.DistributionConfig;
+import com.gemstone.gemfire.management.internal.security.JSONAuthorization;
+import com.gemstone.gemfire.management.internal.security.MBeanServerWrapper;
+import com.gemstone.gemfire.management.internal.security.ManagementInterceptor;
-
-import java.io.IOException;
-import java.net.Inet4Address;
-import java.net.Inet6Address;
-import java.net.InetAddress;
-import java.net.UnknownHostException;
-import java.util.Set;
+import org.json.JSONException;
+import java.io.IOException;
+import java.net.Inet4Address;
+import java.net.Inet6Address;
+import java.net.InetAddress;
+import java.net.UnknownHostException;
+import java.util.Properties;
+import java.util.Set;
-  public Server(int port, String properties) throws IOException {
+  public Server(int port, String properties, boolean secure) throws IOException, JSONException {
+    Properties props = new Properties();
+    props.put(DistributionConfig.SECURITY_CLIENT_AUTHENTICATOR_NAME, JSONAuthorization.class.getName() + ".create");
+    props.put(DistributionConfig.SECURITY_CLIENT_ACCESSOR_NAME, JSONAuthorization.class.getName() + ".create");
+    JSONAuthorization.setUpWithJsonFile("cacheServer.json");
+    ManagementInterceptor interceptor = new ManagementInterceptor(props);
+    MBeanServerWrapper wrapper = new MBeanServerWrapper(interceptor);
+
+    if(secure){
+      //System.setProperty(JMXConnectorServer.AUTHENTICATOR, interceptor);
+    }
+
+
+    if(secure) {
+      cs.setMBeanServerForwarder(wrapper);
+    }
+
-      s = new Server(port, properties);
+      s = new Server(port, properties, true);
