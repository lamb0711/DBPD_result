GEODE-4404: Move BackupWriter creation (#1521)

  * to facilitate future creation of backup plugins, the BackupWriter is created
    using generic information passed from gfsh

-import java.io.File;
+import static org.apache.geode.internal.cache.backup.AbstractBackupWriterConfig.TYPE;
+
+import java.util.Properties;
-      Set<InternalDistributedMember> recipients, int processorId, File targetDir,
-      File baselineDir) {
-    return new PrepareBackupRequest(sender, recipients, processorId, this, targetDir, baselineDir);
+      Set<InternalDistributedMember> recipients, int processorId, Properties properties) {
+    return new PrepareBackupRequest(sender, recipients, processorId, this, properties);
-      File targetDir, File baselineDir) {
-    return new PrepareBackup(member, cache, targetDir, baselineDir);
+      Properties properties) {
+    String memberId = cleanSpecialCharacters(member.toString());
+    BackupWriter backupWriter = BackupWriterFactory.getFactoryForType(properties.getProperty(TYPE))
+        .createWriter(properties, memberId);
+    return new PrepareBackup(member, cache, backupWriter);
+
+  private String cleanSpecialCharacters(String string) {
+    return string.replaceAll("[^\\w]+", "_");
+  }
