GEODE-6854: Skipped events already contained in the batch during conflation


+      if (logger.isDebugEnabled()) {
+        logEvents("original", events);
+      }
-          // Attempt to remove the key. If the entry is removed, that means a
-          // duplicate key was found. If not, this is a no-op.
-          conflatedEventsMap.remove(key);
+          // Get the entry at that key
+          GatewaySenderEventImpl existingEvent = conflatedEventsMap.get(key);
+          if (!gsEvent.equals(existingEvent)) {
+            // Attempt to remove the key. If the entry is removed, that means a
+            // duplicate key was found. If not, this is a no-op.
+            conflatedEventsMap.remove(key);
-          // Add the key to the end of the map.
-          conflatedEventsMap.put(key, gsEvent);
+            // Add the key to the end of the map.
+            conflatedEventsMap.put(key, gsEvent);
+          }
+      if (logger.isDebugEnabled()) {
+        logEvents("conflated", conflatedEvents);
+      }
+  private void logEvents(String message, List<GatewaySenderEventImpl> events) {
+    StringBuilder builder = new StringBuilder();
+    builder.append("The batch contains the following ").append(events.size()).append(" ")
+        .append(message).append(" events:");
+    for (GatewaySenderEventImpl event : events) {
+      builder.append("\t\n").append(event.toSmallString());
+    }
+    logger.debug(builder);
+  }
+
