GEODE-857: Fixing synchronization in SystemFailure.stopWatchDog

Don't join the watchDog thread or the proctor thread while holding the
failureSync lock.

Adding a unit test for SystemFailure.stopThreads.

+   * Time to wait during stopWatchdog and stopProctor. Not final
+   * for tests
+   */
+  static int SHUTDOWN_WAIT = 1000;
+  /**
+    Thread watchDogSnapshot = null;
+        watchDogSnapshot = watchDog;
+      }
+    }
+    if(watchDogSnapshot != null) {
+      try {
+        watchDogSnapshot.join(100);
+      } catch (InterruptedException ignore) {
+      }
+      if (watchDogSnapshot.isAlive()) {
+        watchDogSnapshot.interrupt();
-          watchDog.join(100);
+          watchDogSnapshot.join(SHUTDOWN_WAIT);
-        if (watchDog.isAlive()) {
-          watchDog.interrupt();
-          try {
-            watchDog.join(1000);
-          } catch (InterruptedException ignore) {
-          }
-        }
-      watchDog = null;
+    Thread proctorSnapshot = null;
-      if (proctor != null && proctor.isAlive()) {
-        proctor.interrupt();
-        try {
-          proctor.join(1000);
-        } catch (InterruptedException ignore) {
-        }
+      proctorSnapshot = proctor;
+    }
+    if (proctorSnapshot != null && proctorSnapshot.isAlive()) {
+      proctorSnapshot.interrupt();
+      try {
+        proctorSnapshot.join(SHUTDOWN_WAIT);
+      } catch (InterruptedException ignore) {
-      proctor = null;
+  
+  static Thread getWatchDogForTest() {
+    return watchDog;
+  }
+  
+  static Thread getProctorForTest() {
+    return proctor;
+  }
