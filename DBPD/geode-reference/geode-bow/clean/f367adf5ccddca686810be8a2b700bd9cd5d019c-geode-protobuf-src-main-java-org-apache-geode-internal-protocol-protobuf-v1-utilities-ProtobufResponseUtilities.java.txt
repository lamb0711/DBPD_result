Merge branch 'develop' of https://github.com/apache/geode into feature/GEODE-4528

-import org.apache.geode.internal.protocol.protobuf.v1.ProtobufErrorCode;
+import org.apache.geode.internal.protocol.protobuf.v1.serialization.exception.DecodingException;
+import org.apache.geode.internal.protocol.protobuf.v1.serialization.exception.EncodingException;
-  public static ClientProtocol.ErrorResponse makeErrorResponse(ProtobufErrorCode errorCode,
+  public static ClientProtocol.ErrorResponse makeErrorResponse(BasicTypes.ErrorCode errorCode,
-        .setError(BasicTypes.Error.newBuilder()
-            .setErrorCode(ProtobufUtilities.getProtobufErrorCode(errorCode)).setMessage(message))
+        .setError(BasicTypes.Error.newBuilder().setErrorCode(errorCode).setMessage(message))
+
+  public static ClientProtocol.ErrorResponse makeErrorResponse(Exception exception) {
+    if (exception instanceof ConnectionStateException) {
+      return makeErrorResponse((ConnectionStateException) exception);
+    }
+    return ClientProtocol.ErrorResponse
+        .newBuilder().setError(BasicTypes.Error.newBuilder()
+            .setErrorCode(BasicTypes.ErrorCode.SERVER_ERROR).setMessage(exception.toString()))
+        .build();
+  }
+
