Merge branch 'develop' into feature/GEODE-420

# Conflicts:
#	geode-core/src/test/resources/com/gemstone/gemfire/codeAnalysis/excludedClasses.txt

+import org.apache.geode.security.SecurableComponents;
-import org.apache.shiro.authc.UsernamePasswordToken;
-import org.apache.geode.security.SecurableComponents;
+import com.gemstone.gemfire.internal.security.shiro.GeodeAuthenticationToken;
+import com.gemstone.gemfire.management.internal.security.ResourceConstants;
+   * convenient method for testing
+   * @param username
+   * @param password
+   * @return
+   */
+  public static Subject login(String username, String password){
+    if(StringUtils.isBlank(username) || StringUtils.isBlank(password))
+      return null;
+
+    Properties credentials = new Properties();
+    credentials.setProperty(ResourceConstants.USER_NAME, username);
+    credentials.setProperty(ResourceConstants.PASSWORD, password);
+    return login(credentials);
+  }
+
+  /**
-  public static Subject login(String username, String password) {
+  public static Subject login(Properties credentials) {
+    if(credentials == null)
+      return null;
+
-
-    UsernamePasswordToken token =
-      new UsernamePasswordToken(username, password);
+    GeodeAuthenticationToken token = new GeodeAuthenticationToken(credentials);
-      logger.info("Logging in " + username);
+      logger.info("Logging in " + token.getPrincipal());
-      throw new AuthenticationFailedException("Authentication error. Please check your username/password.", e);
+      throw new AuthenticationFailedException("Authentication error. Please check your credentials.", e);
