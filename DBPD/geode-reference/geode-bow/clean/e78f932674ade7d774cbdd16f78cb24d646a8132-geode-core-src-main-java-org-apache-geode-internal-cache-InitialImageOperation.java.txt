GEODE-6497: Send failed message to image requester when provider is shutting down. (#3279)


-      InternalCache cache = dm.getCache();
-      lclRgn = cache == null ? null : (LocalRegion) cache.getRegionByPath(regionPath);
+      InternalCache cache = dm.getExistingCache();
+      lclRgn = cache == null ? null : (LocalRegion) cache.getRegion(regionPath);
-          // null chunk signals receiver that we are aborting
-          ImageReplyMessage.send(getSender(), processorId, rex, dm, null, 0, 0, 1, true, 0, false,
-              null, null);
+          sendFailureMessage(dm, rex);
+    void sendFailureMessage(ClusterDistributionManager dm, ReplyException rex) {
+      // null chunk signals receiver that we are aborting
+      ImageReplyMessage.send(getSender(), processorId, rex, dm, null, 0, 0, 1, true, 0, false,
+          null, null);
+    }
+
