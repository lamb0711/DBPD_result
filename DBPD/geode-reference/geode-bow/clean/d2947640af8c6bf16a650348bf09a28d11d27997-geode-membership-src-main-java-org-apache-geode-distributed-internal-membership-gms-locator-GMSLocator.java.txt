GEODE-7652: MembershipBuilder lets you set the local locator (#4614)


-import org.apache.geode.distributed.internal.membership.api.Membership;
-import org.apache.geode.distributed.internal.membership.gms.GMSMembership;
-  public synchronized boolean setMembership(Membership<ID> membership) {
-    if (services == null || services.isStopped()) {
-      services = ((GMSMembership<ID>) membership).getServices();
-      localAddress = services.getMessenger().getMemberID();
+  /**
+   * Called initially and after each auto-reconnect. See restart handlers in InternalLocator
+   * up in geode-core. Services must be started before this call.
+   *
+   */
+  public synchronized boolean setServices(
+      final Services<ID> services) {
+    if (this.services == null || this.services.isStopped()) {
+      this.services = services;
+      localAddress = this.services.getMessenger().getMemberID();
-      services.setLocator(this);
-      GMSMembershipView<ID> newView = services.getJoinLeave().getView();
+      GMSMembershipView<ID> newView = this.services.getJoinLeave().getView();
