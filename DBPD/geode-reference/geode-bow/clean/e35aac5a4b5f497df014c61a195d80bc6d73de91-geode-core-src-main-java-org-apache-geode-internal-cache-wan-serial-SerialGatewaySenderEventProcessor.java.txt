Merge branch 'release/1.5.0'

-import java.util.concurrent.RejectedExecutionException;
+import org.apache.geode.cache.Operation;
+          if (logger.isDebugEnabled()) {
+            logger.debug("releaseUnprocessedEvents:" + gatewayEvent);
+          }
-          senderEvent = new GatewaySenderEventImpl(operation, event, substituteValue, false); // OFFHEAP
-                                                                                              // ok
-          handleSecondaryEvent(senderEvent);
+          // 2 Special cases:
+          // 1) UPDATE_VERSION_STAMP: only enqueue to primary
+          // 2) CME && !originRemote: only enqueue to primary
+          if (!(event.getOperation().equals(Operation.UPDATE_VERSION_STAMP)
+              || ((EntryEventImpl) event).isConcurrencyConflict() && !event.isOriginRemote())) {
+            senderEvent = new GatewaySenderEventImpl(operation, event, substituteValue, false); // OFFHEAP
+            handleSecondaryEvent(senderEvent);
+          }
-      try {
-        my_executor.execute(new Runnable() {
-          public void run() {
-            basicHandlePrimaryEvent(gatewayEvent);
-          }
-        });
-      } catch (RejectedExecutionException ex) {
-        throw ex;
-      }
+      my_executor.execute(new Runnable() {
+        public void run() {
+          basicHandlePrimaryEvent(gatewayEvent);
+        }
+      });
-      try {
-        my_executor.execute(new Runnable() {
-          public void run() {
-            basicHandlePrimaryDestroy(gatewayEvent);
-          }
-        });
-      } catch (RejectedExecutionException ex) {
-        throw ex;
-      }
+      my_executor.execute(new Runnable() {
+        public void run() {
+          basicHandlePrimaryDestroy(gatewayEvent);
+        }
+      });
