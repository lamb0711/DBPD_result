Merge branch 'release/1.5.0'

+import static org.apache.geode.internal.cache.backup.AbstractBackupWriterConfig.TYPE;
+
+import java.util.Properties;
-import org.apache.geode.distributed.internal.DM;
+import org.apache.geode.distributed.internal.DistributionManager;
-  BackupReplyProcessor createReplyProcessor(BackupResultCollector resultCollector, DM dm,
-      Set<InternalDistributedMember> recipients) {
+  BackupReplyProcessor createReplyProcessor(BackupResultCollector resultCollector,
+      DistributionManager dm, Set<InternalDistributedMember> recipients) {
-      Set<InternalDistributedMember> recipients, int processorId) {
-    return new PrepareBackupRequest(sender, recipients, processorId, this);
+      Set<InternalDistributedMember> recipients, int processorId, Properties properties) {
+    return new PrepareBackupRequest(sender, recipients, processorId, this, properties);
-  PrepareBackup createPrepareBackup(InternalDistributedMember member, InternalCache cache) {
-    return new PrepareBackup(member, cache);
+  PrepareBackup createPrepareBackup(InternalDistributedMember member, InternalCache cache,
+      Properties properties) {
+    String memberId = cleanSpecialCharacters(member.toString());
+    BackupWriter backupWriter = BackupWriterFactory.getFactoryForType(properties.getProperty(TYPE))
+        .createWriter(properties, memberId);
+    return new PrepareBackup(member, cache, backupWriter);
+
+  private String cleanSpecialCharacters(String string) {
+    return string.replaceAll("[^\\w]+", "_");
+  }
