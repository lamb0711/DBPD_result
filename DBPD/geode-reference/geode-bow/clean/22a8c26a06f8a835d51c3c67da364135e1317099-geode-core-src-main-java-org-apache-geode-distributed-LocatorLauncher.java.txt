GEODE-7345: break dependency on SocketCreator (#4322)


+import static org.apache.geode.distributed.internal.membership.adapter.SocketCreatorAdapter.asTcpSocketCreator;
-import org.apache.geode.distributed.internal.DistributionConfigImpl;
+import org.apache.geode.distributed.internal.tcpserver.TcpSocketCreator;
+import org.apache.geode.internal.admin.SSLConfig;
+import org.apache.geode.internal.net.SSLConfigurationFactory;
+import org.apache.geode.internal.security.SecurableCommunicationChannel;
-    // final int timeout = (60 * 2 * 1000); // 2 minutes
-    final int timeout = Integer.MAX_VALUE; // 2 minutes
-
-    try {
-      TcpClient client = new TcpClient(new DistributionConfigImpl(new Properties()));
-      return (LocatorStatusResponse) client.requestToServer(bindAddress, port,
-          new LocatorStatusRequest(), timeout, true);
-    } catch (ClassNotFoundException e) {
-      throw new RuntimeException(e);
-    }
+    return statusLocator(port, bindAddress, new Properties());
+    return statusLocator(port, bindAddress, getProperties());
+  }
+
+  private static LocatorStatusResponse statusLocator(
+      final int port, InetAddress bindAddress,
+      final Properties properties)
+      throws IOException {
+
-      TcpClient client = new TcpClient(new DistributionConfigImpl(getProperties()));
+
+      final SSLConfig sslConfig = SSLConfigurationFactory.getSSLConfigForComponent(
+          properties,
+          SecurableCommunicationChannel.LOCATOR);
+      final TcpSocketCreator socketCreator = asTcpSocketCreator(new SocketCreator(sslConfig));
+      final TcpClient client = new TcpClient(socketCreator);
+
