GEODE-5485: Make CacheRule use Properties additively

-  private Properties config() {
-    if (replaceConfig) {
-      return config;
-    }
-    Properties allConfig = getDistributedSystemProperties();
-    allConfig.putAll(config);
-    return allConfig;
-  }
-
-    cache = (InternalCache) new CacheFactory(config).create();
+    cache = (InternalCache) new CacheFactory(config(config)).create();
-    cache = (InternalCache) new CacheFactory(config).create();
+    cache = (InternalCache) new CacheFactory(config(config)).create();
+  public InternalCache getOrCreateCache(final CacheFactory cacheFactory) {
+    if (cache == null || cache.isClosed()) {
+      cache = null;
+      createCache(cacheFactory);
+      assertThat(cache).isNotNull();
+    }
+    return cache;
+  }
+
+  public InternalCache getOrCreateCache(final Properties config) {
+    if (cache == null || cache.isClosed()) {
+      cache = null;
+      createCache(config);
+      assertThat(cache).isNotNull();
+    }
+    return cache;
+  }
+
+  public InternalCache getOrCreateCache(final Properties config,
+      final Properties systemProperties) {
+    if (cache == null || cache.isClosed()) {
+      cache = null;
+      createCache(config, systemProperties);
+      assertThat(cache).isNotNull();
+    }
+    return cache;
+  }
+
+  private Properties config() {
+    return config(new Properties());
+  }
+
+  private Properties config(final Properties config) {
+    if (replaceConfig) {
+      return config;
+    }
+    Properties allConfig = getDistributedSystemProperties();
+    allConfig.putAll(this.config);
+    allConfig.putAll(config);
+    return allConfig;
+  }
+
