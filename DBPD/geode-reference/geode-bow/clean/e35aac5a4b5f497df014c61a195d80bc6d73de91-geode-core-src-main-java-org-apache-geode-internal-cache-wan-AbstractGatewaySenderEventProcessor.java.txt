Merge branch 'release/1.5.0'

-  public static boolean TEST_HOOK = false;
-
+  /**
+   * Cumulative count of events dispatched by this event processor.
+   */
-            if (TEST_HOOK) {
-              this.numEventsDispatched += conflatedEventsToBeDispatched.size();
-            }
+
+            increaseNumEventsDispatched(conflatedEventsToBeDispatched.size());
-  private List conflate(List<GatewaySenderEventImpl> events) {
+  public List conflate(List<GatewaySenderEventImpl> events) {
-              gsEvent.getKeyToConflate(), gsEvent.getOperation());
+              gsEvent.getKeyToConflate(), gsEvent.getOperation(), gsEvent.getShadowKey());
+
+  public void increaseNumEventsDispatched(long newEventsDispatched) {
+    this.numEventsDispatched += newEventsDispatched;
+  }
+
+    private long shadowKey;
+
+      this(region, key, operation, -1);
+    }
+
+    private ConflationKey(String region, Object key, Operation operation, long shadowKey) {
+      this.shadowKey = shadowKey;
+      result = prime * result + Long.hashCode(this.shadowKey);
+      if (this.shadowKey != that.shadowKey) {
+        return false;
+      }
