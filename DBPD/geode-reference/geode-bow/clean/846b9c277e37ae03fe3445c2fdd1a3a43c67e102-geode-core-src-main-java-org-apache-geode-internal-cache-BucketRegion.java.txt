GEODE-6762: Prevent unnecessary PartitionedRegion callback events



-  private EntryEventImpl createEventForPR(EntryEventImpl sourceEvent) {
+  EntryEventImpl createEventForPR(EntryEventImpl sourceEvent) {
-
+  private boolean skipPrEvent(final EntryEventImpl event, final boolean callDispatchListenerEvent) {
+    if (!event.isGenerateCallbacks()) {
+      return true;
+    }
+    boolean needsPrEvent = (partitionedRegion.isInitialized() && callDispatchListenerEvent
+        && partitionedRegion.shouldDispatchListenerEvent())
+        || CacheClientNotifier.singletonHasClientProxies();
+    if (!needsPrEvent) {
+      return true;
+    }
+    return false;
+  }
+
+    if (skipPrEvent(event, callDispatchListenerEvent)) {
+      return;
+    }
+
-    final EntryEventImpl prevent = createEventForPR(event);
+    final EntryEventImpl prEvent = createEventForPR(event);
-      partitionedRegion.invokeTXCallbacks(eventType, prevent,
+      partitionedRegion.invokeTXCallbacks(eventType, prEvent,
-      prevent.release();
+      prEvent.release();
+
+    if (skipPrEvent(event, callDispatchListenerEvent)) {
+      return;
+    }
+
-    final EntryEventImpl prevent = createEventForPR(event);
+    final EntryEventImpl prEvent = createEventForPR(event);
-      partitionedRegion.invokeDestroyCallbacks(eventType, prevent,
+      partitionedRegion.invokeDestroyCallbacks(eventType, prEvent,
-      prevent.release();
+      prEvent.release();
+
+    if (skipPrEvent(event, callDispatchListenerEvent)) {
+      return;
+    }
+
-    final EntryEventImpl prevent = createEventForPR(event);
+    final EntryEventImpl prEvent = createEventForPR(event);
-      partitionedRegion.invokeInvalidateCallbacks(eventType, prevent,
+      partitionedRegion.invokeInvalidateCallbacks(eventType, prEvent,
-      prevent.release();
+      prEvent.release();
+    if (skipPrEvent(event, callDispatchListenerEvent)) {
+      return;
+    }
+
-    final EntryEventImpl prevent = createEventForPR(event);
+    final EntryEventImpl prEvent = createEventForPR(event);
-      partitionedRegion.invokePutCallbacks(eventType, prevent,
+      partitionedRegion.invokePutCallbacks(eventType, prEvent,
-      prevent.release();
+      prEvent.release();
