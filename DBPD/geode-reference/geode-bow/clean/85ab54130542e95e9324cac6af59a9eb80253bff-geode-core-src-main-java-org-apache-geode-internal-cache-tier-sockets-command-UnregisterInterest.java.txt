GEODE-8359 (#5371)

GEODE-8359: Code needed protection against the possibility of the null being returned.

There was also a fair amount of inconsistency between files that are very tightly related.

-  public void cmdExecute(final Message clientMessage, final ServerConnection serverConnection,
-      final SecurityService securityService, long start)
+  public void cmdExecute(Message clientMessage, ServerConnection serverConnection,
+      SecurityService securityService, long start)
-    Part regionNamePart = null, keyPart = null;
-    String regionName = null;
-    Object key = null;
-    int interestType = 0;
+    Part regionNamePart, keyPart;
+    String regionName;
+    Object key;
+    int interestType;
-    boolean keepalive = false;
+    boolean keepAlive;
-      Part keepalivePart = clientMessage.getPart(4);
-      byte[] keepaliveBytes = (byte[]) keepalivePart.getObject();
-      keepalive = keepaliveBytes[0] != 0x00;
+      Part keepAlivePart = clientMessage.getPart(4);
+      byte[] keepAliveBytes = (byte[]) keepAlivePart.getObject();
+      keepAlive = keepAliveBytes[0] != 0x00;
-      errMessage =
-          "The input region name and key for the unregister interest request are null.";
+      errMessage = "The input region name and key for the unregister interest request are null.";
-      errMessage =
-          "The input key for the unregister interest request is null.";
+      errMessage = "The input key for the unregister interest request is null.";
-      errMessage =
-          "The input region name for the unregister interest request is null.";
-      String s = errMessage;
-      logger.warn("{}: {}", serverConnection.getName(), s);
-      writeErrorResponse(clientMessage, MessageType.UNREGISTER_INTEREST_DATA_ERROR, s,
+      errMessage = "The input region name for the unregister interest request is null.";
+    }
+
+    if (errMessage != null) {
+      logger.warn("{}: {}", serverConnection.getName(), errMessage);
+      writeErrorResponse(clientMessage, MessageType.UNREGISTER_INTEREST_DATA_ERROR, errMessage,
-    AuthorizeRequest authzRequest = serverConnection.getAuthzRequest();
-    if (authzRequest != null) {
+    AuthorizeRequest authorizeRequest = serverConnection.getAuthzRequest();
+    if (authorizeRequest != null) {
-              authzRequest.unregisterInterestAuthorize(regionName, key, interestType);
+              authorizeRequest.unregisterInterestAuthorize(regionName, key, interestType);
-    // Yogesh : bug fix for 36457 :
-    /*
-     * Region destroy message from server to client results in client calling unregister to server
-     * (an unnecessary callback). The unregister encounters an error because the region has been
-     * destroyed on the server and hence falsely marks the server dead.
-     */
-    /*
-     * Region region = crHelper.getRegion(regionName); if (region == null) {
-     * logger.warning(this.name + ": Region named " + regionName + " was not found during unregister
-     * interest request"); writeErrorResponse(msg, MessageType.UNREGISTER_INTEREST_DATA_ERROR);
-     * responded = true; } else {
-     */
-    // Unregister interest irrelevant of whether the region is present it or
-    // not
-    serverConnection.getAcceptor().getCacheClientNotifier().unregisterClientInterest(regionName,
-        key, interestType, isClosing, serverConnection.getProxyID(), keepalive);
-    // Update the statistics and write the reply
-    // bserverStats.incLong(processDestroyTimeId,
-    // DistributionStats.getStatTime() - start);
-    // start = DistributionStats.getStatTime();
+    serverConnection.getAcceptor().getCacheClientNotifier().unregisterClientInterest(regionName,
+        key, interestType, isClosing, serverConnection.getProxyID(), keepAlive);
+
-    // bserverStats.incLong(writeDestroyResponseTimeId,
-    // DistributionStats.getStatTime() - start);
-    // bserverStats.incInt(destroyResponsesId, 1);
-    // }
-
