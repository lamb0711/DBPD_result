GEODE-5288: fix execute function on region call and create more tests to improve coverage. (#2024)

Co-authored-by: Michael Oleske <moleske@pivotal.io>
Co-authored-by: Finn Southerland <fsoutherland@pivotal.io>
-      List<CliFunctionResult> functionResults, boolean skipIgnored) {
+      List<CliFunctionResult> functionResults, boolean ignoreIgnorable,
+      boolean ignorePartialFailure) {
+    boolean atLeastOneFailure = false;
-      section.addRow(functionResult.getMemberIdOrName(), functionResult.getStatus(skipIgnored),
+      section.addRow(functionResult.getMemberIdOrName(), functionResult.getStatus(ignoreIgnorable),
-      } else if (functionResult.isIgnorableFailure() && skipIgnored) {
+      } else if (functionResult.isIgnorableFailure() && ignoreIgnorable) {
+      } else if (functionResult.isIgnorableFailure() && !ignoreIgnorable) {
+        atLeastOneFailure = true;
+      } else if (!functionResult.isSuccessful()) {
+        atLeastOneFailure = true;
-    setStatus(atLeastOneSuccess ? Result.Status.OK : Result.Status.ERROR);
+    if (ignorePartialFailure) {
+      setStatus(atLeastOneSuccess ? Result.Status.OK : Result.Status.ERROR);
+    } else {
+      setStatus(atLeastOneFailure ? Result.Status.ERROR : Result.Status.OK);
+    }
+
+
-      boolean ignoreIfFailed) {
-    return createMemberStatusResult(functionResults, null, null, ignoreIfFailed);
+      boolean ignoreIgnorable, boolean ignorePartialFailure) {
+    return createMemberStatusResult(functionResults, null, null, ignoreIgnorable,
+        ignorePartialFailure);
+  // this ignores the partial failure, but does not ignore the ignorable, if at least one success,
+  // the command status is success
-    return createMemberStatusResult(functionResults, null, null, false);
+    return createMemberStatusResult(functionResults, null, null, false, true);
+  // this ignores the partial failure, if at least one function result is successful, the command
+  // status is set to be successful
+  public static ResultModel createMemberStatusResult(List<CliFunctionResult> functionResults,
+      boolean ignoreIgnorable) {
+    return createMemberStatusResult(functionResults, null, null, ignoreIgnorable, true);
+  }
+
+
-      String header, String footer, boolean ignoreIfFailed) {
+      String header, String footer, boolean ignoreIgnorable, boolean ignorePartialFailure) {
-        result.addTableAndSetStatus(MEMBER_STATUS_SECTION, functionResults, ignoreIfFailed);
+        result.addTableAndSetStatus(MEMBER_STATUS_SECTION, functionResults, ignoreIgnorable,
+            ignorePartialFailure);
