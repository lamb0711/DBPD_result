GEODE-7828: Convert backing store for Redis Hashes and Sets to single regions (#4781)

* Revert "Revert "GEODE-7828: Convert backing store for Redis Hashes and Sets to single regions (#4745)" (#4780)"

This reverts commit f0982cdedf1b122f734919d0647434cca33ec254.

* Fix sporadic test failures for concurrent HSetNX
+import java.util.Set;
-    @SuppressWarnings("unchecked")
-    Region<ByteArrayWrapper, Boolean> keyRegion =
-        (Region<ByteArrayWrapper, Boolean>) context.getRegionProvider().getRegion(key);
-    if (keyRegion == null) {
+
+    Region<ByteArrayWrapper, Set<ByteArrayWrapper>> region = getRegion(context);
+    Set<ByteArrayWrapper> set = region.get(key);
+
+    if (set == null) {
-        (List<ByteArrayWrapper>) getIteration(new ArrayList(keyRegion.keySet()), matchPattern,
+        (List<ByteArrayWrapper>) getIteration(new ArrayList<>(set), matchPattern,
+  private Region<ByteArrayWrapper, Set<ByteArrayWrapper>> getRegion(
+      ExecutionHandlerContext context) {
+    return context.getRegionProvider().getSetRegion();
+  }
+
-    List<Object> returnList = new ArrayList<Object>();
+    List<Object> returnList = new ArrayList<>();
-      } else
+      } else {
+      }
-    if (i == size - 1)
+    if (i == size - 1) {
-    else
+    } else {
+    }
