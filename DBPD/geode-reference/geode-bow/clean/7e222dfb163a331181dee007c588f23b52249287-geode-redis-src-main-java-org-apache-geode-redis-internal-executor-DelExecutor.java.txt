GEODE-8147: change redis DELETE and EXISTS to use Function+Delta (#5128)

Co-authored-by: Sarah <mboxwala@pivotal.io>
Co-authored-by: Sarah <sabbey@pivotal.io>
-import org.apache.geode.redis.internal.RedisConstants.ArityDef;
-import org.apache.geode.redis.internal.RedisDataType;
-    List<byte[]> commandElems = command.getProcessedCommand();
-    if (commandElems.size() < 2) {
-      command.setResponse(Coder.getErrorResponse(context.getByteBufAllocator(), ArityDef.DEL));
-      return;
-    }
+    List<ByteArrayWrapper> commandElems = command.getProcessedCommandWrappers();
-    int numRemoved = 0;
-
-    for (int i = 1; i < commandElems.size(); i++) {
-      byte[] byteKey = commandElems.get(i);
-      ByteArrayWrapper key = new ByteArrayWrapper(byteKey);
-      RedisDataType type = context.getKeyRegistrar().getType(key);
-      if (removeEntry(key, type, context)) {
-        numRemoved++;
-      }
-    }
+    long numRemoved = commandElems
+        .subList(1, commandElems.size())
+        .stream()
+        .filter((key) -> new RedisKeyCommandsFunctionExecutor(
+            context.getRegionProvider().getDataRegion()).del(key))
+        .count();
-
