GEODE-3974: Core function security improvement (#1310)



+import java.util.Collection;
+import java.util.Collections;
+
-import org.apache.geode.cache.execute.FunctionAdapter;
+import org.apache.geode.cache.execute.Function;
-import org.apache.geode.internal.cache.tier.sockets.ClientProxyMembershipID;
+import org.apache.geode.management.internal.security.ResourcePermissions;
+import org.apache.geode.security.ResourcePermission;
-public class CloseDurableCqFunction extends FunctionAdapter implements InternalEntity {
+public class CloseDurableCqFunction implements Function, InternalEntity {
-    final Cache cache = CliUtil.getCacheIfExists();
+    final Cache cache = context.getCache();
+  public Collection<ResourcePermission> getRequiredPermissions(String regionName) {
+    return Collections.singleton(ResourcePermissions.CLUSTER_MANAGE_QUERY);
+  }
+
+  @Override
