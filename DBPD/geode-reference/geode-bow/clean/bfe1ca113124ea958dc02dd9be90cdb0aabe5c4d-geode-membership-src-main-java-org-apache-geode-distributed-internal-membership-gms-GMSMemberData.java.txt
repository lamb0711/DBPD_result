GEODE-8240: Member Identifier Future Versions

Inability of member identifiers to hold future versions caused 
problems in rolling upgrades. Now member identifiers hang on 
to a VersionOrdinal which is a base type for Version "enum".
-import org.apache.geode.internal.serialization.UnsupportedSerializationVersionException;
+import org.apache.geode.internal.serialization.VersionOrdinal;
+import org.apache.geode.internal.serialization.Versioning;
-  private transient Version versionObj = Version.CURRENT;
+
+  /**
+   * versionOrdinal is stored here as a VersionOrdinal and not a Version, because
+   * GMSMemberData needs to sometimes store the version of a new product version,
+   * e.g. during rolling upgrade members with old versions receive member identifiers
+   * from members with new (unknown) versions.
+   */
+  private transient VersionOrdinal versionOrdinal =
+      Versioning.getVersionOrdinal(Version.CURRENT.ordinal());
-   * @param version the member's version ordinal
+   * @param versionOrdinal the member's version ordinal
-      short version,
+      short versionOrdinal,
-    setVersionObject(version);
+    this.versionOrdinal = Versioning.getVersionOrdinal(versionOrdinal);
-  private void setVersionObject(short versionOrdinal) {
-    try {
-      this.versionObj = Version.fromOrdinal(versionOrdinal);
-    } catch (UnsupportedSerializationVersionException e) {
-      this.versionObj = Version.CURRENT;
-    }
-  }
-
-  public GMSMemberData(InetAddress i, int p, short version, long msbs, long lsbs, int viewId) {
+  public GMSMemberData(InetAddress i, int p, short versionOrdinal, long msbs, long lsbs,
+      int viewId) {
-    setVersionObject(version);
+    this.versionOrdinal = Versioning.getVersionOrdinal(versionOrdinal);
-    this.versionObj = other.versionObj;
+    this.versionOrdinal = other.versionOrdinal;
-    return this.versionObj.ordinal();
+    return versionOrdinal.ordinal();
-  public Version getVersion() {
-    return versionObj;
+  public VersionOrdinal getVersionOrdinalObject() {
+    return versionOrdinal;
-    setVersionObject(versionOrdinal);
+    this.versionOrdinal = Versioning.getVersionOrdinal(versionOrdinal);
-    this.versionObj = v;
+    setVersionOrdinal(v.ordinal());
-    setVersionObject(Version.readOrdinal(in));
+    setVersionOrdinal(Version.readOrdinal(in));
