Revert "GEODE-3647: Fix race condition"

This reverts commit 96149530d82e0b62e9df1a043bfd7d0e01d3411a.

-import org.apache.geode.cache.partition.PartitionRegionHelper;
-
-    /*
-     * All buckets must be created to make this change, otherwise it is possible for
-     * updatePRConfig(...) to make changes that cause bucket creation to live lock
-     */
-    PartitionRegionHelper.assignBucketsToPartitions(this);
-    dataStore.lockBucketCreationAndVisit(
-        (bucketId, r) -> r.getAttributesMutator().setEntryTimeToLive(timeToLive));
+    // Set to Bucket regions as well
+    if (this.getDataStore() != null) { // not for accessors
+      for (Object o : this.getDataStore().getAllLocalBuckets()) {
+        Map.Entry entry = (Map.Entry) o;
+        Region bucketRegion = (Region) entry.getValue();
+        bucketRegion.getAttributesMutator().setEntryTimeToLive(timeToLive);
+      }
+    }
-    dataStore.lockBucketCreationAndVisit(
-        (bucketId, r) -> r.getAttributesMutator().setCustomEntryTimeToLive(custom));
+    if (this.getDataStore() != null) { // not for accessors
+      for (Object o : this.getDataStore().getAllLocalBuckets()) {
+        Map.Entry entry = (Map.Entry) o;
+        Region bucketRegion = (Region) entry.getValue();
+        bucketRegion.getAttributesMutator().setCustomEntryTimeToLive(custom);
+      }
+    }
-    /*
-     * All buckets must be created to make this change, otherwise it is possible for
-     * updatePRConfig(...) to make changes that cause bucket creation to live lock
-     */
-    PartitionRegionHelper.assignBucketsToPartitions(this);
-    dataStore.lockBucketCreationAndVisit(
-        (bucketId, r) -> r.getAttributesMutator().setEntryIdleTimeout(idleTimeout));
+    if (this.getDataStore() != null) { // not for accessors
+      for (Object o : this.getDataStore().getAllLocalBuckets()) {
+        Map.Entry entry = (Map.Entry) o;
+        Region bucketRegion = (Region) entry.getValue();
+        bucketRegion.getAttributesMutator().setEntryIdleTimeout(idleTimeout);
+      }
+    }
-    dataStore.lockBucketCreationAndVisit(
-        (bucketId, r) -> r.getAttributesMutator().setCustomEntryIdleTimeout(custom));
+    if (this.getDataStore() != null) { // not for accessors
+      for (Object o : this.getDataStore().getAllLocalBuckets()) {
+        Map.Entry entry = (Map.Entry) o;
+        Region bucketRegion = (Region) entry.getValue();
+        bucketRegion.getAttributesMutator().setCustomEntryIdleTimeout(custom);
+      }
+    }
