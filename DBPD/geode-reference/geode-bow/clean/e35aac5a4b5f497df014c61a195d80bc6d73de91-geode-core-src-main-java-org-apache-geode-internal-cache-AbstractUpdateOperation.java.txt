Merge branch 'release/1.5.0'

-import org.apache.geode.distributed.internal.DM;
+import org.apache.geode.distributed.internal.ClusterDistributionManager;
-    DM mgr = region.getDistributionManager();
+    DistributionManager mgr = region.getDistributionManager();
-        && ev.getOperation().isUpdate() && !rgn.concurrencyChecksEnabled // misordered CREATE and
-                                                                         // UPDATE messages can
-                                                                         // cause inconsistencies
+        && ev.getOperation().isUpdate() && !rgn.getConcurrencyChecksEnabled()
+        // misordered CREATE and
+        // UPDATE messages can
+        // cause inconsistencies
+            if (ev.isConcurrencyConflict()) {
+              if (logger.isDebugEnabled()) {
+                logger.debug("basicUpdate failed with CME, not to retry:" + ev);
+              }
+              doUpdate = false;
+            }
-                  || (rgn.dataPolicy.withReplication() && rgn.getConcurrencyChecksEnabled())) {
+                  || (rgn.getDataPolicy().withReplication() && rgn.getConcurrencyChecksEnabled())) {
-                rgn.basicUpdate(ev, true /* ifNew */, false/* ifOld */, lastMod,
+                rgn.basicUpdate(ev, false /* ifNew */, false/* ifOld */, lastMod,
-    protected boolean operateOnRegion(CacheEvent event, DistributionManager dm)
+    protected boolean operateOnRegion(CacheEvent event, ClusterDistributionManager dm)
-      DistributedRegion rgn = (DistributedRegion) ev.region;
-      DM mgr = dm;
+      DistributedRegion rgn = (DistributedRegion) ev.getRegion();
+      DistributionManager mgr = dm;
-    protected boolean mayAddToMultipleSerialGateways(DistributionManager dm) {
+    protected boolean mayAddToMultipleSerialGateways(ClusterDistributionManager dm) {
