GEODE-8127: Reintroduces changes that account for primary bucket changing (#5179)

* flaky test ignored

Co-authored-by: john Hutchison <hutchisonjo@vmware.com>
Co-authored-by: Jens Deppe <jdeppe@pivotal.io>
+import org.apache.geode.internal.cache.LocalDataSet;
+import org.apache.geode.internal.cache.PartitionedRegion;
+
+
-    Object result = compute(localRegion, key, command, args);
-    context.getResultSender().lastResult(result);
+
+    Runnable computation = () -> {
+      Object result = compute(localRegion, key, command, args);
+      context.getResultSender().lastResult(result);
+    };
+
+    computeWithPrimaryLocked(key, (LocalDataSet) localRegion, computation);
+
+  public static void computeWithPrimaryLocked(Object key, LocalDataSet localDataSet, Runnable r) {
+    PartitionedRegion partitionedRegion = localDataSet.getProxy();
+
+    partitionedRegion.computeWithPrimaryLocked(key, r);
+  }
+
