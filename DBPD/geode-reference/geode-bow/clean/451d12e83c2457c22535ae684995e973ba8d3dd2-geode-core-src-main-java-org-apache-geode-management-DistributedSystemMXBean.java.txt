GEODE-2919: Provide finer grained security

 - For full details, see https://cwiki.apache.org/confluence/display/GEODE/Finer+grained+security

+
+import org.apache.geode.security.ResourcePermission.Target;
-   * Returns the ID of thie DistributedSystem. allow anyone to access this method
+   * Returns the ID of the DistributedSystem. allow anyone to access this method
-  public int getDistributedSystemId();
+  int getDistributedSystemId();
-  public int getMemberCount();
+  int getMemberCount();
-  public String[] listMembers();
+  String[] listMembers();
-  public String[] listLocatorMembers(boolean onlyStandAloneLocators);
+  String[] listLocatorMembers(boolean onlyStandAloneLocators);
-  public String[] listGroups();
+  String[] listGroups();
-  public int getLocatorCount();
+  int getLocatorCount();
-  public String[] listLocators(); // TODO - Abhishek Should be renamed to
-                                  // listLocatorDiscoveryConfigurations? Do we need something for
-                                  // mcast too?
+  String[] listLocators(); // TODO - Abhishek Should be renamed to
+                           // listLocatorDiscoveryConfigurations? Do we need something for
+                           // mcast too?
-  public int getSystemDiskStoreCount();
+  int getSystemDiskStoreCount();
-  public Map<String, String[]> listMemberDiskstore();
+  Map<String, String[]> listMemberDiskstore();
-  public String[] listGatewaySenders();
+  String[] listGatewaySenders();
-  public String[] listGatewayReceivers();
+  String[] listGatewayReceivers();
-  public String getAlertLevel();
+  String getAlertLevel();
-  public void changeAlertLevel(String alertLevel) throws Exception;
+  void changeAlertLevel(String alertLevel) throws Exception;
-  public long getTotalHeapSize();
+  long getTotalHeapSize();
-  public long getTotalRegionEntryCount();
+  long getTotalRegionEntryCount();
-  public int getTotalRegionCount();
+  int getTotalRegionCount();
-  public int getTotalMissCount();
+  int getTotalMissCount();
-  public int getTotalHitCount();
+  int getTotalHitCount();
-  public int getNumClients();
+  int getNumClients();
-  public float getDiskReadsRate();
+  float getDiskReadsRate();
-  public float getDiskWritesRate();
+  float getDiskWritesRate();
-  public long getDiskFlushAvgLatency();
+  long getDiskFlushAvgLatency();
-  public int getTotalBackupInProgress();
+  int getTotalBackupInProgress();
-  public int getNumInitialImagesInProgress();
+  int getNumInitialImagesInProgress();
-  public long getActiveCQCount();
+  long getActiveCQCount();
-  public float getQueryRequestRate();
+  float getQueryRequestRate();
-  public DiskBackupStatus backupAllMembers(String targetDirPath, String baselineDirPath)
-      throws Exception;
+  DiskBackupStatus backupAllMembers(String targetDirPath, String baselineDirPath) throws Exception;
-  public GemFireProperties fetchMemberConfiguration(String member) throws Exception;
+  GemFireProperties fetchMemberConfiguration(String member) throws Exception;
-  public long fetchMemberUpTime(String member) throws Exception;
+  long fetchMemberUpTime(String member) throws Exception;
-  public String[] listCacheServers();
+  String[] listCacheServers();
-  public String[] listServers();
+  String[] listServers();
-  public JVMMetrics showJVMMetrics(String member) throws Exception;
+  JVMMetrics showJVMMetrics(String member) throws Exception;
-  public OSMetrics showOSMetrics(String member) throws Exception;
+  OSMetrics showOSMetrics(String member) throws Exception;
-  public NetworkMetrics showNetworkMetric(String member) throws Exception;
+  NetworkMetrics showNetworkMetric(String member) throws Exception;
-  public DiskMetrics showDiskMetrics(String member) throws Exception;
+  DiskMetrics showDiskMetrics(String member) throws Exception;
-  public String[] shutDownAllMembers() throws Exception;
+  String[] shutDownAllMembers() throws Exception;
-  public String[] listRegions();
+  String[] listRegions();
-  public String[] listAllRegionPaths();
+  String[] listAllRegionPaths();
-  @ResourceOperation(resource = Resource.DATA, operation = Operation.MANAGE)
-  public boolean revokeMissingDiskStores(String diskStoreId) throws Exception;
+  @ResourceOperation(resource = Resource.CLUSTER, operation = Operation.MANAGE,
+      target = Target.DISK)
+  boolean revokeMissingDiskStores(String diskStoreId);
-  public PersistentMemberDetails[] listMissingDiskStores();
+  PersistentMemberDetails[] listMissingDiskStores();
-  public ObjectName getMemberObjectName();
+  ObjectName getMemberObjectName();
-  public ObjectName getManagerObjectName();
+  ObjectName getManagerObjectName();
-  public ObjectName[] listMemberObjectNames();
+  ObjectName[] listMemberObjectNames();
-  public ObjectName fetchMemberObjectName(String member) throws Exception;
+  ObjectName fetchMemberObjectName(String member) throws Exception;
-  public ObjectName[] fetchRegionObjectNames(ObjectName memberMBeanName) throws Exception;
+  ObjectName[] fetchRegionObjectNames(ObjectName memberMBeanName) throws Exception;
-  public ObjectName[] listDistributedRegionObjectNames();
+  ObjectName[] listDistributedRegionObjectNames();
-  public ObjectName fetchDistributedRegionObjectName(String regionPath) throws Exception;
+  ObjectName fetchDistributedRegionObjectName(String regionPath) throws Exception;
-  public ObjectName fetchRegionObjectName(String member, String regionPath) throws Exception;
+  ObjectName fetchRegionObjectName(String member, String regionPath) throws Exception;
-  public ObjectName fetchGatewaySenderObjectName(String member, String senderId) throws Exception;
+  ObjectName fetchGatewaySenderObjectName(String member, String senderId) throws Exception;
-  public ObjectName fetchGatewayReceiverObjectName(String member) throws Exception;
+  ObjectName fetchGatewayReceiverObjectName(String member) throws Exception;
-  public ObjectName[] listGatewaySenderObjectNames();
+  ObjectName[] listGatewaySenderObjectNames();
-  public ObjectName[] listGatewaySenderObjectNames(String member) throws Exception;
+  ObjectName[] listGatewaySenderObjectNames(String member) throws Exception;
-  public ObjectName[] listGatewayReceiverObjectNames();
+  ObjectName[] listGatewayReceiverObjectNames();
-  public ObjectName fetchDistributedLockServiceObjectName(String lockServiceName) throws Exception;
+  ObjectName fetchDistributedLockServiceObjectName(String lockServiceName) throws Exception;
-  public ObjectName fetchLockServiceObjectName(String member, String lockService) throws Exception;
+  ObjectName fetchLockServiceObjectName(String member, String lockService) throws Exception;
-  public ObjectName fetchDiskStoreObjectName(String member, String diskStoreName) throws Exception;
+  ObjectName fetchDiskStoreObjectName(String member, String diskStoreName) throws Exception;
-  public ObjectName fetchCacheServerObjectName(String member, int port) throws Exception;
+  ObjectName fetchCacheServerObjectName(String member, int port) throws Exception;
-  public ObjectName[] listCacheServerObjectNames();
+  ObjectName[] listCacheServerObjectNames();
-  public int getNumRunningFunctions();
+  int getNumRunningFunctions();
-  public long getRegisteredCQCount();
+  long getRegisteredCQCount();
-  public long getTotalDiskUsage();
+  long getTotalDiskUsage();
-  public long getUsedHeapSize();
+  long getUsedHeapSize();
-  public float getAverageReads();
+  float getAverageReads();
-  public float getAverageWrites();
+  float getAverageWrites();
-  public int getNumSubscriptions();
+  int getNumSubscriptions();
-  public long getGarbageCollectionCount();
+  long getGarbageCollectionCount();
-  public Map<String, Boolean> viewRemoteClusterStatus();
+  Map<String, Boolean> viewRemoteClusterStatus();
-  public long getJVMPauses();
+  long getJVMPauses();
-   * This API is used to query data from GemFire system. This returns a JSON formated String having
+   * This API is used to query data from GemFire system. This returns a JSON formatted String having
-   * @return a JSON formated string containing data and its type
+   * @return a JSON formatted string containing data and its type
-  public String queryData(String queryString, String members, int limit) throws Exception;
+  String queryData(String queryString, String members, int limit) throws Exception;
-  public byte[] queryDataForCompressedResult(String queryString, String members, int limit)
+  byte[] queryDataForCompressedResult(String queryString, String members, int limit)
-  public int getTransactionCommitted();
+  int getTransactionCommitted();
-  public int getTransactionRolledBack();
+  int getTransactionRolledBack();
-  public int getQueryResultSetLimit();
+  int getQueryResultSetLimit();
-  @ResourceOperation(resource = Resource.DATA, operation = Operation.MANAGE)
-  public void setQueryResultSetLimit(int queryResultSetLimit);
+  @ResourceOperation(resource = Resource.CLUSTER, operation = Operation.MANAGE,
+      target = Target.QUERY)
+  void setQueryResultSetLimit(int queryResultSetLimit);
-  public int getQueryCollectionsDepth();
+  int getQueryCollectionsDepth();
-  @ResourceOperation(resource = Resource.DATA, operation = Operation.MANAGE)
-  public void setQueryCollectionsDepth(int queryCollectionsDepth);
+  @ResourceOperation(resource = Resource.CLUSTER, operation = Operation.MANAGE,
+      target = Target.QUERY)
+  void setQueryCollectionsDepth(int queryCollectionsDepth);
