Revert "GEODE-2632: use immutable SecurityService impls to improve performance"

This reverts commit 5eca6f0393c1a05804a4c4b7f97203ee2ec226a2.

+import java.io.IOException;
+import java.util.HashSet;
+import java.util.Set;
+
+import org.apache.geode.cache.query.internal.cq.CqQueryImpl;
-import org.apache.geode.internal.security.SecurityService;
-
-import java.io.IOException;
-import java.util.HashSet;
-import java.util.Set;
-  private static final StopCQ singleton = new StopCQ();
+  private final static StopCQ singleton = new StopCQ();
-  private StopCQ() {
-    // nothing
-  }
+  private StopCQ() {}
-  public void cmdExecute(final Message clientMessage, final ServerConnection serverConnection,
-      final SecurityService securityService, long start) throws IOException {
+  public void cmdExecute(Message clientMessage, ServerConnection serverConnection, long start)
+      throws IOException {
+    // Based on MessageType.QUERY
+    // Added by Rao 2/1/2007
-      securityService.authorizeDataManage();
+      this.securityService.authorizeDataManage();
-          cqRegionNames.add(cqQuery.getRegionName());
+          cqRegionNames.add(((CqQueryImpl) cqQuery).getRegionName());
-    long oldStart = start;
-    start = DistributionStats.getStatTime();
-    stats.incProcessStopCqTime(start - oldStart);
+    {
+      long oldStart = start;
+      start = DistributionStats.getStatTime();
+      stats.incProcessStopCqTime(start - oldStart);
+    }
+
