GEODE-8048: change redis sets to use functions and deltas (#5009)


Co-authored-by: Darrel Schneider <dschneider@pivotal.io>
Co-authored-by: Sarah Abbey <sabbey@pivotal.io>
Co-authored-by: John Hutchison <jhutchison@pivotal.io>
Co-authored-by: Jens Deppe <jdeppe@pivotal.io>
-    Region<ByteArrayWrapper, Set<ByteArrayWrapper>> region = this.getRegion(context);
-    Set<ByteArrayWrapper> firstSet = region.get(firstSetKey);
+    Region<ByteArrayWrapper, DeltaSet> region = this.getRegion(context);
+    Set<ByteArrayWrapper> firstSet = DeltaSet.members(region, firstSetKey);
-      Set<ByteArrayWrapper> entry = region.get(key);
+      Set<ByteArrayWrapper> entry = DeltaSet.members(region, key);
-      Set<ByteArrayWrapper> newSet = null;
-        Set<ByteArrayWrapper> set = new HashSet<>();
-        for (ByteArrayWrapper entry : resultSet) {
-          set.add(entry);
-        }
-        if (!set.isEmpty()) {
-          newSet = new HashSet<>(set);
-          region.put(destination, newSet);
+        if (!resultSet.isEmpty()) {
+          region.put(destination, new DeltaSet(resultSet));
