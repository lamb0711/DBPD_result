Revert "GEODE-2632: use immutable SecurityService impls to improve performance"

This reverts commit 5eca6f0393c1a05804a4c4b7f97203ee2ec226a2.

+import java.io.IOException;
+import java.util.HashSet;
+import java.util.Set;
+
-import org.apache.geode.internal.security.SecurityService;
-import java.io.IOException;
-import java.util.HashSet;
-import java.util.Set;
-  private static final CloseCQ singleton = new CloseCQ();
+  private final static CloseCQ singleton = new CloseCQ();
-  private CloseCQ() {
-    // nothing
-  }
+  private CloseCQ() {}
-  public void cmdExecute(final Message clientMessage, final ServerConnection serverConnection,
-      final SecurityService securityService, long start) throws IOException {
+  public void cmdExecute(Message clientMessage, ServerConnection serverConnection, long start)
+      throws IOException {
+    // Based on MessageType.QUERY
+    // Added by Rao 2/1/2007
-    securityService.authorizeDataManage();
+    this.securityService.authorizeDataManage();
+        String queryStr = null;
+        Set cqRegionNames = null;
-          String queryStr = cqQuery.getQueryString();
-          Set cqRegionNames = new HashSet();
-          cqRegionNames.add(cqQuery.getRegionName());
+          queryStr = cqQuery.getQueryString();
+          cqRegionNames = new HashSet();
+          cqRegionNames.add(((InternalCqQuery) cqQuery).getRegionName());
-
+      // String cqNameWithClientId = new String(cqName + "__" +
+      // getMembershipID());
-    long oldStart = start;
-    start = DistributionStats.getStatTime();
-    stats.incProcessCloseCqTime(start - oldStart);
+    {
+      long oldStart = start;
+      start = DistributionStats.getStatTime();
+      stats.incProcessCloseCqTime(start - oldStart);
+    }
