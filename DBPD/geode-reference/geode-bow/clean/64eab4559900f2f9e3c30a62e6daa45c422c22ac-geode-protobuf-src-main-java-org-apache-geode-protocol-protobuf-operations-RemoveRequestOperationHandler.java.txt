GEODE-3213: Refactor ProtoBuf handler flow. This now closes #646

Signed-off-by: Alexander Murmann <amurmann@pivotal.io>

+import org.apache.logging.log4j.LogManager;
+import org.apache.logging.log4j.Logger;
+
+import org.apache.geode.protocol.protobuf.Failure;
+import org.apache.geode.protocol.protobuf.Result;
+import org.apache.geode.protocol.protobuf.Success;
-import org.apache.logging.log4j.LogManager;
-import org.apache.logging.log4j.Logger;
-    implements OperationHandler<ClientProtocol.Request, ClientProtocol.Response> {
+    implements OperationHandler<RegionAPI.RemoveRequest, RegionAPI.RemoveResponse> {
-  public ClientProtocol.Response process(SerializationService serializationService,
-      ClientProtocol.Request request, Cache cache) {
-    if (request.getRequestAPICase() != ClientProtocol.Request.RequestAPICase.REMOVEREQUEST) {
-      return ProtobufResponseUtilities
-          .createAndLogErrorResponse("Improperly formatted get request message.", logger, null);
-    }
-    RegionAPI.RemoveRequest removeRequest = request.getRemoveRequest();
+  public Result<RegionAPI.RemoveResponse> process(SerializationService serializationService,
+      RegionAPI.RemoveRequest request, Cache cache) {
-    String regionName = removeRequest.getRegionName();
+    String regionName = request.getRegionName();
-      return ProtobufResponseUtilities.createErrorResponse("Region not found");
+      return Failure
+          .of(ClientProtocol.ErrorResponse.newBuilder().setMessage("Region not found").build());
-      Object decodedKey =
-          ProtobufUtilities.decodeValue(serializationService, removeRequest.getKey());
+      Object decodedKey = ProtobufUtilities.decodeValue(serializationService, request.getKey());
-      return ProtobufResponseUtilities.createRemoveResponse();
+      return Success.of(RegionAPI.RemoveResponse.newBuilder().build());
-      return ProtobufResponseUtilities.createAndLogErrorResponse("Encoding not supported.", logger,
-          ex);
+      return Failure.of(ProtobufResponseUtilities
+          .createAndLogErrorResponse("Encoding not supported.", logger, ex));
-      return ProtobufResponseUtilities
-          .createAndLogErrorResponse("Codec error in protobuf deserialization.", logger, ex);
+      return Failure.of(ProtobufResponseUtilities
+          .createAndLogErrorResponse("Codec error in protobuf deserialization.", logger, ex));
