GEODE-7583: rule improvement for ssl support (#4499)


+import org.apache.geode.cache.ssl.CertStores;
+import org.apache.geode.cache.ssl.CertificateBuilder;
+import org.apache.geode.cache.ssl.CertificateMaterial;
+  public T withSSL(String components, boolean requireAuth,
+      boolean endPointIdentification) {
+    Properties sslProps = getSSLProperties(components, requireAuth, endPointIdentification);
+    properties.putAll(sslProps);
+    return (T) this;
+  }
+
+  public static Properties getSSLProperties(String components, boolean requireAuth,
+      boolean endPointIdentification) {
+    CertificateMaterial ca = new CertificateBuilder()
+        .commonName("Test CA")
+        .isCA()
+        .generate();
+
+    CertificateMaterial memberMaterial = new CertificateBuilder()
+        .commonName("member")
+        .issuedBy(ca)
+        .generate();
+
+    CertStores memberStore = new CertStores("member");
+    memberStore.withCertificate("member", memberMaterial);
+    memberStore.trust("ca", ca);
+
+    try {
+      return memberStore.propertiesWith(components, requireAuth, endPointIdentification);
+    } catch (Exception e) {
+      throw new RuntimeException(e.getMessage(), e);
+    }
+  }
+
