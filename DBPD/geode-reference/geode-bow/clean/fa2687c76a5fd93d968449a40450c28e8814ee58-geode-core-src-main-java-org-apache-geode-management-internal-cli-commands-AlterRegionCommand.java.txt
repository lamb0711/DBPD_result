 GEODE-2668: build tabular command result from a list of function results  (#1127)

* GEODE-2668: build tabular command result from a list of function results

* reduce duplicate code to create the tabular results
* promote presentation consistency
* Add more validation for CreateGatewaySender/Receiver command and reworked the tests

-import java.util.concurrent.atomic.AtomicReference;
-import org.apache.geode.cache.execute.ResultCollector;
-import org.apache.geode.management.internal.cli.CliUtil;
-import org.apache.geode.management.internal.cli.result.TabularResultData;
-    AtomicReference<XmlEntity> xmlEntity = new AtomicReference<>();
-
-              new Object[] {cacheListener}));
+              cacheListener));
-          new Object[] {cacheLoader}));
+          cacheLoader));
-          new Object[] {cacheWriter}));
+          cacheWriter));
-          new Object[] {evictionMax}));
+          evictionMax));
-    Set<DistributedMember> targetMembers = CliUtil.findMembers(groups, null);
+    Set<DistributedMember> targetMembers = findMembers(groups, null);
-    ResultCollector<?, ?> resultCollector =
-        CliUtil.executeFunction(new RegionAlterFunction(), regionFunctionArgs, targetMembers);
-        (List<CliFunctionResult>) resultCollector.getResult();
+        executeAndGetFunctionResult(new RegionAlterFunction(), regionFunctionArgs, targetMembers);
+    result = ResultBuilder.buildResult(regionAlterResults);
-    TabularResultData tabularResultData = ResultBuilder.createTabularResultData();
-    final String errorPrefix = "ERROR: ";
-    for (CliFunctionResult regionAlterResult : regionAlterResults) {
-      boolean success = regionAlterResult.isSuccessful();
-      tabularResultData.accumulate("Member", regionAlterResult.getMemberIdOrName());
-      if (success) {
-        tabularResultData.accumulate("Status", regionAlterResult.getMessage());
-        xmlEntity.set(regionAlterResult.getXmlEntity());
-      } else {
-        tabularResultData.accumulate("Status", errorPrefix + regionAlterResult.getMessage());
-        tabularResultData.setStatus(Result.Status.ERROR);
-      }
-    }
-    result = ResultBuilder.buildResult(tabularResultData);
-
-    if (xmlEntity.get() != null) {
+    XmlEntity xmlEntity = findXmlEntity(regionAlterResults);
+    if (xmlEntity != null) {
-          () -> getSharedConfiguration().addXmlEntity(xmlEntity.get(), groups));
+          () -> getSharedConfiguration().addXmlEntity(xmlEntity, groups));
-
-
