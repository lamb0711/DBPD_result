[GEODE-2144] Improve error message when no security credentials are provided.

- Improve error message when no security credentials are provided.
- Add tests for the code paths exposing this message.
- Refactor making those code paths more testable.

This closes #310

+  public boolean isPre65() {
+    return compareTo(Version.GFE_65) < 0;
+  }
