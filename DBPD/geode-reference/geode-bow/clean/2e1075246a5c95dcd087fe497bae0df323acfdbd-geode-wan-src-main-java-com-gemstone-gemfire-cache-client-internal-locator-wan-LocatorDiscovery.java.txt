Merge branch 'release/1.0.0-incubating.M3'

-import java.io.IOException;
-import java.util.concurrent.ConcurrentHashMap;
-
-import org.apache.logging.log4j.Logger;
-
-import com.gemstone.gemfire.distributed.internal.InternalLocator;
+import com.gemstone.gemfire.distributed.internal.DistributionConfig;
-import com.gemstone.gemfire.cache.client.internal.locator.wan.LocatorMembershipListener;
+import org.apache.logging.log4j.Logger;
+
+import java.io.IOException;
+import java.util.concurrent.ConcurrentHashMap;
- * @since 7.0
+ * @since GemFire 7.0
-  
+
+  private WanLocatorDiscoverer discoverer;
+
-  public LocatorDiscovery(DistributionLocatorId locotor,RemoteLocatorJoinRequest request,
+  public LocatorDiscovery(WanLocatorDiscoverer discoverer, DistributionLocatorId locotor,RemoteLocatorJoinRequest request,
+    this.discoverer = discoverer;
-      "gemfire.GatewaySender.FAILURE_MAP_MAXSIZE", 1000000);
+      DistributionConfig.GEMFIRE_PREFIX + "GatewaySender.FAILURE_MAP_MAXSIZE", 1000000);
-      "gemfire.LocatorDiscovery.FAILURE_LOG_MAX_INTERVAL", 300000);
+      DistributionConfig.GEMFIRE_PREFIX + "LocatorDiscovery.FAILURE_LOG_MAX_INTERVAL", 300000);
-  
+
+  private WanLocatorDiscoverer getDiscoverer() {
+    return this.discoverer;
+  }
-    while (true) {
+    while (!getDiscoverer().isStopped()) {
-    while (true) {
+    while (!getDiscoverer().isStopped()) {
