GEODE-17: pass the properties created by authInit to the security manager

-    String username = null, password = null;
-    if (credentials instanceof String[]) {
+    String username = null;
+    Properties credProps = new Properties();
+    if (credentials instanceof Properties) {
+      credProps = (Properties) credentials;
+      username = credProps.getProperty(ResourceConstants.USER_NAME);
+    }
+    else if (credentials instanceof String[]) {
-      password = aCredentials[1];
-    } else if (credentials instanceof Properties) {
-      username = ((Properties) credentials).getProperty(ResourceConstants.USER_NAME);
-      password = ((Properties) credentials).getProperty(ResourceConstants.PASSWORD);
-    } else {
+      credProps.setProperty(ResourceConstants.USER_NAME, aCredentials[0]);
+      credProps.setProperty(ResourceConstants.PASSWORD, aCredentials[1]);
+    }
+    else {
-    org.apache.shiro.subject.Subject shiroSubject = this.securityService.login(username, password);
+    org.apache.shiro.subject.Subject shiroSubject = this.securityService.login(credProps);
