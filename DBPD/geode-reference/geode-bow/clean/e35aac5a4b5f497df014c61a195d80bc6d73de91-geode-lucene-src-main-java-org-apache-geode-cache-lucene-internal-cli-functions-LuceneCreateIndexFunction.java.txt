Merge branch 'release/1.5.0'

+import org.apache.geode.internal.cache.execute.InternalFunction;
+import org.apache.geode.internal.cache.xmlcache.CacheXml;
-public class LuceneCreateIndexFunction implements InternalEntity, Function {
+public class LuceneCreateIndexFunction implements InternalFunction {
+      final String indexName = indexInfo.getIndexName();
+      final String regionPath = indexInfo.getRegionPath();
+
-      INDEX_NAME.validateName(indexInfo.getIndexName());
+      INDEX_NAME.validateName(indexName);
-      REGION_PATH.validateName(indexInfo.getRegionPath());
+      XmlEntity xmlEntity = null;
+      REGION_PATH.validateName(regionPath);
-        indexFactory.create(indexInfo.getIndexName(), indexInfo.getRegionPath(), true);
+        indexFactory.create(indexName, regionPath, true);
+        if (cache.getRegion(regionPath) != null) {
+          xmlEntity = getXmlEntity(indexName, regionPath);
+        }
-        indexFactory.create(indexInfo.getIndexName(), indexInfo.getRegionPath(), false);
+        indexFactory.create(indexName, regionPath, false);
-      // TODO - update cluster configuration by returning a valid XmlEntity
-      XmlEntity xmlEntity = null;
+  protected XmlEntity getXmlEntity(String indexName, String regionPath) {
+    String regionName = StringUtils.stripStart(regionPath, "/");
+    return new XmlEntity(CacheXml.REGION, "name", regionName);
+  }
+
-
