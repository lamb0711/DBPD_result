Merge branch 'develop' into feature/GEODE-420

# Conflicts:
#	geode-assembly/src/test/java/com/gemstone/gemfire/rest/internal/web/controllers/RestAPIsWithSSLDUnitTest.java
#	geode-core/src/main/java/com/gemstone/gemfire/distributed/internal/DistributionConfig.java
#	geode-core/src/main/java/com/gemstone/gemfire/distributed/internal/membership/gms/GMSUtil.java
#	geode-core/src/main/java/com/gemstone/gemfire/internal/cache/tier/sockets/AcceptorImpl.java
#	geode-core/src/main/java/com/gemstone/gemfire/management/internal/ManagementAgent.java
#	geode-core/src/main/java/org/apache/geode/redis/GeodeRedisServer.java
#	geode-core/src/test/java/com/gemstone/gemfire/distributed/LocatorDUnitTest.java

-              queuePrimaryEvent(gatewayEvent);
-              queuedEvent = true;
+              queuedEvent = queuePrimaryEvent(gatewayEvent);
-      queuePrimaryEvent(senderEvent);
+      
+      boolean queuedEvent =false;
+      try {
+        queuedEvent = queuePrimaryEvent(senderEvent);
+      } finally {
+        //When queuePrimaryEvent() failed with some exception, it could
+        //occur after the GatewaySenderEventImpl is put onto the queue.
+        //In that case, the GatewaySenderEventImpl could be released here,
+        //and IllegalStateException could be thrown if getDeserializedValue is called
+        //when the event is accessed through the region queue.
+        if (!queuedEvent) {
+          GatewaySenderEventImpl.release(senderEvent);
+        }
+      }
-  private void queuePrimaryEvent(GatewaySenderEventImpl gatewayEvent)
+  private boolean queuePrimaryEvent(GatewaySenderEventImpl gatewayEvent)
-      return;
+      return false;
+    boolean putDone = false;
-      this.queue.put(gatewayEvent);
+      putDone = this.queue.put(gatewayEvent);      
+    return putDone;
