Merge branch 'feature/GEODE-8' into develop

+  /**
+   * True if the P2P reader that received this message is a SHARED reader.
+   */
+  private transient boolean sharedReceiver;
+  
-    inlineProcess |= this.getInlineProcess();
-    inlineProcess |= Connection.isDominoThread();
-    inlineProcess |= this.acker != null;
+    boolean forceInline = this.acker != null || getInlineProcess() || Connection.isDominoThread();
+    
+    if (inlineProcess && !forceInline && isSharedReceiver()) {
+      // If processing this message may need to add
+      // to more than one serial gateway then don't
+      // do it inline.
+      if (mayAddToMultipleSerialGateways(dm)) {
+        inlineProcess = false;
+      }
+    }
+    
+    inlineProcess |= forceInline;
+  protected boolean mayAddToMultipleSerialGateways(DistributionManager dm) {
+    // subclasses should override this method if processing
+    // them may add to multiple serial gateways.
+    return false;
+  }
+
+  
+  public void setSharedReceiver(boolean v) {
+    this.sharedReceiver = v;
+  }
+  public boolean isSharedReceiver() {
+    return this.sharedReceiver;
+  }
