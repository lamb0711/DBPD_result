Merge branch 'develop' into feature/GEODE-1571

-      boolean updatedDesiredCursorPosition = false;
-      if (!userOptionSet.areOptionsPresent()) {
-        int walkBackwards = remainingBuffer.length() - 1;
-        while (remainingBuffer.charAt(walkBackwards) != '-') {
-          walkBackwards--;
-        }
-        walkBackwards -= 2;
-        desiredCursorPosition += walkBackwards;
-        updatedDesiredCursorPosition = true;
-      }
+
-        if (!updatedDesiredCursorPosition && userOptionSet.hasOption(option)) {
+        if (userOptionSet.hasOption(option)) {
+
-      subString = remainingBuffer.substring(newCursor + (sizeReduced ? -1 : 0) - cursorStart).trim();
+      int sizedReducedAdj = sizeReduced ? -1 : 0;
+      int begin = newCursor + sizedReducedAdj - cursorStart;
+      subString = remainingBuffer.substring(begin).trim();
-
-    if (coe != null && newCursor < cursor && completionCandidates.size() == 0 && !(PreprocessorUtils.containsOnlyWhiteSpaces(subString) || ((subString
-                                                                                                                                               .endsWith(SyntaxConstants.LONG_OPTION_SPECIFIER) && subString
-                                                                                                                                               .startsWith(SyntaxConstants.LONG_OPTION_SPECIFIER)) || (subString
-                                                                                                                                                                                                         .startsWith(SyntaxConstants.SHORT_OPTION_SPECIFIER) && subString
-                                                                                                                                                                                                         .endsWith(SyntaxConstants.SHORT_OPTION_SPECIFIER))))) {
+    if (coe != null // hasException
+      && newCursor < cursor // newCursorIsEarlierThanCursor
+      && completionCandidates.size() == 0 // zeroCompletionCandidates
+      &&!(PreprocessorUtils.containsOnlyWhiteSpaces(subString) // onlyHasWhiteSpaces
+        || ((subString.endsWith(SyntaxConstants.LONG_OPTION_SPECIFIER) && subString.startsWith(SyntaxConstants.LONG_OPTION_SPECIFIER)) // isHypenHyphen
+        || (subString.startsWith(SyntaxConstants.SHORT_OPTION_SPECIFIER) && subString.endsWith(SyntaxConstants.SHORT_OPTION_SPECIFIER))))) { // isHyphen
+
