GEODE-8134: convert String commands to use Function+Delta (#5160)

Co-authored-by: john Hutchison <hutchisonjo@vmware.com>
Co-authored-by: Ray Ingles <ringles@vmware.com>
+import org.apache.geode.redis.internal.RedisData;
-    Region<ByteArrayWrapper, ByteArrayWrapper> r = context.getRegionProvider().getStringsRegion();
+    Region<ByteArrayWrapper, RedisData> region = context.getRegionProvider().getStringsRegion();
-    ByteArrayWrapper wrapper = r.get(key);
+    RedisString redisString = (RedisString) region.get(key);
-      int length = wrapper == null ? 0 : wrapper.toBytes().length;
-      command.setResponse(Coder.getIntegerResponse(context.getByteBufAllocator(), length));
-      if (wrapper == null) {
+      int length;
+      if (redisString == null) {
+        length = 0;
+      } else {
+        ByteArrayWrapper wrapper = redisString.getValue();
+        length = wrapper.length();
+      command.setResponse(Coder.getIntegerResponse(context.getByteBufAllocator(), length));
+
-    if (wrapper == null) {
+    if (redisString == null) {
-      r.put(key, new ByteArrayWrapper(bytes));
+      region.put(key, new RedisString(new ByteArrayWrapper(bytes)));
-
+      ByteArrayWrapper wrapper = redisString.getValue();
-        r.put(key, new ByteArrayWrapper(bytes));
+        region.put(key, new RedisString(new ByteArrayWrapper(bytes)));
-        r.put(key, new ByteArrayWrapper(newBytes));
+        region.put(key, new RedisString(new ByteArrayWrapper(bytes)));
