Merge remote-tracking branch 'origin/feature/GEODE-409' into develop

-      if (closeInProgress) {
+      if (isCloseInProgress()) {
-        if (closeInProgress) {
+        if (isCloseInProgress()) {
-        if (closeInProgress) {
+        if (isCloseInProgress()) {
+  /**
+   * Returns true if this DM or the DistributedSystem owned by
+   * it is closing or is closed.
+   */
+  private boolean isCloseInProgress() {
+    if (closeInProgress) {
+      return true;
+    }
+    InternalDistributedSystem ds = getSystem();
+    if (ds != null && ds.isDisconnecting()) {
+      return true;
+    }
+    return false;
+  }
-        if (closeInProgress) {
+        if (isCloseInProgress()) {
-        if (closeInProgress) {
+        if (isCloseInProgress()) {
-        if (closeInProgress) {
+        if (isCloseInProgress()) {
-        if (closeInProgress) {
+        if (isCloseInProgress()) {
-        if (closeInProgress) {
+        if (isCloseInProgress()) {
-        if (closeInProgress) {
+        if (isCloseInProgress()) {
-        if (closeInProgress) {
+        if (isCloseInProgress()) {
-        if (closeInProgress) {
+        if (isCloseInProgress()) {
-          if (closeInProgress) {
+          if (isCloseInProgress()) {
-          if (closeInProgress) {
+          if (isCloseInProgress()) {
-      if (crashed && ! this.closeInProgress) {
+      if (crashed && ! isCloseInProgress()) {
