GEODE-7171: Encapsulate metrics session (#4203)

Metrics session responsibilities are starting to appear in too many
parts of Geode. This change encapsulates those responsibilities into a
single class.

Changes to core Geode classes:

- GemFireCacheImpl no longer holds a meter registry or the set of "user"
  registries added by the cache builder.

- InternalCacheBuilder no longer constructs objects on behalf of the
  metrics session.  Instead, it gathers meter registries and other
  details into a MetricsService.Builder, which it passes to the
  InternalDistributedSystem.Builder.

- InternalDistributedSystem no longer knows about client meter
  registries. Instead, it holds a MetricsService, which remembers its
  builder.  During reconnect, the InternalDistributedSystem retrieves
  the builder from its metrics service, and uses the builder to build
  a similar metrics service in the reconnected system.

New classes and interfaces (org.apache.geode.metrics.internal):

- StandardMeterBinder
  - Binds standard meter binders to the meter registry.
  - close() closes the closeable binders, freeing their resources.

- MetricsService interface
  - Extends MetricsSession.
  - Adds methods to start and stop the service, and to access the
    service's meter registry.
  - Adds a method that returns the builder that built the metrics
    service, so that reconnect can use the same builder to build the
    metrics service for the reconnected system.

- InternalDistributedSystemMetricsService
  - Implements MetricsService.
  - Creates and retains a composite meter registry to manage meters.
  - Configures the composite composite registry:
    - Adds common tags that describe the system
    - Adds client meter registries to the composite.
    - Applies a StandardMeterBinder to add standard meters to the
      registry.
  - Discovers, starts, and stops metrics publishing services.
  - Adds and removes sub-registries as instructed by publishing
    services.
  - When stopped, stops each publishing service, closes all closeable
    meter binders, removes all sub-registries, and closes its composite
    meter registry.

- MetricsService.Builder interface

- InternalDistriburtedSystemMetricsService.Builder
  - Implements MetricsService.Builder
  - Accumulates and retains constructor parameters for the eventual
    InternalDistributedSystemMetricsService.
  - In particular, maintains a collection of meter registries added by
    the cache builder. It calls these 'persistent' registries, because
    they will persist across reconnects.

Other changes:

- Added MetricsSession parameter to MetricsPublishingService.stop().

Authored-by: Dale Emery <demery@pivotal.io>
- * Provides the ability to add and remove a meter registry for publishing cache metrics to external
- * monitoring systems.
+ * A session that manages Geode metrics. Users can implement and register
+ * {@link MetricsPublishingService}s to publish the session's metrics to external monitoring
+ * systems.
-   * Adds the given registry to the cache's composite registry.
+   * Adds the given registry to this metrics session.
-   * @param subregistry the registry to add
+   * @param registry the registry to add
-  void addSubregistry(MeterRegistry subregistry);
+  void addSubregistry(MeterRegistry registry);
-   * Removes the given registry from the cache's composite registry.
+   * Removes the given registry from this metrics session.
-   * <strong>Caution:</strong> This method deletes from the sub-registry each meter that corresponds
-   * to a meter in the cache's composite registry.
+   * <strong>Caution:</strong> For each meter in this metrics session, this method deletes the
+   * corresponding meter from the given registry.
-   * @param subregistry the registry to remove
+   * @param registry the registry to remove
-  void removeSubregistry(MeterRegistry subregistry);
+  void removeSubregistry(MeterRegistry registry);
