GEODE-8331: allow GFSH to connect to other versions of cluster (#5375)


+import org.apache.geode.internal.GemFireVersion;
-      commandResult = ResultModel.fromJson((String) response);
-
+      try {
+        commandResult = ResultModel.fromJson((String) response);
+      } catch (Exception e) {
+        logWrapper.severe("Unable to parse the remote response.", e);
+        String clientVersion = GemFireVersion.getGemFireVersion();
+        String remoteVersion = null;
+        try {
+          remoteVersion = shell.getOperationInvoker().getRemoteVersion();
+        } catch (Exception exception) {
+          // unable to get the remote version (pre-1.5.0 manager does not have this capability)
+          // ignore
+        }
+        String message = "Unable to parse the remote response. This might due to gfsh client "
+            + "version(" + clientVersion + ") mismatch with the remote cluster version"
+            + ((remoteVersion == null) ? "." : "(" + remoteVersion + ").");
+        return ResultModel.createError(message);
+      }
