GEODE-2863: Discard all new tasks, after close request received

-      // don't block the shutdown hook
-      if (Thread.currentThread() != InternalDistributedSystem.shutdownHook) {
-        waitForBackgroundTasks();
-      }
+
+      this.diskStoreTaskPool.shutdown();
+      this.delayedWritePool.shutdown();
+
+      final int secToWait = 60;
+      try {
+        this.diskStoreTaskPool.awaitTermination(secToWait, TimeUnit.SECONDS);
+      } catch (InterruptedException x) {
+        Thread.currentThread().interrupt();
+        logger.debug("Failed in interrupting the DiskStoreTask Thread due to interrupt");
+      }
+      try {
+        this.delayedWritePool.awaitTermination(secToWait, TimeUnit.SECONDS);
+      } catch (InterruptedException x) {
+        Thread.currentThread().interrupt();
+        logger.debug("Failed in interrupting the DelayedWrite Thread due to interrupt");
+      }
+      if (!this.diskStoreTaskPool.isTerminated()) {
+        logger.warn("Failed to stop DiskStoreTask threads in {} seconds", secToWait);
+      }
+      if (!this.delayedWritePool.isTerminated()) {
+        logger.warn("Failed to stop DelayedWrite threads in {} seconds", secToWait);
+      }
+      // don't block the shutdown hook
+      if (Thread.currentThread() != InternalDistributedSystem.shutdownHook) {
+        waitForBackgroundTasks();
+      }
+
+    if (executor.isShutdown()) {
+      logger.warn("Submitting task to shutdown pool");
+      return null;
+    }
