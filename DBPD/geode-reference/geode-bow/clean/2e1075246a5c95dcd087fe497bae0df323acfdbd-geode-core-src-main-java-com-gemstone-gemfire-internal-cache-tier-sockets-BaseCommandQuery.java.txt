Merge branch 'release/1.0.0-incubating.M3'

-import com.gemstone.gemfire.cache.query.internal.cq.InternalCqQuery;
+import com.gemstone.gemfire.internal.security.GeodeSecurityUtil;
+      // integrated security
+      for(Object regionName:regionNames){
+        GeodeSecurityUtil.authorizeRegionRead(regionName.toString());
+      }
-      // endTime = System.currentTimeMillis();
-      // System.out.println("Query executed in: " + (endTime-startTime) + "ms");
-      // GenericStats.endTime0(startTime);
-
-
+
+        // post process, iterate through the result for post processing
+        if(GeodeSecurityUtil.needPostProcess()) {
+          List list = selectResults.asList();
+          for (Iterator<Object> valItr = list.iterator(); valItr.hasNext(); ) {
+            Object value = valItr.next();
+            if (value == null)
+              continue;
+
+            if (value instanceof CqEntry) {
+              CqEntry cqEntry = (CqEntry) value;
+              Object cqNewValue = GeodeSecurityUtil.postProcess(null, cqEntry.getKey(), cqEntry.getValue());
+              if (!cqEntry.getValue().equals(cqNewValue)) {
+                selectResults.remove(value);
+                selectResults.add(new CqEntry(cqEntry.getKey(), cqNewValue));
+              }
+            } else {
+              Object newValue = GeodeSecurityUtil.postProcess(null, null, value);
+              if (!value.equals(newValue)) {
+                selectResults.remove(value);
+                selectResults.add(newValue);
+              }
+            }
+          }
+        }
+
