Merge branch 'release/1.0.0-incubating.M3'

+import java.lang.reflect.Method;
-import org.springframework.shell.core.Parser;
-import org.springframework.shell.event.ParseResult;
-
+import com.gemstone.gemfire.internal.security.GeodeSecurityUtil;
+import com.gemstone.gemfire.management.internal.security.ResourceOperation;
+import com.gemstone.gemfire.security.NotAuthorizedException;
+
+import org.springframework.shell.core.Parser;
+import org.springframework.shell.event.ParseResult;
- * @since 7.0
+ * @since GemFire 7.0
+
-        
+
+
+        //do general authorization check here
+        Method method = parseResult.getMethod();
+        ResourceOperation resourceOperation = method.getAnnotation(ResourceOperation.class);
+        GeodeSecurityUtil.authorize(resourceOperation);
+
-      } catch (RuntimeException e) {
+      } catch (NotAuthorizedException e) {
+        setLastExecutionStatus(1);
+        if (logWrapper.infoEnabled()) {
+          logWrapper.info("Could not execute \""+cmdStmt.getCommandString()+"\".", e);
+        }
+        // for NotAuthorizedException, will catch this later in the code
+        throw e;
+      }catch (RuntimeException e) {
