GEODE-5440: when we need re-evaluate a entry in a index, we need to pass in the outer value key in the equiJoin. (#2338)

* rewrite the flaky test with an integration test
* pass in the value key when doing the equiJoin
* code clean up.
+import java.util.function.Consumer;
+import org.apache.geode.cache.PartitionAttributesFactory;
+import org.apache.geode.cache.Region;
+import org.apache.geode.cache.RegionFactory;
+  public Region createRegion(RegionShortcut type, String name,
+      Consumer<RegionFactory> regionFactoryConsumer) {
+    RegionFactory factory = getCache().createRegionFactory(type);
+    regionFactoryConsumer.accept(factory);
+    return factory.create(name);
+  }
+
+  public Region createPRRegion(String name, Consumer<RegionFactory> regionFactoryConsumer,
+      Consumer<PartitionAttributesFactory> prAttributesFactory) {
+    return createRegion(RegionShortcut.PARTITION, name, rf -> {
+      regionFactoryConsumer.accept(rf);
+      PartitionAttributesFactory factory = new PartitionAttributesFactory();
+      prAttributesFactory.accept(factory);
+      rf.setPartitionAttributes(factory.create());
+    });
+  }
+
