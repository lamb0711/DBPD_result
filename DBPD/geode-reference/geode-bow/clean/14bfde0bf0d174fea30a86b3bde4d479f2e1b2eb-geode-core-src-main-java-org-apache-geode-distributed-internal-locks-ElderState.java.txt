Merge branch 'release/1.8.0'

-import java.util.Iterator;
-import org.apache.geode.internal.i18n.LocalizedStrings;
-import org.apache.geode.internal.logging.log4j.LocalizedMessage;
-  private final HashMap nameToInfo;
+  private final HashMap<String, GrantorInfo> nameToInfo;
-    this.nameToInfo = new HashMap();
+    this.nameToInfo = new HashMap<>();
-        StringBuffer sb = new StringBuffer("ElderState initialized with:");
-        for (Iterator grantors = this.nameToInfo.keySet().iterator(); grantors.hasNext();) {
-          Object key = grantors.next();
-          // key=dlock svc name, value=GrantorInfo object
-          sb.append("\n\t" + key + ": " + this.nameToInfo.get(key));
+        StringBuilder sb = new StringBuilder("ElderState initialized with:");
+        for (String key : this.nameToInfo.keySet()) {
+          sb.append("\n\t").append(key).append(": ").append(this.nameToInfo.get(key));
-      logger.warn(LogMarker.DLS_MARKER, LocalizedMessage
-          .create(LocalizedStrings.ElderState_ELDERSTATE_PROBLEM_SYSTEM_0, checkDM.getSystem()));
+      logger.warn(LogMarker.DLS_MARKER, "ElderState problem: system={}", checkDM.getSystem());
-          LocalizedMessage.create(
-              LocalizedStrings.ElderState_ELDERSTATE_PROBLEM_SYSTEM_DISTRIBUTIONMANAGER_0,
-              checkDM.getSystem().getDistributionManager()));
+          "ElderState problem: system DistributionManager={}",
+          checkDM.getSystem().getDistributionManager());
-          LocalizedMessage.create(
-              LocalizedStrings.ElderState_ELDERSTATE_PROBLEM_DM_0_BUT_SYSTEM_DISTRIBUTIONMANAGER_1,
-              new Object[] {checkDM, checkDM.getSystem().getDistributionManager()}));
+          "ElderState problem: dm={}, but system DistributionManager={}",
+          new Object[] {checkDM, checkDM.getSystem().getDistributionManager()});
-          // current grantor crashed; make new guy grantor and force recovery
+          // current grantor crashed; make new member grantor and force recovery
-              // current grantor crashed; make new guy grantor and force recovery
+              // current grantor crashed; make new member grantor and force recovery
-        return; // KIRK added this null check because becomeGrantor may not have talked to elder
-                // before destroy dls
+        // added null check because becomeGrantor may not have talked to elder before destroy dls
+        return;
-            LocalizedStrings.ElderState_CANNOT_FORCE_GRANTOR_RECOVERY_FOR_GRANTOR_THAT_IS_TRANSFERRING
-                .toLocalizedString());
+            "Cannot force grantor recovery for grantor that is transferring");
