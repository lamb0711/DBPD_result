GEODE-8147: change redis DELETE and EXISTS to use Function+Delta (#5128)

Co-authored-by: Sarah <mboxwala@pivotal.io>
Co-authored-by: Sarah <sabbey@pivotal.io>
-import org.apache.geode.redis.internal.RedisDataType;
+import org.apache.geode.redis.internal.RegionProvider;
+  private RegionProvider regionProvider;
-  public static void register() {
+  public static void register(RegionProvider regionProvider) {
-    FunctionService.registerFunction(new CommandFunction(stripedExecutor));
+    FunctionService.registerFunction(new CommandFunction(stripedExecutor, regionProvider));
-  public CommandFunction(StripedExecutor stripedExecutor) {
+  public CommandFunction(StripedExecutor stripedExecutor,
+      RegionProvider regionProvider) {
+    this.regionProvider = regionProvider;
-        RedisDataType delType = (RedisDataType) args[1];
-        callable = executeDel(key, localRegion, delType);
+        callable = () -> new RedisKeyInRegion(localRegion, regionProvider).del(key);
+        break;
+      case EXISTS:
+        callable = () -> new RedisKeyInRegion(localRegion, regionProvider).exists(key);
-
-  private Callable<Object> executeDel(ByteArrayWrapper key, Region localRegion,
-      RedisDataType delType) {
-    switch (delType) {
-      case REDIS_SET:
-        return () -> new RedisSetInRegion(localRegion).del(key);
-      case REDIS_HASH:
-        return () -> new RedisHashInRegion(localRegion).del(key);
-      default:
-        throw new UnsupportedOperationException("DEL does not support " + delType);
-    }
-  }
-
