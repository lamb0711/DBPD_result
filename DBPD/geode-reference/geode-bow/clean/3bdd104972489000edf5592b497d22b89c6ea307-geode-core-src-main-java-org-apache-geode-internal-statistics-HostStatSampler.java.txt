GEODE-2012: always write stat types to archive

* refactor classes to make testing easier
* write additional tests for stat archive rolling
* expose bug GEODE-2012 in StatTypesAreRolledOverRegressionTest
* fix bug exposed by StatTypesAreRolledOverRegressionTest

+import org.apache.geode.internal.io.MainWithChildrenRollingFileHandler;
+  private final NanoTimer timer;
+
+    this(stopper, samplerStats, new NanoTimer());
+  }
+
+  protected HostStatSampler(CancelCriterion stopper, StatSamplerStats samplerStats,
+      NanoTimer timer) {
+    this.timer = timer;
-    NanoTimer timer = new NanoTimer();
-
-      this.sampleCollector.initialize(this, NanoTimer.getTime());
+      this.sampleCollector.initialize(this, timer.getTime(),
+          new MainWithChildrenRollingFileHandler());
-        delay(timer, nanosToDelay);
+        delay(nanosToDelay);
-    return this.statSamplerInitializedLatch.await(ms);
+    return awaitInitialization(ms, TimeUnit.MILLISECONDS);
+  }
+
+  /**
+   * Awaits the initialization of special statistics.
+   *
+   * @see #initSpecialStats
+   */
+  public final boolean awaitInitialization(final long timeout, final TimeUnit unit)
+      throws InterruptedException {
+    return this.statSamplerInitializedLatch.await(timeout, unit);
-    this.sampleCollector.changeArchive(newFile, NanoTimer.getTime());
+    this.sampleCollector.changeArchive(newFile, timer.getTime());
-   * @param timer a NanoTimer used to compute the elapsed delay
-  private void delay(NanoTimer timer, final long nanosToDelay) throws InterruptedException {
+  private void delay(final long nanosToDelay) throws InterruptedException {
