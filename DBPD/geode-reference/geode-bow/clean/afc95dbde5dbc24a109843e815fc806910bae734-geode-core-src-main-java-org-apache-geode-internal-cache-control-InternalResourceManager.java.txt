Revert "Merge pull request #3878 from aaronlindsey/server-online-uses-startup-tasks"

This reverts commit d9a9e30275ae21e33212a48ca72762bacdf37d67, reversing
changes made to f0db209e0508a313e1095a99d3e6009c1d229ce0.

-import java.util.Objects;
+import java.util.function.Consumer;
-  /**
-   * Adds a task that represents an asynchronous action during startup
-   *
-   * @param startupTask the CompletableFuture startup task
-   */
-    Objects.requireNonNull(startupTask);
-  /**
-   * Clears the startup tasks and returns a CompletableFuture that completes when all of the startup
-   * tasks complete.
-   *
-   * @return a CompletableFuture that completes when all of the startup tasks complete
-   */
-  public CompletableFuture<Void> allOfStartupTasks() {
-    CompletableFuture[] completableFutures = startupTasks.toArray(new CompletableFuture[0]);
+  public void runWhenStartupTasksComplete(Runnable runnable, Consumer<Throwable> exceptionAction) {
+    CompletableFuture.allOf(startupTasks.toArray(new CompletableFuture[0]))
+        .thenRun(runnable)
+        .exceptionally((throwable) -> {
+          exceptionAction.accept(throwable);
+          return null;
+        });
+
-    return CompletableFuture.allOf(completableFutures);
