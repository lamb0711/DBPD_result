Merge branch 'release/1.0.0-incubating.M3'

+import java.util.Arrays;
+import java.util.UUID;
+import com.gemstone.gemfire.cache.lucene.internal.filesystem.FileSystemStats;
-  
+
-  public RegionDirectory(ConcurrentMap<String, File> fileRegion, ConcurrentMap<ChunkKey, byte[]> chunkRegion) {
+  public RegionDirectory(ConcurrentMap<String, File> fileRegion, ConcurrentMap<ChunkKey, byte[]> chunkRegion, FileSystemStats stats) {
-    fs = new FileSystem(fileRegion, chunkRegion);
+    fs = new FileSystem(fileRegion, chunkRegion, stats);
-  
+
-    return fs.listFileNames().toArray(new String[] {});
+    String[] array = fs.listFileNames().toArray(new String[]{});
+    Arrays.sort(array);
+    return array;
-    return new OutputStreamIndexOutput(name, out, 1000);
+    return new OutputStreamIndexOutput(name, name, out, 1000);
+  }
+
+  public IndexOutput createTempOutput(String prefix, String suffix, IOContext context) throws IOException {
+    String name = prefix + "_temp_" + UUID.randomUUID() + suffix;
+    final File file = fs.createTemporaryFile(name);
+    final OutputStream out = file.getOutputStream();
+
+    return new OutputStreamIndexOutput(name, name, out, 1000);
