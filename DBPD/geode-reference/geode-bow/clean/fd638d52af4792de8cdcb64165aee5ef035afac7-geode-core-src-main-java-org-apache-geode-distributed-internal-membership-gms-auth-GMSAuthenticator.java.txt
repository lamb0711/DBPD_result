Revert "GEODE-2632: use immutable SecurityService impls to improve performance"

This reverts commit 5eca6f0393c1a05804a4c4b7f97203ee2ec226a2.

-import static org.apache.geode.distributed.ConfigurationProperties.SECURITY_PEER_AUTHENTICATOR;
-import static org.apache.geode.distributed.ConfigurationProperties.SECURITY_PEER_AUTH_INIT;
-import static org.apache.geode.internal.i18n.LocalizedStrings.AUTH_PEER_AUTHENTICATION_FAILED;
-import static org.apache.geode.internal.i18n.LocalizedStrings.AUTH_PEER_AUTHENTICATION_FAILED_WITH_EXCEPTION;
-import static org.apache.geode.internal.i18n.LocalizedStrings.AUTH_PEER_AUTHENTICATION_MISSING_CREDENTIALS;
-import static org.apache.geode.internal.i18n.LocalizedStrings.HandShake_FAILED_TO_ACQUIRE_AUTHENTICATOR_OBJECT;
+import static org.apache.geode.distributed.ConfigurationProperties.*;
+import static org.apache.geode.internal.i18n.LocalizedStrings.*;
+
+import java.security.Principal;
+import java.util.Properties;
+
-import org.apache.geode.internal.security.CallbackInstantiator;
+import org.apache.geode.internal.security.IntegratedSecurityService;
-import java.security.Principal;
-import java.util.Properties;
-
+  private SecurityService securityService = IntegratedSecurityService.getSecurityService();
-    SecurityService securityService = this.services.getSecurityService();
-
-    // initialized here. We need to check if the passed in secProps has peer authenticator or not at
-    // this point
+    // initialized here. We need to check
+    // if the passed in secProps has peer authenticator or not
+    // at this point,
-      if (securityService.isIntegratedSecurity()) {
-        securityService.login(credentials);
-        securityService.authorizeClusterManage();
+      if (this.securityService.isIntegratedSecurity()) {
+        this.securityService.login(credentials);
+        this.securityService.authorizeClusterManage();
-      auth = CallbackInstantiator.getObjectOfType(authMethod,
+      auth = SecurityService.getObjectOfType(authMethod,
-
-      // this.securityProps contains security-ldap-basedn but security-ldap-baseDomainName is
-      // expected
-      auth.init(this.securityProps, logWriter, securityLogWriter);
+      auth.init(this.securityProps, logWriter, securityLogWriter); // this.securityProps contains
+                                                                   // security-ldap-basedn but
+                                                                   // security-ldap-baseDomainName
+                                                                   // is expected
