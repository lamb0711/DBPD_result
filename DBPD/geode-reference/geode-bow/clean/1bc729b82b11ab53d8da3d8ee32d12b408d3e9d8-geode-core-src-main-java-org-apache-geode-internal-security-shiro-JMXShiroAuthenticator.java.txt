GEODE-6717: Logging out when all JMX connections are closed (#3903)

Co-authored-by: mkevo


+import java.util.Map;
+import java.util.concurrent.ConcurrentHashMap;
+  private final Map<String, org.apache.shiro.subject.Subject> connectedUsers =
+      new ConcurrentHashMap<>();
-      if (JMXConnectionNotification.CLOSED.equals(type)) {
-        this.securityService.logout();
+      String connectionId = cxNotification.getConnectionId();
+      if (JMXConnectionNotification.OPENED.equals(type)) {
+        connectedUsers.put(connectionId, securityService.getSubject());
+      } else if (JMXConnectionNotification.CLOSED.equals(type)) {
+        org.apache.shiro.subject.Subject subject = connectedUsers.remove(connectionId);
+        securityService.bindSubject(subject);
+        securityService.logout();
