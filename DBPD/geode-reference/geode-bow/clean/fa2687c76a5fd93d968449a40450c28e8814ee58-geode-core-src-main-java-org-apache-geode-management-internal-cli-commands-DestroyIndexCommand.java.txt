 GEODE-2668: build tabular command result from a list of function results  (#1127)

* GEODE-2668: build tabular command result from a list of function results

* reduce duplicate code to create the tabular results
* promote presentation consistency
* Add more validation for CreateGatewaySender/Receiver command and reworked the tests

-import java.util.HashMap;
-import java.util.Map;
-import java.util.TreeSet;
-import java.util.concurrent.atomic.AtomicReference;
-import org.apache.geode.cache.execute.ResultCollector;
-import org.apache.geode.management.internal.cli.result.ErrorResultData;
-import org.apache.geode.management.internal.cli.result.InfoResultData;
-import org.apache.geode.management.internal.cli.result.TabularResultData;
-    ResultCollector rc = CliUtil.executeFunction(destroyIndexFunction, indexInfo, targetMembers);
-    List<CliFunctionResult> funcResults = (List<CliFunctionResult>) rc.getResult();
+    List<CliFunctionResult> funcResults =
+        executeAndGetFunctionResult(destroyIndexFunction, indexInfo, targetMembers);
+    Result result = ResultBuilder.buildResult(funcResults);
+    XmlEntity xmlEntity = findXmlEntity(funcResults);
-    Set<String> successfulMembers = new TreeSet<>();
-    Map<String, Set<String>> indexOpFailMap = new HashMap<>();
-
-    AtomicReference<XmlEntity> xmlEntity = new AtomicReference<>();
-
-    TabularResultData tabularResultData = ResultBuilder.createTabularResultData();
-    final String errorPrefix = "ERROR:";
-
-    for (CliFunctionResult cliFunctionResult : funcResults) {
-      boolean success = cliFunctionResult.isSuccessful();
-
-      tabularResultData.accumulate("Member", cliFunctionResult.getMemberIdOrName());
-      tabularResultData.accumulate("Status",
-          (success ? "" : errorPrefix) + cliFunctionResult.getMessage());
-
-      if (success) {
-        if (xmlEntity.get() == null) {
-          xmlEntity.set(cliFunctionResult.getXmlEntity());
-        }
-      } else {
-        tabularResultData.setStatus(Result.Status.ERROR);
-      }
-
-      if (cliFunctionResult.isSuccessful()) {
-        successfulMembers.add(cliFunctionResult.getMemberIdOrName());
-        if (xmlEntity.get() == null) {
-          xmlEntity.set(cliFunctionResult.getXmlEntity());
-        }
-      } else {
-        String exceptionMessage = cliFunctionResult.getMessage();
-        Set<String> failedMembers = indexOpFailMap.get(exceptionMessage);
-
-        if (failedMembers == null) {
-          failedMembers = new TreeSet<>();
-        }
-        failedMembers.add(cliFunctionResult.getMemberIdOrName());
-        indexOpFailMap.put(exceptionMessage, failedMembers);
-      }
-    }
-    Result result = ResultBuilder.buildResult(tabularResultData);
-
-    if (xmlEntity.get() != null) {
+    if (xmlEntity != null) {
-          () -> getSharedConfiguration().deleteXmlEntity(xmlEntity.get(), group));
+          () -> getSharedConfiguration().deleteXmlEntity(xmlEntity, group));
