GEODE-3739: Refactor protobuf authentication (#922)

GEODE-3739: Refactor protobuf authentication

Use the security settings to determine authentication type, remove new authentication property
Move the authentication and authorization objects out of core
Change authentication messages to use full protobuf message objects
Add and update unit tests

Signed-off-by: Sarge <mdodge@pivotal.io>
Signed-off-by: Brian Rowe <browe@pivotal.io>

+import org.apache.geode.internal.protocol.protobuf.security.Authenticator;
+import org.apache.geode.internal.protocol.protobuf.security.Authorizer;
-import org.apache.geode.security.internal.server.Authenticator;
+import org.apache.geode.security.AuthenticationFailedException;
+
+  private final Authorizer authorizer;
+  private Object authenticatorToken;
+
-      SecurityService securityService) {
+      Authorizer authorizer, SecurityService securityService) {
+    this.authorizer = authorizer;
-    if (!authenticator.isAuthenticated()) {
-      authenticator.authenticate(inputStream, outputStream, securityService.getSecurityManager());
+    if (authenticatorToken == null) {
+      try {
+        authenticatorToken = authenticator.authenticate(inputStream, outputStream, securityService);
+      } catch (AuthenticationFailedException ex) {
+        statistics.incAuthenticationFailures();
+        throw new IOException(ex);
+      }
-          new MessageExecutionContext(cache, authenticator.getAuthorizer(), statistics));
+          new MessageExecutionContext(cache, authorizer, authenticatorToken, statistics));
