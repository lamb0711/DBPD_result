GEODE-7345: break dependency on SocketCreator (#4322)


-import java.util.Properties;
-import org.apache.geode.distributed.internal.DistributionConfigImpl;
-import org.apache.geode.internal.net.SocketCreator;
-import org.apache.geode.internal.net.SocketCreatorFactory;
-import org.apache.geode.internal.security.SecurableCommunicationChannel;
-  protected SocketCreator socketCreator;
+  protected TcpSocketCreator socketCreator;
-  public TcpServer(int port, InetAddress bind_address, Properties sslConfig,
-      DistributionConfigImpl cfg, TcpHandler handler,
+  public TcpServer(int port, InetAddress bind_address,
+      TcpHandler handler,
-      final Supplier<ExecutorService> executorServiceSupplier) {
+      final Supplier<ExecutorService> executorServiceSupplier,
+      final TcpSocketCreator socketCreator) {
-
-    if (cfg == null) {
-      if (sslConfig == null) {
-        sslConfig = new Properties();
-      }
-      cfg = new DistributionConfigImpl(sslConfig);
-    }
-  }
-
-  protected SocketCreator getSocketCreator() {
-    if (this.socketCreator == null) {
-      this.socketCreator =
-          SocketCreatorFactory.getSocketCreatorForComponent(SecurableCommunicationChannel.LOCATOR);
-    }
-    return socketCreator;
+    this.socketCreator = socketCreator;
-        srv_sock = getSocketCreator().createServerSocket(port, BACKLOG);
+        srv_sock = socketCreator.createServerSocket(port, BACKLOG);
-        srv_sock = getSocketCreator().createServerSocket(port, BACKLOG, bind_address);
+        srv_sock = socketCreator.createServerSocket(port, BACKLOG, bind_address);
-        getSocketCreator().handshakeIfSocketIsSSL(socket, READ_TIMEOUT);
+        socketCreator.handshakeIfSocketIsSSL(socket, READ_TIMEOUT);
