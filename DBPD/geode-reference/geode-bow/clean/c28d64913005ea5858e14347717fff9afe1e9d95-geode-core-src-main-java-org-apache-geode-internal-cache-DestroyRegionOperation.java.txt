Merge branch 'release/1.4.0'

-// import org.apache.geode.internal.*;
-// import org.apache.geode.distributed.internal.*;
- * 
+ *
-   * 
+   *
-          // do this before CacheFactory.getInstance for bug 33471
-                advisee =
-                    PartitionedRegionHelper.getProxyBucketRegion(GemFireCacheImpl.getInstance(),
-                        regionPath, waitForBucketInitializationToComplete);
+                advisee = PartitionedRegionHelper.getProxyBucketRegion(dm.getCache(), regionPath,
+                    waitForBucketInitializationToComplete);
-            final LocalRegion lr = getRegionFromPath(dm.getSystem(), lclRgn.getFullPath());
+            final LocalRegion lr = getRegionFromPath(dm, lclRgn.getFullPath());
-    protected LocalRegion getRegionFromPath(InternalDistributedSystem sys, String path) {
+    protected LocalRegion getRegionFromPath(DistributionManager dm, String path) {
-      InternalCache cache = (InternalCache) CacheFactory.getInstance(sys);
+      InternalCache cache = dm.getExistingCache();
