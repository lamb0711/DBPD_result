 GEODE-2668: build tabular command result from a list of function results  (#1127)

* GEODE-2668: build tabular command result from a list of function results

* reduce duplicate code to create the tabular results
* promote presentation consistency
* Add more validation for CreateGatewaySender/Receiver command and reworked the tests

-import java.util.concurrent.atomic.AtomicReference;
-import org.apache.geode.management.internal.cli.result.TabularResultData;
-    // regionPath should already be converted to have "/" in front of it.
-    AtomicReference<XmlEntity> xmlEntity = new AtomicReference<>();
-
-    List<CliFunctionResult> resultsList =
-        executeAndGetFunctionResult(RegionDestroyFunction.INSTANCE, regionPath, regionMembersList);
-
-    TabularResultData tabularData = ResultBuilder.createTabularResultData();
+    List<CliFunctionResult> resultsList =
+        executeAndGetFunctionResult(RegionDestroyFunction.INSTANCE, regionPath, regionMembersList);
-    boolean regionDestroyed = false;
-    for (CliFunctionResult functionResult : resultsList) {
-      tabularData.accumulate("Member", functionResult.getMemberIdOrName());
-      if (functionResult.isSuccessful()) {
-        if (xmlEntity.get() == null) {
-          xmlEntity.set(functionResult.getXmlEntity());
-        }
-        tabularData.accumulate("Status", functionResult.getMessage());
-        regionDestroyed = true;
-      } else {
-        tabularData.accumulate("Status", "Error: " + functionResult.getErrorMessage());
-      }
-    }
-    tabularData.setStatus(regionDestroyed ? Result.Status.OK : Result.Status.ERROR);
-
-    CommandResult result = ResultBuilder.buildResult(tabularData);
+    CommandResult result = ResultBuilder.buildResult(resultsList);
+    XmlEntity xmlEntity = findXmlEntity(resultsList);
-    if (regionDestroyed) {
+    if (xmlEntity != null) {
-          () -> getSharedConfiguration().deleteXmlEntity(xmlEntity.get(), null));
+          () -> getSharedConfiguration().deleteXmlEntity(xmlEntity, null));
