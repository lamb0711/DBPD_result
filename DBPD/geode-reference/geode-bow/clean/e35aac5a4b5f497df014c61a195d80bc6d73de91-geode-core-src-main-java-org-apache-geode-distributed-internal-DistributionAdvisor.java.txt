Merge branch 'release/1.5.0'

-      public void memberJoined(InternalDistributedMember id) {
+      public void memberJoined(DistributionManager distributionManager,
+          InternalDistributedMember id) {
-      public void quorumLost(Set<InternalDistributedMember> failures,
-          List<InternalDistributedMember> remaining) {}
+      public void quorumLost(DistributionManager distributionManager,
+          Set<InternalDistributedMember> failures, List<InternalDistributedMember> remaining) {}
-      public void memberDeparted(final InternalDistributedMember id, boolean crashed) {
+      public void memberDeparted(DistributionManager distributionManager,
+          final InternalDistributedMember id, boolean crashed) {
-      public void memberSuspect(InternalDistributedMember id,
-          InternalDistributedMember whoSuspected, String reason) {}
+      public void memberSuspect(DistributionManager distributionManager,
+          InternalDistributedMember id, InternalDistributedMember whoSuspected, String reason) {}
-  public DM getDistributionManager() {
+  public DistributionManager getDistributionManager() {
+  /**
+   * Like getDistributionManager but does not check
+   * that the DistributedSystem is still connected
+   */
+  private DistributionManager getDistributionManagerWithNoCheck() {
+    return getAdvisee().getSystem().getDM();
+  }
+
-        ((MembershipListener) it.next()).memberJoined(member);
+        ((MembershipListener) it.next()).memberJoined(getDistributionManagerWithNoCheck(), member);
-        logger.fatal(
-            LocalizedMessage.create(LocalizedStrings.DistributionAdvisor_UNEXPECTED_EXCEPTION), e);
+        logger.warn("Ignoring exception during member joined listener notification", e);
-        ((MembershipListener) it.next()).memberDeparted(member, crashed);
+        ((MembershipListener) it.next()).memberDeparted(getDistributionManagerWithNoCheck(), member,
+            crashed);
-        logger.fatal(
-            LocalizedMessage.create(LocalizedStrings.DistributionAdvisor_UNEXPECTED_EXCEPTION), e);
+        logger.warn("Ignoring exception during member departed listener notification", e);
-  public static interface ProfileVisitor<T> {
+  public interface ProfileVisitor<T> {
-  protected static interface Filter {
-    public boolean include(Profile profile);
+  protected interface Filter {
+    boolean include(Profile profile);
-  public static interface ProfileId {
+  public interface ProfileId {
-    public void processIncoming(DistributionManager dm, String adviseePath, boolean removeProfile,
-        boolean exchangeProfiles, final List<Profile> replyProfiles) {
+    public void processIncoming(ClusterDistributionManager dm, String adviseePath,
+        boolean removeProfile, boolean exchangeProfiles, final List<Profile> replyProfiles) {
