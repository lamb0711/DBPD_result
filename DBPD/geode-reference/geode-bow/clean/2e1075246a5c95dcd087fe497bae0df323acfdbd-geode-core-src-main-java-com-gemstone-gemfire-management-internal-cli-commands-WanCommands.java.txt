Merge branch 'release/1.0.0-incubating.M3'

-import java.util.HashSet;
-
-import org.springframework.shell.core.CommandMarker;
-import org.springframework.shell.core.annotation.CliAvailabilityIndicator;
-import org.springframework.shell.core.annotation.CliCommand;
-import org.springframework.shell.core.annotation.CliOption;
-
-import com.gemstone.gemfire.internal.i18n.LocalizedStrings;
+import com.gemstone.gemfire.management.internal.security.ResourceOperation;
+import org.apache.geode.security.GeodePermission.Operation;
+import org.apache.geode.security.GeodePermission.Resource;
+
+import org.springframework.shell.core.CommandMarker;
+import org.springframework.shell.core.annotation.CliAvailabilityIndicator;
+import org.springframework.shell.core.annotation.CliCommand;
+import org.springframework.shell.core.annotation.CliOption;
-  
+
-  @CliMetaData(relatedTopic = CliStrings.TOPIC_GEMFIRE_WAN, writesToSharedConfiguration=true)
+  @CliMetaData(relatedTopic = CliStrings.TOPIC_GEODE_WAN, writesToSharedConfiguration=true)
+  @ResourceOperation(resource = Resource.DATA, operation = Operation.MANAGE)
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__MEMBER, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__MEMBER,
-      help = CliStrings.CREATE_GATEWAYSENDER__MEMBER__HELP) 
+      help = CliStrings.CREATE_GATEWAYSENDER__MEMBER__HELP)
-          
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__ID, 
-      mandatory = true, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__ID,
+      mandatory = true,
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__REMOTEDISTRIBUTEDSYSTEMID, 
-      mandatory = true, 
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__REMOTEDISTRIBUTEDSYSTEMID,
+      mandatory = true,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__PARALLEL, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__PARALLEL,
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__MANUALSTART, 
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__MANUALSTART,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__SOCKETBUFFERSIZE, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__SOCKETBUFFERSIZE,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__SOCKETREADTIMEOUT, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__SOCKETREADTIMEOUT,
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__ENABLEBATCHCONFLATION, 
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__ENABLEBATCHCONFLATION,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__BATCHSIZE, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__BATCHSIZE,
-          
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__BATCHTIMEINTERVAL, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__BATCHTIMEINTERVAL,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__ENABLEPERSISTENCE, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__ENABLEPERSISTENCE,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__DISKSTORENAME, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__DISKSTORENAME,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__DISKSYNCHRONOUS, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__DISKSYNCHRONOUS,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__MAXQUEUEMEMORY, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__MAXQUEUEMEMORY,
-          
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__ALERTTHRESHOLD, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__ALERTTHRESHOLD,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__DISPATCHERTHREADS, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__DISPATCHERTHREADS,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__ORDERPOLICY, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__ORDERPOLICY,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__GATEWAYEVENTFILTER, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__GATEWAYEVENTFILTER,
-      @CliMetaData (valueSeparator = ",") 
+      @CliMetaData (valueSeparator = ",")
-          
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__GATEWAYTRANSPORTFILTER, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__GATEWAYTRANSPORTFILTER,
-      @CliMetaData (valueSeparator = ",") 
+      @CliMetaData (valueSeparator = ",")
-      GatewaySenderFunctionArgs gatewaySenderFunctionArgs = 
+      GatewaySenderFunctionArgs gatewaySenderFunctionArgs =
-            remoteDistributedSystemId, parallel, manualStart, socketBufferSize, socketReadTimeout, 
-            enableBatchConflation, batchSize, batchTimeInterval, enablePersistence, diskStoreName, 
-            diskSynchronous, maxQueueMemory, alertThreshold, dispatcherThreads, orderPolicy, 
+            remoteDistributedSystemId, parallel, manualStart, socketBufferSize, socketReadTimeout,
+            enableBatchConflation, batchSize, batchTimeInterval, enablePersistence, diskStoreName,
+            diskSynchronous, maxQueueMemory, alertThreshold, dispatcherThreads, orderPolicy,
-      
+
-      
+
-      
+
-        
+
-    
+
-  @CliMetaData(relatedTopic = CliStrings.TOPIC_GEMFIRE_WAN)
+  @CliMetaData(relatedTopic = CliStrings.TOPIC_GEODE_WAN)
+  @ResourceOperation(resource = Resource.DATA, operation = Operation.MANAGE)
-      @CliOption(key = CliStrings.START_GATEWAYSENDER__ID, 
-      mandatory = true, 
+      @CliOption(key = CliStrings.START_GATEWAYSENDER__ID,
+      mandatory = true,
-      
+
-      
-      @CliOption(key = CliStrings.START_GATEWAYSENDER__MEMBER, 
+
+      @CliOption(key = CliStrings.START_GATEWAYSENDER__MEMBER,
-      help = CliStrings.START_GATEWAYSENDER__MEMBER__HELP) 
+      help = CliStrings.START_GATEWAYSENDER__MEMBER__HELP)
-    
+
-        
+
-          
+
-            
+
-      
+
-      
+
-      
+
-    
+
-  @CliMetaData(relatedTopic = CliStrings.TOPIC_GEMFIRE_WAN)
+  @CliMetaData(relatedTopic = CliStrings.TOPIC_GEODE_WAN)
+  @ResourceOperation(resource = Resource.DATA, operation = Operation.MANAGE)
-      @CliOption(key = CliStrings.PAUSE_GATEWAYSENDER__ID, 
-      mandatory = true, 
+      @CliOption(key = CliStrings.PAUSE_GATEWAYSENDER__ID,
+      mandatory = true,
-      
+
-      help = CliStrings.PAUSE_GATEWAYSENDER__GROUP__HELP) 
+      help = CliStrings.PAUSE_GATEWAYSENDER__GROUP__HELP)
-      
-      @CliOption(key = CliStrings.PAUSE_GATEWAYSENDER__MEMBER, 
+
+      @CliOption(key = CliStrings.PAUSE_GATEWAYSENDER__MEMBER,
-      help = CliStrings.PAUSE_GATEWAYSENDER__MEMBER__HELP) 
+      help = CliStrings.PAUSE_GATEWAYSENDER__MEMBER__HELP)
-    
+
-      
+
-  @CliMetaData(relatedTopic = CliStrings.TOPIC_GEMFIRE_WAN)
+  @CliMetaData(relatedTopic = CliStrings.TOPIC_GEODE_WAN)
+  @ResourceOperation(resource=Resource.DATA, operation = Operation.MANAGE)
-      @CliOption(key = CliStrings.RESUME_GATEWAYSENDER__ID, 
-      mandatory = true, 
+      @CliOption(key = CliStrings.RESUME_GATEWAYSENDER__ID,
+      mandatory = true,
-      
+
-      help = CliStrings.RESUME_GATEWAYSENDER__GROUP__HELP) 
+      help = CliStrings.RESUME_GATEWAYSENDER__GROUP__HELP)
-      
-      @CliOption(key = CliStrings.RESUME_GATEWAYSENDER__MEMBER, 
+
+      @CliOption(key = CliStrings.RESUME_GATEWAYSENDER__MEMBER,
-      help = CliStrings.RESUME_GATEWAYSENDER__MEMBER__HELP) 
+      help = CliStrings.RESUME_GATEWAYSENDER__MEMBER__HELP)
-    
+
-  @CliMetaData(relatedTopic = CliStrings.TOPIC_GEMFIRE_WAN)
+  @CliMetaData(relatedTopic = CliStrings.TOPIC_GEODE_WAN)
+  @ResourceOperation(resource = Resource.DATA, operation = Operation.MANAGE)
-      @CliOption(key = CliStrings.STOP_GATEWAYSENDER__ID, 
-      mandatory = true, 
+      @CliOption(key = CliStrings.STOP_GATEWAYSENDER__ID,
+      mandatory = true,
-      
+
-      
-      @CliOption(key = CliStrings.STOP_GATEWAYSENDER__MEMBER, 
+
+      @CliOption(key = CliStrings.STOP_GATEWAYSENDER__MEMBER,
-      help = CliStrings.STOP_GATEWAYSENDER__MEMBER__HELP) 
+      help = CliStrings.STOP_GATEWAYSENDER__MEMBER__HELP)
-    
+
-   
+
-  
+
-  @CliMetaData(relatedTopic = CliStrings.TOPIC_GEMFIRE_WAN)
+  @CliMetaData(relatedTopic = CliStrings.TOPIC_GEODE_WAN)
+  @ResourceOperation( resource=Resource.DATA, operation = Operation.MANAGE)
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__MEMBER, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__MEMBER,
-      help = CliStrings.CREATE_GATEWAYRECEIVER__MEMBER__HELP) 
+      help = CliStrings.CREATE_GATEWAYRECEIVER__MEMBER__HELP)
-          
-      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__MANUALSTART, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__MANUALSTART,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__STARTPORT, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__STARTPORT,
-      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__ENDPORT, 
+      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__ENDPORT,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__BINDADDRESS, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__BINDADDRESS,
-      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__MAXTIMEBETWEENPINGS, 
+      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__MAXTIMEBETWEENPINGS,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__SOCKETBUFFERSIZE, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__SOCKETBUFFERSIZE,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__GATEWAYTRANSPORTFILTER, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__GATEWAYTRANSPORTFILTER,
-      @CliMetaData (valueSeparator = ",") 
+      @CliMetaData (valueSeparator = ",")
-        
+
-    
+
-    
+
-  @CliMetaData(relatedTopic = CliStrings.TOPIC_GEMFIRE_WAN)
+  @CliMetaData(relatedTopic = CliStrings.TOPIC_GEODE_WAN)
+  @ResourceOperation(resource = Resource.DATA, operation = Operation.MANAGE)
-      @CliOption(key = CliStrings.LOAD_BALANCE_GATEWAYSENDER__ID, 
-      mandatory = true, 
+      @CliOption(key = CliStrings.LOAD_BALANCE_GATEWAYSENDER__ID,
+      mandatory = true,
-    
+
-  @CliMetaData(relatedTopic = CliStrings.TOPIC_GEMFIRE_WAN)
+  @CliMetaData(relatedTopic = CliStrings.TOPIC_GEODE_WAN)
+  @ResourceOperation(resource = Resource.DATA, operation = Operation.MANAGE)
-      help = CliStrings.START_GATEWAYRECEIVER__GROUP__HELP) 
+      help = CliStrings.START_GATEWAYRECEIVER__GROUP__HELP)
-      
-      @CliOption(key = CliStrings.START_GATEWAYRECEIVER__MEMBER, 
+
+      @CliOption(key = CliStrings.START_GATEWAYRECEIVER__MEMBER,
-      help = CliStrings.START_GATEWAYRECEIVER__MEMBER__HELP) 
+      help = CliStrings.START_GATEWAYRECEIVER__MEMBER__HELP)
-  @CliMetaData(relatedTopic = CliStrings.TOPIC_GEMFIRE_WAN)
+  @CliMetaData(relatedTopic = CliStrings.TOPIC_GEODE_WAN)
+  @ResourceOperation(resource = Resource.DATA, operation = Operation.MANAGE)
-      
-      @CliOption(key = CliStrings.STOP_GATEWAYRECEIVER__GROUP, 
+
+      @CliOption(key = CliStrings.STOP_GATEWAYRECEIVER__GROUP,
-      help = CliStrings.STOP_GATEWAYRECEIVER__GROUP__HELP) 
+      help = CliStrings.STOP_GATEWAYRECEIVER__GROUP__HELP)
-      
-      @CliOption(key = CliStrings.STOP_GATEWAYRECEIVER__MEMBER, 
+
+      @CliOption(key = CliStrings.STOP_GATEWAYRECEIVER__MEMBER,
-      help = CliStrings.STOP_GATEWAYRECEIVER__MEMBER__HELP) 
+      help = CliStrings.STOP_GATEWAYRECEIVER__MEMBER__HELP)
-    
+
-  @CliMetaData(relatedTopic = CliStrings.TOPIC_GEMFIRE_WAN)
+  @CliMetaData(relatedTopic = CliStrings.TOPIC_GEODE_WAN)
+  @ResourceOperation(resource = Resource.CLUSTER, operation = Operation.READ)
-      help = CliStrings.LIST_GATEWAY__GROUP__HELP) 
+      help = CliStrings.LIST_GATEWAY__GROUP__HELP)
-    
+
-  @CliMetaData(relatedTopic = CliStrings.TOPIC_GEMFIRE_WAN)
+  @CliMetaData(relatedTopic = CliStrings.TOPIC_GEODE_WAN)
+  @ResourceOperation(resource = Resource.CLUSTER, operation = Operation.READ)
-      @CliOption(key = CliStrings.STATUS_GATEWAYSENDER__ID, 
-      mandatory = true, 
+      @CliOption(key = CliStrings.STATUS_GATEWAYSENDER__ID,
+      mandatory = true,
-      
+
-      help = CliStrings.STATUS_GATEWAYSENDER__GROUP__HELP) 
+      help = CliStrings.STATUS_GATEWAYSENDER__GROUP__HELP)
-      
-      @CliOption(key = CliStrings.STATUS_GATEWAYSENDER__MEMBER, 
+
+      @CliOption(key = CliStrings.STATUS_GATEWAYSENDER__MEMBER,
-    
+
-  @CliMetaData(relatedTopic = CliStrings.TOPIC_GEMFIRE_WAN)
+  @CliMetaData(relatedTopic = CliStrings.TOPIC_GEODE_WAN)
+  @ResourceOperation(resource = Resource.CLUSTER, operation = Operation.READ)
-      @CliOption(key = CliStrings.STATUS_GATEWAYRECEIVER__GROUP, 
+      @CliOption(key = CliStrings.STATUS_GATEWAYRECEIVER__GROUP,
-      
-      @CliOption(key = CliStrings.STATUS_GATEWAYRECEIVER__MEMBER, 
+
+      @CliOption(key = CliStrings.STATUS_GATEWAYRECEIVER__MEMBER,
-      help = CliStrings.STATUS_GATEWAYRECEIVER__MEMBER__HELP) 
+      help = CliStrings.STATUS_GATEWAYRECEIVER__MEMBER__HELP)
-    
+
-  
+
-  
+
