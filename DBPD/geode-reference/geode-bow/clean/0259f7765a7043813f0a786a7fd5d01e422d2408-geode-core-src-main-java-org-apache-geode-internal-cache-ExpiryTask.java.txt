GEODE-3764: prevent early idle expiration (#940)

Idle expiration now sends a message to others checking
if they have been read more recently. If so and if given
the new last access time the entry is not expired then
the expiration is rescheduled.
This is only done for distributed expiration actions.
This change applies to both replicates and partitioned regions.

The system property "geode.restoreIdleExpirationBehavior" can
be set to true to restore the previous idle expiration behavior.
+    long idle = getIdleTimeoutInMillis();
+    if (idle > 0) {
+      return getLastAccessedTime() + idle;
+    }
+    return 0L;
+  }
+
+  protected long getIdleTimeoutInMillis() {
-    long tilt = 0;
-      tilt = getLastAccessedTime() + idle;
-    return tilt;
+    return idle;
-    if (expTime > 0L && getNow() >= expTime) {
-      return true;
+    if (expTime > 0L) {
+      long now = getNow();
+      if (now >= expTime) {
+        if (isIdleExpiredOnOthers()) {
+          return true;
+        } else {
+          // our last access time was reset so recheck
+          expTime = getExpirationTime();
+          if (expTime > 0L && now >= expTime) {
+            return true;
+          }
+        }
+      }
+   * Added for GEODE-3764.
+   * 
+   * @return true if other members last access time indicates we have expired
+   */
+  protected boolean isIdleExpiredOnOthers() throws EntryNotFoundException {
+    // by default return true since we don't need to check with others
+    return true;
+  }
+
+  /**
