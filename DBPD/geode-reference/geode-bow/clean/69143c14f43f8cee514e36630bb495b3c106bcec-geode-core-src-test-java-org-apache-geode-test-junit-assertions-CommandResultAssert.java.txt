GEODE-3961: Refactor ShowMetricsCommand to handle --categories uniformly

* GEODE-3961: Refactor ShowMetricsCommand to behave uniformly when --categories is provided.

* The ShowMetricsCommand has been almost entirely refactored, but with minimal change to existing behavior.
* The category "cache-server" has been renamed to "cacheserver"
* The "query" category now only lists once instead of twice.
* Category checking is now performed by the client, not the server.
* Alphabetized excludedClasses.txt

-    Object content = resultContentJSON.get(header);
+    Object content = getColumnContent(header, resultContentJSON);
-    Object content = resultContentJSON.get(header);
+    Object content = getColumnContent(header, resultContentJSON);
-    Object content = resultContentJSON.get(header);
+    Object content = getColumnContent(header, resultContentJSON);
+
+  /**
+   * Verifies that each of the actual values in the column with the given header contains at least
+   * one of the expectedValues.
+   */
+  public CommandResultAssert tableHasColumnOnlyWithValues(String header, String... expectedValues) {
+    GfJsonObject resultContentJSON = actual.getCommandResult().getContent();
+    Object content = getColumnContent(header, resultContentJSON);
+
+    if (content == null) {
+      failWithMessage("Command result did not contain a table with column header <" + header + ">: "
+          + resultContentJSON.toString());
+    }
+
+    Object[] actualValues = toArray((JSONArray) content);
+    assertThat(actualValues).containsOnly(expectedValues);
+    return this;
+  }
+
+  private Object getColumnContent(String header, GfJsonObject resultContentJSON) {
+    if (resultContentJSON.get(header) != null) {
+      return resultContentJSON.get(header);
+    }
+    try {
+      // Sometimes, the output is buried in a most questionable way.
+      return resultContentJSON.getJSONObject("__sections__-0").getJSONObject("__tables__-0")
+          .getJSONObject("content").get(header);
+    } catch (NullPointerException ignored) {
+    }
+    return null;
+  }
+
