GEODE-8338: change redis commands not be repeated when a server dies (#5351)

The redis functions are no longer HA.
The product does have some cases when it can safely retry the function
but if a server dies the client will see a redis error containing "memberDeparted".
In that case the client app can check to see if the redis operation should be done
again, or if it already happened even though a server died.

Co-authored-by: Sarah Abbey <sabbey@vmware.com>
Co-authored-by: Darrel Schneider <darrel@vmware.com>
+import org.apache.geode.cache.execute.FunctionInvocationTargetException;
+import org.apache.geode.redis.internal.executor.CommandFunction;
-    if (cause instanceof FunctionException) {
-      Throwable th = cause.getCause();
-      if (th == null) {
-        FunctionException functionException = (FunctionException) cause;
-        if (functionException.getExceptions() != null) {
-          th = functionException.getExceptions().get(0);
-        }
-      }
+    if (cause instanceof FunctionException
+        && !(cause instanceof FunctionInvocationTargetException)) {
+      Throwable th = CommandFunction.getInitialCause((FunctionException) cause);
+    } else if (cause instanceof FunctionInvocationTargetException) {
+      // This indicates a member departed
+      String errorMsg = cause.getMessage();
+      if (!errorMsg.contains("memberDeparted")) {
+        errorMsg = "memberDeparted: " + errorMsg;
+      }
+      response = RedisResponse.error(errorMsg);
