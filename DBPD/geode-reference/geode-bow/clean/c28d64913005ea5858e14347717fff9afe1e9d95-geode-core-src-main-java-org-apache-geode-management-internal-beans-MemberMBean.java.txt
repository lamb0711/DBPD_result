Merge branch 'release/1.4.0'

+import java.io.File;
+import java.io.IOException;
+import java.util.List;
-import org.apache.geode.internal.util.ArrayUtils;
+import org.apache.commons.io.FileUtils;
+
+import org.apache.geode.management.internal.cli.CliUtil;
- * 
- * 
+ *
+ *
-    return processCommand(commandString, env, null);
+    return processCommand(commandString, env, (List<String>) null);
+  public String processCommand(String commandString, Map<String, String> env,
+      List<String> stagedFilePaths) {
+    return bridge.processCommand(commandString, env, stagedFilePaths);
+  }
+
+  @Override
+  /**
+   * We don't expect any callers to call this code, but just in case, implementation is provided for
+   * backward compatibility
+   *
+   * @deprecated since 1.4 use processCommand(String commandString, Map<String, String> env,
+   *             List<String> stagedFilePaths)
+   */
-    return bridge.processCommand(commandString, env, ArrayUtils.toBytes(binaryData));
+    // save the binaryData into stagedFile first, and then call the new api
+    File tempDir = FileUtils.getTempDirectory();
+    List<String> filePaths = null;
+    try {
+      filePaths = CliUtil.bytesToFiles(binaryData, tempDir.getAbsolutePath());
+      return bridge.processCommand(commandString, env, filePaths);
+    } catch (IOException e) {
+      throw new RuntimeException(e.getMessage(), e);
+    } finally {
+      // delete the staged files
+      FileUtils.deleteQuietly(tempDir);
+    }
