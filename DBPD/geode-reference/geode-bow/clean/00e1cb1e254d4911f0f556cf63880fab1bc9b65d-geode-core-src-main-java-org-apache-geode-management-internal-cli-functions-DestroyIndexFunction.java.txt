GEODE-2566: Add --if-exists option to destroy index (#1014)

* GEODE-2566: Add --if-exists option to destroy index

* GEODE-2566: Review updates

-import org.apache.geode.cache.execute.FunctionAdapter;
+import org.apache.geode.cache.execute.Function;
-
-
-public class DestroyIndexFunction extends FunctionAdapter implements InternalEntity {
-
-  private static final long serialVersionUID = 1L;
+public class DestroyIndexFunction implements Function, InternalEntity {
+  private static final long serialVersionUID = -868082551095130315L;
+    CliFunctionResult result;
-            context.getResultSender().lastResult(new CliFunctionResult(memberId, xmlEntity));
+            result = new CliFunctionResult(memberId, xmlEntity,
+                "Destroyed all indexes on region " + regionPath);
-              context.getResultSender().lastResult(new CliFunctionResult(memberId, xmlEntity));
+              result = new CliFunctionResult(memberId, xmlEntity,
+                  "Destroyed index " + indexName + " on region " + regionPath);
+            } else if (indexInfo.isIfExists()) {
+              result = new CliFunctionResult(memberId, true,
+                  "Index " + indexName + " not found - skipped");
-              context.getResultSender().lastResult(new CliFunctionResult(memberId, false,
-                  CliStrings.format(CliStrings.DESTROY_INDEX__INDEX__NOT__FOUND, indexName)));
+              result = new CliFunctionResult(memberId, false,
+                  CliStrings.format(CliStrings.DESTROY_INDEX__INDEX__NOT__FOUND, indexName));
-          context.getResultSender().lastResult(new CliFunctionResult(memberId, false,
-              CliStrings.format(CliStrings.DESTROY_INDEX__REGION__NOT__FOUND, regionPath)));
+          result = new CliFunctionResult(memberId, false,
+              CliStrings.format(CliStrings.DESTROY_INDEX__REGION__NOT__FOUND, regionPath));
-
-          context.getResultSender().lastResult(new CliFunctionResult(memberId, xmlEntity));
+          result = new CliFunctionResult(memberId, xmlEntity, "Destroyed all indexes");
-          if (removeIndexByName(indexName, queryService)) {
-            context.getResultSender().lastResult(new CliFunctionResult(memberId, xmlEntity));
+          boolean indexRemoved = removeIndexByName(indexName, queryService);
+          if (indexRemoved) {
+            result = new CliFunctionResult(memberId, xmlEntity, "Destroyed index " + indexName);
+          } else if (indexInfo.isIfExists()) {
+            result = new CliFunctionResult(memberId, true,
+                "Index " + indexName + " not found - skipped");
-            context.getResultSender().lastResult(new CliFunctionResult(memberId, false,
-                CliStrings.format(CliStrings.DESTROY_INDEX__INDEX__NOT__FOUND, indexName)));
+            result = new CliFunctionResult(memberId, false,
+                CliStrings.format(CliStrings.DESTROY_INDEX__INDEX__NOT__FOUND, indexName));
-      context.getResultSender().lastResult(new CliFunctionResult(memberId, e, e.getMessage()));
+      result = new CliFunctionResult(memberId, e, e.getMessage());
-      context.getResultSender().lastResult(new CliFunctionResult(memberId, e, e.getMessage()));
+      result = new CliFunctionResult(memberId, e, e.getMessage());
+
+    context.getResultSender().lastResult(result);
