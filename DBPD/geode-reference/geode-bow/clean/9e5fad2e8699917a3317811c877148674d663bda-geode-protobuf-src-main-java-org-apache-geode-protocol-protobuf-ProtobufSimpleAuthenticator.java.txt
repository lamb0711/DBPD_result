GEODE-3447 Implement client authorization for the new protocol

Implementation of authorization checks for the new protocol.

+import org.apache.geode.security.AuthenticationRequiredException;
+import org.apache.geode.security.StreamAuthorizer;
+  private ProtobufSimpleAuthorizer authorizer = null;
+    authorizer = null; // authenticating a new user clears current authorizer
-      authenticated = principal != null;
+      if (principal != null) {
+        authorizer = new ProtobufSimpleAuthorizer(principal, securityManager);
+      }
-      authenticated = false;
+      authorizer = null;
-    AuthenticationAPI.SimpleAuthenticationResponse.newBuilder().setAuthenticated(authenticated)
+    AuthenticationAPI.SimpleAuthenticationResponse.newBuilder().setAuthenticated(isAuthenticated())
-    return authenticated;
+    // note: an authorizer is only created if the user has been authenticated
+    return authorizer != null;
+  }
+
+  @Override
+  public StreamAuthorizer getAuthorizer() throws AuthenticationRequiredException {
+    if (authorizer == null) {
+      throw new AuthenticationRequiredException("Not yet authenticated");
+    }
+    return authorizer;
