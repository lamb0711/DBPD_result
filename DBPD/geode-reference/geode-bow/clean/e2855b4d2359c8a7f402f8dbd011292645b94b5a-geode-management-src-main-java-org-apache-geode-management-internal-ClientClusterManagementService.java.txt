GEODE-7024: raise a Java exception on non-success response from REST API (#3861)

* GEODE-7024: raise a Java exception on non-success response from REST call
+import org.apache.geode.management.api.ClusterManagementException;
-    return restTemplate
+    return assertSuccessful(restTemplate
-        .getBody();
+        .getBody());
-    return restTemplate
+    return assertSuccessful(restTemplate
-        .getBody();
+        .getBody());
-    return restTemplate
+    return assertSuccessful(restTemplate
-        .getBody();
+        .getBody());
-    return restTemplate
+    return assertSuccessful(restTemplate
-        .getBody();
+        .getBody());
-    result = restTemplate.postForEntity(RestfulEndpoint.URI_VERSION + op.getEndpoint(), op,
-        ClusterManagementOperationResult.class).getBody();
+    result =
+        assertSuccessful(restTemplate.postForEntity(RestfulEndpoint.URI_VERSION + op.getEndpoint(),
+            op, ClusterManagementOperationResult.class).getBody());
-    result = restTemplate.getForEntity(RestfulEndpoint.URI_VERSION + opType.getEndpoint(),
-        ClusterManagementListOperationsResult.class).getBody();
+    result = assertSuccessful(
+        restTemplate.getForEntity(RestfulEndpoint.URI_VERSION + opType.getEndpoint(),
+            ClusterManagementListOperationsResult.class).getBody());
+  private <T extends ClusterManagementResult> T assertSuccessful(T result) {
+    if (!result.isSuccessful()) {
+      throw new ClusterManagementException(result);
+    }
+    return result;
+  }
+
-    return restTemplate.getForEntity(RestfulEndpoint.URI_VERSION + "/ping", String.class)
-        .getBody().equals("pong");
+    try {
+      return restTemplate.getForEntity(RestfulEndpoint.URI_VERSION + "/ping", String.class)
+          .getBody().equals("pong");
+    } catch (Exception e) {
+      return false;
+    }
