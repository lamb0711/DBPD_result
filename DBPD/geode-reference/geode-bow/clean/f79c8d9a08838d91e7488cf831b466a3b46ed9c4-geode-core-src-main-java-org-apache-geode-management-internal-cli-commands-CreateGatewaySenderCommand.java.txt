Merge branch 'develop' into add-extensions-to-classpath-155484283
+import org.apache.geode.distributed.internal.InternalClusterConfigurationService;
+import org.apache.geode.distributed.internal.membership.InternalDistributedMember;
+import org.apache.geode.internal.Version;
-public class CreateGatewaySenderCommand extends GfshCommand {
+public class CreateGatewaySenderCommand extends InternalGfshCommand {
+    // Don't allow sender to be created if all members are not the current version.
+    if (!verifyAllCurrentVersion(membersToCreateGatewaySenderOn)) {
+      return ResultBuilder.createUserErrorResult(
+          CliStrings.CREATE_GATEWAYSENDER__MSG__CAN_NOT_CREATE_DIFFERENT_VERSIONS);
+    }
+
-    if (onMember != null || getSharedConfiguration() == null) {
+    if (onMember != null || getConfigurationService() == null) {
-    getSharedConfiguration().addXmlEntity(xmlEntity, onGroups);
+    ((InternalClusterConfigurationService) getConfigurationService()).addXmlEntity(xmlEntity,
+        onGroups);
+  private boolean verifyAllCurrentVersion(Set<DistributedMember> members) {
+    return members.stream().allMatch(
+        member -> ((InternalDistributedMember) member).getVersionObject().equals(Version.CURRENT));
+  }
+
