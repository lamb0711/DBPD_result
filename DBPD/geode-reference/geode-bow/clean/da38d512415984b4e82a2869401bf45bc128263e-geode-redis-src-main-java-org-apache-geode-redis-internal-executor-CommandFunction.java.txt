GEODE-8076: simplify redis concurrency code (#5019)

Added StripedExecutor which is used by the redis set functions to cause all operations for a given key to be executed sequentially.
Note that DeltaSet has been renamed to RedisSet.
The RedisSet interface is now named RedisSetCommands.

Co-authored-by: Darrel Schneider <dschneider@pivotal.io>
Co-authored-by: Murtuza <mboxwala@pivotal.io>
Co-authored-by: Sarah <sabbey@pivotal.io>
Co-authored-by: john <jhutchison@gmail.com>
+import java.util.concurrent.atomic.AtomicBoolean;
-import org.apache.geode.redis.internal.executor.set.DeltaSet;
+import org.apache.geode.redis.internal.executor.set.RedisSet;
+import org.apache.geode.redis.internal.executor.set.StripedExecutor;
+  private final transient StripedExecutor stripedExecutor;
+
+  public CommandFunction(StripedExecutor stripedExecutor) {
+    this.stripedExecutor = stripedExecutor;
+  }
+
-    Region<ByteArrayWrapper, DeltaSet> localRegion =
+    Region<ByteArrayWrapper, RedisSet> localRegion =
-    ArrayList<ByteArrayWrapper> membersToAdd = (ArrayList<ByteArrayWrapper>) args[1];
+    ArrayList<ByteArrayWrapper> commandArgs = (ArrayList<ByteArrayWrapper>) args[1];
-        DeltaSet.sadd(resultSender, localRegion, key, membersToAdd);
+        stripedExecutor.execute(key,
+            () -> RedisSet.sadd(localRegion, key, commandArgs),
+            (addedCount) -> resultSender.lastResult(addedCount));
-        DeltaSet.srem(resultSender, localRegion, key, membersToAdd);
+        AtomicBoolean setWasDeleted = new AtomicBoolean();
+        stripedExecutor.execute(key,
+            () -> RedisSet.srem(localRegion, key, commandArgs, setWasDeleted),
+            (removedCount) -> {
+              resultSender.sendResult(removedCount);
+              resultSender.lastResult(setWasDeleted.get() ? 1L : 0L);
+            });
-        DeltaSet.del(resultSender, localRegion, key);
+        stripedExecutor.execute(key,
+            () -> RedisSet.del(localRegion, key),
+            (deleted) -> resultSender.lastResult(deleted));
-        DeltaSet.smembers(resultSender, localRegion, key);
+        stripedExecutor.execute(key,
+            () -> RedisSet.members(localRegion, key),
+            (members) -> resultSender.lastResult(members));
