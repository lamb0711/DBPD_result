Feature/geode 3583 storage (#1285)

* This resolves the following tickets: GEODE-4196, GEODE-4197, GEODE-4198, GEODE-4199
   GEODE-4200, GEODE-4201, GEODE-4203, GEODE-4204, GEODE-4205, GEODE-4206
   GEODE-4208, GEODE-4209, GEODE-4210, GEODE-4212, and GEODE-4213
-import org.apache.geode.distributed.internal.InternalDistributedSystem;
-  private static final boolean DISABLE_MONITOR =
-      Boolean.getBoolean(DistributionConfig.GEMFIRE_PREFIX + "DISK_USAGE_DISABLE_MONITORING");
-
+  static final String DISK_USAGE_DISABLE_MONITORING =
+      DistributionConfig.GEMFIRE_PREFIX + "DISK_USAGE_DISABLE_MONITORING";
+
+  private final boolean disableMonitor = Boolean.getBoolean(DISK_USAGE_DISABLE_MONITORING);
+
-  public DiskStoreMonitor() {
+  public DiskStoreMonitor(File logFile) {
-    logDisk = new LogUsage(getLogDir());
+    logDisk = new LogUsage(getLogDir(logFile));
-          (DISABLE_MONITOR ? "disabled" : "enabled"));
+          (disableMonitor ? "disabled" : "enabled"));
-    if (DISABLE_MONITOR) {
+    if (disableMonitor) {
+  LogUsage getLogDisk() {
+    return logDisk;
+  }
+
-  private File getLogDir() {
-    File log = null;
-    InternalCache internalCache = GemFireCacheImpl.getInstance();
-    if (internalCache != null) {
-      InternalDistributedSystem ds = internalCache.getInternalDistributedSystem();
-      if (ds != null) {
-        DistributionConfig conf = ds.getConfig();
-        if (conf != null) {
-          log = conf.getLogFile();
-          if (log != null) {
-            log = log.getParentFile();
-          }
-        }
-      }
+  private static File getLogDir(File logFile) {
+    File logDir = null;
+    if (logFile != null) {
+      logDir = logFile.getParentFile();
-    if (log == null) {
+    if (logDir == null) {
-      log = new File(".");
+      logDir = new File(".");
-    return log;
+    return logDir;
