GEODE-3273: If serializer returns empty, should update index.
            Add junit tests for IndexRepositoryImpl.update()

-    searcherManager = new SearcherManager(writer, APPLY_ALL_DELETES, true, null);
+    searcherManager = createSearchManager();
+  protected SearcherManager createSearchManager() throws IOException {
+    return new SearcherManager(writer, APPLY_ALL_DELETES, true, null);
+  }
+
+    boolean exceptionHappened = false;
+        exceptionHappened = true;
-      if (!docs.isEmpty()) {
+      if (!exceptionHappened) {
+    boolean exceptionHappened = false;
+        exceptionHappened = true;
-      if (!docs.isEmpty()) {
+      if (!exceptionHappened) {
