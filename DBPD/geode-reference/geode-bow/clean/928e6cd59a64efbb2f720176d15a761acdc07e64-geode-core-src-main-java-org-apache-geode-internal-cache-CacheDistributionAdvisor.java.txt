GEODE-6807: Added UT and inRecovery update check

+  private volatile long inRecoveryVersion = 0;
+  private volatile long adviseInRecoveryVersion = -1;
+
+  public synchronized void incInRecoveryVersion() {
+    inRecoveryVersion++;
+  }
-  private Set<InternalDistributedMember> adviseAllEventsOrCached()
+  Set<InternalDistributedMember> adviseAllEventsOrCached()
-    if (adviseAllEventsVersion != tempProfilesVersion) {
+    long tempInRecoveryVersion = inRecoveryVersion; // volatile read
+
+    if (adviseAllEventsVersion != tempProfilesVersion
+        || adviseInRecoveryVersion != tempInRecoveryVersion) {
-        if (adviseAllEventsVersion != tempProfilesVersion) {
+        if (adviseAllEventsVersion != tempProfilesVersion
+            || adviseInRecoveryVersion != tempInRecoveryVersion) {
-            if (cp.inRecovery) {
+            if (cp.getInRecovery()) {
+          adviseInRecoveryVersion = tempInRecoveryVersion;
-              DataPolicy dp = cp.dataPolicy;
+              DataPolicy dp = cp.getDataPolicy();
-      return !cp.inRecovery;
+      return !cp.getInRecovery();
-      if (prof.inRecovery) {
+      if (prof.getInRecovery()) {
-      if (profile.inRecovery) {
+      if (profile.getInRecovery()) {
+
-    public boolean inRecovery = false;
+    private boolean inRecovery = false;
+    public boolean getInRecovery() {
+      return inRecovery;
+    };
+
+    public void setInRecovery(boolean recovery) {
+      inRecovery = recovery;
+    };
+
+    public DataPolicy getDataPolicy() {
+      return dataPolicy;
+    }
+
