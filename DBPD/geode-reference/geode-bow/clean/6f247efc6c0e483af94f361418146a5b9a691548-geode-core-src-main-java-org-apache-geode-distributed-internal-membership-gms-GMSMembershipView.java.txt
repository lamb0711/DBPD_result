GEODE-7479: Change Membership interface to use MemberIdentifier interface (#4420)

Changing all classes in Membership to be parameterized by an ID type,
which extends MemberIdentifier. This allows core to create a membership
system that manages InternalDistributedMember objects in a type safe
way.

Removing all uses of InternalDistributedMember, DistributedMember, and
friends from within the membership code.

-public class GMSMembershipView implements DataSerializableFixedID {
+public class GMSMembershipView<ID extends MemberIdentifier> implements DataSerializableFixedID {
-  private List<MemberIdentifier> members;
+  private List<ID> members;
-  private final Map<MemberIdentifier, Object> publicKeys = new ConcurrentHashMap<>();
+  private final Map<ID, Object> publicKeys = new ConcurrentHashMap<>();
-  private Set<MemberIdentifier> shutdownMembers;
-  private Set<MemberIdentifier> crashedMembers;
-  private MemberIdentifier creator;
-  private Set<MemberIdentifier> hashedMembers;
+  private Set<ID> shutdownMembers;
+  private Set<ID> crashedMembers;
+  private ID creator;
+  private Set<ID> hashedMembers;
-  public GMSMembershipView(MemberIdentifier creator) {
+  public GMSMembershipView(ID creator) {
-  public GMSMembershipView(MemberIdentifier creator, int viewId,
-      List<MemberIdentifier> members) {
+  public GMSMembershipView(ID creator, int viewId,
+      List<ID> members) {
-  public GMSMembershipView(GMSMembershipView other, int viewId) {
+  public GMSMembershipView(GMSMembershipView<ID> other, int viewId) {
-  public GMSMembershipView(MemberIdentifier creator, int viewId,
-      List<MemberIdentifier> mbrs, Set<MemberIdentifier> shutdowns,
-      Set<MemberIdentifier> crashes) {
+  public GMSMembershipView(ID creator, int viewId,
+      List<ID> mbrs, Set<ID> shutdowns,
+      Set<ID> crashes) {
-  public MemberIdentifier getCreator() {
+  public ID getCreator() {
-  public void setCreator(MemberIdentifier creator) {
+  public void setCreator(ID creator) {
-  public Object getPublicKey(MemberIdentifier mbr) {
+  public Object getPublicKey(ID mbr) {
-  public void setPublicKey(MemberIdentifier mbr, Object key) {
+  public void setPublicKey(ID mbr, Object key) {
-  public void setPublicKeys(GMSMembershipView otherView) {
+  public void setPublicKeys(GMSMembershipView<ID> otherView) {
-  public int getFailureDetectionPort(MemberIdentifier mbr) {
+  public int getFailureDetectionPort(ID mbr) {
-  public void setFailureDetectionPort(MemberIdentifier mbr, int port) {
+  public void setFailureDetectionPort(ID mbr, int port) {
-  public void setFailureDetectionPorts(GMSMembershipView otherView) {
+  public void setFailureDetectionPorts(GMSMembershipView<ID> otherView) {
-      for (MemberIdentifier mbr : otherView.getMembers()) {
+      for (ID mbr : otherView.getMembers()) {
-  public Object get(int i) {
+  public ID get(int i) {
-  public void add(MemberIdentifier mbr) {
+  public void add(ID mbr) {
-  public void addCrashedMembers(Set<MemberIdentifier> mbr) {
+  public void addCrashedMembers(Set<ID> mbr) {
-  public List<MemberIdentifier> getNewMembers(GMSMembershipView olderView) {
-    List<MemberIdentifier> result = new ArrayList<>(members);
+  public List<ID> getNewMembers(GMSMembershipView<ID> olderView) {
+    List<ID> result = new ArrayList<>(members);
-  public List<MemberIdentifier> getNewMembers() {
-    List<MemberIdentifier> result = new ArrayList<>(5);
+  public List<ID> getNewMembers() {
+    List<ID> result = new ArrayList<>(5);
-  public boolean remove(MemberIdentifier mbr) {
+  public boolean remove(ID mbr) {
-  public void removeAll(Collection<MemberIdentifier> ids) {
+  public void removeAll(Collection<ID> ids) {
-  public boolean contains(MemberIdentifier mbr) {
+  public boolean contains(ID mbr) {
-  public MemberIdentifier getLeadMember() {
-    for (MemberIdentifier mbr : this.members) {
-      if (mbr.getVmKind() == MemberIdentifier.NORMAL_DM_TYPE) {
+  public ID getLeadMember() {
+    for (ID mbr : this.members) {
+      if (mbr.getVmKind() == ID.NORMAL_DM_TYPE) {
-  public MemberIdentifier getCoordinator() {
+  public ID getCoordinator() {
-      for (MemberIdentifier addr : members) {
+      for (ID addr : members) {
-  public MemberIdentifier getCoordinator(
-      Collection<MemberIdentifier> rejections) {
+  public ID getCoordinator(
+      Collection<ID> rejections) {
-      for (MemberIdentifier addr : members) {
+      for (ID addr : members) {
-      for (MemberIdentifier addr : members) {
+      for (ID addr : members) {
-  public List<MemberIdentifier> getPreferredCoordinators(
-      Set<MemberIdentifier> filter, MemberIdentifier localAddress,
+  public List<ID> getPreferredCoordinators(
+      Set<ID> filter, ID localAddress,
-    List<MemberIdentifier> results = new ArrayList<>();
-    List<MemberIdentifier> notPreferredCoordinatorList = new ArrayList<>();
+    List<ID> results = new ArrayList<>();
+    List<ID> notPreferredCoordinatorList = new ArrayList<>();
-      for (MemberIdentifier addr : members) {
+      for (ID addr : members) {
-        Iterator<MemberIdentifier> it = notPreferredCoordinatorList.iterator();
+        Iterator<ID> it = notPreferredCoordinatorList.iterator();
-  public List<MemberIdentifier> getGMSMembers() {
-    return (List<MemberIdentifier>) (List<?>) Collections.unmodifiableList(this.members);
-  }
-
-
-  public List<MemberIdentifier> getMembers() {
+  public List<ID> getGMSMembers() {
-  public Set<MemberIdentifier> getShutdownMembers() {
+
+  public List<ID> getMembers() {
+    return Collections.unmodifiableList(this.members);
+  }
+
+  public Set<ID> getShutdownMembers() {
-  public Set<MemberIdentifier> getCrashedMembers() {
+  public Set<ID> getCrashedMembers() {
-  public boolean shouldBeCoordinator(MemberIdentifier who) {
-    Iterator<MemberIdentifier> it = this.members.iterator();
-    MemberIdentifier firstNonPreferred = null;
+  public boolean shouldBeCoordinator(ID who) {
+    Iterator<ID> it = this.members.iterator();
+    ID firstNonPreferred = null;
-      MemberIdentifier mbr = it.next();
+      ID mbr = it.next();
-    MemberIdentifier lead = getLeadMember();
-    for (MemberIdentifier mbr : this.members) {
+    ID lead = getLeadMember();
+    for (ID mbr : this.members) {
-        case MemberIdentifier.NORMAL_DM_TYPE:
+        case ID.NORMAL_DM_TYPE:
-        case MemberIdentifier.LOCATOR_DM_TYPE:
+        case ID.LOCATOR_DM_TYPE:
-        case MemberIdentifier.ADMIN_ONLY_DM_TYPE:
+        case ID.ADMIN_ONLY_DM_TYPE:
-  public int getCrashedMemberWeight(GMSMembershipView oldView) {
+  public int getCrashedMemberWeight(GMSMembershipView<ID> oldView) {
-    MemberIdentifier lead = oldView.getLeadMember();
-    for (MemberIdentifier mbr : this.crashedMembers) {
+    ID lead = oldView.getLeadMember();
+    for (ID mbr : this.crashedMembers) {
-        case MemberIdentifier.NORMAL_DM_TYPE:
+        case ID.NORMAL_DM_TYPE:
-        case MemberIdentifier.LOCATOR_DM_TYPE:
+        case ID.LOCATOR_DM_TYPE:
-        case MemberIdentifier.ADMIN_ONLY_DM_TYPE:
+        case ID.ADMIN_ONLY_DM_TYPE:
-  public Set<MemberIdentifier> getActualCrashedMembers(GMSMembershipView oldView) {
-    Set<MemberIdentifier> result = new HashSet<>(this.crashedMembers.size());
+  public Set<ID> getActualCrashedMembers(GMSMembershipView<ID> oldView) {
+    Set<ID> result = new HashSet<>(this.crashedMembers.size());
-        .filter(mbr -> (mbr.getVmKind() != MemberIdentifier.ADMIN_ONLY_DM_TYPE))
+        .filter(mbr -> (mbr.getVmKind() != ID.ADMIN_ONLY_DM_TYPE))
-  public void logCrashedMemberWeights(GMSMembershipView oldView, Logger log) {
-    MemberIdentifier lead = oldView.getLeadMember();
-    for (MemberIdentifier mbr : this.crashedMembers) {
+  public void logCrashedMemberWeights(GMSMembershipView<ID> oldView, Logger log) {
+    ID lead = oldView.getLeadMember();
+    for (ID mbr : this.crashedMembers) {
-        case MemberIdentifier.NORMAL_DM_TYPE:
+        case ID.NORMAL_DM_TYPE:
-        case MemberIdentifier.LOCATOR_DM_TYPE:
+        case ID.LOCATOR_DM_TYPE:
-        case MemberIdentifier.ADMIN_ONLY_DM_TYPE:
+        case ID.ADMIN_ONLY_DM_TYPE:
-    MemberIdentifier lead = getLeadMember();
+    ID lead = getLeadMember();
-    for (MemberIdentifier mbr : this.members) {
+    for (ID mbr : this.members) {
-      for (MemberIdentifier mbr : this.shutdownMembers) {
+      for (ID mbr : this.shutdownMembers) {
-      for (MemberIdentifier mbr : this.crashedMembers) {
+      for (ID mbr : this.crashedMembers) {
-  public synchronized MemberIdentifier getCanonicalID(MemberIdentifier id) {
+  public synchronized ID getCanonicalID(ID id) {
-      for (MemberIdentifier m : this.members) {
+      for (ID m : this.members) {
-      return this.members.equals(((GMSMembershipView) other).getGMSMembers());
+      return this.members.equals(((GMSMembershipView<ID>) other).getGMSMembers());
-    Map pubkeys = StaticSerialization.readHashMap(in, context);
+    Map<ID, Object> pubkeys = StaticSerialization.readHashMap(in, context);
-  private void writeAsArrayList(List<MemberIdentifier> list, DataOutput out,
+  private void writeAsArrayList(List<ID> list, DataOutput out,
