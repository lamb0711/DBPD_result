Feature/geode 3583 storage (#1285)

* This resolves the following tickets: GEODE-4196, GEODE-4197, GEODE-4198, GEODE-4199
   GEODE-4200, GEODE-4201, GEODE-4203, GEODE-4204, GEODE-4205, GEODE-4206
   GEODE-4208, GEODE-4209, GEODE-4210, GEODE-4212, and GEODE-4213
+import org.apache.geode.annotations.TestingOnly;
+  private transient InternalCache cache;
+
+    this.cache = null;
-  public TXRegionLockRequestImpl(LocalRegion r) {
+  public TXRegionLockRequestImpl(InternalCache cache, LocalRegion r) {
+    this.cache = cache;
+  @TestingOnly
+    this.cache = null;
+  @Override
+  @Override
+  @Override
-    final InternalCache cache = getCache(false);
+    cache = GemFireCacheImpl.getInstance();
+  @Override
+  @Override
+  @Override
-      getCache(true);
+      cache.getCancelCriterion().checkCancelInProgress(null);
-  private InternalCache getCache(boolean throwIfClosing) {
-    final InternalCache cache = GemFireCacheImpl.getInstance();
-    if (cache != null && !cache.isClosed()) {
-      if (throwIfClosing) {
-        cache.getCancelCriterion().checkCancelInProgress(null);
-      }
-      return cache;
-    }
-    if (throwIfClosing) {
-      throw cache.getCacheClosedException("The cache is closed.", null);
-    }
-    return null;
-  }
-
