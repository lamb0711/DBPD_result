GEODE-7345: break dependency on SocketCreator (#4322)


-public class DummySocketCreator extends SocketCreator {
+/*
+ * This test class will fail the TLS handshake with an SSLException, by default.
+ */
+public class SocketCreatorFailHandshake extends SocketCreator {
-  private List<Integer> socketSoTimeouts;
+  private final List<Integer> socketSoTimeouts;
+  private boolean failTLSHandshake;
+
+  public SocketCreatorFailHandshake(SSLConfig sslConfig, List<Integer> socketTimeouts) {
+    super(sslConfig);
+    this.socketSoTimeouts = socketTimeouts;
+    failTLSHandshake = true;
+  }
-   * Constructs new SocketCreator instance.
+   * @param failTLSHandshake false will cause the next handshake to NOT throw SSLException
-  public DummySocketCreator(SSLConfig sslConfig, List<Integer> sockets) {
-    super(sslConfig);
-    this.socketSoTimeouts = sockets;
+  public void setFailTLSHandshake(final boolean failTLSHandshake) {
+    this.failTLSHandshake = failTLSHandshake;
-    throw new SSLException("This is a test SSLException");
+    if (failTLSHandshake)
+      throw new SSLException("This is a test SSLException");
+    else
+      super.handshakeIfSocketIsSSL(socket, timeout);
