GEODE-6709: Locators should not start when ClusterConfigurationServicâ€¦ (#3503)

Co-authored-by: Jinmei Liao <jiliao@pivotal.io>


-import java.io.FileOutputStream;
-import java.io.InputStream;
-import java.util.Collections;
-import com.healthmarketscience.rmiio.RemoteInputStream;
-import com.healthmarketscience.rmiio.RemoteInputStreamClient;
-import org.apache.commons.io.IOUtils;
-import org.apache.geode.cache.execute.ResultCollector;
+import org.apache.geode.internal.cache.ClusterConfigurationLoader;
-import org.apache.geode.management.internal.beans.FileUploader;
-import org.apache.geode.management.internal.cli.CliUtil;
-import org.apache.geode.management.internal.configuration.functions.DownloadJarFunction;
-    ResultCollector<RemoteInputStream, List<RemoteInputStream>> rc =
-        (ResultCollector<RemoteInputStream, List<RemoteInputStream>>) CliUtil.executeFunction(
-            new DownloadJarFunction(), new Object[] {groupName, jarName},
-            Collections.singleton(locator));
-
-    List<RemoteInputStream> result = rc.getResult();
-    RemoteInputStream jarStream = result.get(0);
-
-    Path tempDir = FileUploader.createSecuredTempDirectory("deploy-");
-    Path tempJar = Paths.get(tempDir.toString(), jarName);
-    FileOutputStream fos = new FileOutputStream(tempJar.toString());
-    InputStream input = RemoteInputStreamClient.wrap(jarStream);
-
-    IOUtils.copy(input, fos);
-
-    fos.close();
-    input.close();
-
-    return tempJar.toFile();
+    ClusterConfigurationLoader loader = new ClusterConfigurationLoader();
+    return loader.downloadJar(locator, groupName, jarName);
