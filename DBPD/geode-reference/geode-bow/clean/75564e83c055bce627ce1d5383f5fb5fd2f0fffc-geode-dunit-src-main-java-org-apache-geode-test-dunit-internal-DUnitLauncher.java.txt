GEODE-7265: Avoid creating default locator VM when ClusterStartupRule is used (#4107)


+    launchIfNeeded(true);
+  }
+
+  public static void launchIfNeeded(boolean launchLocator) {
-        launch();
+        launch(launchLocator);
-  private static void launch() throws AlreadyBoundException, IOException,
+  private static void launch(boolean launchLocator) throws AlreadyBoundException, IOException,
-    // Create a VM for the locator
-    processManager.launchVM(LOCATOR_VM_NUM);
+    if (launchLocator) {
+      // Create a VM for the locator
+      processManager.launchVM(LOCATOR_VM_NUM);
-    // wait for the VM to start up
-    if (!processManager.waitForVMs(STARTUP_TIMEOUT)) {
-      throw new RuntimeException(STARTUP_TIMEOUT_MESSAGE);
+      // wait for the VM to start up
+      if (!processManager.waitForVMs(STARTUP_TIMEOUT)) {
+        throw new RuntimeException(STARTUP_TIMEOUT_MESSAGE);
+      }
+
+      locatorPort = startLocator(registry);
-    locatorPort = startLocator(registry);
-
-    host.init(registry, NUM_VMS);
+    host.init(NUM_VMS, launchLocator);
