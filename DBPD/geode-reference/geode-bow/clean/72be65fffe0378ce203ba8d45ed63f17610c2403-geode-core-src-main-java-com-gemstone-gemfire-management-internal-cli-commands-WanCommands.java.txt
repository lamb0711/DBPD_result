Merge branch 'feature/GEODE-17-2' into develop

-import java.util.ArrayList;
-import java.util.HashSet;
-import java.util.Iterator;
-import java.util.List;
-import java.util.Map;
-import java.util.Set;
-import java.util.TreeMap;
-import java.util.concurrent.Callable;
-import java.util.concurrent.ExecutionException;
-import java.util.concurrent.ExecutorService;
-import java.util.concurrent.Executors;
-import java.util.concurrent.Future;
-import java.util.concurrent.ThreadFactory;
-import java.util.concurrent.atomic.AtomicInteger;
-
-import javax.management.ObjectName;
-
-import org.springframework.shell.core.CommandMarker;
-import org.springframework.shell.core.annotation.CliAvailabilityIndicator;
-import org.springframework.shell.core.annotation.CliCommand;
-import org.springframework.shell.core.annotation.CliOption;
-
-import com.gemstone.gemfire.internal.i18n.LocalizedStrings;
+import com.gemstone.gemfire.management.internal.security.ResourceOperation;
+import org.springframework.shell.core.CommandMarker;
+import org.springframework.shell.core.annotation.CliAvailabilityIndicator;
+import org.springframework.shell.core.annotation.CliCommand;
+import org.springframework.shell.core.annotation.CliOption;
+
+import javax.management.ObjectName;
+import java.util.ArrayList;
+import java.util.Iterator;
+import java.util.List;
+import java.util.Map;
+import java.util.Set;
+import java.util.TreeMap;
+import java.util.concurrent.Callable;
+import java.util.concurrent.ExecutionException;
+import java.util.concurrent.ExecutorService;
+import java.util.concurrent.Executors;
+import java.util.concurrent.Future;
+import java.util.concurrent.ThreadFactory;
+import java.util.concurrent.atomic.AtomicInteger;
+
+import static com.gemstone.gemfire.cache.operations.OperationContext.OperationCode;
+import static com.gemstone.gemfire.cache.operations.OperationContext.Resource;
-  
+
+  @ResourceOperation(resource = Resource.DATA, operation = OperationCode.MANAGE)
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__MEMBER, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__MEMBER,
-      help = CliStrings.CREATE_GATEWAYSENDER__MEMBER__HELP) 
+      help = CliStrings.CREATE_GATEWAYSENDER__MEMBER__HELP)
-          
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__ID, 
-      mandatory = true, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__ID,
+      mandatory = true,
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__REMOTEDISTRIBUTEDSYSTEMID, 
-      mandatory = true, 
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__REMOTEDISTRIBUTEDSYSTEMID,
+      mandatory = true,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__PARALLEL, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__PARALLEL,
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__MANUALSTART, 
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__MANUALSTART,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__SOCKETBUFFERSIZE, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__SOCKETBUFFERSIZE,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__SOCKETREADTIMEOUT, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__SOCKETREADTIMEOUT,
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__ENABLEBATCHCONFLATION, 
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__ENABLEBATCHCONFLATION,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__BATCHSIZE, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__BATCHSIZE,
-          
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__BATCHTIMEINTERVAL, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__BATCHTIMEINTERVAL,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__ENABLEPERSISTENCE, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__ENABLEPERSISTENCE,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__DISKSTORENAME, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__DISKSTORENAME,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__DISKSYNCHRONOUS, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__DISKSYNCHRONOUS,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__MAXQUEUEMEMORY, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__MAXQUEUEMEMORY,
-          
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__ALERTTHRESHOLD, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__ALERTTHRESHOLD,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__DISPATCHERTHREADS, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__DISPATCHERTHREADS,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__ORDERPOLICY, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__ORDERPOLICY,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__GATEWAYEVENTFILTER, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__GATEWAYEVENTFILTER,
-      @CliMetaData (valueSeparator = ",") 
+      @CliMetaData (valueSeparator = ",")
-          
-      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__GATEWAYTRANSPORTFILTER, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYSENDER__GATEWAYTRANSPORTFILTER,
-      @CliMetaData (valueSeparator = ",") 
+      @CliMetaData (valueSeparator = ",")
-      GatewaySenderFunctionArgs gatewaySenderFunctionArgs = 
+      GatewaySenderFunctionArgs gatewaySenderFunctionArgs =
-            remoteDistributedSystemId, parallel, manualStart, socketBufferSize, socketReadTimeout, 
-            enableBatchConflation, batchSize, batchTimeInterval, enablePersistence, diskStoreName, 
-            diskSynchronous, maxQueueMemory, alertThreshold, dispatcherThreads, orderPolicy, 
+            remoteDistributedSystemId, parallel, manualStart, socketBufferSize, socketReadTimeout,
+            enableBatchConflation, batchSize, batchTimeInterval, enablePersistence, diskStoreName,
+            diskSynchronous, maxQueueMemory, alertThreshold, dispatcherThreads, orderPolicy,
-      
+
-      
+
-      
+
-        
+
-    
+
+  @ResourceOperation(resource = Resource.DATA, operation = OperationCode.MANAGE)
-      @CliOption(key = CliStrings.START_GATEWAYSENDER__ID, 
-      mandatory = true, 
+      @CliOption(key = CliStrings.START_GATEWAYSENDER__ID,
+      mandatory = true,
-      
+
-      
-      @CliOption(key = CliStrings.START_GATEWAYSENDER__MEMBER, 
+
+      @CliOption(key = CliStrings.START_GATEWAYSENDER__MEMBER,
-      help = CliStrings.START_GATEWAYSENDER__MEMBER__HELP) 
+      help = CliStrings.START_GATEWAYSENDER__MEMBER__HELP)
-    
+
-        
+
-          
+
-            
+
-      
+
-      
+
-      
+
-    
+
+  @ResourceOperation(resource = Resource.DATA, operation = OperationCode.MANAGE)
-      @CliOption(key = CliStrings.PAUSE_GATEWAYSENDER__ID, 
-      mandatory = true, 
+      @CliOption(key = CliStrings.PAUSE_GATEWAYSENDER__ID,
+      mandatory = true,
-      
+
-      help = CliStrings.PAUSE_GATEWAYSENDER__GROUP__HELP) 
+      help = CliStrings.PAUSE_GATEWAYSENDER__GROUP__HELP)
-      
-      @CliOption(key = CliStrings.PAUSE_GATEWAYSENDER__MEMBER, 
+
+      @CliOption(key = CliStrings.PAUSE_GATEWAYSENDER__MEMBER,
-      help = CliStrings.PAUSE_GATEWAYSENDER__MEMBER__HELP) 
+      help = CliStrings.PAUSE_GATEWAYSENDER__MEMBER__HELP)
-    
+
-      
+
+  @ResourceOperation(resource=Resource.DATA, operation = OperationCode.MANAGE)
-      @CliOption(key = CliStrings.RESUME_GATEWAYSENDER__ID, 
-      mandatory = true, 
+      @CliOption(key = CliStrings.RESUME_GATEWAYSENDER__ID,
+      mandatory = true,
-      
+
-      help = CliStrings.RESUME_GATEWAYSENDER__GROUP__HELP) 
+      help = CliStrings.RESUME_GATEWAYSENDER__GROUP__HELP)
-      
-      @CliOption(key = CliStrings.RESUME_GATEWAYSENDER__MEMBER, 
+
+      @CliOption(key = CliStrings.RESUME_GATEWAYSENDER__MEMBER,
-      help = CliStrings.RESUME_GATEWAYSENDER__MEMBER__HELP) 
+      help = CliStrings.RESUME_GATEWAYSENDER__MEMBER__HELP)
-    
+
+  @ResourceOperation(resource = Resource.DATA, operation = OperationCode.MANAGE)
-      @CliOption(key = CliStrings.STOP_GATEWAYSENDER__ID, 
-      mandatory = true, 
+      @CliOption(key = CliStrings.STOP_GATEWAYSENDER__ID,
+      mandatory = true,
-      
+
-      
-      @CliOption(key = CliStrings.STOP_GATEWAYSENDER__MEMBER, 
+
+      @CliOption(key = CliStrings.STOP_GATEWAYSENDER__MEMBER,
-      help = CliStrings.STOP_GATEWAYSENDER__MEMBER__HELP) 
+      help = CliStrings.STOP_GATEWAYSENDER__MEMBER__HELP)
-    
+
-   
+
-  
+
+  @ResourceOperation( resource=Resource.DATA, operation = OperationCode.MANAGE)
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__MEMBER, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__MEMBER,
-      help = CliStrings.CREATE_GATEWAYRECEIVER__MEMBER__HELP) 
+      help = CliStrings.CREATE_GATEWAYRECEIVER__MEMBER__HELP)
-          
-      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__MANUALSTART, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__MANUALSTART,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__STARTPORT, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__STARTPORT,
-      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__ENDPORT, 
+      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__ENDPORT,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__BINDADDRESS, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__BINDADDRESS,
-      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__MAXTIMEBETWEENPINGS, 
+      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__MAXTIMEBETWEENPINGS,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__SOCKETBUFFERSIZE, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__SOCKETBUFFERSIZE,
-      
-      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__GATEWAYTRANSPORTFILTER, 
+
+      @CliOption(key = CliStrings.CREATE_GATEWAYRECEIVER__GATEWAYTRANSPORTFILTER,
-      @CliMetaData (valueSeparator = ",") 
+      @CliMetaData (valueSeparator = ",")
-        
+
-    
+
-    
+
+  @ResourceOperation(resource = Resource.DATA, operation = OperationCode.MANAGE)
-      @CliOption(key = CliStrings.LOAD_BALANCE_GATEWAYSENDER__ID, 
-      mandatory = true, 
+      @CliOption(key = CliStrings.LOAD_BALANCE_GATEWAYSENDER__ID,
+      mandatory = true,
-    
+
+  @ResourceOperation(resource = Resource.DATA, operation = OperationCode.MANAGE)
-      help = CliStrings.START_GATEWAYRECEIVER__GROUP__HELP) 
+      help = CliStrings.START_GATEWAYRECEIVER__GROUP__HELP)
-      
-      @CliOption(key = CliStrings.START_GATEWAYRECEIVER__MEMBER, 
+
+      @CliOption(key = CliStrings.START_GATEWAYRECEIVER__MEMBER,
-      help = CliStrings.START_GATEWAYRECEIVER__MEMBER__HELP) 
+      help = CliStrings.START_GATEWAYRECEIVER__MEMBER__HELP)
+  @ResourceOperation(resource = Resource.DATA, operation = OperationCode.MANAGE)
-      
-      @CliOption(key = CliStrings.STOP_GATEWAYRECEIVER__GROUP, 
+
+      @CliOption(key = CliStrings.STOP_GATEWAYRECEIVER__GROUP,
-      help = CliStrings.STOP_GATEWAYRECEIVER__GROUP__HELP) 
+      help = CliStrings.STOP_GATEWAYRECEIVER__GROUP__HELP)
-      
-      @CliOption(key = CliStrings.STOP_GATEWAYRECEIVER__MEMBER, 
+
+      @CliOption(key = CliStrings.STOP_GATEWAYRECEIVER__MEMBER,
-      help = CliStrings.STOP_GATEWAYRECEIVER__MEMBER__HELP) 
+      help = CliStrings.STOP_GATEWAYRECEIVER__MEMBER__HELP)
-    
+
+  @ResourceOperation(resource = Resource.CLUSTER, operation = OperationCode.READ)
-      help = CliStrings.LIST_GATEWAY__GROUP__HELP) 
+      help = CliStrings.LIST_GATEWAY__GROUP__HELP)
-    
+
+  @ResourceOperation(resource = Resource.CLUSTER, operation = OperationCode.READ)
-      @CliOption(key = CliStrings.STATUS_GATEWAYSENDER__ID, 
-      mandatory = true, 
+      @CliOption(key = CliStrings.STATUS_GATEWAYSENDER__ID,
+      mandatory = true,
-      
+
-      help = CliStrings.STATUS_GATEWAYSENDER__GROUP__HELP) 
+      help = CliStrings.STATUS_GATEWAYSENDER__GROUP__HELP)
-      
-      @CliOption(key = CliStrings.STATUS_GATEWAYSENDER__MEMBER, 
+
+      @CliOption(key = CliStrings.STATUS_GATEWAYSENDER__MEMBER,
-    
+
+  @ResourceOperation(resource = Resource.CLUSTER, operation = OperationCode.READ)
-      @CliOption(key = CliStrings.STATUS_GATEWAYRECEIVER__GROUP, 
+      @CliOption(key = CliStrings.STATUS_GATEWAYRECEIVER__GROUP,
-      
-      @CliOption(key = CliStrings.STATUS_GATEWAYRECEIVER__MEMBER, 
+
+      @CliOption(key = CliStrings.STATUS_GATEWAYRECEIVER__MEMBER,
-      help = CliStrings.STATUS_GATEWAYRECEIVER__MEMBER__HELP) 
+      help = CliStrings.STATUS_GATEWAYRECEIVER__MEMBER__HELP)
-    
+
-  
+
-  
+
