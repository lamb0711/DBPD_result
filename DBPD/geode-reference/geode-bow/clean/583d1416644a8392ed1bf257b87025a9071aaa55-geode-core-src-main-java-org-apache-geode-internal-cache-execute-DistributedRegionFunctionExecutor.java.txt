GEODE-5562 Reading the values of LocalRegion.memoryThresholdReached and DistributedRegion.memoryThresholdReachedMembers must be atomic (#2320)

* GEODE-5562 Reading the values of LocalRegion.memoryThresholdReached and
           DistributedRegion.memoryThresholdReachedMembers must be atomic.
+import org.apache.geode.internal.cache.MemoryThresholdInfo;
+import org.apache.geode.internal.cache.control.InternalResourceManager;
-      try {
-        region.checkIfAboveThreshold(null);
-      } catch (LowMemoryException ignore) {
-        Set<DistributedMember> htrm = region.getMemoryThresholdReachedMembers();
+      MemoryThresholdInfo info = region.getAtomicThresholdInfo();
+      if (info.isMemoryThresholdReached()) {
+        InternalResourceManager.getInternalResourceManager(region.getCache()).getHeapMonitor()
+            .updateStateAndSendEvent();
+        Set<DistributedMember> criticalMembers = info.getMembersThatReachedThreshold();
-                .toLocalizedString(function.getId(), htrm),
-            htrm);
-
+                .toLocalizedString(function.getId(), criticalMembers),
+            criticalMembers);
