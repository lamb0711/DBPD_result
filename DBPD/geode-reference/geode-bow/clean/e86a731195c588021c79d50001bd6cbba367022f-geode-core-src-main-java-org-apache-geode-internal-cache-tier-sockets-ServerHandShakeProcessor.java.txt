Merge branch 'release/1.3.0'

+import org.apache.geode.internal.cache.tier.CommunicationMode;
+import org.apache.geode.internal.security.SecurityService;
-  public static boolean readHandShake(ServerConnection connection) {
+  public static boolean readHandShake(ServerConnection connection,
+      SecurityService securityService) {
-        validHandShake = readGFEHandshake(connection, clientVersion);
+        validHandShake = readGFEHandshake(connection, clientVersion, securityService);
-  private static boolean readGFEHandshake(ServerConnection connection, Version clientVersion) {
+  private static boolean readGFEHandshake(ServerConnection connection, Version clientVersion,
+      SecurityService securityService) {
-          connection.getCommunicationMode());
+          connection.getCommunicationMode(), securityService);
-          || connection.getCommunicationMode() == Acceptor.GATEWAY_TO_GATEWAY) {
+          || connection.getCommunicationMode().isWAN()) {
-        if (connection.getCommunicationMode() == Acceptor.GATEWAY_TO_GATEWAY
-            && !(clientVersionOrdinal == Version.NOT_SUPPORTED_ORDINAL)) {
+        if (connection.getCommunicationMode().isWAN()) {
