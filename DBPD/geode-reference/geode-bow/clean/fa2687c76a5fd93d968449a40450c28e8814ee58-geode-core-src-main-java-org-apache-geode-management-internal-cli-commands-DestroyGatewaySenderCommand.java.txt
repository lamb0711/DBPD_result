 GEODE-2668: build tabular command result from a list of function results  (#1127)

* GEODE-2668: build tabular command result from a list of function results

* reduce duplicate code to create the tabular results
* promote presentation consistency
* Add more validation for CreateGatewaySender/Receiver command and reworked the tests

-import org.apache.geode.cache.execute.ResultCollector;
+import org.apache.geode.management.internal.cli.result.CommandResult;
-import org.apache.geode.management.internal.cli.result.TabularResultData;
-    ResultCollector<?, ?> resultCollector = executeFunction(GatewaySenderDestroyFunction.INSTANCE,
-        gatewaySenderDestroyFunctionArgs, members);
+    List<CliFunctionResult> functionResults = executeAndGetFunctionResult(
+        GatewaySenderDestroyFunction.INSTANCE, gatewaySenderDestroyFunctionArgs, members);
-    List<CliFunctionResult> functionResults = (List<CliFunctionResult>) resultCollector.getResult();
+    CommandResult result = ResultBuilder.buildResult(functionResults);
-    TabularResultData tabularResultData = ResultBuilder.createTabularResultData();
-    boolean errorOccurred = false;
-    for (CliFunctionResult functionResult : functionResults) {
-      tabularResultData.accumulate("Member", functionResult.getMemberIdOrName());
-      if (functionResult.isSuccessful()) {
-        tabularResultData.accumulate("Status", functionResult.getMessage());
-      } else {
-        // if result has exception, it will be logged by the server before throwing it.
-        // so we don't need to log it here anymore.
-        tabularResultData.accumulate("Status", "ERROR: " + functionResult.getErrorMessage());
-        errorOccurred = true;
-      }
-    }
-    tabularResultData.setStatus(errorOccurred ? Result.Status.ERROR : Result.Status.OK);
-    return ResultBuilder.buildResult(tabularResultData);
+    return result;
