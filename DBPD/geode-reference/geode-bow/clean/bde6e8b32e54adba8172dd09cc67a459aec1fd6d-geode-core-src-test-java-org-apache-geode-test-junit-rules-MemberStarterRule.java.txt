GEODE-3530: refactor ListClientCommandDUnitTest (#2129)

Co-authored-by: Jinmei Liao <jiliao@pivotal.io>


+import static org.apache.geode.management.internal.ManagementConstants.OBJECTNAME__CLIENTSERVICE_MXBEAN;
+import java.text.MessageFormat;
+import javax.management.ObjectName;
+
+import org.apache.geode.management.CacheServerMXBean;
+import org.apache.geode.management.internal.MBeanJMXAdapter;
+import org.apache.geode.management.internal.SystemManagementService;
+  public void waitTillClientsAreReadyOnServer(String serverName, int serverPort, int clientCount) {
+    waitTillCacheServerIsReady(serverName, serverPort);
+    CacheServerMXBean bean = getCacheServerMXBean(serverName, serverPort);
+    await().atMost(1, TimeUnit.MINUTES).until(() -> bean.getClientIds().length == clientCount);
+  }
+
+  public void waitTillCacheServerIsReady(String serverName, int serverPort) {
+    await().atMost(1, TimeUnit.MINUTES)
+        .until(() -> getCacheServerMXBean(serverName, serverPort) != null);
+  }
+
+  public CacheServerMXBean getCacheServerMXBean(String serverName, int serverPort) {
+    SystemManagementService managementService = (SystemManagementService) getManagementService();
+    String objectName = MessageFormat.format(OBJECTNAME__CLIENTSERVICE_MXBEAN,
+        String.valueOf(serverPort), serverName);
+    ObjectName cacheServerMBeanName = MBeanJMXAdapter.getObjectName(objectName);
+    return managementService.getMBeanProxy(cacheServerMBeanName, CacheServerMXBean.class);
+  }
+
