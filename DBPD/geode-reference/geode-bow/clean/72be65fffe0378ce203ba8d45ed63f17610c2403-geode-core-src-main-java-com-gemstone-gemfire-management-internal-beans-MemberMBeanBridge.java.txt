Merge branch 'feature/GEODE-17-2' into develop

-import java.util.Properties;
-
-import org.apache.logging.log4j.Logger;
-
-import com.gemstone.gemfire.internal.logging.ManagerLogWriter;
+import com.gemstone.gemfire.management.internal.cli.result.ErrorResultData;
+import com.gemstone.gemfire.security.GemFireSecurityException;
+import org.apache.logging.log4j.Logger;
-//    System.out.println("isGfshRequest :: "+isGfshRequest);
+
+      // throw GemFireSecurityException is the returned error code is 415
+      if(((CommandResult) result).getResultData() instanceof ErrorResultData){
+        ErrorResultData resultData = (ErrorResultData) ((CommandResult)result).getResultData();
+        if(resultData.getErrorCode()==ResultBuilder.ERRORCODE_UNAUTHORIZED){
+          throw new GemFireSecurityException(resultData.getGfJsonObject().toString());
+        }
+      }
