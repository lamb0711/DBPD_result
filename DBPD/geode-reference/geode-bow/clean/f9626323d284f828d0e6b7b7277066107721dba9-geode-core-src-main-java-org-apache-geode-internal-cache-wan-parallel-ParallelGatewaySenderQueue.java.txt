GEODE-8366: Compared the input region's data policy to the sender instead of the leader region's


+    addShadowPartitionedRegionForUserPR(userPR, null);
+  }
+
+  public void addShadowPartitionedRegionForUserPR(PartitionedRegion userPR,
+      PartitionedRegion childPR) {
-      logger.debug("{} addShadowPartitionedRegionForUserPR: Attempting to create queue region: {}",
-          this, userPR.getDisplayName());
+      logger.debug(
+          "{} addShadowPartitionedRegionForUserPR: Attempting to create queue region: {}; child region: {}",
+          this, userPR.getDisplayName(), childPR == null ? "null" : childPR.getDisplayName());
-          addShadowPartitionedRegionForUserPR(ColocationHelper.getLeaderRegion(userPR));
+          addShadowPartitionedRegionForUserPR(ColocationHelper.getLeaderRegion(userPR), userPR);
-      if (userPR.getDataPolicy().withPersistence() && !sender.isPersistenceEnabled()) {
+      if ((childPR == null ? userPR : childPR).getDataPolicy().withPersistence()
+          && !sender.isPersistenceEnabled()) {
