GEODE-17: Shiro Integration

GEODE-17: associate async request with correct shiro user

GEODE-17

GEODE-17: fix shiro dependency

+import com.gemstone.gemfire.security.ShiroUtil;
-  private ManagementInterceptor interceptor;
-
-  public MBeanServerWrapper(ManagementInterceptor interceptor){
-    this.interceptor = interceptor;
+  public MBeanServerWrapper(){
-    interceptor.authorize(context);
+    ShiroUtil.authorize(context);
-    interceptor.postAuthorize(context);
+    //interceptor.postAuthorize(context);
+    // skip authorization check if operation is "processCommand" since we will check authorization in the command itself
-    if("processCommand".equals(operationName) && params.length>=1){
-      ctx = CLIOperationContext.getOperationContext((String)params[0]);
-    }
-    else {
+    if(!"processCommand".equals(operationName)) {
+      doAuthorization(ctx);
-    doAuthorization(ctx);
-      return new ResourceOperationContext(resource, operationCode);
+      return new ResourceOperationContext(resource, operationCode, null);
-  public ManagementInterceptor getInterceptor() {
-    return interceptor;
-  }
-
