GEODE-1760 Sending partial results to users ResultCollector

For non-HA functions on the client, results will now be passed to the
users result collector, even if some nodes fail due to a bucket movement
or cache close.

Signed-off-by: Dan Smith <upthewaterspout@apache.org>

-
+import com.gemstone.gemfire.GemFireException;
+        GemFireException functionExecutionException = null;
-              rc.clearResults();
-              if (!isHA) {
+              // Clear the results only if isHA so that partial results can be returned.
+              if (isHA) {
+                rc.clearResults();
+              } else {
-                  throw new FunctionInvocationTargetException(ee.getCause()
-                      .getCause());
+                  functionExecutionException = new FunctionInvocationTargetException(
+                      ee.getCause().getCause());
-                  throw new FunctionInvocationTargetException(
+                  functionExecutionException = new FunctionInvocationTargetException(
-                
-              throw (FunctionException)ee.getCause();
+              FunctionException fe = (FunctionException)ee.getCause();
+              if (isHA) {
+                throw fe;
+              } else {
+                functionExecutionException = fe;
+              }
-              throw (ServerOperationException)ee.getCause();
+              ServerOperationException soe = (ServerOperationException)ee.getCause();
+              if (isHA) {
+                throw soe;
+              } else {
+                functionExecutionException = soe;
+              }
-              reexecute = true;
-              rc.clearResults();
-              if (!isHA) {
-                reexecute = false;
-                throw (ServerConnectivityException) ee.getCause();
+              // Clear the results only if isHA so that partial results can be returned.
+              if (isHA) {
+                reexecute = true;
+                rc.clearResults();
+              } else {
+                functionExecutionException = (ServerConnectivityException) ee.getCause();
+        if (functionExecutionException != null) {
+          throw functionExecutionException;
+        }
