GEODE-6712: locator should not start if cluster configuration service failed to start (#3815)


-import org.apache.geode.distributed.LockServiceDestroyedException;
-  private void startDistributedSystem() throws UnknownHostException {
+  private void startDistributedSystem() throws IOException {
-  private void startCache(DistributedSystem system) {
+  private void startCache(DistributedSystem system) throws IOException {
-  private void startClusterManagementService() {
+  private void startClusterManagementService() throws IOException {
-  private void startConfigurationPersistenceService() {
+  private void startConfigurationPersistenceService() throws IOException {
-    try {
-      if (locator.configurationPersistenceService == null) {
-        // configurationPersistenceService will already be created in case of auto-reconnect
-        locator.configurationPersistenceService =
-            new InternalConfigurationPersistenceService(locator.internalCache, workingDirectory,
-                JAXBService.create());
-      }
-      locator.configurationPersistenceService
-          .initSharedConfiguration(locator.loadFromSharedConfigDir());
-      logger.info(
-          "Cluster configuration service start up completed successfully and is now running ....");
-      isSharedConfigurationStarted = true;
-    } catch (CancelException | LockServiceDestroyedException e) {
-      if (logger.isDebugEnabled()) {
-        logger.debug("Cluster configuration start up was cancelled", e);
-      }
-    } catch (Exception e) {
-      logger.error(e.getMessage(), e);
+
+    if (locator.configurationPersistenceService == null) {
+      // configurationPersistenceService will already be created in case of auto-reconnect
+      locator.configurationPersistenceService =
+          new InternalConfigurationPersistenceService(locator.internalCache, workingDirectory,
+              JAXBService.create());
+    locator.configurationPersistenceService
+        .initSharedConfiguration(locator.loadFromSharedConfigDir());
+    logger.info(
+        "Cluster configuration service start up completed successfully and is now running ....");
+    isSharedConfigurationStarted = true;
