GEODE-3062: create new SecurityService after receiving cluster config

+import org.apache.geode.internal.security.SecurityServiceFactory;
-import org.apache.geode.cache.client.internal.ConnectionImpl;
-import org.apache.geode.internal.security.SecurityServiceFactory;
+  private volatile ConfigurationResponse configurationResponse;
+
-      this.securityService = this.system.getSecurityService();
+      this.configurationResponse = loadClusterConfig();
+
+      this.securityService = SecurityServiceFactory.create(cacheConfig, this.system.getConfig());
+      this.system.setSecurityService(this.securityService);
+  private ConfigurationResponse loadClusterConfig() {
+    // request and check cluster configuration
+    ConfigurationResponse configurationResponse = requestSharedConfiguration();
+    deployJarsReceivedFromClusterConfiguration(configurationResponse);
+
+    // apply the cluster's properties configuration and initialize security using that configuration
+    ClusterConfigurationLoader.applyClusterPropertiesConfiguration(configurationResponse,
+        this.system.getConfig());
+
+    return configurationResponse;
+  }
+
-    // request and check cluster configuration
-    ConfigurationResponse configurationResponse = requestSharedConfiguration();
-    deployJarsReceivedFromClusterConfiguration(configurationResponse);
-
-    // apply the cluster's properties configuration and initialize security using that configuration
-    ClusterConfigurationLoader.applyClusterPropertiesConfiguration(this, configurationResponse,
-        this.system.getConfig());
+    // Cluster Config request moved from here
-      if (configurationResponse == null) {
+      if (this.configurationResponse == null) {
-      ClusterConfigurationLoader.applyClusterXmlConfiguration(this, configurationResponse,
+      ClusterConfigurationLoader.applyClusterXmlConfiguration(this, this.configurationResponse,
+        this.configurationResponse = null;
