GEODE-7162: Remove AttributesFactory in geode-lucene (#4280)

- Fixed method setPartitionAttributes to behave as the one within
  the deprecated AttributesFactory class.
- Removed references to the deprecated AttributesFactory from the
  geode-lucene module.
+import org.apache.geode.internal.cache.PartitionAttributesImpl;
-  public void setPartitionAttributes(PartitionAttributes pa) {
-    if (pa != null) {
+  public void setPartitionAttributes(PartitionAttributes partitionAttr) {
+    if (partitionAttr != null) {
-        this.setDataPolicy(PartitionedRegionHelper.DEFAULT_DATA_POLICY);
+        setDataPolicy(PartitionedRegionHelper.DEFAULT_DATA_POLICY);
+      } else if (!PartitionedRegionHelper.ALLOWED_DATA_POLICIES.contains(getDataPolicy())) {
+        throw new IllegalStateException(
+            String.format(
+                "Data policy %s is not allowed for a partitioned region. DataPolicies other than %s are not allowed.",
+                this.getDataPolicy(), PartitionedRegionHelper.ALLOWED_DATA_POLICIES));
-      this.partitionAttributes = pa;
+      if (hasPartitionAttributes()
+          && partitionAttributes instanceof PartitionAttributesImpl
+          && partitionAttr instanceof PartitionAttributesImpl) {
+
+        // Make a copy and call merge on it to prevent bug 51616
+        PartitionAttributesImpl copy = ((PartitionAttributesImpl) partitionAttributes).copy();
+        copy.merge((PartitionAttributesImpl) partitionAttr);
+        this.partitionAttributes = copy;
+      } else {
+        this.partitionAttributes = partitionAttr;
+      }
+
+      ((PartitionAttributesImpl) partitionAttributes).setOffHeap(offHeap);
+    } else {
+      partitionAttributes = null;
+      setHasPartitionAttributes(false);
