GEODE-4858: Refactor destroy gateway-receiver command (#1968)

* GEODE-4858: Refactor destroy gateway-receiver command

Refactored to use SingleGfshCommand and ResultModel

Added tests for more complete unit test coverage of
DestroyGatewayReceiverFuntion

-import java.util.Arrays;
+import org.apache.geode.cache.configuration.CacheConfig;
-import org.apache.geode.distributed.internal.InternalConfigurationPersistenceService;
-import org.apache.geode.management.cli.Result;
+import org.apache.geode.management.cli.SingleGfshCommand;
-import org.apache.geode.management.internal.cli.result.CommandResult;
-import org.apache.geode.management.internal.cli.result.ResultBuilder;
+import org.apache.geode.management.internal.cli.result.model.ResultModel;
-public class DestroyGatewayReceiverCommand extends InternalGfshCommand {
+public class DestroyGatewayReceiverCommand extends SingleGfshCommand {
-  public Result destroyGatewayReceiver(
+  public ResultModel destroyGatewayReceiver(
-        executeAndGetFunctionResult(DestroyGatewayReceiverFunction.INSTANCE, ifExists, members);
+        executeAndGetFunctionResult(DestroyGatewayReceiverFunction.INSTANCE, null, members);
-    CommandResult result = ResultBuilder.buildResult(functionResults);
+    ResultModel result = ResultModel.createMemberStatusResult(functionResults, ifExists);
+    result.setConfigObject(new CacheConfig.GatewayReceiver());
-    // Only update the cluster config if the command is not executed on specific members.
-    InternalConfigurationPersistenceService service =
-        (InternalConfigurationPersistenceService) getConfigurationPersistenceService();
-    if (onMember != null || service == null) {
-      persisted = false;
-    } else if (result.getStatus().equals(Result.Status.OK) && service != null) {
-      if (onGroups == null) {
-        onGroups = new String[] {"cluster"};
-      }
-      Arrays.stream(onGroups).forEach(group -> service.updateCacheConfig(group, cc -> {
-        if (cc == null || cc.getGatewayReceiver() == null) {
-          if (!ifExists) {
-            result.setStatus(Result.Status.ERROR);
-          }
-        } else {
-          cc.setGatewayReceiver(null);
-        }
-        return cc;
-      }));
-    }
-    result.setCommandPersisted(persisted);
+
+  @Override
+  public void updateClusterConfig(String group, CacheConfig config, Object element) {
+    if (config.getGatewayReceiver() != null) {
+      config.setGatewayReceiver(null);
+    }
+  }
