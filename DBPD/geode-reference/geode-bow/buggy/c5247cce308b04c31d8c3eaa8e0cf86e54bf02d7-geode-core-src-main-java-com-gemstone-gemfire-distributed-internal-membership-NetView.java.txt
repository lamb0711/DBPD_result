GEODE-1372 added unit test and some more fixes.

-    DataSerializer.writeObject(publicKeys, out);
+    DataSerializer.writeHashMap(publicKeys, out);
-    publicKeys = DataSerializer.readObject(in);
+    publicKeys = DataSerializer.readHashMap(in);
