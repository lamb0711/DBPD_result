GEODE-4734: cleanup tests for use as examples in Geode wiki (#1518)



+import static org.assertj.core.api.Assertions.assertThat;
-import java.util.Collections;
-  private static InternalCache cache;
+  private static volatile InternalCache cache;
-    this.createCacheInAll = false;
-    this.createCache = false;
-    this.disconnectAfter = false;
-    this.createCacheInVMs = Collections.emptyList();
-    this.config = new Properties();
-    this.config.setProperty(LOCATORS, getLocators());
-    this.systemProperties = new Properties();
+    this(new Builder());
-    this.createCacheInAll = builder.createCacheInAll;
-    this.createCache = builder.createCache;
-    this.disconnectAfter = builder.disconnectAfter;
-    this.createCacheInVMs = builder.createCacheInVMs;
-    this.config = builder.config;
-    this.systemProperties = builder.systemProperties;
+    createCacheInAll = builder.createCacheInAll;
+    createCache = builder.createCache;
+    disconnectAfter = builder.disconnectAfter;
+    createCacheInVMs = builder.createCacheInVMs;
+    config = builder.config;
+    systemProperties = builder.systemProperties;
-  public InternalCache createCache() {
-    createCache(config, systemProperties);
-    return cache;
+  public void createCache() {
+    cache = (InternalCache) new CacheFactory(config).create();
-  private static void createCache(final Properties config, final Properties systemProperties) {
+  public void createCache(final Properties config) {
+    cache = (InternalCache) new CacheFactory(config).create();
+  }
+
+  public void createCache(final Properties config, final Properties systemProperties) {
+  public InternalCache getOrCreateCache() {
+    if (cache == null) {
+      createCache();
+      assertThat(cache).isNotNull();
+    }
+    return cache;
+  }
+
-      this.config.put(key, value);
+      config.put(key, value);
-      this.systemProperties.put(key, value);
+      systemProperties.put(key, value);
-      this.systemProperties.putAll(config);
+      systemProperties.putAll(config);
