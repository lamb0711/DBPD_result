GEODE-4406: Improve authorization granularity for protobuf (#1514)


+import org.apache.geode.internal.protocol.protobuf.v1.ProtobufSerializationService;
+import org.apache.geode.internal.protocol.protobuf.v1.RegionAPI;
+import org.apache.geode.management.internal.security.ResourcePermissions;
+  private final ResourcePermission noneRequired =
+      new ResourcePermission(ResourcePermission.NULL, ResourcePermission.NULL);
+
+  private ResourcePermission skipAuthorizationCheck(Object unused,
+      ProtobufSerializationService unused2) {
+    return noneRequired;
+  }
+
-            new ResourcePermission(ResourcePermission.NULL, ResourcePermission.NULL)));
+            this::skipAuthorizationCheck));
-            new ResourcePermission(ResourcePermission.Resource.DATA,
-                ResourcePermission.Operation.READ)));
+            GetRequestOperationHandler::determineRequiredPermission));
-            new ResourcePermission(ResourcePermission.Resource.DATA,
-                ResourcePermission.Operation.READ)));
+            // May require per-key checks, will be handled by OperationHandler
+            this::skipAuthorizationCheck));
-            new ResourcePermission(ResourcePermission.Resource.DATA,
-                ResourcePermission.Operation.WRITE)));
+            PutRequestOperationHandler::determineRequiredPermission));
-            new ResourcePermission(ResourcePermission.Resource.DATA,
-                ResourcePermission.Operation.WRITE)));
+            // May require per-key checks, will be handled by OperationHandler
+            this::skipAuthorizationCheck));
-            new ResourcePermission(ResourcePermission.Resource.DATA,
-                ResourcePermission.Operation.WRITE)));
+            RemoveRequestOperationHandler::determineRequiredPermission));
-            new ResourcePermission(ResourcePermission.Resource.DATA,
-                ResourcePermission.Operation.READ)));
+            ResourcePermissions.DATA_READ));
-            new ResourcePermission(ResourcePermission.Resource.DATA,
-                ResourcePermission.Operation.READ)));
+            ResourcePermissions.DATA_READ));
-            new ResourcePermission(ResourcePermission.Resource.CLUSTER,
-                ResourcePermission.Operation.READ)));
+            ResourcePermissions.DATA_READ));
-            new ResourcePermission(ResourcePermission.NULL, ResourcePermission.NULL)));
+            this::skipAuthorizationCheck));
-            new ResourcePermission(ResourcePermission.NULL, ResourcePermission.NULL)));
+            this::skipAuthorizationCheck));
-            new ResourcePermission(ResourcePermission.NULL, ResourcePermission.NULL)));
+            this::skipAuthorizationCheck));
