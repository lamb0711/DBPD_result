GEODE-6522 Server hangs during shutdown after becoming membership coordinator

Schedule removal of members that have failed availability checks before
becoming coordinator.  Do not shut down the View Creator thread if the
view was created locally, even if it seems to have a different
coordinator.

-      logger.info(
-          "View with removed and left members removed is {}; removed members: {}; left members: {}; suspect members: {}",
-          check, removedMembers, leftMembers, suspectMembers);
+      logger.info("View with removed and left members removed is {}", check);
+        for (InternalDistributedMember suspect : suspectMembers) {
+          recordViewRequest(
+              new RemoveMemberMessage(localAddress, suspect, "Failed availability check"));
+        }
+      ViewCreator thread = this.viewCreator;
-          && getViewCreator() != null) {
-        getViewCreator().markViewCreatorForShutdown();
+          && !localAddress.equals(view.getCreator())
+          && thread != null) {
+        thread.markViewCreatorForShutdown(view.getCoordinator());
-    private void markViewCreatorForShutdown() {
+    private void markViewCreatorForShutdown(InternalDistributedMember viewCreator) {
+      logger.info(
+          "Marking view creator for shutdown because {} is now the coordinator.  My address is {}."
+              + "  Net member IDs are {} and {} respectively",
+          viewCreator, localAddress, viewCreator.getNetMember(), localAddress.getNetMember());
+        logger.info("View Creator thread is exiting");
+        markViewCreatorForShutdown = false;
