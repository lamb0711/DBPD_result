client server

client server

+  public static String ALL_KEYS = "*";
+  public String getKey() {
+    return key;
+  }
+
+  private String key = ALL_KEYS;
-    this(Resource.valueOf(resource), Operation.valueOf(operation));
+    this(resource, operation, ALL_REGIONS);
+  }
+
+  public GeodePermission(String resource, String operation, String regionName) {
+    this(resource, operation, regionName, ALL_KEYS);
+  }
+
+  public GeodePermission(String resource, String operation, String regionName, String key) {
+    this((resource==null) ? Resource.NULL : Resource.valueOf(resource),
+      (operation == null) ? Operation.NULL : Operation.valueOf(operation),
+      regionName,
+      key);
-  public GeodePermission(String resource, String operation, String regionName) {
-    if(resource != null) this.resource = Resource.valueOf(resource);
-    if(operation != null) this.operation = Operation.valueOf(operation);
-    if(regionName != null) this.regionName = regionName;
-
-    setParts(this.resource+":"+this.operation+":"+this.regionName, true);
+  public GeodePermission(Resource resource, Operation operation, String regionName){
+    this(resource, operation, regionName, ALL_KEYS);
-  public GeodePermission(Resource resource, Operation operation, String regionName){
+  public GeodePermission(Resource resource, Operation operation, String regionName, String key){
+    if(key != null) this.key = key;
-    setParts(this.resource+":"+this.operation+":"+this.regionName, true);
+    setParts(this.resource+":"+this.operation+":"+this.regionName+":"+this.key, true);
-    if (ALL_REGIONS.equals(getRegionName())) {
+    if (ALL_REGIONS.equals(regionName)) {
-    } else {
-      return getResource() + ":" + getOperation() + ":" + getRegionName();
+    } else if(ALL_KEYS.equals(key)) {
+      return resource + ":" + operation + ":" + regionName;
+    }
+    else{
+      return resource + ":" + operation + ":" + regionName + ":" + key;
