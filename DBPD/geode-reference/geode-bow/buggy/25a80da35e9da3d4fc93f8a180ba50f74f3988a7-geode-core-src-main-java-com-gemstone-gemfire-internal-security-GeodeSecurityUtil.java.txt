Fixing close method

+
+  private static SecurityManager securityManager;
-      SecurityManager authenticator = (SecurityManager) authenticatorObject;
-      authenticator.init(securityProps);
-      Realm realm = new CustomAuthRealm(authenticator);
+      securityManager = (SecurityManager) authenticatorObject;
+      securityManager.init(securityProps);
+      Realm realm = new CustomAuthRealm(securityManager);
-  public static void close(Properties securityProps) {
-    if (securityProps != null) {
-      String customAuthenticator = securityProps.getProperty(SECURITY_MANAGER);
-      Object authenticatorObject = getObject(customAuthenticator);
-      if (authenticatorObject != null && authenticatorObject instanceof SecurityManager) {
-        ((SecurityManager) authenticatorObject).close();
+  public static void close() {
+      if (securityManager != null) {
+        securityManager.close();
+        securityManager = null;
-    }
-    return;
+
