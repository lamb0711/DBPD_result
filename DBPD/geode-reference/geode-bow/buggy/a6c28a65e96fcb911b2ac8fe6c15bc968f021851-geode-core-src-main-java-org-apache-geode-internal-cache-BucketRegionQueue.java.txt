GEODE-2400: use a function to implement waitUntilFlushed, then accessor and client
can have this feature.

+import org.apache.geode.internal.cache.execute.BucketMovedException;
+    long then = System.currentTimeMillis();
-      logger.debug("BucketRegionQueue: waitUntilFlushed bucket=" + getId() + "; time="
-          + System.currentTimeMillis() + "; timeout=" + timeout + "; unit=" + unit);
+      logger.debug("BucketRegionQueue: waitUntilFlushed bucket=" + getId() + "; timeout=" + timeout
+          + "; unit=" + unit);
-        if (latestAcknowledgedKey.get() > latestQueuedKeyToCheck || isEmpty()) {
-          result = true;
-          break;
+        try {
+          if (latestAcknowledgedKey.get() > latestQueuedKeyToCheck || isEmpty()) {
+            result = true;
+            break;
+          }
+        } catch (RegionDestroyedException e) {
+          if (this.isBucketDestroyed()) {
+            getCancelCriterion().checkCancelInProgress(e);
+            throw new BucketMovedException(this.getFullPath());
+          }
-      logger.debug("BucketRegionQueue: waitUntilFlushed completed bucket=" + getId() + "; time="
-          + System.currentTimeMillis() + "; result=" + result);
+      logger.debug("BucketRegionQueue: waitUntilFlushed completed bucket=" + getId() + "; duration="
+          + (System.currentTimeMillis() - then) + "; result=" + result);
