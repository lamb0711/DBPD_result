GEODE-6363 LocatorUDPSecurityDUnitTest

Changes in GMSJoinLeave prevent a restarting locator from becoming
membership coordinator if its findCoordinatorFromView method indicates
that it received responses from processes that are members of a
distributed system.  It now also waits for more than one response to its
requests to find the coordinator from other members so that it gets a
better picture of who's out there that might be the current coordinator.

+    public int joinedMembersContacted;
+    public int responsesExpected;
+          .append("; findInViewResponses=").append(joinedMembersContacted)
-            if (tries > 2 || System.currentTimeMillis() < giveupTime) {
+            if (state.joinedMembersContacted <= 0 &&
+                (tries > 2 || System.currentTimeMillis() < giveupTime)) {
+    logger.info("sending FindCoordinatorRequests to {}", recipients);
+
+          state.responsesExpected = recipients.size();
-    InternalDistributedMember coord = null;
+    InternalDistributedMember bestGuessCoordinator = null;
-      coord = localAddress;
+      bestGuessCoordinator = localAddress;
-    boolean coordIsNoob = true;
+    state.joinedMembersContacted = 0;
+    boolean bestGuessIsNotMember = true;
-      InternalDistributedMember mbr = resp.getCoordinator();
-      if (!localAddress.equals(mbr) && !state.alreadyTried.contains(mbr)) {
-        boolean mbrIsNoob = (mbr.getVmViewId() < 0);
-        if (mbrIsNoob) {
+      InternalDistributedMember suggestedCoordinator = resp.getCoordinator();
+      if (resp.getSenderId().getVmViewId() >= 0) {
+        state.joinedMembersContacted++;
+      }
+      if (!localAddress.equals(suggestedCoordinator)
+          && !state.alreadyTried.contains(suggestedCoordinator)) {
+        boolean suggestedIsNotMember = (suggestedCoordinator.getVmViewId() < 0);
+        if (suggestedIsNotMember) {
-          if (coordIsNoob && (coord == null || coord.compareTo(mbr, false) > 0)) {
-            coord = mbr;
+          if (bestGuessIsNotMember && (bestGuessCoordinator == null
+              || bestGuessCoordinator.compareTo(suggestedCoordinator, false) > 0)) {
+            bestGuessCoordinator = suggestedCoordinator;
-          if (coordIsNoob || mbr.getVmViewId() > coord.getVmViewId()) {
-            coord = mbr;
-            coordIsNoob = false;
+          if (bestGuessIsNotMember
+              || suggestedCoordinator.getVmViewId() > bestGuessCoordinator.getVmViewId()) {
+            bestGuessCoordinator = suggestedCoordinator;
+            bestGuessIsNotMember = false;
+        logger.info("findCoordinatorFromView's best guess is now {}", bestGuessCoordinator);
-      logger.info("findCoordinatorFromView is selecting {}", coord);
-    state.possibleCoordinator = coord;
-    return coord != null;
+    state.possibleCoordinator = bestGuessCoordinator;
+    return bestGuessCoordinator != null;
-      searchState.responses.notifyAll();
+      if (searchState.responsesExpected <= searchState.responses.size()) {
+        searchState.responses.notifyAll();
+      }
