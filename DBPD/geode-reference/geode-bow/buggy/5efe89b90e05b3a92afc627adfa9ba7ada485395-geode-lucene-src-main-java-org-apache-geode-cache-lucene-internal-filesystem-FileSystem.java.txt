GEODE-2314: EOF file segment exceptions due to empty file

 * We will occasionally see EOF exceptions due to file segments being empty
 * This diff also reinstates the query retry
 * Added a few null checks
 * Added additional logging for exceptional cases

+import org.apache.geode.cache.Region;
+import org.apache.geode.internal.logging.LogService;
+import org.apache.logging.log4j.Logger;
+
-  // private final Cache cache;
+  private static final Logger logger = LogService.getLogger();
+
+  public File putIfAbsentFile(String name, File file) throws IOException {
+    // TODO lock region ?
+    if (null != fileRegion.putIfAbsent(name, file)) {
+      throw new IOException("File exists.");
+    }
+    stats.incFileCreates(1);
+    // TODO unlock region ?
+    return file;
+  }
+
+
-    final File destFile = createFile(dest);
+    final File destFile = new File(this, dest);
-    updateFile(destFile);
+    putIfAbsentFile(dest, destFile);
-
-
-    stats.incReadBytes(chunk.length);
+    if (chunk != null) {
+      stats.incReadBytes(chunk.length);
+    } else {
+      logger.debug("Chunk was null for file:" + file.getName() + " file id: " + key.getFileId()
+          + " chunkKey:" + key.chunkId);
+    }
