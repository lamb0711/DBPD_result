[GEODE-2324] Make AcceptorImplObserver an interface

and fix threading issues.

+  // Assumed non-null. Do not set this to null.
+  private static AcceptorImplObserver acceptorImplObserver_do_not_access_directly =
+      new AcceptorImplObserver() {
+        @Override
+        public void beforeClose(AcceptorImpl acceptorImpl) {}
+
+        @Override
+        public void normalCloseTermination(AcceptorImpl acceptorImpl) {}
+
+        @Override
+        public void afterClose(AcceptorImpl acceptorImpl) {}
+      };
+
+  private static AcceptorImplObserver getAcceptorImplObserver() {
+    synchronized (AcceptorImpl.class) {
+      return acceptorImplObserver_do_not_access_directly;
+    }
+  }
+
+  public static void setObserver_TESTONLY(AcceptorImplObserver observer) {
+    synchronized (AcceptorImpl.class) {
+      if (observer != null) {
+        acceptorImplObserver_do_not_access_directly = observer;
+      }
+    }
+  }
+
-    AcceptorImplObserver acceptorImplObserver = AcceptorImplObserver.getInstance();
+    AcceptorImplObserver acceptorImplObserver = getAcceptorImplObserver();
-        if (acceptorImplObserver != null) {
-          acceptorImplObserver.beforeClose(this);
-        }
+        acceptorImplObserver.beforeClose(this);
-        if (acceptorImplObserver != null) {
-          acceptorImplObserver.normalCloseTermination(this);
-        }
+        acceptorImplObserver.normalCloseTermination(this);
-      if (acceptorImplObserver != null) {
-        acceptorImplObserver.afterClose(this);
-      }
+      acceptorImplObserver.afterClose(this);
