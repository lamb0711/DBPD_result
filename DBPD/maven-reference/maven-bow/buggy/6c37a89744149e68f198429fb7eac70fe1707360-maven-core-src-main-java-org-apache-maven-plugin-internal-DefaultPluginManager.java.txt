[MNG-4756] Aether integration


git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@988749 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.maven.artifact.repository.DefaultRepositoryRequest;
-import org.apache.maven.artifact.repository.RepositoryRequest;
-            RepositoryRequest repositoryRequest =
-                DefaultRepositoryRequest.getRepositoryRequest( session, session.getCurrentProject() );
-
-            pluginDescriptor = pluginManager.getPluginDescriptor( plugin, repositoryRequest );
+            pluginDescriptor =
+                pluginManager.getPluginDescriptor( plugin, session.getCurrentProject().getRemotePluginRepositories(),
+                                                   session.getRepositorySession() );
-            RepositoryRequest repositoryRequest =
-                DefaultRepositoryRequest.getRepositoryRequest( session, session.getCurrentProject() );
-
-            pluginDescriptor = pluginManager.getPluginDescriptor( plugin, repositoryRequest );
+            pluginDescriptor =
+                pluginManager.getPluginDescriptor( plugin, session.getCurrentProject().getRemotePluginRepositories(),
+                                                   session.getRepositorySession() );
-        RepositoryRequest repositoryRequest = new DefaultRepositoryRequest();
-        repositoryRequest.setLocalRepository( localRepository );
-        repositoryRequest.setRemoteRepositories( project.getPluginArtifactRepositories() );
-        repositoryRequest.setOffline( settings.isOffline() );
+        MavenSession session = legacySupport.getSession();
-            PluginVersionRequest versionRequest = new DefaultPluginVersionRequest( plugin, repositoryRequest );
+            PluginVersionRequest versionRequest =
+                new DefaultPluginVersionRequest( plugin, session.getRepositorySession(),
+                                                 project.getRemotePluginRepositories() );
-            return pluginManager.getPluginDescriptor( plugin, repositoryRequest );
+            return pluginManager.getPluginDescriptor( plugin, project.getRemotePluginRepositories(),
+                                                      session.getRepositorySession() );
-            throw new PluginNotFoundException( plugin, repositoryRequest.getRemoteRepositories() );
+            throw new PluginNotFoundException( plugin, project.getPluginArtifactRepositories() );
