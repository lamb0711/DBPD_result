Centralized repository handling in AbstractVersionTransformation, for consistency (should fix MNG-527).

Changed download strategy for plugins.xml metadata to download only when non-existent locally or when plugin prefix cannot be located within local metadata. NOTE: This could lead to local-only installs of plugins having their prefix mappings overwritten.

Next step is to change the maven-plugin-plugin.


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@219615 13f79535-47bb-0310-9956-ffa450edef68

+    private boolean refreshed = false;
-        // flush the cache.
-        pluginDefinitionsByPrefix = null;
-        pluginDefinitionsByPackaging = null;
+        clearCache();
+    }
+    
+    public void markRefreshed()
+    {
+        this.refreshed = true;
+    }
+    
+    public boolean isRefreshed()
+    {
+        return refreshed;
+    }
+    
+    public List getPluginMaps()
+    {
+        return mappings;
+    }
+    
+    public void clear()
+    {
+        this.mappings = null;
+        clearCache();
+    }
+
+    private void clearCache()
+    {
+        this.pluginDefinitionsByPackaging = null;
+        this.pluginDefinitionsByPrefix = null;
