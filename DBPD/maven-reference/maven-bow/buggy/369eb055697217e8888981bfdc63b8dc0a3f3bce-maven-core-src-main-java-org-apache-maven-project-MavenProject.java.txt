refactor plugin configuration finding and mergine into MavenProject


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@163724 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.model.Goal;
+import org.apache.maven.util.Xpp3DomUtils;
+import org.codehaus.plexus.util.xml.Xpp3Dom;
+    public Xpp3Dom getGoalConfiguration( String pluginId, String goalName )
+    {
+        Xpp3Dom dom = null;
+
+        // ----------------------------------------------------------------------
+        // I would like to be able to lookup the Plugin object using a key but
+        // we have a limitation in modello that will be remedied shortly. So
+        // for now I have to iterate through and see what we have.
+        // ----------------------------------------------------------------------
+
+        if ( getPlugins() != null )
+        {
+            for ( Iterator iterator = getPlugins().iterator(); iterator.hasNext(); )
+            {
+                Plugin plugin = (Plugin) iterator.next();
+
+                // TODO: groupID not handled
+                if ( pluginId.equals( plugin.getArtifactId() ) )
+                {
+                    dom = (Xpp3Dom) plugin.getConfiguration();
+
+                    if ( goalName != null )
+                    {
+                        for ( Iterator j = plugin.getGoals().iterator(); j.hasNext(); )
+                        {
+                            Goal goal = (Goal) j.next();
+                            if ( goal.getId().equals( goalName ) )
+                            {
+                                Xpp3Dom goalConfiguration = (Xpp3Dom) goal.getConfiguration();
+                                if ( goalConfiguration != null )
+                                {
+                                    Xpp3Dom newDom = Xpp3DomUtils.copyXpp3Dom( goalConfiguration );
+                                    dom = Xpp3DomUtils.mergeXpp3Dom( newDom, dom );
+                                }
+                                break;
+                            }
+                        }
+                    }
+                    break;
+                }
+            }
+        }
+        return dom;
+    }
