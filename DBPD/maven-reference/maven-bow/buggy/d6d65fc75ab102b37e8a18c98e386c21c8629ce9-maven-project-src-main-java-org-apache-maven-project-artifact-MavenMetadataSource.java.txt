add quick support for exclusions



git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@188779 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.artifact.resolver.filter.ArtifactFilter;
+import org.apache.maven.artifact.resolver.filter.ExcludesArtifactFilter;
+import org.apache.maven.artifact.resolver.filter.AndArtifactFilter;
+import org.apache.maven.model.Exclusion;
+import java.util.ArrayList;
-                                                   artifact.getVersion(), artifact.getScope(), "pom" );
+                                                               artifact.getVersion(), artifact.getScope(), "pom" );
-        return createArtifacts( dependencies, artifact.getScope() );
+        return createArtifacts( dependencies, artifact.getScope(), artifact.getDependencyFilter() );
-    protected Set createArtifacts( List dependencies, String inheritedScope )
+    public Set createArtifacts( List dependencies, String inheritedScope, ArtifactFilter dependencyFilter )
-            if ( artifact != null )
+
+            if ( artifact != null && ( dependencyFilter == null || dependencyFilter.include( artifact ) ) )
-                projectArtifacts.add( artifact );
+                if ( d.getExclusions() != null && !d.getExclusions().isEmpty() )
+                {
+                    List exclusions = new ArrayList();
+                    for ( Iterator j = d.getExclusions().iterator(); j.hasNext(); )
+                    {
+                        Exclusion e = (Exclusion) j.next();
+                        exclusions.add( e.getGroupId() + ":" + e.getArtifactId() );
+                    }
+
+                    ArtifactFilter newFilter = new ExcludesArtifactFilter( exclusions );
+
+                    if ( dependencyFilter != null )
+                    {
+                        AndArtifactFilter filter = new AndArtifactFilter();
+                        filter.add( dependencyFilter );
+                        filter.add( newFilter );
+                        dependencyFilter = filter;
+                    }
+                    else
+                    {
+                        dependencyFilter = newFilter;
+                    }
+                }
+
+                artifact.setDependencyFilter( dependencyFilter );
+
+                    projectArtifacts.add( artifact );
