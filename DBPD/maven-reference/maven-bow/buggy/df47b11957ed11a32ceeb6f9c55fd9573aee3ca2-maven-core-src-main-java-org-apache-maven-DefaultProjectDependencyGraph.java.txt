[MNG-2576] Make Like Reactor Mode

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@794043 13f79535-47bb-0310-9956-ffa450edef68

-        List<MavenProject> projects = new ArrayList<MavenProject>();
-
-        for ( MavenProject p : sorter.getSortedProjects() )
-        {
-            if ( projectIds.contains( ProjectSorter.getId( p ) ) )
-            {
-                projects.add( p );
-            }
-        }
-
-        return projects;
+        return getProjects( projectIds );
+    public List<MavenProject> getUpstreamProjects( MavenProject project, boolean transitive )
+    {
+        if ( project == null )
+        {
+            throw new IllegalArgumentException( "project missing" );
+        }
+
+        Collection<String> projectIds = new HashSet<String>();
+
+        getUpstreamProjects( ProjectSorter.getId( project ), projectIds, transitive );
+
+        return getProjects( projectIds );
+    }
+
+    private void getUpstreamProjects( String projectId, Collection<String> projectIds, boolean transitive )
+    {
+        for ( String id : sorter.getDependencies( projectId ) )
+        {
+            projectIds.add( id );
+
+            if ( transitive )
+            {
+                getUpstreamProjects( id, projectIds, transitive );
+            }
+        }
+    }
+
+    private List<MavenProject> getProjects( Collection<String> projectIds )
+    {
+        List<MavenProject> projects = new ArrayList<MavenProject>();
+
+        for ( MavenProject p : sorter.getSortedProjects() )
+        {
+            if ( projectIds.contains( ProjectSorter.getId( p ) ) )
+            {
+                projects.add( p );
+            }
+        }
+
+        return projects;
+    }
+
