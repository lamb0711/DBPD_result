o Restored backward-compat with regard to handling of duplicate dependencies during metadata retrieval

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@784227 13f79535-47bb-0310-9956-ffa450edef68

+
+        if ( request.istLenientValidation() )
+        {
+            /*
+             * NOTE: This is to keep backward-compat with Maven 2.x which did not validate that dependencies are unique
+             * within a single POM. Upon multiple declarations, 2.x just kept the last one. So when we're in lenient
+             * mode for metadata retrieval, we have to deal with such broken POMs and mimic the way 2.x works.
+             */
+            Map<String, Dependency> dependencies = new LinkedHashMap<String, Dependency>();
+            for ( Dependency dependency : model.getDependencies() )
+            {
+                dependencies.put( dependency.getManagementKey(), dependency );
+            }
+            model.setDependencies( new ArrayList<Dependency>( dependencies.values() ) );
+        }
