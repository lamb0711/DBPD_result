o Used project realm during dependency resolution
o Fixed NPEs

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@793871 13f79535-47bb-0310-9956-ffa450edef68

+import org.codehaus.plexus.classworlds.realm.ClassRealm;
+
+        ClassLoader oldContextClassLoader = Thread.currentThread().getContextClassLoader();
+                ClassRealm projectRealm = currentProject.getClassRealm();
+                if ( projectRealm != null )
+                {
+                    Thread.currentThread().setContextClassLoader( projectRealm );
+                }
+
+
+                Thread.currentThread().setContextClassLoader( oldContextClassLoader );
