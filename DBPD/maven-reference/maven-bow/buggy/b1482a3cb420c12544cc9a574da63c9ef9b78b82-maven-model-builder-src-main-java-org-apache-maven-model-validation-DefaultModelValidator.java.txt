o Improved error message in case of empty plugin version (i.e. <version/>, not to be confused with a completely missing <version>)

git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@883551 13f79535-47bb-0310-9956-ffa450edef68

-                    validateStringNotEmpty( "build.plugins.plugin.version", problems, errOn31, p.getVersion(),
-                                            p.getKey() );
-
-                    validatePluginVersion( "build.plugins.plugin.version", problems, errOn30, p.getVersion(), p.getKey() );
+                    validatePluginVersion( "build.plugins.plugin.version", problems, p.getVersion(), p.getKey(),
+                                           request );
-    private boolean validatePluginVersion( String fieldName, ModelProblemCollector problems, Severity severity, String string,
-                                     String sourceHint )
+    private boolean validatePluginVersion( String fieldName, ModelProblemCollector problems, String string,
+                                           String sourceHint, ModelBuildingRequest request )
-        if ( string == null || string.length() <= 0 )
+        Severity errOn30 = getSeverity( request, ModelBuildingRequest.VALIDATION_LEVEL_MAVEN_3_0 );
+        Severity errOn31 = getSeverity( request, ModelBuildingRequest.VALIDATION_LEVEL_MAVEN_3_1 );
+
+        if ( !validateNotNull( fieldName, problems, errOn31, string, sourceHint ) )
-            return true;
+            return false;
-        if ( !hasExpression( string ) && !"RELEASE".equals( string ) && !"LATEST".equals( string ) )
+        if ( string.length() > 0 && !hasExpression( string ) && !"RELEASE".equals( string )
+            && !"LATEST".equals( string ) )
-            addViolation( problems, severity, "'" + fieldName + "' must be a valid version for " + sourceHint
+            addViolation( problems, errOn30, "'" + fieldName + "' must be a valid version for " + sourceHint
-            addViolation( problems, severity, "'" + fieldName + "' must be a valid version but is '" + string + "'." );
+            addViolation( problems, errOn30, "'" + fieldName + "' must be a valid version but is '" + string + "'." );
-        if ( request.getValidationLevel() < errorThreshold )
+        return getSeverity( request.getValidationLevel(), errorThreshold );
+    }
+
+    private static Severity getSeverity( int validationLevel, int errorThreshold )
+    {
+        if ( validationLevel < errorThreshold )
