PR: MNG-471, MNG-489
- refactor project out of MavenSession so that it can be cloned
- refactor lifecycle construction out so we can clone the existing one and pass it into a new execution
- only resolve plugins that are executed (MNG-489)



git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@191413 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.project.MavenProject;
-    public PluginParameterExpressionEvaluator( MavenSession context, PluginDescriptor pluginDescriptor, PathTranslator pathTranslator, Logger logger )
+    private final MavenProject project;
+
+    public PluginParameterExpressionEvaluator( MavenSession context, PluginDescriptor pluginDescriptor,
+                                               PathTranslator pathTranslator, Logger logger, MavenProject project )
+        this.project = project;
-            value = context.getProject();
+            value = project;
-                    value = ReflectionValueExtractor.evaluate( pathExpression, context.getProject() );
+                    value = ReflectionValueExtractor.evaluate( pathExpression, project );
-                    value = ReflectionValueExtractor.evaluate( expression.substring( 1 ), context.getProject() );
+                    value = ReflectionValueExtractor.evaluate( expression.substring( 1 ), project );
-            value = context.getProject().getBasedir().getAbsolutePath();
+            value = project.getBasedir().getAbsolutePath();
-                value = context.getProject().getFile().getParentFile().getAbsolutePath() +
-                    expression.substring( pathSeparator );
+                value = project.getFile().getParentFile().getAbsolutePath() + expression.substring( pathSeparator );
-            // Check properties that have been injected via profiles before we default over to 
+            // Check properties that have been injected via profiles before we default over to
-            
-            if( context.getProject().getProfileProperties() != null )
+
+            if ( project.getProfileProperties() != null )
-                value = context.getProject().getProfileProperties().getProperty( expression );
+                value = project.getProfileProperties().getProperty( expression );
-            if( value == null )
+            if ( value == null )
-        
-        if ( context != null && context.getProject() != null && context.getProject().getFile() != null )
+
+        if ( project != null && project.getFile() != null )
-            basedir = context.getProject().getFile().getParentFile();
+            basedir = project.getFile().getParentFile();
-        
+
