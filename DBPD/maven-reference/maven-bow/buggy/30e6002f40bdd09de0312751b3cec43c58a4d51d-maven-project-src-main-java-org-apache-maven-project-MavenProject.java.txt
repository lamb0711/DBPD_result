o push out the artifact repository creation when it's requested in the project


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@751159 13f79535-47bb-0310-9956-ffa450edef68

+        
+        /*
-            if ( dm.getSnapshotRepository() != null )
-            {
-                repo = repositorySystem.buildArtifactRepository( dm.getSnapshotRepository() );
-                setSnapshotArtifactRepository( repo );
-            }
+        */
-                Artifact artifact = repositorySystem.createPluginArtifact( p.getGroupId(), p.getArtifactId(), version );
+                Artifact artifact = repositorySystem.createPluginArtifact( p );
-                Artifact artifact = repositorySystem.createPluginArtifact( p.getGroupId(), p.getArtifactId(), version );
+                Plugin pp = new Plugin();
+                pp.setGroupId( p.getGroupId() );
+                pp.setArtifactId( p.getArtifactId() );
+                pp.setVersion( version );
+                Artifact artifact = repositorySystem.createPluginArtifact( pp );
+        if ( getDistributionManagement().getRepository() != null )
+        {           
+            try
+            {
+                setReleaseArtifactRepository( repositorySystem.buildArtifactRepository( getDistributionManagement().getRepository() ) );
+            }
+            catch ( InvalidRepositoryException e )
+            {
+            }
+        }
+        
+        if ( getDistributionManagement().getSnapshotRepository() != null )
+        {           
+            try
+            {
+                setSnapshotArtifactRepository( repositorySystem.buildArtifactRepository( getDistributionManagement().getSnapshotRepository() ) );
+            }
+            catch ( InvalidRepositoryException e )
+            {
+            }
+        }
+        
+        /*
+        */
