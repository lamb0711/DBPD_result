o Used project realm during dependency resolution
o Fixed NPEs

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@793871 13f79535-47bb-0310-9956-ffa450edef68

-    
-    private MavenProject standaloneProject;
+            project.setClassRealm( listener.getProjectRealm() );
+
-        if ( standaloneProject != null )
-        {
-            return standaloneProject;
-        }
-
+        MavenProject standaloneProject;
+
-            // Not going to happen.
+            throw new IllegalStateException( e );
+        standaloneProject.setActiveProfiles( result.getActiveExternalProfiles() );
+        standaloneProject.setInjectedProfileIds( "external", getProfileIds( result.getActiveExternalProfiles() ) );
+
