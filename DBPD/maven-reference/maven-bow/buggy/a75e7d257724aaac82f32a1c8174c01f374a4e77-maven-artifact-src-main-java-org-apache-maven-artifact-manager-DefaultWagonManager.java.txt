improved error handling and other clean up


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@163979 13f79535-47bb-0310-9956-ffa450edef68

-    private void releaseWagon( Wagon wagon )
-        throws ComponentLifecycleException
-    {
-        container.release( wagon );
-    }
-
-
-            // TODO [BP]: put all disconnects in finally
-            wagon.disconnect();
-            try
-            {
-                releaseWagon( wagon );
-            }
-            catch ( Exception e )
-            {
-                throw new TransferFailedException( "Unable to release wagon", e );
-            }
+            disconnectWagon( wagon );
+
+            releaseWagon( wagon );
-
-            // TODO [BP]: put all disconnects in finally
-            wagon.disconnect();
-            try
-            {
-                releaseWagon( wagon );
-            }
-            catch ( Exception e )
-            {
-                throw new TransferFailedException( "Release of wagon failed: ", e );
-            }
+            disconnectWagon( wagon );
+
+            releaseWagon( wagon );
-            throw new TransferFailedException( "Downloaded file does not exist: " + temp );
+            throw new ResourceDoesNotExistException( "Downloaded file does not exist: " + temp );
+    private void disconnectWagon( Wagon wagon )
+    {
+        try
+        {
+            wagon.disconnect();
+        }
+        catch ( ConnectionException e )
+        {
+            getLogger().error( "Problem disconnecting from wagon - ignoring: " + e.getMessage() );
+        }
+    }
+
+    private void releaseWagon( Wagon wagon )
+    {
+        try
+        {
+            container.release( wagon );
+        }
+        catch ( ComponentLifecycleException e )
+        {
+            getLogger().error( "Problem releasing wagon - ignoring: " + e.getMessage() );
+        }
+    }
+
