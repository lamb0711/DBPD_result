MNG-4041: maven core returns stale project state during extended use. this is a patch which provides intelligent caching and yields a very substantial performance improvement.
Submitted by: Igor Fedorenko



git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@782014 13f79535-47bb-0310-9956-ffa450edef68

-    @Requirement
-    private MavenProjectCache projectCache;
-    
-        String cacheKey = getCacheKey( pomFile, configuration );
-
-        MavenProject project = projectCache.get( cacheKey );
-                
-        if ( project != null )
-        {
-            return project;
-        }
-        
-        project = fromModelToMavenProject( model, result.getRawModels().get( 1 ).getPomFile(), configuration, model.getPomFile() );
+        MavenProject project = fromModelToMavenProject( model, result.getRawModels().get( 1 ).getPomFile(), configuration, model.getPomFile() );
-        projectCache.put( cacheKey, project );
-                
-    private String getCacheKey( File pomFile, ProjectBuildingRequest configuration )
-    {
-        StringBuilder buffer = new StringBuilder( 256 );
-        buffer.append( pomFile.getAbsolutePath() );
-        buffer.append( '/' ).append( pomFile.lastModified() );
-        return buffer.toString();
-    }
-
