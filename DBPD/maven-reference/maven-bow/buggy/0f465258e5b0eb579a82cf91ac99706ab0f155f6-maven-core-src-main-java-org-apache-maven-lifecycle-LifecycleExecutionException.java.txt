[MNG-4440] error message should clearly indicate the module that failed, and how to continue

git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@836267 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.maven.project.MavenProject;
-
+import org.apache.maven.plugin.MojoExecution;
+import org.apache.maven.project.MavenProject;
+
-    
+
+    LifecycleExecutionException( String message, MojoExecution execution, MavenProject project )
+    {
+        super( message );
+        this.project = project;
+    }
+
+    LifecycleExecutionException( String message, MojoExecution execution, MavenProject project, Throwable cause )
+    {
+        super( message, cause );
+        this.project = project;
+    }
+
+    LifecycleExecutionException( MojoExecution execution, MavenProject project, Throwable cause )
+    {
+        this( createMessage( execution, project, cause ), execution, project, cause );
+    }
+
+
+    private static String createMessage( MojoExecution execution, MavenProject project, Throwable cause )
+    {
+        StringBuilder buffer = new StringBuilder( 256 );
+
+        buffer.append( "Failed to execute goal" );
+
+        if ( execution != null )
+        {
+            buffer.append( ' ' );
+            buffer.append( execution.getGroupId() );
+            buffer.append( ':' );
+            buffer.append( execution.getArtifactId() );
+            buffer.append( ':' );
+            buffer.append( execution.getVersion() );
+            buffer.append( ':' );
+            buffer.append( execution.getGoal() );
+            buffer.append( " (" );
+            buffer.append( execution.getExecutionId() );
+            buffer.append( ")" );
+        }
+
+        if ( project != null )
+        {
+            buffer.append( " on project " );
+            buffer.append( project.getArtifactId() );
+        }
+
+        if ( cause != null )
+        {
+            buffer.append( ": " ).append( cause.getMessage() );
+        }
+
+        return buffer.toString();
+    }
+
