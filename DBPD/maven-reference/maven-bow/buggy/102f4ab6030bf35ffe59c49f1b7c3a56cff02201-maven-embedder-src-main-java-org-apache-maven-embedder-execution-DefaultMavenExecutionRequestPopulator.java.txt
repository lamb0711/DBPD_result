[MNG-4334] maven core caches settings.xml

o Last pass: proxies moved out of the components into the requests

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@810444 13f79535-47bb-0310-9956-ffa450edef68

-        Proxy activeProxy = settings.getActiveProxy();
-
-        if ( activeProxy != null )
-        {
-            if ( activeProxy.getHost() == null )
-            {
-                throw new MavenEmbedderException( "Proxy in settings.xml has no host" );
-            }
-
-            String password = decrypt( activeProxy.getPassword(), "password for proxy " + activeProxy.getId() );
-
-            repositorySystem.addProxy( activeProxy.getProtocol(), activeProxy.getHost(), activeProxy.getPort(),
-                                       activeProxy.getUsername(), password, activeProxy.getNonProxyHosts() );
-        }
-
+            if ( !proxy.isActive() )
+            {
+                continue;
+            }
+
+        repositorySystem.injectProxy( request.getRemoteRepositories(), request.getProxies() );
+        repositorySystem.injectProxy( request.getPluginArtifactRepositories(), request.getProxies() );
