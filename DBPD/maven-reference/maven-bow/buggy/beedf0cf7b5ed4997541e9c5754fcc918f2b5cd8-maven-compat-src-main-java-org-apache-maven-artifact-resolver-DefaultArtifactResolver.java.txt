o restore profile manager location so that the site plugin works ...                                                                                                                                                                                                         
o teach the resolution to understand when the root is local with a file present versus retrieving the root as well          


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@749924 13f79535-47bb-0310-9956-ffa450edef68

-            throw new MultipleArtifactsNotFoundException( request.getArtifact(), new ArrayList( result.getArtifacts() ), result.getMissingArtifacts(), request.getRemoteRepostories() );
+            throw new MultipleArtifactsNotFoundException( request.getArtifact(), result.getMissingArtifacts(), request.getRemoteRepostories() );
-        Artifact originatingArtifact = request.getArtifact();
+        Artifact rootArtifact = request.getArtifact();
-        if ( request.getArtifactDependencies() == null || request.getArtifactDependencies().size() == 0 )
-        {
-            ArtifactResolutionResult result = new ArtifactResolutionResult();
+        ArtifactResolutionResult result = new ArtifactResolutionResult();
+        // The root artifact may, or may not be resolved so we need to check before we attempt to resolve.
+        // This is often an artifact like a POM that is taken from disk and we already have hold of the
+        // file reference. But this may be a Maven Plugin that we need to resolve from a remote repository
+        // as well as its dependencies.
+        
+        if ( rootArtifact.getFile() == null )
+        {
-                resolve( request.getArtifact(), request.getRemoteRepostories(), request.getLocalRepository() );
-
-                result.addArtifact( request.getArtifact() );
+                resolve( rootArtifact, remoteRepositories, localRepository );
+                result.addArtifact( rootArtifact );
+                return result;
+                return result;
-
-            return result;
+        if ( artifacts == null || artifacts.size() == 0 )
+        {
+            return result;
+        } 
+        
-        ArtifactResolutionResult result = artifactCollector.collect( artifacts, originatingArtifact, managedVersions, localRepository, remoteRepositories, source, filter, listeners );
-
-        // Let's grab all the repositories that were gleaned. This we should know up front. I'm not sure
-        // what the metadata source is doing. Repositories in POMs are deadly.
-        result.setRepositories( remoteRepositories );
+        result = artifactCollector.collect( artifacts, rootArtifact, managedVersions, localRepository, remoteRepositories, source, filter, listeners );
