implement cycle detection

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@191819 13f79535-47bb-0310-9956-ffa450edef68

+    public ArtifactResolutionException( String message, String groupId, String artifactId, String version, String type,
+                                        List remoteRepositories, String downloadUrl )
+    {
+        super( constructMessage( message, groupId, artifactId, version, type, remoteRepositories, downloadUrl ) );
+
+        this.groupId = groupId;
+        this.artifactId = artifactId;
+        this.type = type;
+        this.version = version;
+        this.remoteRepositories = remoteRepositories;
+        this.downloadUrl = downloadUrl;
+    }
+
-        sb.append( LS );
-        sb.append( "from the specified remote repositories:" );
-        sb.append( LS + "  " );
-
-        for ( Iterator i = remoteRepositories.iterator(); i.hasNext(); )
+        if ( remoteRepositories != null && !remoteRepositories.isEmpty() )
-            ArtifactRepository remoteRepository = (ArtifactRepository) i.next();
+            sb.append( LS );
+            sb.append( "from the specified remote repositories:" );
+            sb.append( LS + "  " );
-            sb.append( remoteRepository.getUrl() );
-            if ( i.hasNext() )
+            for ( Iterator i = remoteRepositories.iterator(); i.hasNext(); )
-                sb.append( ", " );
+                ArtifactRepository remoteRepository = (ArtifactRepository) i.next();
+
+                sb.append( remoteRepository.getUrl() );
+                if ( i.hasNext() )
+                {
+                    sb.append( ", " );
+                }
+    public ArtifactResolutionException( String message, Artifact artifact )
+    {
+        this( message, artifact.getGroupId(), artifact.getArtifactId(), artifact.getVersion(), artifact.getType(), null,
+              artifact.getDownloadUrl() );
+    }
+
