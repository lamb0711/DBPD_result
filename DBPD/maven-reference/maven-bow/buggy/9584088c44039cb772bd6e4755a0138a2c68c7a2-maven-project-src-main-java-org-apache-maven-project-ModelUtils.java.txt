PR: MNG-1499
Submitted By: David Jackman
Reviewed By: John Casey

Applied. Thanks, David.

This patch makes the ordering of plugins deterministic after they are merged via inheritance or other mechanism.


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@345312 13f79535-47bb-0310-9956-ffa450edef68

+        
+        List mergedPlugins = new ArrayList();
-                    assembledPlugins.put( assembledPlugin.getKey(), assembledPlugin );
+                    mergedPlugins.add(assembledPlugin);
-                    assembledPlugins.put( childPlugin.getKey(), childPlugin );
+                    mergedPlugins.add(childPlugin);
-            childContainer.setPlugins( new ArrayList( assembledPlugins.values() ) );
+            childContainer.setPlugins(mergedPlugins);
+            List mergedExecutions = new ArrayList();
+            
+                    mergedExecutions.add(assembled);
-            for ( Iterator it = childExecutions.entrySet().iterator(); it.hasNext(); )
+            for ( Iterator it = child.getExecutions().iterator(); it.hasNext(); )
-                Map.Entry entry = (Map.Entry) it.next();
+                PluginExecution childExecution = (PluginExecution)it.next();
-                String id = (String) entry.getKey();
-
-                if ( !assembledExecutions.containsKey( id ) )
+                if ( !assembledExecutions.containsKey( childExecution.getId() ) )
-                    assembledExecutions.put( id, entry.getValue() );
+                    mergedExecutions.add(childExecution);
-            child.setExecutions( new ArrayList( assembledExecutions.values() ) );
+            child.setExecutions(mergedExecutions);
