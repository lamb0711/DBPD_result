[MNG-4925] Mismanagement of container lookup realm can cause type incompatibilities for plugins looking up components by string

git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@1042237 13f79535-47bb-0310-9956-ffa450edef68

-        ClassRealm oldLookupRealm = container.getLookupRealm();
+        ClassRealm oldLookupRealm = container.setLookupRealm( pluginRealm );
+
+        Thread.currentThread().setContextClassLoader( pluginRealm );
-            Thread.currentThread().setContextClassLoader( pluginRealm );
-
-            if ( oldLookupRealm != null )
-            {
-                container.setLookupRealm( null );
-            }
-
+            container.setLookupRealm( oldLookupRealm );
