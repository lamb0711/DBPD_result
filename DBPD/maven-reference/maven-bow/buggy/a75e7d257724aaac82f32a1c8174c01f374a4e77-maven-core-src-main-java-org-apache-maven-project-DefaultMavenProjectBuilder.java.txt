improved error handling and other clean up


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@163979 13f79535-47bb-0310-9956-ffa450edef68

+import org.codehaus.plexus.util.xml.pull.XmlPullParserException;
-        catch ( Exception e )
+        catch ( IOException e )
+        {
+            throw new ProjectBuildingException( "Cannot read settings.", e );
+        }
+        catch ( XmlPullParserException e )
-                throw new ProjectBuildingException( "Unable to find artifact: " + artifact.toString() );
+                throw new ProjectBuildingException( "Unable to find artifact: " + artifact.toString(), e );
-        try
-        {
-            project.setPluginArtifactRepositories( buildPluginRepositories( model.getPluginRepositories() ) );
-        }
-        catch ( Exception e )
-        {
-            throw new ProjectBuildingException( "Error building plugin repository list.", e );
-        }
+        project.setPluginArtifactRepositories( buildPluginRepositories( model.getPluginRepositories() ) );
-            try
-            {
-                project.setDistributionManagementArtifactRepository( buildDistributionManagementRepository(
-                    dm.getRepository() ) );
-            }
-            catch ( Exception e )
-            {
-                throw new ProjectBuildingException( "Error building distribution management repository.", e );
-            }
+            project.setDistributionManagementArtifactRepository( buildDistributionManagementRepository(
+                dm.getRepository() ) );
-            throw new ProjectBuildingException( "Could not find the model file '" + file.getAbsolutePath() + "'." );
+            throw new ProjectBuildingException( "Could not find the model file '" + file.getAbsolutePath() + "'.", e );
-        catch ( Exception e )
+        catch ( IOException e )
+        catch ( XmlPullParserException e )
+        {
+            throw new ProjectBuildingException(
+                "Error while parsing model from file '" + file.getAbsolutePath() + "'.", e );
+        }
+        InputStreamReader reader = null;
-            return modelReader.read( new InputStreamReader( url.openStream() ) );
+            reader = new InputStreamReader( url.openStream() );
+            return modelReader.read( reader );
-            throw new ProjectBuildingException( "Error while reading model.", e );
+            throw new ProjectBuildingException( "Error while building model from " + url.toExternalForm(), e );
-        catch ( Exception ex )
+        catch ( XmlPullParserException e )
-            throw new ProjectBuildingException( "Error while building model from " + url.toExternalForm(), ex );
+            throw new ProjectBuildingException( "Error while building model from " + url.toExternalForm(), e );
+        }
+        finally
+        {
+            IOUtil.close( reader );
