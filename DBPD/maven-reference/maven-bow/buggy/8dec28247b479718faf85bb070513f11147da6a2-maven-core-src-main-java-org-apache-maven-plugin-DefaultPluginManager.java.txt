PR: MNG-471

implemented cloned lifecycle, project and tests. update mojos accordingly


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@191476 13f79535-47bb-0310-9956-ffa450edef68

-            container.createChildContainer( pluginKey, files, Collections.EMPTY_MAP,
-                                            Collections.singletonList( this ) );
+            PlexusContainer child = container.createChildContainer( pluginKey, files, Collections.EMPTY_MAP,
+                                                                    Collections.singletonList( this ) );
-            // this plugin's descriptor should have been discovered by now, so we should be able to circle
-            // around and set the artifacts.
+            // this plugin's descriptor should have been discovered in the child creation, so we should be able to
+            // circle around and set the artifacts and class realm
+            addedPlugin.setClassRealm( child.getContainerRealm() );
+
+            if ( mojoExecution.getConfiguration() != null )
+            {
+                dom = Xpp3Dom.mergeXpp3Dom( dom, mojoExecution.getConfiguration() );
+            }
