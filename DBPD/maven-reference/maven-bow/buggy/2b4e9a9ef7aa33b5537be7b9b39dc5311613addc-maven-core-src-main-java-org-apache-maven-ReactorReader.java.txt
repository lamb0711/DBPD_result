MNG-5214: Dependency resolution substitutes g:a:v:jar for j:a:v:something-else when something-else isn't in the reacto

o When Aether asks the ReactorReader for a file for an artifact, remember to match type and classifier. And if all else
  fails, do not return target/classes if the desired artifact is not of type 'jar'. Arguably, if type or classifier
  are non-default, then we should never return those default paths at all.
o Add 'dir' format to make it quicker to run a quick test. If everyone hates this I'll revert it.


git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@1212564 13f79535-47bb-0310-9956-ffa450edef68

-        else if ( !hasBeenPackaged( project ) )
+        else if ( !hasBeenPackaged( project ) ) 
+            // and only for plain old jars. Not war files, not ear files, not anything else.
-                if ( project.hasLifecyclePhase( "compile" ) )
+                if ( project.hasLifecyclePhase( "compile" ) && artifact.getProperty( "type", "").equals( "jar" ) ) /* also reject non-"" classifier? */
-                if ( requestedRepositoryConflictId.equals( getConflictId( attachedArtifact ) ) )
+                if ( requestedArtifact.getProperty ( "type", "" ).equals( attachedArtifact.getType() )
+                     && classifierComparison ( requestedArtifact.getClassifier(), attachedArtifact.getClassifier() )                                
+                     && requestedRepositoryConflictId.equals( getConflictId( attachedArtifact ) ) )
+    
+    private boolean classifierComparison ( String c1, String c2 )
+    {
+        return c1 == null && c2 == null
+                        || ((c1 != null) && c1.equals(c2));
+    }
