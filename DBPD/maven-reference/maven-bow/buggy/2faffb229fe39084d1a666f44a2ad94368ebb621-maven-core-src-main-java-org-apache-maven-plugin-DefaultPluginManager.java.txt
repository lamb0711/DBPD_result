Fix resolving <plugin><dependencies>: it0081

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@497533 13f79535-47bb-0310-9956-ffa450edef68

-            componentRealm = container.createComponentRealm( plugin.getKey(), jars );
-
+            componentRealm = container.createComponentRealm( projectPlugin.getKey(), jars );
-            throw new PluginManagerException( "Failed to create realm for plugin '" + plugin + ".", e );
+            throw new PluginManagerException( "Failed to create realm for plugin '" + projectPlugin + ".", e );
-        PluginDescriptor pluginDescriptor = pluginCollector.getPluginDescriptor( plugin );
+        PluginDescriptor pluginDescriptor = pluginCollector.getPluginDescriptor( projectPlugin );
-                "The PluginDescriptor for the plugin " + plugin.getKey() + " was not found" );
+                "The PluginDescriptor for the plugin " + projectPlugin.getKey() + " was not found" );
-        throws InvalidPluginException, ArtifactNotFoundException, PluginManagerException, ArtifactResolutionException
+        throws InvalidPluginException, ArtifactNotFoundException, ArtifactResolutionException
-        Set artifacts;
+        Set projectPluginDependencies;
-            artifacts = MavenMetadataSource.createArtifacts( artifactFactory, plugin.getDependencies(), null,
+            projectPluginDependencies = MavenMetadataSource.createArtifacts( artifactFactory, plugin.getDependencies(), null,
+        // Also resolve the plugin dependencies specified in <plugin><dependencies>:
+        resolved.addAll( artifactResolver.resolveTransitively( projectPluginDependencies,
+                                                               pluginArtifact,
+                                                               localRepository,
+                                                               repositories,
+                                                               artifactMetadataSource,
+                                                               artifactFilter ).getArtifacts() );
+
