o restoring auth


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@794767 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.wagon.authentication.AuthenticationInfo;
+import org.apache.maven.wagon.proxy.ProxyInfo;
+    /**
+     * Deal with connecting to a wagon repository taking into account authentication and proxies.
+     * 
+     * @param wagon
+     * @param repository
+     * @throws ConnectionException
+     * @throws AuthenticationException
+     */
+    private void connectWagon( Wagon wagon, ArtifactRepository repository ) 
+        throws ConnectionException, AuthenticationException
+    {
+        if ( repository.getAuthentication() != null )
+        {
+            //
+            // We have authentication we have been asked to deal with.
+            //
+            AuthenticationInfo ai = new AuthenticationInfo();
+            ai.setUserName( repository.getAuthentication().getUserName() );
+            ai.setPassword( repository.getAuthentication().getPassword() );
+            
+            wagon.connect( new Repository( repository.getId(), repository.getUrl() ), ai );                    
+        }
+        else
+        {
+            wagon.connect( new Repository( repository.getId(), repository.getUrl() ) );                    
+        }
+        
+        //
+        // ProxyInfo proxyInfo = new ProxyInfo();
+        //        
+    }    
+    
-            wagon.connect( new Repository( repository.getId(), repository.getUrl() ) );
-
+            connectWagon( wagon, repository );
+            
-                wagon.connect( new Repository( repository.getId(), repository.getUrl() ) );
+                connectWagon( wagon, repository );
