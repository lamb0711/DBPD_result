o Restored backward-compat regarding the lenient handling of the type of remote repositories provided to the project builder (this code is limited to the compat level so doesn't pollute clients of the new APIs)

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@785389 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.ArrayList;
+import org.apache.maven.artifact.InvalidRepositoryException;
+import org.apache.maven.model.Repository;
+import org.apache.maven.repository.RepositorySystem;
+    @Requirement
+    private RepositorySystem repositorySystem;
+
+        normalizeToArtifactRepositories( configuration );
+
+    private void normalizeToArtifactRepositories( ProjectBuilderConfiguration configuration )
+        throws ProjectBuildingException
+    {
+        /*
+         * This provides backward-compat with 2.x that allowed plugins like the maven-remote-resources-plugin:1.0 to
+         * populate the builder configuration with model repositories instead of artifact repositories.
+         */
+
+        List<?> repositories = configuration.getRemoteRepositories();
+
+        if ( repositories != null )
+        {
+            boolean normalized = false;
+
+            List<ArtifactRepository> repos = new ArrayList<ArtifactRepository>( repositories.size() );
+
+            for ( Object repository : repositories )
+            {
+                if ( repository instanceof Repository )
+                {
+                    try
+                    {
+                        repos.add( repositorySystem.buildArtifactRepository( (Repository) repository ) );
+                    }
+                    catch ( InvalidRepositoryException e )
+                    {
+                        throw new ProjectBuildingException( "", "Invalid remote repository " + repository, e );
+                    }
+                    normalized = true;
+                }
+                else
+                {
+                    repos.add( (ArtifactRepository) repository );
+                }
+            }
+
+            if ( normalized )
+            {
+                configuration.setRemoteRepositories( repos );
+            }
+        }
+    }
+
