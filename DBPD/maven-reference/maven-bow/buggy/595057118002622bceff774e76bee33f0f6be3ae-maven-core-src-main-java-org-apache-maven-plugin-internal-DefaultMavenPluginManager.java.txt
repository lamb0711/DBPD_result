[MNG-4381] Allow extension plugins to contribute non-core components to be reused by other plugins

git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@819540 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.Arrays;
+import org.apache.maven.artifact.resolver.filter.AndArtifactFilter;
+        MavenProject project = session.getCurrentProject();
+
-        request.setRemoteRepositories( session.getCurrentProject().getPluginArtifactRepositories() );
+        request.setRemoteRepositories( project.getPluginArtifactRepositories() );
-        List<Artifact> pluginArtifacts = resolvePluginArtifacts( plugin, pluginArtifact, request );
+        List<Artifact> pluginArtifacts =
+            resolvePluginArtifacts( plugin, pluginArtifact, request, project.getExtensionArtifactFilter() );
-                                                   RepositoryRequest repositoryRequest )
+                                                     RepositoryRequest repositoryRequest,
+                                                     ArtifactFilter extensionArtifactFilter )
+        if ( extensionArtifactFilter != null )
+        {
+            resolutionFilter = new AndArtifactFilter( Arrays.asList( resolutionFilter, extensionArtifactFilter ) );
+        }
+
