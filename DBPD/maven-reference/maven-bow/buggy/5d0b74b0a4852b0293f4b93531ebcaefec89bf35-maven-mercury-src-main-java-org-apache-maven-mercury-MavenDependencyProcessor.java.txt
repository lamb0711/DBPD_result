Fixed pom profile activation issues. Added support for hooking up latest builder into Mercury.

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@759145 13f79535-47bb-0310-9956-ffa450edef68

-public final class MavenDependencyProcessor
+public class MavenDependencyProcessor
+	/**
+	 * Over-ride this method to change how dependencies are obtained
+	 */
-        List<InterpolatorProperty> interpolatorProperties = new ArrayList<InterpolatorProperty>();
-        interpolatorProperties.add( new InterpolatorProperty( "${mavenVersion}", "3.0-SNAPSHOT",
-                                                              PomInterpolatorTag.EXECUTION_PROPERTIES.name() ) );
-
-        if ( system != null )
-        {
-            interpolatorProperties.addAll(
-                InterpolatorProperty.toInterpolatorProperties( system, PomInterpolatorTag.EXECUTION_PROPERTIES.name() ) );
-        }
-        if ( user != null )
-        {
-            interpolatorProperties.addAll(
-                InterpolatorProperty.toInterpolatorProperties( user, PomInterpolatorTag.USER_PROPERTIES.name() ) );
-        }
+        List<InterpolatorProperty> interpolatorProperties = createInterpolatorProperties(system, user);
+    
+    protected final List<InterpolatorProperty> createInterpolatorProperties(Map system, Map user)
+    {
+        List<InterpolatorProperty> interpolatorProperties = new ArrayList<InterpolatorProperty>();
+        interpolatorProperties.add( new InterpolatorProperty( "${mavenVersion}", "3.0-SNAPSHOT",
+                                                              PomInterpolatorTag.EXECUTION_PROPERTIES.name() ) );
-    private static List<DomainModel> getParentsOfDomainModel( MavenDomainModel domainModel, MetadataReader mdReader )
+        if ( system != null )
+        {
+            interpolatorProperties.addAll(
+                InterpolatorProperty.toInterpolatorProperties( system, PomInterpolatorTag.EXECUTION_PROPERTIES.name() ) );
+        }
+        if ( user != null )
+        {
+            interpolatorProperties.addAll(
+                InterpolatorProperty.toInterpolatorProperties( user, PomInterpolatorTag.USER_PROPERTIES.name() ) );
+        }
+        return interpolatorProperties;
+    }
+
+    protected final List<DomainModel> getParentsOfDomainModel( MavenDomainModel domainModel, MetadataReader mdReader )
