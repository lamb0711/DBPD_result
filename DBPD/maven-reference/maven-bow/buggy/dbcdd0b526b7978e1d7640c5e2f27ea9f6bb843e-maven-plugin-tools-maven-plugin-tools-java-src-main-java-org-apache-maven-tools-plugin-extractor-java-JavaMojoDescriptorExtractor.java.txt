PR: MNG-471
add @execute phase|lifecycle doclet tag for java and beanshell
not sure how this would be configured for marmalade - will leave this for a once over of marmalade wrt the mojo api later


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@191385 13f79535-47bb-0310-9956-ffa450edef68

-    public static final String EXECUTE_PHASE = "executePhase";
+    public static final String EXECUTE = "execute";
-        DocletTag executePhase = findInClassHierarchy( javaClass, EXECUTE_PHASE );
-
-        if ( executePhase != null )
+        DocletTag oldExecutePhase = findInClassHierarchy( javaClass, "executePhase" );
+        if ( oldExecutePhase != null )
-            mojoDescriptor.setExecutePhase( executePhase.getValue() );
+            getLogger().warn( "DEPRECATED: @executePhase is deprecated, please use @execute" );
+            mojoDescriptor.setExecutePhase( oldExecutePhase.getValue() );
+        }
+
+        DocletTag execute = findInClassHierarchy( javaClass, EXECUTE );
+
+        if ( execute != null )
+        {
+            String executePhase = execute.getNamedParameter( "phase" );
+            if ( executePhase == null )
+            {
+                throw new InvalidPluginDescriptorException( "@execute tag requires a 'phase' parameter" );
+            }
+            mojoDescriptor.setExecutePhase( executePhase );
+
+            String lifecycle = execute.getNamedParameter( "lifecycle" );
+            if ( lifecycle != null )
+            {
+                mojoDescriptor.setExecuteLifecycle( lifecycle );
+            }
-        Map rawParams = new TreeMap();
-
-        extractFieldParameterTags( javaClass, rawParams );
+        Map rawParams = extractFieldParameterTags( javaClass );
-    private void extractFieldParameterTags( JavaClass javaClass, Map rawParams )
+    private Map extractFieldParameterTags( JavaClass javaClass )
+        Map rawParams;
+
-            extractFieldParameterTags( superClass, rawParams );
+            rawParams = extractFieldParameterTags( superClass );
+        }
+        else
+        {
+            rawParams = new TreeMap();
-
+        return rawParams;
-        File basedir = project.getBasedir();
-
