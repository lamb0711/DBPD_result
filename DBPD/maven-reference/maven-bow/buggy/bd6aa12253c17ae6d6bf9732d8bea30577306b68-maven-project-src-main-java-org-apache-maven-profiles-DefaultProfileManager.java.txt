(Merged from 384847.) [MNG-2136] Modifying <activeByDefault/> processing to only use profiles embedded in the POM as a basis for computing whether or not to activate.

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@384851 13f79535-47bb-0310-9956-ffa450edef68

-        List active = new ArrayList( profilesById.size() );
+        List activeFromPom = new ArrayList();
+        List activeExternal = new ArrayList();
+            boolean shouldAdd = false;
-                active.add( profile );
+                shouldAdd = true;
-                active.add( profile );
+                shouldAdd = true;
+            }
+            
+            if ( shouldAdd )
+            {
+                if ( "pom".equals( profile.getSource() ) )
+                {
+                    activeFromPom.add( profile );
+                }
+                else
+                {
+                    activeExternal.add( profile );
+                }
-        if ( active.isEmpty() )
+        if ( activeFromPom.isEmpty() )
-                active.add( profile );
+                activeFromPom.add( profile );
+        
+        List allActive = new ArrayList( activeFromPom.size() + activeExternal.size() );
+        
+        allActive.addAll( activeExternal );
+        allActive.addAll( activeFromPom );
-        return active;
+        return allActive;
