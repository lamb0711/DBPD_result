o Kept active external and POM profiles separate in model building result

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@784583 13f79535-47bb-0310-9956-ffa450edef68

+        result.setActiveExternalProfiles( activeExternalProfiles );
+
-            List<Profile> activeProjectProfiles =
-                getActiveProjectProfiles( rawModel, profileActivationContext, problems );
+            List<Profile> activePomProfiles = getActivePomProfiles( rawModel, profileActivationContext, problems );
-            List<Profile> activeProfiles = activeProjectProfiles;
-            if ( current == model )
-            {
-                activeProfiles = new ArrayList<Profile>( activeProjectProfiles.size() + activeExternalProfiles.size() );
-                activeProfiles.addAll( activeProjectProfiles );
-                activeProfiles.addAll( activeExternalProfiles );
-            }
+            result.setActivePomProfiles( rawModel, activePomProfiles );
-            for ( Profile activeProfile : activeProfiles )
+            for ( Profile activeProfile : activePomProfiles )
-            result.setActiveProfiles( rawModel, activeProfiles );
+            if ( current == model )
+            {
+                for ( Profile activeProfile : activeExternalProfiles )
+                {
+                    profileInjector.injectProfile( resultModel, activeProfile, request );
+                }
+            }
-    private List<Profile> getActiveProjectProfiles( Model model, ProfileActivationContext context,
-                                                    List<ModelProblem> problems )
+    private List<Profile> getActivePomProfiles( Model model, ProfileActivationContext context,
+                                                List<ModelProblem> problems )
