[MNG-4633] Fixed weave mode bug when building m3 itself in weave mode.

Updated testcase for MEP.

Also removed all unused/unecessar code from weave mode.

git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@934201 13f79535-47bb-0310-9956-ffa450edef68

-import java.util.Arrays;
-import java.util.List;
-
+import org.omg.CORBA.INITIALIZE;
+
+import java.util.Arrays;
+import java.util.HashMap;
+import java.util.Iterator;
+import java.util.List;
+import java.util.Map;
+
+import static org.apache.maven.lifecycle.internal.stub.LifecycleExecutionPlanCalculatorStub.*;
-        final Lifecycle lifecycle1 = new Lifecycle( "abc", Arrays.asList( "compile" ), null );
-        final Lifecycle lifecycle2 = new Lifecycle( "abc", Arrays.asList( "test" ), null );
-        final List<Lifecycle> lifeCycles = Arrays.asList( lifecycle1, lifecycle2 );
+
+        List<String> stubDefaultCycle =
+            Arrays.asList( VALIDATE.getPhase(), INITIALIZE.getPhase(), PROCESS_RESOURCES.getPhase(), COMPILE.getPhase(),
+                           TEST.getPhase(), PROCESS_TEST_RESOURCES.getPhase(), PACKAGE.getPhase(), "BEER",
+                           INSTALL.getPhase() );
+
+        // The two phases below are really for future expansion, some would say they lack a drink
+        // The point being that they do not really have to match the "real" stuff,
+        List<String> stubCleanCycle =
+            Arrays.asList( PRE_CLEAN.getPhase(), CLEAN.getPhase(), POST_CLEAN.getPhase() );
+
+        List<String> stubSiteCycle =
+            Arrays.asList( PRE_SITE.getPhase(), SITE.getPhase(), POST_SITE.getPhase(), SITE_DEPLOY.getPhase());
+
+        Iterator<List<String>> lcs = Arrays.asList( stubDefaultCycle, stubCleanCycle, stubSiteCycle ).iterator();
+
+        Map<String, Lifecycle> lifeCycles = new HashMap<String, Lifecycle>();
+        for ( String s : DefaultLifecycles.STANDARD_LIFECYCLES )
+        {
+            final Lifecycle lifecycle = new Lifecycle( s, lcs.next(), null );
+            lifeCycles.put( s, lifecycle );
+
+        }
-        final DefaultLifecycles defaultLifecycles = new DefaultLifecycles( lifeCycles, schedulingList );
-        return defaultLifecycles;
+        return new DefaultLifecycles( lifeCycles, schedulingList, new LoggerStub() );
