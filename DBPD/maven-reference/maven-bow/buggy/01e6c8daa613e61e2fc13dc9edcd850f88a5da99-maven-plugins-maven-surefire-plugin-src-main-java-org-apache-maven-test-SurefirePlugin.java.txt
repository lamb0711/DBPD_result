PR: MNG-257

refactor artifact creation to all go through the factory, and assign the type handler from there.
Attach EJB client to the EJB artifact so that it is installed/deployed along with it.



git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@191096 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.maven.artifact.DefaultArtifact;
+import org.apache.maven.artifact.Artifact;
-import org.apache.maven.artifact.repository.layout.ArtifactPathFormatException;
+    /**
+     * @parameter expression="${plugin.artifacts}"
+     */
+    private List pluginArtifacts;
+
-        // TODO: we should really just trust the plugin classloader?
-        try
+        for ( Iterator i = pluginArtifacts.iterator(); i.hasNext(); )
-            DefaultArtifact artifact = new DefaultArtifact( "junit", "junit", "3.8.1", "jar" );
-            File file = new File( localRepository.getBasedir(), localRepository.pathOf( artifact ) );
-            surefireBooter.addClassPathUrl( file.getAbsolutePath() );
-            artifact = new DefaultArtifact( "surefire", "surefire", "1.2", "jar" );
-            file = new File( localRepository.getBasedir(), localRepository.pathOf( artifact ) );
-            surefireBooter.addClassPathUrl( file.getAbsolutePath() );
-        }
-        catch ( ArtifactPathFormatException e )
-        {
-            throw new MojoExecutionException( "Error finding surefire JAR", e );
+            Artifact artifact = (Artifact) i.next();
+            surefireBooter.addClassPathUrl( artifact.getFile().getAbsolutePath() );
