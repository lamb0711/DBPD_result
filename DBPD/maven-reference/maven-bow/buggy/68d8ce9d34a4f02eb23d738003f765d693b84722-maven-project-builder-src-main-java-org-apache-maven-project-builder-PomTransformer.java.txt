MNG-3979.

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@736252 13f79535-47bb-0310-9956-ffa450edef68

-//       for(ModelProperty mp : props) {
-//           if(mp.getUri().startsWith(ProjectUri.Build.Plugins.Plugin.Executions.Execution.configuration)) {
-//               System.out.println(mp);
-//           }
-//       }
-        return factory.createDomainModel( props );
+        
+        //Cleanup props (MNG-3979)
+        List<ModelProperty> p = new ArrayList<ModelProperty>();
+        for(ModelProperty mp : props)
+        {
+            if(mp.getResolvedValue() != null
+                    && mp.getResolvedValue().trim().equals(""))
+            {
+                int index = props.indexOf(mp) + 1;
+
+                if(index <= props.size() && mp.isParentOf(props.get(index)) && !props.get(index).getUri().contains("#property"))
+                {
+                    p.add(new ModelProperty(mp.getUri(), null));
+                }
+                else
+                {
+                    p.add(mp);
+                }
+            }
+            else
+            {
+                p.add(mp);
+            }
+        }
+        return factory.createDomainModel( p );
