o Extended model builder to report the ids of the models from the lineage and used these ids as keys to pull infos from the building result

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@786838 13f79535-47bb-0310-9956-ffa450edef68

-public class DefaultModelBuildingResult
+class DefaultModelBuildingResult
-    private Model model;
+    private Model effectiveModel;
-    private List<Model> rawModels;
+    private List<String> modelIds;
-    private Map<Model, List<Profile>> activePomProfiles;
+    private Map<String, Model> rawModels;
+
+    private Map<String, List<Profile>> activePomProfiles;
-        rawModels = new ArrayList<Model>();
-        activePomProfiles = new HashMap<Model, List<Profile>>();
+        modelIds = new ArrayList<String>();
+        rawModels = new HashMap<String, Model>();
+        activePomProfiles = new HashMap<String, List<Profile>>();
-        return model;
+        return effectiveModel;
-        this.model = model;
+        this.effectiveModel = model;
+
+        return this;
+    }
+
+    public List<String> getModelIds()
+    {
+        return Collections.unmodifiableList( modelIds );
+    }
+
+    public DefaultModelBuildingResult addModelId( String modelId )
+    {
+        if ( modelId == null )
+        {
+            throw new IllegalArgumentException( "no model identifier specified" );
+        }
+
+        modelIds.add( modelId );
-        return rawModels.get( 0 );
+        return rawModels.get( modelIds.get( 0 ) );
-    public List<Model> getRawModels()
+    public Model getRawModel( String modelId )
-        return Collections.unmodifiableList( rawModels );
+        return rawModels.get( modelId );
-    public DefaultModelBuildingResult setRawModels( List<Model> rawModels )
+    public DefaultModelBuildingResult setRawModel( String modelId, Model rawModel )
-        this.rawModels.clear();
-        if ( rawModels != null )
+        if ( modelId == null )
-            this.rawModels.addAll( rawModels );
+            throw new IllegalArgumentException( "no model identifier specified" );
+        rawModels.put( modelId, rawModel );
+
-    public List<Profile> getActivePomProfiles( Model rawModel )
+    public List<Profile> getActivePomProfiles( String modelId )
-        List<Profile> profiles = this.activePomProfiles.get( rawModel );
-        return ( profiles == null ) ? Collections.<Profile> emptyList() : Collections.unmodifiableList( profiles );
+        List<Profile> profiles = this.activePomProfiles.get( modelId );
+        return ( profiles != null ) ? Collections.unmodifiableList( profiles ) : null;
-    public DefaultModelBuildingResult setActivePomProfiles( Model rawModel, List<Profile> activeProfiles )
+    public DefaultModelBuildingResult setActivePomProfiles( String modelId, List<Profile> activeProfiles )
-        if ( rawModel == null )
+        if ( modelId == null )
-            throw new IllegalArgumentException( "no model specified" );
+            throw new IllegalArgumentException( "no model identifier specified" );
-            this.activePomProfiles.put( rawModel, new ArrayList<Profile>( activeProfiles ) );
+            this.activePomProfiles.put( modelId, new ArrayList<Profile>( activeProfiles ) );
-            this.activePomProfiles.remove( rawModel );
+            this.activePomProfiles.remove( modelId );
-    public DefaultModelBuildingResult addActivePomProfiles( Model rawModel, List<Profile> activeProfiles )
-    {
-        if ( rawModel == null )
-        {
-            throw new IllegalArgumentException( "no model specified" );
-        }
-
-        List<Profile> currentProfiles = this.activePomProfiles.get( rawModel );
-        if ( currentProfiles == null )
-        {
-            currentProfiles = new ArrayList<Profile>( activeProfiles.size() );
-            this.activePomProfiles.put( rawModel, currentProfiles );
-        }
-        currentProfiles.addAll( activeProfiles );
-
-        return this;
-    }
-
+
