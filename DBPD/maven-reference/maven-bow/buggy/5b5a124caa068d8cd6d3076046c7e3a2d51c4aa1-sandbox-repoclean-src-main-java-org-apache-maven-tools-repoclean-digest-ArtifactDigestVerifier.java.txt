o Updated the repo layout classes to use direct string concatenation rather than StringUtils.replace() which is not useful because the layout is non-varying.
o Repoclean still not working with the new artifact/artifactmetadata stuff...the above modifications to the repo layout classes was primarily meant to improve performance when using repoclean.


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@163736 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.maven.artifact.Artifact;
-import org.apache.maven.artifact.repository.ArtifactRepository;
-import org.apache.maven.artifact.repository.layout.ArtifactPathFormatException;
-import org.apache.maven.tools.repoclean.report.Reporter;
-import org.codehaus.plexus.util.FileUtils;
-
-import java.io.File;
-import java.io.IOException;
-
+import org.apache.maven.artifact.Artifact;
+import org.apache.maven.tools.repoclean.report.Reporter;
+import org.codehaus.plexus.util.FileUtils;
+
+import java.io.File;
+import java.io.IOException;
+
-    public void verifyDigest( Artifact artifact, ArtifactRepository sourceRepo, ArtifactRepository targetRepo,
-                             Reporter reporter, boolean reportOnly ) throws Exception
+    public void verifyDigest( Artifact artifact, File artifactTarget, Reporter reporter, boolean reportOnly ) throws Exception
-        File sourceBase = new File( sourceRepo.getBasedir() );
-        File targetBase = new File( targetRepo.getBasedir() );
-
-        File digestSourceFile = null;
-        try
-        {
-            digestSourceFile = new File( sourceBase, sourceRepo.pathOf( artifact ) + ".md5" );
-        }
-        catch ( ArtifactPathFormatException e )
-        {
-            reporter.error( "Error creating java.io.File of digest source for artifact[" + artifact.getId() + "]", e );
-
-            throw e;
-        }
+        File digestSourceFile = new File( artifact.getFile() + ".md5" );
-        File digestTargetFile = null;
-        try
-        {
-            digestTargetFile = new File( targetBase, targetRepo.pathOf( artifact ) + ".md5" );
-        }
-        catch ( ArtifactPathFormatException e )
-        {
-            reporter.error( "Error creating java.io.File of digest target for artifact[" + artifact.getId() + "]", e );
-
-            throw e;
-        }
+        File digestTargetFile = new File( artifactTarget + ".md5" );
-        // create the artifact file in the target repo to use for generating a new digest.
-        File artifactTargetFile = null;
-        try
-        {
-            artifactTargetFile = new File( targetBase, targetRepo.pathOf( artifact ) );
-        }
-        catch ( ArtifactPathFormatException e )
-        {
-            reporter.error( "Error creating java.io.File for artifact[" + artifact.getId() + "]", e );
-
-            throw e;
-        }
-
-            verified = artifactDigestor.verifyArtifactDigest( artifactTargetFile, digestTargetFile,
+            verified = artifactDigestor.verifyArtifactDigest( artifactTarget, digestTargetFile,
-                artifactDigestor.createArtifactDigest( artifactTargetFile, digestTargetFile, ArtifactDigestor.MD5 );
+                artifactDigestor.createArtifactDigest( artifactTarget, digestTargetFile, ArtifactDigestor.MD5 );
