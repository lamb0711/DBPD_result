

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@497176 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.execution.MavenSession;
-    public String resolvePluginVersion( String groupId, String artifactId, MavenProject project, Settings settings,
-                                        ArtifactRepository localRepository )
+    public String resolvePluginVersion( String groupId,
+                                        String artifactId,
+                                        MavenProject project,
+                                        MavenSession session )
-        return resolvePluginVersion( groupId, artifactId, project, settings, localRepository, false );
+        return resolvePluginVersion( groupId, artifactId, project, session, false );
-    public String resolveReportPluginVersion( String groupId, String artifactId, MavenProject project,
-                                              Settings settings, ArtifactRepository localRepository )
+    public String resolveReportPluginVersion( String groupId,
+                                              String artifactId,
+                                              MavenProject project,
+                                              MavenSession session )
-        return resolvePluginVersion( groupId, artifactId, project, settings, localRepository, true );
+        return resolvePluginVersion( groupId, artifactId, project, session, true );
-    private String resolvePluginVersion( String groupId, String artifactId, MavenProject project, Settings settings,
-                                         ArtifactRepository localRepository, boolean resolveAsReportPlugin )
+    private String resolvePluginVersion( String groupId,
+                                         String artifactId,
+                                         MavenProject project,
+                                         MavenSession session,
+                                         boolean resolveAsReportPlugin )
+        Settings settings = session.getSettings();
+
+        ArtifactRepository localRepository = session.getLocalRepository();
+
-    private boolean shouldCheckForUpdates( String groupId, String artifactId )
+    private boolean shouldCheckForUpdates( String groupId,
+                                           String artifactId )
-    private boolean checkForRejectedStatus( String groupId, String artifactId, String version )
+    private boolean checkForRejectedStatus( String groupId,
+                                            String artifactId,
+                                            String version )
-    private boolean promptToPersistPluginUpdate( String version, String updatedVersion, String groupId,
-                                                 String artifactId, Settings settings )
+    private boolean promptToPersistPluginUpdate( String version,
+                                                 String updatedVersion,
+                                                 String groupId,
+                                                 String artifactId,
+                                                 Settings settings )
-    private void addNewVersionToRejectedListInExisting( String groupId, String artifactId, String rejectedVersion )
+    private void addNewVersionToRejectedListInExisting( String groupId,
+                                                        String artifactId,
+                                                        String rejectedVersion )
-    private String resolveExistingFromPluginRegistry( String groupId, String artifactId )
+    private String resolveExistingFromPluginRegistry( String groupId,
+                                                      String artifactId )
-    private org.apache.maven.plugin.registry.Plugin getPlugin( String groupId, String artifactId,
+    private org.apache.maven.plugin.registry.Plugin getPlugin( String groupId,
+                                                               String artifactId,
-    private String constructPluginKey( String groupId, String artifactId )
+    private String constructPluginKey( String groupId,
+                                       String artifactId )
-    private String getVersionFromPluginConfig( String groupId, String artifactId, MavenProject project,
+    private String getVersionFromPluginConfig( String groupId,
+                                               String artifactId,
+                                               MavenProject project,
-    private void updatePluginVersionInRegistry( String groupId, String artifactId, String version )
+    private void updatePluginVersionInRegistry( String groupId,
+                                                String artifactId,
+                                                String version )
-    private void writeUserRegistry( String groupId, String artifactId, PluginRegistry pluginRegistry )
+    private void writeUserRegistry( String groupId,
+                                    String artifactId,
+                                    PluginRegistry pluginRegistry )
-    private PluginRegistry getPluginRegistry( String groupId, String artifactId )
+    private PluginRegistry getPluginRegistry( String groupId,
+                                              String artifactId )
-    private String resolveMetaVersion( String groupId, String artifactId, MavenProject project,
-                                       ArtifactRepository localRepository, String metaVersionId )
+    private String resolveMetaVersion( String groupId,
+                                       String artifactId,
+                                       MavenProject project,
+                                       ArtifactRepository localRepository,
+                                       String metaVersionId )
