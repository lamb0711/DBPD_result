PR: MNG-456
allow separate snapshot and release repositories
deprecate existing snapshotPolicy and checksumPolicy in favour of updatePolicy and checksumPolicy within the <releases> and <snapshots> elements in the <repository> element.



git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@224707 13f79535-47bb-0310-9956-ffa450edef68

-    private String globalSnapshotPolicy = null;
+    private String globalUpdatePolicy;
-    private String globalChecksumPolicy = null;
+    private String globalChecksumPolicy;
+
+    private boolean globalEnable = true;
+
+    public ArtifactRepository createArtifactRepository( String id, String url,
+                                                        ArtifactRepositoryLayout repositoryLayout )
+    {
+        return new DefaultArtifactRepository( id, url, repositoryLayout );
+    }
-                                                        String snapshotPolicy, String checksumPolicy )
+                                                        ArtifactRepositoryPolicy snapshots,
+                                                        ArtifactRepositoryPolicy releases )
-        ArtifactRepository repo = null;
-
-        String snapPolicy = snapshotPolicy;
-
-        if ( globalSnapshotPolicy != null )
+        if ( snapshots == null )
-            snapPolicy = globalSnapshotPolicy;
+            snapshots = new ArtifactRepositoryPolicy();
-        if ( snapPolicy == null )
+        if ( releases == null )
-            snapPolicy = ArtifactRepository.SNAPSHOT_POLICY_NEVER;
+            releases = new ArtifactRepositoryPolicy();
-        String csumPolicy = checksumPolicy;
+        if ( globalUpdatePolicy != null )
+        {
+            snapshots.setUpdatePolicy( globalUpdatePolicy );
+            releases.setUpdatePolicy( globalUpdatePolicy );
+        }
-            csumPolicy = globalChecksumPolicy;
+            snapshots.setChecksumPolicy( globalChecksumPolicy );
+            releases.setChecksumPolicy( globalChecksumPolicy );
-        if ( csumPolicy == null )
+        // TODO: needed, or can offline cover it?
+        if ( !globalEnable )
-            csumPolicy = ArtifactRepository.CHECKSUM_POLICY_WARN;
+            snapshots.setEnabled( false );
+            releases.setEnabled( false );
-        repo = new DefaultArtifactRepository( id, url, repositoryLayout, snapPolicy, csumPolicy );
-
-        return repo;
+        return new DefaultArtifactRepository( id, url, repositoryLayout, snapshots, releases );
-    public void setGlobalSnapshotPolicy( String snapshotPolicy )
+    public void setGlobalUpdatePolicy( String updatePolicy )
-        this.globalSnapshotPolicy = snapshotPolicy;
+        this.globalUpdatePolicy = updatePolicy;
+
+    public void setGlobalEnable( boolean enable )
+    {
+        this.globalEnable = enable;
+    }
