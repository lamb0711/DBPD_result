[MNG-4320] [regression] Aggregators invoked from CLI no longer resolve dependencies for all reactor projects

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@807638 13f79535-47bb-0310-9956-ffa450edef68

-                repositoryRequest.setRemoteRepositories( currentProject.getRemoteArtifactRepositories() );
-                projectDependenciesResolver.resolve( currentProject, executionPlan.getRequiredResolutionScopes(),
-                                                     repositoryRequest );
+                List<MavenProject> projectsToResolve;
+
+                if ( projectBuild.taskSegment.aggregating )
+                {
+                    projectsToResolve = session.getProjects();
+                }
+                else
+                {
+                    projectsToResolve = Collections.singletonList( currentProject );
+                }
+
+                for ( MavenProject project : projectsToResolve )
+                {
+                    repositoryRequest.setRemoteRepositories( project.getRemoteArtifactRepositories() );
+                    projectDependenciesResolver.resolve( project, executionPlan.getRequiredResolutionScopes(),
+                                                         repositoryRequest );
+                }
