o Decoupled model building request from profile activation context

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@781144 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.model.profile.DefaultProfileActivationContext;
+import org.apache.maven.model.profile.ProfileActivationContext;
-        List<Profile> activeExternalProfiles = getActiveExternalProfiles( request );
+        ProfileActivationContext profileActivationContext = getProfileActivationContext( request );
+
+        List<Profile> activeExternalProfiles = getActiveExternalProfiles( request, profileActivationContext );
-            List<Profile> activeProjectProfiles = getActiveProjectProfiles( rawModel, request );
+            List<Profile> activeProjectProfiles = getActiveProjectProfiles( rawModel, profileActivationContext );
+    private ProfileActivationContext getProfileActivationContext( ModelBuildingRequest request )
+    {
+        ProfileActivationContext context = new DefaultProfileActivationContext();
+        context.setActiveProfileIds( request.getActiveProfileIds() );
+        context.setInactiveProfileIds( request.getInactiveProfileIds() );
+        context.setExecutionProperties( request.getExecutionProperties() );
+        return context;
+    }
+
-    private List<Profile> getActiveExternalProfiles( ModelBuildingRequest request )
+    private List<Profile> getActiveExternalProfiles( ModelBuildingRequest request, ProfileActivationContext context )
-            return profileSelector.getActiveProfiles( request.getProfiles(), request.getProfileActivationContext() );
+            return profileSelector.getActiveProfiles( request.getProfiles(), context );
-    private List<Profile> getActiveProjectProfiles( Model model, ModelBuildingRequest request )
+    private List<Profile> getActiveProjectProfiles( Model model, ProfileActivationContext context )
-            return profileSelector.getActiveProfiles( model.getProfiles(), request.getProfileActivationContext() );
+            return profileSelector.getActiveProfiles( model.getProfiles(), context );
