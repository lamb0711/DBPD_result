[MNG-4528] [regression] mvn deploy ignores proxy settings

git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@899004 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.artifact.resolver.filter.ExclusionSetFilter;
+        /*
+         * NOTE: This is a hack to support maven-deploy-plugin:[2.2.1,2.4] which has dependencies on old/buggy wagons.
+         * Under our class loader hierarchy those would take precedence over the wagons from the distro, causing grief
+         * due to their bugs (e.g. MNG-4528).
+         */
+        if ( "maven-deploy-plugin".equals( plugin.getArtifactId() )
+            && "org.apache.maven.plugins".equals( plugin.getGroupId() ) )
+        {
+            collectionFilter =
+                new AndArtifactFilter( Arrays.asList( collectionFilter,
+                                                      new ExclusionSetFilter( new String[] { "maven-core" } ) ) );
+        }
+
