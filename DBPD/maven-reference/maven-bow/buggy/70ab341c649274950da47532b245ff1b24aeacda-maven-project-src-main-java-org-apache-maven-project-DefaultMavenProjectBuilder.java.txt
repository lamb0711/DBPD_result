PR: MNG-1108
don't resolve a default POM for a parent or dependency of type POM

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@307047 13f79535-47bb-0310-9956-ffa450edef68

+        return buildFromRepository( artifact, remoteArtifactRepositories, localRepository, true );
+    }
+
+    public MavenProject buildFromRepository( Artifact artifact, List remoteArtifactRepositories,
+                                             ArtifactRepository localRepository, boolean allowStubModel )
+        throws ProjectBuildingException
+    {
-        Model model = findModelFromRepository( artifact, remoteArtifactRepositories, localRepository );
+        Model model = findModelFromRepository( artifact, remoteArtifactRepositories, localRepository, allowStubModel );
-                                           ArtifactRepository localRepository )
+                                           ArtifactRepository localRepository, boolean allowStubModel )
+                // TODO: how can this not be true?
-                else
+                else if ( allowStubModel )
+                else
+                {
+                    throw new ProjectBuildingException( "POM could not be resolved from the repository" );
+                }
-                model = createStubModel( projectArtifact );
+                if ( allowStubModel )
+                {
+                    model = createStubModel( projectArtifact );
+                }
+                else
+                {
+                    throw new ProjectBuildingException( "POM not found in repository", e );
+                }
-                model = findModelFromRepository( parentArtifact, remoteRepositories, localRepository );
+                model = findModelFromRepository( parentArtifact, remoteRepositories, localRepository, false );
