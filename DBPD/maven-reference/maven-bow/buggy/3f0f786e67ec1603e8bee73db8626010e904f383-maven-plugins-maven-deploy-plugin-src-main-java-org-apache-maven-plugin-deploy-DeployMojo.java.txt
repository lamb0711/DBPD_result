transform deployment of SNAPSHOT.
Currently, the POM and artifact are deployed separately, causing an inconsistent version to be written out.


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@163684 13f79535-47bb-0310-9956-ffa450edef68

- * @goal deploy
- *
- * @description deploys an artifact to remote repository
- *
- * @parameter
- *  name="project"
- *  type="org.apache.maven.project.MavenProject"
- *  required="true"
- *  validator=""
- *  expression="#project"
- *  description=""
- *
- * @parameter
- *  name="deployer"
- *  type="org.apache.maven.artifact.deployer.ArtifactDeployer"
- *  required="true"
- *  validator=""
- *  expression="#component.org.apache.maven.artifact.deployer.ArtifactDeployer"
- *  description=""
- *
- * @parameter
- *  name="deploymentRepository"
- *  type="org.apache.maven.artifact.repository.ArtifactRepository"
- *  required="true"
- *  validator=""
- *  expression="#project.distributionManagementArtifactRepository"
- *  description=""
- *
+ * @goal deploy
+ * @description deploys an artifact to remote repository
+ * @parameter name="project"
+ * type="org.apache.maven.project.MavenProject"
+ * required="true"
+ * validator=""
+ * expression="#project"
+ * description=""
+ * @parameter name="deployer"
+ * type="org.apache.maven.artifact.deployer.ArtifactDeployer"
+ * required="true"
+ * validator=""
+ * expression="#component.org.apache.maven.artifact.deployer.ArtifactDeployer"
+ * description=""
+ * @parameter name="deploymentRepository"
+ * type="org.apache.maven.artifact.repository.ArtifactRepository"
+ * required="true"
+ * validator=""
+ * expression="#project.distributionManagementArtifactRepository"
+ * description=""
+ * @parameter name="localRepository"
+ * type="org.apache.maven.artifact.repository.ArtifactRepository"
+ * required="true"
+ * validator=""
+ * expression="#localRepository"
+ * description=""
+    private ArtifactRepository localRepository;
+
-            String msg = "Deployment failed: repository element was not specified in the pom inside"
-                + " distributionManagement element";
+            String msg = "Deployment failed: repository element was not specified in the pom inside" +
+                " distributionManagement element";
-            getLog().warn(
-                           "Deployment repository {id: \'" + deploymentRepository.getId()
-                               + "\'} has no associated authentication info!" );
+            getLog().warn( "Deployment repository {id: \'" + deploymentRepository.getId() +
+                           "\'} has no associated authentication info!" );
-            deployer.deploy( pom, pomArtifact, deploymentRepository );
+            deployer.deploy( pom, pomArtifact, deploymentRepository, localRepository );
-                deployer.deploy( project.getBuild().getDirectory(), artifact, deploymentRepository );
+                deployer.deploy( project.getBuild().getDirectory(), artifact, deploymentRepository, localRepository );
