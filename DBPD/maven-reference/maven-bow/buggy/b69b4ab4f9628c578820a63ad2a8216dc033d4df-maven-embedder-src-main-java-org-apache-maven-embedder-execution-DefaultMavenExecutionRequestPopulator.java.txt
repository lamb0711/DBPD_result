o add default plugin artifact repositories in the populator


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@796817 13f79535-47bb-0310-9956-ffa450edef68

-        
+
-    
+
-        
+
-        
+
-        request.addActiveProfiles( settings.getActiveProfiles() );        
-        
+        request.addActiveProfiles( settings.getActiveProfiles() );
+
-                request.addProfile( SettingsUtils.convertFromSettingsProfile( rawProfile ) );                
+                request.addProfile( SettingsUtils.convertFromSettingsProfile( rawProfile ) );
-        
+
+        
+        injectDefaultPluginRepositories( request );        
-        {            
+        {
+    private void injectDefaultPluginRepositories( MavenExecutionRequest request )
+        throws MavenEmbedderException
+    {
+        Set<String> definedRepositories = new HashSet<String>();
+        if ( request.getPluginArtifactRepositories() != null )
+        {
+            for ( ArtifactRepository repository : request.getPluginArtifactRepositories() )
+            {
+                definedRepositories.add( repository.getId() );
+            }
+        }
+
+        if ( !definedRepositories.contains( RepositorySystem.DEFAULT_REMOTE_REPO_ID ) )
+        {
+            try
+            {
+                request.addPluginArtifactRepository( repositorySystem.createDefaultRemoteRepository() );
+            }
+            catch ( InvalidRepositoryException e )
+            {
+                throw new MavenEmbedderException( "Cannot create default remote repository.", e );
+            }
+        }
+    }
+
-        
+
-        
+
-                
+
