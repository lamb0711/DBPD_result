Removing maven-build-context, and replacing it with caching aspects for model-lineage stuff and project instances. Still needs caching for artifact resolution, and I have an aspect for this too, but it's not enabled yet, since it's still buggy.

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@595215 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.profiles.activation.DefaultProfileActivationContext;
+import org.apache.maven.profiles.activation.ProfileActivationContext;
-        if ( request.getPom() != null )
+        if ( ( request.getPom() != null ) && ( request.getPom().getParentFile() != null ) )
-            request.setBaseDirectory( request.getPom() );
+            request.setBaseDirectory( request.getPom().getParentFile() );
-        else if ( request.getBaseDirectory() != null )
+        else if ( ( request.getPom() == null ) && ( request.getBaseDirectory() != null ) )
+        // TODO: Is this correct?
+        else if ( request.getBaseDirectory() == null )
+        {
+            request.setBaseDirectory( new File( System.getProperty( "user.dir" ) ) );
+        }
-        ProfileManager globalProfileManager = new DefaultProfileManager( container );
+        ProfileActivationContext activationContext = new DefaultProfileActivationContext( request.getProperties(), false );
+        ProfileManager globalProfileManager = new DefaultProfileManager( container, activationContext );
