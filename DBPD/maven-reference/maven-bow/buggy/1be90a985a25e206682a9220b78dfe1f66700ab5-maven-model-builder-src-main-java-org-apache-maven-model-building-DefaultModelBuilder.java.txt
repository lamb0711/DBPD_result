[MNG-4825] Relative path errors could be more explicit


git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@998850 13f79535-47bb-0310-9956-ffa450edef68

+            StringBuilder buffer = new StringBuilder( 256 );
+            buffer.append( "'parent.relativePath'" );
+            if ( childModel != problems.getRootModel() )
+            {
+                buffer.append( " of POM " ).append( ModelProblemUtils.toSourceHint( childModel ) );
+            }
+            buffer.append( " points at " ).append( groupId ).append( ":" ).append( artifactId );
+            buffer.append( " instead of " ).append( parent.getGroupId() ).append( ":" ).append( parent.getArtifactId() );
+            buffer.append( ", please verify your project structure" );
+
-            problems.add( Severity.WARNING, "'parent.relativePath' of POM "
-                + ModelProblemUtils.toSourceHint( childModel ) + " points at " + groupId + ":" + artifactId
-                + " instead of " + parent.getGroupId() + ":" + parent.getArtifactId()
-                + ", please verify your project structure", childModel.getLocation( "parent" ), null );
+            problems.add( Severity.WARNING, buffer.toString(), parent.getLocation( "" ), null );
-            problems.add( Severity.FATAL, "Non-resolvable parent POM "
-                + ModelProblemUtils.toId( groupId, artifactId, version ) + " for "
-                + ModelProblemUtils.toId( childModel ) + ": " + e.getMessage(), childModel.getLocation( "parent" ), e );
+            StringBuilder buffer = new StringBuilder( 256 );
+            buffer.append( "Non-resolvable parent POM" );
+            if ( !containsCoordinates( e.getMessage(), groupId, artifactId, version ) )
+            {
+                buffer.append( " " ).append( ModelProblemUtils.toId( groupId, artifactId, version ) );
+            }
+            if ( childModel != problems.getRootModel() )
+            {
+                buffer.append( " for " ).append( ModelProblemUtils.toId( childModel ) );
+            }
+            buffer.append( ": " ).append( e.getMessage() );
+            buffer.append( " and 'parent.relativePath' points at wrong local POM" );
+
+            problems.add( Severity.FATAL, buffer.toString(), parent.getLocation( "" ), e );
-                    problems.add( Severity.ERROR, "Non-resolvable import POM "
-                        + ModelProblemUtils.toId( groupId, artifactId, version ) + ": " + e.getMessage(),
-                                  dependency.getLocation( "" ), e );
+                    StringBuilder buffer = new StringBuilder( 256 );
+                    buffer.append( "Non-resolvable import POM" );
+                    if ( !containsCoordinates( e.getMessage(), groupId, artifactId, version ) )
+                    {
+                        buffer.append( " " ).append( ModelProblemUtils.toId( groupId, artifactId, version ) );
+                    }
+                    buffer.append( ": " ).append( e.getMessage() );
+
+                    problems.add( Severity.ERROR, buffer.toString(), dependency.getLocation( "" ), e );
+    private boolean containsCoordinates( String message, String groupId, String artifactId, String version )
+    {
+        return message != null && message.contains( groupId ) && message.contains( artifactId )
+            && message.contains( version );
+    }
+
