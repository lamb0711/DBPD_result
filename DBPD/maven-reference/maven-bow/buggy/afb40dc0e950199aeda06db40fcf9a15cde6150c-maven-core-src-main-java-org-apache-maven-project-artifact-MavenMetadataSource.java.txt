[MNG-4379] Properties defined in parent POM and used in systemPath element cause POM validation warnings and dependencies ignoration - compilation error

git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@895245 13f79535-47bb-0310-9956-ffa450edef68

+import java.io.IOException;
+import java.util.Properties;
+import java.util.Map.Entry;
-import org.apache.maven.artifact.repository.RepositoryRequest;
+import org.codehaus.plexus.util.cli.CommandLineUtils;
-                    configuration.setSystemProperties( System.getProperties() );
+                    configuration.setSystemProperties( getSystemProperties() );
+    private Properties getSystemProperties()
+    {
+        Properties props = new Properties();
+
+        try
+        {
+            Properties envVars = CommandLineUtils.getSystemEnvVars();
+            for ( Entry<Object, Object> e : envVars.entrySet() )
+            {
+                props.setProperty( "env." + e.getKey().toString(), e.getValue().toString() );
+            }
+        }
+        catch ( IOException e )
+        {
+            logger.debug( "Error getting environment variables: " + e );
+        }
+
+        props.putAll( System.getProperties() );
+
+        return props;
+    }
+
