reduce the code duplication of the injection


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@168052 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.project.injection.ModelDefaultsInjector;
+    private ModelDefaultsInjector modelDefaultsInjector;
+
+        // TODO: shouldn't have to call all the time
+        modelDefaultsInjector.injectDefaults( project.getModel() );
+
+        // TODO: remove - should discover the version
+        plugin = findPlugin( project.getPlugins(), groupId, artifactId );
-            while ( project != null )
-            {
-                PluginManagement pluginManagement = project.getPluginManagement();
-
-                if ( pluginManagement != null )
-                {
-                    Plugin management = findPlugin( pluginManagement.getPlugins(), groupId, artifactId );
-                    if ( management != null && management.getVersion() != null )
-                    {
-                        plugin.setVersion( management.getVersion() );
-                        break;
-                    }
-                }
-                project = project.getParent();
-            }
-
-            if ( plugin.getVersion() == null )
-            {
-                // TODO: this has probably supplanted the default in the plugin manager
-                plugin.setVersion( PluginDescriptor.getDefaultPluginVersion() );
-            }
+            plugin.setVersion( PluginDescriptor.getDefaultPluginVersion() );
-
