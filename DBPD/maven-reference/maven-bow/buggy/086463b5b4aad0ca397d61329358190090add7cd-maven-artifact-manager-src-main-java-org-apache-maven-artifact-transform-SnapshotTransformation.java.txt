PR: MNG-456
allow separate snapshot and release repositories
deprecate existing snapshotPolicy and checksumPolicy in favour of updatePolicy and checksumPolicy within the <releases> and <snapshots> elements in the <repository> element.



git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@224707 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.artifact.repository.ArtifactRepositoryPolicy;
-import java.util.regex.Matcher;
-    public static final String SNAPSHOT_VERSION = "SNAPSHOT";
-
-        Matcher m = SnapshotArtifactMetadata.VERSION_FILE_PATTERN.matcher( artifact.getBaseVersion() );
-        if ( m.matches() )
-        {
-            // This corrects the base version, but ensure it is not resolved again
-            artifact.setBaseVersion( m.group( 1 ) + "-" + SNAPSHOT_VERSION );
-        }
-        else if ( isSnapshot( artifact ) )
+        if ( artifact.isSnapshot() )
-        Matcher m = SnapshotArtifactMetadata.VERSION_FILE_PATTERN.matcher( artifact.getBaseVersion() );
-        if ( m.matches() )
-        {
-            artifact.setBaseVersion( m.group( 1 ) + "-" + SNAPSHOT_VERSION );
-        }
-        else if ( isSnapshot( artifact ) )
+        if ( artifact.isSnapshot() )
-        Matcher m = SnapshotArtifactMetadata.VERSION_FILE_PATTERN.matcher( artifact.getBaseVersion() );
-        if ( m.matches() )
-        {
-            // This corrects the base version, but ensure it is not updated again
-            artifact.setBaseVersion( m.group( 1 ) + "-" + SNAPSHOT_VERSION );
-        }
-        else if ( isSnapshot( artifact ) )
+        if ( artifact.isSnapshot() )
-                metadata = (SnapshotArtifactMetadata) retrieveFromRemoteRepository( artifact, remoteRepository, null );
+                metadata = (SnapshotArtifactMetadata) retrieveFromRemoteRepository( artifact, remoteRepository, null,
+                                                                                    ArtifactRepositoryPolicy.UPDATE_POLICY_ALWAYS );
-    private static boolean isSnapshot( Artifact artifact )
-    {
-        return artifact.getVersion().endsWith( SNAPSHOT_VERSION );
-    }
-
