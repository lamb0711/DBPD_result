Correcting core-library resolution

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@225208 13f79535-47bb-0310-9956-ffa450edef68

-                resolveCoreArtifacts( unresolved );
+                resolveCoreArtifacts( unresolved, project.getRemoteArtifactRepositories(), localRepository );
-    private void resolveCoreArtifacts( List unresolved )
-        throws PluginConfigurationException
+    private void resolveCoreArtifacts( List unresolved, List remoteRepositories, ArtifactRepository localRepository )
+        throws ArtifactResolutionException
-                    throw new PluginConfigurationException( "Cannot resolve core artifact: " + artifact.getId() );
+                    artifactResolver.resolve( artifact, unresolved, localRepository );
+                    
+                    artifactFile = artifact.getFile();
+                else
+                {
+                    String artifactPath = resourceUrl.getPath();
-                String artifactPath = resourceUrl.getPath();
+                    artifactPath = artifactPath.substring( 0, artifactPath.length() - resource.length() );
+                    
+                    if ( artifactPath.endsWith( "/" ) )
+                    {
+                        artifactPath = artifactPath.substring( 0, artifactPath.length() - 1 );
+                    }
-                artifactPath = artifactPath.substring( 0, artifactPath.length() - resource.length() );
+                    if ( artifactPath.endsWith( "!" ) )
+                    {
+                        artifactPath = artifactPath.substring( 0, artifactPath.length() - 1 );
+                    }
-                artifactFile = new File( artifactPath );
+                    artifactFile = new File( artifactPath ).getAbsoluteFile();
+                }
