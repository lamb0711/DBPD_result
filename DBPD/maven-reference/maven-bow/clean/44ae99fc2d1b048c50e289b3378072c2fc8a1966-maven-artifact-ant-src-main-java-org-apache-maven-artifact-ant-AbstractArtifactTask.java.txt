Merge maven.new for latest plexus classworlds and container APIs

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@483302 13f79535-47bb-0310-9956-ffa450edef68

-import org.codehaus.classworlds.ClassWorld;
-import org.codehaus.classworlds.DuplicateRealmException;
+import org.codehaus.plexus.classworlds.ClassWorld;
+import org.codehaus.plexus.classworlds.realm.DuplicateRealmException;
+import org.codehaus.plexus.PlexusContainer;
+import org.codehaus.plexus.DefaultPlexusContainer;
-import org.codehaus.plexus.embed.Embedder;
-    private Embedder embedder;
+    private PlexusContainer container;
-                getEmbedder().release( repositoryFactory );
+                getContainer().release( repositoryFactory );
-            return getEmbedder().lookup( role );
+            return getContainer().lookup( role );
-            return getEmbedder().lookup( role, roleHint );
+            return getContainer().lookup( role, roleHint );
-    protected synchronized Embedder getEmbedder()
+    protected synchronized PlexusContainer getContainer()
-        if ( embedder == null )
+        if ( container == null )
-            embedder = (Embedder) getProject().getReference( Embedder.class.getName() );
+            container = (PlexusContainer) getProject().getReference( PlexusContainer.class.getName() );
-            if ( embedder == null )
+            if ( container == null )
-                embedder = new Embedder();
-
-                    embedder.start( classWorld );
+                    container = new DefaultPlexusContainer( null, null, null, classWorld );
+
-                getProject().addReference( Embedder.class.getName(), embedder );
+                getProject().addReference( PlexusContainer.class.getName(),container );
-        return embedder;
+
+        return container;
-            ErrorDiagnostics diagnostics = (ErrorDiagnostics) embedder.lookup( ErrorDiagnostics.ROLE );
+            ErrorDiagnostics diagnostics = (ErrorDiagnostics) container.lookup( ErrorDiagnostics.ROLE );
