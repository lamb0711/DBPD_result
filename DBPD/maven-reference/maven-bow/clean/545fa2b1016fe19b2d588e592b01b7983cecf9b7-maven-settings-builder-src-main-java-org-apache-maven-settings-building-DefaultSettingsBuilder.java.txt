o Introduced SettingsSource to enable non-file based content providers

git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@1029127 13f79535-47bb-0310-9956-ffa450edef68

-        Settings globalSettings = readSettings( request.getGlobalSettingsFile(), request, problems );
+        SettingsSource globalSettingsSource =
+            getSettingsSource( request.getGlobalSettingsFile(), request.getGlobalSettingsSource() );
+        Settings globalSettings = readSettings( globalSettingsSource, request, problems );
-        Settings userSettings = readSettings( request.getUserSettingsFile(), request, problems );
+        SettingsSource userSettingsSource =
+            getSettingsSource( request.getUserSettingsFile(), request.getUserSettingsSource() );
+        Settings userSettings = readSettings( userSettingsSource, request, problems );
-    private Settings readSettings( File settingsFile, SettingsBuildingRequest request,
+    private SettingsSource getSettingsSource( File settingsFile, SettingsSource settingsSource )
+    {
+        if ( settingsSource != null )
+        {
+            return settingsSource;
+        }
+        else if ( settingsFile != null && settingsFile.exists() )
+        {
+            return new FileSettingsSource( settingsFile );
+        }
+        return null;
+    }
+
+    private Settings readSettings( SettingsSource settingsSource, SettingsBuildingRequest request,
-        if ( settingsFile == null || !settingsFile.exists() )
+        if ( settingsSource == null )
-        problems.setSource( settingsFile.getAbsolutePath() );
+        problems.setSource( settingsSource.getLocation() );
-                settings = settingsReader.read( settingsFile, options );
+                settings = settingsReader.read( settingsSource.getInputStream(), options );
-                settings = settingsReader.read( settingsFile, options );
+                settings = settingsReader.read( settingsSource.getInputStream(), options );
-            problems.add( SettingsProblem.Severity.FATAL, "Non-parseable settings " + settingsFile + ": "
+            problems.add( SettingsProblem.Severity.FATAL, "Non-parseable settings " + settingsSource.getLocation() + ": "
-            problems.add( SettingsProblem.Severity.FATAL, "Non-readable settings " + settingsFile + ": "
+            problems.add( SettingsProblem.Severity.FATAL, "Non-readable settings " + settingsSource.getLocation() + ": "
