PR: MNG-249
also recognise transitive projects



git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@225780 13f79535-47bb-0310-9956-ffa450edef68

+    private Map projectCache = new HashMap();
+
-            project.setDependencyArtifacts( project.createArtifacts( artifactFactory ) );
+            project.setDependencyArtifacts( project.createArtifacts( artifactFactory, null, null ) );
+        String cacheKey = createCacheKey( artifact.getGroupId(), artifact.getArtifactId(), artifact.getVersion() );
+        MavenProject project = (MavenProject) projectCache.get( cacheKey );
+        if ( project != null )
+        {
+            return project;
+        }
+
+        projectCache.put( createCacheKey( project.getGroupId(), project.getArtifactId(), project.getVersion() ),
+                          project );
-                Artifact artifact = null;
+                Artifact artifact;
-                    artifact = artifactFactory.createPluginArtifact( p.getGroupId(), p.getArtifactId(), VersionRange
-                        .createFromVersionSpec( version ) );
+                    artifact = artifactFactory.createPluginArtifact( p.getGroupId(), p.getArtifactId(),
+                                                                     VersionRange.createFromVersionSpec( version ) );
