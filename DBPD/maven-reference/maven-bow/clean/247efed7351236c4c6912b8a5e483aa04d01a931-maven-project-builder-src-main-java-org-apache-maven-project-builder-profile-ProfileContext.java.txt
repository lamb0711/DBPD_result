[MNG-3885] [MNG-4009] : Fixed problem of profile info in parents not being applied.

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@741282 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.maven.shared.model.ModelContainer;
-import org.apache.maven.shared.model.ModelDataSource;
-import org.apache.maven.shared.model.DataSourceException;
-import org.apache.maven.shared.model.InterpolatorProperty;
+import org.apache.maven.shared.model.*;
+    private Collection<String> activeProfileIds;
+
-    public ProfileContext(ModelDataSource modelDataSource, List<InterpolatorProperty> properties) {
+    public ProfileContext(ModelDataSource modelDataSource, Collection<String> activeProfileIds,
+                          List<InterpolatorProperty> properties) {
+        this.activeProfileIds = (activeProfileIds != null) ? activeProfileIds : new ArrayList<String>();
+                    continue;
+
+            String profileId = getProfileId(mc.getProperties());
+            if(profileId != null && activeProfileIds.contains(profileId))
+            {
+                matchedContainers.add(mc);
+            }
+
+    private String getProfileId(List<ModelProperty> modelProperties)
+    {
+        for(ModelProperty mp : modelProperties)
+        {
+            if(mp.getUri().equals(ProfileUri.Profiles.Profile.id))
+            {
+                return mp.getResolvedValue();
+            }
+        }
+        return null;
+    }
