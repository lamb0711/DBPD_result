[MNG-6300] Multi module release creates empty directories in war file instead of jars

+import java.io.File;
+
-import org.apache.maven.plugin.ProjectArtifactsCache;
+import org.apache.maven.project.artifact.ProjectArtifactsCache;
-            Set<Artifact> artifacts;
+            Set<Artifact> resolvedArtifacts;
-                artifacts = recordArtifacts.artifacts;
+                resolvedArtifacts = recordArtifacts.artifacts;
-                    artifacts = getDependencies( project, scopesToCollect, scopesToResolve, session, aggregating, 
-                        projectArtifacts );
-                    recordArtifacts = projectArtifactsCache.put( cacheKey, artifacts );
+                    resolvedArtifacts = getDependencies( project, scopesToCollect, scopesToResolve, session,
+                                                         aggregating, projectArtifacts );
+                    recordArtifacts = projectArtifactsCache.put( cacheKey, resolvedArtifacts );
-            project.setResolvedArtifacts( artifacts );
+            Map<Artifact, File> reactorProjects = new HashMap<>( session.getProjects().size() );
+            for ( MavenProject reactorProject : session.getProjects() )
+            {
+                reactorProjects.put( reactorProject.getArtifact(), reactorProject.getArtifact().getFile() );
+            }
-            for ( Artifact artifact : artifacts )
+            for ( Artifact artifact : resolvedArtifacts )
+                /**
+                 * MNG-6300: resolvedArtifacts can be cache result; this ensures reactor files are always up to date 
+                 * During lifecycle the Artifact.getFile() can change from target/classes to the actual jar.
+                 * This clearly shows that target/classes should not be abused as artifactFile just for the classpath
+                 */
+                File reactorProjectFile = reactorProjects.get( artifact );
+                if ( reactorProjectFile != null )
+                {
+                    artifact.setFile( reactorProjectFile );
+                }
+
+            
+            project.setResolvedArtifacts( resolvedArtifacts );
+            
