PR: MNG-616
improve version logging, use artifact.toString for textual logging

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@307309 13f79535-47bb-0310-9956-ffa450edef68

-                        previous.getArtifact().setVersionRange( previousRange.restrict( currentRange ) );
+                        VersionRange newRange = previousRange.restrict( currentRange );
+                        // TODO: ick. this forces the OCE that should have come from the previous call. It is still correct
+                        if ( newRange.isSelectedVersionKnown( previous.getArtifact() ) )
+                        {
+                            fireEvent( ResolutionListener.RESTRICT_RANGE, listeners, node, previous.getArtifact(),
+                                       newRange );
+                        }
+                        previous.getArtifact().setVersionRange( newRange );
+        fireEvent( event, listeners, node, replacement, null );
+    }
+
+    private void fireEvent( int event, List listeners, ResolutionNode node, Artifact replacement,
+                            VersionRange newRange )
+    {
-                    listener.omitForNearer( node.getArtifact(), replacement );
+                    String version = node.getArtifact().getVersion();
+                    String replacementVersion = replacement.getVersion();
+                    if ( version != null ? !version.equals( replacementVersion ) : replacementVersion != null )
+                    {
+                        listener.omitForNearer( node.getArtifact(), replacement );
+                    }
+                case ResolutionListener.RESTRICT_RANGE:
+                    if ( node.getArtifact().getVersionRange().hasRestrictions() ||
+                        replacement.getVersionRange().hasRestrictions() )
+                    {
+                        listener.restrictRange( node.getArtifact(), replacement, newRange );
+                    }
+                    break;
