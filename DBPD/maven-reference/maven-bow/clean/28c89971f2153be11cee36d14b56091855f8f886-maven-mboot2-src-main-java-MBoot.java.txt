clean before build


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@162992 13f79535-47bb-0310-9956-ffa450edef68

-    private static final String CLASSES = "target/classes";
-
-    private static final String TEST_CLASSES = "target/test-classes";
-
-    private static final String GENERATED_SOURCES = "target/generated-sources";
+    private static final String CLASSES = BUILD_DIR + "/classes";
+
+    private static final String TEST_CLASSES = BUILD_DIR + "/test-classes";
+
+    private static final String GENERATED_SOURCES = BUILD_DIR + "/generated-sources";
-        String buildDir = new File( basedir, BUILD_DIR ).getAbsolutePath();
+        File buildDirFile = new File( basedir, BUILD_DIR );
+        String buildDir = buildDirFile.getAbsolutePath();
+
+        // clean
+        System.out.println( "Cleaning " + buildDirFile + "..." );
+        FileUtils.forceDelete( buildDirFile );
-            File generatedSourcesDirectory = new File( basedir, "target/generated-sources" );
+            File generatedSourcesDirectory = new File( basedir, GENERATED_SOURCES );
-            generateSources( model.getAbsolutePath(), "java", generatedSourcesDirectory.getAbsolutePath(), "4.0.0", "false" );
+            generateSources( model.getAbsolutePath(), "java", generatedSources, "4.0.0", "false" );
-            generateSources( model.getAbsolutePath(), "java", generatedSourcesDirectory.getAbsolutePath(), "3.0.0", "true" );
+            generateSources( model.getAbsolutePath(), "java", generatedSources, "3.0.0", "true" );
-            generateSources( model.getAbsolutePath(), "xpp3", generatedSourcesDirectory.getAbsolutePath(), "4.0.0", "false" );
+            generateSources( model.getAbsolutePath(), "xpp3", generatedSources, "4.0.0", "false" );
-            generateSources( model.getAbsolutePath(), "xpp3", generatedSourcesDirectory.getAbsolutePath(), "3.0.0", "true" );
+            generateSources( model.getAbsolutePath(), "xpp3", generatedSources, "3.0.0", "true" );
-        compile( testDependencies, testSources, testClasses, basedir + "/target/classes", null );
+        compile( testDependencies, testSources, testClasses, classes, null );
