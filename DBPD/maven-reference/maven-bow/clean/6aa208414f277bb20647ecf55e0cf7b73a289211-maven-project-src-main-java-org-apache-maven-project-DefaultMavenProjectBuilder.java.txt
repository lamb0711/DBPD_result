PR: MNG-229
 - always use super POM's repository for parent resolution
- use correct repository set for plugin dependency resolution

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@220102 13f79535-47bb-0310-9956-ffa450edef68

-        List aggregatedRemoteWagonRepositories;
-        if ( remoteArtifactRepositories == null || remoteArtifactRepositories.isEmpty() )
+        Set aggregatedRemoteWagonRepositories = new HashSet();
+        if ( remoteArtifactRepositories != null && !remoteArtifactRepositories.isEmpty() )
-            aggregatedRemoteWagonRepositories = ProjectUtils.buildArtifactRepositories( superModel.getRepositories(),
-                                                                                        artifactRepositoryFactory,
-                                                                                        container );
+            aggregatedRemoteWagonRepositories.addAll( remoteArtifactRepositories );
-        else
-        {
-            aggregatedRemoteWagonRepositories = new ArrayList( remoteArtifactRepositories );
-        }
+
+        aggregatedRemoteWagonRepositories.addAll( ProjectUtils.buildArtifactRepositories( superModel.getRepositories(),
+                                                                                          artifactRepositoryFactory,
+                                                                                          container ) );
-                if ( !aggregatedRemoteWagonRepositories.contains( artifactRepo ) )
-                {
-                    aggregatedRemoteWagonRepositories.add( artifactRepo );
-                }
+                aggregatedRemoteWagonRepositories.add( artifactRepo );
-        MavenProject project = assembleLineage( model, lineage, aggregatedRemoteWagonRepositories, localRepository );
+        List repositories = new ArrayList( aggregatedRemoteWagonRepositories );
+
+        MavenProject project = assembleLineage( model, lineage, repositories, localRepository );
-            project = processProjectLogic( pomLocation, project, aggregatedRemoteWagonRepositories, externalProfiles );
+            project = processProjectLogic( pomLocation, project, repositories, externalProfiles );
