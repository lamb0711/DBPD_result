load repositories from user configuration before trying to find the POMs there


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@162987 13f79535-47bb-0310-9956-ffa450edef68

+     *  @todo the user model bit overwriting the super model seems a bit gross, but is needed so that any repositories given take affect
+            Model userModel = null;
+            // TODO: use maven.home.local instead of user.home/.m2
+            File userModelFile = new File( System.getProperty( "user.home" ) + "/.m2", "pom.xml" );
+            if ( userModelFile.exists() )
+            {
+                userModel = modelReader.read( new FileReader( userModelFile ) );
+                if ( userModel.getParent() != null )
+                {
+                    throw new ProjectBuildingException( "Inheritence not supported in the user override POM" );
+                }
+
+                superModel.getRepositories().addAll( userModel.getRepositories() );
+            }
+
-            // TODO: use maven.home.local instead of user.home/.m2
-            File userModelFile = new File( System.getProperty( "user.home" ) + "/.m2", "pom.xml" );
-            if ( userModelFile.exists() )
+            if ( userModelFile != null )
-                Model userModel = modelReader.read( new FileReader( userModelFile ) );
-                if ( userModel.getParent() != null )
-                {
-                    throw new ProjectBuildingException( "Inheritence not supported in the user override POM" );
-                }
-
