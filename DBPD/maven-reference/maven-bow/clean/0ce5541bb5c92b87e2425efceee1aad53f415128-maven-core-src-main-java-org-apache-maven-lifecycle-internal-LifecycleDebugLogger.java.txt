[MNG-4795] [regression] Dependencies in forked reactor projects are not resolved when aggregator bound to lifecycle forks

git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@996206 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.plugin.descriptor.MojoDescriptor;
+import org.codehaus.plexus.util.StringUtils;
+import java.util.Set;
+import java.util.TreeSet;
+
+        if ( !logger.isDebugEnabled() )
+        {
+            return;
+        }
+
-        logger.debug( "Dependencies (collect): " + executionPlan.getRequiredCollectionScopes() );
-        logger.debug( "Dependencies (resolve): " + executionPlan.getRequiredResolutionScopes() );
+
+        debugDependencyRequirements( executionPlan.getMojoExecutions() );
+                debugDependencyRequirements( fork.getValue() );
+
+    private void debugDependencyRequirements( List<MojoExecution> mojoExecutions )
+    {
+        Set<String> scopesToCollect = new TreeSet<String>();
+        Set<String> scopesToResolve = new TreeSet<String>();
+
+        for ( MojoExecution mojoExecution : mojoExecutions )
+        {
+            MojoDescriptor mojoDescriptor = mojoExecution.getMojoDescriptor();
+
+            String scopeToCollect = mojoDescriptor.getDependencyCollectionRequired();
+            if ( StringUtils.isNotEmpty( scopeToCollect ) )
+            {
+                scopesToCollect.add( scopeToCollect );
+            }
+
+            String scopeToResolve = mojoDescriptor.getDependencyResolutionRequired();
+            if ( StringUtils.isNotEmpty( scopeToResolve ) )
+            {
+                scopesToResolve.add( scopeToResolve );
+            }
+        }
+
+        logger.debug( "Dependencies (collect): " + scopesToCollect );
+        logger.debug( "Dependencies (resolve): " + scopesToResolve );
+    }
+
