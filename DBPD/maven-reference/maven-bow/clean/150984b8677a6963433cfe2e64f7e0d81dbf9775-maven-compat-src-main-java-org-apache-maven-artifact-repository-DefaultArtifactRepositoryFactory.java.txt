[MNG-4991] LegacyRepositorySystem#injectProxy(repositories, proxies) doesn't evaluate non-proxy hosts


git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@1073990 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.maven.execution.MavenExecutionRequest;
-import org.apache.maven.execution.MavenSession;
+import org.sonatype.aether.RepositorySystemSession;
-        MavenSession session = legacySupport.getSession();
+        RepositorySystemSession session = legacySupport.getRepositorySession();
-            MavenExecutionRequest request = session.getRequest();
-            if ( request != null )
+            List<ArtifactRepository> repositories = Arrays.asList( repository );
+
+            if ( mirrors )
-                List<ArtifactRepository> repositories = Arrays.asList( repository );
-
-                if ( mirrors )
-                {
-                    repositorySystem.injectMirror( repositories, request.getMirrors() );
-                }
-
-                repositorySystem.injectProxy( repositories, request.getProxies() );
-
-                repositorySystem.injectAuthentication( repositories, request.getServers() );
+                repositorySystem.injectMirror( session, repositories );
+
+            repositorySystem.injectProxy( session, repositories );
+
+            repositorySystem.injectAuthentication( session, repositories );
