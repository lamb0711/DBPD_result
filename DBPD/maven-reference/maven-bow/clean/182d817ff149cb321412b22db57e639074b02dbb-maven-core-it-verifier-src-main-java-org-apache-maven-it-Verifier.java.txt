return exit code for goal failures


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@163071 13f79535-47bb-0310-9956-ffa450edef68

+        int ret = 0;
-            Method m = c.getMethod( "main", new Class[] { String[].class } );
-            m.invoke( null, new Object[] { allGoals.toArray( new String[0] ) } );
+            Method m = c.getMethod( "mainWithExitCode", new Class[] { String[].class } );
+            Object o = m.invoke( null, new Object[] { allGoals.toArray( new String[0] ) } );
+            ret = ( ( Integer ) o ).intValue();
+
+        if ( ret > 0 )
+        {
+            System.err.println( "Exit code: " + ret );
+            throw new VerificationException();
+        }
