o Decoupled project building request from model building request
o Moved model resolver into model building request

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@782223 13f79535-47bb-0310-9956-ffa450edef68

-    public ModelBuildingResult build( File pomFile, ModelBuildingRequest request, ModelResolver modelResolver )
+    public ModelBuildingResult build( File pomFile, ModelBuildingRequest request )
-        return build( new FileModelSource( pomFile ), pomFile, request, modelResolver );
+        return build( new FileModelSource( pomFile ), pomFile, request );
-    public ModelBuildingResult build( ModelSource modelSource, ModelBuildingRequest request, ModelResolver modelResolver )
+    public ModelBuildingResult build( ModelSource modelSource, ModelBuildingRequest request )
-        return build( modelSource, null, request, modelResolver );
+        return build( modelSource, null, request );
-    private ModelBuildingResult build( ModelSource modelSource, File pomFile, ModelBuildingRequest request,
-                                       ModelResolver modelResolver )
+    private ModelBuildingResult build( ModelSource modelSource, File pomFile, ModelBuildingRequest request )
-        for ( Model current = model; current != null; current = readParent( current, request, modelResolver ) )
+        for ( Model current = model; current != null; current = readParent( current, request ) )
-            configureResolver( modelResolver, resultModel );
+            configureResolver( request.getModelResolver(), resultModel );
+        if ( modelResolver == null )
+        {
+            return;
+        }
+
-    private Model readParent( Model childModel, ModelBuildingRequest request, ModelResolver modelResolver )
+    private Model readParent( Model childModel, ModelBuildingRequest request )
-                parentModel = readParentExternally( childModel, request, modelResolver );
+                parentModel = readParentExternally( childModel, request );
-    private Model readParentExternally( Model childModel, ModelBuildingRequest request, ModelResolver modelResolver )
+    private Model readParentExternally( Model childModel, ModelBuildingRequest request )
+        ModelResolver modelResolver = request.getModelResolver();
+
+        if ( modelResolver == null )
+        {
+            Exception e = new IllegalArgumentException( "No model resolver provided" );
+            throw new UnresolvableParentException( "Failed to resolve parent POM " + toId( parent ) + " for POM "
+                + toSourceHint( childModel ), e );
+        }
+
