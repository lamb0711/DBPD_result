Generate reports links in menu

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@169073 13f79535-47bb-0310-9956-ffa450edef68

+import org.codehaus.plexus.util.FileUtils;
+import org.codehaus.plexus.util.StringInputStream;
+import org.codehaus.plexus.util.StringUtils;
+import java.util.HashMap;
-            siteRenderer.render( siteDirectory, generatedSiteDirectory, outputDirectory, flavour );
+            File siteDescriptor = new File( siteDirectory, "site.xml" );
+            if ( !siteDescriptor.exists() )
+            {
+                throw new MojoExecutionException( "The site descriptor is not present!" );
+            }
+            String siteDescriptorContent = FileUtils.fileRead( siteDescriptor );
+            Map props = new HashMap();
+            if ( reports != null )
+            {
+                props.put( "reports", getReportsMenu() );
+            }
+            siteDescriptorContent = StringUtils.interpolate( siteDescriptorContent, props );
+            StringInputStream siteDescriptorStream = new StringInputStream( siteDescriptorContent );
+
+            siteRenderer.render( siteDirectory, generatedSiteDirectory, outputDirectory, flavour,
+                                 siteDescriptorStream );
+    private String getReportsMenu()
+    {
+        StringBuffer buffer = new StringBuffer();
+        buffer.append( "<menu name=\"Project Documentation\">\n" );
+        buffer.append( "    <item name=\"About " + project.getName() + "\" href=\"/index.html\"/>\n");
+        buffer.append( "    <item name=\"Project reports\" href=\"/maven-reports.html\" collapse=\"true\">\n" );
+
+        for ( Iterator i = reports.keySet().iterator(); i.hasNext(); )
+        {
+            String reportKey = (String) i.next();
+            buffer.append( "        <item name=\"" + reportKey + "\" href=\"/" + reportKey + ".html\"/>\n" );
+        }
+
+        buffer.append( "    </item>\n" );
+        buffer.append( "</menu>\n" );
+        return buffer.toString();
+    }
