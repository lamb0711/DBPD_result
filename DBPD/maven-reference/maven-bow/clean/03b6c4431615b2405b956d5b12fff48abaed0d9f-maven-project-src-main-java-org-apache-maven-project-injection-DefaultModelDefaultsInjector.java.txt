Resolving: MNG-985...simply fixed merging of plugins from PluginManagement to happen on a plugin-by-plugin basis using individual merge logic from ModelUtils, rather than the wholesale merge logic for plugin lists.

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@292255 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.model.Build;
+import org.apache.maven.model.PluginManagement;
-            ModelUtils.mergePluginLists( model.getBuild(), model.getBuild().getPluginManagement(), false );
+            injectPluginDefaults( model.getBuild(), model.getBuild().getPluginManagement() );
+    private void injectPluginDefaults( Build build, PluginManagement pluginManagement )
+    {
+        if ( pluginManagement == null )
+        {
+            // nothing to inject.
+            return ;
+        }
+        
+        List buildPlugins = build.getPlugins();
+        
+        if ( buildPlugins != null && !buildPlugins.isEmpty() )
+        {
+            Map pmPlugins = pluginManagement.getPluginsAsMap();
+            
+            if ( pmPlugins != null && !pmPlugins.isEmpty() )
+            {
+                for ( Iterator it = buildPlugins.iterator(); it.hasNext(); )
+                {
+                    Plugin buildPlugin = (Plugin) it.next();
+                    
+                    Plugin pmPlugin = (Plugin) pmPlugins.get( buildPlugin.getKey() );
+                    
+                    if ( pmPlugin != null )
+                    {
+                        mergePluginWithDefaults( buildPlugin, pmPlugin );
+                    }
+                }
+            }
+        }
+        
+    }
+
