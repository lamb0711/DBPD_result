PR: MNG-366
reverse the reference. DoxiaMojo depends on maven-core instead of maven-core depending on the reporting api + doxia

This is not a great solution, but it gets us closer. It is currently not possible, as before, to get the correct set of reports as they are all loaded into the one container and then everything found is returned.


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@188690 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.artifact.repository.ArtifactRepository;
+import org.apache.maven.model.Plugin;
-    public PluginDescriptor verifyPlugin( String groupId, String artifactId, String version, MavenSession session )
+    public PluginDescriptor verifyPlugin( String groupId, String artifactId, String version, MavenProject project,
+                                          ArtifactRepository localRepository )
-        
+
-            MavenProject project = session.getProject();
-            org.apache.maven.model.Plugin pluginConfig = null;
+            Plugin pluginConfig = null;
-                org.apache.maven.model.Plugin plugin = (org.apache.maven.model.Plugin) it.next();
+                Plugin plugin = (Plugin) it.next();
-                    org.apache.maven.model.Plugin plugin = (org.apache.maven.model.Plugin) it.next();
+                    Plugin plugin = (Plugin) it.next();
-                addPlugin( pluginKey, pluginArtifact, session );
+                addPlugin( pluginKey, pluginArtifact, project, localRepository );
-    protected void addPlugin( String pluginKey, Artifact pluginArtifact, MavenSession session )
+    protected void addPlugin( String pluginKey, Artifact pluginArtifact, MavenProject project,
+                              ArtifactRepository localRepository )
-                Collections.singleton( pluginArtifact ), session.getRemoteRepositories(), session.getLocalRepository(),
+                Collections.singleton( pluginArtifact ), project.getRemoteArtifactRepositories(), localRepository,
-        artifactFilter = new ExclusionSetFilter( new String[]{/*"bsh",*/ "classworlds", "doxia-core", "maven-artifact",
+        artifactFilter = new ExclusionSetFilter( new String[]{"classworlds", /*"doxia-core",*/ "maven-artifact",
-                                                              "maven-project", "maven-reporting-api",
-                                                              /*"maven-script-beanshell", */"maven-settings",
-                                                              /*"plexus-bsh-factory", */"plexus-container-default",
-                                                              "plexus-utils", "wagon-provider-api"} );
+                                                              "maven-project", /*"maven-reporting-api",*/ "maven-settings",
+                                                              "plexus-container-default", "plexus-utils",
+                                                              "wagon-provider-api"} );
