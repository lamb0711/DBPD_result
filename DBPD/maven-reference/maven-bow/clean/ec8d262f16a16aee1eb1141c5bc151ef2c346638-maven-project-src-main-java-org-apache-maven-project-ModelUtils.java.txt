Resolving: MNG-878, MNG-921

o Verified that plugins are added to the list in the model when invoked from the command line (878)
o Reformatted ModelUtils after the profiles-cloning addition
o Added cache-flush for the plugin map in MavenProject
o Moved dependencies for subproject/subproject2 into the parent-project POM, inside a profile
o Added activation property for this new profile into the test.sh script
o Added explicit activation inside of release:perform's m2 invocation for all profile-ids active in the release-plugin's execution.
o Added code to remove the dynamic parts of the POM from the release-pom.xml...it's not meant to be a dynamic version of a POM.



git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@290336 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.maven.model.Build;
-                                         boolean handleAsInheritance )
+                                        boolean handleAsInheritance )
-                if ( !handleAsInheritance || parentInherited == null ||
-                    Boolean.valueOf( parentInherited ).booleanValue() )
+                if ( !handleAsInheritance || parentInherited == null
+                    || Boolean.valueOf( parentInherited ).booleanValue() )
-                if ( !handleAsInheritance || parentInherited == null ||
-                    Boolean.valueOf( parentInherited ).booleanValue() )
+                if ( !handleAsInheritance || parentInherited == null
+                    || Boolean.valueOf( parentInherited ).booleanValue() )
-                                                     boolean handleAsInheritance )
+                                                    boolean handleAsInheritance )
-        
+
-        
+
-        
+
-        
+
-            
+
-            
-            newProfile.setId(profile.getId());
-            
+
+            newProfile.setId( profile.getId() );
+
-            
+
-            
+
-            
+
-            
+
-                
+
-                
+
-            
-            newProfile.setDistributionManagement( cloneProfileDistributionManagement( profile.getDistributionManagement() ) );
-            
+
+            newProfile.setDistributionManagement( cloneProfileDistributionManagement( profile
+                .getDistributionManagement() ) );
+
-            
+
-            
+
-            
+
-            
+
-            
+
-            
+
-            
+
-            
-            newProfile.setSource(profile.getSource() );
-            
+
+            newProfile.setSource( profile.getSource() );
+
-        
+
-        
+
-            
-            newR.setOutputDirectory(reporting.getOutputDirectory());
-            
+
+            newR.setOutputDirectory( reporting.getOutputDirectory() );
+
-            
+
-            
+
-                
+
-                    
+
-                    
-                    newPlugin.setArtifactId(plugin.getArtifactId());
-                    newPlugin.setGroupId(plugin.getGroupId());
-                    newPlugin.setVersion(plugin.getVersion());
-                    newPlugin.setInherited(plugin.getInherited());
+
+                    newPlugin.setArtifactId( plugin.getArtifactId() );
+                    newPlugin.setGroupId( plugin.getGroupId() );
+                    newPlugin.setVersion( plugin.getVersion() );
+                    newPlugin.setInherited( plugin.getInherited() );
-                    
+
-                    newPlugin.setConfiguration(plugin.getConfiguration());
-                    
+                    newPlugin.setConfiguration( plugin.getConfiguration() );
+
-                
-                newR.setPlugins(newP);
+
+                newR.setPlugins( newP );
-        
+
-            
+
-                
+
-                
+
-                newSet.setConfiguration(set.getConfiguration());
-                
-                newSet.setId(set.getId());
-                newSet.setInherited(set.getInherited());
-                
-                newSet.setReports(new ArrayList( set.getReports() ));
-                
+                newSet.setConfiguration( set.getConfiguration() );
+
+                newSet.setId( set.getId() );
+                newSet.setInherited( set.getInherited() );
+
+                newSet.setReports( new ArrayList( set.getReports() ) );
+
-        
+
-        
+
-            
+
-                
+
-                
-                newRepo.setChecksumPolicy(repo.getChecksumPolicy());
-                newRepo.setId(repo.getId());
-                newRepo.setLayout(repo.getLayout());
-                newRepo.setName(repo.getName());
-                newRepo.setSnapshotPolicy(repo.getSnapshotPolicy());
-                
+
+                newRepo.setChecksumPolicy( repo.getChecksumPolicy() );
+                newRepo.setId( repo.getId() );
+                newRepo.setLayout( repo.getLayout() );
+                newRepo.setName( repo.getName() );
+                newRepo.setSnapshotPolicy( repo.getSnapshotPolicy() );
+
-                
+
-                    newPolicy.setEnabled(releasePolicy.isEnabled());
-                    newPolicy.setChecksumPolicy(releasePolicy.getChecksumPolicy());
-                    newPolicy.setUpdatePolicy(releasePolicy.getUpdatePolicy());
-                    
-                    newRepo.setReleases(newPolicy);
+                    newPolicy.setEnabled( releasePolicy.isEnabled() );
+                    newPolicy.setChecksumPolicy( releasePolicy.getChecksumPolicy() );
+                    newPolicy.setUpdatePolicy( releasePolicy.getUpdatePolicy() );
+
+                    newRepo.setReleases( newPolicy );
-                
+
-                
+
-                    newPolicy.setEnabled(snapPolicy.isEnabled());
-                    newPolicy.setChecksumPolicy(snapPolicy.getChecksumPolicy());
-                    newPolicy.setUpdatePolicy(snapPolicy.getUpdatePolicy());
-                    
-                    newRepo.setSnapshots(newPolicy);
+                    newPolicy.setEnabled( snapPolicy.isEnabled() );
+                    newPolicy.setChecksumPolicy( snapPolicy.getChecksumPolicy() );
+                    newPolicy.setUpdatePolicy( snapPolicy.getUpdatePolicy() );
+
+                    newRepo.setSnapshots( newPolicy );
-                
-                newRepo.setUrl(repo.getUrl());
-                
+
+                newRepo.setUrl( repo.getUrl() );
+
-        
+
-        
+
-            
-            newDM.setDownloadUrl(dm.getDownloadUrl() );
-            newDM.setStatus(dm.getStatus());
-            
+
+            newDM.setDownloadUrl( dm.getDownloadUrl() );
+            newDM.setStatus( dm.getStatus() );
+
-            
+
-                
-                newR.setArtifactId(relocation.getArtifactId());
-                newR.setGroupId(relocation.getGroupId());
-                newR.setMessage(relocation.getMessage());
-                newR.setVersion(relocation.getVersion());
-                
-                newDM.setRelocation(newR);
+
+                newR.setArtifactId( relocation.getArtifactId() );
+                newR.setGroupId( relocation.getGroupId() );
+                newR.setMessage( relocation.getMessage() );
+                newR.setVersion( relocation.getVersion() );
+
+                newDM.setRelocation( newR );
-            
+
-            
+
-                
-                newRepo.setId(repo.getId());
-                newRepo.setLayout(repo.getLayout());
-                newRepo.setName(repo.getName());
-                newRepo.setUrl(repo.getUrl());
-                
-                newDM.setRepository(newRepo);
+
+                newRepo.setId( repo.getId() );
+                newRepo.setLayout( repo.getLayout() );
+                newRepo.setName( repo.getName() );
+                newRepo.setUrl( repo.getUrl() );
+
+                newDM.setRepository( newRepo );
-            
+
-            
+
-                
-                newSite.setId(site.getId());
-                newSite.setName(site.getName());
-                newSite.setUrl(site.getUrl());
-                
-                newDM.setSite(newSite);
+
+                newSite.setId( site.getId() );
+                newSite.setName( site.getName() );
+                newSite.setUrl( site.getUrl() );
+
+                newDM.setSite( newSite );
-            
+
-            
+
-                
-                newRepo.setId(sRepo.getId());
-                newRepo.setLayout(sRepo.getLayout());
-                newRepo.setName(sRepo.getName());
-                newRepo.setUrl(sRepo.getUrl());
-                
-                newDM.setSnapshotRepository(newRepo);
+
+                newRepo.setId( sRepo.getId() );
+                newRepo.setLayout( sRepo.getLayout() );
+                newRepo.setName( sRepo.getName() );
+                newRepo.setUrl( sRepo.getUrl() );
+
+                newDM.setSnapshotRepository( newRepo );
-        
+
-        
+
-            
+
-                
+
-                
-                newDep.setArtifactId(dep.getArtifactId());
-                newDep.setClassifier(dep.getClassifier());
+
+                newDep.setArtifactId( dep.getArtifactId() );
+                newDep.setClassifier( dep.getClassifier() );
-                newDep.setGroupId(dep.getGroupId());
-                newDep.setScope(dep.getScope());
-                newDep.setSystemPath(dep.getSystemPath());
-                newDep.setType(dep.getType());
-                newDep.setVersion(dep.getVersion());
-                
+                newDep.setGroupId( dep.getGroupId() );
+                newDep.setScope( dep.getScope() );
+                newDep.setSystemPath( dep.getSystemPath() );
+                newDep.setType( dep.getType() );
+                newDep.setVersion( dep.getVersion() );
+
-        
+
-            
+
-                
+
-                
-                newExclusion.setArtifactId(exclusion.getArtifactId() );
+
+                newExclusion.setArtifactId( exclusion.getArtifactId() );
-                
+
-            
-            newBuild.setDefaultGoal(build.getDefaultGoal());
-            newBuild.setDirectory(build.getDirectory());
-            newBuild.setFinalName(build.getFinalName());
-            
+
+            newBuild.setDefaultGoal( build.getDefaultGoal() );
+            newBuild.setDirectory( build.getDirectory() );
+            newBuild.setFinalName( build.getFinalName() );
+
-        
+
-        
+
-            
+
-                
+
-                
-                newResource.setDirectory(resource.getDirectory());
-                newResource.setExcludes(new ArrayList( resource.getExcludes()));
-                newResource.setFiltering(resource.isFiltering());
-                newResource.setIncludes(new ArrayList( resource.getIncludes()));
-                newResource.setTargetPath(resource.getTargetPath());
-                
+
+                newResource.setDirectory( resource.getDirectory() );
+                newResource.setExcludes( new ArrayList( resource.getExcludes() ) );
+                newResource.setFiltering( resource.isFiltering() );
+                newResource.setIncludes( new ArrayList( resource.getIncludes() ) );
+                newResource.setTargetPath( resource.getTargetPath() );
+
-        
+
-        
+
-            
+
-            
+
-        
+
-        
+
-            
+
-                
+
-                
-                newPlugin.setArtifactId(plugin.getArtifactId());
-                newPlugin.setExtensions(plugin.isExtensions());
-                newPlugin.setGroupId(plugin.getGroupId());
-                newPlugin.setInherited(plugin.getInherited());
-                newPlugin.setVersion(plugin.getVersion());
-                
+
+                newPlugin.setArtifactId( plugin.getArtifactId() );
+                newPlugin.setExtensions( plugin.isExtensions() );
+                newPlugin.setGroupId( plugin.getGroupId() );
+                newPlugin.setInherited( plugin.getInherited() );
+                newPlugin.setVersion( plugin.getVersion() );
+
-                newPlugin.setConfiguration(plugin.getConfiguration());
-                
+                newPlugin.setConfiguration( plugin.getConfiguration() );
+
-                    
-                    newPlugin.setGoals(newGoals);
+
+                    newPlugin.setGoals( newGoals );
-                
-                newPlugin.setExecutions( cloneExecutions( plugin.getExecutions() ));
-                
+
+                newPlugin.setExecutions( cloneExecutions( plugin.getExecutions() ) );
+
-        
+
-        
+
-            
+
-                
+
-                
+
-                newExec.setConfiguration(exec.getConfiguration());
-                
-                newExec.setId(exec.getId());
-                newExec.setInherited(exec.getInherited());
-                newExec.setPhase(exec.getPhase());
-                
+                newExec.setConfiguration( exec.getConfiguration() );
+
+                newExec.setId( exec.getId() );
+                newExec.setInherited( exec.getInherited() );
+                newExec.setPhase( exec.getPhase() );
+
-                
+
-                
+
-        
+
-            
-            newActivation.setActiveByDefault(activation.isActiveByDefault());
-            
+
+            newActivation.setActiveByDefault( activation.isActiveByDefault() );
+
-            
+
-                afNew.setExists(af.getExists());
-                afNew.setMissing(af.getMissing());
-                
-                newActivation.setFile(afNew);
+                afNew.setExists( af.getExists() );
+                afNew.setMissing( af.getMissing() );
+
+                newActivation.setFile( afNew );
-            
-            newActivation.setJdk(activation.getJdk());
-            
+
+            newActivation.setJdk( activation.getJdk() );
+
-            
+
-                
-                newAp.setName(ap.getName());
-                newAp.setValue(ap.getValue());
-                
-                newActivation.setProperty(newAp);
+
+                newAp.setName( ap.getName() );
+                newAp.setValue( ap.getValue() );
+
+                newActivation.setProperty( newAp );
-        
+
