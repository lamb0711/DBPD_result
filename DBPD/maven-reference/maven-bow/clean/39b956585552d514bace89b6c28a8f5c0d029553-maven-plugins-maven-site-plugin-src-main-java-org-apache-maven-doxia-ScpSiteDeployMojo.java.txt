PR: MNG-484
Submitted by: Binyan
Reviewed by:  Brett Porter
add file:// deployment mechanism to site:deploy

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@292366 13f79535-47bb-0310-9956-ffa450edef68

- * Deploys website using scp protocol.
- * First website files are packaged into zip archive,
+ * Deploys website using scp/file protocol.
+ * For scp protocol, website files are packaged into zip archive,
- * then making file by file copy.
+ * then making file by file copy.  For file protocol, the files are copied
+ * directly to the destination directory.
-        if ( !"scp".equals( repository.getProtocol() ) )
+        String siteProtocol = repository.getProtocol();
+
+        if ( "scp".equals( siteProtocol ) )
+        {
+            scpDeploy( zipFile, id, repository );
+        }
+        else if ( "file".equals( siteProtocol ) )
+        {
+            File toDir = new File( repository.getBasedir() );
+            fileDeploy( toDir );
+        }
+        else
-                "The deploy mojo currently only supports site deployment using the 'scp' protocol." );
+                "The deploy mojo currently only supports site deployment using the 'scp' and 'file' protocols." );
+    }
+
+    /**
+     * @throws MojoExecutionException
+     */
+    private void fileDeploy( File toDir )
+        throws MojoExecutionException
+    {
+        try
+        {
+            FileUtils.copyDirectoryStructure( inputDirectory, toDir );
+        }
+        catch ( IOException e )
+        {
+            throw new MojoExecutionException( "Error transfering site!", e );
+        }
+    }
+
+
+    /**
+     * @param zipFile
+     * @param id
+     * @param repository
+     * @throws MojoExecutionException
+     */
+    private void scpDeploy( File zipFile, String id, Repository repository )
+        throws MojoExecutionException
+    {
