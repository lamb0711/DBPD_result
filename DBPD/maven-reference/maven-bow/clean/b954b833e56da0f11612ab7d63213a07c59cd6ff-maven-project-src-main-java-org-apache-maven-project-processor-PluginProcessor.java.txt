[MNG-3906] - Project-level plugin dependencies order. Fixed a lot of problems with ordering of elements. We need to assume that the processors always get the parent model first, then the child, down the line.

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@757936 13f79535-47bb-0310-9956-ffa450edef68

-            copyDependencies( (Plugin) child, targetPlugin, true );
+            copyDependencies( new ArrayList<Dependency>(), 
+                              new ArrayList<Dependency>(( (Plugin) child).getDependencies() ), targetPlugin, true );
-            copyDependencies( (Plugin) parent, targetPlugin, false );
+            copyDependencies( new ArrayList<Dependency>(( (Plugin) parent).getDependencies() ), new ArrayList<Dependency>(), 
+                      targetPlugin, true );            
+           // copyDependencies( (Plugin) parent, targetPlugin, false );
-                
-                copyDependencies( (Plugin) child, targetPlugin, true );
-                copyDependencies( (Plugin) parent, targetPlugin, false );
+                copyDependencies( new ArrayList<Dependency>(( (Plugin) parent).getDependencies() ),
+                                  new ArrayList<Dependency>(( (Plugin) child).getDependencies() ), targetPlugin, true );
-                copyDependencies( (Plugin) child, targetPlugin, true );
-                copyDependencies( (Plugin) parent, targetPlugin, false );
+                copyDependencies( new ArrayList<Dependency>(( (Plugin) parent).getDependencies() ),
+                                  new ArrayList<Dependency>(( (Plugin) child).getDependencies() ), targetPlugin, true );
+              //  copyDependencies( (Plugin) parent, targetPlugin, false );
-    private static void copyDependencies(Plugin source, Plugin target, boolean isChild)
+    private static void copyDependencies(List<Dependency> parent, List<Dependency> child, Plugin target, boolean isChild)
-        proc.process( new ArrayList<Dependency>(), new ArrayList<Dependency>(source.getDependencies()), target.getDependencies(), isChild );            
+        proc.process( parent, child, target.getDependencies(), isChild );            
-        
-        
+               
-     
-
-
+        
