o Improved error reporting

git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@826015 13f79535-47bb-0310-9956-ffa450edef68

-                        pluginDescriptor = parsePluginDescriptor( is, plugin );
+                        pluginDescriptor = parsePluginDescriptor( is, plugin, pluginFile.getAbsolutePath() );
-                if ( pluginXml.canRead() )
+                if ( pluginXml.isFile() )
-                        pluginDescriptor = parsePluginDescriptor( is, plugin );
+                        pluginDescriptor = parsePluginDescriptor( is, plugin, pluginXml.getAbsolutePath() );
+
+            if ( pluginDescriptor == null )
+            {
+                throw new IOException( "No plugin descriptor found at " + getPluginDescriptorLocation() );
+            }
-            throw new PluginDescriptorParsingException( plugin, e );
-        }
-
-        if ( pluginDescriptor == null )
-        {
-            throw new InvalidPluginDescriptorException( "Missing plugin descriptor for " + plugin.getId() + " ("
-                + pluginFile + ")" );
+            throw new PluginDescriptorParsingException( plugin, pluginFile.getAbsolutePath(), e );
-    private PluginDescriptor parsePluginDescriptor( InputStream is, Plugin plugin )
+    private PluginDescriptor parsePluginDescriptor( InputStream is, Plugin plugin, String descriptorLocation )
-            PluginDescriptor pluginDescriptor = builder.build( reader );
+            PluginDescriptor pluginDescriptor = builder.build( reader, descriptorLocation );
-            throw new PluginDescriptorParsingException( plugin, e );
+            throw new PluginDescriptorParsingException( plugin, descriptorLocation, e );
-            throw new PluginDescriptorParsingException( plugin, e );
+            throw new PluginDescriptorParsingException( plugin, descriptorLocation, e );
