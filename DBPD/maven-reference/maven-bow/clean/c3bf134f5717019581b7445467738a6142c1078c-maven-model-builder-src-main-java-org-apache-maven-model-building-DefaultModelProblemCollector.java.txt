[MNG-5073] ProjectBuilder.build(File,ProjectBuildingRequest) returns null project if dependency version info is missing

git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@1176414 13f79535-47bb-0310-9956-ffa450edef68

-import java.util.ArrayList;
+    private final ModelBuildingResult result;
+
-    public DefaultModelProblemCollector( List<ModelProblem> problems )
+    public DefaultModelProblemCollector( ModelBuildingResult result )
-        this.problems = ( problems != null ) ? problems : new ArrayList<ModelProblem>();
+        this.result = result;
+        this.problems = result.getProblems();
+    public ModelBuildingException newModelBuildingException()
+    {
+        ModelBuildingResult result = this.result;
+        if ( result.getModelIds().isEmpty() )
+        {
+            DefaultModelBuildingResult tmp = new DefaultModelBuildingResult();
+            tmp.setEffectiveModel( result.getEffectiveModel() );
+            tmp.setProblems( getProblems() );
+            tmp.setActiveExternalProfiles( result.getActiveExternalProfiles() );
+            String id = getRootModelId();
+            tmp.addModelId( id );
+            tmp.setRawModel( id, getRootModel() );
+            result = tmp;
+        }
+        return new ModelBuildingException( result );
+    }
+
