o remove the resolve plugin version, this logic will all be handled by building up the project model, and there will be no magical plugin version diddling. you must set the version of the plugins you're using.

git-svn-id: https://svn.apache.org/repos/asf/maven/components/branches/MNG-2766@774327 13f79535-47bb-0310-9956-ffa450edef68

-        resolvePluginVersion( plugin, project );
-
-        ArtifactResolutionRequest request = new ArtifactResolutionRequest( pluginArtifact, localRepository, project.getRemoteArtifactRepositories() );
+        ArtifactResolutionRequest request = new ArtifactResolutionRequest()
+            .setArtifact( pluginArtifact )
+            .setLocalRepository( localRepository )
+            .setRemoteRepostories( project.getRemoteArtifactRepositories() );
-    public void resolvePluginVersion( Plugin plugin, MavenProject project )
-        throws PluginVersionNotFoundException
-    {
-        String version = plugin.getVersion();
-
-        if ( version != null && !Artifact.RELEASE_VERSION.equals( version ) )
-        {
-            return;
-        }
-
-        String groupId = plugin.getGroupId();
-
-        String artifactId = plugin.getArtifactId();
-
-        if ( project.getBuildPlugins() != null )
-        {
-            for ( Plugin p : project.getBuildPlugins() )
-            {
-                if ( groupId.equals( p.getGroupId() ) && artifactId.equals( p.getArtifactId() ) )
-                {
-                    version = p.getVersion();
-                }
-            }
-        }
-
-        if ( StringUtils.isEmpty( version ) || Artifact.RELEASE_VERSION.equals( version ) )
-        {
-            // 1. resolve the version to be used            
-            Artifact artifact = repositorySystem.createProjectArtifact( groupId, artifactId, Artifact.RELEASE_VERSION );
-
-            String artifactVersion = artifact.getVersion();
-
-            // make sure this artifact was transformed to a real version, and actually resolved to a file in the repo...
-            if ( !Artifact.RELEASE_VERSION.equals( artifactVersion ) && ( artifact.getFile() != null ) )
-            {
-                boolean pluginValid = false;
-
-                while ( !pluginValid && ( artifactVersion != null ) )
-                {
-                    pluginValid = true;
-
-                    artifact = repositorySystem.createProjectArtifact( groupId, artifactId, artifactVersion );
-                }
-
-                version = artifactVersion;
-            }
-
-            if ( version == null )
-            {
-                version = artifactVersion;
-            }
-        }
-
-        // if we still haven't found a version, then fail early before we get into the update goop.
-        if ( StringUtils.isEmpty( version ) )
-        {
-            throw new PluginVersionNotFoundException( groupId, artifactId );
-        }
-
-        plugin.setVersion( version );
-    }
-
