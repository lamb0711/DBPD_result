o adding in all plugins in all the default lifecycles

git-svn-id: https://svn.apache.org/repos/asf/maven/components/branches/MNG-2766@769547 13f79535-47bb-0310-9956-ffa450edef68

-    public Set<Plugin> lifecyclePlugins( String lifecycleId, String packaging )
+    public Set<Plugin> lifecyclePlugins( String packaging )
-        Lifecycle lifecycle = lifecycleMap.get( lifecycleId );                
-                
-        LifecycleMapping lifecycleMappingForPackaging = lifecycleMappings.get( packaging );
-          
-        Map<String, String> lifecyclePhasesForPackaging = lifecycleMappingForPackaging.getLifecycles().get( lifecycleId ).getPhases();            
-        
-        for ( String s : lifecyclePhasesForPackaging.values() )
+        for ( Lifecycle lifecycle : lifecycles )
-            String[] p = StringUtils.split( s, ":" );
-            Plugin plugin = new Plugin();        
-            plugin.setGroupId( p[0] );
-            plugin.setArtifactId( p[1] );
-            plugins.add( plugin );
+            LifecycleMapping lifecycleMappingForPackaging = lifecycleMappings.get( packaging );
+
+            org.apache.maven.lifecycle.mapping.Lifecycle lifecycleConfiguration = lifecycleMappingForPackaging.getLifecycles().get( lifecycle.getId() );                                                           
+            
+            if ( lifecycleConfiguration != null )
+            {
+                Map<String, String> lifecyclePhasesForPackaging = lifecycleConfiguration.getPhases();
+
+                for ( String s : lifecyclePhasesForPackaging.values() )
+                {
+                    String[] p = StringUtils.split( s, ":" );
+                    Plugin plugin = new Plugin();
+                    plugin.setGroupId( p[0] );
+                    plugin.setArtifactId( p[1] );
+                    plugins.add( plugin );
+                }
+            }
+            else if ( lifecycle.getDefaultPhases() != null )
+            {
+                for ( String s : lifecycle.getDefaultPhases() )
+                {
+                    String[] p = StringUtils.split( s, ":" );
+                    Plugin plugin = new Plugin();
+                    plugin.setGroupId( p[0] );
+                    plugin.setArtifactId( p[1] );
+                    plugins.add( plugin );
+                }                
+            }        
-        
+
-                    }
-                    
+                    }                    
