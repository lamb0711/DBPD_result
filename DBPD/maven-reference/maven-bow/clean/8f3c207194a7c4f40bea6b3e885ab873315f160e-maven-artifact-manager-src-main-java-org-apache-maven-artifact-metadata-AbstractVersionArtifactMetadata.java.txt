PR: MNG-613
changes versioning to use repository metadata

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@278881 13f79535-47bb-0310-9956-ffa450edef68

-    implements VersionArtifactMetadata
+    implements LegacyArtifactMetadata
-    protected File getLocalRepositoryLocation( ArtifactRepository localRepository, ArtifactRepository remoteRepository )
-    {
-        return new File( localRepository.getBasedir(),
-                         localRepository.pathOfLocalRepositoryMetadata( this, remoteRepository ) );
-    }
-
-    private void readFromFile( File file )
+    public void readFromFile( File file )
-    public boolean exists()
-    {
-        return lastModified > 0;
-    }
-
-    public Date getLastModified()
-    {
-        return new Date( lastModified );
-    }
-
-    public void readFromLocalRepository( ArtifactRepository localRepository, ArtifactRepository remoteRepository )
-        throws IOException
-    {
-        File f = getLocalRepositoryLocation( localRepository, remoteRepository );
-        if ( f.exists() )
-        {
-            readFromFile( f );
-        }
-    }
-
-    public void storeInLocalRepository( ArtifactRepository localRepository, ArtifactRepository remoteRepository )
+    public void storeInLocalRepository( ArtifactRepository localRepository )
-                String path = getLocalRepositoryLocation( localRepository, remoteRepository ).getPath();
-                File file = new File( path );
-                // TODO: this should be centralised before the resolution of the artifact
+                File file = new File( localRepository.getBasedir(),
+                                      localRepository.pathOfLocalRepositoryMetadata( this, null ) );
-                FileUtils.fileWrite( path, version );
+                FileUtils.fileWrite( file.getPath(), version );
+
+    public void storeInLocalRepository( ArtifactRepository localRepository, ArtifactRepository remoteRepository )
+        throws ArtifactMetadataRetrievalException
+    {
+        throw new IllegalStateException( "This code should no longer be called" );
+    }
+
+    public Date getLastModified()
+    {
+        return new Date( lastModified );
+    }
