o Fixed parent resolution from settings' repositories

git-svn-id: https://svn.apache.org/repos/asf/maven/components/branches/MNG-2766@778127 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.model.Repository;
+
-        List<ArtifactRepository> remoteRepositories = projectBuilderConfiguration.getRemoteRepositories();
+
+        List<ArtifactRepository> remoteRepositories = new ArrayList<ArtifactRepository>();
+        try
+        {
+            for ( Profile profile : profileSelector.getActiveProfiles( projectBuilderConfiguration.getProfiles(),
+                                                                       projectBuilderConfiguration ) )
+            {
+                for ( Repository repository : profile.getRepositories() )
+                {
+                    try
+                    {
+                        remoteRepositories.add( repositorySystem.buildArtifactRepository( repository ) );
+                    }
+                    catch ( InvalidRepositoryException e )
+                    {
+                        throw new ProjectBuildingException( projectId, "Failed to create remote repository "
+                            + repository, pomFile, e );
+                    }
+                }
+            }
+            remoteRepositories = repositorySystem.getMirrors( remoteRepositories );
+        }
+        catch ( ProfileActivationException e )
+        {
+            throw new ProjectBuildingException( projectId, "Failed to determine active profiles", pomFile, e );
+        }
+        remoteRepositories.addAll( projectBuilderConfiguration.getRemoteRepositories() );
