ability to set a proxy for a wagon


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@163343 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.maven.artifact.Artifact;
-import org.apache.maven.artifact.repository.ArtifactRepository;
+import org.apache.maven.artifact.Artifact;
-import org.apache.maven.artifact.handler.manager.ArtifactHandlerNotFoundException;
-import org.apache.maven.wagon.observers.ChecksumObserver;
+import org.apache.maven.wagon.proxy.ProxyInfo;
-import org.codehaus.plexus.util.FileUtils;
+import org.codehaus.plexus.util.FileUtils;
+import java.util.HashMap;
+import java.util.Map;
+    private Map proxies = new HashMap();
+
-        wagon.connect( repository );
+        wagon.connect( repository, getProxy( repository.getProtocol() ) );
-                wagon.connect( repository );
+                wagon.connect( repository, getProxy( repository.getProtocol() ) );
+    private ProxyInfo getProxy( String protocol )
+    {
+        return (ProxyInfo) proxies.get( protocol );
+    }
+
+    /**
+     * Set the proxy used for a particular protocol.
+     *
+     * @todo [BP] would be nice to configure this via plexus in some way
+     *
+     * @param protocol the protocol (required)
+     * @param host the proxy host name (required)
+     * @param port the proxy port (required)
+     * @param username the username for the proxy, or null if there is none
+     * @param password the password for the proxy, or null if there is none
+     * @param nonProxyHosts the set of hosts not to use the proxy for. Follows Java system property format:
+     *  <code>*.foo.com|localhost</code>.
+     */
+    public void setProxy( String protocol, String host, int port, String username, String password,
+                          String nonProxyHosts )
+    {
+        ProxyInfo proxyInfo = new ProxyInfo();
+        proxyInfo.setHost( host );
+        proxyInfo.setType( protocol );
+        proxyInfo.setPort( port );
+        proxyInfo.setNonProxyHosts( nonProxyHosts );
+        proxyInfo.setUserName( username );
+        proxyInfo.setPassword( password );
+
+        proxies.put( protocol, proxyInfo );
+    }
+
