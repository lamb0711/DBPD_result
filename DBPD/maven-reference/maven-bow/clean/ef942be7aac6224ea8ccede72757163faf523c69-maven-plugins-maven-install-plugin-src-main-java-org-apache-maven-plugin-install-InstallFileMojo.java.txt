PR: MNG-1322
Submitted By: Allan Ramirez
Reviewed By: John Casey

Applied. Thanks, Allan.

Minor change I made was to throw a MojoFailureException with the offending path, rather than logging to the error message-level.


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@330646 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.plugin.MojoFailureException;
-        throws MojoExecutionException
+        throws MojoExecutionException, MojoFailureException
-            installer.install( file, artifact, localRepository );
+            String localPath = localRepository.pathOf( artifact );
+
+            File destination = new File( localRepository.getBasedir(), localPath );
+
+            if( !file.getPath().equals( destination.getPath() ) )
+            {
+                installer.install( file, artifact, localRepository );
+            }
+            else
+            {
+                throw new MojoFailureException( "Cannot install artifact. Artifact is already in the local repository.\n\nFile in question is: " + file + "\n" );
+            }
