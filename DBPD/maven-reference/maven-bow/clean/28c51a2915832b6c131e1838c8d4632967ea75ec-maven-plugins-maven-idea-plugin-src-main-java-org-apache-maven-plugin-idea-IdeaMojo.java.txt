PR: MNG-904
Submitted by: Allan Ramirez
exclude individual directories, but not generated sources
(applied with modifications)

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@330212 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.ArrayList;
+
+            removeOldElements( content, "excludeFolder" );
+
+            //For excludeFolder
+            File target = new File( project.getBuild().getDirectory() );
+
+            List excludeFolders = new ArrayList();
+            excludeFolders.add( new File( project.getBuild().getOutputDirectory() ).getAbsolutePath() );
+            excludeFolders.add( new File( project.getBuild().getTestOutputDirectory() ).getAbsolutePath() );
+
+            if ( target.exists() )
+            {
+                File[] fileNames = target.listFiles();
+
+                for ( int i = 0; i < fileNames.length; i++ )
+                {
+                    File fileName = fileNames[i];
+                    if ( fileName.isDirectory() )
+                    {
+                        String absolutePath = fileName.getAbsolutePath();
+                        if ( !executedProject.getCompileSourceRoots().contains( absolutePath ) )
+                        {
+                            if ( !excludeFolders.contains( absolutePath ) )
+                            {
+                                excludeFolders.add( absolutePath );
+                            }
+                        }
+                    }
+                }
+
+                for ( Iterator i = excludeFolders.iterator(); i.hasNext(); )
+                {
+                    addExcludeFolder( content, i.next().toString() );
+                }
+            }
+
+    private void addExcludeFolder( Xpp3Dom content, String directory )
+    {
+        if ( !StringUtils.isEmpty( directory ) && new File( directory ).isDirectory() )
+        {
+            Xpp3Dom excludeFolder = createElement( content, "excludeFolder" );
+            excludeFolder.setAttribute( "url", getModuleFileUrl( directory ) );
+        }
+    }
+
