PR: MNG-999
Submitted by: Edwin Punzalan
use runtime classpath elements instead of all artifacts to avoid getting non-classpath elements in the libraries list

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@327860 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.ArrayList;
+import java.util.Collections;
+import java.util.List;
+import java.util.Set;
+import org.apache.maven.artifact.resolver.filter.ScopeArtifactFilter;
-            // Must loop artifacts, not dependencies to resolve transitivity
-            for ( Iterator i = project.getArtifacts().iterator(); i.hasNext(); )
+            for ( Iterator i = getRuntimeClasspathArtifacts().iterator(); i.hasNext(); )
+    
+    /**
+     * Get the list of Classpath Artifacts
+     *
+     * @return List of artifacts that are Classpath Elements
+     */
+    private List getRuntimeClasspathArtifacts()
+    {
+        Set artifacts = project.getArtifacts();
+        
+        if ( artifacts == null ||  artifacts.isEmpty() ) return Collections.EMPTY_LIST;
+        
+        ScopeArtifactFilter scopeFilter = new ScopeArtifactFilter( Artifact.SCOPE_RUNTIME );
+        
+        List list = new ArrayList();
+        
+        for ( Iterator i = artifacts.iterator(); i.hasNext(); )
+        {
+            Artifact artifact = (Artifact) i.next();
+            
+            if ( artifact.getArtifactHandler().isAddedToClasspath() && scopeFilter.include( artifact ) )
+            {
+                list.add( artifact );
+            }
+        }
+        
+        return list;
+    }
