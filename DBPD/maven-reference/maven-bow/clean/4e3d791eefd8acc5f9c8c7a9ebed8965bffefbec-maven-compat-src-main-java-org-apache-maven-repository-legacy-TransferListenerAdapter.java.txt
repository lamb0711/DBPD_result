o Revised transfer listener to provide better feedback

git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@828026 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.IdentityHashMap;
+import java.util.Map;
+
+import org.apache.maven.wagon.repository.Repository;
+    private Map<Resource, Long> transfers;
+
+        this.transfers = new IdentityHashMap<Resource, Long>();
+        transfers.remove( transferEvent.getResource() );
+
-        listener.transferProgress( wrap( transferEvent ), buffer, length );
+        Long transferred = transfers.get( transferEvent.getResource() );
+        if ( transferred == null )
+        {
+            transferred = Long.valueOf( length );
+        }
+        else
+        {
+            transferred = Long.valueOf( transferred.longValue() + length );
+        }
+        transfers.put( transferEvent.getResource(), transferred );
+
+        listener.transferProgress( wrap( transferEvent ), transferred.longValue(), buffer, 0, length );
+        listener.transferStarted( wrap( transferEvent ) );
-            String wagon = event.getWagon().getRepository().getUrl();
+            String wagon = event.getWagon().getClass().getName();
-            MavenArtifact artifact = wrap( event.getResource() );
+            MavenArtifact artifact = wrap( event.getWagon().getRepository(), event.getResource() );
-    private MavenArtifact wrap( Resource resource )
+    private MavenArtifact wrap( Repository repository, Resource resource )
-            return new MavenArtifact( resource.getName(), resource.getContentLength() );
+            return new MavenArtifact( repository.getUrl(), resource.getName(), resource.getContentLength() );
