Fixing it0112 and it0115, and cleaning up extension isolation further. Also, adding a flag to tell whether an accompanying profiles.xml file is valid for any given POM file...when loaded from a repository (or stubbed), this flag should always be false.

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@586061 13f79535-47bb-0310-9956-ffa450edef68

-    public static String createRealmId( Artifact realmArtifact )
+    private String createExtensionRealmId( Artifact realmArtifact )
-        return ArtifactUtils.versionlessKey( realmArtifact );
+        return projectId + "/extensions/" + ArtifactUtils.versionlessKey( realmArtifact );
-    public boolean containsRealm( Artifact extensionArtifact )
+    public boolean containsExtensionRealm( Artifact extensionArtifact )
-        String id = createRealmId( extensionArtifact );
+        String id = createExtensionRealmId( extensionArtifact );
-        String id = createRealmId( plugin );
-        return componentRealms.containsKey( id );
+        String realmId = createPluginRealmId( ArtifactUtils.versionlessKey( plugin.getGroupId(), plugin.getArtifactId() ) );
+
+        return componentRealms.containsKey( realmId );
-        String realmId = MavenProjectSession.createRealmId( extensionArtifact );
-        ClassRealm extRealm = container.getContainerRealm().createChildRealm( projectId + "/" + realmId );
+        String realmId = createExtensionRealmId( extensionArtifact );
+        ClassRealm extRealm = container.getContainerRealm().createChildRealm( realmId );
-    public ClassRealm getComponentRealm( String key )
+    public ClassRealm getPluginRealm( Plugin plugin )
+        throws NoSuchRealmException
-        return (ClassRealm) componentRealms.get( key );
+        String realmId = createPluginRealmId( ArtifactUtils.versionlessKey( plugin.getGroupId(), plugin.getArtifactId() ) );
+
+        return projectRealm.getWorld().getRealm( realmId );
-    public ClassRealm createPluginRealm( Plugin projectPlugin )
+    public ClassRealm createPluginRealm( Plugin plugin )
-        String realmId = MavenProjectSession.createRealmId( projectPlugin );
+        String realmId = createPluginRealmId( ArtifactUtils.versionlessKey( plugin.getGroupId(), plugin.getArtifactId() ) );
+
-    public static String createRealmId( Plugin plugin )
+    private String createPluginRealmId( String baseId )
-        return ArtifactUtils.versionlessKey( plugin.getGroupId(), plugin.getArtifactId() );
+        return projectId + "/plugins/" + baseId;
-    public static String createRealmId( PluginDescriptor pd )
-    {
-        return ArtifactUtils.versionlessKey( pd.getGroupId(), pd.getArtifactId() );
-    }
-
-    public ClassRealm getPluginRealm( PluginDescriptor pluginDescriptor )
+    public ClassRealm getPluginRealm( PluginDescriptor pd )
-        String realmId = MavenProjectSession.createRealmId( pluginDescriptor );
+        String realmId = createPluginRealmId( ArtifactUtils.versionlessKey( pd.getGroupId(), pd.getArtifactId() ) );
+
