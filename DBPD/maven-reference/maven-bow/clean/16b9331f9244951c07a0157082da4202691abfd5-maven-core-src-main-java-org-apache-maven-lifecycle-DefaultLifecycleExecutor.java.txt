[MNG-4291] [regression] @requiresOnline mojo annotation is ignored

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@803141 13f79535-47bb-0310-9956-ffa450edef68

+        MojoDescriptor mojoDescriptor = mojoExecution.getMojoDescriptor();
+
+        if ( mojoDescriptor.isOnlineRequired() && session.isOffline() )
+        {
+            if ( MojoExecution.Source.CLI.equals( mojoExecution.getSource() ) )
+            {
+                throw new MojoExecutionException( "Goal " + mojoDescriptor.getGoal()
+                    + " requires online mode for execution but Maven is currently offline." );
+            }
+            else
+            {
+                logger.warn( "Goal " + mojoDescriptor.getGoal()
+                    + " requires online mode for execution but Maven is currently offline, skipping" );
+                return;
+            }
+        }
+
-                logger.debug( "Forking execution for " + mojoExecution.getMojoDescriptor().getId() );
+                logger.debug( "Forking execution for " + mojoDescriptor.getId() );
-                logger.debug( "Completed forked execution for " + mojoExecution.getMojoDescriptor().getId() );
+                logger.debug( "Completed forked execution for " + mojoDescriptor.getId() );
