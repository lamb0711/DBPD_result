consolidate defaults injection

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@168152 13f79535-47bb-0310-9956-ffa450edef68

-            injectPluginDefaults( model.getBuild().getPlugins(), model.getBuild().getPluginManagement() );
+            injectPluginDefaults( model.getBuild().getPluginsAsMap(), model.getBuild().getPluginManagement() );
-    private void injectPluginDefaults( List plugins, PluginManagement pluginManagement )
+    private void injectPluginDefaults( Map pluginMap, PluginManagement pluginManagement )
-            // TODO: share with inheritence assembler
-            Map pluginMap = new TreeMap();
-            for ( Iterator it = plugins.iterator(); it.hasNext(); )
-            {
-                Plugin plugin = (Plugin) it.next();
-                pluginMap.put( constructPluginKey( plugin ), plugin );
-            }
-
-                String key = constructPluginKey( def );
-                Plugin plugin = (Plugin) pluginMap.get( key );
+                Plugin plugin = (Plugin) pluginMap.get( def.getKey() );
-    private static String constructPluginKey( Plugin plugin )
-    {
-        return plugin.getGroupId() + ":" + plugin.getArtifactId();
-    }
-
-    private void mergePluginWithDefaults( Plugin plugin, Plugin def )
+    public void mergePluginWithDefaults( Plugin plugin, Plugin def )
-        Map defaultGoals = new TreeMap();
-
-        List defGoalList = def.getGoals();
-
-        if ( defGoalList != null )
-        {
-            for ( Iterator it = defGoalList.iterator(); it.hasNext(); )
-            {
-                Goal defaultGoal = (Goal) it.next();
-
-                defaultGoals.put( defaultGoal.getId(), defaultGoal );
-            }
-        }
+        Map defaultGoals = def.getGoalsAsMap();
