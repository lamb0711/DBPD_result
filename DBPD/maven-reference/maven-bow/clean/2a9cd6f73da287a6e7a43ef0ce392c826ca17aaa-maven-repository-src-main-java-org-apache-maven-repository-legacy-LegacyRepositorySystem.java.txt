[MNG-4196] [regression] Exclusions in project-level plugin dependencies are ignored

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@784371 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.artifact.resolver.filter.ExcludesArtifactFilter;
+import org.apache.maven.model.Exclusion;
-        return artifactFactory.createDependencyArtifact( d.getGroupId(), d.getArtifactId(), versionRange, d.getType(), d.getClassifier(), d.getScope() );
+        Artifact artifact =
+            artifactFactory.createDependencyArtifact( d.getGroupId(), d.getArtifactId(), versionRange, d.getType(),
+                                                      d.getClassifier(), d.getScope(), d.isOptional() );
+
+        if ( Artifact.SCOPE_SYSTEM.equals( d.getScope() ) && d.getSystemPath() != null )
+        {
+            artifact.setFile( new File( d.getSystemPath() ) );
+        }
+
+        if ( !d.getExclusions().isEmpty() )
+        {
+            List<String> exclusions = new ArrayList<String>();
+
+            for ( Exclusion exclusion : d.getExclusions() )
+            {
+                exclusions.add( exclusion.getGroupId() + ':' + exclusion.getArtifactId() );
+            }
+
+            artifact.setDependencyFilter( new ExcludesArtifactFilter( exclusions ) );
+        }
+
+        return artifact;
