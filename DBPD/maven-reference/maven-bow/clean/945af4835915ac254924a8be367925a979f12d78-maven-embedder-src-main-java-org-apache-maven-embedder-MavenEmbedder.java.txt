o doing a quick pass at integrating the fork mojo into the embedder


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@291748 13f79535-47bb-0310-9956-ffa450edef68

+import org.codehaus.plexus.util.DirectoryScanner;
-import java.util.Collections;
+import java.util.Iterator;
-    private void execute( MavenProject project, List goals, EventDispatcher eventDispatcher, File executionRootDirectory )
+    public void execute( MavenProject project, List goals, EventDispatcher eventDispatcher, File executionRootDirectory )
+   public List collectProjects( File basedir, String[] includes, String[] excludes )
+        throws MojoExecutionException
+    {
+        List projects = new ArrayList();
+
+        List poms = getPomFiles( basedir, includes, excludes );
+
+        for ( Iterator i = poms.iterator(); i.hasNext(); )
+        {
+            File pom = (File) i.next();
+
+            try
+            {
+                MavenProject p = readProject( pom );
+
+                projects.add( p );
+
+            }
+            catch (ProjectBuildingException e)
+            {
+                throw new MojoExecutionException( "Error loading " + pom, e );
+            }
+        }
+
+        return projects;
+    }
+
+    private List getPomFiles( File basedir, String[] includes, String[] excludes )
+    {
+        DirectoryScanner scanner = new DirectoryScanner();
+
+        scanner.setBasedir( basedir );
+
+        scanner.setIncludes( includes );
+
+        scanner.setExcludes( excludes );
+
+        scanner.scan();
+
+        List poms = new ArrayList();
+
+        for ( int i = 0; i < scanner.getIncludedFiles().length; i++ )
+        {
+            poms.add( new File( basedir, scanner.getIncludedFiles()[i] ) );
+        }
+
+        return poms;
+    }
+
