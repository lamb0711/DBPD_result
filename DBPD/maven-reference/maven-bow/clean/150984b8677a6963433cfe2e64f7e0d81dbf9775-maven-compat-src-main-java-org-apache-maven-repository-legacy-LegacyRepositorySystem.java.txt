[MNG-4991] LegacyRepositorySystem#injectProxy(repositories, proxies) doesn't evaluate non-proxy hosts


git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@1073990 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.wagon.proxy.ProxyInfo;
+import org.apache.maven.wagon.proxy.ProxyUtils;
-                    return proxy;
+                    if ( StringUtils.isNotEmpty( proxy.getNonProxyHosts() ) )
+                    {
+                        ProxyInfo pi = new ProxyInfo();
+                        pi.setNonProxyHosts( proxy.getNonProxyHosts() );
+
+                        org.apache.maven.wagon.repository.Repository repo =
+                            new org.apache.maven.wagon.repository.Repository( repository.getId(), repository.getUrl() );
+
+                        if ( !ProxyUtils.validateNonProxyHosts( pi, repo.getHost() ) )
+                        {
+                            return proxy;
+                        }
+                    }
+                    else
+                    {
+                        return proxy;
+                    }
