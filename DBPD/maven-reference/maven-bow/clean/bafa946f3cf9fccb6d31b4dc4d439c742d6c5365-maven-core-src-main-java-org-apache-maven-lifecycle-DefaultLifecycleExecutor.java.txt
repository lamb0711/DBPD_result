o Fixed handling of missing plugin version during calculation of execution plan

git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@821170 13f79535-47bb-0310-9956-ffa450edef68

-        RepositoryRequest repositoryRequest = getRepositoryRequest( session, null );
-
-                repositoryRequest.setRemoteRepositories( currentProject.getPluginArtifactRepositories() );
-                resolveMissingPluginVersions( currentProject.getBuildPlugins(), repositoryRequest );
-
+        resolveMissingPluginVersions( project, session );
+
-    private void resolveMissingPluginVersions( Collection<Plugin> plugins, RepositoryRequest repositoryRequest )
-        throws LifecycleExecutionException
+    private void resolveMissingPluginVersions( MavenProject project, MavenSession session )
+        throws PluginVersionResolutionException
-        for ( Plugin plugin : plugins )
+        for ( Plugin plugin : project.getBuildPlugins() )
-                try
-                {
-                    resolvePluginVersion( plugin, repositoryRequest );
-                }
-                catch ( PluginVersionResolutionException e )
-                {
-                    throw new LifecycleExecutionException( "Error resolving version for plugin " + plugin.getKey()
-                        + ": " + e.getMessage(), e );
-                }
+                PluginVersionRequest request = new DefaultPluginVersionRequest( plugin, session );
+                plugin.setVersion( pluginVersionResolver.resolve( request ).getVersion() );
