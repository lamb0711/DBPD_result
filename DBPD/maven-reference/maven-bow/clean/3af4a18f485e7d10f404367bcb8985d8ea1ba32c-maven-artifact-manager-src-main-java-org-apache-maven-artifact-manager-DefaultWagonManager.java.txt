PR: MNG-575
Submitted by: Jesse McConnell
Reviewed by:  Brett Porter
Add a way to configure permissions on deployed files

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@290660 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.wagon.repository.RepositoryPermissions;
+    private Map serverPermissionsMap = new HashMap();
+
-            wagon.connect( new Repository( repository.getId(), repository.getUrl() ),
-                           getAuthenticationInfo( repository.getId() ), getProxy( protocol ) );
+            Repository artifactRepository = new Repository( repository.getId(), repository.getUrl() );
+
+            if ( serverPermissionsMap.containsKey( repository.getId() ) )
+            {
+                RepositoryPermissions perms = (RepositoryPermissions) serverPermissionsMap.get( repository.getId() );
+                getLogger().debug(
+                    "adding permissions to wagon connection: " + perms.getFileMode() + " " + perms.getDirectoryMode() );
+                artifactRepository.setPermissions( perms );
+            }
+            else
+            {
+                getLogger().debug( "not adding permissions to wagon connection" );
+            }
+
+            wagon.connect( artifactRepository, getAuthenticationInfo( repository.getId() ), getProxy( protocol ) );
+
+    public void addPermissionInfo( String repositoryId, String filePermissions, String directoryPermissions )
+    {
+
+        RepositoryPermissions permissions = new RepositoryPermissions();
+        boolean addPermissions = false;
+
+        if ( filePermissions != null )
+        {
+            permissions.setFileMode( filePermissions );
+            addPermissions = true;
+        }
+
+        if ( directoryPermissions != null )
+        {
+            permissions.setDirectoryMode( directoryPermissions );
+            addPermissions = true;
+        }
+
+        if ( addPermissions )
+        {
+            serverPermissionsMap.put( repositoryId, permissions );
+        }
+    }
+
