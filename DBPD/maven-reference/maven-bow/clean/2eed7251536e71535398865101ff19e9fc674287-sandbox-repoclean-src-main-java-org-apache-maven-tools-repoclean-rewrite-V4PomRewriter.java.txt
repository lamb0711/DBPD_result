o Reworked the artifact parsing code for the legacy artifact discoverer.
o Getting OutOfMemoryError when running against ibiblio-v1.


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@163732 13f79535-47bb-0310-9956-ffa450edef68

-public class V4PomRewriter implements ArtifactPomRewriter
+public class V4PomRewriter
+    implements ArtifactPomRewriter
-    public void rewrite( Artifact artifact, File from, File to, Reporter reporter, boolean reportOnly  ) throws Exception
+    public void rewrite( Artifact artifact, File from, File to, Reporter reporter, boolean reportOnly )
+        throws Exception
-        
-        if(from.exists())
+
+        if ( from.exists() )
-                fromReader = new FileReader(from);
-                
+                fromReader = new FileReader( from );
+
-                
+
-                    reporter.error("Invalid v4 POM at \'" + from + "\'. Cannot read.", e);
+                    reporter.error( "Invalid v4 POM at \'" + from + "\'. Cannot read.", e );
-                IOUtil.close(fromReader);
+                IOUtil.close( fromReader );
-        
+
+        throws Exception
-        if(StringUtils.isEmpty( model.getModelVersion() ) )
+        if ( StringUtils.isEmpty( model.getModelVersion() ) )
-            reporter.info("Setting modelVersion on v4 model to \'4.0.0\'");
-            model.setModelVersion("4.0.0");
+            reporter.info( "Setting modelVersion on v4 model to \'4.0.0\'" );
+            model.setModelVersion( "4.0.0" );
-        
-        if(StringUtils.isEmpty(model.getGroupId()))
+
+        if ( StringUtils.isEmpty( model.getGroupId() ) )
-            reporter.info("Setting groupId on model using artifact information.");
-            model.setGroupId(artifact.getGroupId());
+            reporter.info( "Setting groupId on model using artifact information." );
+            model.setGroupId( artifact.getGroupId() );
-        
-        if(StringUtils.isEmpty(model.getArtifactId()))
+
+        if ( StringUtils.isEmpty( model.getArtifactId() ) )
-            reporter.info("Setting artifactId on model using artifact information.");
-            model.setArtifactId(artifact.getArtifactId());
+            reporter.info( "Setting artifactId on model using artifact information." );
+            model.setArtifactId( artifact.getArtifactId() );
-        
-        if(StringUtils.isEmpty(model.getVersion()))
+
+        if ( StringUtils.isEmpty( model.getVersion() ) )
-            reporter.info("Setting version on model using artifact information.");
-            model.setVersion(artifact.getVersion());
+            reporter.info( "Setting version on model using artifact information." );
+            model.setVersion( artifact.getVersion() );
-        
-        if(StringUtils.isEmpty(model.getPackaging()))
+
+        if ( StringUtils.isEmpty( model.getPackaging() ) )
-            reporter.info("Setting packaging on model using artifact type information.");
-            model.setPackaging(artifact.getType());
+            reporter.info( "Setting packaging on model using artifact type information." );
+            model.setPackaging( artifact.getType() );
-}
+}
