o Fixed project realm handling to be more embedder friendly

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@795206 13f79535-47bb-0310-9956-ffa450edef68

-        ArtifactResolutionResult result = repositorySystem.resolve( artifactRequest );
+        ArtifactResolutionResult result;
+
+        ClassLoader oldContextClassLoader = Thread.currentThread().getContextClassLoader();
+
+        try
+        {
+            if ( project.getClassRealm() != null )
+            {
+                Thread.currentThread().setContextClassLoader( project.getClassRealm() );
+            }
+
+            result = repositorySystem.resolve( artifactRequest );
+        }
+        finally
+        {
+            Thread.currentThread().setContextClassLoader( oldContextClassLoader );
+        }
