Moved legacy builder code to maven-mercury. Moved over interpolator code from model-builder to maven-project-builder to reduce the dependencies. Reduce the amount of parsing to and from model properties.

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@764568 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.maven.model.io.xpp3.MavenXpp3Writer;
-import org.apache.maven.project.builder.PomInterpolatorTag;
-import org.apache.maven.project.processor.ProcessorContext;
+import org.apache.maven.project.builder.ProcessorContext;
+import org.apache.maven.project.builder.interpolator.DomainModel;
+import org.apache.maven.project.builder.interpolator.InterpolatorProperty;
+import org.apache.maven.project.builder.interpolator.ModelProperty;
+import org.apache.maven.project.builder.interpolator.PomInterpolatorTag;
-import org.apache.maven.shared.model.DomainModel;
-import org.apache.maven.shared.model.InterpolatorProperty;
-import org.apache.maven.shared.model.ModelProperty;
-import org.codehaus.plexus.util.WriterFactory;
-        }      
+        }    
+        
-            	List<ModelProperty> mps = domainModel.getModelProperties();
-            	ProcessorContext.interpolateModelProperties( mps, interpolatorProperties, domainModel );
+            	//List<ModelProperty> mps = domainModel.getModelProperties();
+            	model = ProcessorContext.interpolateDomainModel( domainModel, interpolatorProperties ).getModel();
+            	/*
+
+            	*/
-            }   
+            }  
+            
-            domainModels.add( convertToDomainModel( getSuperModel(), false ) );
+            domainModels.add( new PomClassicDomainModel( getSuperModel(), false ) );
-    private static PomClassicDomainModel convertToDomainModel( Model model, boolean isMostSpecialized )
-        throws IOException
-    {
-        if ( model == null )
-        {
-            throw new IllegalArgumentException( "model: null" );
-        }
-        ByteArrayOutputStream baos = new ByteArrayOutputStream();
-        Writer out = null;
-        MavenXpp3Writer writer = new MavenXpp3Writer();
-        try
-        {
-            out = WriterFactory.newXmlWriter( baos );
-            writer.write( out, model );
-        }
-        finally
-        {
-            if ( out != null )
-            {
-                out.close();
-            }
-        }
-        return new PomClassicDomainModel( new ByteArrayInputStream( baos.toByteArray() ), isMostSpecialized );
-    }
-
