[MNG-2222] dependency to dependency without source code fails

git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@928058 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.maven.execution.BuildSuccess;
-import org.apache.maven.execution.MavenExecutionResult;
-//TODO: need phase information here to determine whether to hand back the classes/ or archive.
-    private MavenExecutionResult executionResult;
-
-        this.executionResult = ( session != null ) ? session.getResult() : null;
-                else if ( isProjectOutputValid( project ) )
+                else
-                    File classesDir;
+                    Collection<String> lifecyclePhases = project.getLifecyclePhases();
-                    if ( isTestArtifact( artifact ) )
+                    if ( !lifecyclePhases.contains( "package" ) )
-                        classesDir = new File( project.getBuild().getTestOutputDirectory() );
-                    }
-                    else
-                    {
-                        classesDir = new File( project.getBuild().getOutputDirectory() );
-                    }
-
-                    if ( classesDir.isDirectory() )
-                    {
-                        resolve( artifact, classesDir );
+                        if ( isTestArtifact( artifact ) )
+                        {
+                            if ( lifecyclePhases.contains( "test-compile" ) )
+                            {
+                                resolve( artifact, new File( project.getBuild().getTestOutputDirectory() ) );
+                            }
+                        }
+                        else
+                        {
+                            if ( lifecyclePhases.contains( "compile" ) )
+                            {
+                                resolve( artifact, new File( project.getBuild().getOutputDirectory() ) );
+                            }
+                        }
-     * Determines whether the output directories of the specified project have valid contents and can be used for
-     * artifact resolution.
-     * 
-     * @param project The project to check, must not be {@code null}.
-     * @return {@code true} if the output directories are valid, {@code false} otherwise.
-     */
-    private boolean isProjectOutputValid( MavenProject project )
-    {
-        return executionResult != null && executionResult.getBuildSummary( project ) instanceof BuildSuccess;
-    }
-
-    /**
