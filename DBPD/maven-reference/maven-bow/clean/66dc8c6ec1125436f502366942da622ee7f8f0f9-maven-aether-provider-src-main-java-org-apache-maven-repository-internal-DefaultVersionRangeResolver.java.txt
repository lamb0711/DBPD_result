code simplification
-import java.io.FileInputStream;
-import org.apache.maven.artifact.repository.metadata.io.xpp3.MetadataXpp3Reader;
-import org.codehaus.plexus.util.IOUtil;
-        FileInputStream fis = null;
-        try
+        if ( metadata != null )
-            if ( metadata != null )
+            SyncContext syncContext = syncContextFactory.newInstance( session, true );
+
+            try
-                SyncContext syncContext = syncContextFactory.newInstance( session, true );
+                syncContext.acquire( null, Collections.singleton( metadata ) );
-                try
-                {
-                    syncContext.acquire( null, Collections.singleton( metadata ) );
-
-                    if ( metadata.getFile() != null && metadata.getFile().exists() )
-                    {
-                        fis = new FileInputStream( metadata.getFile() );
-                        org.apache.maven.artifact.repository.metadata.Metadata m =
-                            new MetadataXpp3Reader().read( fis, false );
-                        versioning = m.getVersioning();
-                    }
-                }
-                finally
-                {
-                    syncContext.release();
-                }
+                versioning = DefaultVersionResolver.readMavenRepositoryMetadataVersioning( metadata.getFile() );
-        }
-        catch ( Exception e )
-        {
-            invalidMetadata( session, trace, metadata, repository, e );
-            result.addException( e );
-        }
-        finally
-        {
-            IOUtil.close( fis );
+            catch ( Exception e )
+            {
+                invalidMetadata( session, trace, metadata, repository, e );
+                result.addException( e );
+            }
+            finally
+            {
+                syncContext.release();
+            }
