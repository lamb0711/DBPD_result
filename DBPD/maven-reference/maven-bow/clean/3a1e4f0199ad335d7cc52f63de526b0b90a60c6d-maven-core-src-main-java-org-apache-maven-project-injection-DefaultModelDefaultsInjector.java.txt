clean up plugin configuration handling


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@163653 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.util.Xpp3DomUtils;
+import org.codehaus.plexus.util.xml.Xpp3Dom;
-                    // TODO: merge
-                    if ( localGoal.getConfiguration() == null )
-                    {
-                        localGoal.setConfiguration( defaultGoal.getConfiguration() );
-                    }
+                    Xpp3Dom goalConfiguration = (Xpp3Dom) localGoal.getConfiguration();
+                    Xpp3Dom defaultGoalConfiguration = (Xpp3Dom) defaultGoal.getConfiguration();
+                    localGoal.setConfiguration(
+                        Xpp3DomUtils.mergeXpp3Dom( goalConfiguration, defaultGoalConfiguration ) );
-        // TODO: merge
-        if ( plugin.getConfiguration() == null )
-        {
-            plugin.setConfiguration( def.getConfiguration() );
-        }
+        Xpp3Dom pluginConfiguration = (Xpp3Dom) plugin.getConfiguration();
+        Xpp3Dom defaultPluginConfiguration = (Xpp3Dom) def.getConfiguration();
+        plugin.setConfiguration( Xpp3DomUtils.mergeXpp3Dom( pluginConfiguration, defaultPluginConfiguration ) );
