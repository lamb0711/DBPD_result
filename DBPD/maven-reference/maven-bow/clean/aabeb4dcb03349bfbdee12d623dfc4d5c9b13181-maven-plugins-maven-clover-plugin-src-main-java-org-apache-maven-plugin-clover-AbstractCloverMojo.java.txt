MNG-618: We know make sure test coverage data is flushed before running the test coverage check.

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@328760 13f79535-47bb-0310-9956-ffa450edef68

-     * @parameter default-value="5000"
+     * @parameter default-value="500"
+
+    /**
+     * If true we'll wait 2*flushInterval to ensure coverage data is flushed to the Clover 
+     * database before running any query on it. 
+     * 
+     * Note: The only use case where you would want to turn this off is if you're running your 
+     * tests in a separate JVM. In that case the coverage data will be flushed by default upon
+     * the JVM shutdown and there would be no need to wait for the data to be flushed. As we
+     * can't control whether users want to fork their tests or not, we're offering this parameter
+     * to them.  
+     * 
+     * @parameter default-value="true"
+     */
+    protected boolean waitForFlush;
+    /**
+     * Wait 2*'flush interval' milliseconds to ensure that the coverage data have been flushed.
+     */
+    protected void waitForFlush()
+    {
+        if ( this.waitForFlush )
+        {
+            try
+            {
+                Thread.sleep( 2 * this.flushInterval );
+            }
+            catch ( InterruptedException e )
+            {
+                // Nothing to do... Just go on and try to check for coverage.
+            }
+        }
+    }
