[MNG-4461] [regression] No transfer progress during artifact deployment

git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@882668 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.execution.MavenSession;
+import org.apache.maven.plugin.LegacySupport;
+import org.apache.maven.repository.legacy.TransferListenerAdapter;
+import org.apache.maven.wagon.events.TransferListener;
+    @Requirement
+    private LegacySupport legacySupport;
+
-            wagonManager.putArtifact( source, artifact, deploymentRepository, null );
+            wagonManager.putArtifact( source, artifact, deploymentRepository, getTransferListener() );
+
+    private TransferListener getTransferListener()
+    {
+        MavenSession session = legacySupport.getSession();
+
+        if ( session == null )
+        {
+            return null;
+        }
+
+        return TransferListenerAdapter.newAdapter( session.getRequest().getTransferListener() );
+    }
+
