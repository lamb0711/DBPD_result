Refactored out restorer class and related MavenProjectBuilder methods.

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@694360 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.model.Model;
+import org.apache.maven.project.ModelUtils;
+import java.io.File;
-            try
-            {
-                mavenProjectBuilder.calculateConcreteState( project, session.getProjectBuilderConfiguration() );
-            }
-            catch ( ModelInterpolationException e )
-            {
-                throw new PluginManagerException( mojoDescriptor, project, "Failed to calculate concrete state for project.", e );
-            }
+            Model model = ModelUtils.cloneModel( project.getModel() );
+
+            File basedir = project.getBasedir();
+
+            Model model2 = ModelUtils.cloneModel( model );
+            pathTranslator.alignToBaseDirectory( model, basedir );
+            project.preserveBuild( model2.getBuild() );
+
+            project.setBuild( model.getBuild() );
+            project.setConcrete( true );
-        try
-        {
-            mavenProjectBuilder.restoreDynamicState( project, session.getProjectBuilderConfiguration() );
-        }
-        catch ( ModelInterpolationException e )
-        {
-            throw new PluginManagerException( mojoDescriptor, project, "Failed to restore dynamic state for project.", e );
-        }
+        project.setConcrete( false );
