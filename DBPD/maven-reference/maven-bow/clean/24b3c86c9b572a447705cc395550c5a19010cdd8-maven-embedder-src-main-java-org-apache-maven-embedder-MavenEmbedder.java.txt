MNG-2835 Make sure the global settings are obeyed when they are the only settings provided


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@512890 13f79535-47bb-0310-9956-ffa450edef68

+    public static final File DEFAULT_GLOBAL_SETTINGS_FILE = new File( System
+        .getProperty( "maven.home", System.getProperty( "user.dir", "" ) ), "conf/settings.xml" );
+
-                if ( configuration.getUserSettingsFile() == null )
-                {
-                    configuration.setUserSettingsFile( DEFAULT_USER_SETTINGS_FILE );
-                }
-
+
+                System.out.println( "settings.getLocalRepository() = " + settings.getLocalRepository() );
-        if ( configuration.getUserSettingsFile() == null )
-        {
-            configuration.setUserSettingsFile( MavenEmbedder.DEFAULT_USER_SETTINGS_FILE );
-        }
-
-        try
+        if ( configuration.getUserSettingsFile() != null )
-            fileReader = new FileReader( configuration.getUserSettingsFile() );
+            try
+            {
+                fileReader = new FileReader( configuration.getUserSettingsFile() );
-            new SettingsXpp3Reader().read( fileReader );
-        }
-        catch ( FileNotFoundException e )
-        {
-            result.setUserSettingsFilePresent( false );
-        }
-        catch ( IOException e )
-        {
-            result.setUserSettingsFileParses( false );
-        }
-        catch ( XmlPullParserException e )
-        {
-            result.setUserSettingsFileParses( false );
+                new SettingsXpp3Reader().read( fileReader );
+            }
+            catch ( FileNotFoundException e )
+            {
+                result.setUserSettingsFilePresent( false );
+            }
+            catch ( IOException e )
+            {
+                result.setUserSettingsFileParses( false );
+            }
+            catch ( XmlPullParserException e )
+            {
+                result.setUserSettingsFileParses( false );
+            }
