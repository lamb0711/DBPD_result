don't throw a runtime exception

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@219862 13f79535-47bb-0310-9956-ffa450edef68

+package org.apache.maven.plugin.clover;
+
- * Copyright 2005 The Apache Software Foundation.
+ * Copyright 2001-2005 The Apache Software Foundation.
-package org.apache.maven.plugin.clover;
-
-import org.apache.maven.plugin.MojoExecutionException;
-import org.apache.maven.plugin.AbstractMojo;
-import org.apache.tools.ant.Project;
-import org.apache.tools.ant.taskdefs.Taskdef;
+import org.apache.maven.plugin.MojoExecutionException;
+import org.apache.tools.ant.Project;
+import org.apache.tools.ant.BuildException;
+import org.apache.tools.ant.taskdefs.Taskdef;
- * @goal check
- * @phase verify
- * @execute phase="test" lifecycle="clover"
- * @description Verify test percentage coverage and fail the build if it is below the defined threshold
+ * Verify test percentage coverage and fail the build if it is below the defined threshold.
+ * @goal check
+ * @phase verify
+ * @execute phase="test" lifecycle="clover"
+ * *
-public class CloverCheckMojo extends AbstractCloverMojo
+public class CloverCheckMojo
+    extends AbstractCloverMojo
-	protected String cloverDatabase;
+    protected String cloverDatabase;
-    public void execute() throws MojoExecutionException
+    public void execute()
+        throws MojoExecutionException
-    private void registerCloverAntTasks(Project antProject)
+    private void registerCloverAntTasks( Project antProject )
-        Taskdef taskdef = (Taskdef) antProject.createTask("taskdef");
-        taskdef.setResource("clovertasks");
+        Taskdef taskdef = (Taskdef) antProject.createTask( "taskdef" );
+        taskdef.setResource( "clovertasks" );
-    
+
+        throws MojoExecutionException
-        
-        registerCloverAntTasks(antProject);
-        CloverPassTask cloverPassTask = (CloverPassTask) antProject.createTask("clover-check");
-        cloverPassTask.setInitString(this.cloverDatabase);
-        cloverPassTask.setHaltOnFailure(true);
-        cloverPassTask.setTarget(new Percentage(this.targetPercentage));
-        cloverPassTask.execute();
+        registerCloverAntTasks( antProject );
+
+        CloverPassTask cloverPassTask = (CloverPassTask) antProject.createTask( "clover-check" );
+        cloverPassTask.setInitString( this.cloverDatabase );
+        cloverPassTask.setHaltOnFailure( true );
+        cloverPassTask.setTarget( new Percentage( this.targetPercentage ) );
+        try
+        {
+            cloverPassTask.execute();
+        }
+        catch ( BuildException e )
+        {
+            // TODO: change to a failure, hopefully get a decent Java API out of them so we can get a better exception
+            throw new MojoExecutionException( e.getMessage(), e );
+        }
