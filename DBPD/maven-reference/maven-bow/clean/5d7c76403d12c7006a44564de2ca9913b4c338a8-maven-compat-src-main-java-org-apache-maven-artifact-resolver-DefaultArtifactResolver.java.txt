o Improved backward-compat

git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@1003515 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.regex.Matcher;
+import org.apache.maven.artifact.repository.metadata.Snapshot;
+import org.apache.maven.artifact.repository.metadata.SnapshotArtifactRepositoryMetadata;
+
+            if ( artifact.isSnapshot() )
+            {
+                Matcher matcher = Artifact.VERSION_FILE_PATTERN.matcher( artifact.getVersion() );
+                if ( matcher.matches() )
+                {
+                    Snapshot snapshot = new Snapshot();
+                    snapshot.setTimestamp( matcher.group( 2 ) );
+                    try
+                    {
+                        snapshot.setBuildNumber( Integer.parseInt( matcher.group( 3 ) ) );
+                        artifact.addMetadata( new SnapshotArtifactRepositoryMetadata( artifact, snapshot ) );
+                    }
+                    catch ( NumberFormatException e )
+                    {
+                        logger.warn( "Invalid artifact version " + artifact.getVersion() + ": " + e.getMessage() );
+                    }
+                }
+            }
