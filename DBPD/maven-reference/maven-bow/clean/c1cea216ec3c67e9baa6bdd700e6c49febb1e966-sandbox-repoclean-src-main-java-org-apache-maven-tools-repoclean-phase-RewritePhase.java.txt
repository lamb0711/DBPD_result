add metadata for new artifact

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@290357 13f79535-47bb-0310-9956-ffa450edef68

+        boolean changed = false;
+        Metadata targetMetadata = null;
+
-            Metadata targetMetadata = null;
-
-            boolean changed = targetMetadata.merge( sourceMetadata );
-
-            if ( changed )
+            changed = targetMetadata.merge( sourceMetadata );
+        }
+        else
+        {
+            changed = true;
+            targetMetadata = sourceMetadata;
+        }
+        if ( changed )
+        {
+            Writer writer = null;
+            try
-                Writer writer = null;
-                try
+                target.getParentFile().mkdirs();
+                writer = new FileWriter( target );
+
+                MetadataXpp3Writer mappingWriter = new MetadataXpp3Writer();
+
+                mappingWriter.write( writer, targetMetadata );
+
+                if ( !reportOnly )
-                    target.getParentFile().mkdirs();
-                    writer = new FileWriter( target );
-
-                    MetadataXpp3Writer mappingWriter = new MetadataXpp3Writer();
-
-                    mappingWriter.write( writer, targetMetadata );
-
-                    if ( !reportOnly )
-                    {
-                        File digestFile = artifactDigestor.getDigestFile( target, Digestor.MD5 );
-                        artifactDigestor.createArtifactDigest( target, digestFile, Digestor.MD5 );
-                        digestFile = artifactDigestor.getDigestFile( target, Digestor.SHA );
-                        artifactDigestor.createArtifactDigest( target, digestFile, Digestor.SHA );
-                    }
+                    File digestFile = artifactDigestor.getDigestFile( target, Digestor.MD5 );
+                    artifactDigestor.createArtifactDigest( target, digestFile, Digestor.MD5 );
+                    digestFile = artifactDigestor.getDigestFile( target, Digestor.SHA );
+                    artifactDigestor.createArtifactDigest( target, digestFile, Digestor.SHA );
-                finally
-                {
-                    IOUtil.close( writer );
-                }
+            }
+            finally
+            {
+                IOUtil.close( writer );
