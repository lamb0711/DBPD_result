PR: MNG-950
use active project artifacts for extensions and plugin dependencies

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@307245 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.maven.artifact.metadata.ArtifactMetadata;
-import java.util.Map;
-                                       ArtifactFilter dependencyFilter, Map projectReferences )
+                                       ArtifactFilter dependencyFilter, MavenProject project )
-                if ( projectReferences != null )
+                if ( project != null )
-                    // TODO: use MavenProject getProjectReferenceId
-                    String refId = d.getGroupId() + ":" + d.getArtifactId();
-                    MavenProject project = (MavenProject) projectReferences.get( refId );
-                    if ( project != null && project.getArtifact() != null )
-                    {
-                        // TODO: if not matching, we should get the correct artifact from that project (attached)
-                        if ( project.getArtifact().getDependencyConflictId().equals(
-                            artifact.getDependencyConflictId() ) )
-                        {
-                            artifact = new ActiveProjectArtifact( project, artifact );
-                        }
-                    }
+                    artifact = project.replaceWithActiveArtifact( artifact );
-    private Metadata loadMetadata( ArtifactMetadata repoMetadata, ArtifactRepository remoteRepository,
-                                   ArtifactRepository localRepository )
-        throws ArtifactMetadataRetrievalException
-    {
-        File metadataFile = new File( localRepository.getBasedir(),
-                                      localRepository.pathOfLocalRepositoryMetadata( repoMetadata, remoteRepository ) );
-
-        Metadata metadata = null;
-        if ( metadataFile.exists() )
-        {
-            metadata = readMetadata( metadataFile );
-        }
-        return metadata;
-    }
-
