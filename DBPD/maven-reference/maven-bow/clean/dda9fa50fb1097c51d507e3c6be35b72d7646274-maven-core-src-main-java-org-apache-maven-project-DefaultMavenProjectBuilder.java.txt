cache POMs within the reactor


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@163571 13f79535-47bb-0310-9956-ffa450edef68

-    
+
-    
+
+    private final Map projectCache = new HashMap();
+
+        projectCache.put( createCacheKey( project.getGroupId(), project.getArtifactId(), project.getVersion() ),
+                          project );
+
-            File parentPom = findParentModel( parentModel, aggregatedRemoteWagonRepositories, localRepository );
+            MavenProject parent = getCachedProject( parentModel.getGroupId(), parentModel.getArtifactId(),
+                                                    parentModel.getVersion() );
+            if ( parent == null )
+            {
+                File parentPom = findParentModel( parentModel, aggregatedRemoteWagonRepositories, localRepository );
-            MavenProject parent = assembleLineage( parentPom, localRepository, lineage,
-                                                   aggregatedRemoteWagonRepositories );
-
+                parent = assembleLineage( parentPom, localRepository, lineage, aggregatedRemoteWagonRepositories );
+            }
-    private List buildArtifactRepositories( List repositories ) throws ProjectBuildingException
+    private List buildArtifactRepositories( List repositories )
+        throws ProjectBuildingException
-        
+
+    public MavenProject getCachedProject( String groupId, String artifactId, String version )
+    {
+        return (MavenProject) projectCache.get( createCacheKey( groupId, artifactId, version ) );
+    }
+
+    private static String createCacheKey( String groupId, String artifactId, String version )
+    {
+        return groupId + ":" + artifactId + ":" + version;
+    }
+
