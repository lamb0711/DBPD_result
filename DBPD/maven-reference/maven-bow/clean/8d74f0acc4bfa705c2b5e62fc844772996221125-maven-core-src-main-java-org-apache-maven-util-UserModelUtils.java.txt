o Added user.xml as the central point of config for local repository, both in MBoot2 and maven proper.
o Added proxy-profile support to user.xml


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@163510 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.model.user.DefaultProfiles;
+import org.apache.maven.model.user.MavenProfile;
+import org.apache.maven.model.user.ProxyProfile;
+    private static final String ACTIVE_MAVEN_PROFILE_ID_ENVAR = "maven.profile";
+
+    public static MavenProfile getActiveMavenProfile( UserModel userModel )
+    {
+        String activeProfileId = System.getProperty( ACTIVE_MAVEN_PROFILE_ID_ENVAR );
+        if ( activeProfileId == null || activeProfileId.trim().length() < 1 )
+        {
+            DefaultProfiles defaults = userModel.getDefaultProfiles();
+            if ( defaults != null )
+            {
+                activeProfileId = defaults.getMavenProfileId();
+            }
+        }
+
+        MavenProfile activeProfile = null;
+
+        if ( activeProfileId != null && activeProfileId.trim().length() > 0 )
+        {
+            activeProfile = UserModelUtils.getMavenProfile( userModel, activeProfileId );
+        }
+
+        return activeProfile;
+    }
+
+    public static ProxyProfile getActiveProxyProfile( UserModel userModel )
+    {
+        String activeProfileId = System.getProperty( ACTIVE_MAVEN_PROFILE_ID_ENVAR );
+        if ( activeProfileId == null || activeProfileId.trim().length() < 1 )
+        {
+            DefaultProfiles defaults = userModel.getDefaultProfiles();
+            if ( defaults != null )
+            {
+                activeProfileId = defaults.getProxyProfileId();
+            }
+        }
+
+        ProxyProfile activeProfile = null;
+
+        if ( activeProfileId != null && activeProfileId.trim().length() > 0 )
+        {
+            activeProfile = UserModelUtils.getProxyProfile( userModel, activeProfileId );
+        }
+
+        return activeProfile;
+    }
+
+    public static MavenProfile getMavenProfile( UserModel userModel, String mavenProfileId )
+    {
+        MavenProfile result = null;
+
+        List mavenProfiles = userModel.getMavenProfiles();
+        if ( mavenProfiles != null )
+        {
+            for ( Iterator it = mavenProfiles.iterator(); it.hasNext(); )
+            {
+                MavenProfile profile = (MavenProfile) it.next();
+                if ( mavenProfileId.equals( profile.getId() ) )
+                {
+                    result = profile;
+                    break;
+                }
+            }
+        }
+
+        return result;
+    }
+
+    public static ProxyProfile getProxyProfile( UserModel userModel, String proxyProfileId )
+    {
+        ProxyProfile result = null;
+
+        List proxyProfile = userModel.getProxyProfiles();
+        if ( proxyProfile != null )
+        {
+            for ( Iterator it = proxyProfile.iterator(); it.hasNext(); )
+            {
+                ProxyProfile profile = (ProxyProfile) it.next();
+                if ( proxyProfileId.equals( profile.getId() ) )
+                {
+                    result = profile;
+                    break;
+                }
+            }
+        }
+
+        return result;
+    }
+
