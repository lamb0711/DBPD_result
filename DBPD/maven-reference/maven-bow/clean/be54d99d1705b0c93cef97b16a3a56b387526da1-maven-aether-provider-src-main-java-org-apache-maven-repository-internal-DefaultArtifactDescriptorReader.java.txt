o Dispatched repository events via dedicated component

git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@1180679 13f79535-47bb-0310-9956-ffa450edef68

-import org.sonatype.aether.RepositoryListener;
+import org.sonatype.aether.impl.RepositoryEventDispatcher;
+    private RepositoryEventDispatcher repositoryEventDispatcher;
+
+    @Requirement
+        setRepositoryEventDispatcher( locator.getService( RepositoryEventDispatcher.class ) );
+    public DefaultArtifactDescriptorReader setRepositoryEventDispatcher( RepositoryEventDispatcher repositoryEventDispatcher )
+    {
+        if ( repositoryEventDispatcher == null )
+        {
+            throw new IllegalArgumentException( "repository event dispatcher has not been specified" );
+        }
+        this.repositoryEventDispatcher = repositoryEventDispatcher;
+        return this;
+    }
+
-        RepositoryListener listener = session.getRepositoryListener();
-        if ( listener != null )
-        {
-            DefaultRepositoryEvent event =
-                new DefaultRepositoryEvent( EventType.ARTIFACT_DESCRIPTOR_MISSING, session, trace );
-            event.setArtifact( artifact );
-            event.setException( exception );
-            listener.artifactDescriptorMissing( event );
-        }
+        DefaultRepositoryEvent event =
+            new DefaultRepositoryEvent( EventType.ARTIFACT_DESCRIPTOR_MISSING, session, trace );
+        event.setArtifact( artifact );
+        event.setException( exception );
+
+        repositoryEventDispatcher.dispatch( event );
-        RepositoryListener listener = session.getRepositoryListener();
-        if ( listener != null )
-        {
-            DefaultRepositoryEvent event =
-                new DefaultRepositoryEvent( EventType.ARTIFACT_DESCRIPTOR_INVALID, session, trace );
-            event.setArtifact( artifact );
-            event.setException( exception );
-            listener.artifactDescriptorInvalid( event );
-        }
+        DefaultRepositoryEvent event =
+            new DefaultRepositoryEvent( EventType.ARTIFACT_DESCRIPTOR_INVALID, session, trace );
+        event.setArtifact( artifact );
+        event.setException( exception );
+
+        repositoryEventDispatcher.dispatch( event );
