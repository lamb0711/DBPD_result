Adding more unit tests for error reporting. Almost done with project-based errors now.

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@612333 13f79535-47bb-0310-9956-ffa450edef68

-        List activeProfiles;
+        List activeProfiles = new ArrayList();
-            activeProfiles = profileAdvisor.applyActivatedExternalProfiles( superModel, null, profileManager );
-        }
-        else
-        {
-            activeProfiles = Collections.EMPTY_LIST;
+            List activated = profileAdvisor.applyActivatedProfiles( superModel, null, false, profileManager.getProfileActivationContext() );
+            if ( !activated.isEmpty() )
+            {
+                activeProfiles.addAll( activated );
+            }
+
+            activated = profileAdvisor.applyActivatedExternalProfiles( superModel, null, profileManager );
+            if ( !activated.isEmpty() )
+            {
+                activeProfiles.addAll( activated );
+            }
-        List activated = profileAdvisor.applyActivatedExternalProfiles( superModel, projectDescriptor, externalProfileManager );
+        List activated = profileAdvisor.applyActivatedProfiles( superModel, projectDescriptor, validProfilesXmlLocation, profileActivationContext );
-        activated = profileAdvisor.applyActivatedProfiles( superModel, projectDescriptor, validProfilesXmlLocation, profileActivationContext );
+        activated = profileAdvisor.applyActivatedExternalProfiles( superModel, projectDescriptor, externalProfileManager );
