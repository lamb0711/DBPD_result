o Improving some error reporting.


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@163484 13f79535-47bb-0310-9956-ffa450edef68

+import java.io.File;
+import java.io.FileNotFoundException;
+import java.io.FileReader;
+import java.io.IOException;
+import java.io.InputStreamReader;
+import java.net.URL;
+import java.util.ArrayList;
+import java.util.HashMap;
+import java.util.Iterator;
+import java.util.LinkedList;
+import java.util.List;
+import java.util.Map;
+import java.util.Set;
+
+
-import org.codehaus.plexus.util.IOUtil;
-import java.io.File;
-import java.io.FileNotFoundException;
-import java.io.FileReader;
-import java.io.InputStreamReader;
-import java.io.Reader;
-import java.util.ArrayList;
-import java.util.HashMap;
-import java.util.Iterator;
-import java.util.LinkedList;
-import java.util.List;
-import java.util.Map;
-import java.util.Set;
-
+/**
+ * @version $Id$
+ */
-    private Model readModel( File projectDescriptor )
+    private Model readModel( File file )
-            return readModel( new FileReader( projectDescriptor ) );
+            return modelReader.read( new FileReader( file ) );
-        catch ( FileNotFoundException ex )
+        catch ( FileNotFoundException e )
-            throw new ProjectBuildingException( "Error while building model.", ex );
+            throw new ProjectBuildingException( "Could not find the model file '" + file.getAbsolutePath() + "'." );
+        }
+        catch ( Exception e )
+        {
+            throw new ProjectBuildingException( "Error while reading model from file '" + file.getAbsolutePath() + "'.", e );
-    private Model readModel( Reader reader )
+    private Model readModel( URL url )
-            return modelReader.read( reader );
+            return modelReader.read( new InputStreamReader( url.openStream() ) );
+        }
+        catch ( IOException e )
+        {
+            throw new ProjectBuildingException( "Error while reading model.", e );
-            throw new ProjectBuildingException( "Error while building model.", ex );
-        }
-        finally
-        {
-            IOUtil.close( reader );
+            throw new ProjectBuildingException( "Error while building model from " + url.toExternalForm(), ex );
-        return readModel( new InputStreamReader( DefaultMavenProjectBuilder.class.getResourceAsStream(
-            "pom-" + MavenConstants.MAVEN_MODEL_VERSION + ".xml" ) ) );
+        URL url = DefaultMavenProjectBuilder.class.getResource( "pom-" + MavenConstants.MAVEN_MODEL_VERSION + ".xml" );
+
+        return readModel( url );
-}
+}
