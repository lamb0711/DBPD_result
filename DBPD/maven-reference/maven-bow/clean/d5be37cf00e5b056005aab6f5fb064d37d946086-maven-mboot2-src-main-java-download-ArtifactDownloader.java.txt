PR: MNG-232
resolve snapshots in bootstrap


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@163931 13f79535-47bb-0310-9956-ffa450edef68

+import util.FileUtils;
+import java.io.IOException;
-                boolean snapshot = dep.getVersion().indexOf( SNAPSHOT_SIGNATURE ) >= 0;
+                boolean snapshot = isSnapshot( dep );
+    private static boolean isSnapshot( Dependency dep )
+    {
+        return dep.getVersion().indexOf( SNAPSHOT_SIGNATURE ) >= 0;
+    }
+
+                if ( isSnapshot( dep ) )
+                {
+                    String filename = getSnapshotMetadataFile( destinationFile.getPath(), "SNAPSHOT.version.txt" );
+                    String metaUrl = getSnapshotMetadataFile( url, "SNAPSHOT.version.txt" );
+                    log( "Downloading " + metaUrl );
+                    try
+                    {
+                        HttpUtils.getFile( metaUrl, new File( filename ), ignoreErrors, useTimestamp, proxyHost,
+                                           proxyPort, proxyUserName, proxyPassword, true );
+                        String version = FileUtils.fileRead( filename );
+                        log( "Resolved version: " + version );
+                        version = version.substring( version.lastIndexOf( "-", version.lastIndexOf( "-" ) - 1 ) + 1 );
+                        String extension = url.substring( url.length() - 4 );
+                        url = getSnapshotMetadataFile( url, version + extension );
+                    }
+                    catch ( IOException e )
+                    {
+                        log( "WARNING: SNAPSHOT version not found, using default" );
+                    }
+                }
+
+    private static String getSnapshotMetadataFile( String filename, String s )
+    {
+        int index = filename.lastIndexOf( "SNAPSHOT" );
+        return filename.substring( 0, index ) + s;
+    }
+
