[MNG-4410] [regression] Maven execution does not end after showing usage help
[MNG-4411] [regression] Maven execution does not stop after showing version


git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@830142 13f79535-47bb-0310-9956-ffa450edef68

-    private enum Exit { EXIT_WITHOUT_ERROR, EXIT_WITH_ERROR }
-    
-        
+
+        catch( ExitException e )
+        {
+            return e.exitCode;
+        }
-        {            
+        {
-        }       
+        }
-        }                               
+        }
-        }        
+        }
-    {   
+    {
+        throws Exception
-            cliRequest.exit = Exit.EXIT_WITH_ERROR;
+            throw e;
-            cliRequest.exit = Exit.EXIT_WITHOUT_ERROR;
+            throw new ExitException( 0 );
-            cliRequest.exit = Exit.EXIT_WITHOUT_ERROR;
-        }        
-    }    
+            throw new ExitException( 0 );
+        }
+    }
-    }   
+    }
-    }    
+    }
+
+            throw new ExitException( 0 );
-                cliRequest.stderr.println( "Master password is not set in the setting security file." );
+                throw new IllegalStateException( "Master password is not set in the setting security file: " + file );
+
+            throw new ExitException( 0 );
-    {    
+    {
-        Exit exit;
-        }        
-    }    
+        }
+    }
+
+    static class ExitException
+        extends Exception
+    {
+
+        public int exitCode;
+
+        public ExitException( int exitCode )
+        {
+            this.exitCode = exitCode;
+        }
+
+    }
+
