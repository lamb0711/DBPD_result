isolate path generation in Repository class


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@163753 13f79535-47bb-0310-9956-ffa450edef68

+import model.Repository;
-    private File mavenRepoLocal;
-
-    public ArtifactDownloader( String localRepository, List remoteRepositories )
+    private Repository localRepository;
+
+    public ArtifactDownloader( Repository localRepository, List remoteRepositories )
-        mavenRepoLocal = new File( localRepository );
+        this.localRepository = localRepository;
-        if ( !mavenRepoLocal.exists() )
-        {
-            if ( !mavenRepoLocal.mkdirs() )
-            {
-                System.err.println( "Cannot create the specified local repository: " + mavenRepoLocal );
-
-                System.exit( 1 );
-            }
-        }
-
-        if ( !mavenRepoLocal.canWrite() )
-        {
-            System.err.println( "Can't write to " + mavenRepoLocal.getAbsolutePath() );
-
-            System.exit( 1 );
-        }
-
-        System.out.println( "Using the following for your local repository: " + mavenRepoLocal );
+        System.out.println( "Using the following for your local repository: " + localRepository );
-    public File getMavenRepoLocal()
-    {
-        return mavenRepoLocal;
-    }
-
-                String repositoryPath = dep.getRepositoryPath();
-                File destinationFile = new File( mavenRepoLocal, repositoryPath );
+                File destinationFile = localRepository.getArtifactFile( dep );
-                getRemoteArtifact( repositoryPath, destinationFile );
+                getRemoteArtifact( dep, destinationFile );
-            remoteRepos.add( "http://repo1.maven.org" );
+            // TODO: configure layout
+            remoteRepos.add( new Repository( "http://repo1.maven.org", Repository.LAYOUT_LEGACY ) );
-    private List getRemoteRepos()
-    {
-        return remoteRepos;
-    }
-
-    private boolean getRemoteArtifact( String file, File destinationFile )
+    private boolean getRemoteArtifact( Dependency dep, File destinationFile )
-        for ( Iterator i = getRemoteRepos().iterator(); i.hasNext(); )
+        for ( Iterator i = remoteRepos.iterator(); i.hasNext(); )
-            String remoteRepo = (String) i.next();
+            Repository remoteRepo = (Repository) i.next();
-            String url = remoteRepo + "/" + file;
+            String url = remoteRepo.getArtifactPath( dep );
