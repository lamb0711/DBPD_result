tests and repairs for scope


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@163486 13f79535-47bb-0310-9956-ffa450edef68

-                artifacts = createArtifacts( project.getDependencies(), localRepository );
+                artifacts = createArtifacts( project.getDependencies(), artifact.getScope(), localRepository );
-                artifacts = createArtifacts( model.getDependencies(), localRepository );
+                artifacts = createArtifacts( model.getDependencies(), artifact.getScope(), localRepository );
-    public Set createArtifacts( List dependencies, ArtifactRepository localRepository )
+    protected Set createArtifacts( List dependencies, String scope, ArtifactRepository localRepository )
-            Artifact artifact = createArtifact( d, localRepository );
+            Artifact artifact = createArtifact( d, scope, localRepository );
-    public Artifact createArtifact( Dependency dependency, ArtifactRepository localRepository )
+    protected Artifact createArtifact( Dependency dependency, String scope, ArtifactRepository localRepository )
-                                                 dependency.getScope(),
+                                                 transitiveScope( dependency.getScope(), scope ),
+
+    private String transitiveScope( String desiredScope, String artifactScope )
+    {
+        // TODO: scope handler
+        if ( Artifact.SCOPE_TEST.equals( artifactScope ) || Artifact.SCOPE_TEST.equals( desiredScope ) )
+        {
+            return Artifact.SCOPE_TEST;
+        }
+        else
+        {
+            return Artifact.SCOPE_RUNTIME;
+        }
+    }
