Merge of sisbell-maven-2.1-profile branch. Removes use of project lineage from builder.

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@693332 13f79535-47bb-0310-9956-ffa450edef68

+        private static String findBaseUriFrom( List<ModelProperty> modelProperties )
+        {
+            String baseUri = null;
+            for ( ModelProperty mp : modelProperties )
+            {
+                if ( baseUri == null || mp.getUri().length() < baseUri.length() )
+                {
+                    baseUri = mp.getUri();
+                }
+            }
+            return baseUri;
+        }
+
+            String uri = findBaseUriFrom( this.properties );
-            for ( ModelProperty mp : properties )
+            for ( ModelProperty mp : this.properties )
-                if ( mp.getUri().endsWith( "version" ) )
+                if ( version == null && mp.getUri().equals( uri + "/version" ) )
-                else if ( mp.getUri().endsWith( "artifactId" ) )
+                else if ( artifactId == null && mp.getUri().equals( uri + "/artifactId" ) )
-                else if ( mp.getUri().endsWith( "groupId" ) )
+                else if ( groupId == null && mp.getUri().equals( uri + "/groupId" ) )
-                else if ( mp.getUri().equals( ProjectUri.Dependencies.Dependency.type ) )
+                else if ( mp.getUri().equals( ProjectUri.Dependencies.Dependency.type ) && type == null )
-                throw new IllegalArgumentException(
-                    "Properties does not contain artifact id. Group ID = " + groupId + ", Version = " + version );
+                StringBuffer sb = new StringBuffer();
+                for ( ModelProperty mp : properties )
+                {
+                    sb.append( mp ).append( "\r\n" );
+                }
+                throw new IllegalArgumentException( "Properties does not contain artifact id. Group ID = " + groupId +
+                    ", Version = " + version + ":" + sb );
