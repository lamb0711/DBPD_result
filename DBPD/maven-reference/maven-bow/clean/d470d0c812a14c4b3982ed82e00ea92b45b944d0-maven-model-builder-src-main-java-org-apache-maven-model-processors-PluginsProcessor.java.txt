[MNG-0051] - This test was broken due to an unrelated issue on plugin management inheritance. Fixed it and added some unit tests.

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@767266 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.maven.model.Dependency;
-import org.apache.maven.model.Model;
-                for ( Plugin d1 : c)
+                for ( Plugin childPlugin : c)
-                    for ( Plugin d2 : p)
+                    for ( Plugin parentPlugin : p)
-                        if ( match( d1, d2 ) )
+                        if ( match( childPlugin, parentPlugin ) )
-                            processor.process( d2, d1, plugins, isChildMostSpecialized );// JOIN
+                            processor.process( parentPlugin, childPlugin, plugins, isChildMostSpecialized );// JOIN
-                            processor.process( null, d1, plugins, isChildMostSpecialized );
-                            parentDependencies.add( d2 );
+                            processor.process( null, childPlugin, plugins, isChildMostSpecialized );
+                            if(!parentDependencies.contains(parentPlugin))
+                            	{
+                            	parentDependencies.add( parentPlugin );
+                            }
-
+                
+                /**
+                 * Process Parents after child to keep plugin order but don't want to overwrite the child values. Use different method
+                 */
-                    processor.process( d2, null, plugins, isChildMostSpecialized );
+                    processor.process( d2, plugins, isChildMostSpecialized );
+                
-        sb.append( d.getGroupId() ).append( ":" ).append( d.getArtifactId() ).append( ":" );
+        sb.append( (d.getGroupId() != null) ? d.getGroupId() : "org.apache.maven.plugins").append( ":" ).append( d.getArtifactId() ).append( ":" );
