o merging from my branch to trunk


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@699806 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.maven.monitor.event.MavenWorkspaceMonitor;
-import org.apache.maven.monitor.event.PerCallWorkspaceMonitor;
-import org.apache.maven.workspace.MavenWorkspaceStore;
-    private MavenWorkspaceStore workspaceManager;
-
-        workspaceMonitor( request, configuration );
-
-    private void workspaceMonitor( MavenExecutionRequest request,
-                                   Configuration configuration )
-    {
-        MavenWorkspaceMonitor workspaceMonitor = request.getWorkspaceMonitor();
-
-        if ( workspaceMonitor == null )
-        {
-            workspaceMonitor = configuration.getWorkspaceMonitor();
-        }
-
-        List requestEventMonitors = request.getEventMonitors();
-        if ( ( requestEventMonitors != null ) && !requestEventMonitors.isEmpty() )
-        {
-            for ( Iterator it = requestEventMonitors.iterator(); it.hasNext(); )
-            {
-                Object monitor = it.next();
-                if ( monitor instanceof MavenWorkspaceMonitor )
-                {
-                    if ( workspaceMonitor == null )
-                    {
-                        workspaceMonitor = (MavenWorkspaceMonitor) monitor;
-                    }
-                    it.remove();
-                    break;
-                }
-            }
-        }
-
-        if ( workspaceMonitor == null )
-        {
-            workspaceMonitor = new PerCallWorkspaceMonitor();
-        }
-
-        workspaceMonitor.setWorkspaceStore( workspaceManager );
-
-        request.addEventMonitor( workspaceMonitor );
-    }
-
