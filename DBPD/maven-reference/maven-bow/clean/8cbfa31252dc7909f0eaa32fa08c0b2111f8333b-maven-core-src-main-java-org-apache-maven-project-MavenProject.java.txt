o Restored API backward compat with 2.x and polished some code

git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@1054693 13f79535-47bb-0310-9956-ffa450edef68

+        repositorySystem = project.repositorySystem;
+        logger = project.logger;
+        mavenProjectBuilder = project.mavenProjectBuilder;
+        projectBuilderConfiguration = project.projectBuilderConfiguration;
+    public void setPluginArtifacts( Set<Artifact> pluginArtifacts )
+    {
+        this.pluginArtifacts = pluginArtifacts;
+
+        this.pluginArtifactMap = null;
+    }
+
+
+
-            List<Plugin> plugins = getBuildPlugins();
-            for ( Iterator<Plugin> i = plugins.iterator(); i.hasNext(); )
+            for ( Plugin p : getBuildPlugins() )
-                Plugin p = (Plugin) i.next();
-
-                String version;
-                if ( StringUtils.isEmpty( p.getVersion() ) )
-                {
-                    version = "RELEASE";
-                }
-                else
-                {
-                    version = p.getVersion();
-                }
-
-                if ( artifact == null )
-                {
-                    return pluginArtifacts;
-                }
-                else
+                if ( artifact != null )
+
+
-        pluginArtifactMap = ArtifactUtils.artifactMapByVersionlessId( getPluginArtifacts() );
+        if ( pluginArtifactMap == null )
+        {
+            pluginArtifactMap = ArtifactUtils.artifactMapByVersionlessId( getPluginArtifacts() );
+        }
+
-        List<ReportPlugin> reports = getReportPlugins();
-        if ( reports != null )
+
+        if ( repositorySystem != null )
-            for ( Iterator<ReportPlugin> i = reports.iterator(); i.hasNext(); )
+            for ( ReportPlugin p : getReportPlugins() )
-                ReportPlugin p = (ReportPlugin) i.next();
-
-                String version;
-                if ( StringUtils.isEmpty( p.getVersion() ) )
-                {
-                    version = "RELEASE";
-                }
-                else
-                {
-                    version = p.getVersion();
-                }
-
-                pp.setVersion( version );
+                pp.setVersion( p.getVersion() );
+
+
+
+        if ( project.getPluginArtifacts() != null )
+        {
+            setPluginArtifacts( Collections.unmodifiableSet( project.getPluginArtifacts() ) );
+        }
+
