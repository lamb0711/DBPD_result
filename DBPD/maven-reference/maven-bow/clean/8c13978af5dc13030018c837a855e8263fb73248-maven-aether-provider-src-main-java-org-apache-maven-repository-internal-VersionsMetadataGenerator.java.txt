o Fixed duplicate processig of g:a-level metadata

git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@990769 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.Iterator;
+    private Map<Object, VersionsMetadata> processedVersions;
+
+        processedVersions = new LinkedHashMap<Object, VersionsMetadata>();
-         * same timestamp+buildno for the snapshot versions. Allowing the caller to pass in metadata from a previous
-         * deployment allows to re-establish the association between the artifacts of the same project.
+         * same version index. Allowing the caller to pass in metadata from a previous deployment allows to re-establish
+         * the association between the artifacts of the same project.
-        for ( Metadata metadata : metadatas )
+        for ( Iterator<? extends Metadata> it = metadatas.iterator(); it.hasNext(); )
+            Metadata metadata = it.next();
+                it.remove();
-                versions.put( versionsMetadata.getKey(), versionsMetadata );
+                processedVersions.put( versionsMetadata.getKey(), versionsMetadata );
-            VersionsMetadata versionsMetadata = versions.get( key );
-            if ( versionsMetadata == null )
+            if ( processedVersions.get( key ) == null )
-                versionsMetadata = new VersionsMetadata( artifact );
-                versions.put( key, versionsMetadata );
+                VersionsMetadata versionsMetadata = versions.get( key );
+                if ( versionsMetadata == null )
+                {
+                    versionsMetadata = new VersionsMetadata( artifact );
+                    versions.put( key, versionsMetadata );
+                }
