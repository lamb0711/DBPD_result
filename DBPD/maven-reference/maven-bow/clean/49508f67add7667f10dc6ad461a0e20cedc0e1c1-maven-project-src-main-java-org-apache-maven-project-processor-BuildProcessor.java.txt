[MNG-3899] - Inheritance does not merge extensions with same gid and aid

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@758487 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.model.Dependency;
-        }        
-          
+        }   
+        /*
+        List<Dependency> childDependencies = 
+            new ArrayList<Dependency>(dependencies.subList( length - 1 , dependencies.size() ) );
+        dependencies.removeAll( childDependencies );
+        dependencies.addAll( 0, childDependencies );   
+        */
+        int i = target.getExtensions().size();
+        
+        List<Extension> m = new ArrayList<Extension>();
-            Extension e = new Extension();
-            e.setArtifactId( extension.getArtifactId() );
-            e.setGroupId( extension.getGroupId() );
-            e.setVersion( extension.getVersion() );
-            target.addExtension( e );
-        }
+            Extension match = isMatch(extension, target.getExtensions());
+            if(match != null)
+            {
+                match.setArtifactId( extension.getArtifactId() );
+                match.setGroupId( extension.getGroupId() );
+                match.setVersion( extension.getVersion() );  
+                m.add( match );
+            }
+            else
+            {
+                Extension e = new Extension();
+                e.setArtifactId( extension.getArtifactId() );
+                e.setGroupId( extension.getGroupId() );
+                e.setVersion( extension.getVersion() );
+                m.add( e );
+               // target.addExtension( e );               
+            }
+        } 
+        target.getExtensions().removeAll( m );
+        target.getExtensions().addAll( 0, m );
+
+    private static Extension isMatch(Extension extension, List<Extension> extensions)
+    {
+        for(Extension e : extensions)
+        {
+            if(e.getGroupId().equals( extension.getGroupId() ) && e.getArtifactId().equals( extension.getArtifactId() ))
+            {
+                return e;
+            }
+        }
+        return null;
+    }
+
