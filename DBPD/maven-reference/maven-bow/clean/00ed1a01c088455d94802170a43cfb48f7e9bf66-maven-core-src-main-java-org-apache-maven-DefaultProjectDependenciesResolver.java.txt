[MNG-4304] [regression] MavenProject.getDependencyArtifacts() not set

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@805008 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.HashSet;
+import java.util.LinkedHashSet;
+import org.apache.maven.model.Dependency;
+
-        return result.getArtifacts();        
-    }  
+
+        Set<String> directDependencies = new HashSet<String>( project.getDependencies().size() * 2 );
+        for ( Dependency dependency : project.getDependencies() )
+        {
+            directDependencies.add( dependency.getManagementKey() );
+        }
+
+        Set<Artifact> dependencyArtifacts = new LinkedHashSet<Artifact>( project.getDependencies().size() * 2 );
+        for ( Artifact artifact : result.getArtifacts() )
+        {
+            if ( directDependencies.contains( artifact.getDependencyConflictId() ) )
+            {
+                dependencyArtifacts.add( artifact );
+            }
+        }
+        project.setDependencyArtifacts( dependencyArtifacts );
+
+        return result.getArtifacts();
+    }
+
