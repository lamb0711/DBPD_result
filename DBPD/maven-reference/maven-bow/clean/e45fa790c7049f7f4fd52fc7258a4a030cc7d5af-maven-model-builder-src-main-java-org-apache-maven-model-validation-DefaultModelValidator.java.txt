[MNG-4418] Dependency resolution appears to misbehave if a remote repository uses the id "local"

git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@929329 13f79535-47bb-0310-9956-ffa450edef68

-                validateRepositoryLayout( problems, repository, "repositories.repository", request );
+                validateRepository( problems, repository, "repositories.repository", request );
-                validateRepositoryLayout( problems, repository, "pluginRepositories.pluginRepository", request );
+                validateRepository( problems, repository, "pluginRepositories.pluginRepository", request );
-                validateRepositoryLayout( problems, distMgmt.getRepository(), "distributionManagement.repository",
-                                          request );
-                validateRepositoryLayout( problems, distMgmt.getSnapshotRepository(),
-                                          "distributionManagement.snapshotRepository", request );
+                validateRepository( problems, distMgmt.getRepository(), "distributionManagement.repository", request );
+                validateRepository( problems, distMgmt.getSnapshotRepository(),
+                                    "distributionManagement.snapshotRepository", request );
-    private void validateRepositoryLayout( ModelProblemCollector problems, Repository repository, String prefix,
-                                           ModelBuildingRequest request )
+    private void validateRepository( ModelProblemCollector problems, Repository repository, String prefix,
+                                     ModelBuildingRequest request )
-        if ( repository != null && "legacy".equals( repository.getLayout() ) )
+        if ( repository != null )
-            addViolation( problems, Severity.WARNING, prefix + ".layout", repository.getId(),
-                          "uses the deprecated value 'legacy'." );
+            if ( "local".equals( repository.getId() ) )
+            {
+                addViolation( problems, Severity.ERROR, prefix + ".id", null,
+                              "must not be 'local', this identifier is reserved." );
+            }
+            if ( "legacy".equals( repository.getLayout() ) )
+            {
+                addViolation( problems, Severity.WARNING, prefix + ".layout", repository.getId(),
+                              "uses the deprecated value 'legacy'." );
+            }
