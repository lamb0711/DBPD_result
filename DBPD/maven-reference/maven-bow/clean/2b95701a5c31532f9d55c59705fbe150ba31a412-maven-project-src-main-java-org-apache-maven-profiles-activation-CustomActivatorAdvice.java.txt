Rearranging project-builder caching so it's done externally and available for use in the model-lineage builder and during artifact resolution as well.

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@509692 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.Collections;
+import java.util.Map;
+
+    private static final String FAIL_QUIETLY_KEY = "fail-quietly";
+    
-        CustomActivatorAdvice advice = null;
+        CustomActivatorAdvice advice = new CustomActivatorAdvice();
-            advice = (CustomActivatorAdvice) buildContext.get( BUILD_CONTEXT_KEY );
-        }
-        
-        if ( advice == null )
-        {
-            advice = new CustomActivatorAdvice();
+            buildContext.retrieve( advice );
-        buildContext.put( this );
+        buildContext.store( this );
+
+    public Map getData()
+    {
+        return Collections.singletonMap( FAIL_QUIETLY_KEY, Boolean.valueOf( failQuietly ) );
+    }
+
+    public void setData( Map data )
+    {
+        this.failQuietly = ((Boolean) data.get( FAIL_QUIETLY_KEY )).booleanValue();
+    }
