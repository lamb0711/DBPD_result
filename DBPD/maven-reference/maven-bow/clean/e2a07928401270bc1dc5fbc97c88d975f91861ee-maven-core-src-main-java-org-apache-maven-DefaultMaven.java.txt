exit session scope in finally {} block

Signed-off-by: Igor Fedorenko <ifedorenko@apache.org>

-        DefaultRepositorySystemSession repoSession = (DefaultRepositorySystemSession) newRepositorySession( request );
-
-        MavenSession session = new MavenSession( container, repoSession, request, result );
-
-        sessionScope.seed( MavenSession.class, session );
+        try
+        {
+            DefaultRepositorySystemSession repoSession =
+                (DefaultRepositorySystemSession) newRepositorySession( request );
+            MavenSession session = new MavenSession( container, repoSession, request, result );
-        legacySupport.setSession( session );
+            sessionScope.seed( MavenSession.class, session );
+            legacySupport.setSession( session );
+
+            return doExecute( request, session, result, repoSession );
+        }
+        finally
+        {
+            sessionScope.exit();
+        }
+    }
+
+    private MavenExecutionResult doExecute( MavenExecutionRequest request, MavenSession session,
+                                            MavenExecutionResult result, DefaultRepositorySystemSession repoSession )
+    {
-            finally
-            {
-                sessionScope.exit();
-            }
