PR: MNG-1355
Submitted By: Edwin Punzalan
Reviewed By: John Casey

Applied patch, with small logical fix (used getArtifactId() where getGroupId() was the intention).

This patch will guard against overwriting cached models in the project builder (check for pre-existing model in cache before adding), and will validate that a POM's parent has a different groupId:artifactId than the current POM.



git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@354473 13f79535-47bb-0310-9956-ffa450edef68

-        modelCache.put( createCacheKey( model.getGroupId(), model.getArtifactId(), model.getVersion() ), p );
+        
+        String modelKey = createCacheKey( model.getGroupId(), model.getArtifactId(), model.getVersion() );
+        if ( modelCache.containsKey( modelKey ) )
+        {
+            throw new ProjectBuildingException( model.getGroupId() + ":" + model.getArtifactId(), 
+                    "Duplicate project ID found in " + projectDescriptor.getAbsolutePath() );
+        }
+        modelCache.put( modelKey, p );
+            else if ( parentModel.getGroupId().equals( model.getGroupId() ) &&  
+                    parentModel.getArtifactId().equals( model.getArtifactId() ) )
+            {
+                throw new ProjectBuildingException( projectId, "Parent element is a duplicate of " +
+                        "the current project " );
+            }
