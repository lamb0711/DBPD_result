PR: MNG-487

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@191309 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.Iterator;
+import java.util.List;
+        setLocalRepository( userSettings );
+
+        return userSettings;
+    }
+
+    private void setLocalRepository( Settings userSettings )
+    {
-        
+
-        
-        // if both are missing, default to ~/.m2/repository.
+
+        // this is a backward compatibility feature...
+        if ( localRepository == null || localRepository.length() < 1 )
+        {
+            List profiles = userSettings.getProfiles();
+
+            for ( Iterator it = profiles.iterator(); it.hasNext(); )
+            {
+                Profile profile = (Profile) it.next();
+
+                localRepository = profile.getLocalRepository();
+
+                if ( localRepository != null && localRepository.length() > 0 )
+                {
+                    getLogger().warn(
+                                      "DEPRECATED: Please specify the local repository as:\n\n<settings>"
+                                          + "\n    <localRepository>" + localRepository + "</localRepository>"
+                                          + "\n    ...\n</settings>\n" );
+
+                    // we've found it! so stop looking through the profiles...
+                    break;
+                }
+            }
+        }
+
+        // if all of the above are missing, default to ~/.m2/repository.
-
-        return userSettings;
