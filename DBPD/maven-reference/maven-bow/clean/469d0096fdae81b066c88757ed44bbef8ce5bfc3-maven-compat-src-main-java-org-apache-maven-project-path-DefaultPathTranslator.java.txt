[MNG-4933] With a resource directory as . maven raise an java.lang.StringIndexOutOfBoundsException:217

o Aligned code with r1050425 of https://svn.apache.org/repos/asf/maven/maven-2/branches/maven-2.2.x/maven-project/src/main/java/org/apache/maven/project/path/DefaultPathTranslator.java
o Fixed special case of path=${basedir} to yield valid/non-empty path "."

git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@1054712 13f79535-47bb-0310-9956-ffa450edef68

+        if ( basedir == null )
+        {
+            return;
+        }
+
+        if ( basedir == null )
+        {
+            return path;
+        }
+
+        if ( basedir == null )
+        {
+            return;
+        }
+
-    public String unalignFromBaseDirectory( String directory, File basedir )
+    public String unalignFromBaseDirectory( String path, File basedir )
-        String path = basedir.getPath();
-        if ( directory.startsWith( path ) )
+        if ( basedir == null )
-            directory = directory.substring( path.length() + 1 ).replace( '\\', '/' );
+            return path;
-        return directory;
+
+        if ( path == null )
+        {
+            return null;
+        }
+
+        path = path.trim();
+
+        String base = basedir.getAbsolutePath();
+        if ( path.startsWith( base ) )
+        {
+            path = chopLeadingFileSeparator( path.substring( base.length() ) );
+        }
+
+        if ( path.length() <= 0 )
+        {
+            path = ".";
+        }
+
+        if ( !new File( path ).isAbsolute() )
+        {
+            path = path.replace( '\\', '/' );
+        }
+
+        return path;
