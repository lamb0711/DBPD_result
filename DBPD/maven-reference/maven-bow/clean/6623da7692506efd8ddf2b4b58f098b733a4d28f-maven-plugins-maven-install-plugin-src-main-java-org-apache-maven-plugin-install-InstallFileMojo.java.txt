PR: MNG-1279
Submitted by: Philipp Meier
Reviewed by:  Brett Porter
ability to write a pom on install-file

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@327918 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.artifact.metadata.ArtifactMetadata;
+import org.apache.maven.model.Model;
+import org.apache.maven.model.io.xpp3.MavenXpp3Writer;
+import org.apache.maven.project.artifact.ProjectArtifactMetadata;
+import org.codehaus.plexus.util.IOUtil;
+import java.io.FileWriter;
+import java.io.IOException;
+     * @parameter expression="${generatePom}"
+     * @readonly
+     */
+    private boolean generatePom = false;
+
+    /**
-        // TODO: validate
-        // TODO: maybe not strictly correct, while we should enfore that packaging has a type handler of the same id, we don't
+        // TODO: check if it exists first, and default to true if not
+        if ( generatePom )
+        {
+            FileWriter fw = null;
+            try
+            {
+                File tempFile = File.createTempFile( "mvninstall", ".pom" );
+                tempFile.deleteOnExit();
+
+                Model model = new Model();
+                model.setGroupId( groupId );
+                model.setArtifactId( artifactId );
+                model.setVersion( version );
+                model.setPackaging( packaging );
+                model.setDescription( "POM was created from install:install-file" );
+                fw = new FileWriter( tempFile );
+                tempFile.deleteOnExit();
+                new MavenXpp3Writer().write( fw, model );
+                ArtifactMetadata metadata = new ProjectArtifactMetadata( artifact, tempFile );
+                artifact.addMetadata( metadata );
+            }
+            catch ( IOException e )
+            {
+                throw new MojoExecutionException( "Error writing temporary pom file: "
+                    + e.getMessage(), e );
+            }
+            finally
+            {
+                IOUtil.close( fw );
+            }
+        }
+
+        // TODO: validate
+        // TODO: maybe not strictly correct, while we should enfore that packaging has a type handler of the same id, we don't
