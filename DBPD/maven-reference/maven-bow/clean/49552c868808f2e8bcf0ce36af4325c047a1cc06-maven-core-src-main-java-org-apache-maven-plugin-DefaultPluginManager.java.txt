make sure paths are processed after plugin configuration is merged


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@163616 13f79535-47bb-0310-9956-ffa450edef68

-        Map map = null;
-
-        if ( parameters != null )
+        Map map = new HashMap();
+
+        for ( int i = 0; i < parameters.size(); i++ )
-            map = new HashMap();
+            Parameter parameter = (Parameter) parameters.get( i );
-            for ( int i = 0; i < parameters.size(); i++ )
+            String key = parameter.getName();
+
+            String expression = parameter.getExpression();
+
+            Object value = PluginParameterExpressionEvaluator.evaluate( expression, session );
+
+            getLogger().debug( "Evaluated mojo parameter expression: \'" + expression + "\' to: " + value );
+
+            if ( value == null )
-                Parameter parameter = (Parameter) parameters.get( i );
-
-                String key = parameter.getName();
-
-                String expression = parameter.getExpression();
-
-                Object value = PluginParameterExpressionEvaluator.evaluate( expression, session );
-
-                getLogger().debug( "Evaluated mojo parameter expression: \'" + expression + "\' to: " + value );
-
-                if ( value == null )
+                if ( parameter.getDefaultValue() != null )
-                    if ( parameter.getDefaultValue() != null )
-                    {
-                        value = PluginParameterExpressionEvaluator.evaluate( parameter.getDefaultValue(), session );
-                    }
+                    value = PluginParameterExpressionEvaluator.evaluate( parameter.getDefaultValue(), session );
-
-                String type = parameter.getType();
-
-                if ( type != null && ( type.equals( "File" ) || type.equals( "java.io.File" ) ) )
-                {
-                    value = pathTranslator.alignToBaseDirectory( (String) value,
-                                                                 session.getProject().getFile().getParentFile() );
-                }
-
-                map.put( key, value );
-            if ( session.getProject() != null )
-            {
-                map = mergeProjectDefinedPluginConfiguration( session.getProject(), goal.getId(), map );
-            }
+            map.put( key, value );
+        }
+
+        if ( session.getProject() != null )
+        {
+            map = mergeProjectDefinedPluginConfiguration( session.getProject(), goal.getId(), map );
+
+            String type = parameter.getType();
+
+            if ( type != null && ( type.equals( "File" ) || type.equals( "java.io.File" ) ) )
+            {
+                value = pathTranslator.alignToBaseDirectory( (String) value,
+                                                             session.getProject().getFile().getParentFile() );
+                map.put( key, value );
+            }
-                // TODO: groupID not handled
+// TODO: groupID not handled
-    // ----------------------------------------------------------------------
-    // Lifecycle
-    // ----------------------------------------------------------------------
+// ----------------------------------------------------------------------
+// Lifecycle
+// ----------------------------------------------------------------------
-        // TODO: move this to be configurable from the Maven component
+// TODO: move this to be configurable from the Maven component
-        // TODO: needs to be configured from the POM element
-        
+// TODO: needs to be configured from the POM element
+
-    // ----------------------------------------------------------------------
-    // Artifact resolution
-    // ----------------------------------------------------------------------
+// ----------------------------------------------------------------------
+// Artifact resolution
+// ----------------------------------------------------------------------
-    // ----------------------------------------------------------------------
-    // Artifact downloading
-    // ----------------------------------------------------------------------
+// ----------------------------------------------------------------------
+// Artifact downloading
+// ----------------------------------------------------------------------
