[MNG-1803] Provide line number information when there are errors processing a pom.xml

o Merged feature branch

git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@949708 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.model.InputSource;
+import org.apache.maven.model.io.xpp3.MavenXpp3ReaderEx;
-            return read( input, isStrict( options ) );
+            return read( input, isStrict( options ), getSource( options ) );
-            return read( ReaderFactory.newXmlReader( input ), isStrict( options ) );
+            return read( ReaderFactory.newXmlReader( input ), isStrict( options ), getSource( options ) );
-    private Model read( Reader reader, boolean strict )
+    private InputSource getSource( Map<String, ?> options )
+    {
+        Object value = ( options != null ) ? options.get( INPUT_SOURCE ) : null;
+        return (InputSource) value;
+    }
+
+    private Model read( Reader reader, boolean strict, InputSource source )
-            MavenXpp3Reader r = new MavenXpp3Reader();
-            return r.read( reader, strict );
+            if ( source != null )
+            {
+                return new MavenXpp3ReaderEx().read( reader, strict, source );
+            }
+            else
+            {
+                return new MavenXpp3Reader().read( reader, strict );
+            }

INS26 INS26 INS40 INS40 INS31 INS83 INS43 INS42 INS44 INS8 INS44 INS42 INS74 INS42 INS60 INS41 INS43 INS42 INS43 INS43 INS76 INS43 INS59 INS11 INS42 INS42 INS42 INS42 INS42 INS16 INS43 INS42 INS25 INS36 INS32 INS33 INS42 INS27 INS8 INS8 INS32 INS32 INS27 INS42 INS42 INS42 INS42 INS33 INS41 MOV41 INS42 INS42 INS42 INS42 INS42 INS33 INS32 INS14 INS42 INS42 INS42 INS42 MOV14 INS43 UPD42 MOV42 DEL42 DEL43 DEL42 DEL59 DEL60