o A change that eliminates the use of System.properties from the core in an
attempt to move toward true embeddability. 

 - System properties are still populated in the CLI to make sure that the 
   system property profile activator functions and the settings are dealt with
   correctly. I will look at each of those shortly but this is a first step.
   


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@293504 13f79535-47bb-0310-9956-ffa450edef68

-        initializeSystemProperties( commandLine );
-
+        // ----------------------------------------------------------------------
+        // The execution properties need to be created before the settings
+        // are constructed.
+        // ----------------------------------------------------------------------
+
+        Properties executionProperties = getExecutionProperties( commandLine );
+
-            request = createRequest( commandLine, settings, eventDispatcher, loggerManager, profileManager );
+            request = createRequest( commandLine,
+                                     settings,
+                                     eventDispatcher,
+                                     loggerManager,
+                                     profileManager,
+                                     executionProperties );
-    private static MavenExecutionRequest createRequest( CommandLine commandLine, Settings settings,
-                                                        EventDispatcher eventDispatcher, LoggerManager loggerManager,
-                                                        ProfileManager profileManager )
+    private static MavenExecutionRequest createRequest( CommandLine commandLine,
+                                                        Settings settings,
+                                                        EventDispatcher eventDispatcher,
+                                                        LoggerManager loggerManager,
+                                                        ProfileManager profileManager,
+                                                        Properties executionProperties )
-        request = new DefaultMavenExecutionRequest( localRepository, settings, eventDispatcher,
-                                                    commandLine.getArgList(), userDir.getPath(), profileManager );
+
+        request = new DefaultMavenExecutionRequest( localRepository,
+                                                    settings,
+                                                    eventDispatcher,
+                                                    commandLine.getArgList(),
+                                                    userDir.getPath(),
+                                                    profileManager,
+                                                    executionProperties );
+
-    private static void initializeSystemProperties( CommandLine commandLine )
+    private static Properties getExecutionProperties( CommandLine commandLine )
+        Properties executionProperties = new Properties();
+
+
-                setCliProperty( defStrs[i] );
+                setCliProperty( defStrs[i], executionProperties );
+
+        return executionProperties;
-    private static void setCliProperty( String property )
+    private static void setCliProperty( String property, Properties executionProperties )
+        executionProperties.setProperty( name, value );
+
+        // ----------------------------------------------------------------------
+        // I'm leaving the setting of system properties here as not to break
+        // the SystemPropertyProfileActivator. This won't harm embedding. jvz.
+        // ----------------------------------------------------------------------
+

INS44 INS43 INS42 INS44 INS60 INS43 INS42 INS42 INS60 INS41 INS43 INS42 INS21 INS43 INS59 INS42 INS43 INS59 INS42 INS42 INS32 INS42 INS42 INS32 INS42 INS42 INS14 INS42 INS42 INS42 INS42 UPD42 MOV42 MOV42 INS42 INS43 INS42 INS42 INS42 DEL32 DEL21 DEL39 DEL42