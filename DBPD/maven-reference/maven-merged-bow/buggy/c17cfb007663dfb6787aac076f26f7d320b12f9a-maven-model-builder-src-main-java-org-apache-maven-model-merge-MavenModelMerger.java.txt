o Continued work on model merging

git-svn-id: https://svn.apache.org/repos/asf/maven/components/branches/MNG-2766@772980 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.model.CiManagement;
+import org.apache.maven.model.DeploymentRepository;
+import org.apache.maven.model.DistributionManagement;
+import org.apache.maven.model.Extension;
+import org.apache.maven.model.IssueManagement;
+import org.apache.maven.model.Organization;
+import org.apache.maven.model.ReportPlugin;
+import org.apache.maven.model.ReportSet;
+import org.apache.maven.model.Reporting;
+    /*
+     * TODO: Whether the merge continues recursively into an existing node or not could be an option for the generated merger
+     */
+    @Override
+    protected void mergeModel_Organization( Model target, Model source, boolean sourceDominant,
+                                            Map<Object, Object> context )
+    {
+        Organization src = source.getOrganization();
+        if ( source.getOrganization() != null )
+        {
+            Organization tgt = target.getOrganization();
+            if ( tgt == null )
+            {
+                target.setOrganization( tgt = new Organization() );
+                mergeOrganization( tgt, src, sourceDominant, context );
+            }
+        }
+    }
+
+    @Override
+    protected void mergeModel_IssueManagement( Model target, Model source, boolean sourceDominant,
+                                               Map<Object, Object> context )
+    {
+        IssueManagement src = source.getIssueManagement();
+        if ( source.getIssueManagement() != null )
+        {
+            IssueManagement tgt = target.getIssueManagement();
+            if ( tgt == null )
+            {
+                target.setIssueManagement( tgt = new IssueManagement() );
+                mergeIssueManagement( tgt, src, sourceDominant, context );
+            }
+        }
+    }
+
+    @Override
+    protected void mergeModel_CiManagement( Model target, Model source, boolean sourceDominant,
+                                            Map<Object, Object> context )
+    {
+        CiManagement src = source.getCiManagement();
+        if ( source.getCiManagement() != null )
+        {
+            CiManagement tgt = target.getCiManagement();
+            if ( tgt == null )
+            {
+                target.setCiManagement( tgt = new CiManagement() );
+                mergeCiManagement( tgt, src, sourceDominant, context );
+            }
+        }
+    }
+
+    protected void mergeDistributionManagement_Repository( DistributionManagement target,
+                                                           DistributionManagement source, boolean sourceDominant,
+                                                           Map<Object, Object> context )
+    {
+        DeploymentRepository src = source.getRepository();
+        if ( src != null )
+        {
+            DeploymentRepository tgt = target.getRepository();
+            if ( tgt == null )
+            {
+                target.setRepository( tgt = new DeploymentRepository() );
+                mergeDeploymentRepository( tgt, src, sourceDominant, context );
+            }
+        }
+    }
+
+    @Override
+    protected void mergeDistributionManagement_SnapshotRepository( DistributionManagement target,
+                                                                   DistributionManagement source,
+                                                                   boolean sourceDominant, Map<Object, Object> context )
+    {
+        DeploymentRepository src = source.getSnapshotRepository();
+        if ( src != null )
+        {
+            DeploymentRepository tgt = target.getSnapshotRepository();
+            if ( tgt == null )
+            {
+                target.setSnapshotRepository( tgt = new DeploymentRepository() );
+                mergeDeploymentRepository( tgt, src, sourceDominant, context );
+            }
+        }
+    }
+
+    @Override
+    protected void mergeDistributionManagement_Site( DistributionManagement target, DistributionManagement source,
+                                                     boolean sourceDominant, Map<Object, Object> context )
+    {
+        Site src = source.getSite();
+        if ( src != null )
+        {
+            Site tgt = target.getSite();
+            if ( tgt == null )
+            {
+                target.setSite( tgt = new Site() );
+                mergeSite( tgt, src, sourceDominant, context );
+            }
+        }
+    }
+
+    @Override
+    protected void mergeReporting_Plugins( Reporting target, Reporting source, boolean sourceDominant,
+                                           Map<Object, Object> context )
+    {
+        List<ReportPlugin> src = source.getPlugins();
+        if ( !src.isEmpty() )
+        {
+            List<ReportPlugin> tgt = target.getPlugins();
+            Map<Object, ReportPlugin> merged =
+                new LinkedHashMap<Object, ReportPlugin>( ( src.size() + tgt.size() ) * 2 );
+
+            for ( Iterator<ReportPlugin> it = tgt.iterator(); it.hasNext(); )
+            {
+                ReportPlugin element = it.next();
+                Object key = getReportPluginKey( element );
+                merged.put( key, element );
+            }
+
+            for ( Iterator<ReportPlugin> it = src.iterator(); it.hasNext(); )
+            {
+                ReportPlugin element = it.next();
+                Object key = getReportPluginKey( element );
+                ReportPlugin existing = merged.get( key );
+                if ( existing != null )
+                {
+                    mergeReportPlugin( existing, element, sourceDominant, context );
+                }
+                else
+                {
+                    merged.put( key, element );
+                }
+            }
+
+            target.setPlugins( new ArrayList<ReportPlugin>( merged.values() ) );
+        }
+    }
+
+    @Override
+    protected Object getReportPluginKey( ReportPlugin object )
+    {
+        return object.getKey();
+    }
+
+    @Override
+    protected Object getReportSetKey( ReportSet object )
+    {
+        return object.getId();
+    }
+
+    @Override
+    @Override
+    protected Object getExtensionKey( Extension object )
+    {
+        return object.getGroupId() + ':' + object.getArtifactId();
+    }
+

INS26 INS26 INS26 INS26 INS26 INS26 INS26 INS26 INS26 INS40 INS40 INS40 INS40 INS40 INS40 INS40 INS40 INS40 INS31 INS31 INS31 INS31 INS31 INS31 INS31 INS31 INS31 INS31 INS78 INS83 INS39 INS42 INS44 INS44 INS44 INS44 INS8 INS78 INS83 INS39 INS42 INS44 INS44 INS44 INS44 INS8 INS78 INS83 INS39 INS42 INS44 INS44 INS44 INS44 INS8 INS78 INS83 INS39 INS42 INS44 INS44 INS44 INS44 INS8 INS78 INS83 INS39 INS42 INS44 INS44 INS44 INS44 INS8 INS78 INS83 INS39 INS42 INS44 INS44 INS44 INS44 INS8 INS78 INS83 INS39 INS42 INS44 INS44 INS44 INS44 INS8 INS78 INS83 INS43 INS42 INS44 INS8 INS78 INS83 INS43 INS42 INS44 INS8 INS78 INS83 INS43 INS42 INS44 INS8 INS42 INS43 INS42 INS43 INS42 INS39 INS42 INS74 INS42 INS60 INS25 INS42 INS43 INS42 INS43 INS42 INS39 INS42 INS74 INS42 INS60 INS25 INS42 INS43 INS42 INS43 INS42 INS39 INS42 INS74 INS42 INS60 INS25 INS42 INS43 INS42 INS43 INS42 INS39 INS42 INS74 INS42 INS60 INS25 INS42 INS43 INS42 INS43 INS42 INS39 INS42 INS74 INS42 INS60 INS25 INS42 INS43 INS42 INS43 INS42 INS39 INS42 INS74 INS42 INS60 INS25 INS42 INS43 INS42 INS43 INS42 INS39 INS42 INS74 INS42 INS60 INS25 INS42 INS42 INS43 INS42 INS41 INS42 INS42 INS43 INS42 INS41 INS42 INS42 INS43 INS42 INS41 INS42 INS42 INS43 INS43 INS43 INS43 INS59 INS27 INS8 INS42 INS42 INS43 INS43 INS43 INS43 INS59 INS27 INS8 INS42 INS42 INS43 INS43 INS43 INS43 INS59 INS27 INS8 INS42 INS42 INS43 INS43 INS43 INS43 INS59 INS27 INS8 INS42 INS42 INS43 INS43 INS43 INS43 INS59 INS27 INS8 INS42 INS42 INS43 INS43 INS43 INS43 INS59 INS27 INS8 INS42 INS42 INS43 INS43 INS43 INS74 INS59 INS38 INS8 INS42 INS32 INS42 INS32 INS42 INS27 INS42 INS42 INS42 INS42 INS42 INS32 INS32 INS33 INS60 INS25 INS42 INS42 INS42 INS42 INS42 INS32 INS32 INS33 INS60 INS25 INS42 INS42 INS42 INS42 INS42 INS32 INS32 INS33 INS60 INS25 INS42 INS42 INS42 INS42 INS42 INS32 INS42 INS33 INS60 INS25 INS42 INS42 INS42 INS42 INS42 INS32 INS42 INS33 INS60 INS25 INS42 INS42 INS42 INS42 INS42 INS32 INS42 INS33 INS60 INS25 INS42 INS42 INS42 INS43 INS43 INS42 INS32 INS32 INS60 INS60 INS24 INS24 INS21 INS42 INS42 INS42 INS42 INS32 INS13 INS32 INS42 INS42 INS42 INS42 INS43 INS59 INS27 INS8 INS42 INS42 INS42 INS42 INS43 INS59 INS27 INS8 INS42 INS42 INS42 INS42 INS43 INS59 INS27 INS8 INS42 INS42 INS43 INS59 INS27 INS8 INS42 INS42 INS43 INS59 INS27 INS8 INS42 INS42 INS43 INS59 INS27 INS8 INS42 INS42 INS42 INS42 INS42 INS42 INS74 INS59 INS74 INS59 INS58 INS32 INS8 INS58 INS32 INS8 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS32 INS42 INS33 INS21 INS21 INS42 INS42 INS32 INS42 INS33 INS21 INS21 INS42 INS42 INS32 INS42 INS33 INS21 INS21 INS42 INS42 INS32 INS42 INS33 INS21 INS21 INS42 INS42 INS32 INS42 INS33 INS21 INS21 INS42 INS42 INS32 INS42 INS33 INS21 INS21 INS43 INS43 INS42 INS32 INS43 INS43 INS43 INS42 INS14 INS74 INS59 INS42 INS42 INS60 INS60 INS21 INS74 INS59 INS42 INS42 INS60 INS60 INS60 INS25 INS42 INS42 INS14 INS42 INS42 INS32 INS32 INS42 INS42 INS32 INS32 INS42 INS42 INS32 INS32 INS42 INS42 INS32 INS32 INS42 INS42 INS32 INS32 INS42 INS42 INS32 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS74 INS27 INS43 INS43 INS42 INS32 INS43 INS59 INS43 INS59 INS32 INS43 INS43 INS42 INS32 INS43 INS59 INS43 INS59 INS43 INS59 INS27 INS8 INS8 INS74 INS32 INS42 INS42 INS7 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS7 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS7 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS7 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS7 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS7 INS42 INS42 INS42 INS42 INS42 INS43 INS43 INS43 INS36 INS34 INS42 INS42 INS42 INS42 INS42 INS42 INS32 INS42 INS42 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS32 INS42 INS42 INS32 INS42 INS42 INS32 INS42 INS33 INS21 INS21 INS43 INS43 INS42 INS42 INS42 INS14 INS42 INS14 INS42 INS14 INS42 INS14 INS42 INS14 INS42 INS14 INS42 INS42 INS42 INS27 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS32 INS32 INS42 INS42 INS43 INS43 INS43 INS43 INS43 INS43 INS32 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42