o Removed AuthenticationInfoProvider stuff
o Added ArtifactRepositoryFactory stuff to construct with AuthenticationInfo if possible.
o Added UserModelBuilder stuff for componentizing UserModel construction.
  -> DefaultUserModelBuilder has a configuration point 'userModelPath' which can redirect where it reads user.xml from (${user.home} is substitutable here).
o Added warning message to deployment plugin when deployment repo has no authentication info available.
o Added warning message for repos with null <id/> (auth info cannot be assigned here).
o Added a couple of debug-level messages for aid in debugging repo- and userModel-related problems.


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@163558 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.artifact.repository.ArtifactRepositoryFactory;
+import org.apache.maven.model.user.UserModel;
+ * Requires the follow parameters:
+ * 
+ * @parameter
+ *  name="project"
+ *  type="org.apache.maven.project.MavenProject"
+ *  required="true"
+ *  validator=""
+ *  expression="#project"
+ *  description=""
+ *
+ * @parameter
+ *  name="deployer"
+ *  type="org.apache.maven.artifact.deployer.ArtifactDeployer"
+ *  required="true"
+ *  validator=""
+ *  expression="#component.org.apache.maven.artifact.deployer.ArtifactDeployer"
+ *  description=""
+ *
+ * @parameter
+ *  name="artifactRepositoryFactory"
+ *  type="org.apache.maven.artifact.repository.ArtifactRepositoryFactory"
+ *  required="true"
+ *  validator=""
+ *  expression="#component.org.apache.maven.artifact.repository.ArtifactRepositoryFactory"
+ *  description=""
+ *
+ * @parameter
+ *  name="userModel"
+ *  type="org.apache.maven.model.user.UserModel"
+ *  required="true"
+ *  validator=""
+ *  expression="#userModel"
+ *  description=""
+ *
+        
+        ArtifactRepositoryFactory artifactRepositoryFactory = (ArtifactRepositoryFactory) request.getParameter( "artifactRepositoryFactory" );
+        
+        UserModel userModel = (UserModel) request.getParameter( "userModel" );
-        ArtifactRepository deploymentRepository = new ArtifactRepository( repository.getId(), repository.getUrl() );
+        ArtifactRepository deploymentRepository = artifactRepositoryFactory.createArtifactRepository( repository, userModel );
+        
+        if(deploymentRepository.getAuthenticationInfo() == null)
+        {
+            request.getLog().warn("Deployment repository {id: \'" + repository.getId() + "\'} has no associated authentication info!");
+        }

INS26 INS26 INS40 INS40 INS65 INS65 INS65 INS65 INS65 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS60 INS60 INS60 INS25 UPD43 MOV43 INS59 INS43 INS59 MOV43 MOV59 INS27 INS8 UPD42 INS42 INS11 INS42 INS42 INS11 INS32 INS32 INS33 INS21 INS43 INS32 INS43 INS32 INS42 INS42 MOV42 UPD42 MOV42 INS42 INS42 INS32 INS42 INS42 INS42 INS45 INS42 INS42 INS42 INS45 INS32 INS42 INS27 INS42 INS42 INS45 MOV32 INS45 DEL32 DEL14 DEL60