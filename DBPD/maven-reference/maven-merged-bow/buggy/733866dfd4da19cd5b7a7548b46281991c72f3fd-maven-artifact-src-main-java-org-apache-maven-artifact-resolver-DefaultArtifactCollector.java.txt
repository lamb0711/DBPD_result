implement managed versions in tests


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@191781 13f79535-47bb-0310-9956-ffa450edef68

-        return collect( artifacts, originatingArtifact, Collections.EMPTY_SET, localRepository, remoteRepositories,
+        return collect( artifacts, originatingArtifact, Collections.EMPTY_MAP, localRepository, remoteRepositories,
-    public ArtifactResolutionResult collect( Set artifacts, Artifact originatingArtifact, Set managedVersions,
+    public ArtifactResolutionResult collect( Set artifacts, Artifact originatingArtifact, Map managedVersions,
-        recurse( root, resolvedArtifacts, localRepository, remoteRepositories, source, filter, artifactFactory );
+        recurse( root, resolvedArtifacts, managedVersions, localRepository, remoteRepositories, source, filter,
+                 artifactFactory );
-    private void recurse( ResolutionNode node, Map resolvedArtifacts, ArtifactRepository localRepository,
-                          List remoteRepositories, ArtifactMetadataSource source, ArtifactFilter filter,
-                          ArtifactFactory artifactFactory )
+    private void recurse( ResolutionNode node, Map resolvedArtifacts, Map managedVersions,
+                          ArtifactRepository localRepository, List remoteRepositories, ArtifactMetadataSource source,
+                          ArtifactFilter filter, ArtifactFactory artifactFactory )
-        ResolutionNode previous = (ResolutionNode) resolvedArtifacts.get( node.getKey() );
+        // TODO: conflict resolvers, shouldn't be munging original artifact perhaps?
+        Object key = node.getKey();
+        if ( managedVersions.containsKey( key ) )
+        {
+            node.getArtifact().setVersion( (String) managedVersions.get( key ) );
+        }
+
+        ResolutionNode previous = (ResolutionNode) resolvedArtifacts.get( key );
-        resolvedArtifacts.put( node.getKey(), node );
+        resolvedArtifacts.put( key, node );
-                recurse( child, resolvedArtifacts, localRepository, remoteRepositories, source, filter,
+                recurse( child, resolvedArtifacts, managedVersions, localRepository, remoteRepositories, source, filter,

INS44 UPD43 INS43 INS42 INS60 INS25 UPD42 INS42 INS43 INS59 INS32 INS8 MOV43 UPD40 INS42 INS42 INS42 MOV32 INS42 INS42 INS42 INS21 INS42 INS32 MOV43 INS32 INS42 INS11 UPD42 MOV42 INS42 INS42 INS43 INS32 INS42 INS42 INS42 INS42 INS42 DEL42 DEL32