o the newly gutted system bootstraps, i think i'm happy about the state of 3.x now :-)


git-svn-id: https://svn.apache.org/repos/asf/maven/components/branches/MNG-2766@773740 13f79535-47bb-0310-9956-ffa450edef68

-// maven-compat
-//   target/classes
-// maven-core
-//   target/classes
-// maven-embedder
-//   target/classes
-// maven-model
-//   target/classes
-// maven-model-builder
-//   target/classes
-// maven-plugin-api
-//   target/classes
-// maven-repository
-//   target/classes
-// maven-toolchain
-//   target/classes
+//TODO: need phase information here to determine whether to hand back the classes/ or archive.
-            //TODO: determine if we want to pass the artifact produced by the project if it
-            // is present and under what conditions we will do such a thing.            
-
+                File artifactFile = new File( project.getBuild().getDirectory(), project.getArtifactId() + "-" + project.getVersion() + "."+ artifact.getArtifactHandler().getExtension() );
+                
-                if ( classesDirectory.exists() )
+                //TODO: This is really completely wrong and should probably be based on the phase that is currently being executed.
+                // If we are running before the packaging phase there is going to be no archive anyway, but if we are running prior to package
+                // we shouldn't even take the archive anyway.
+                
+                if ( artifactFile.exists() )
+                {
+                    artifact.setFile( artifactFile );
+
+                    artifact.setFromAuthoritativeRepository( true );
+
+                    artifact.setResolved( true );                    
+                }                
+                else if ( classesDirectory.exists() )

INS60 INS25 INS43 INS59 INS32 INS8 MOV25 INS42 INS42 INS14 INS42 INS42 INS21 INS21 INS21 INS43 INS32 INS27 INS32 INS32 INS32 INS42 INS32 INS42 INS32 INS45 INS32 INS45 INS32 INS42 INS42 INS42 INS42 INS42 INS9 INS42 INS42 INS9 INS42 INS42 INS42 INS42 INS42 INS42 INS32 INS42 INS42 INS42