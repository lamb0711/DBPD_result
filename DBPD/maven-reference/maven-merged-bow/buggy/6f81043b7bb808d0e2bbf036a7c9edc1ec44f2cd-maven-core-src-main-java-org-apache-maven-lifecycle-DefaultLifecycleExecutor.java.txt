Centralized repository handling in AbstractVersionTransformation, for consistency (should fix MNG-527).

Changed download strategy for plugins.xml metadata to download only when non-existent locally or when plugin prefix cannot be located within local metadata. NOTE: This could lead to local-only installs of plugins having their prefix mappings overwritten.

Next step is to change the maven-plugin-plugin.


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@219615 13f79535-47bb-0310-9956-ffa450edef68

-            pluginDescriptor = pluginManager.getPluginDescriptorForPrefix( prefix );
+            try
+            {
+                pluginDescriptor = pluginManager.getPluginDescriptorForPrefix( prefix );
+            }
+            catch ( PluginManagerException e )
+            {
+                throw new LifecycleExecutionException( "Cannot resolve plugin-prefix: \'" + prefix + "\' from plugin collector.", e );
+            }
+            
+            if ( pluginDescriptor == null )
+            {
+                try
+                {
+                    plugin = pluginManager.getPluginDefinitionForPrefix( prefix, session, project );
+                }
+                catch ( PluginManagerException e )
+                {
+                    throw new LifecycleExecutionException( "Cannot resolve plugin-prefix: \'" + prefix + "\' from plugin mappings metadata.", e );
+                }
+            }
-            // 2. use the plugin resolver to resolve the prefix in the search groups
-            if ( plugin == null )
-            {
-                PluginMappingManager mappingManager = getPluginMappingManager( session, project );
-
-                plugin = mappingManager.getByPrefix( prefix );
-            }
-
-            // 3. default to o.a.m.plugins and maven-<prefix>-plugin
+            // 2. default to o.a.m.plugins and maven-<prefix>-plugin

MOV25 INS54 INS8 INS12 MOV21 INS44 INS8 UPD42 INS54 INS43 INS42 INS53 INS8 INS12 INS42 INS14 INS21 INS44 INS8 INS43 INS27 INS42 INS7 INS43 INS42 INS53 INS42 INS45 INS42 INS45 INS42 INS32 INS42 INS14 INS42 UPD42 MOV42 INS42 MOV42 MOV42 INS43 INS27 INS42 INS42 INS45 INS42 INS45 DEL42 DEL43 DEL42 DEL32 DEL59 DEL60 DEL42 DEL42 DEL42 DEL42 DEL32 DEL7 DEL21