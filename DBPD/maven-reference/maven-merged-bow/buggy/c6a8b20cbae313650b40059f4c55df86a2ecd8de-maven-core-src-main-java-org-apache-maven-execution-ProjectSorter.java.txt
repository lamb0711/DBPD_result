o get rid of the reactor manager to make way for a real reactor that can be a local repository implementation which will prevent the pollution in the metadata source for dealing with projects that are in the current build
o clean up the project sorter
o push the information that was in the reactor manager into the session


git-svn-id: https://svn.apache.org/repos/asf/maven/components/branches/MNG-2766@772039 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.maven.model.Extension;
-import org.apache.maven.model.ReportPlugin;
-        Map projectMap = new HashMap();
+        Map<String,MavenProject> projectMap = new HashMap<String,MavenProject>();
-        for ( Iterator i = projects.iterator(); i.hasNext(); )
+        for ( MavenProject project : projects )
-            MavenProject project = (MavenProject) i.next();
-
-                throw new DuplicateProjectException( id,
-                                                     conflictingProject.getFile(),
-                                                     project.getFile(),
-                                                     "Project '"
-                                                     + id
-                                                     + "' is duplicated in the reactor" );
+                throw new DuplicateProjectException( id, conflictingProject.getFile(), project.getFile(), "Project '" + id + "' is duplicated in the reactor" );
-        for ( Iterator i = projects.iterator(); i.hasNext(); )
+        for ( MavenProject project : projects )
-            MavenProject project = (MavenProject) i.next();
-
-            for ( Iterator j = project.getDependencies().iterator(); j.hasNext(); )
+            for( Dependency dependency : project.getDependencies() )
-                Dependency dependency = (Dependency) j.next();
-
-                String dependencyId = ArtifactUtils
-                    .versionlessKey( dependency.getGroupId(), dependency.getArtifactId() );
+                String dependencyId = ArtifactUtils.versionlessKey( dependency.getGroupId(), dependency.getArtifactId() );
+            
+                    
-
-            List buildPlugins = project.getBuildPlugins();
-            if ( buildPlugins != null )
+            
+            if ( project.getBuildPlugins() != null )
-                for ( Iterator j = buildPlugins.iterator(); j.hasNext(); )
+                for( Plugin plugin : project.getBuildPlugins() )
-                    Plugin plugin = (Plugin) j.next();
+                    
-
-            List reportPlugins = project.getReportPlugins();
-            if ( reportPlugins != null )
-            {
-                for ( Iterator j = reportPlugins.iterator(); j.hasNext(); )
-                {
-                    ReportPlugin plugin = (ReportPlugin) j.next();
-                    String pluginId = ArtifactUtils.versionlessKey( plugin.getGroupId(), plugin.getArtifactId() );
-                    if ( ( dag.getVertex( pluginId ) != null ) && !pluginId.equals( id ) )
-                    {
-                        addEdgeWithParentCheck( projectMap, pluginId, project, id );
-                    }
-                }
-            }
-
-            for ( Iterator j = project.getBuildExtensions().iterator(); j.hasNext(); )
-            {
-                Extension extension = (Extension) j.next();
-                String extensionId = ArtifactUtils.versionlessKey( extension.getGroupId(), extension.getArtifactId() );
-                if ( dag.getVertex( extensionId ) != null )
-                {
-                    addEdgeWithParentCheck( projectMap, extensionId, project, id );
-                }
-            }
-        List sortedProjects = new ArrayList();
+        List<MavenProject> sortedProjects = new ArrayList<MavenProject>();
-        for ( Iterator i = TopologicalSorter.sort( dag ).iterator(); i.hasNext(); )
+        List<String> sortedProjectLabels = TopologicalSorter.sort( dag );
+         
+        for( String id : sortedProjectLabels )
-            String id = (String) i.next();
-
-    private void addEdgeWithParentCheck( Map projectMap, String projectRefId, MavenProject project, String id )
+    private void addEdgeWithParentCheck( Map<String,MavenProject> projectMap, String projectRefId, MavenProject project, String id )
-    List getDependents( String id )
+    List<String> getDependents( String id )

INS74 INS70 INS70 INS60 INS70 INS74 MOV43 INS43 INS74 INS44 INS42 MOV8 INS44 INS42 MOV8 INS74 INS74 MOV59 INS44 INS42 MOV8 MOV43 MOV43 INS43 UPD42 MOV42 MOV43 MOV43 MOV43 INS43 INS42 INS43 INS42 INS70 MOV43 MOV43 MOV43 INS43 UPD42 MOV32 INS43 INS42 INS42 INS74 UPD42 MOV42 UPD42 MOV42 INS44 MOV32 MOV8 INS74 INS42 UPD42 MOV42 MOV43 MOV43 MOV43 MOV43 INS42 INS32 INS70 MOV43 MOV43 INS42 INS42 INS44 MOV32 MOV8 MOV43 INS42 DEL40 DEL26 DEL40 DEL26 DEL42 DEL42 DEL42 DEL32 DEL11 DEL59 DEL60 DEL42 DEL42 DEL42 DEL32 DEL11 DEL59 DEL60 DEL42 DEL42 DEL43 DEL42 DEL42 DEL32 DEL11 DEL59 DEL60 DEL42 DEL43 DEL42 DEL42 DEL32 DEL59 DEL58 DEL42 DEL42 DEL32 DEL24 DEL42 DEL59 DEL60 DEL42 DEL42 DEL42 DEL43 DEL42 DEL42 DEL32 DEL11 DEL59 DEL60 DEL42 DEL43 DEL42 DEL42 DEL42 DEL32 DEL59 DEL58 DEL42 DEL42 DEL32 DEL24 DEL42 DEL42 DEL42 DEL32 DEL59 DEL60 DEL42 DEL33 DEL27 DEL42 DEL43 DEL42 DEL42 DEL42 DEL32 DEL59 DEL58 DEL42 DEL42 DEL32 DEL42 DEL43 DEL42 DEL42 DEL43 DEL42 DEL42 DEL32 DEL11 DEL59 DEL60 DEL42 DEL43 DEL42 DEL42 DEL42 DEL42 DEL42 DEL32 DEL42 DEL42 DEL32 DEL32 DEL59 DEL60 DEL42 DEL42 DEL42 DEL32 DEL33 DEL27 DEL36 DEL42 DEL42 DEL42 DEL32 DEL38 DEL27 DEL42 DEL42 DEL42 DEL42 DEL42 DEL32 DEL21 DEL8 DEL25 DEL8 DEL24 DEL8 DEL25 DEL42 DEL43 DEL42 DEL42 DEL42 DEL32 DEL42 DEL32 DEL59 DEL58 DEL42 DEL42 DEL32 DEL42 DEL43 DEL42 DEL42 DEL43 DEL42 DEL42 DEL32 DEL11 DEL59 DEL60 DEL42 DEL42 DEL42 DEL42 DEL42 DEL32 DEL42 DEL42 DEL32 DEL32 DEL59 DEL60 DEL42 DEL42 DEL42 DEL32 DEL33 DEL27 DEL42 DEL42 DEL42 DEL42 DEL42 DEL32 DEL21 DEL8 DEL25 DEL8 DEL24 DEL43 DEL42 DEL42 DEL42 DEL32 DEL59 DEL58 DEL42 DEL42 DEL32 DEL24 DEL43 DEL42 DEL42 DEL42 DEL32 DEL59 DEL58 DEL42 DEL42 DEL32 DEL24 DEL42 DEL32 DEL42 DEL42 DEL42 DEL32 DEL11 DEL59 DEL60 DEL43 DEL58 DEL42 DEL42 DEL32 DEL24 DEL43