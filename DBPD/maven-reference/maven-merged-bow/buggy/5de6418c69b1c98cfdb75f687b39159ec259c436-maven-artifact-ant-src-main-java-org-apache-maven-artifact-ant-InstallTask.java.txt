PR: MNG-122
exception clean up phase 1

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@320668 13f79535-47bb-0310-9956-ffa450edef68

-    public void execute()
+    protected void doExecute()
+        ArtifactRepository localRepo = createLocalArtifactRepository();
+
+        MavenProjectBuilder builder = (MavenProjectBuilder) lookup( MavenProjectBuilder.ROLE );
+        Pom pom = buildPom( builder, localRepo );
+
+        Artifact artifact = createArtifact( pom );
+
+        boolean isPomArtifact = "pom".equals( pom.getPackaging() );
+        if ( !isPomArtifact )
+        {
+            ArtifactMetadata metadata = new ProjectArtifactMetadata( artifact, pom.getFile() );
+            artifact.addMetadata( metadata );
+        }
+
+        ArtifactInstaller installer = (ArtifactInstaller) lookup( ArtifactInstaller.ROLE );
-            ArtifactRepository localRepo = createLocalArtifactRepository();
-
-            MavenProjectBuilder builder = (MavenProjectBuilder) lookup( MavenProjectBuilder.ROLE );
-            Pom pom = buildPom( builder, localRepo );
-
-            Artifact artifact = createArtifact( pom );
-
-            boolean isPomArtifact = "pom".equals( pom.getPackaging() );
-                ArtifactMetadata metadata = new ProjectArtifactMetadata( artifact, pom.getFile() );
-                artifact.addMetadata( metadata );
+                installer.install( file, artifact, localRepo );
-
-            ArtifactInstaller installer = (ArtifactInstaller) lookup( ArtifactInstaller.ROLE );
-            try
+            else
-                if ( !isPomArtifact )
-                {
-                    installer.install( file, artifact, localRepo );
-                }
-                else
-                {
-                    installer.install( pom.getFile(), artifact, localRepo );
-                }
-            }
-            catch ( ArtifactInstallationException e )
-            {
-                // TODO: install exception that does not give a trace
-                throw new BuildException( "Error installing artifact", e );
+                installer.install( pom.getFile(), artifact, localRepo );
-        catch ( BuildException e )
+        catch ( ArtifactInstallationException e )
-            diagnoseError( e );
-            
-            throw e;
+            // TODO: install exception that does not give a trace
+            throw new BuildException( "Error installing artifact", e );

UPD83 UPD42 MOV8 DEL42 DEL43 DEL42 DEL44 DEL42 DEL42 DEL32 DEL21 DEL42 DEL53 DEL8 DEL12 DEL54 DEL8