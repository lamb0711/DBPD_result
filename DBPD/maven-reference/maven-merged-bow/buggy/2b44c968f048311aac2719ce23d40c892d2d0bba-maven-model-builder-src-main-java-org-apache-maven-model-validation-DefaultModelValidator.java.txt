o Extended model validator to support more than two validation levels

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@790338 13f79535-47bb-0310-9956-ffa450edef68

-        if ( !request.istLenientValidation() )
+        if ( request.getValidationLevel() >= ModelBuildingRequest.VALIDATION_LEVEL_MAVEN_2_0 )
-            validateDependencies( result, model.getDependencies(), "dependencies" );
+            validateDependencies( result, model.getDependencies(), "dependencies", request );
-                                      "dependencyManagment.dependencies" );
+                                      "dependencyManagment.dependencies", request );
-            validateRepositories( result, model.getRepositories(), "repositories.repository" );
+            validateRepositories( result, model.getRepositories(), "repositories.repository", request );
-            validateRepositories( result, model.getPluginRepositories(), "pluginRepositories.pluginRepository" );
+            validateRepositories( result, model.getPluginRepositories(), "pluginRepositories.pluginRepository", request );
-                    + "].dependencies" );
+                    + "].dependencies", request );
-                                          "profiles.profile[" + profile.getId() + "].dependencyManagment.dependencies" );
+                                          "profiles.profile[" + profile.getId() + "].dependencyManagment.dependencies",
+                                          request );
-                    + "].repositories.repository" );
+                    + "].repositories.repository", request );
-                    + "].pluginRepositories.pluginRepository" );
+                    + "].pluginRepositories.pluginRepository", request );
-        if ( !request.istLenientValidation() )
+        if ( request.getValidationLevel() >= ModelBuildingRequest.VALIDATION_LEVEL_MAVEN_2_0 )
+            boolean warnOnMissingPluginVersion =
+                request.getValidationLevel() < ModelBuildingRequest.VALIDATION_LEVEL_MAVEN_3_1;
+
-                    validateStringNotEmpty( "build.plugins.plugin.version", result, true, p.getVersion(), p.getKey() );
+                    validateStringNotEmpty( "build.plugins.plugin.version", result, warnOnMissingPluginVersion,
+                                            p.getVersion(), p.getKey() );
-                    validateStringNotEmpty( "reporting.plugins.plugin.groupId", result,false, p.getGroupId() );
+                    validateStringNotEmpty( "reporting.plugins.plugin.groupId", result, false, p.getGroupId() );
-                    validateStringNotEmpty( "reporting.plugins.plugin.version", result, true, p.getVersion(), p.getKey() );
+                    validateStringNotEmpty( "reporting.plugins.plugin.version", result, warnOnMissingPluginVersion,
+                                            p.getVersion(), p.getKey() );
-    private void validateDependencies( ModelValidationResult result, List<Dependency> dependencies, String prefix )
+    private void validateDependencies( ModelValidationResult result, List<Dependency> dependencies, String prefix,
+                                       ModelBuildingRequest request )
-                addViolation( result, false, "'" + prefix + ".(groupId:artifactId:type:classifier)' must be unique: " + key
-                    + " -> " + existing.getVersion() + " vs " + dependency.getVersion() );
+                boolean warning = request.getValidationLevel() < ModelBuildingRequest.VALIDATION_LEVEL_MAVEN_3_0;
+
+                addViolation( result, warning, "'" + prefix + ".(groupId:artifactId:type:classifier)' must be unique: "
+                    + key + " -> " + existing.getVersion() + " vs " + dependency.getVersion() );
-    private void validateRepositories( ModelValidationResult result, List<Repository> repositories, String prefix )
+    private void validateRepositories( ModelValidationResult result, List<Repository> repositories, String prefix,
+                                       ModelBuildingRequest request )
-                addViolation( result, false, "'" + prefix + ".id' must be unique: " + repository.getId() + " -> "
+                boolean warning = request.getValidationLevel() < ModelBuildingRequest.VALIDATION_LEVEL_MAVEN_3_0;
+
+                addViolation( result, warning, "'" + prefix + ".id' must be unique: " + repository.getId() + " -> "

INS44 INS44 INS43 INS42 INS43 INS42 INS27 INS27 INS42 INS42 INS32 INS40 INS32 INS40 INS60 MOV42 UPD42 MOV42 MOV42 UPD42 MOV42 INS39 INS59 INS42 INS42 INS42 INS42 INS27 INS60 INS60 INS32 INS40 INS39 INS59 INS39 INS59 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS27 INS42 INS42 INS27 INS42 INS32 INS40 INS32 INS40 INS42 INS42 INS42 INS42 INS42 INS42 INS42 DEL32 DEL38 DEL32 DEL38 DEL9 DEL9 DEL9 DEL9