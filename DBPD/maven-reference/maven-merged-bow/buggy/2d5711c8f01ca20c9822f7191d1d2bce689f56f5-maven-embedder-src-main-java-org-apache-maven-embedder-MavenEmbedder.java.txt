Adding SettingsBuilderAdvice, to enable skipping default locations for settings files. Also, removing the settings cache, to enable call-by-call synchronization of settings between Maven embedder instances that share the same settings files. Next step is to refresh settings per-call to the embedder.

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@511172 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.model.Plugin;
+import org.apache.maven.plugin.PluginManager;
+import org.apache.maven.plugin.PluginManagerException;
+import org.apache.maven.plugin.PluginNotFoundException;
+import org.codehaus.plexus.util.IOUtil;
+import java.io.FileWriter;
-import java.io.Reader;
-import org.apache.maven.model.Plugin;
-import org.apache.maven.plugin.PluginManager;
-import org.apache.maven.plugin.PluginManagerException;
-import org.apache.maven.plugin.PluginNotFoundException;
-
-
-    public static Settings readSettingsFromFile( Reader reader )
+    
+    public static Settings readSettings( File settingsFile )
-        return readSettingsFromFile( reader, null );
+        return readSettings( settingsFile, null );
-    public static Settings readSettingsFromFile( Reader reader, MavenEmbedderLogger logger )
+    public static Settings readSettings( File settingsFile, MavenEmbedderLogger logger )
+        FileReader reader = null;
+            reader = new FileReader( settingsFile );
+            
+            IOUtil.close( reader );
+            
-    public static void writeSettings( Writer writer, Settings settings )
+    public static void writeSettings( File settingsFile, Settings settings )
-        writeSettings( writer, settings, null );
+        writeSettings( settingsFile, settings, null );
-    public static void writeSettings( Writer writer, Settings settings, MavenEmbedderLogger logger )
+    public static void writeSettings( File settingsFile, Settings settings, MavenEmbedderLogger logger )
+        FileWriter writer = null;
+            writer = new FileWriter( settingsFile );
+            
+            IOUtil.close(  writer );
+            
-            settings = mavenTools.buildSettings( req.getUserSettingsFile(), req.getGlobalSettingsFile(), false );
+            settings = mavenTools.buildSettings( req.getUserSettingsFile(), req.getGlobalSettingsFile(), false,
+                                                 req.getSettingsBuilderAdvice() );

MOV26 MOV26 MOV26 MOV26 MOV26 INS26 INS40 UPD40 UPD42 UPD42 UPD43 UPD42 UPD43 UPD42 INS60 UPD43 UPD42 UPD43 UPD42 INS60 UPD42 UPD42 INS43 INS59 UPD42 UPD42 INS43 INS59 UPD42 UPD42 INS42 INS42 INS33 INS21 INS21 UPD42 INS42 INS42 INS33 INS21 INS21 INS7 INS32 INS7 INS32 INS42 INS14 INS42 INS42 INS42 INS42 INS14 INS42 INS42 INS42 INS43 INS42 INS43 INS42 INS32 INS42 INS42 INS42 INS42