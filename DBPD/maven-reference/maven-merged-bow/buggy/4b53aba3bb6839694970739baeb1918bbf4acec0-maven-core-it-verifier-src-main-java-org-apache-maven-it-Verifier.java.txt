Fixing issues related to MNG-377, where the plugins.xml metadata was being mishandled. Separated updating of this metadata into a separate mojo, bound to the 'package' phase, and put in a validator for the POM (POM has to have distributionRepository now for maven-plugin's) which is bound to the 'validate' phase. Put together an integration test that uses modello:java as a case where the pluginGroups must be consulted. Also had to change the Verifier to check a verifier.properties for failOnErrorOutput, which will suppress IT failures based on [ERROR] log output (modello outputs one of these, and kills the IT unnecessarily).

MNG-377 should be resolved at this point.


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@215890 13f79535-47bb-0310-9956-ffa450edef68

-    public void verify()
+    public void verify( boolean chokeOnErrorOutput )
-        lines = loadFile( basedir, LOG_FILENAME );
-
-        for ( Iterator i = lines.iterator(); i.hasNext(); )
+        if ( chokeOnErrorOutput )
-            String line = (String) i.next();
+            lines = loadFile( basedir, LOG_FILENAME );
-            if ( line.indexOf( "[ERROR]" ) >= 0 )
+            for ( Iterator i = lines.iterator(); i.hasNext(); )
-                throw new VerificationException( "Error in execution." );
+                String line = (String) i.next();
+
+                if ( line.indexOf( "[ERROR]" ) >= 0 )
+                {
+                    throw new VerificationException( "Error in execution." );
+                }
-
+        
+                Properties controlProperties = verifier.loadProperties( "verifier.properties" );
+
+                boolean chokeOnErrorOutput = Boolean.valueOf( controlProperties.getProperty( "failOnErrorOutput", "true" ) ).booleanValue();
+
-                verifier.verify();
+                System.out.println("*** Verifying: fail when [ERROR] detected? " + chokeOnErrorOutput + " ***");
+                
+                verifier.verify( chokeOnErrorOutput );

INS44 INS39 INS42 INS25 INS42 INS8 MOV21 MOV24 INS60 INS60 INS21 INS43 INS59 INS39 INS59 INS32 INS42 INS42 INS32 INS42 INS32 INS40 INS42 INS27 INS42 INS42 INS42 INS45 INS32 INS42 INS45 INS42 INS45 INS42 INS42 INS32 INS42 INS42 INS45 INS45