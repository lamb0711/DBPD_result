no need to throw an exception every time there is a compiler error, however make sure to process lines starting with "error: " as a compile error


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@163633 13f79535-47bb-0310-9956-ffa450edef68

-        if ( config.isDebug() )
-        {
-            args.add( "-g" );
-        }
-
+        if ( config.isDebug() )
+        {
+            args.add( "-g" );
+        }
+
-        if ( !ok.booleanValue() )
-        {
-            throw new Exception( "Failure executing javac: \n\n'javac " + args + "'\n\n" + err.toString() );
-        }
-
+        if ( !ok.booleanValue() && messages.isEmpty() )
+        {
+            // TODO: don't throw exception
+            throw new Exception( "Failure executing javac, but could not parse the error:\n\n" + err.toString() );
+        }
+
-                buffer.append( line );
+                if ( buffer.length() == 0 && line.startsWith( "error: " ) )
+                {
+                    errors.add( new CompilerError( line ) );
+                }
+                else
+                {
+                    buffer.append( line );
-                buffer.append( '\n' );
-            } while ( !line.endsWith( "^" ) );
+                    buffer.append( '\n' );
+                }
+            }
+            while ( !line.endsWith( "^" ) );
-            return new CompilerError( file, false, line, startcolumn, line, endcolumn, message );
+            return new CompilerError( file, true, line, startcolumn, line, endcolumn, message );
-}
+}

MOV25 MOV25 INS27 MOV38 INS32 INS42 INS42 INS25 UPD9 UPD45 INS27 INS8 INS8 INS27 INS32 INS21 MOV21 MOV21 INS32 INS34 INS42 INS42 INS45 INS32 INS42 INS42 INS42 INS42 INS14 INS43 INS42 INS42 DEL42 DEL45