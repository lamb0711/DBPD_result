fix missing optional dependencies in .wtpmodules, cleanup test and introduce a test using MavenEmbedder (currently disabled due to a couple of issues, but it should replace the command line test)

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@330946 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.artifact.resolver.ArtifactResolver;
-                         EclipseSourceDir[] sourceDirs, ArtifactRepository localRepository )
+                         EclipseSourceDir[] sourceDirs, ArtifactRepository localRepository,
+                         ArtifactResolver artifactResolver, List remoteArtifactRepositories )
-            writeWarSpecificResources( writer, basedir, project, referencedReactorArtifacts, localRepository );
+            writeWarSpecificResources( writer, basedir, project, referencedReactorArtifacts, localRepository,
+                                       artifactResolver, remoteArtifactRepositories );
-                                           List referencedReactorArtifacts, ArtifactRepository localRepository )
+                                           List referencedReactorArtifacts, ArtifactRepository localRepository,
+                                           ArtifactResolver artifactResolver, List remoteArtifactRepositories )
+
+        EclipseUtils.fixMissingOptionalArtifacts( artifacts, project.getDependencyArtifacts(), localRepository,
+                                                  artifactResolver, remoteArtifactRepositories, log );
+

INS26 INS40 INS44 INS44 INS44 INS44 INS43 INS42 INS43 INS42 INS43 INS42 INS43 INS42 INS21 INS42 INS42 INS42 INS42 INS32 INS42 INS42 INS42 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42