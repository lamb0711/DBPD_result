o Introduced RepositoryRequest to hold the bare minimum of items required for repo accesses
o Added cache for metadata.xml

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@803059 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.artifact.repository.DefaultRepositoryRequest;
+import org.apache.maven.artifact.repository.RepositoryRequest;
-     * @param localRepository
-     * @param remoteRepositories
+     * @param repositoryRequest
-    public synchronized PluginDescriptor loadPlugin( Plugin plugin, ArtifactRepository localRepository, List<ArtifactRepository> remoteRepositories )
+    public synchronized PluginDescriptor loadPlugin( Plugin plugin, RepositoryRequest repositoryRequest )
-        PluginDescriptor pluginDescriptor = pluginCache.getPluginDescriptor( plugin, localRepository, remoteRepositories );
+        PluginDescriptor pluginDescriptor =
+            pluginCache.getPluginDescriptor( plugin, repositoryRequest.getLocalRepository(),
+                                             repositoryRequest.getRemoteRepositories() );
-        ArtifactResolutionRequest request = new ArtifactResolutionRequest()
+        ArtifactResolutionRequest request = new ArtifactResolutionRequest( repositoryRequest )
-            .setLocalRepository( localRepository )
-            .setRemoteRepositories( remoteRepositories )
-            pluginCache.putPluginDescriptor( plugin, localRepository, remoteRepositories, pluginDescriptor );
+            pluginCache.putPluginDescriptor( plugin, repositoryRequest.getLocalRepository(),
+                                             repositoryRequest.getRemoteRepositories(), pluginDescriptor );
-    List<Artifact> getPluginArtifacts( Artifact pluginArtifact, Plugin pluginAsSpecifiedInPom, ArtifactRepository localRepository, List<ArtifactRepository> remoteRepositories )
+    List<Artifact> getPluginArtifacts( Artifact pluginArtifact, Plugin pluginAsSpecifiedInPom, RepositoryRequest repositoryRequest )
-        ArtifactResolutionRequest request = new ArtifactResolutionRequest()
+        ArtifactResolutionRequest request = new ArtifactResolutionRequest( repositoryRequest )
-            .setLocalRepository( localRepository )
-            .setRemoteRepositories( remoteRepositories )
+        
-            pluginArtifacts = getPluginArtifacts( pluginArtifact, plugin, localRepository, remoteRepositories );
+            RepositoryRequest request = new DefaultRepositoryRequest();
+            request.setLocalRepository( localRepository );
+            request.setRemoteRepositories( remoteRepositories );
+            request.setCache( session.getRepositoryCache() );
+            pluginArtifacts = getPluginArtifacts( pluginArtifact, plugin, request );
-    public MojoDescriptor getMojoDescriptor( String groupId, String artifactId, String version, String goal, ArtifactRepository localRepository, List<ArtifactRepository> remoteRepositories )
+    public MojoDescriptor getMojoDescriptor( String groupId, String artifactId, String version, String goal, RepositoryRequest repositoryRequest )
-        return getMojoDescriptor( plugin, goal, localRepository, remoteRepositories );
+        return getMojoDescriptor( plugin, goal, repositoryRequest );
-    public MojoDescriptor getMojoDescriptor( Plugin plugin, String goal, ArtifactRepository localRepository, List<ArtifactRepository> remoteRepositories )
+    public MojoDescriptor getMojoDescriptor( Plugin plugin, String goal, RepositoryRequest repositoryRequest )
-        PluginDescriptor pluginDescriptor = loadPlugin( plugin, localRepository, remoteRepositories );
+        PluginDescriptor pluginDescriptor = loadPlugin( plugin, repositoryRequest );

INS26 INS26 INS40 INS40 INS43 UPD42 INS43 UPD42 INS43 UPD42 INS43 UPD42 UPD42 UPD42 MOV42 UPD42 MOV42 MOV43 UPD42 MOV42 UPD42 MOV42 MOV32 INS60 INS21 INS21 INS21 UPD42 INS32 INS32 UPD42 INS9 INS43 INS59 INS32 INS32 INS32 UPD42 INS42 UPD42 MOV42 INS42 UPD42 MOV42 INS32 INS32 INS42 INS42 INS14 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS32 INS42 INS42 UPD42 MOV42 INS42 UPD42 MOV42 MOV32 INS43 INS42 INS42 UPD42 INS42 MOV43 INS42 DEL42 DEL65 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL43 DEL74 DEL42 DEL42 DEL42 DEL32 DEL42 DEL9 DEL32 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL43 DEL74 DEL42 DEL42 DEL32 DEL42 DEL42 DEL32 DEL42 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL43 DEL74 DEL42 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL43 DEL74 DEL42