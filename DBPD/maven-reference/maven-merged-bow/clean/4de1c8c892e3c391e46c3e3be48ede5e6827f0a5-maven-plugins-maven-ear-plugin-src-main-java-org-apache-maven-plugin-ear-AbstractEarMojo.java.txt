Fixing MNG-623: "Improve the exclusion / inclusion of a dependency inside the
                ear"
Committing on behalf of Stephane Nicoll.
Provides two new flags to customize ear modules: 

* excluded ; if set the module is not bundle in the EAR file 
* library ; if set the java module is considered as a 3rd party library and no
  entry is generated in the application.xml 
 
The patch also update the documentation.


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@232833 13f79535-47bb-0310-9956-ffa450edef68

-import java.util.Arrays;
+    private List allModules;
+
+        allModules = new ArrayList();
+
-
+                    allModules.add( module );
-            earModules = new ArrayList( Arrays.asList( modules ) );
-        }
-        else
-        {
-            earModules = new ArrayList();
-            if ( !isArtifactRegistered( artifact, earModules ) &&
-                 !Artifact.SCOPE_TEST.equals( artifact.getScope() ) &&
-                 !Artifact.SCOPE_PROVIDED.equals( artifact.getScope() ) )
+            if ( !isArtifactRegistered( artifact, allModules ) && !Artifact.SCOPE_TEST.equals( artifact.getScope() ) &&
+                !Artifact.SCOPE_PROVIDED.equals( artifact.getScope() ) )
-                earModules.add( module );
+                allModules.add( module );
+            }
+        }
+
+        // Now we have everything let's built modules which have not been excluded
+        earModules = new ArrayList();
+        for ( Iterator iter = allModules.iterator(); iter.hasNext(); )
+        {
+            EarModule earModule = (EarModule) iter.next();
+            if ( earModule.isExcluded() )
+            {
+                getLog().debug( "Skipping ear module[" + earModule + "]" );
+            }
+            else
+            {
+                earModules.add( earModule );

INS23 INS83 INS43 INS59 INS42 INS42 MOV21 MOV21 INS24 INS58 INS32 INS8 UPD42 INS43 INS59 INS42 INS42 INS60 INS25 INS42 INS42 INS32 INS43 INS59 INS32 INS8 INS8 INS42 INS42 INS42 INS42 INS11 INS42 INS42 INS21 INS21 INS43 INS32 INS32 INS32 INS21 UPD42 UPD42 INS42 INS42 INS42 INS32 INS42 INS27 INS42 INS42 INS42 INS32 INS42 INS45 INS42 INS45 INS42 INS42 INS42 DEL40 DEL26 DEL42 DEL42 DEL42 DEL32 DEL8