o Changed maven-core's super-pom from pom.xml to pom-4.0.0.xml
o Added validation logic for non-heritable pom elements to the default project builder
o Changed default builder to select the correct super-pom from the project pom's modelVersion.


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@163086 13f79535-47bb-0310-9956-ffa450edef68

-            // TODO: rename to super-pom.xml so it is not used by the reactor
-            superModel = modelReader.read( new InputStreamReader( DefaultMavenProjectBuilder.class.getResourceAsStream( "pom.xml" ) ) );
-
+                
+                validateLeafModel(userModel);
+                
+                // TODO: rename to super-pom.xml so it is not used by the reactor
+                superModel = modelReader.read( new InputStreamReader( DefaultMavenProjectBuilder.class.getResourceAsStream( "pom-" + userModel.getModelVersion() + ".xml" ) ) );
+                
+    private void validateLeafModel( Model userModel )
+    {
+        String modelVersion = userModel.getModelVersion();
+        if ( modelVersion == null || modelVersion.length() < 1 )
+        {
+            throw new IllegalStateException( "POM element \'modelVersion\' must be specified; it may not be inherited" );
+        }
+
+        String name = userModel.getName();
+        if ( name == null || name.length() < 1 )
+        {
+            throw new IllegalStateException( "POM element \'name\' must be specified; it may not be inherited" );
+        }
+
+        String artifactId = userModel.getArtifactId();
+        if ( artifactId == null || artifactId.length() < 1 )
+        {
+            throw new IllegalStateException( "POM element \'artifactId\' must be specified; it may not be inherited" );
+        }
+
+        String version = userModel.getVersion();
+        if ( version == null || version.length() < 1 )
+        {
+            throw new IllegalStateException( "POM element \'version\' must be specified; it may not be inherited" );
+        }
+
+    }
+

INS31 INS83 INS39 INS42 INS44 INS8 INS43 INS42 INS60 INS25 INS60 INS25 INS60 INS25 INS60 INS25 INS42 INS43 INS59 INS27 INS8 INS43 INS59 INS27 INS8 INS43 INS59 INS27 INS8 INS43 INS59 INS27 INS8 INS42 INS42 INS32 INS27 INS27 INS53 INS42 INS42 INS32 INS27 INS27 INS53 INS42 INS42 INS32 INS27 INS27 INS53 INS42 INS42 INS32 INS27 INS27 INS53 INS42 INS42 INS42 INS33 INS32 INS34 INS14 INS42 INS42 INS42 INS33 INS32 INS34 INS14 INS42 INS42 INS42 INS33 INS32 INS34 INS14 INS42 INS42 INS42 INS33 INS32 INS34 INS14 INS21 MOV21 INS42 INS42 INS43 INS45 INS42 INS42 INS43 INS45 INS42 INS42 INS43 INS45 INS42 INS42 INS43 INS45 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS27 INS45 INS32 INS45 INS42 INS42 DEL45