MNG-3887: order of plugin executions, MNG-3864: plugin configs are collapsed, MNG-4000: Plugin executions without id are lost

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@737633 13f79535-47bb-0310-9956-ffa450edef68

-            boolean hasAtLeastOneWithoutId = true;
+            boolean hasAtLeastOneWithoutId = false;
-                if ( hasAtLeastOneWithoutId )
-                {
-                    hasAtLeastOneWithoutId = hasExecutionId( executionContainer );
-                }
+
-                if ( !hasAtLeastOneWithoutId && !hasExecutionId( executionContainer ) && executionContainers.indexOf( executionContainer ) > 0 )
+                if ( hasAtLeastOneWithoutId && !hasExecutionId( executionContainer ) && executionContainers.indexOf( executionContainer ) > 0 )
+                if ( !hasAtLeastOneWithoutId )
+                {
+                    hasAtLeastOneWithoutId = !hasExecutionId( executionContainer );
+                }                
-                //List<ModelProperty> x = rule.execute(es.getProperties());
-                List<ModelProperty> x = (!joinedContainer) ? rule.execute(es.getProperties()) :
-                        ModelTransformerContext.sort(rule.execute(es.getProperties()),
-                                ProjectUri.Build.Plugins.Plugin.Executions.Execution.xUri);
+                List<ModelProperty> x = rule.execute(es.getProperties());
+               // List<ModelProperty> x = (!joinedContainer) ? rule.execute(es.getProperties()) :
+               //         ModelTransformerContext.sort(rule.execute(es.getProperties()),
+               //                 ProjectUri.Build.Plugins.Plugin.Executions.Execution.xUri);
-        props = dataSource.getModelProperties();
+        props = joinedContainer ? ModelTransformerContext.sort(dataSource.getModelProperties(), ProjectUri.baseUri)
+                : dataSource.getModelProperties();

INS16 MOV25 INS42 INS32 INS32 UPD9 INS42 INS42 MOV32 INS40 INS42 INS42 MOV38 INS42 MOV32 INS38 INS32 MOV42 MOV42 DEL42 DEL32 DEL42 DEL38 DEL36 DEL42 DEL42 DEL42 DEL42 DEL42 DEL42 DEL32 DEL32 DEL40 DEL32 DEL16