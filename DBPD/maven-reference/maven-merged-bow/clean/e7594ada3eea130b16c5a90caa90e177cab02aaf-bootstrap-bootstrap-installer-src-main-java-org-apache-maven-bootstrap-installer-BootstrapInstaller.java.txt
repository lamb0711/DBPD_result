MNG-2560 patch applied to make the bootstrap easier
Submitted by: Dan Fabulich


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@453099 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.maven.bootstrap.model.Dependency;
-import org.apache.maven.bootstrap.model.Model;
+import org.apache.maven.bootstrap.download.*;
+import org.apache.maven.bootstrap.model.*;
-    private final String prefix;
+    private final String destDir;
-        this.prefix = parser.getArgumentValue( "--prefix" );
+        this.destDir = parser.getArgumentValue( "--destDir" );
-        parser.addArgument( "--prefix", "The location to install Maven", true, getDefaultPrefix() );
+        parser.addArgument( "--destDir", "The location to install Maven", true, getDefaultPrefix() );
+        Model mavenRootModel = bootstrapper.readModel(new File(basedir, "pom.xml"), false);
+
+        String finalName = "maven-" + mavenRootModel.getVersion();
+        
+        File destDirFile = new File(destDir);
+        if (!finalName.equals(destDirFile.getName())) {
+        	throw new Exception("The Maven install destination directory must end with '" + finalName + "'.\n"
+        			+ "Your destDir was = " + destDirFile.getAbsolutePath() + "\n"
+        			+ "we recommend = " + new File(destDirFile.getParent(), finalName).getAbsolutePath());
+        }
+        
-
+        
-        String finalName = "maven-" + mavenCliModel.getVersion();
-        File mavenHome = new File( prefix, finalName );
+        File mavenHome = new File( destDir );
-        expand.setDest( new File( prefix ) );
+        expand.setDest( new File( destDir ).getParentFile() );

UPD40 UPD40 MOV60 UPD42 INS60 INS60 INS25 INS43 INS59 INS43 INS59 INS38 INS8 INS43 UPD45 INS42 INS42 INS32 INS42 INS42 INS14 INS32 INS53 INS42 INS32 UPD42 UPD45 INS42 INS42 INS14 INS9 INS43 INS42 INS42 INS42 INS32 INS14 UPD42 MOV14 INS42 INS43 INS42 INS45 UPD42 INS42 INS42 INS42 INS43 INS27 UPD42 INS42 INS42 INS45 INS42 INS45 INS45 INS32 INS45 INS45 INS32 INS42 INS42 INS14 INS42 MOV43 INS32 INS42 INS42 INS42 DEL42