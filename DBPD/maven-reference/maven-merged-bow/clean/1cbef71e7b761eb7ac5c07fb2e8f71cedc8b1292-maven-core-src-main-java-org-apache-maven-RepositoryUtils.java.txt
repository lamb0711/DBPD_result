[MNG-4779] NullPointerException thrown during dependency resolution when dependency with range occurs more than once in the dirty tree
[MNG-4781] Can't deploy to Nexus staging repository


git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@990771 13f79535-47bb-0310-9956-ffa450edef68

-            props = Collections.singletonMap( ArtifactProperties.LACKS_DESCRIPTOR, Boolean.TRUE.toString() );
+            String localPath = ( artifact.getFile() != null ) ? artifact.getFile().getPath() : "";
+            props = Collections.singletonMap( ArtifactProperties.LOCAL_PATH, localPath );
-            props = Collections.singletonMap( ArtifactProperties.LACKS_DESCRIPTOR, Boolean.TRUE.toString() );
+            props = Collections.singletonMap( ArtifactProperties.LOCAL_PATH, dependency.getSystemPath() );
-        if ( system )
-        {
-            artifact = artifact.setFile( new File( dependency.getSystemPath() ) );
-        }
-

INS60 INS43 INS59 INS42 INS42 INS16 INS36 INS32 INS45 UPD40 UPD42 MOV42 UPD40 MOV32 INS27 INS32 INS42 INS32 INS33 INS42 INS42 INS42 INS42 DEL40 DEL32 DEL40 DEL42 DEL32 DEL42 DEL42 DEL42 DEL42 DEL42 DEL43 DEL14 DEL32 DEL7 DEL21 DEL8 DEL25