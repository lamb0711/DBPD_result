Fixing case where non-POM artifacts are passed to the project builder for parsing...doing defensive construction of POM artifacts inside the project builder, and fixed the call in the DependenciesReport.

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@280903 13f79535-47bb-0310-9956-ffa450edef68

-        MavenProject project = getCachedProject( artifact.getGroupId(), artifact.getArtifactId(),
-                                                 artifact.getVersion() );
+        Artifact projectArtifact;
+        
+        if ( "pom".equals( artifact.getType() ) )
+        {
+            projectArtifact = artifact;
+        }
+        else
+        {
+            getLogger().warn(
+                              "Attempting to build MavenProject instance for Artifact of type: " + artifact.getType()
+                                  + "; constructing POM artifact instead." );
+            
+            projectArtifact = artifactFactory.createProjectArtifact( artifact.getGroupId(), artifact.getArtifactId(),
+                                                                     artifact.getVersion(), artifact.getScope() );
+        }
+        
+        MavenProject project = getCachedProject( projectArtifact.getGroupId(), projectArtifact.getArtifactId(),
+                                                 projectArtifact.getVersion() );
-                artifactResolver.resolve( artifact, remoteArtifactRepositories, localRepository );
+                artifactResolver.resolve( projectArtifact, remoteArtifactRepositories, localRepository );
-                File file = artifact.getFile();
+                File file = projectArtifact.getFile();
-                if ( !artifact.isSnapshot() && status.compareTo( ArtifactStatus.DEPLOYED ) < 0 )
+                if ( !projectArtifact.isSnapshot() && status.compareTo( ArtifactStatus.DEPLOYED ) < 0 )
-                            artifact.getArtifactId() + ": updating metadata due to status of '" + status + "'" );
+                            projectArtifact.getArtifactId() + ": updating metadata due to status of '" + status + "'" );
-                            artifact.setResolved( false );
-                            artifactResolver.resolveAlways( artifact, remoteArtifactRepositories, localRepository );
+                            projectArtifact.setResolved( false );
+                            artifactResolver.resolveAlways( projectArtifact, remoteArtifactRepositories, localRepository );
-                    artifact.setDownloadUrl( downloadUrl );
+                    projectArtifact.setDownloadUrl( downloadUrl );
-                    artifact.setDownloadUrl( model.getUrl() );
+                    projectArtifact.setDownloadUrl( model.getUrl() );
-                getLogger().warn( "\n  ***** Using defaults for missing POM " + artifact.getId() + " *****\n" );
+                getLogger().warn( "\n  ***** Using defaults for missing POM " + projectArtifact.getId() + " *****\n" );
-                model.setArtifactId( artifact.getArtifactId() );
-                model.setGroupId( artifact.getGroupId() );
-                model.setVersion( artifact.getVersion() );
+                model.setArtifactId( projectArtifact.getArtifactId() );
+                model.setGroupId( projectArtifact.getGroupId() );
+                model.setVersion( projectArtifact.getVersion() );
-                model.setPackaging( artifact.getType() );
+                model.setPackaging( projectArtifact.getType() );

INS60 INS25 INS43 INS59 MOV32 INS8 INS8 INS42 INS42 INS45 UPD42 INS21 INS21 INS21 INS32 INS7 INS32 INS7 INS42 INS32 INS32 INS32 INS42 INS42 MOV32 INS42 INS27 INS42 MOV32 INS42 INS42 INS42 INS42 INS42 INS42 INS45 INS32 INS45 INS42 UPD42 INS32 INS42 INS42 INS42 INS42 UPD42 INS32 UPD42 INS42 INS42 INS32 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 INS42 INS42 UPD42 INS32 INS42 UPD42 UPD42 UPD42 DEL42