o Kept active external and POM profiles separate in model building result

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@784583 13f79535-47bb-0310-9956-ffa450edef68

+        result.setActiveExternalProfiles( activeExternalProfiles );
+
-            List<Profile> activeProjectProfiles =
-                getActiveProjectProfiles( rawModel, profileActivationContext, problems );
+            List<Profile> activePomProfiles = getActivePomProfiles( rawModel, profileActivationContext, problems );
-            List<Profile> activeProfiles = activeProjectProfiles;
-            if ( current == model )
-            {
-                activeProfiles = new ArrayList<Profile>( activeProjectProfiles.size() + activeExternalProfiles.size() );
-                activeProfiles.addAll( activeProjectProfiles );
-                activeProfiles.addAll( activeExternalProfiles );
-            }
+            result.setActivePomProfiles( rawModel, activePomProfiles );
-            for ( Profile activeProfile : activeProfiles )
+            for ( Profile activeProfile : activePomProfiles )
-            result.setActiveProfiles( rawModel, activeProfiles );
+            if ( current == model )
+            {
+                for ( Profile activeProfile : activeExternalProfiles )
+                {
+                    profileInjector.injectProfile( resultModel, activeProfile, request );
+                }
+            }
-    private List<Profile> getActiveProjectProfiles( Model model, ProfileActivationContext context,
-                                                    List<ModelProblem> problems )
+    private List<Profile> getActivePomProfiles( Model model, ProfileActivationContext context,
+                                                List<ModelProblem> problems )

UPD42 INS21 INS32 INS42 INS42 INS42 INS21 INS70 INS25 INS32 INS44 INS42 INS8 MOV27 INS8 UPD42 INS42 INS42 INS42 INS42 INS43 INS42 MOV21 MOV70 UPD42 MOV42 UPD42 UPD42 UPD42 UPD42 UPD42 INS42 DEL42 DEL43 DEL42 DEL43 DEL74 DEL42 DEL42 DEL59 DEL60 DEL42 DEL42 DEL43 DEL43 DEL74 DEL42 DEL42 DEL32 DEL42 DEL42 DEL32 DEL27 DEL14 DEL7 DEL21 DEL42 DEL42 DEL42 DEL32 DEL21 DEL42 DEL42 DEL42 DEL32 DEL21 DEL8 DEL25