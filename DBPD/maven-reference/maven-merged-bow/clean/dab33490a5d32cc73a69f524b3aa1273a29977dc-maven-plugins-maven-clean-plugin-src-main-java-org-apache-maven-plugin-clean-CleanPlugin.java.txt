most basic of field based plugins


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@163627 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.maven.plugin.PluginExecutionRequest;
-import org.apache.maven.plugin.PluginExecutionResponse;
+import org.apache.maven.plugin.PluginExecutionException;
- * @goal clean
- *
- * @description Goal which cleans the build
- *
- * @parameter
- *  name="outputDirectory"
- *  type="String"
- *  required="true"
- *  validator=""
- *  expression="#project.build.directory"
- *  description=""
- *
+ * @goal clean
+ * @description Goal which cleans the build
+ * @parameter name="outputDirectory"
+ * type="String"
+ * required="true"
+ * validator=""
+ * expression="#project.build.directory"
+ * description=""
-    private boolean failOnError;
-
-    public void execute( PluginExecutionRequest request, PluginExecutionResponse response )
-        throws Exception
+    // TODO: not in the descriptor previously
+//    private boolean failOnError;
+    public boolean supportsNewMojoParadigm()
-        try
+        return true;
+    }
+
+    public void execute()
+        throws PluginExecutionException
+    {
+        if ( outputDirectory != null )
-            outputDirectory = (String) request.getParameter( "outputDirectory" );
+            File dir = new File( outputDirectory );
-            failOnError = Boolean.valueOf( (String) request.getParameter( "failedOnError" ) ).booleanValue();
-            
-            if ( outputDirectory != null )
+            if ( dir.exists() && dir.isDirectory() )
-                File dir = new File( outputDirectory );
-
-                if ( dir.exists() && dir.isDirectory() )
+                getLog().info( "Deleting directory " + dir.getAbsolutePath() );
+                try
-                    getLog().info( "Deleting directory " + dir.getAbsolutePath() );
+                catch ( Exception e )
+                {
+                    throw new PluginExecutionException( "Unable to delete directory", e );
+                }
-        finally
-        {
-            // clean up state.
-            failOnError = false;
-            outputDirectory = null;
-        }
-    protected void removeDir( File d ) throws Exception
+    protected void removeDir( File d )
+        throws Exception
-                //log("Deleting " + f.getAbsolutePath());
-                    String message = "Unable to delete file "
-                        + f.getAbsolutePath();
-                    if ( failOnError )
-                    {
-                        throw new Exception( message );
-                    }
-                    else
-                    {
+                    String message = "Unable to delete file " + f.getAbsolutePath();
+// TODO:...
+//                    if ( failOnError )
+//                    {
+//                        throw new Exception( message );
+//                    }
+//                    else
+//                    {
-                    }
+//                    }
-        //log("Deleting directory " + d.getAbsolutePath());
+
-            String message = "Unable to delete directory "
-                + d.getAbsolutePath();
-            if ( failOnError )
-            {
-                throw new Exception( message );
-            }
-            else
-            {
+            String message = "Unable to delete directory " + d.getAbsolutePath();
+// TODO:...
+//            if ( failOnError )
+//            {
+//                throw new Exception( message );
+//            }
+//            else
+//            {
-            }
+//            }

UPD40 MOV65 MOV65 INS31 INS83 INS39 INS42 INS8 INS43 MOV8 UPD66 INS41 UPD42 MOV42 INS9 MOV8 MOV60 INS54 INS8 INS12 MOV21 INS44 INS8 MOV21 MOV43 INS42 INS53 INS14 INS43 INS45 INS42 INS42 DEL40 DEL26 DEL83 DEL39 DEL42 DEL59 DEL23 DEL42 DEL42 DEL43 DEL42 DEL42 DEL45 DEL32 DEL11 DEL7 DEL21 DEL42 DEL42 DEL42 DEL42 DEL43 DEL42 DEL42 DEL45 DEL32 DEL11 DEL32 DEL42 DEL32 DEL7 DEL21 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL9 DEL7 DEL21 DEL42 DEL33 DEL7 DEL21 DEL8 DEL54 DEL8 DEL42 DEL42 DEL14 DEL53 DEL8 DEL25 DEL42 DEL42 DEL43 DEL42 DEL14 DEL53 DEL8 DEL8 DEL25 DEL8