o Changed Set to List for remote repo handling so that we can maintain declarative ordering in remote repos we use.
o Added UserModel support, integrated with maven-artifact and wagon via AuthenticationInfoProvider implementation.


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@163501 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.model.Repository;
-import org.apache.maven.repository.RepositoryUtils;
-import java.util.Set;
- * @version $Id$
+ * @version $Id: DefaultMavenProjectBuilder.java,v 1.37 2005/03/08 01:55:22
+ *          trygvis Exp $
-            Set aggregatedRemoteWagonRepositories = RepositoryUtils.mavenToWagon( superModel.getRepositories() );
-            MavenProject project = assembleLineage( projectDescriptor, localRepository, lineage,
+            List aggregatedRemoteWagonRepositories = buildArtifactRepositories( superModel.getRepositories() );
+            MavenProject project = assembleLineage( projectDescriptor,
+                                                    localRepository,
+                                                    lineage,
-                Set repos = RepositoryUtils.mavenToWagon( project.getRepositories() );
+                List repos = buildArtifactRepositories( project.getRepositories() );
-                                          LinkedList lineage, Set aggregatedRemoteWagonRepositories )
+                                          LinkedList lineage, List aggregatedRemoteWagonRepositories )
-            aggregatedRemoteWagonRepositories.addAll( RepositoryUtils.mavenToWagon( model.getRepositories() ) );
+            aggregatedRemoteWagonRepositories.addAll( buildArtifactRepositories( model.getRepositories() ) );
-    private Model readModel( File file )
-        throws ProjectBuildingException
+    private List buildArtifactRepositories( List repositories )
+    {
+        List repos = new ArrayList();
+        for ( Iterator i = repositories.iterator(); i.hasNext(); )
+        {
+            Repository mavenRepo = (Repository) i.next();
+
+            ArtifactRepository artifactRepo = new ArtifactRepository( mavenRepo.getId(), mavenRepo.getUrl() );
+
+            if ( !repos.contains( artifactRepo ) )
+            {
+                repos.add( artifactRepo );
+            }
+        }
+        return repos;
+    }
+
+    private Model readModel( File file ) throws ProjectBuildingException
-    private File findParentModel( Parent parent, Set remoteArtifactRepositories, ArtifactRepository localRepository )
+    private File findParentModel( Parent parent, List remoteArtifactRepositories, ArtifactRepository localRepository )

MOV26 UPD40 INS31 INS83 INS43 INS42 INS44 INS8 UPD66 INS66 UPD43 INS42 INS43 INS42 INS60 INS24 INS41 UPD43 UPD42 INS42 INS43 INS59 INS58 INS32 INS8 INS42 UPD42 INS42 INS42 INS14 INS43 INS59 INS42 INS42 INS60 INS60 INS25 UPD43 INS43 INS42 INS42 INS32 INS43 INS59 INS43 INS59 INS38 INS8 UPD42 INS42 INS42 INS42 INS42 INS42 INS11 INS42 INS42 INS14 INS32 INS21 UPD42 UPD43 UPD42 INS43 INS32 INS43 INS32 INS32 INS42 INS42 INS42 INS32 UPD42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 UPD42 DEL40 DEL26 DEL42 DEL42 DEL42