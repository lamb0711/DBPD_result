[MNG-4933] With a resource directory as . maven raise an java.lang.StringIndexOutOfBoundsException:217

o Aligned code with r1050425 of https://svn.apache.org/repos/asf/maven/maven-2/branches/maven-2.2.x/maven-project/src/main/java/org/apache/maven/project/path/DefaultPathTranslator.java
o Fixed special case of path=${basedir} to yield valid/non-empty path "."

git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@1054712 13f79535-47bb-0310-9956-ffa450edef68

+        if ( basedir == null )
+        {
+            return;
+        }
+
+        if ( basedir == null )
+        {
+            return path;
+        }
+
+        if ( basedir == null )
+        {
+            return;
+        }
+
-    public String unalignFromBaseDirectory( String directory, File basedir )
+    public String unalignFromBaseDirectory( String path, File basedir )
-        String path = basedir.getPath();
-        if ( directory.startsWith( path ) )
+        if ( basedir == null )
-            directory = directory.substring( path.length() + 1 ).replace( '\\', '/' );
+            return path;
-        return directory;
+
+        if ( path == null )
+        {
+            return null;
+        }
+
+        path = path.trim();
+
+        String base = basedir.getAbsolutePath();
+        if ( path.startsWith( base ) )
+        {
+            path = chopLeadingFileSeparator( path.substring( base.length() ) );
+        }
+
+        if ( path.length() <= 0 )
+        {
+            path = ".";
+        }
+
+        if ( !new File( path ).isAbsolute() )
+        {
+            path = path.replace( '\\', '/' );
+        }
+
+        return path;

INS25 INS25 INS25 UPD42 INS25 INS25 INS21 INS25 INS25 INS27 INS8 INS27 INS8 INS27 INS8 INS27 INS8 INS27 INS8 INS7 INS32 INS8 UPD27 MOV27 INS8 INS38 UPD42 INS42 INS33 INS41 INS42 INS33 INS41 INS42 INS33 INS41 INS42 INS33 INS41 INS42 INS33 INS41 INS42 INS32 UPD42 INS42 INS42 INS42 INS21 UPD34 INS21 INS32 INS42 INS42 INS33 INS42 INS42 UPD42 INS7 INS7 INS14 UPD42 MOV42 INS42 INS32 INS42 INS45 INS43 INS42 UPD42 INS42 INS32 INS42 UPD42 MOV42 INS42 INS42 INS32 INS42 INS42 DEL42 DEL42 DEL32 DEL42 DEL32