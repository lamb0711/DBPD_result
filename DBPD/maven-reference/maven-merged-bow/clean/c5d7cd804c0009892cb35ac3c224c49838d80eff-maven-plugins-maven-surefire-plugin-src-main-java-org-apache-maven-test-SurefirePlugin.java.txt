convert surefire plugin to new execute()


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@163663 13f79535-47bb-0310-9956-ffa450edef68

+/*
+ * Copyright 2001-2005 The Apache Software Foundation.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
-import org.apache.maven.plugin.PluginExecutionRequest;
-import org.apache.maven.plugin.PluginExecutionResponse;
+import org.apache.maven.plugin.PluginExecutionException;
-    public void execute( PluginExecutionRequest request, PluginExecutionResponse response )
-        throws Exception
+    private String mavenRepoLocal;
+
+    private String basedir;
+
+    private String classesDirectory;
+
+    private String testClassesDirectory;
+
+    private List classpathElements;
+
+    private String reportsDirectory;
+
+    private String test;
+
+    private List includes;
+
+    private List excludes;
+
+    public void execute()
+        throws PluginExecutionException
-        //
-        // ----------------------------------------------------------------------
-
-        String mavenRepoLocal = (String) request.getParameter( "mavenRepoLocal" );
-
-        String basedir = (String) request.getParameter( "basedir" );
-
-        String classesDirectory = (String) request.getParameter( "classesDirectory" );
-
-        String testClassesDirectory = (String) request.getParameter( "testClassesDirectory" );
-
-        List testClasspathElements = (List) request.getParameter( "classpathElements" );
-
-        String reportsDirectory = (String) request.getParameter( "reportsDirectory" );
-
-        String test = (String) request.getParameter( "test" );
-
-        // ----------------------------------------------------------------------
-        System.out.println("Setting reports dir: " + reportsDirectory);
+        System.out.println( "Setting reports dir: " + reportsDirectory );
-        
+
-            List includes = (List) request.getParameter( "includes" );
-
-            List excludes = (List) request.getParameter( "excludes" );
-
-        for ( Iterator i = testClasspathElements.iterator(); i.hasNext(); )
+        for ( Iterator i = classpathElements.iterator(); i.hasNext(); )
-        boolean success = surefireBooter.run();
+        boolean success = false;
+        try
+        {
+            success = surefireBooter.run();
+        }
+        catch ( Exception e )
+        {
+            // TODO: better handling
+            throw new PluginExecutionException( "Error executing surefire", e );
+        }
-            response.setExecutionFailure( new SurefireFailureResponse( null ) );
+            throw new PluginExecutionException( "There are some test failures." );

UPD40 INS23 INS23 INS23 INS23 INS23 INS23 INS23 INS23 INS23 INS83 MOV43 INS59 INS83 MOV43 INS59 INS83 MOV43 INS59 INS83 MOV43 INS59 INS83 MOV43 INS59 INS83 MOV43 INS59 INS83 MOV43 INS59 INS83 MOV43 INS59 INS83 MOV43 INS59 INS43 MOV60 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 UPD42 MOV42 INS54 INS39 INS8 INS12 UPD42 INS9 INS21 INS44 INS8 INS53 INS7 MOV43 INS42 INS53 INS14 UPD42 INS42 MOV32 INS14 UPD43 MOV43 INS45 INS43 INS45 INS42 UPD42 UPD42 MOV42 DEL40 DEL26 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL44 DEL42 DEL42 DEL42 DEL45 DEL32 DEL11 DEL59 DEL60 DEL42 DEL42 DEL42 DEL45 DEL32 DEL11 DEL59 DEL60 DEL42 DEL43 DEL42 DEL42 DEL43 DEL42 DEL42 DEL45 DEL32 DEL11 DEL59 DEL60 DEL42 DEL42 DEL42 DEL45 DEL32 DEL11 DEL59 DEL60 DEL43 DEL42 DEL42 DEL43 DEL42 DEL42 DEL45 DEL32 DEL11 DEL59 DEL60 DEL42 DEL43 DEL42 DEL42 DEL43 DEL42 DEL42 DEL45 DEL32 DEL11 DEL59 DEL60 DEL42 DEL42 DEL43 DEL42 DEL42 DEL45 DEL32 DEL11 DEL59 DEL60 DEL42 DEL43 DEL42 DEL42 DEL43 DEL42 DEL42 DEL45 DEL32 DEL11 DEL59 DEL60 DEL42 DEL42 DEL45 DEL32 DEL11 DEL39 DEL42 DEL59 DEL60 DEL42 DEL42 DEL33 DEL14 DEL32 DEL21