Fixing CI. Had to move the addPlugin(..) call back to its original spot, and expose a new method in MavenProject to inject PluginManagement info to a Plugin instance that's passed in as a parameter.


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@344294 13f79535-47bb-0310-9956-ffa450edef68

-            buildOverlay = new BuildOverlay( model.getBuild() );
+            buildOverlay = new BuildOverlay( getModelBuild() );
-
-    public void addPlugin( Plugin plugin )
+    
+    private Build getModelBuild()
+        
+        return build;
+    }
+
+    public void addPlugin( Plugin plugin )
+    {
+        Build build = getModelBuild();
-            PluginManagement pm = build.getPluginManagement();
-
-            if ( pm != null )
-            {
-                Map pmByKey = pm.getPluginsAsMap();
-
-                String pluginKey = plugin.getKey();
-
-                if ( pmByKey != null && pmByKey.containsKey( pluginKey ) )
-                {
-                    Plugin pmPlugin = (Plugin) pmByKey.get( pluginKey );
-
-                    ModelUtils.mergePluginDefinitions( plugin, pmPlugin, false );
-                }
-
-            }
+            injectPluginManagementInfo( plugin );
+    
+    public void injectPluginManagementInfo( Plugin plugin )
+    {
+        PluginManagement pm = getModelBuild().getPluginManagement();
+
+        if ( pm != null )
+        {
+            Map pmByKey = pm.getPluginsAsMap();
+
+            String pluginKey = plugin.getKey();
+
+            if ( pmByKey != null && pmByKey.containsKey( pluginKey ) )
+            {
+                Plugin pmPlugin = (Plugin) pmByKey.get( pluginKey );
+
+                ModelUtils.mergePluginDefinitions( plugin, pmPlugin, false );
+            }
+        }
+    }

INS31 INS31 INS83 INS43 INS42 INS8 INS83 INS39 INS42 INS44 INS8 UPD42 MOV8 INS42 MOV60 MOV25 INS41 INS43 INS42 INS60 INS25 INS42 INS42 INS43 INS59 MOV38 INS8 INS42 INS42 INS32 INS21 MOV21 MOV21 INS42 INS32 INS32 INS42 INS42 UPD42 MOV42 UPD42 DEL42 DEL25 DEL8