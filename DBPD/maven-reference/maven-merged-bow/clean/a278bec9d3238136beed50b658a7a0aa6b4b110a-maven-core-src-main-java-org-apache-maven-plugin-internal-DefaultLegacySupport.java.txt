o Fixed another super-subtle classloader leak

-        if ( session == null )
+        AtomicReference<MavenSession> reference = DefaultLegacySupport.session.get();
+        if ( reference != null )
-            AtomicReference<MavenSession> oldSession = DefaultLegacySupport.session.get();
-            if ( oldSession != null )
-            {
-                oldSession.set( null);
-                DefaultLegacySupport.session.remove();
-            }
+            reference.set( null);
+        }
+
+        if ( session == null && reference != null)
+        {
+            DefaultLegacySupport.session.remove();

MOV60 INS25 INS27 INS8 INS27 MOV8 UPD42 INS42 INS33 INS21 MOV27 INS27 INS32 UPD42 MOV42 MOV33 INS42 INS42 INS33 DEL42 DEL42 DEL33 DEL32 DEL21 DEL27 DEL25 DEL8