fix for MNG-1324 "System" dependencies path non correctly added to eclipse buildpath
path is fixed by overwriting artifact file with the path returned by dependency.getSystemPath()

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@329851 13f79535-47bb-0310-9956-ffa450edef68

+import java.io.File;
+import java.io.FileWriter;
+import java.io.IOException;
+import java.util.Iterator;
+import java.util.List;
+
+import org.codehaus.plexus.util.StringUtils;
-import java.io.File;
-import java.io.FileWriter;
-import java.io.IOException;
-import java.util.Iterator;
-import java.util.List;
-
-                          EclipseSourceDir[] sourceDirs, List classpathContainers, ArtifactRepository localRepository,
-                          ArtifactResolver artifactResolver, ArtifactFactory artifactFactory,
-                          List remoteArtifactRepositories, boolean downloadSources, String outputDirectory )
+                         EclipseSourceDir[] sourceDirs, List classpathContainers, ArtifactRepository localRepository,
+                         ArtifactResolver artifactResolver, ArtifactFactory artifactFactory,
+                         List remoteArtifactRepositories, boolean downloadSources, String outputDirectory )
-            throw new MojoExecutionException( Messages.getString( "EclipsePlugin.erroropeningfile" ),
-                                              ex ); //$NON-NLS-1$
+            throw new MojoExecutionException( Messages.getString( "EclipsePlugin.erroropeningfile" ), ex ); //$NON-NLS-1$
-        writer.addAttribute( "path", EclipseUtils.toRelativeAndFixSeparator( projectBaseDir,  //$NON-NLS-1$  
+        writer.addAttribute( "path", EclipseUtils.toRelativeAndFixSeparator( projectBaseDir, //$NON-NLS-1$  
+        EclipseUtils.fixSystemScopeArtifacts( artifacts, project.getDependencies() );
+
-                                ArtifactRepository localRepository, ArtifactResolver artifactResolver,
-                                ArtifactFactory artifactFactory, List remoteArtifactRepositories,
-                                boolean downloadSources )
+                               ArtifactRepository localRepository, ArtifactResolver artifactResolver,
+                               ArtifactFactory artifactFactory, List remoteArtifactRepositories, boolean downloadSources )
-                    path = artifactPath.getCanonicalPath();
+                    path = StringUtils.replace( artifactPath.getCanonicalPath(), "\\", "/" );
-                    
+
-                
+
-                                
+
-                    Artifact sourceArtifact = retrieveSourceArtifact( artifact, remoteArtifactRepositories, localRepository,
-                                                                      artifactResolver, artifactFactory );
+                    Artifact sourceArtifact = retrieveSourceArtifact( artifact, remoteArtifactRepositories,
+                                                                      localRepository, artifactResolver,
+                                                                      artifactFactory );
-                                                       new Object[]{sourceArtifact.getArtifactId(),
-                                                           sourceArtifact.getFile().getAbsolutePath()} ) );
+                                                       new Object[] {
+                                                           sourceArtifact.getArtifactId(),
+                                                           sourceArtifact.getFile().getAbsolutePath() } ) );
-                            + EclipseUtils.toRelativeAndFixSeparator( localRepositoryFile,
-                                                                      sourceArtifact.getFile().getAbsolutePath(), false );
+                            + EclipseUtils.toRelativeAndFixSeparator( localRepositoryFile, sourceArtifact.getFile()
+                                .getAbsolutePath(), false );
-
-                                             ArtifactRepository localRepository, ArtifactResolver artifactResolver,
-                                             ArtifactFactory artifactFactory )
+                                            ArtifactRepository localRepository, ArtifactResolver artifactResolver,
+                                            ArtifactFactory artifactFactory )
-        Artifact sourceArtifact = artifactFactory.createArtifactWithClassifier( artifact.getGroupId(),
-                                                                                artifact.getArtifactId(),
-                                                                                artifact.getVersion(), "java-source",
-                                                                                "sources" ); //$NON-NLS-1$ //$NON-NLS-2$
+        Artifact sourceArtifact = artifactFactory.createArtifactWithClassifier( artifact.getGroupId(), artifact
+            .getArtifactId(), artifact.getVersion(), "java-source", "sources" ); //$NON-NLS-1$ //$NON-NLS-2$
-                
-                log.debug( message , e );
+
+                log.debug( message, e );
-            
+
-

MOV26 MOV26 MOV26 MOV26 MOV26 INS26 INS40 INS21 INS32 INS42 INS42 INS42 INS32 INS42 INS42 INS32 INS42 INS42 MOV32 INS45 INS45