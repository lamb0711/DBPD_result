Fixing MNG-3355 and MNG-2339.

This commit introduces three changes: user-level properties that are separated from the execution properties, where execution properties contain envars, sysprops, and user-level properties...user-level properties are useful for POM interpolation for 2339 and 3355.

Second, a ProjectBuilderConfiguration interface and default implementation, to stem the proliferation of method parameters to projectBuilder methods. This was a natural place to introduce it, as user-level properties had to be passed in separately from the execution properties, for interpolation.

Finally, interpolation has been switched to use the new plexus-interpolation project, which is based on the classes in plexus-utils.

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@644354 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.project.ProjectBuilderConfiguration;
-            List originalRemoteRepositories = getInitialRemoteRepositories();
+            List originalRemoteRepositories = getInitialRemoteRepositories( request.getProjectBuildingConfiguration() );
-            ModelLineage lineage = buildModelLineage( pom, request, originalRemoteRepositories );
+            ModelLineage lineage = buildModelLineage( pom, request.getProjectBuildingConfiguration(), originalRemoteRepositories );
-                model = modelInterpolator.interpolate( model, inheritedInterpolationValues, false );
+                model = modelInterpolator.interpolate( model, inheritedInterpolationValues, request.getUserProperties(), false );
-    private ModelLineage buildModelLineage( File pom, MavenExecutionRequest request,
+    private ModelLineage buildModelLineage( File pom, ProjectBuilderConfiguration config,
-        ProfileManager profileManager = request.getProfileManager();
+        ProfileManager profileManager = config.getGlobalProfileManager();
-                        ? new DefaultProfileActivationContext( System.getProperties(), false )
+                        ? new DefaultProfileActivationContext( config.getExecutionProperties(), false )
-            lineage = modelLineageBuilder.buildModelLineage( pom, request.getLocalRepository(), originalRemoteRepositories,
-                                                             request.getProfileManager(), false, true );
+
+            lineage = modelLineageBuilder.buildModelLineage( pom, config, originalRemoteRepositories, false, true );
-    private List getInitialRemoteRepositories()
+    private List getInitialRemoteRepositories( ProjectBuilderConfiguration config )
-                basicSuperProject = projectBuilder.buildStandaloneSuperProject();
+                basicSuperProject = projectBuilder.buildStandaloneSuperProject( config );

INS26 INS40 INS44 UPD43 UPD42 INS43 INS42 UPD42 INS42 UPD42 UPD42 INS32 INS32 UPD42 UPD42 UPD42 MOV42 INS42 INS42 MOV42 INS42 INS32 INS42 INS42 INS42 DEL42 DEL32 DEL42 DEL42 DEL32