[MNG-4915] Versions in pom.xml are not checked for invalid characters

git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@1038838 13f79535-47bb-0310-9956-ffa450edef68

-        if ( !hasExpression( string ) )
+        if ( hasExpression( string ) )
-            return true;
+            addViolation( problems, severity, fieldName, sourceHint,
+                          "must be a valid version but is '" + string + "'.", tracker );
+            return false;
-        addViolation( problems, severity, fieldName, sourceHint, "must be a valid version but is '" + string + "'.",
-                      tracker );
+        if ( !validateBannedCharacters( fieldName, problems, severity, string, sourceHint, tracker,
+                                        ILLEGAL_VERSION_CHARS ) )
+        {
+            return false;
+        }
-        return false;
+        return true;
-        Severity errOn30 = getSeverity( request, ModelBuildingRequest.VALIDATION_LEVEL_MAVEN_3_0 );
-
-        if ( string.length() > 0 && !hasExpression( string ) && !"RELEASE".equals( string )
-            && !"LATEST".equals( string ) )
+        Severity errOn30 = getSeverity( request, ModelBuildingRequest.VALIDATION_LEVEL_MAVEN_3_0 );
+
+        if ( !validateVersion( fieldName, problems, errOn30, string, sourceHint, tracker ) )
-            return true;
+            return false;
-        addViolation( problems, errOn30, fieldName, sourceHint, "must be a valid version but is '" + string + "'.",
-                      tracker );
+        if ( string.length() <= 0 || "RELEASE".equals( string ) || "LATEST".equals( string ) )
+        {
+            addViolation( problems, errOn30, fieldName, sourceHint, "must be a valid version but is '" + string + "'.",
+                          tracker );
+            return false;
+        }
-        return false;
+        return true;

MOV60 INS25 MOV41 INS25 MOV41 MOV32 INS8 INS38 INS8 UPD27 MOV27 INS8 MOV21 MOV41 INS32 INS41 INS32 MOV41 UPD27 MOV32 MOV21 INS41 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS9 UPD42 MOV42 INS42 MOV42 MOV42 UPD42 MOV42 MOV42 MOV42 UPD27 MOV32 UPD45 MOV45 MOV42 MOV42 INS9 INS45 UPD42 MOV42 MOV42 INS42 INS42 UPD42 MOV42 INS42 INS42 INS42 DEL32 DEL38 DEL38 DEL38 DEL27 DEL8