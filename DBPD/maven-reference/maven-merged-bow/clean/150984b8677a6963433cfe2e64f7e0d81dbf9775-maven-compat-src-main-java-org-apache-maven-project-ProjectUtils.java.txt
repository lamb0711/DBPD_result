[MNG-4991] LegacyRepositorySystem#injectProxy(repositories, proxies) doesn't evaluate non-proxy hosts


git-svn-id: https://svn.apache.org/repos/asf/maven/maven-3/trunk@1073990 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.maven.execution.MavenExecutionRequest;
+import org.sonatype.aether.RepositorySystemSession;
-        MavenExecutionRequest executionRequest = er( c );
+        RepositorySystemSession session = rss( c );
-        if ( executionRequest != null )
+        if ( session != null )
-            repositorySystem.injectMirror( Arrays.asList( repository ), executionRequest.getMirrors() );
-            repositorySystem.injectProxy( Arrays.asList( repository ), executionRequest.getProxies() );
-            repositorySystem.injectAuthentication( Arrays.asList( repository ), executionRequest.getServers() );
+            repositorySystem.injectMirror( session, Arrays.asList( repository ) );
+            repositorySystem.injectProxy( session, Arrays.asList( repository ) );
+            repositorySystem.injectAuthentication( session, Arrays.asList( repository ) );
-    private static MavenExecutionRequest er( PlexusContainer c )
+    private static RepositorySystemSession rss( PlexusContainer c )
-            if ( legacySupport.getSession() != null )
-            {
-                return legacySupport.getSession().getRequest();
-            }
-            else
-            {
-                return null;
-            }
+            return legacySupport.getRepositorySession();

MOV26 UPD40 UPD43 UPD42 UPD42 UPD43 UPD42 UPD42 UPD42 MOV41 UPD42 INS32 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 MOV42 UPD42 MOV42 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32 DEL32 DEL42 DEL32 DEL42 DEL42 DEL32 DEL33 DEL27 DEL8 DEL33 DEL41 DEL8 DEL25