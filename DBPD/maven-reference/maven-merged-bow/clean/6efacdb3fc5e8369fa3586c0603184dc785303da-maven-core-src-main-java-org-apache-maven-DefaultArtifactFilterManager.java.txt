MNG-5771 user-defined core extensions

read ${maven.projectBasedir}/.mvn/extensions.xml and create core
extensions realms during maven runtime bootstrap. this required
short-lived bootstrap plexus container to resolve extensions.

individual extensions realms are wired to maven.ext realm according
to META-INF/maven/extension.xml exported packages specification

Signed-off-by: Igor Fedorenko <ifedorenko@apache.org>

-import org.apache.maven.extension.internal.DefaultCoreExports;
-
-import com.google.common.collect.ImmutableSet;
+import org.apache.maven.extension.internal.CoreExportsProvider;
-    protected final Set<String> coreArtifacts;
+    protected Set<String> excludedArtifacts;
-    protected final Set<String> excludedArtifacts;
+    private final Set<String> coreArtifacts;
-    public DefaultArtifactFilterManager( List<ArtifactFilterManagerDelegate> delegates, DefaultCoreExports extensions )
+    public DefaultArtifactFilterManager( List<ArtifactFilterManagerDelegate> delegates, CoreExportsProvider coreExports )
-        this.coreArtifacts = ImmutableSet.copyOf( extensions.getExportedArtifacts() );
-        this.excludedArtifacts = new LinkedHashSet<String>( extensions.getExportedArtifacts() );
+        this.coreArtifacts = coreExports.get().getExportedArtifacts();
+    }
+
+    private synchronized Set<String> getExcludedArtifacts()
+    {
+        if ( excludedArtifacts == null )
+        {
+            excludedArtifacts = new LinkedHashSet<String>( coreArtifacts );
+        }
+        return excludedArtifacts;
-        Set<String> excludes = new LinkedHashSet<String>( excludedArtifacts );
+        Set<String> excludes = new LinkedHashSet<String>( getExcludedArtifacts() );
-        excludedArtifacts.add( artifactId );
+        getExcludedArtifacts().add( artifactId );

MOV23 UPD40 INS31 UPD83 INS83 INS83 INS74 INS42 INS8 UPD43 UPD42 INS43 INS43 INS25 INS41 UPD42 INS42 INS42 INS27 INS8 INS42 INS42 INS33 MOV21 INS32 INS32 MOV42 INS32 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 INS42 INS42 INS42 DEL40 DEL26 DEL83 DEL42 DEL32 DEL52 DEL42 DEL22 DEL42 DEL42 DEL32 DEL42