o we'll use the embedder now for some default values because we still have an asymmetry for many of the methods that 
  don't use an execution request, or configuration, but require direct use of things like settings and the local repository. an
  example being the profile manager.


git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@512541 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.maven.embedder.MavenEmbedderConfiguration;
+import org.apache.maven.artifact.repository.ArtifactRepository;
+import org.apache.maven.artifact.repository.layout.ArtifactRepositoryLayout;
+import org.apache.maven.embedder.configuration.Configuration;
+import org.apache.maven.embedder.MavenEmbedder;
+import org.codehaus.plexus.util.StringUtils;
-    private MavenTools mavenTools;
-
+    private ArtifactRepositoryLayout defaultArtifactRepositoryLayout;
+
-    public MavenExecutionRequest populateDefaults( MavenExecutionRequest request, MavenEmbedderConfiguration embedderConfiguration )
+    public MavenExecutionRequest populateDefaults( MavenExecutionRequest request, MavenEmbedder embedder )
-        // Settings
-
-            // A local repository set in the request should win over what's in a settings.xml file.
-            String userSettingsLocation = request.getSettingsFile();
-            if ( userSettingsLocation == null )
-            {
-                File userSettingsFile = embedderConfiguration.getUserSettingsFile();
-                if ( userSettingsFile != null )
-                {
-                    userSettingsLocation = userSettingsFile.getAbsolutePath();
-                }
-            }
-
-            File userSettingsPath = null; //mavenTools.getUserSettingsPath( userSettingsLocation );
-            if ( userSettingsLocation != null )
-            {
-                userSettingsPath = new File( userSettingsLocation );
-            }
-
-            File globalSettingsFile = null; //mavenTools.getGlobalSettingsPath();
-            
-            File configGlobalSettings = embedderConfiguration.getGlobalSettingsFile();
-            if ( configGlobalSettings != null )
-            {
-                globalSettingsFile = configGlobalSettings;
-            }
-
-            try
-            {
-                request.setSettings( mavenTools.buildSettings( userSettingsPath, globalSettingsFile, request
-                    .isInteractiveMode(), request.isOffline(), request.isUsePluginRegistry(), request
-                    .isUsePluginUpdateOverride(), request.getSettingsBuilderAdvice() ) );
-            }
-            catch ( SettingsConfigurationException e )
-            {
-                throw new MavenEmbedderException( "Error processing settings.xml.", e );
-            }
+            request.setSettings( embedder.getSettings() );
-        // Local repository
-
-            String localRepositoryPath = mavenTools.getLocalRepositoryPath( request.getSettings() );
-
-            if ( request.getLocalRepository() == null )
-            {
-                request.setLocalRepository( mavenTools.createLocalRepository( new File( localRepositoryPath ) ) );
-            }
+            request.setLocalRepository( embedder.getLocalRepository() );
-        if ( request.getSettings().isOffline() )
+        if ( request.isOffline() )

MOV26 INS26 INS26 INS26 INS26 MOV23 INS40 INS40 INS40 UPD40 INS40 UPD43 UPD42 UPD42 UPD43 UPD42 MOV25 UPD42 INS8 MOV27 MOV32 MOV21 UPD42 UPD42 UPD42 UPD42 DEL42 DEL42 DEL42 DEL42 DEL32 DEL42 DEL42 DEL32 DEL42 DEL42 DEL32 DEL42 DEL42 DEL32 DEL42 DEL43 DEL42 DEL42 DEL42 DEL32 DEL59 DEL60 DEL42 DEL33 DEL27 DEL42 DEL43 DEL42 DEL42 DEL42 DEL32 DEL59 DEL60 DEL42 DEL33 DEL27 DEL42 DEL42 DEL42 DEL32 DEL7 DEL21 DEL8 DEL25 DEL8 DEL25 DEL42 DEL43 DEL42 DEL33 DEL59 DEL60 DEL42 DEL33 DEL27 DEL42 DEL42 DEL43 DEL42 DEL14 DEL7 DEL21 DEL8 DEL25 DEL42 DEL43 DEL42 DEL33 DEL59 DEL60 DEL42 DEL43 DEL42 DEL42 DEL42 DEL32 DEL59 DEL60 DEL42 DEL33 DEL27 DEL42 DEL42 DEL7 DEL21 DEL8 DEL25 DEL8 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL45 DEL42 DEL14 DEL53 DEL8 DEL12 DEL54 DEL8 DEL42 DEL42 DEL32 DEL33 DEL27 DEL42 DEL43 DEL42 DEL14 DEL42 DEL43 DEL42 DEL42 DEL42 DEL42 DEL42 DEL32 DEL32 DEL59 DEL60 DEL8 DEL25 DEL42 DEL42 DEL32 DEL42 DEL32