Removing maven-build-context, and replacing it with caching aspects for model-lineage stuff and project instances. Still needs caching for artifact resolution, and I have an aspect for this too, but it's not enabled yet, since it's still buggy.

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@595215 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.maven.profiles.activation.DefaultProfileActivationContext;
+import org.apache.maven.profiles.activation.ProfileActivationContext;
-        if ( request.getPom() != null )
+        if ( ( request.getPom() != null ) && ( request.getPom().getParentFile() != null ) )
-            request.setBaseDirectory( request.getPom() );
+            request.setBaseDirectory( request.getPom().getParentFile() );
-        else if ( request.getBaseDirectory() != null )
+        else if ( ( request.getPom() == null ) && ( request.getBaseDirectory() != null ) )
+        // TODO: Is this correct?
+        else if ( request.getBaseDirectory() == null )
+        {
+            request.setBaseDirectory( new File( System.getProperty( "user.dir" ) ) );
+        }
-        ProfileManager globalProfileManager = new DefaultProfileManager( container );
+        ProfileActivationContext activationContext = new DefaultProfileActivationContext( request.getProperties(), false );
+        ProfileManager globalProfileManager = new DefaultProfileManager( container, activationContext );

INS26 INS26 INS40 INS40 INS60 INS27 INS43 INS59 INS36 INS36 INS27 INS25 INS42 INS42 INS14 MOV27 INS27 INS32 INS36 INS36 INS27 INS8 INS43 INS32 INS9 INS42 MOV32 MOV42 INS33 INS42 INS42 INS32 INS27 MOV27 INS32 INS33 INS21 INS42 INS42 INS42 UPD42 INS32 INS42 INS32 INS33 INS42 INS42 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS14 INS43 INS32 INS42 INS42 INS42 INS45 DEL42