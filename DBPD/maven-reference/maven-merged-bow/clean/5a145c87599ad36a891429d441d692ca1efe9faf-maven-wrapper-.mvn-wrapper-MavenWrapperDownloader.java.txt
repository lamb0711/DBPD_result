- Made the wrapperUrl configurable from the maven-wrapper.properties file
  - Updated and tested the linux/unix/mac version of the script
  - Updated and tested the Java downloader
  - Updated the windows cmd (but not tested yet)

(Need to test the changes to the windows command on a windows machine)

+import java.util.Properties;
+    /**
+     * Default URL to download the maven-wrapper.jar from, if no 'downloadUrl' is provided.
+     */
+    private static final String DEFAULT_DOWNLOAD_URL =
+            "http://central.maven.org/maven2/io/takari/maven-wrapper/0.2.1/maven-wrapper-0.2.1.jar";
+
+    /**
+     * Path to the maven-wrapper.properties file, which might contain a downloadUrl property to
+     * use instead of the default one.
+     */
+    private static final String MAVEN_WRAPPER_PROPERTIES_PATH =
+            ".mvn/wrapper/maven-wrapper.properties";
+
+    /**
+     * Path where the maven-wrapper.jar will be saved to.
+     */
+    private static final String MAVEN_WRAPPER_JAR_PATH =
+            ".mvn/wrapper/maven-wrapper.jar";
+
+    /**
+     * Name of the property which should be used to override the default download url for the wrapper.
+     */
+    private static final String PROPERTY_NAME_WRAPPER_URL = "wrapperUrl";
+
-        String url="http://central.maven.org/maven2/io/takari/maven-wrapper/0.2.1/maven-wrapper-0.2.1.jar";
-        File outputFile = new File(baseDirectory.getAbsolutePath(), ".mvn/wrapper/maven-wrapper.jar");
+
+        // If the maven-wrapper.properties exists, read it and check if it contains a custom
+        // wrapperUrl parameter.
+        File mavenWrapperPropertyFile = new File(baseDirectory, MAVEN_WRAPPER_PROPERTIES_PATH);
+        String url = DEFAULT_DOWNLOAD_URL;
+        if(mavenWrapperPropertyFile.exists()) {
+            FileInputStream mavenWrapperPropertyFileInputStream = null;
+            try {
+                mavenWrapperPropertyFileInputStream = new FileInputStream(mavenWrapperPropertyFile);
+                Properties mavenWrapperProperties = new Properties();
+                mavenWrapperProperties.load(mavenWrapperPropertyFileInputStream);
+                url = mavenWrapperProperties.getProperty(PROPERTY_NAME_WRAPPER_URL, url);
+            } catch (IOException e) {
+                System.out.println("- ERROR loading '" + MAVEN_WRAPPER_PROPERTIES_PATH + "'");
+            } finally {
+                try {
+                    if(mavenWrapperPropertyFileInputStream != null) {
+                        mavenWrapperPropertyFileInputStream.close();
+                    }
+                } catch (IOException e) {
+                    // Ignore ...
+                }
+            }
+        }
+        System.out.println("- Downloading from: : " + url);
+
+        File outputFile = new File(baseDirectory.getAbsolutePath(), MAVEN_WRAPPER_JAR_PATH);
-            outputFile.getParentFile().mkdirs();
+            if(!outputFile.getParentFile().mkdirs()) {
+                System.out.println(
+                        "- ERROR creating output direcrory '" + outputFile.getParentFile().getAbsolutePath() + "'");
+            }
-    public static void downloadFileFromURL(String urlString, File destination) throws Exception {
+    private static void downloadFileFromURL(String urlString, File destination) throws Exception {

INS26 INS40 INS23 INS23 INS23 INS23 INS29 INS83 INS83 INS83 INS43 INS59 INS29 INS83 INS83 INS83 INS43 INS59 INS29 INS83 INS83 INS83 INS43 INS59 INS29 INS83 INS83 INS83 INS43 INS59 MOV60 UPD83 INS65 INS42 INS42 INS45 INS65 INS42 INS42 INS45 INS65 INS42 INS42 INS45 INS65 INS42 INS42 INS45 INS60 INS25 INS21 INS66 INS66 INS66 INS66 INS66 INS43 INS59 INS32 INS8 INS32 INS8 INS42 INS42 INS14 INS42 INS42 INS42 INS60 INS54 INS40 INS42 INS27 INS25 INS43 INS42 INS42 INS43 INS59 INS8 INS12 INS8 INS45 INS42 INS42 INS38 MOV8 INS42 INS42 INS42 INS33 INS21 INS60 INS21 INS21 INS44 INS8 INS54 MOV32 INS7 INS43 INS59 INS32 INS7 INS43 INS42 INS21 INS8 INS12 INS32 INS42 INS14 INS42 INS42 INS14 INS42 INS42 INS42 INS42 INS32 INS42 INS32 INS25 INS44 INS8 INS40 INS42 INS27 INS43 INS42 INS43 INS42 INS42 INS42 INS42 INS40 INS42 INS27 INS27 INS8 INS43 INS42 INS45 INS32 INS45 INS42 INS42 INS45 INS42 INS45 INS42 INS33 INS21 INS42 INS32 INS42 INS32 INS42 INS42 INS42 INS42 DEL45 DEL45