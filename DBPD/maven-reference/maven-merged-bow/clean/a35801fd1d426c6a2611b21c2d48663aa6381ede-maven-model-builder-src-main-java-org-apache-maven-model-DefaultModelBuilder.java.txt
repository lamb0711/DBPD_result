o Set POM file before validation to provide better source hint for validation problems

git-svn-id: https://svn.apache.org/repos/asf/maven/components/trunk@782283 13f79535-47bb-0310-9956-ffa450edef68

-        Model model = readModel( modelSource, request, problems );
-        model.setPomFile( pomFile );
+        Model model = readModel( modelSource, pomFile, request, problems );
-        validateModel( resultModel, false, request, problems );
+        ModelValidationResult validationResult = modelValidator.validateEffectiveModel( resultModel, request );
+        addProblems( resultModel, validationResult, problems );
-    private Model readModel( ModelSource modelSource, ModelBuildingRequest request, List<ModelProblem> problems )
+    private Model readModel( ModelSource modelSource, File pomFile, ModelBuildingRequest request,
+                             List<ModelProblem> problems )
-        validateModel( model, true, request, problems );
+        model.setPomFile( pomFile );
+
+        ModelValidationResult validationResult = modelValidator.validateRawModel( model, request );
+        addProblems( model, validationResult, problems );
-    private void validateModel( Model model, boolean raw, ModelBuildingRequest request, List<ModelProblem> problems )
+    private void addProblems( Model model, ModelValidationResult result, List<ModelProblem> problems )
-        ModelValidationResult result;
-
-        if ( raw )
-        {
-            result = modelValidator.validateRawModel( model, request );
-        }
-        else
-        {
-            result = modelValidator.validateEffectiveModel( model, request );
-        }
-
-        Model candidateModel = readModel( new FileModelSource( pomFile ), request, problems );
-        candidateModel.setPomFile( pomFile );
+        Model candidateModel = readModel( new FileModelSource( pomFile ), pomFile, request, problems );
-        return readModel( modelSource, request, problems );
+        return readModel( modelSource, null, request, problems );

INS44 UPD42 INS60 INS43 INS42 MOV21 INS60 MOV43 UPD42 INS43 INS59 INS42 INS43 INS59 INS42 INS42 INS32 UPD42 UPD42 INS42 INS42 MOV32 UPD42 UPD42 INS33 INS42 INS42 INS42 INS42 INS42 INS42 DEL9 DEL9 DEL39 DEL42 DEL44 DEL42 DEL43 DEL42 DEL59 DEL60 DEL42 DEL42 DEL7 DEL21 DEL8 DEL42 DEL42 DEL42 DEL42 DEL42 DEL32 DEL7 DEL21 DEL8 DEL25 DEL42 DEL42 DEL42 DEL32 DEL21