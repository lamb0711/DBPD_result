HDFS-5889. When starting rolling upgrade, create a fs image for rollback so that the standby namenode can create checkpoints during upgrade.  Contributed by szetszwo & jing9


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-5535@1567861 13f79535-47bb-0310-9956-ffa450edef68

-  private static final Pattern IMAGE_REGEX = Pattern.compile(
-    NameNodeFile.IMAGE.getName() + "_(\\d+)");
+  private final Pattern namePattern;
+
+  FSImageTransactionalStorageInspector() {
+    this(NameNodeFile.IMAGE);
+  }
+
+  FSImageTransactionalStorageInspector(NameNodeFile nnf) {
+    namePattern = Pattern.compile(nnf.getName() + "_(\\d+)");
+  }
-      Matcher imageMatch = IMAGE_REGEX.matcher(name);
+      Matcher imageMatch = namePattern.matcher(name);
