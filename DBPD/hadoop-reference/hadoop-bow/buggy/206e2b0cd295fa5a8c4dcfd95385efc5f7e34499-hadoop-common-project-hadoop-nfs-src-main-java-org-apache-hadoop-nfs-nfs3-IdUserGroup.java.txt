HDFS-6044. Add property for setting the NFS look up time for users. Contributed by Brandon Li

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1574622 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.conf.Configuration;
-  // Do update every 15 minutes
-  final static long TIMEOUT = 15 * 60 * 1000; // ms
-
+  // Do update every 15 minutes by default
+  final static long TIMEOUT_DEFAULT = 15 * 60 * 1000; // ms
+  final static long TIMEOUT_MIN = 1 * 60 * 1000; // ms
+  final private long timeout;
+  final static String NFS_USERUPDATE_MILLY = "hadoop.nfs.userupdate.milly";
+  
+    timeout = TIMEOUT_DEFAULT;
+    updateMaps();
+  }
+  
+  public IdUserGroup(Configuration conf) throws IOException {
+    long updateTime = conf.getLong(NFS_USERUPDATE_MILLY, TIMEOUT_DEFAULT);
+    // Minimal interval is 1 minute
+    if (updateTime < TIMEOUT_MIN) {
+      LOG.info("User configured user account update time is less"
+          + " than 1 minute. Use 1 minute instead.");
+      timeout = TIMEOUT_MIN;
+    } else {
+      timeout = updateTime;
+    }
-  private boolean isExpired() {
-    return lastUpdateTime - System.currentTimeMillis() > TIMEOUT;
+  @VisibleForTesting
+  public long getTimeout() {
+    return timeout;
+  }
+  
+  synchronized private boolean isExpired() {
+    return lastUpdateTime - System.currentTimeMillis() > timeout;
