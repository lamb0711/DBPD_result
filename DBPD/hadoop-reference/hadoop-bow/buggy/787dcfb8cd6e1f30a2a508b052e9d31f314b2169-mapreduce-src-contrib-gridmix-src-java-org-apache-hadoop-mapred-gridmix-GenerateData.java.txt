MAPREDUCE-2596. [Gridmix] Summarize Gridmix runs. (amarrk)

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1144403 13f79535-47bb-0310-9956-ffa450edef68

-   * Publish the data statistics.
+   * Represents the input data characteristics.
-  static void publishDataStatistics(Path inputDir, long genBytes, 
-                                    Configuration conf) 
-  throws IOException {
-    if (CompressionEmulationUtil.isCompressionEmulationEnabled(conf)) {
-      CompressionEmulationUtil.publishCompressedDataStatistics(inputDir, 
-                                                               conf, genBytes);
-    } else {
-      publishPlainDataStatistics(conf, inputDir);
+  static class DataStatistics {
+    private long dataSize;
+    private long numFiles;
+    private boolean isDataCompressed;
+    
+    DataStatistics(long dataSize, long numFiles, boolean isCompressed) {
+      this.dataSize = dataSize;
+      this.numFiles = numFiles;
+      this.isDataCompressed = isCompressed;
+    }
+    
+    long getDataSize() {
+      return dataSize;
+    }
+    
+    long getNumFiles() {
+      return numFiles;
+    }
+    
+    boolean isDataCompressed() {
+      return isDataCompressed;
-  static void publishPlainDataStatistics(Configuration conf, Path inputDir) 
+  /**
+   * Publish the data statistics.
+   */
+  static DataStatistics publishDataStatistics(Path inputDir, long genBytes, 
+                                              Configuration conf) 
+  throws IOException {
+    if (CompressionEmulationUtil.isCompressionEmulationEnabled(conf)) {
+      return CompressionEmulationUtil.publishCompressedDataStatistics(inputDir, 
+                                        conf, genBytes);
+    } else {
+      return publishPlainDataStatistics(conf, inputDir);
+    }
+  }
+  
+  static DataStatistics publishPlainDataStatistics(Configuration conf, 
+                                                   Path inputDir) 
+    
+    return new DataStatistics(dataSize, fileCount, false);
