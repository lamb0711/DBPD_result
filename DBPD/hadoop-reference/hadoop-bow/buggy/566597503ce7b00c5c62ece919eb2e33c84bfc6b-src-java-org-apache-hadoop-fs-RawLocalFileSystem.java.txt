HADOOP-7015. RawLocalFileSystem#listStatus does not deal with a directory whose entries are changing (e.g. in a multi-thread or multi-process environment). Contributed by Sanjay Radia 


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1036729 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.Arrays;
+    int j = 0;
-      results[i] = getFileStatus(new Path(f, names[i]));
+      try {
+        results[j] = getFileStatus(new Path(f, names[i]));
+        j++;
+      } catch (FileNotFoundException e) {
+        // ignore the files not found since the dir list may have have changed
+        // since the names[] list was generated.
+      }
-    return results;
+    if (j == names.length) {
+      return results;
+    }
+    return Arrays.copyOf(results, j);
