HDFS-2582. Scope dfs.ha.namenodes config by nameservice. Contributed by Todd Lipcon.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1207738 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.ArrayList;
+import java.util.Collection;
+import com.google.common.collect.Collections2;
+import com.google.common.collect.Lists;
+
-  NameNodeConnector(InetSocketAddress namenodeAddress, Configuration conf
-      ) throws IOException {
-    this.namenodeAddress = namenodeAddress;
-    this.namenode = createNamenode(namenodeAddress, conf);
+  NameNodeConnector(Collection<InetSocketAddress> haNNs,
+      Configuration conf) throws IOException {
+    InetSocketAddress nn = Lists.newArrayList(haNNs).get(0);
+    // TODO(HA): need to deal with connecting to HA NN pair here
+    this.namenodeAddress = nn;
+    this.namenode = createNamenode(nn, conf);
-    this.fs = FileSystem.get(NameNode.getUri(namenodeAddress), conf);
+    this.fs = FileSystem.get(NameNode.getUri(nn), conf);
