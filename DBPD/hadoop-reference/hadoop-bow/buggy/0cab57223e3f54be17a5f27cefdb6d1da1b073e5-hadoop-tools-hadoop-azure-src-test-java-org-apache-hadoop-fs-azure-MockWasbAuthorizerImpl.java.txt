HADOOP-14274. Azure: Simplify Ranger-WASB policy model. Contributed by Sivaguru Sankaridurg

+import java.util.regex.Pattern;
-    AuthorizationComponent component =
-        new AuthorizationComponent(wasbAbsolutePath, accessType);
+
+    AuthorizationComponent component = wasbAbsolutePath.endsWith("*")
+        ? new AuthorizationComponent("^" + wasbAbsolutePath.replace("*", ".*"), accessType)
+        : new AuthorizationComponent(wasbAbsolutePath, accessType);
+
+    if (wasbAbsolutePath.endsWith(NativeAzureFileSystem.FolderRenamePending.SUFFIX)) {
+      return true;
+    }
+
+      // Regex-pattern match if we don't have a straight match
+      for (Map.Entry<AuthorizationComponent, Boolean> entry : authRules.entrySet()) {
+        AuthorizationComponent key = entry.getKey();
+        String keyPath = key.getWasbAbsolutePath();
+        String keyAccess = key.getAccessType();
+
+        if (keyPath.endsWith("*") && Pattern.matches(keyPath, wasbAbsolutePath) && keyAccess.equals(accessType)) {
+          return entry.getValue();
+        }
+      }
