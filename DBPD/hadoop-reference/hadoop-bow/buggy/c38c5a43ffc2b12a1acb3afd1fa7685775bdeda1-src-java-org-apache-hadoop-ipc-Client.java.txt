HADOOP-6099. The RPC module can be configured to not send period pings.
The default behaviour remains unchanged. (dhruba)



git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@792812 13f79535-47bb-0310-9956-ffa450edef68

+  final private boolean doPing; //do we need to send ping message
+
+  /**
+   * The time after which a RPC will timeout.
+   * If ping is not enabled (via ipc.client.ping), then the timeout value is the 
+   * same as the pingInterval.
+   * If ping is enabled, then there is no timeout value.
+   * 
+   * @param conf Configuration
+   * @return the timeout period in milliseconds. -1 if no timeout value is set
+   */
+  final public static int getTimeout(Configuration conf) {
+    if (!conf.getBoolean("ipc.client.ping", true)) {
+      return getPingInterval(conf);
+    }
+    return -1;
+  }
-        this.in = new DataInputStream(new BufferedInputStream
+        if (doPing) {
+          this.in = new DataInputStream(new BufferedInputStream
+        } else {
+          this.in = new DataInputStream(new BufferedInputStream
+            (NetUtils.getInputStream(socket)));
+        }
+    this.doPing = conf.getBoolean("ipc.client.ping", true);
