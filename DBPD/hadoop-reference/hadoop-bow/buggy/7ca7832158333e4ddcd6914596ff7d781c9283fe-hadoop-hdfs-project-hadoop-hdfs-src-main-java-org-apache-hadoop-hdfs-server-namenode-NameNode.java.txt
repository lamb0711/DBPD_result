HDFS-2231. Configuration changes for HA namenode. Contributed by Suresh Srinivas.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1182626 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.hdfs.HAUtil;
-    this.haEnabled = DFSUtil.isHAEnabled(conf);
+    this.haEnabled = HAUtil.isHAEnabled(conf);
-   * @see DFSUtil#setGenericConf(Configuration, String, String...)
+   * @see DFSUtil#setGenericConf(Configuration, String, String, String...)
-    if ((nameserviceId == null) || nameserviceId.isEmpty()) {
+    String namenodeId = HAUtil.getNameNodeId(conf);
+    if ((nameserviceId == null || nameserviceId.isEmpty()) && 
+        (namenodeId == null || namenodeId.isEmpty())) {
-    DFSUtil.setGenericConf(conf, nameserviceId, NAMESERVICE_SPECIFIC_KEYS);
+    DFSUtil.setGenericConf(conf, nameserviceId, namenodeId,
+        NAMESERVICE_SPECIFIC_KEYS);
