MAPREDUCE-4019. -list-attempt-ids is not working. Contributed by Ashwin Shankar, Devaraj K, and B Anil Kumar


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1492868 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.commons.lang.StringUtils;
-
+  private static final Set<String> taskTypes = new HashSet<String>(
+      Arrays.asList("MAP", "REDUCE"));
+  
+      if (!taskTypes.contains(taskType.toUpperCase())) {
+        System.out.println("Error: Invalid task-type: "+taskType);
+        displayUsage(cmd);
+        return exitCode;
+      }
-    cluster = new Cluster(getConf());
+    cluster = createCluster();
+  Cluster createCluster() throws IOException {
+    return new Cluster(getConf());
+  }
+  
-  private String getTaskTypess() {
-    StringBuffer sb = new StringBuffer();
-    for (TaskType t : TaskType.values()) {
-      sb.append(t.name()).append(" ");
-    }
-    return sb.substring(0, sb.length()-1);
+  private String getTaskTypes() {
+    return StringUtils.join(taskTypes, " ");
-
+  
-    String taskTypes = getTaskTypess();
+    
-          "Valid values for <task-type> are " + taskTypes + ". " +
+          "Valid values for <task-type> are " + getTaskTypes() + ". " +
-        "Valid values for <task-type> are " + taskTypes + ". " +
+        "Valid values for <task-type> are " + getTaskTypes() + ". " +
-
+	  
-    try{
-      reports = job.getTaskReports(TaskType.valueOf(type));
-    }catch(IllegalArgumentException e){
-      throw new IllegalArgumentException("Invalid type: " + type + 
-          ". Valid types for task are: MAP, REDUCE, JOB_SETUP, JOB_CLEANUP, TASK_CLEANUP.");
-    }
+    reports = job.getTaskReports(TaskType.valueOf(type.toUpperCase()));
