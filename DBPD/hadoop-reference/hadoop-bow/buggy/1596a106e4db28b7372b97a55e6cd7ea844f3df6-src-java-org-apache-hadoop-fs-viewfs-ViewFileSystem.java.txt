    HADOOP-7284 Trash and shell's rm does not work for viewfs (Sanjay Radia)


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1127642 13f79535-47bb-0310-9956-ffa450edef68

-      workingDir =
-        this.makeQualified(new Path("/user/" + ugi.getShortUserName()));
+      workingDir = this.getHomeDirectory();
+  Path homeDir = null;
+  @Override
+  public Path getHomeDirectory() {
+    String base = "/user/";;
+    if (homeDir == null) {
+      // We deal with whether or not home dir should be /user (hdfs) or /Users (if run on local file system on mac
+      try {
+        if (this.exists(new Path("/user/"))) {
+          base = "/user/";
+        } else if (this.exists(new Path("/Users"))) {
+          base = "/Users/";  
+        } else if (this.exists(new Path("/homes"))) {
+          base = "/homes/";  
+        }
+      } catch (IOException e) {
+          // ignore - - the default of /user is good enough
+      }
+      homeDir = this.makeQualified(new Path(base + ugi.getShortUserName()));
+    }
+    return homeDir;
+  }
+  
