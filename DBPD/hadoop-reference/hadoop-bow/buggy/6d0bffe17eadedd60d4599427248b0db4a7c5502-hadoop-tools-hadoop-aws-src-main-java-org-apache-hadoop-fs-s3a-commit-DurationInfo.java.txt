HADOOP-14556. S3A to support Delegation Tokens.

Contributed by Steve Loughran and Daryn Sharp.

- * A duration with logging of final state at info in the {@code close()} call.
+ * A duration with logging of final state at info or debug
+ * in the {@code close()} call.
-   * Create the duration text from a {@code String.format()} code call.
+   * Should the log be at INFO rather than DEBUG.
+   */
+  private final boolean logAtInfo;
+
+  /**
+   * Create the duration text from a {@code String.format()} code call;
+   * log output at info level.
+    this(log, true, format, args);
+  }
+
+  /**
+   * Create the duration text from a {@code String.format()} code call
+   * and log either at info or debug.
+   * @param log log to write to
+   * @param logAtInfo should the log be at info, rather than debug
+   * @param format format string
+   * @param args list of arguments
+   */
+  public DurationInfo(Logger log,
+      boolean logAtInfo,
+      String format,
+      Object... args) {
-    log.info("Starting: {}", text);
+    this.logAtInfo = logAtInfo;
+    if (logAtInfo) {
+      log.info("Starting: {}", text);
+    } else {
+      log.debug("Starting: {}", text);
+    }
-    log.info(this.toString());
+    if (logAtInfo) {
+      log.info("{}", this);
+    } else {
+      log.debug("{}", this);
+    }
