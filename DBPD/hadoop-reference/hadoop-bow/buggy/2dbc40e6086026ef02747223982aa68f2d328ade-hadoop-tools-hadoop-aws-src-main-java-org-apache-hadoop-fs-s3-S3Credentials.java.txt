HADOOP-12059. S3Credentials should support use of CredentialProvider. Contributed by Sean Busbey.

+import java.io.IOException;
+   * @throws IOException if credential providers are misconfigured and we have
+   *                     to talk to them.
-  public void initialize(URI uri, Configuration conf) {
+  public void initialize(URI uri, Configuration conf) throws IOException {
-      secretAccessKey = conf.getTrimmed(secretAccessKeyProperty);
+      final char[] pass = conf.getPassword(secretAccessKeyProperty);
+      if (pass != null) {
+        secretAccessKey = (new String(pass)).trim();
+      }
