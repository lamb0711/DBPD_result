HDFS-5085. Refactor o.a.h.nfs to support different types of authentications. Contributed by Jing Zhao.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1521601 13f79535-47bb-0310-9956-ffa450edef68

-package org.apache.hadoop.oncrpc;
+package org.apache.hadoop.oncrpc.security;
-import java.util.Arrays;
+import org.apache.hadoop.oncrpc.XDR;
- *  Authentication Info as defined in RFC 1831
+ *  Authentication Info. Base class of Verifier and Credential.
-public class RpcAuthInfo {
+public abstract class RpcAuthInfo {
-  private final byte[] body;
-  protected RpcAuthInfo(AuthFlavor flavor, byte[] body) {
+  protected RpcAuthInfo(AuthFlavor flavor) {
-    this.body = body;
-  public static RpcAuthInfo read(XDR xdr) {
-    int type = xdr.readInt();
-    AuthFlavor flavor = AuthFlavor.fromValue(type);
-    byte[] body = xdr.readVariableOpaque();
-    return new RpcAuthInfo(flavor, body);
-  }
+  /** Load auth info */
+  public abstract void read(XDR xdr);
+  
+  /** Write auth info */
+  public abstract void write(XDR xdr);
-
-  public byte[] getBody() {
-    return Arrays.copyOf(body, body.length);
-  }
