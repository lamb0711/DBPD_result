HDFS-8934. Move ShortCircuitShm to hdfs-client. Contributed by Mingliang Liu.

-import org.apache.commons.logging.Log;
-import org.apache.commons.logging.LogFactory;
-import org.apache.hadoop.hdfs.protocolPB.PBHelper;
-import org.apache.hadoop.hdfs.server.datanode.ShortCircuitRegistry;
+import org.apache.hadoop.hdfs.protocolPB.PBHelperClient;
-import org.apache.hadoop.io.IOUtils;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
+
-  private static final Log LOG = LogFactory.getLog(DfsClientShmManager.class);
+  private static final Logger LOG = LoggerFactory.getLogger(
+      DfsClientShmManager.class);
-              PBHelper.vintPrefixed(peer.getInputStream()));
+            PBHelperClient.vintPrefixed(peer.getInputStream()));
-              new DfsClientShm(PBHelper.convert(resp.getId()),
+              new DfsClientShm(PBHelperClient.convert(resp.getId()),
-          IOUtils.cleanup(LOG,  fis[0]);
+          try {
+            fis[0].close();
+          } catch (Throwable e) {
+            LOG.debug("Exception in closing " + fis[0], e);
+          }
-    IOUtils.cleanup(LOG, domainSocketWatcher);
+    try {
+      domainSocketWatcher.close();
+    } catch (Throwable e) {
+      LOG.debug("Exception in closing " + domainSocketWatcher, e);
+    }
