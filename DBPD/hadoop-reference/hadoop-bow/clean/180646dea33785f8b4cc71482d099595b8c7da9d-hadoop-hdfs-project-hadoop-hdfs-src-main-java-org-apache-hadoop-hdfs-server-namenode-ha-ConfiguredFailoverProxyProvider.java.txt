HDFS-2418. Change ConfiguredFailoverProxyProvider to take advantage of HDFS-2231. (atm)


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1190078 13f79535-47bb-0310-9956-ffa450edef68

-import java.net.URI;
-import java.net.URISyntaxException;
-import org.apache.hadoop.hdfs.server.namenode.NameNode;
-  public static final String CONFIGURED_NAMENODE_ADDRESSES
-      = "dfs.ha.namenode.addresses";
-  
-      Collection<String> addresses = conf.getTrimmedStringCollection(
-          CONFIGURED_NAMENODE_ADDRESSES);
-      if (addresses == null || addresses.size() == 0) {
-        throw new RuntimeException(this.getClass().getSimpleName() +
-            " is configured but " + CONFIGURED_NAMENODE_ADDRESSES +
-            " is not set.");
-      }
-      for (String address : addresses) {
-        proxies.add(new AddressRpcProxyPair(
-            NameNode.getAddress(new URI(address).getAuthority())));
+      Collection<InetSocketAddress> addresses = DFSUtil.getHaNnRpcAddresses(
+          conf);
+      for (InetSocketAddress address : addresses) {
+        proxies.add(new AddressRpcProxyPair(address));
-    } catch (URISyntaxException e) {
-      throw new RuntimeException("Malformed URI set in " +
-          CONFIGURED_NAMENODE_ADDRESSES, e);
