YARN-1781. Modified NodeManagers to allow admins to specify max disk utilization for local disks so as to be able to offline full disks. Contributed by Varun Vasudev.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1575463 13f79535-47bb-0310-9956-ffa450edef68

-      localDirs = new DirectoryCollection(
-          validatePaths(conf.getTrimmedStrings(YarnConfiguration.NM_LOCAL_DIRS)));
-      logDirs = new DirectoryCollection(
-          validatePaths(conf.getTrimmedStrings(YarnConfiguration.NM_LOG_DIRS)));
+      float maxUsableSpacePercentagePerDisk =
+          conf.getFloat(
+            YarnConfiguration.NM_MAX_PER_DISK_UTILIZATION_PERCENTAGE,
+            YarnConfiguration.DEFAULT_NM_MAX_PER_DISK_UTILIZATION_PERCENTAGE);
+      long minFreeSpacePerDiskMB =
+          conf.getLong(YarnConfiguration.NM_MIN_PER_DISK_FREE_SPACE_MB,
+            YarnConfiguration.DEFAULT_NM_MIN_PER_DISK_FREE_SPACE_MB);
+      localDirs =
+          new DirectoryCollection(
+            validatePaths(conf
+              .getTrimmedStrings(YarnConfiguration.NM_LOCAL_DIRS)),
+            maxUsableSpacePercentagePerDisk, minFreeSpacePerDiskMB);
+      logDirs =
+          new DirectoryCollection(
+            validatePaths(conf.getTrimmedStrings(YarnConfiguration.NM_LOG_DIRS)),
+            maxUsableSpacePercentagePerDisk, minFreeSpacePerDiskMB);
