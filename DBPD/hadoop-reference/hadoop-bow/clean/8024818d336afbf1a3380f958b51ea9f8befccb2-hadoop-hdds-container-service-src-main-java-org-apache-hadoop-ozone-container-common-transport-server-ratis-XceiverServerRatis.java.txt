HDDS-1786 : Datanodes takeSnapshot should delete previously created snapshots (#1163)



-import org.apache.hadoop.conf.Configuration;
+import org.apache.hadoop.hdds.conf.OzoneConfiguration;
-  private final Configuration conf;
+  private final OzoneConfiguration conf;
-      Configuration conf)
+      OzoneConfiguration conf)
+    //Set the number of Snapshots Retained.
+    RatisServerConfiguration ratisServerConfiguration =
+        conf.getObject(RatisServerConfiguration.class);
+    int numSnapshotsRetained =
+        ratisServerConfiguration.getNumSnapshotsRetained();
+    RaftServerConfigKeys.Snapshot.setSnapshotRetentionPolicy(properties,
+        numSnapshotsRetained);
-      DatanodeDetails datanodeDetails, Configuration ozoneConf,
+      DatanodeDetails datanodeDetails, OzoneConfiguration ozoneConf,
