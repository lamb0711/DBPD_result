Merge trunk into HDFS-1623 branch.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1158072 13f79535-47bb-0310-9956-ffa450edef68

-  private boolean includeCounters;
+  private boolean includeAllCounters;
-    this.includeCounters = true;
+    this.includeAllCounters = true;
-  public boolean getIncludeCounters() {
-    return includeCounters; 
+  public boolean getIncludeAllCounters() {
+    return includeAllCounters;
-  public void setIncludeCounters(boolean send) {
-    includeCounters = send;
+  public void setIncludeAllCounters(boolean send) {
+    includeAllCounters = send;
+    counters.setWriteAllCounters(send);
-    out.writeBoolean(includeCounters);
+    out.writeBoolean(includeAllCounters);
-    if (includeCounters) {
-      counters.write(out);
-    }
+    counters.write(out);
-    this.includeCounters = in.readBoolean();
+    this.includeAllCounters = in.readBoolean();
-    if (includeCounters) {
-      counters.readFields(in);
-    }
+    counters.readFields(in);
