Merge remote-tracking branch 'apache/trunk' into HDFS-7285

-    /** The starting modification for fail-fast. */
-    private final int startModification = modification;
+    /** The current modification epoch. */
+    private int expectedModification = modification;
+    private LinkedElement<T> current;
-      if (modification != startModification) {
+      if (modification != expectedModification) {
-            + modification + " != startModification = " + startModification);
+            + modification + " != expectedModification = " + expectedModification);
+      current = next;
-      throw new UnsupportedOperationException("Remove is not supported.");
+      if (current == null) {
+        throw new NoSuchElementException();
+      }
+      if (modification != expectedModification) {
+        throw new ConcurrentModificationException("modification="
+            + modification + " != expectedModification = " + expectedModification);
+      }
+      LightWeightHashSet.this.removeElem(current.element);
+      current = null;
+      expectedModification = modification;
