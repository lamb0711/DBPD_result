HDDS-1017. Use distributed tracing to indentify performance problems in Ozone. Contributed by Elek, Marton.

-import com.google.protobuf.RpcController;
-import com.google.protobuf.ServiceException;
-
+import org.apache.hadoop.hdds.tracing.TracingUtil;
-import org.apache.hadoop.ozone.protocol.proto.OzoneManagerProtocolProtos
-    .OMRequest;
-import org.apache.hadoop.ozone.protocol.proto.OzoneManagerProtocolProtos
-    .OMResponse;
+import org.apache.hadoop.ozone.protocol.proto.OzoneManagerProtocolProtos.OMRequest;
+import org.apache.hadoop.ozone.protocol.proto.OzoneManagerProtocolProtos.OMResponse;
+import com.google.protobuf.RpcController;
+import com.google.protobuf.ServiceException;
+import io.opentracing.Scope;
-    if (isRatisEnabled) {
-      return submitRequestToRatis(request);
-    } else {
-      return submitRequestDirectlyToOM(request);
+    Scope scope = TracingUtil
+        .importAndCreateScope(request.getCmdType().name(),
+            request.getTraceID());
+    try {
+      if (isRatisEnabled) {
+        return submitRequestToRatis(request);
+      } else {
+        return submitRequestDirectlyToOM(request);
+      }
+    } finally {
+      scope.close();
