HDFS-2480. Separate datatypes for NamenodeProtocol. Contributed by Suresh Srinivas.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1187505 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.hdfs.protocol.DatanodeInfo;
-    NORMAL(org.apache.hadoop.hdfs.protocol.DatanodeInfo.AdminStates.NORMAL.toString()), 
-    DECOMMISSION_INPROGRESS(org.apache.hadoop.hdfs.protocol.DatanodeInfo.AdminStates.DECOMMISSION_INPROGRESS.toString()), 
-    DECOMMISSIONED(org.apache.hadoop.hdfs.protocol.DatanodeInfo.AdminStates.DECOMMISSIONED.toString());
+    NORMAL(DatanodeInfo.AdminStates.NORMAL.toString()), 
+    DECOMMISSION_INPROGRESS(DatanodeInfo.AdminStates.DECOMMISSION_INPROGRESS.toString()), 
+    DECOMMISSIONED(DatanodeInfo.AdminStates.DECOMMISSIONED.toString());
-  static public org.apache.hadoop.hdfs.protocol.DatanodeInfo convertDatanodeInfo(DatanodeInfoWritable di) {
+  static public DatanodeInfo convertDatanodeInfo(DatanodeInfoWritable di) {
-    return new org.apache.hadoop.hdfs.protocol.DatanodeInfo(
+    return new DatanodeInfo(
-        org.apache.hadoop.hdfs.protocol.DatanodeInfo.AdminStates.fromValue(di.getAdminState().value)); 
+        DatanodeInfo.AdminStates.fromValue(di.getAdminState().value)); 
-  static public org.apache.hadoop.hdfs.protocol.DatanodeInfo[] convertDatanodeInfo(DatanodeInfoWritable di[]) {
+  static public DatanodeInfo[] convertDatanodeInfo(DatanodeInfoWritable di[]) {
-    org.apache.hadoop.hdfs.protocol.DatanodeInfo[] result = new org.apache.hadoop.hdfs.protocol.DatanodeInfo[di.length];
+    DatanodeInfo[] result = new DatanodeInfo[di.length];
-  static public DatanodeInfoWritable[] convertDatanodeInfo(org.apache.hadoop.hdfs.protocol.DatanodeInfo[] di) {
+  static public DatanodeInfoWritable[] convertDatanodeInfo(DatanodeInfo[] di) {
-    
+  }
+  
+  static public DatanodeInfoWritable convertDatanodeInfo(DatanodeInfo di) {
+    if (di == null) return null;
+    return new DatanodeInfoWritable(new DatanodeIDWritable(di.getName(),
+        di.getStorageID(), di.getInfoPort(), di.getIpcPort()),
+        di.getNetworkLocation(), di.getHostName(), di.getCapacity(),
+        di.getDfsUsed(), di.getRemaining(), di.getBlockPoolUsed(),
+        di.getLastUpdate(), di.getXceiverCount(), 
+        AdminStates.fromValue(di.getAdminState().toString()));
