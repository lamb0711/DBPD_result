Merge trunk into HA branch


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1196458 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.yarn.api.records.ApplicationResourceUsageReport;
+  private final long submitTime;
-        EnumSet.of(RMAppEventType.KILL, RMAppEventType.ATTEMPT_FINISHED,
-            RMAppEventType.ATTEMPT_FAILED, RMAppEventType.ATTEMPT_KILLED))
+        EnumSet.of(RMAppEventType.APP_ACCEPTED,
+            RMAppEventType.APP_REJECTED, RMAppEventType.KILL,
+            RMAppEventType.ATTEMPT_FINISHED, RMAppEventType.ATTEMPT_FAILED,
+            RMAppEventType.ATTEMPT_KILLED))
-      YarnScheduler scheduler, ApplicationMasterService masterService) {
+      YarnScheduler scheduler, ApplicationMasterService masterService, 
+      long submitTime) {
+    this.submitTime = submitTime;
-      return createFinalApplicationStatus(this.stateMachine.getCurrentState());
+      return 
+          createFinalApplicationStatus(this.stateMachine.getCurrentState());
+      String origTrackingUrl = "N/A";
+      ApplicationResourceUsageReport appUsageReport = null;
+        origTrackingUrl = this.currentAttempt.getOriginalTrackingUrl();
+        appUsageReport = currentAttempt.getApplicationResourceUsageReport();
-          this.startTime, this.finishTime, finishState);
+          this.startTime, this.finishTime, finishState, appUsageReport,
+          origTrackingUrl);
+  public long getSubmitTime() {
+    return this.submitTime;
+  }
+
+  @Override
-
+    
-        submissionContext);
+        submissionContext, YarnConfiguration.getProxyHostAndPort(conf));
