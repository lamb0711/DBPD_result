Merge branch 'trunk' into HDDS-1535
-   * {@link S3AFileSystem#finishedWrite(String, long)} to update the filesystem.
+   * {@link S3AFileSystem#finishedWrite(String, long, String, String)}
+   * to update the filesystem.
-    CompleteMultipartUploadResult uploadResult = invoker.retry("Completing multipart commit", destKey,
-        true,
-        retrying,
-        () -> {
-          // a copy of the list is required, so that the AWS SDK doesn't
-          // attempt to sort an unmodifiable list.
-          return owner.getAmazonS3Client().completeMultipartUpload(
-              new CompleteMultipartUploadRequest(bucket,
-                  destKey,
-                  uploadId,
-                  new ArrayList<>(partETags)));
-        }
+    CompleteMultipartUploadResult uploadResult =
+        invoker.retry("Completing multipart commit", destKey,
+            true,
+            retrying,
+            () -> {
+              // a copy of the list is required, so that the AWS SDK doesn't
+              // attempt to sort an unmodifiable list.
+              return owner.getAmazonS3Client().completeMultipartUpload(
+                  new CompleteMultipartUploadRequest(bucket,
+                      destKey,
+                      uploadId,
+                      new ArrayList<>(partETags)));
+            }
-    owner.finishedWrite(destKey, length);
+    owner.finishedWrite(destKey, length, uploadResult.getETag(),
+        uploadResult.getVersionId());
