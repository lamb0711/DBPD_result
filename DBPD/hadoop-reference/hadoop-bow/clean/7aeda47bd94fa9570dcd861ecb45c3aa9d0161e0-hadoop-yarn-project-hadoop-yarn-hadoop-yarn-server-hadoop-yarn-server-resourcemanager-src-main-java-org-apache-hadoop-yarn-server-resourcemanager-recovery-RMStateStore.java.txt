Merge branch 'trunk' into HDFS-6581

+import org.apache.hadoop.yarn.server.resourcemanager.rmapp.attempt.AggregateAppResourceUsage;
+    long memorySeconds;
+    long vcoreSeconds;
-        long startTime) {
+        long startTime, long memorySeconds, long vcoreSeconds) {
-        null, "", null, ContainerExitStatus.INVALID);
+        null, "", null, ContainerExitStatus.INVALID, memorySeconds, vcoreSeconds);
-        int exitStatus) {
+        int exitStatus, long memorySeconds, long vcoreSeconds) {
+      this.memorySeconds = memorySeconds;
+      this.vcoreSeconds = vcoreSeconds;
+    public long getMemorySeconds() {
+      return memorySeconds;
+    }
+    public long getVcoreSeconds() {
+      return vcoreSeconds;
+    }
-  public abstract int getAndIncrementEpoch() throws Exception;
+  public abstract long getAndIncrementEpoch() throws Exception;
+    AggregateAppResourceUsage resUsage =
+        appAttempt.getRMAppAttemptMetrics().getAggregateAppResourceUsage();
-          appAttempt.getStartTime());
+          appAttempt.getStartTime(), resUsage.getMemorySeconds(),
+          resUsage.getVcoreSeconds());
-            appAttempt.getStartTime());
+            appAttempt.getStartTime(), 0, 0);
