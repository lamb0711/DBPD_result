HADOOP-16266. Add more fine-grained processing time metrics to the RPC layer. Contributed by Christopher Gregorian.

-        long startTime = Time.now();
-        int qTime = (int) (startTime-receivedTime);
+        Call currentCall = Server.getCurCall().get();
+          currentCall.setDetailedMetricsName(call.getMethodName());
-          int processingTime = (int) (Time.now() - startTime);
-          if (LOG.isDebugEnabled()) {
-            String msg = "Served: " + call.getMethodName() +
-                " queueTime= " + qTime + " procesingTime= " + processingTime;
-            if (exception != null) {
-              msg += " exception= " + exception.getClass().getSimpleName();
-            }
-            LOG.debug(msg);
+          if (exception != null) {
+            currentCall.setDetailedMetricsName(
+                exception.getClass().getSimpleName());
-          String detailedMetricsName = (exception == null) ?
-              call.getMethodName() :
-              exception.getClass().getSimpleName();
-          server
-              .updateMetrics(detailedMetricsName, qTime, processingTime, false);
