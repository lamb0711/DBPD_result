YARN-7339. LocalityMulticastAMRMProxyPolicy should handle cancel request properly. (Botong Huang via curino)

-      for (SubClusterId targetId : targetSubclusters) {
-        if (headroom.containsKey(targetId)) {
-          allocationBookkeeper.addAnyRR(targetId, originalResourceRequest);
-        }
+      for (SubClusterId targetId : headroom.keySet()) {
+        allocationBookkeeper.addAnyRR(targetId, originalResourceRequest);
-      if (!countContainersPerRM.containsKey(rr.getAllocationRequestId())) {
-        countContainersPerRM.put(rr.getAllocationRequestId(), new HashMap<>());
-      }
-      if (!countContainersPerRM.get(rr.getAllocationRequestId())
-          .containsKey(targetId)) {
-        countContainersPerRM.get(rr.getAllocationRequestId()).put(targetId,
-            new AtomicLong(0));
-      }
-      countContainersPerRM.get(rr.getAllocationRequestId()).get(targetId)
-          .addAndGet(rr.getNumContainers());
+      if (rr.getNumContainers() > 0) {
+        if (!countContainersPerRM.containsKey(rr.getAllocationRequestId())) {
+          countContainersPerRM.put(rr.getAllocationRequestId(),
+              new HashMap<>());
+        }
+        if (!countContainersPerRM.get(rr.getAllocationRequestId())
+            .containsKey(targetId)) {
+          countContainersPerRM.get(rr.getAllocationRequestId()).put(targetId,
+              new AtomicLong(0));
+        }
+        countContainersPerRM.get(rr.getAllocationRequestId()).get(targetId)
+            .addAndGet(rr.getNumContainers());
-      if (!totNumLocalizedContainers.containsKey(rr.getAllocationRequestId())) {
-        totNumLocalizedContainers.put(rr.getAllocationRequestId(),
-            new AtomicLong(0));
+        if (!totNumLocalizedContainers
+            .containsKey(rr.getAllocationRequestId())) {
+          totNumLocalizedContainers.put(rr.getAllocationRequestId(),
+              new AtomicLong(0));
+        }
+        totNumLocalizedContainers.get(rr.getAllocationRequestId())
+            .addAndGet(rr.getNumContainers());
-      totNumLocalizedContainers.get(rr.getAllocationRequestId())
-          .addAndGet(rr.getNumContainers());
