HADOOP-9770. Make RetryCache#state non volatile. Contributed by Suresh Srinivas.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1507414 13f79535-47bb-0310-9956-ffa450edef68

-    private volatile byte state = INPROGRESS;
+    private byte state = INPROGRESS;
-      Preconditions.checkArgument(clientId.length == 16, "Invalid clientId");
-      // Conver UUID bytes to two longs
+      // ClientId must be a UUID - that is 16 octets.
+      Preconditions.checkArgument(clientId.length == 16,
+          "Invalid clientId - must be UUID of size 16 octets");
+      // Convert UUID bytes to two longs
-    public boolean isSuccess() {
+    public synchronized boolean isSuccess() {
-        expirationTime);
+        System.nanoTime() + expirationTime);
-        payload, expirationTime);
+        payload, System.nanoTime() + expirationTime);
