HADOOP-7060. A more elegant FileSystem#listCorruptFileBlocks API. Contributed by Patrick Kling.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1044146 13f79535-47bb-0310-9956-ffa450edef68

-   * @return a list in which each entry describes a corrupt file/block
+   * @return an iterator over the corrupt files under the given path
+   * (may contain duplicates if a file has more than one corrupt block)
-  public CorruptFileBlocks listCorruptFileBlocks(final String path,
-                                                 final String cookie)
+  public RemoteIterator<Path> listCorruptFileBlocks(Path path)
-    final Path absF = fixRelativePart(new Path(path));
-    return new FSLinkResolver<CorruptFileBlocks>() {
+    final Path absF = fixRelativePart(path);
+    return new FSLinkResolver<RemoteIterator<Path>>() {
-      public CorruptFileBlocks next(final AbstractFileSystem fs, final Path p) 
+      public RemoteIterator<Path> next(final AbstractFileSystem fs,
+                                       final Path p) 
-        return fs.listCorruptFileBlocks(p.toUri().getPath(), cookie);
+        return fs.listCorruptFileBlocks(p);
