YARN-8618. Added detection for non-upgradable service.
           Contributed by Chandni Singh

-
+    boolean foundNotNeverComp = false;
+    for (Component comp : persistedService.getComponents()) {
+      // If restart policy of any component is not NEVER then upgrade is
+      // allowed.
+      if (!comp.getRestartPolicy().equals(Component.RestartPolicyEnum.NEVER)) {
+        foundNotNeverComp = true;
+        break;
+      }
+    }
+    if (!foundNotNeverComp) {
+      String message = "All the components of the service " + service.getName()
+          + " have " + Component.RestartPolicyEnum.NEVER + " restart policy, " +
+          "so it cannot be upgraded.";
+      LOG.error(message);
+      throw new YarnException(message);
+    }
