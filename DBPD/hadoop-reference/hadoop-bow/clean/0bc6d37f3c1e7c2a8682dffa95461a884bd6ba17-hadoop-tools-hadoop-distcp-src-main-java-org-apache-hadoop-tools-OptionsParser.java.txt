Revert "HDFS-9820. Improve distcp to support efficient restore to an earlier snapshot. Contributed by Yongjun Zhang."

This reverts commit 412c4c9a342b73bf1c1a7f43ea91245cbf94d02d.

-import org.apache.commons.lang.StringUtils;
-  private static void checkSnapshotsArgs(final String[] snapshots) {
-    Preconditions.checkArgument(snapshots != null && snapshots.length == 2
-        && !StringUtils.isBlank(snapshots[0])
-        && !StringUtils.isBlank(snapshots[1]),
-        "Must provide both the starting and ending snapshot names");
-  }
-
-  public static DistCpOptions parse(String[] args)
-      throws IllegalArgumentException {
+  public static DistCpOptions parse(String args[]) throws IllegalArgumentException {
-      String[] snapshots = getVals(command,
-          DistCpOptionSwitch.DIFF.getSwitch());
-      checkSnapshotsArgs(snapshots);
-      option.setUseDiff(snapshots[0], snapshots[1]);
-    }
-    if (command.hasOption(DistCpOptionSwitch.RDIFF.getSwitch())) {
-      String[] snapshots = getVals(command,
-          DistCpOptionSwitch.RDIFF.getSwitch());
-      checkSnapshotsArgs(snapshots);
-      option.setUseRdiff(snapshots[0], snapshots[1]);
+      String[] snapshots = getVals(command, DistCpOptionSwitch.DIFF.getSwitch());
+      Preconditions.checkArgument(snapshots != null && snapshots.length == 2,
+          "Must provide both the starting and ending snapshot names");
+      option.setUseDiff(true, snapshots[0], snapshots[1]);
-          SOURCE_FILE_LISTING.getSwitch())), targetPath);
+              SOURCE_FILE_LISTING.getSwitch())), targetPath);
