YARN-851. Share NMTokens using NMTokenCache (api-based) between AMRMClient and NMClient instead of memory based approach which is used currently. Contributed by Omkar Vinit Joshi.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1495247 13f79535-47bb-0310-9956-ffa450edef68

-import java.util.Map;
+import org.apache.hadoop.yarn.client.api.NMTokenCache;
-  private Map<String, Token> nmTokens;
-  public ContainerManagementProtocolProxy(Configuration conf,
-      Map<String, Token> nmTokens) {
-    this.nmTokens = nmTokens;
+  public ContainerManagementProtocolProxy(Configuration conf) {
-    
+
-            nmTokens.get(containerManagerBindAddr).getIdentifier())) {
+            NMTokenCache.getNMToken(containerManagerBindAddr).getIdentifier())) {
-              containerId, nmTokens.get(containerManagerBindAddr));
+              containerId, NMTokenCache.getNMToken(containerManagerBindAddr));
-  public synchronized void setNMTokens(Map<String, Token> nmTokens) {
-    this.nmTokens = nmTokens;
-  }
-  
+
+      
