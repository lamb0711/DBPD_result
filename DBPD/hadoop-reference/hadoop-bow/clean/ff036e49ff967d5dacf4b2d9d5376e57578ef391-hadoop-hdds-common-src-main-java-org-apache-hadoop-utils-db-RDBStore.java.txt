HDDS-357. Use DBStore and TableStore for OzoneManager non-background service.
Contributed by Nandakumar.

+
+    move(key, key, value, source, dest);
+  }
+
+  @Override
+  public void move(byte[] sourceKey, byte[] destKey, byte[] value, Table source,
+      Table dest) throws IOException {
-      batch.put(destTable.getHandle(), key, value);
-      batch.delete(sourceTable.getHandle(), key);
+      batch.put(destTable.getHandle(), destKey, value);
+      batch.delete(sourceTable.getHandle(), sourceKey);
-      LOG.error("Move of key failed. Key:{}", DFSUtil.bytes2String(key));
-      throw toIOException("Unable to move key: " + DFSUtil.bytes2String(key),
-          rockdbException);
+      LOG.error("Move of key failed. Key:{}", DFSUtil.bytes2String(sourceKey));
+      throw toIOException("Unable to move key: " +
+              DFSUtil.bytes2String(sourceKey), rockdbException);
+  @Override
+  public void write(WriteBatch batch) throws IOException {
+    try {
+      db.write(writeOptions, batch);
+    } catch (RocksDBException e) {
+      throw toIOException("Unable to write the batch.", e);
+    }
+  }
+
