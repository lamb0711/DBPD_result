Rebase onto trunk - fix some issues. Contributed by Rohith Sharma K S

+    super.serviceInit(configuration);
-    entityInfos.put(ServiceTimelineMetricsConstants.STATE,
-        service.getState().toString());
+//    entityInfos.put(ServiceTimelineMetricsConstants.STATE,
+//        service.getState().toString());
-      entityInfos.put(ServiceTimelineMetricsConstants.ARTIFACT_ID,
-          component.getArtifact().getId());
-      entityInfos.put(ServiceTimelineMetricsConstants.ARTIFACT_TYPE,
-          component.getArtifact().getType().toString());
-      if (component.getResource().getProfile() != null) {
-        entityInfos.put(ServiceTimelineMetricsConstants.RESOURCE_PROFILE,
-            component.getResource().getProfile());
+      if (component.getArtifact() != null) {
+        entityInfos.put(ServiceTimelineMetricsConstants.ARTIFACT_ID,
+            component.getArtifact().getId());
+        entityInfos.put(ServiceTimelineMetricsConstants.ARTIFACT_TYPE,
+            component.getArtifact().getType().toString());
-      entityInfos.put(ServiceTimelineMetricsConstants.RESOURCE_CPU,
-          component.getResource().getCpus());
-      entityInfos.put(ServiceTimelineMetricsConstants.RESOURCE_MEMORY,
-          component.getResource().getMemory());
+
+      if (component.getResource() != null) {
+        entityInfos.put(ServiceTimelineMetricsConstants.RESOURCE_CPU,
+            component.getResource().getCpus());
+        entityInfos.put(ServiceTimelineMetricsConstants.RESOURCE_MEMORY,
+            component.getResource().getMemory());
+        if (component.getResource().getProfile() != null) {
+          entityInfos.put(ServiceTimelineMetricsConstants.RESOURCE_PROFILE,
+              component.getResource().getProfile());
+        }
+      }
