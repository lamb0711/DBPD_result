Merging r1540239 through r1540547 from trunk to branch HDFS-2832

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2832@1540549 13f79535-47bb-0310-9956-ffa450edef68

-import java.util.List;
+  private int udpBoundPort; // Will set after server starts
+  private int tcpBoundPort; // Will set after server starts
-   * @param exports
+   * @param program
-  public MountdBase(List<String> exports, RpcProgram program) throws IOException {
+  public MountdBase(RpcProgram program) throws IOException {
+    udpBoundPort = udpServer.getBoundPort();
+    tcpBoundPort = tcpServer.getBoundPort();
-      rpcProgram.register(PortmapMapping.TRANSPORT_UDP);
-      rpcProgram.register(PortmapMapping.TRANSPORT_TCP);
+      rpcProgram.register(PortmapMapping.TRANSPORT_UDP, udpBoundPort);
+      rpcProgram.register(PortmapMapping.TRANSPORT_TCP, tcpBoundPort);
