YARN-2009. CapacityScheduler: Add intra-queue preemption for app priority support. (Sunil G via wangda)

+import com.google.common.annotations.VisibleForTesting;
+
+import java.util.Collections;
+import java.util.Comparator;
+import java.util.List;
-   * @param clusterResource
+   * @param clusterResource total resource
+
+  /**
+   * Compare by reversed priority order first, and then reversed containerId
+   * order.
+   *
+   * @param containers list of containers to sort for.
+   */
+  @VisibleForTesting
+  static void sortContainers(List<RMContainer> containers) {
+    Collections.sort(containers, new Comparator<RMContainer>() {
+      @Override
+      public int compare(RMContainer a, RMContainer b) {
+        int schedKeyComp = b.getAllocatedSchedulerKey()
+            .compareTo(a.getAllocatedSchedulerKey());
+        if (schedKeyComp != 0) {
+          return schedKeyComp;
+        }
+        return b.getContainerId().compareTo(a.getContainerId());
+      }
+    });
+  }
+
