HDFS-10195. Ozone: Add container persistence. Contributed by Anu Engineer.

-package org.apache.hadoop.ozone.web.localstorage;
+package org.apache.hadoop.ozone.container.common.utils;
+import org.iq80.leveldb.DBIterator;
- * OzoneLevelDBStore is used by the local
- * OzoneStore which is used in testing.
+ * LevelDB interface.
-class OzoneLevelDBStore {
+public class LevelDBStore {
+  private final File dbFile;
-   * @param dbPath - DB File path
+   * @param dbPath          - DB File path
-   *
-  OzoneLevelDBStore(File dbPath, boolean createIfMissing) throws IOException {
+  public LevelDBStore(File dbPath, boolean createIfMissing) throws
+      IOException {
+    this.dbFile = dbPath;
-   * @param key - key
+   * @param key   - key
-   *
+
+  /**
+   * Returns true if the DB is empty.
+   *
+   * @return boolean
+   * @throws IOException
+   */
+  public boolean isEmpty() throws IOException {
+    DBIterator iter = db.iterator();
+    try {
+      iter.seekToFirst();
+      return iter.hasNext();
+    } finally {
+      iter.close();
+    }
+  }
+
+  /**
+   * Returns Java File Object that points to the DB.
+   * @return File
+   */
+  public File getDbFile() {
+    return dbFile;
+  }
+
+  /**
+   * Returns the actual levelDB object.
+   * @return DB handle.
+   */
+  public DB getDB() {
+    return db;
+  }
+
