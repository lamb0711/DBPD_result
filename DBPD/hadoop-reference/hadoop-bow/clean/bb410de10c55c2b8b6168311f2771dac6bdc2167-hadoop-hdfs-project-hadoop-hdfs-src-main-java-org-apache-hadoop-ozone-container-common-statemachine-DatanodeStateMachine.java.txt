HDFS-11184. Ozone: SCM: Make SCM use container protocol. Contributed by Anu Engineer.

- * <p>
+ *
- * <p>
+ *
-import org.apache.hadoop.ozone.OzoneConfigKeys;
-import java.util.concurrent.ExecutionException;
-import java.util.concurrent.TimeoutException;
-    executorService = HadoopExecutors.newScheduledThreadPool(
-        this.conf.getInt(OzoneConfigKeys.OZONE_SCM_CONTAINER_THREADS,
-            OzoneConfigKeys.OZONE_SCM_CONTAINER_THREADS_DEFAULT),
-        new ThreadFactoryBuilder().setDaemon(true)
+    executorService = HadoopExecutors.newCachedThreadPool(
+                new ThreadFactoryBuilder().setDaemon(true)
-    heartbeatFrequency = OzoneClientUtils.getScmHeartbeatInterval(conf);
+    heartbeatFrequency = TimeUnit.SECONDS.toMillis(
+        OzoneClientUtils.getScmHeartbeatInterval(conf));
+        LOG.debug("Executing cycle Number : {}", context.getExecutionCount());
-      } catch (InterruptedException | ExecutionException | TimeoutException e) {
-        LOG.error("Unable to finish the execution", e);
+      } catch (Exception e) {
+        LOG.error("Unable to finish the execution.", e);
