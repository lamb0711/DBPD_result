MAPREDUCE-3519. Fixed a deadlock in NodeManager LocalDirectories's handling service. Contributed by Ravi Gummadi.    


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1212680 13f79535-47bb-0310-9956-ffa450edef68

-    synchronized(conf) {
-      conf.setStrings(YarnConfiguration.NM_LOG_DIRS,
+    conf.setStrings(YarnConfiguration.NM_LOG_DIRS,
-    }
-    Configuration conf = getConfig();
-    Path path = null;
-    synchronized (conf) {
-      path = localDirsAllocator.getLocalPathForWrite(pathStr, conf);
-    }
-    return path;
+    return localDirsAllocator.getLocalPathForWrite(pathStr, getConfig());
-    Configuration conf = getConfig();
-    Path path = null;
-    synchronized (conf) {
-      path = localDirsAllocator.getLocalPathForWrite(pathStr, size, conf,
-                                                     checkWrite);
-    }
-    return path;
+    return localDirsAllocator.getLocalPathForWrite(pathStr, size, getConfig(),
+                                                   checkWrite);
-    Configuration conf = getConfig();
-    Path path = null;
-    synchronized (conf) {
-      path = logDirsAllocator.getLocalPathForWrite(pathStr,
-        LocalDirAllocator.SIZE_UNKNOWN, conf, checkWrite);
-    }
-    return path;
+    return logDirsAllocator.getLocalPathForWrite(pathStr,
+        LocalDirAllocator.SIZE_UNKNOWN, getConfig(), checkWrite);
-    Configuration conf = getConfig();
-    Path path = null;
-    synchronized (conf) {
-      path = logDirsAllocator.getLocalPathToRead(pathStr, conf);
-    }
-    return path;
+    return logDirsAllocator.getLocalPathToRead(pathStr, getConfig());
