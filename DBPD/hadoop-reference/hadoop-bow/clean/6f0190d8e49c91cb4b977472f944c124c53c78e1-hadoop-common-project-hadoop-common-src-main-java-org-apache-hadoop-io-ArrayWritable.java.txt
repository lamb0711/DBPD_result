HADOOP-16678: Review of ArrayWritable (#1692)


-import java.io.*;
-import java.lang.reflect.Array;
+import java.io.DataInput;
+import java.io.DataOutput;
+import java.io.IOException;
+import java.util.Arrays;
-  private Class<? extends Writable> valueClass;
+  private final Class<? extends Writable> valueClass;
-  public Class getValueClass() {
+  public Class<? extends Writable> getValueClass() {
-    Object result = Array.newInstance(valueClass, values.length);
-    for (int i = 0; i < values.length; i++) {
-      Array.set(result, i, values[i]);
-    }
-    return result;
+    return Arrays.copyOf(values, values.length);
-  public void set(Writable[] values) { this.values = values; }
+  public void set(Writable[] values) {
+    this.values = values;
+  }
-  public Writable[] get() { return values; }
+  public Writable[] get() {
+    return values;
+  }
+  @Override
+  public String toString() {
+    return "ArrayWritable [valueClass=" + valueClass + ", values="
+        + Arrays.toString(values) + "]";
+  }
+
