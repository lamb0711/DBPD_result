HDFS-12982 : [SPS]: Reduce the locking and cleanup the Namesystem access. Contributed by Rakesh R.

+   * @param needLocation if blockLocations need to be returned
