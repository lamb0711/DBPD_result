HDFS-2979. Balancer should use logical uri for creating failover proxy with HA enabled. Contributed by Aaron T. Myers.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1295340 13f79535-47bb-0310-9956-ffa450edef68

-    this.conf = conf;
+    this.conf = new Configuration(conf);
-    String nsId = getNameServiceId(conf);
-    String namenodeId = HAUtil.getNameNodeId(conf, nsId);
-    this.haEnabled = HAUtil.isHAEnabled(conf, nsId);
+    String nsId = getNameServiceId(this.conf);
+    String namenodeId = HAUtil.getNameNodeId(this.conf, nsId);
+    this.haEnabled = HAUtil.isHAEnabled(this.conf, nsId);
-    this.allowStaleStandbyReads = HAUtil.shouldAllowStandbyReads(conf);
+    this.allowStaleStandbyReads = HAUtil.shouldAllowStandbyReads(this.conf);
-      initializeGenericKeys(conf, nsId, namenodeId);
-      initialize(conf);
+      initializeGenericKeys(this.conf, nsId, namenodeId);
+      initialize(this.conf);
+    conf = new Configuration(conf);
+    conf = new Configuration(conf);
