YARN-918. Remove ApplicationAttemptId from RegisterApplicationMasterRequestProto. Contributed by Vinod K V.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1504735 13f79535-47bb-0310-9956-ffa450edef68

-  private void authorizeRequest(ApplicationAttemptId appAttemptID)
+  private ApplicationAttemptId authorizeRequest()
-    String appAttemptIDStr = appAttemptID.toString();
-
-      String msg = "Cannot obtain the user-name for ApplicationAttemptID: "
-          + appAttemptIDStr + ". Got exception: "
-          + StringUtils.stringifyException(e);
+      String msg =
+          "Cannot obtain the user-name for authorizing ApplicationMaster. "
+              + "Got exception: " + StringUtils.stringifyException(e);
-        message = "No AMRMToken found for " + appAttemptIDStr;
+        message = "No AMRMToken found for user " + remoteUgi.getUserName();
-          "Got exception while looking for AMRMToken for " + appAttemptIDStr;
+          "Got exception while looking for AMRMToken for user "
+              + remoteUgi.getUserName();
-    ApplicationAttemptId remoteApplicationAttemptId =
-        appTokenIdentifier.getApplicationAttemptId();
-    if (!remoteApplicationAttemptId.equals(appAttemptID)) {
-      String msg = "Unauthorized request from ApplicationMaster. "
-          + "Expected ApplicationAttemptID: " + remoteApplicationAttemptId
-          + " Found: " + appAttemptIDStr;
-      LOG.warn(msg);
-      throw RPCUtil.getRemoteException(msg);
-    }
+    return appTokenIdentifier.getApplicationAttemptId();
-    ApplicationAttemptId applicationAttemptId = request
-        .getApplicationAttemptId();
-    authorizeRequest(applicationAttemptId);
+    ApplicationAttemptId applicationAttemptId = authorizeRequest();
-    ApplicationAttemptId applicationAttemptId = request
-        .getApplicationAttemptId();
-    authorizeRequest(applicationAttemptId);
+    ApplicationAttemptId applicationAttemptId = authorizeRequest();
-    ApplicationAttemptId appAttemptId = request.getApplicationAttemptId();
-    authorizeRequest(appAttemptId);
+    ApplicationAttemptId appAttemptId = authorizeRequest();
