HDFS-14593. RBF: Implement deletion feature for expired records in State Store. Contributed by  Takanobu Asanuma.

-import java.util.Collections;
-   * expired state.
+   * expired state. If an expired record exists beyond deletion time, it is
+   * removed.
+    List<R> deleteRecords = new ArrayList<>();
-      if (record.checkExpired(currentDriverTime)) {
+      if (record.shouldBeDeleted(currentDriverTime)) {
+        String recordName = StateStoreUtils.getRecordName(record.getClass());
+        if (getDriver().remove(record)) {
+          deleteRecords.add(record);
+          LOG.info("Deleted State Store record {}: {}", recordName, record);
+        } else {
+          LOG.warn("Couldn't delete State Store record {}: {}", recordName,
+              record);
+        }
+      } else if (record.checkExpired(currentDriverTime)) {
+    if (deleteRecords.size() > 0) {
+      newRecords.removeAll(deleteRecords);
+    }
-    List<R> newRecords = Collections.singletonList(record);
+    List<R> newRecords = new ArrayList<>();
+    newRecords.add(record);
