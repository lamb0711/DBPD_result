YARN-8953. [CSI] CSI driver adaptor module support in NodeManager. Contributed by Weiwei Yang.

+import org.apache.hadoop.yarn.api.CsiAdaptorProtocol;
+import org.apache.hadoop.yarn.conf.YarnConfiguration;
-  private Volume checkAndGetVolume(VolumeMetaData metaData) {
+  private Volume checkAndGetVolume(VolumeMetaData metaData)
+      throws InvalidVolumeException {
+    CsiAdaptorProtocol adaptor = volumeManager
+        .getAdaptorByDriverName(metaData.getDriverName());
+    if (adaptor == null) {
+      throw new InvalidVolumeException("It seems for the driver name"
+          + " specified in the volume " + metaData.getDriverName()
+          + " ,there is no matched driver-adaptor can be found. "
+          + "Is the driver probably registered? Please check if"
+          + " adaptors service addresses defined in "
+          + YarnConfiguration.NM_CSI_ADAPTOR_ADDRESSES
+          + " are correct and services are started.");
+    }
+    toAdd.setClient(adaptor);
