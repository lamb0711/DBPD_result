HDDS-2238. Container Data Scrubber spams log in empty cluster

Signed-off-by: Anu Engineer <aengineer@apache.org>

-import org.apache.hadoop.conf.Configuration;
+  private final long dataScanInterval;
-  public ContainerDataScanner(Configuration conf,
+  public ContainerDataScanner(ContainerScrubberConfiguration conf,
-                              HddsVolume volume, long bytesPerSec) {
+                              HddsVolume volume) {
-    this.throttler = new HddsDataTransferThrottler(bytesPerSec);
-    this.canceler = new Canceler();
-    this.metrics = ContainerDataScrubberMetrics.create(conf,
-        volume.toString());
+    dataScanInterval = conf.getDataScanInterval();
+    throttler = new HddsDataTransferThrottler(conf.getBandwidthPerVolume());
+    canceler = new Canceler();
+    metrics = ContainerDataScrubberMetrics.create(volume.toString());
-    Iterator<Container> itr = controller.getContainers(volume);
+    Iterator<Container<?>> itr = controller.getContainers(volume);
-      metrics.incNumScanIterations();
-      LOG.info("Completed an iteration of container data scrubber in" +
-              " {} minutes." +
-              " Number of  iterations (since the data-node restart) : {}" +
-              ", Number of containers scanned in this iteration : {}" +
-              ", Number of unhealthy containers found in this iteration : {}",
-          TimeUnit.NANOSECONDS.toMinutes(totalDuration),
-          metrics.getNumScanIterations(),
-          metrics.getNumContainersScanned(),
-          metrics.getNumUnHealthyContainers());
+      if (metrics.getNumContainersScanned() > 0) {
+        metrics.incNumScanIterations();
+        LOG.info("Completed an iteration of container data scrubber in" +
+                " {} minutes." +
+                " Number of iterations (since the data-node restart) : {}" +
+                ", Number of containers scanned in this iteration : {}" +
+                ", Number of unhealthy containers found in this iteration : {}",
+            TimeUnit.NANOSECONDS.toMinutes(totalDuration),
+            metrics.getNumScanIterations(),
+            metrics.getNumContainersScanned(),
+            metrics.getNumUnHealthyContainers());
+      }
+      long elapsedMillis = TimeUnit.NANOSECONDS.toMillis(totalDuration);
+      long remainingSleep = dataScanInterval - elapsedMillis;
+      if (remainingSleep > 0) {
+        try {
+          Thread.sleep(remainingSleep);
+        } catch (InterruptedException ignored) {
+        }
+      }
