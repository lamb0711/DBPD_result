Revert "HADOOP-10930. Refactor: Wrap Datanode IO related operations. Contributed by Xiaoyu Yao."

This reverts commit aeecfa24f4fb6af289920cbf8830c394e66bd78e.

+import org.apache.hadoop.io.nativeio.NativeIO;
-      DataChecksum requestedChecksum, long slowLogThresholdMs)
-      throws IOException {
+      DataChecksum requestedChecksum) throws IOException {
-          getVolume().isTransientStorage(), slowLogThresholdMs);
+          getVolume().isTransientStorage());
-    LocalReplica oldReplica = (LocalReplica) oldReplicaInfo;
-    File oldmeta = oldReplica.getMetaFile();
+    LocalReplica localReplica = (LocalReplica) oldReplicaInfo;
+
+    File oldmeta = localReplica.getMetaFile();
+    if (LOG.isDebugEnabled()) {
+      LOG.debug("Renaming " + oldmeta + " to " + newmeta);
+    }
-      oldReplica.renameMeta(newmeta);
+      NativeIO.renameTo(oldmeta, newmeta);
+    File blkfile = localReplica.getBlockFile();
+
+    if (LOG.isDebugEnabled()) {
+      LOG.debug("Renaming " + blkfile + " to " + newBlkFile
+          + ", file length=" + blkfile.length());
+    }
-      oldReplica.renameBlock(newBlkFile);
+      NativeIO.renameTo(blkfile, newBlkFile);
-        renameMeta(oldmeta);
+        NativeIO.renameTo(newmeta, oldmeta);
-          " Unable to move block file " + oldReplica.getBlockFile() +
-          " to rbw dir " + newBlkFile, e);
+                              " Unable to move block file " + blkfile +
+                              " to rbw dir " + newBlkFile, e);
