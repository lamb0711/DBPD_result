YARN-4571. Make app id/name available to the yarn authorizer provider for better auditing. (Jian He via wangda)

+import org.apache.hadoop.yarn.api.records.ApplicationId;
+import org.apache.hadoop.yarn.security.AccessRequest;
+import org.apache.hadoop.yarn.security.YarnAuthorizationProvider;
+import org.apache.hadoop.yarn.server.resourcemanager.scheduler.SchedulerUtils;
+import org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.CapacityScheduler;
-  
+  private YarnAuthorizationProvider authorizer;
+
+    this.authorizer = YarnAuthorizationProvider.getInstance(conf);
-  public boolean checkAccess(UserGroupInformation callerUGI,
-      QueueACL acl, String queueName) {
+  public boolean checkAccess(UserGroupInformation callerUGI, QueueACL acl,
+      String queueName, ApplicationId appId, String appName) {
-    return scheduler.checkAccess(callerUGI, acl, queueName);
+    if (scheduler instanceof CapacityScheduler) {
+      return authorizer.checkPermission(new AccessRequest(
+          ((CapacityScheduler) scheduler).getQueue(queueName)
+              .getPrivilegedEntity(), callerUGI,
+          SchedulerUtils.toAccessType(acl), appId.toString(), appName));
+    } else {
+      return scheduler.checkAccess(callerUGI, acl, queueName);
+    }
