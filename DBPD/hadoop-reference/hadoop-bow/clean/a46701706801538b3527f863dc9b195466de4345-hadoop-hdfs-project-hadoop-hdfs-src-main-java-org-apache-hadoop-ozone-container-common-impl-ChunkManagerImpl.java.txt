HDFS-12411. Ozone: Add container usage information to DN container report. Contributed by Xiaoyu Yao.

+import org.apache.hadoop.ozone.container.common.helpers.ContainerData;
+import java.nio.ByteBuffer;
-
-      Preconditions.checkNotNull(pipeline.getContainerName(),
+      String containerName = pipeline.getContainerName();
+      Preconditions.checkNotNull(containerName,
-      File chunkFile = ChunkUtils.validateChunk(pipeline,
-          containerManager.readContainer(pipeline.getContainerName()), info);
+      ContainerData container =
+          containerManager.readContainer(containerName);
+      File chunkFile = ChunkUtils.validateChunk(pipeline, container, info);
+      long oldSize = chunkFile.length();
-
+      containerManager.incrWriteBytes(containerName, info.getLen());
+      containerManager.incrWriteCount(containerName);
+      long newSize = chunkFile.length();
+      containerManager.incrBytesUsed(containerName, newSize - oldSize);
-      File chunkFile = ChunkUtils.getChunkFile(pipeline, containerManager
-          .readContainer(pipeline.getContainerName()), info);
-      return ChunkUtils.readData(chunkFile, info).array();
+      Preconditions.checkNotNull(pipeline, "Pipeline cannot be null");
+      String containerName = pipeline.getContainerName();
+      Preconditions.checkNotNull(containerName,
+          "Container name cannot be null");
+      ContainerData container =
+          containerManager.readContainer(containerName);
+      File chunkFile = ChunkUtils.getChunkFile(pipeline, container, info);
+      ByteBuffer data =  ChunkUtils.readData(chunkFile, info);
+      containerManager.incrReadCount(containerName);
+      containerManager.incrReadBytes(containerName, chunkFile.length());
+      return data.array();
-
+      Preconditions.checkNotNull(pipeline, "Pipeline cannot be null");
+      String containerName = pipeline.getContainerName();
+      Preconditions.checkNotNull(containerName,
+          "Container name cannot be null");
-          .readContainer(pipeline.getContainerName()), info);
+          .readContainer(containerName), info);
+        containerManager.decrBytesUsed(containerName, chunkFile.length());
