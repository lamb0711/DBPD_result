HDDS-2200 : Recon does not handle the NULL snapshot from OM DB cleanly.

Signed-off-by: Anu Engineer <aengineer@apache.org>

+    try {
+      omMetadataManager.start(configuration);
+    } catch (IOException ioEx) {
+      LOG.error("Error staring Recon OM Metadata Manager.", ioEx);
+    }
-  void updateReconOmDBWithNewSnapshot() throws IOException {
+  boolean updateReconOmDBWithNewSnapshot() throws IOException {
+      LOG.info("Got new checkpoint from OM : " +
+          dbSnapshot.getCheckpointLocation());
+        return true;
+    return false;
+    LOG.info("Syncing data from Ozone Manager.");
+        LOG.info("Obtaining delta updates from Ozone Manager");
+        LOG.info("Obtaining full snapshot from Ozone Manager");
-        updateReconOmDBWithNewSnapshot();
+        boolean success = updateReconOmDBWithNewSnapshot();
-        ReconTaskStatus reconTaskStatusRecord =
-            new ReconTaskStatus(
-                OmSnapshotTaskName.OM_DB_FULL_SNAPSHOT.name(),
-                System.currentTimeMillis(), getCurrentOMDBSequenceNumber());
-        reconTaskStatusDao.update(reconTaskStatusRecord);
-        // Reinitialize tasks that are listening.
-        reconTaskController.reInitializeTasks(omMetadataManager);
+        if (success) {
+          ReconTaskStatus reconTaskStatusRecord =
+              new ReconTaskStatus(
+                  OmSnapshotTaskName.OM_DB_FULL_SNAPSHOT.name(),
+                  System.currentTimeMillis(), getCurrentOMDBSequenceNumber());
+          reconTaskStatusDao.update(reconTaskStatusRecord);
+          // Reinitialize tasks that are listening.
+          LOG.info("Calling reprocess on Recon tasks.");
+          reconTaskController.reInitializeTasks(omMetadataManager);
+        }
