HDFS-13008. Ozone: Add DN container open/close state to container report. Contributed by  Xiaoyu Yao.

-  private boolean open;
+  private Long containerID;
+  private OzoneProtos.LifeCycleState state;
-  public ContainerData(String containerName, Configuration conf) {
+  public ContainerData(String containerName, Long containerID,
+      Configuration conf) {
-    this.open = true;
-
+    this.containerID = containerID;
+    this.state = OzoneProtos.LifeCycleState.OPEN;
-    ContainerData data = new ContainerData(protoData.getName(), conf);
+    ContainerData data = new ContainerData(protoData.getName(),
+        protoData.getContainerID(), conf);
-    if (protoData.hasOpen()) {
-      data.setOpen(protoData.getOpen());
-    } else {
-      data.setOpen(true);
+    if (protoData.hasState()) {
+      data.setState(protoData.getState());
+    builder.setContainerID(this.getContainerID());
-    builder.setOpen(this.isOpen());
+    builder.setState(this.getState());
+    if (this.getKeyCount() >= 0) {
+      builder.setKeyCount(this.getKeyCount());
+    }
+
+   * Get container ID.
+   * @return - container ID.
+   */
+  public synchronized Long getContainerID() {
+    return containerID;
+  }
+
+  public synchronized  void setState(OzoneProtos.LifeCycleState state) {
+    this.state = state;
+  }
+
+  public synchronized OzoneProtos.LifeCycleState getState() {
+    return this.state;
+  }
+
+  /**
-    return open;
+    return OzoneProtos.LifeCycleState.OPEN == state;
-    setOpen(false);
+    // TODO: closed or closing here
+    setState(OzoneProtos.LifeCycleState.CLOSED);
-  /**
-   * Sets the open or closed values.
-   * @param open
-   */
-  public synchronized void setOpen(boolean open) {
-    this.open = open;
-  }
-
