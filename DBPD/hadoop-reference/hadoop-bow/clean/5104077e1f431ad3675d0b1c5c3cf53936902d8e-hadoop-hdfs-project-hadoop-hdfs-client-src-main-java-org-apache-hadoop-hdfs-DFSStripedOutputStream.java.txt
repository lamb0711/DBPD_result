HDFS-9373. Erasure coding: friendly log information for write operations with some failed streamers. Contributed by Li Bo.

Change-Id: Ie8ab4ae00e9ee0eb03c32a54bea26a3524308038

+import java.util.LinkedHashMap;
+  private final Map<Integer, Integer> corruptBlockCountMap;
+  private int blockGroupIndex;
+    corruptBlockCountMap = new LinkedHashMap<>();
+    blockGroupIndex++;
+      corruptBlockCountMap.put(blockGroupIndex, failedStreamers.size());
+      logCorruptBlocks();
+  private void logCorruptBlocks() {
+    for (Map.Entry<Integer, Integer> entry : corruptBlockCountMap.entrySet()) {
+      int bgIndex = entry.getKey();
+      int corruptBlockCount = entry.getValue();
+      StringBuilder sb = new StringBuilder();
+      sb.append("Block group <").append(bgIndex).append("> has ")
+          .append(corruptBlockCount).append(" corrupt blocks.");
+      if (corruptBlockCount == numAllBlocks - numDataBlocks) {
+        sb.append(" It's at high risk of losing data.");
+      }
+      LOG.warn(sb.toString());
+    }
+  }
+
