YARN-2496. Enhanced Capacity Scheduler to have basic support for allocating resources based on node-labels. Contributed by Wangda Tan.
YARN-2500. Ehnaced ResourceManager to support schedulers allocating resources based on node-labels. Contributed by Wangda Tan.

+import org.apache.hadoop.yarn.api.records.ApplicationSubmissionContext;
-                + applicationAttemptId.getApplicationId();
+                + appID;
-            .get(applicationAttemptId.getApplicationId()).getUser(),
+            .get(appID).getUser(),
-          applicationAttemptId.getApplicationId(), applicationAttemptId);
+          appID, applicationAttemptId);
+    ApplicationId appId = applicationAttemptId.getApplicationId();
-                + applicationAttemptId.getApplicationId();
+                + appId;
-                .get(applicationAttemptId.getApplicationId()).getUser(),
+                .get(appId).getUser(),
-            message, applicationAttemptId.getApplicationId(),
+            message, appId,
-          rmContext.getRMApps().get(applicationAttemptId.getApplicationId());
+          rmContext.getRMApps().get(appId);
+    ApplicationId applicationId = appAttemptId.getApplicationId();
-                + appAttemptId.getApplicationId()
+                + applicationId
-            this.rmContext.getRMApps().get(appAttemptId.getApplicationId())
+            this.rmContext.getRMApps().get(applicationId)
-            appAttemptId.getApplicationId(),
+            applicationId,
-
+      RMApp app =
+          this.rmContext.getRMApps().get(applicationId);
+      
+      // set label expression for Resource Requests
+      ApplicationSubmissionContext asc = app.getApplicationSubmissionContext();
+      for (ResourceRequest req : ask) {
+        if (null == req.getNodeLabelExpression()) {
+          req.setNodeLabelExpression(asc.getNodeLabelExpression());
+        }
+      }
+              
-            rScheduler.getMaximumResourceCapability());
+            rScheduler.getMaximumResourceCapability(), app.getQueue(),
+            rScheduler);
-      RMApp app =
-          this.rmContext.getRMApps().get(appAttemptId.getApplicationId());
-            + " to application: " + appAttemptId.getApplicationId());
+            + " to application: " + applicationId);
