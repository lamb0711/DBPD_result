YARN-4162. CapacityScheduler: Add resource usage by partition and queue capacity by partition to REST API. (Naganarasimha G R via wangda)

-import org.apache.hadoop.yarn.nodelabels.RMNodeLabel;
-import org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.AbstractCSQueue;
-import org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.QueueCapacities;
+  protected QueueCapacitiesInfo capacities;
-  public CapacitySchedulerInfo(CSQueue parent, CapacityScheduler cs,
-      RMNodeLabel nodeLabel) {
-    String label = nodeLabel.getLabelName();
-    QueueCapacities parentQueueCapacities = parent.getQueueCapacities();
+  public CapacitySchedulerInfo(CSQueue parent, CapacityScheduler cs) {
-    this.usedCapacity = parentQueueCapacities.getUsedCapacity(label) * 100;
-    this.capacity = parentQueueCapacities.getCapacity(label) * 100;
-    float max = parentQueueCapacities.getMaximumCapacity(label);
+    this.usedCapacity = parent.getUsedCapacity() * 100;
+    this.capacity = parent.getCapacity() * 100;
+    float max = parent.getMaximumCapacity();
-    queues = getQueues(parent, nodeLabel);
+    capacities = new QueueCapacitiesInfo(parent.getQueueCapacities());
+    queues = getQueues(parent);
+  public QueueCapacitiesInfo getCapacities() {
+    return capacities;
+  }
+
-  protected CapacitySchedulerQueueInfoList getQueues(CSQueue parent,
-      RMNodeLabel nodeLabel) {
+  protected CapacitySchedulerQueueInfoList getQueues(CSQueue parent) {
-      if (nodeLabel.getIsExclusive()
-          && !((AbstractCSQueue) queue).accessibleToPartition(nodeLabel
-              .getLabelName())) {
-        // Skip displaying the hierarchy for the queues for which the exclusive
-        // labels are not accessible
-        continue;
-      }
-            new CapacitySchedulerLeafQueueInfo((LeafQueue) queue,
-                nodeLabel.getLabelName());
+            new CapacitySchedulerLeafQueueInfo((LeafQueue) queue);
-        info = new CapacitySchedulerQueueInfo(queue, nodeLabel.getLabelName());
-        info.queues = getQueues(queue, nodeLabel);
+        info = new CapacitySchedulerQueueInfo(queue);
+        info.queues = getQueues(queue);
-
