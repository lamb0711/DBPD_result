MAPREDUCE-3878. Null user on filtered jobhistory job page (Jonathon Eagles via tgraves)


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1292831 13f79535-47bb-0310-9956-ffa450edef68

-    UserGroupInformation callerUgi = UserGroupInformation.createRemoteUser(
-        request().getRemoteUser());
-    return job.checkAccess(callerUgi, JobACL.VIEW_JOB);
+    String remoteUser = request().getRemoteUser();
+    UserGroupInformation callerUGI = null;
+    if (remoteUser != null) {
+      callerUGI = UserGroupInformation.createRemoteUser(remoteUser);
+    }
+    if (callerUGI != null && !job.checkAccess(callerUGI, JobACL.VIEW_JOB)) {
+      return false;
+    }
+    return true;
