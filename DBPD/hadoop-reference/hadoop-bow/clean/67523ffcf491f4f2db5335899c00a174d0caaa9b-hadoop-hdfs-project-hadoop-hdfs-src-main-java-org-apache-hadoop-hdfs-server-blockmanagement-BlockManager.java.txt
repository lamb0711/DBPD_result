HDFS-9412. getBlocks occupies FSLock and takes too long to complete. Contributed by He Tianyi.

+
+  /**
+   * Minimum size that a block can be sent to Balancer through getBlocks.
+   * And after HDFS-8824, the small blocks are unused anyway, so there's no
+   * point to send them to balancer.
+   */
+  private long getBlocksMinBlockSize = -1;
+
+    this.getBlocksMinBlockSize = conf.getLongBytes(
+        DFSConfigKeys.DFS_BALANCER_GETBLOCKS_MIN_BLOCK_SIZE_KEY,
+        DFSConfigKeys.DFS_BALANCER_GETBLOCKS_MIN_BLOCK_SIZE_DEFAULT);
+      if (curBlock.getNumBytes() < getBlocksMinBlockSize) {
+        continue;
+      }
+        if (curBlock.getNumBytes() < getBlocksMinBlockSize) {
+          continue;
+        }
