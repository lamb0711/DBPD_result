YARN-2059. Added admin ACLs support to Timeline Server. Contributed by Zhijie Shen.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1597207 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.hadoop.yarn.conf.YarnConfiguration;
+import org.apache.hadoop.yarn.security.AdminACLsManager;
-  private boolean aclsEnabled;
+  private AdminACLsManager adminAclsManager;
-    aclsEnabled = conf.getBoolean(YarnConfiguration.YARN_ACL_ENABLE,
-        YarnConfiguration.DEFAULT_YARN_ACL_ENABLE);
+    this.adminAclsManager = new AdminACLsManager(conf);
-    if (!aclsEnabled) {
+    if (!adminAclsManager.areACLsEnabled()) {
-    // TODO: Currently we just check the user is the timeline entity owner. In
-    // the future, we need to check whether the user is admin or is in the
+    // TODO: Currently we just check the user is the admin or the timeline
+    // entity owner. In the future, we need to check whether the user is in the
-    if (callerUGI != null && callerUGI.getShortUserName().equals(owner)) {
+    if (callerUGI != null
+        && (adminAclsManager.isAdmin(callerUGI) ||
+            callerUGI.getShortUserName().equals(owner))) {
-  public void setACLsEnabled(boolean aclsEnabled) {
-    this.aclsEnabled = aclsEnabled;
+  public AdminACLsManager
+      setAdminACLsManager(AdminACLsManager adminAclsManager) {
+    AdminACLsManager oldAdminACLsManager = this.adminAclsManager;
+    this.adminAclsManager = adminAclsManager;
+    return oldAdminACLsManager;
