HDFS-12216. Ozone: TestKeys is failing consistently. Contributed by Mukul Kumar Singh.

+import static org.apache.hadoop.ozone.OzoneConfigKeys
+    .DFS_CONTAINER_IPC_PORT;
+import static org.apache.hadoop.ozone.OzoneConfigKeys
+    .DFS_CONTAINER_IPC_RANDOM_PORT;
+  public boolean restartDataNode(int i) throws IOException {
+    return restartDataNode(i, true);
+  }
+  /*
+   * Restart a particular datanode, wait for it to become active
+   */
+  public boolean restartDataNode(int i, boolean keepPort) throws IOException {
+    if (keepPort) {
+      DataNodeProperties dnProp = dataNodes.get(i);
+      int currentPort = dnProp.getDatanode().getOzoneContainerManager()
+          .getContainerServerPort();
+      Configuration config = dnProp.getConf();
+      config.setInt(DFS_CONTAINER_IPC_PORT, currentPort);
+      config.setBoolean(DFS_CONTAINER_IPC_RANDOM_PORT, false);
+    }
+    boolean status =  super.restartDataNode(i, true);
+    this.waitActive();
+    return status;
+  }
+
