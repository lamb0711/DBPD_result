YARN-9841. Capacity scheduler: add support for combined %user + %primary_group mapping. Contributed by Manikandan R

-          if (mapping.queue.equals(CURRENT_USER_MAPPING)) {
+          if (mapping.getParentQueue() != null
+              && mapping.getParentQueue().equals(PRIMARY_GROUP_MAPPING)
+              && mapping.getQueue().equals(CURRENT_USER_MAPPING)) {
+            return getPlacementContext(
+                new QueueMapping(mapping.getType(), mapping.getSource(),
+                    CURRENT_USER_MAPPING, groups.getGroups(user).get(0)),
+                user);
+          } else if (mapping.queue.equals(CURRENT_USER_MAPPING)) {
-    if (queuePath.hasParentQueue()) {
+    if (queuePath.hasParentQueue()
+        && queuePath.getParentQueue().equals(PRIMARY_GROUP_MAPPING)) {
+      // dynamic parent queue
+      return new QueueMapping(mapping.getType(), mapping.getSource(),
+          queuePath.getLeafQueue(), queuePath.getParentQueue());
+    } else if (queuePath.hasParentQueue()) {
