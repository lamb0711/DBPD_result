HDFS-9223. Code cleanup for DatanodeDescriptor and HeartbeatManager. Contributed by Jing Zhao.

-        dn.removeBlock(blockInfo); // remove from the list and wipe the location
+        removeBlock(dn, blockInfo); // remove from the list and wipe the location
-    boolean removed = node.removeBlock(info);
+    boolean removed = removeBlock(node, info);
+  /**
+   * Remove block from the list of blocks belonging to the data-node. Remove
+   * data-node from the block.
+   */
+  static boolean removeBlock(DatanodeDescriptor dn, BlockInfo b) {
+    final DatanodeStorageInfo s = b.findStorageInfo(dn);
+    // if block exists on this datanode
+    return s != null && s.removeBlock(b);
+  }
+
