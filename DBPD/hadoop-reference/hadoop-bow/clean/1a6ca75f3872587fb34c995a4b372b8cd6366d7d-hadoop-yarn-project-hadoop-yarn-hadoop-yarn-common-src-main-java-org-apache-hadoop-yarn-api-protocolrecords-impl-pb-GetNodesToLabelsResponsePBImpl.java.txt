YARN-6143. Fix incompatible issue caused by YARN-3583. (Sunil G via wangda)

-import org.apache.hadoop.yarn.proto.YarnProtos.NodeIdToLabelsInfoProto;
+import org.apache.hadoop.yarn.proto.YarnProtos.NodeIdToLabelsProto;
+import com.google.common.collect.Sets;
+
-  private Map<NodeId, Set<NodeLabel>> nodeToLabels;
+  private Map<NodeId, Set<String>> nodeToLabels;
-    List<NodeIdToLabelsInfoProto> list = p.getNodeToLabelsList();
-    this.nodeToLabels = new HashMap<NodeId, Set<NodeLabel>>();
+    List<NodeIdToLabelsProto> list = p.getNodeToLabelsList();
+    this.nodeToLabels = new HashMap<NodeId, Set<String>>();
-    for (NodeIdToLabelsInfoProto c : list) {
-      Set<NodeLabel> labels = new HashSet<NodeLabel>();
-      for (NodeLabelProto l : c.getNodeLabelsList()) {
-        labels.add(new NodeLabelPBImpl(l));
-      }
-      this.nodeToLabels.put(new NodeIdPBImpl(c.getNodeId()), labels);
+    for (NodeIdToLabelsProto c : list) {
+      this.nodeToLabels.put(new NodeIdPBImpl(c.getNodeId()),
+          Sets.newHashSet(c.getNodeLabelsList()));
-    Iterable<NodeIdToLabelsInfoProto> iterable =
-        new Iterable<NodeIdToLabelsInfoProto>() {
+    Iterable<NodeIdToLabelsProto> iterable =
+        new Iterable<NodeIdToLabelsProto>() {
-          public Iterator<NodeIdToLabelsInfoProto> iterator() {
-            return new Iterator<NodeIdToLabelsInfoProto>() {
+          public Iterator<NodeIdToLabelsProto> iterator() {
+            return new Iterator<NodeIdToLabelsProto>() {
-              Iterator<Entry<NodeId, Set<NodeLabel>>> iter = nodeToLabels
+              Iterator<Entry<NodeId, Set<String>>> iter = nodeToLabels
-              public NodeIdToLabelsInfoProto next() {
-                Entry<NodeId, Set<NodeLabel>> now = iter.next();
-                Set<NodeLabelProto> labelProtoList =
-                    new HashSet<NodeLabelProto>();
-                for (NodeLabel l : now.getValue()) {
-                  labelProtoList.add(convertToProtoFormat(l));
-                }
-                return NodeIdToLabelsInfoProto.newBuilder()
+              public NodeIdToLabelsProto next() {
+                Entry<NodeId, Set<String>> now = iter.next();
+                return NodeIdToLabelsProto.newBuilder()
-                    .addAllNodeLabels(labelProtoList).build();
+                    .addAllNodeLabels(now.getValue()).build();
-  public Map<NodeId, Set<NodeLabel>> getNodeToLabels() {
+  public Map<NodeId, Set<String>> getNodeToLabels() {
-  public void setNodeToLabels(Map<NodeId, Set<NodeLabel>> map) {
+  public void setNodeToLabels(Map<NodeId, Set<String>> map) {
-  
-  private NodeLabelProto convertToProtoFormat(NodeLabel t) {
-    return ((NodeLabelPBImpl)t).getProto();
-  }
