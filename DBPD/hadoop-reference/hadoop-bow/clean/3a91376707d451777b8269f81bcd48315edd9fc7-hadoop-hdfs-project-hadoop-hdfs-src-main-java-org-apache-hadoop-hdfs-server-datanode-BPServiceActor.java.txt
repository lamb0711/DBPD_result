HDFS-11558. BPServiceActor thread name is too long. Contributed by Xiaobing Zhou

-import java.util.Collection;
-    
+
+    /* set thread name again to include NamespaceInfo when it's available. */
+    this.bpThread.setName(formatThreadName("heartbeating", nnAddr));
+
-  
-  private String formatThreadName(String action, InetSocketAddress addr) {
-    Collection<StorageLocation> dataDirs =
-        DataNode.getStorageLocations(dn.getConf());
-    return "DataNode: [" + dataDirs.toString() + "]  " +
-        action + " to " + addr;
+
+  private String formatThreadName(
+      final String action,
+      final InetSocketAddress addr) {
+    final String prefix = bpos.getBlockPoolId() != null ? bpos.getBlockPoolId()
+        : bpos.getNameserviceId();
+    return prefix + " " + action + " to " + addr;
-  
+
-      lifelineThread = new Thread(this, formatThreadName("lifeline",
-          lifelineNnAddr));
+      lifelineThread = new Thread(this,
+          formatThreadName("lifeline", lifelineNnAddr));
