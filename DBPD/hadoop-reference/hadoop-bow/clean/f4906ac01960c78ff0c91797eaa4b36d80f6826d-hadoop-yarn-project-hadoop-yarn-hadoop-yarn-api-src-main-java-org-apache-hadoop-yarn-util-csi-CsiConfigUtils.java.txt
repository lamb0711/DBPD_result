YARN-9038. [CSI] Add ability to publish/unpublish volumes on node managers. Contributed by Weiwei Yang.

-package org.apache.hadoop.yarn.csi.utils;
+package org.apache.hadoop.yarn.util.csi;
+import com.google.common.base.Strings;
- * Utility class to load configurations.
+ * Utility class for CSI in the API level.
-public final class ConfigUtils {
+public final class CsiConfigUtils {
-  private ConfigUtils() {
+  private CsiConfigUtils() {
+
+  public static String[] getCsiDriverNames(Configuration conf) {
+    return conf.getStrings(YarnConfiguration.NM_CSI_DRIVER_NAMES);
+  }
+
+  public static String getCsiDriverEndpoint(String driverName,
+      Configuration conf) throws YarnException {
+    String driverEndpointProperty = YarnConfiguration.NM_CSI_DRIVER_PREFIX
+        + driverName + YarnConfiguration.NM_CSI_DRIVER_ENDPOINT_SUFFIX;
+    String driverEndpoint = conf.get(driverEndpointProperty);
+    if (Strings.isNullOrEmpty(driverEndpoint)) {
+      throw new YarnException("CSI driver's endpoint is not specified or"
+          + " invalid, property "+ driverEndpointProperty + " is not defined");
+    }
+    return driverEndpoint;
+  }
+
-        + driverName + ".address";
+        + driverName + YarnConfiguration.NM_CSI_ADAPTOR_ADDRESS_SUFFIX;
