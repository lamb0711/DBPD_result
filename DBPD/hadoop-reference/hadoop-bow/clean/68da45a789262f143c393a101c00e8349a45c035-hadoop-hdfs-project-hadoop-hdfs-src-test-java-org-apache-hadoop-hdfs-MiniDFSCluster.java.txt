HDFS-11519. Ozone: Implement XceiverServerSpi and XceiverClientSpi using Ratis. Contributed by Tsz Wo Nicholas Sze.

-      setupDatanodeAddress(dnConf, setupHostsFile, checkDataNodeAddrConfig);
+      setupDatanodeAddress(i, dnConf, setupHostsFile, checkDataNodeAddrConfig);
+   * For examples,
-   * <li><base directory>/data/data<2*dnIndex + 1></li>
-   * <li><base directory>/data/data<2*dnIndex + 2></li>
+   * <li><base directory>/data/dn0_data0</li>
+   * <li><base directory>/data/dn0_data1</li>
+   * <li><base directory>/data/dn1_data0</li>
+   * <li><base directory>/data/dn1_data1</li>
-  public File getStorageDir(int dnIndex, int dirIndex) {
+  public static File getStorageDir(int dnIndex, int dirIndex) {
-  private String getStorageDirPath(int dnIndex, int dirIndex) {
-    return "data/data" + (storagesPerDatanode * dnIndex + 1 + dirIndex);
+  private static String getStorageDirPath(int dnIndex, int dirIndex) {
+    return "data/dn" + dnIndex + "_data" + dirIndex;
-  protected void setupDatanodeAddress(Configuration conf, boolean setupHostsFile,
-                           boolean checkDataNodeAddrConfig) throws IOException {
+  protected void setupDatanodeAddress(
+      int i, Configuration dnConf, boolean setupHostsFile,
+      boolean checkDataNodeAddrConfig) throws IOException {
-      String hostsFile = conf.get(DFS_HOSTS, "").trim();
+      String hostsFile = dnConf.get(DFS_HOSTS, "").trim();
-        conf.setIfUnset(DFS_DATANODE_ADDRESS_KEY, address);
+        dnConf.setIfUnset(DFS_DATANODE_ADDRESS_KEY, address);
-        conf.set(DFS_DATANODE_ADDRESS_KEY, address);
+        dnConf.set(DFS_DATANODE_ADDRESS_KEY, address);
-        conf.setIfUnset(DFS_DATANODE_ADDRESS_KEY, "127.0.0.1:0");
+        dnConf.setIfUnset(DFS_DATANODE_ADDRESS_KEY, "127.0.0.1:0");
-        conf.set(DFS_DATANODE_ADDRESS_KEY, "127.0.0.1:0");
+        dnConf.set(DFS_DATANODE_ADDRESS_KEY, "127.0.0.1:0");
-      conf.setIfUnset(DFS_DATANODE_HTTP_ADDRESS_KEY, "127.0.0.1:0");
-      conf.setIfUnset(DFS_DATANODE_IPC_ADDRESS_KEY, "127.0.0.1:0");
+      dnConf.setIfUnset(DFS_DATANODE_HTTP_ADDRESS_KEY, "127.0.0.1:0");
+      dnConf.setIfUnset(DFS_DATANODE_IPC_ADDRESS_KEY, "127.0.0.1:0");
-      conf.set(DFS_DATANODE_HTTP_ADDRESS_KEY, "127.0.0.1:0");
-      conf.set(DFS_DATANODE_IPC_ADDRESS_KEY, "127.0.0.1:0");
+      dnConf.set(DFS_DATANODE_HTTP_ADDRESS_KEY, "127.0.0.1:0");
+      dnConf.set(DFS_DATANODE_IPC_ADDRESS_KEY, "127.0.0.1:0");
