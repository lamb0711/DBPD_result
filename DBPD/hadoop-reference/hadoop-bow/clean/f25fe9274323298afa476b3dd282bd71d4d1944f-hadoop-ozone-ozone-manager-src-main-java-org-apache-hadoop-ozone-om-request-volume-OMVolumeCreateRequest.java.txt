HDDS-1909. Use new HA code for Non-HA in OM. (#1225)


+import java.util.Collection;
-import org.apache.hadoop.ozone.security.acl.IAccessAuthorizer;
-import org.apache.hadoop.ozone.security.acl.OzoneObj;
+import static org.apache.hadoop.ozone.OzoneConfigKeys.OZONE_ADMINISTRATORS_WILDCARD;
+    Collection<String> ozAdmins = ozoneManager.getOzoneAdmins();
+
-        checkAcls(ozoneManager, OzoneObj.ResourceType.VOLUME,
-            OzoneObj.StoreType.OZONE, IAccessAuthorizer.ACLType.CREATE, volume,
-            null, null);
+        if (!ozAdmins.contains(OZONE_ADMINISTRATORS_WILDCARD) &&
+            !ozAdmins.contains(getUserInfo().getUserName())) {
+          throw new OMException("Only admin users are authorized to create " +
+              "Ozone volumes. User: " + getUserInfo().getUserName(),
+              OMException.ResultCodes.PERMISSION_DENIED);
+        }
-      LOG.debug("created volume:{} for user:{}", volume, owner);
+      LOG.info("created volume:{} for user:{}", volume, owner);
