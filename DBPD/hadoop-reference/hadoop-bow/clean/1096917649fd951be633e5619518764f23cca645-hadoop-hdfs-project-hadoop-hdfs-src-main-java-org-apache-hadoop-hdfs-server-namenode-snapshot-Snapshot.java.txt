HDFS-4611. Update FSImage for INodeReference.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1463332 13f79535-47bb-0310-9956-ffa450edef68

+import java.io.DataInput;
+import org.apache.hadoop.hdfs.server.namenode.FSImageFormat;
-  Snapshot(int id, INodeDirectory dir,
-      INodeDirectorySnapshottable parent) {
+  Snapshot(int id, INodeDirectory dir, INodeDirectorySnapshottable parent) {
+  public int getId() {
+    return id;
+  }
+
-    return getClass().getSimpleName() + "." + root.getLocalName();
+    return getClass().getSimpleName() + "." + root.getLocalName() + "(id=" + id + ")";
+  
+  static Snapshot read(DataInput in, FSImageFormat.Loader loader) throws IOException {
+    final int snapshotId = in.readInt();
+    final INode root = loader.loadINodeWithLocalName(false, in);
+    return new Snapshot(snapshotId, root.asDirectory(), null);
+  }
