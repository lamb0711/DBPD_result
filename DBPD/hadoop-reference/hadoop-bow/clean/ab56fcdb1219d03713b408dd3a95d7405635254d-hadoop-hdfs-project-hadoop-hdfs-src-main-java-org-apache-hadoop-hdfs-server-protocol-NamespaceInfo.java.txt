Merge remote-tracking branch 'apache/trunk' into HDFS-7285

-  private static long CAPABILITIES_SUPPORTED = 0;
+  private static final long CAPABILITIES_SUPPORTED = getSupportedCapabilities();
+
+  private static long getSupportedCapabilities() {
+    long mask = 0;
+    for (Capability c : Capability.values()) {
+      if (c.supported) {
+        mask |= c.mask;
+      }
+    }
+    return mask;
+  }
+    private final boolean supported;
+      supported = isSupported;
-      if (isSupported) {
-        CAPABILITIES_SUPPORTED |= mask;
-      }
