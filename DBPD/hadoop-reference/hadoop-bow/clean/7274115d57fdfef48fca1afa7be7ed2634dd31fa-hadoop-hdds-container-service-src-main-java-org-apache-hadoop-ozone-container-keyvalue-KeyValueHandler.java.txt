HDDS-890. Handle OverlappingFileLockException during writeStateMachineData in ContainerStateMachine. Contributed by Shashikant Banerjee.

-      boolean isReadFromTmpFile = dispatcherContext == null ? false :
-          dispatcherContext.isReadFromTmpFile();
+      if (dispatcherContext == null) {
+        dispatcherContext = new DispatcherContext.Builder().build();
+      }
+
-          .readChunk(kvContainer, blockID, chunkInfo, isReadFromTmpFile);
+          .readChunk(kvContainer, blockID, chunkInfo, dispatcherContext);
-      WriteChunkStage stage =
-          dispatcherContext == null ? WriteChunkStage.COMBINED :
-              dispatcherContext.getStage();
+      if (dispatcherContext == null) {
+        dispatcherContext = new DispatcherContext.Builder().build();
+      }
+      WriteChunkStage stage = dispatcherContext.getStage();
-      chunkManager.writeChunk(kvContainer, blockID, chunkInfo, data, stage);
+      chunkManager
+          .writeChunk(kvContainer, blockID, chunkInfo, data, dispatcherContext);
-      WriteChunkStage stage =
-          dispatcherContext == null ? WriteChunkStage.COMBINED :
-              dispatcherContext.getStage();
+      if (dispatcherContext == null) {
+        dispatcherContext = new DispatcherContext.Builder().build();
+      }
+
-      chunkManager.writeChunk(kvContainer, blockID, chunkInfo, data, stage);
+      chunkManager
+          .writeChunk(kvContainer, blockID, chunkInfo, data, dispatcherContext);
-      long bcsId =
-          dispatcherContext == null ? 0 : dispatcherContext.getLogIndex();
-      blockData.setBlockCommitSequenceId(bcsId);
+      blockData.setBlockCommitSequenceId(dispatcherContext.getLogIndex());
+      DispatcherContext dispatcherContext =
+          new DispatcherContext.Builder().build();
-            ChunkInfo.getFromProtoBuf(chunk), false);
+            ChunkInfo.getFromProtoBuf(chunk), dispatcherContext);
