YARN-5708. Implement APIs to get resource profiles from the RM. Contributed by Varun Vasudev.

+import org.apache.hadoop.yarn.api.protocolrecords.GetAllResourceProfilesRequest;
+import org.apache.hadoop.yarn.api.protocolrecords.GetAllResourceProfilesResponse;
+import org.apache.hadoop.yarn.api.protocolrecords.GetResourceProfileRequest;
+import org.apache.hadoop.yarn.api.protocolrecords.GetResourceProfileResponse;
+import org.apache.hadoop.yarn.server.resourcemanager.resource.ResourceProfilesManager;
+  private ResourceProfilesManager resourceProfilesManager;
+
+    resourceProfilesManager = rmContext.getResourceProfilesManager();
+  @Override
+  public GetAllResourceProfilesResponse getResourceProfiles(
+      GetAllResourceProfilesRequest request) throws YarnException, IOException {
+    GetAllResourceProfilesResponse response =
+        GetAllResourceProfilesResponse.newInstance();
+    response.setResourceProfiles(getResourceProfiles());
+    return response;
+  }
+
+  @Override
+  public GetResourceProfileResponse getResourceProfile(
+      GetResourceProfileRequest request) throws YarnException, IOException {
+    Map<String, Resource> profiles = getResourceProfiles();
+    if (!profiles.containsKey(request.getProfileName())) {
+      throw new YarnException(
+          "Resource profile '" + request.getProfileName() + "' not found");
+    }
+    GetResourceProfileResponse response =
+        GetResourceProfileResponse.newInstance();
+    response.setResource(
+        resourceProfilesManager.getProfile(request.getProfileName()));
+    return response;
+  }
+
+  private Map<String, Resource> getResourceProfiles() throws YarnException {
+    boolean resourceProfilesEnabled = getConfig()
+        .getBoolean(YarnConfiguration.RM_RESOURCE_PROFILES_ENABLED,
+            YarnConfiguration.DEFAULT_RM_RESOURCE_PROFILES_ENABLED);
+    if (!resourceProfilesEnabled) {
+      throw new YarnException("Resource profiles are not enabled");
+    }
+    return resourceProfilesManager.getResourceProfiles();
+  }
