HDDS-1674. Make ScmBlockLocationProtocol message type based.

Closes #984

+import org.apache.hadoop.hdds.protocol.proto.ScmBlockLocationProtocolProtos;
+import org.apache.hadoop.hdds.protocol.proto.ScmBlockLocationProtocolProtos
+    .SCMBlockLocationResponse;
+import org.apache.hadoop.hdds.protocol.proto.ScmBlockLocationProtocolProtos
+    .SCMBlockLocationRequest;
+import org.apache.hadoop.hdds.protocol.proto.ScmBlockLocationProtocolProtos
+    .Status;
+
+  private SCMBlockLocationResponse.Builder createSCMBlockResponse(
+      ScmBlockLocationProtocolProtos.Type cmdType,
+      String traceID) {
+    return SCMBlockLocationResponse.newBuilder()
+        .setCmdType(cmdType)
+        .setTraceID(traceID);
+  }
+
+  public SCMBlockLocationResponse send(RpcController controller,
+      SCMBlockLocationRequest request) throws ServiceException {
+    String traceId = request.getTraceID();
+
+    SCMBlockLocationResponse.Builder response = createSCMBlockResponse(
+        request.getCmdType(),
+        traceId);
+
+    switch (request.getCmdType()) {
+    case AllocateScmBlock:
+      response.setAllocateScmBlockResponse(
+          allocateScmBlock(traceId, request.getAllocateScmBlockRequest()));
+      break;
+    case DeleteScmKeyBlocks:
+      response.setDeleteScmKeyBlocksResponse(
+          deleteScmKeyBlocks(traceId, request.getDeleteScmKeyBlocksRequest()));
+      break;
+    case GetScmInfo:
+      response.setGetScmInfoResponse(
+          getScmInfo(traceId, request.getGetScmInfoRequest()));
+      break;
+    default:
+      throw new ServiceException("Unknown Operation");
+    }
+    response.setSuccess(true)
+        .setStatus(Status.OK);
+    return response.build();
+  }
+
-      RpcController controller, AllocateScmBlockRequestProto request)
+      String traceId, AllocateScmBlockRequestProto request)
-    try (Scope scope = TracingUtil
+    try(Scope scope = TracingUtil
-            request.getTraceID())) {
+            traceId)) {
-  @Override
-      RpcController controller, DeleteScmKeyBlocksRequestProto req)
+      String traceId, DeleteScmKeyBlocksRequestProto req)
-    try {
+    try(Scope scope = TracingUtil
+        .importAndCreateScope("ScmBlockLocationProtocol.deleteKeyBlocks",
+            traceId)) {
-  @Override
-      RpcController controller, HddsProtos.GetScmInfoRequestProto req)
+      String traceId, HddsProtos.GetScmInfoRequestProto req)
-    try {
+    try(Scope scope = TracingUtil
+        .importAndCreateScope("ScmBlockLocationProtocol.getInfo",
+            traceId)) {
