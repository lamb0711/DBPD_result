HDFS-8283. DataStreamer cleanup and some minor improvement. Contributed by Tsz Wo Nicholas Sze.

+import java.util.ArrayList;
+
+  /**
+   * Build an {@link IOException} using {@link MultipleIOException}
+   * if there are more than one.
+   */
+  public static class Builder {
+    private List<IOException> exceptions;
+    
+    /** Add the given {@link Throwable} to the exception list. */
+    public void add(Throwable t) {
+      if (exceptions == null) {
+        exceptions = new ArrayList<>();
+      }
+      exceptions.add(t instanceof IOException? (IOException)t
+          : new IOException(t));
+    }
+
+    /**
+     * @return null if nothing is added to this builder;
+     *         otherwise, return an {@link IOException}
+     */
+    public IOException build() {
+      return createIOException(exceptions);
+    }
+  }
