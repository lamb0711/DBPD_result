HDFS-14609. RBF: Security should use common AuthenticationFilter. Contributed by Chen Zhang.

-import static org.apache.hadoop.hdfs.DFSConfigKeys.DFS_WEB_AUTHENTICATION_KERBEROS_KEYTAB_KEY;
-import static org.apache.hadoop.hdfs.DFSConfigKeys.DFS_WEB_AUTHENTICATION_KERBEROS_PRINCIPAL_KEY;
+  private static final String PREFIX = "hadoop.http.authentication.";
+  public static String getRouterUserName() {
+    return ROUTER_USER_NAME;
+  }
+
-    conf.set(DFS_WEB_AUTHENTICATION_KERBEROS_PRINCIPAL_KEY, spnegoPrincipal);
-    conf.set(DFS_WEB_AUTHENTICATION_KERBEROS_KEYTAB_KEY, keytab);
+    conf.set(PREFIX + "type", "kerberos");
+    conf.set(PREFIX + "kerberos.principal", spnegoPrincipal);
+    conf.set(PREFIX + "kerberos.keytab", keytab);
-    conf.set(DFS_ROUTER_KERBEROS_INTERNAL_SPNEGO_PRINCIPAL_KEY, "*");
+    conf.set(DFS_ROUTER_KERBEROS_INTERNAL_SPNEGO_PRINCIPAL_KEY,
+        spnegoPrincipal);
