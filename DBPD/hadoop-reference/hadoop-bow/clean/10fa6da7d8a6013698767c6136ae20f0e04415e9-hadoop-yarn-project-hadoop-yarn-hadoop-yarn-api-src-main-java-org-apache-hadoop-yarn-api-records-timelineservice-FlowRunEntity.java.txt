YARN-4074. [timeline reader] implement support for querying for flows and flow runs (sjlee via vrushali)

+import javax.xml.bind.annotation.XmlElement;
+
-import javax.xml.bind.annotation.XmlElement;
-
-public class FlowEntity extends HierarchicalTimelineEntity {
+public class FlowRunEntity extends HierarchicalTimelineEntity {
+  public static final String FLOW_RUN_END_TIME =
+      TimelineEntity.SYSTEM_INFO_KEY_PREFIX + "FLOW_RUN_END_TIME";
-  public FlowEntity() {
-    super(TimelineEntityType.YARN_FLOW.toString());
+  public FlowRunEntity() {
+    super(TimelineEntityType.YARN_FLOW_RUN.toString());
+    // set config to null
+    setConfigs(null);
-  public FlowEntity(TimelineEntity entity) {
+  public FlowRunEntity(TimelineEntity entity) {
-    if (!entity.getType().equals(TimelineEntityType.YARN_FLOW.toString())) {
+    if (!entity.getType().equals(TimelineEntityType.YARN_FLOW_RUN.toString())) {
+    // set config to null
+    setConfigs(null);
-    //Flow id schema: user@flow_name(or id)/version/run_id
+    //Flow id schema: user@flow_name(or id)/run_id
-      sb.append(getInfo().get(FLOW_VERSION_INFO_KEY).toString());
-      sb.append('/');
-    Object user = getInfo().get(USER_INFO_KEY);
-    return user == null ? null : user.toString();
+    return (String)getInfo().get(USER_INFO_KEY);
-    Object name = getInfo().get(FLOW_NAME_INFO_KEY);
-    return name == null ? null : name.toString();
+    return (String)getInfo().get(FLOW_NAME_INFO_KEY);
-    Object version = getInfo().get(FLOW_VERSION_INFO_KEY);
-    return version == null ? null : version.toString();
+    return (String)getInfo().get(FLOW_VERSION_INFO_KEY);
+
+  public long getStartTime() {
+    return getCreatedTime();
+  }
+
+  public void setStartTime(long startTime) {
+    setCreatedTime(startTime);
+  }
+
+  public long getMaxEndTime() {
+    Object time = getInfo().get(FLOW_RUN_END_TIME);
+    return time == null ? 0L : (Long)time;
+  }
+
+  public void setMaxEndTime(long endTime) {
+    addInfo(FLOW_RUN_END_TIME, endTime);
+  }
