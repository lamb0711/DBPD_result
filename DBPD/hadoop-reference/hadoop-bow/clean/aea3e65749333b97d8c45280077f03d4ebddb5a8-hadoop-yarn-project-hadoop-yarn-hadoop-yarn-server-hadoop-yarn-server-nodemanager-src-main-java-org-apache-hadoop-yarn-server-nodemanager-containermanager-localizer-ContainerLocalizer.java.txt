YARN-5137. Make DiskChecker pluggable in NodeManager. (Yufei Gu via rchiang)

-import org.apache.hadoop.util.DiskChecker;
+import org.apache.hadoop.util.DiskValidator;
+import org.apache.hadoop.util.DiskValidatorFactory;
-import org.apache.hadoop.yarn.util.ConverterUtils;
+  private final DiskValidator diskValidator;
-    this.conf = new Configuration();
+    this.conf = new YarnConfiguration();
+    this.diskValidator = DiskValidatorFactory.getInstance(
+        conf.get(YarnConfiguration.DISK_VALIDATOR));
+    LOG.info("Disk Validator: " + YarnConfiguration.DISK_VALIDATOR +
+        " is loaded.");
-    DiskChecker.checkDir(new File(path.toUri().getRawPath()));
+    diskValidator.checkStatus(new File(path.toUri().getRawPath()));
