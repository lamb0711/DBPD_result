HDFS-12982 : [SPS]: Reduce the locking and cleanup the Namesystem access. Contributed by Rakesh R.

-import org.apache.hadoop.hdfs.server.namenode.IntraNNSPSContext;
+import org.apache.hadoop.hdfs.server.namenode.sps.Context;
+import org.apache.hadoop.hdfs.server.namenode.sps.IntraSPSNameNodeContext;
+  private Context spsctxt = null;
-    StoragePolicySatisfier.Context spsctxt = new IntraNNSPSContext(namesystem);
-    sps = new StoragePolicySatisfier(namesystem, this, conf, spsctxt);
+    spsctxt = new IntraSPSNameNodeContext(namesystem, this, conf);
+    sps = new StoragePolicySatisfier(spsctxt);
-
-    sps.start(false);
+    // TODO: FSDirectory will get removed via HDFS-12911 modularization work
+    sps.start(false, namesystem.getFSDirectory());
-
-    sps.start(true);
+    // TODO: FSDirectory will get removed via HDFS-12911 modularization work
+    sps.start(true, namesystem.getFSDirectory());
