YARN-693. Modified RM to send NMTokens on allocate call so that AMs can then use them for authentication with NMs. Contributed by Omkar Vinit Joshi.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1493448 13f79535-47bb-0310-9956-ffa450edef68

+      // Adding NMTokens for allocated containers.
+      if (!allocation.getContainers().isEmpty()) {
+        allocateResponse.setNMTokens(rmContext.getNMTokenSecretManager()
+            .getNMTokens(app.getUser(), appAttemptId,
+                allocation.getContainers()));
+      }
-    LOG.info("Registering " + attemptId);
+    LOG.info("Registering app attempt : " + attemptId);
+    rmContext.getNMTokenSecretManager().registerApplicationAttempt(attemptId);
+    LOG.info("Unregistering app attempt : " + attemptId);
+    rmContext.getNMTokenSecretManager().unregisterApplicationAttempt(attemptId);
