HDFS-8167. BlockManager.addBlockCollectionWithCheck should check if the block is a striped block. Contributed by Hui Zheng.

-   * Set the value of whether there are any non-EC blocks using StripedID.
-   *
-   * @param has - the value of whether there are any non-EC blocks using StripedID.
-   */
-  public void hasNonEcBlockUsingStripedID(boolean has){
-    hasNonEcBlockUsingStripedID = has;
-  }
-
-  /**
-      if ((info == null) && hasNonEcBlockUsingStripedID()){
+      if ((info == null) && hasNonEcBlockUsingStripedID){
-    if (!hasNonEcBlockUsingStripedID()){
-      if (BlockIdManager.isStripedBlockID(block.getBlockId())) {
-        hasNonEcBlockUsingStripedID(true);
-      }
+    if (!hasNonEcBlockUsingStripedID && !block.isStriped() &&
+        BlockIdManager.isStripedBlockID(block.getBlockId())) {
+      hasNonEcBlockUsingStripedID = true;
