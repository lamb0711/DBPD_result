MAPREDUCE-7190. Add SleepJob additional parameter to make parallel runs distinguishable. Contributed by Adam Antal.

Signed-off-by: Wei-Chiu Chuang <weichiu@apache.org>

+  public static final String SLEEP_JOB_NAME = "Sleep job";
+
-  public Job createJob(int numMapper, int numReducer, 
+  public Job createJob(int numMapper, int numReducer,
+      long mapSleepTime, int mapSleepCount,
+      long reduceSleepTime, int reduceSleepCount) throws IOException {
+    return createJob(numMapper, numReducer, mapSleepTime, mapSleepCount,
+        reduceSleepTime, reduceSleepCount, SLEEP_JOB_NAME);
+  }
+
+  public Job createJob(int numMapper, int numReducer,
-                       long reduceSleepTime, int reduceSleepCount) 
+                       long reduceSleepTime, int reduceSleepCount,
+                       String name)
-    Job job = Job.getInstance(conf, "sleep");
+    Job job = Job.getInstance(conf);
-    job.setJobName("Sleep job");
+    if (SLEEP_JOB_NAME.equals(name)) {
+      job.setJobName(SLEEP_JOB_NAME);
+    } else {
+      job.setJobName(SLEEP_JOB_NAME + " - " + name);
+    }
+    String name = SLEEP_JOB_NAME;
+      } else if (args[i].equals("-name")) {
+        name = args[++i];
-                mapSleepCount, reduceSleepTime, reduceSleepCount);
+        mapSleepCount, reduceSleepTime, reduceSleepCount, name);
-        " [-recordt recordSleepTime (msec)]");
+        " [-recordt recordSleepTime (msec)] [-name]");
