Additional check when unpacking archives. Contributed by Wilfred Spiegelenburg.

+      String targetDirPath = toDir.getCanonicalPath() + File.separator;
+          if (!file.getCanonicalPath().startsWith(targetDirPath)) {
+            throw new IOException("expanding " + entry.getName()
+                + " would create file outside of " + toDir);
+          }
+      String targetDirPath = toDir.getCanonicalPath() + File.separator;
+            if (!file.getCanonicalPath().startsWith(targetDirPath)) {
+              throw new IOException("expanding " + entry.getName()
+                  + " would create file outside of " + toDir);
+            }
