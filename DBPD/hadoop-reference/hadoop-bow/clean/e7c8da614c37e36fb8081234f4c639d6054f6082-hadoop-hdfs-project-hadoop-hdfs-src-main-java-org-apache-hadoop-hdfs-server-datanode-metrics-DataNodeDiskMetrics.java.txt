HDFS-11545. Propagate DataNode's slow disks info to the NameNode via Heartbeats. Contributed by Hanisha Koneru.

+import org.apache.hadoop.hdfs.server.protocol.SlowDiskReports.DiskOp;
-  private volatile Map<String, Map<DiskOutlierDetectionOp, Double>>
+  private volatile Map<String, Map<DiskOp, Double>>
-    Map<String, Map<DiskOutlierDetectionOp, Double>> diskStats =
+    Map<String, Map<DiskOp, Double>> diskStats =
-      Map<DiskOutlierDetectionOp, Double> diskStat = Maps.newHashMap();
-      diskStat.put(DiskOutlierDetectionOp.METADATA, metadataOpStats.get(disk));
-      diskStat.put(DiskOutlierDetectionOp.READ, readIoStats.get(disk));
-      diskStat.put(DiskOutlierDetectionOp.WRITE, writeIoStats.get(disk));
+      Map<DiskOp, Double> diskStat = Maps.newHashMap();
+      diskStat.put(DiskOp.METADATA, metadataOpStats.get(disk));
+      diskStat.put(DiskOp.READ, readIoStats.get(disk));
+      diskStat.put(DiskOp.WRITE, writeIoStats.get(disk));
-  /**
-   * Lists the types of operations on which disk latencies are measured.
-   */
-  public enum DiskOutlierDetectionOp {
-    METADATA,
-    READ,
-    WRITE
-  }
-
-  public Map<String,
-      Map<DiskOutlierDetectionOp, Double>> getDiskOutliersStats() {
+  public Map<String, Map<DiskOp, Double>> getDiskOutliersStats() {
-  public void addSlowDiskForTesting(String slowDiskPath) {
-    diskOutliersStats.put(slowDiskPath, ImmutableMap.of());
+  public void addSlowDiskForTesting(String slowDiskPath,
+      Map<DiskOp, Double> latencies) {
+    if (latencies == null) {
+      diskOutliersStats.put(slowDiskPath, ImmutableMap.of());
+    } else {
+      diskOutliersStats.put(slowDiskPath, latencies);
+    }
