Merge remote-tracking branch 'apache/trunk' into HDFS-7285

+  private volatile Priority maxClusterLevelAppPriority;
+
+    maxClusterLevelAppPriority = getMaxPriorityFromConf(conf);
+
+  public Priority getMaxClusterLevelAppPriority() {
+    return maxClusterLevelAppPriority;
+  }
+
+  private Priority getMaxPriorityFromConf(Configuration conf) {
+    return Priority.newInstance(conf.getInt(
+        YarnConfiguration.MAX_CLUSTER_LEVEL_APPLICATION_PRIORITY,
+        YarnConfiguration.DEFAULT_CLUSTER_LEVEL_APPLICATION_PRIORITY));
+  }
+
+  @Override
+  public synchronized void setClusterMaxPriority(Configuration conf)
+      throws YarnException {
+    try {
+      maxClusterLevelAppPriority = getMaxPriorityFromConf(conf);
+    } catch (NumberFormatException e) {
+      throw new YarnException(e);
+    }
+    LOG.info("Updated the cluste max priority to maxClusterLevelAppPriority = "
+        + maxClusterLevelAppPriority);
+  }
