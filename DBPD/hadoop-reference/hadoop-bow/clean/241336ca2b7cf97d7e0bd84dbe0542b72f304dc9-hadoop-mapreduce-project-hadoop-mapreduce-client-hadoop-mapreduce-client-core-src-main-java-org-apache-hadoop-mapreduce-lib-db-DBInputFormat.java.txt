MAPREDUCE-6237. Multiple mappers with DBInputFormat don't work because of reusing conections. Contributed by Kannan Rajah.

-      getConnection();
+      this.connection = createConnection();
+    // TODO Remove this code that handles backward compatibility.
+    if (this.connection == null) {
+      this.connection = createConnection();
+    }
+
+    return this.connection;
+  }
+
+  public Connection createConnection() {
-      if (null == this.connection) {
-        // The connection was closed; reinstantiate it.
-        this.connection = dbConf.getConnection();
-        this.connection.setAutoCommit(false);
-        this.connection.setTransactionIsolation(
-            Connection.TRANSACTION_SERIALIZABLE);
-      }
+      Connection newConnection = dbConf.getConnection();
+      newConnection.setAutoCommit(false);
+      newConnection.setTransactionIsolation(
+          Connection.TRANSACTION_SERIALIZABLE);
+
+      return newConnection;
-    return connection;
-            conf, getConnection(), getDBConf(), conditions, fieldNames,
+            conf, createConnection(), getDBConf(), conditions, fieldNames,
-            conf, getConnection(), getDBConf(), conditions, fieldNames,
+            conf, createConnection(), getDBConf(), conditions, fieldNames,
-            conf, getConnection(), getDBConf(), conditions, fieldNames,
+            conf, createConnection(), getDBConf(), conditions, fieldNames,
