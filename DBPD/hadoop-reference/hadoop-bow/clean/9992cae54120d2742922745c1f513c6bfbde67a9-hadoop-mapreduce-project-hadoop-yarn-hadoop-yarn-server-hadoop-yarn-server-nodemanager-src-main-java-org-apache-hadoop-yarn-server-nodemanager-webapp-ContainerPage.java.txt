Reverting the previous trunk merge since it added other unintended changes in addition


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1177127 13f79535-47bb-0310-9956-ffa450edef68

-import static org.apache.hadoop.yarn.util.StringHelper.ujoin;
+import static org.apache.hadoop.yarn.util.StringHelper.ujoin;
-import java.io.IOException;
-
+import org.apache.hadoop.conf.Configuration;
+import org.apache.hadoop.yarn.factories.RecordFactory;
+import org.apache.hadoop.yarn.factory.providers.RecordFactoryProvider;
-import org.apache.hadoop.yarn.webapp.hamlet.Hamlet;
-import org.apache.hadoop.yarn.webapp.hamlet.Hamlet.DIV;
+    private final Configuration conf;
+    private final RecordFactory recordFactory;
-    public ContainerBlock(Context nmContext) {
+    public ContainerBlock(Configuration conf, Context nmContext) {
+      this.conf = conf;
+      this.recordFactory = RecordFactoryProvider.getRecordFactory(this.conf);
-      ContainerId containerID;
-      try {
-        containerID = ConverterUtils.toContainerId($(CONTAINER_ID));
-      } catch (IOException e) {
-        html.p()._("Invalid containerId " + $(CONTAINER_ID))._();
-        return;
-      }
-
-      DIV<Hamlet> div = html.div("#content");
+      ContainerId containerID =
+        ConverterUtils.toContainerId(this.recordFactory, $(CONTAINER_ID));
-      if (container == null) {
-        div.h1("Unknown Container. Container might have completed, "
-                + "please go back to the previous page and retry.")._();
-        return;
-      }
