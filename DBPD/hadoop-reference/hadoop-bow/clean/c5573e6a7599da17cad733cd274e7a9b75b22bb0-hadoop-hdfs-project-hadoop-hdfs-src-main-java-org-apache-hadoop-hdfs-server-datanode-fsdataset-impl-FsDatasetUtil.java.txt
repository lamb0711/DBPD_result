HDFS-11009. Add a tool to reconstruct block meta file from CLI.

+import java.io.InputStream;
+import java.net.URI;
+import com.google.common.base.Preconditions;
+import org.apache.hadoop.conf.Configuration;
+import org.apache.hadoop.hdfs.server.datanode.FinalizedReplica;
+import org.apache.hadoop.hdfs.server.datanode.ReplicaInfo;
+
+  /**
+   * Compute the checksum for a block file that does not already have
+   * its checksum computed, and save it to dstMeta file.
+   */
+  public static void computeChecksum(File srcMeta, File dstMeta, File blockFile,
+      int smallBufferSize, Configuration conf) throws IOException {
+    Preconditions.checkNotNull(srcMeta);
+    Preconditions.checkNotNull(dstMeta);
+    Preconditions.checkNotNull(blockFile);
+    // Create a dummy ReplicaInfo object pointing to the blockFile.
+    ReplicaInfo wrapper = new FinalizedReplica(0, 0, 0, null, null) {
+      @Override
+      public URI getMetadataURI() {
+        return srcMeta.toURI();
+      }
+
+      @Override
+      public InputStream getDataInputStream(long seekOffset)
+          throws IOException {
+        return new FileInputStream(blockFile);
+      }
+    };
+
+    FsDatasetImpl.computeChecksum(wrapper, dstMeta, smallBufferSize, conf);
+  }
