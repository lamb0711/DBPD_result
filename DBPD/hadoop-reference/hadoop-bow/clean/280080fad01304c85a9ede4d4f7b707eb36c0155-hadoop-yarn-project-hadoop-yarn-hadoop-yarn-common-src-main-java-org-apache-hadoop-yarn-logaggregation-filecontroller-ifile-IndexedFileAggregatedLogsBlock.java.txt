YARN-7259. Add size-based rolling policy to LogAggregationIndexedFileController. (xgong via wangda)

Change-Id: Ifaf82c0aee6b73b9b6ebf103aa72e131e3942f31

-    Map<String, FileStatus> checkSumFiles;
+    Map<String, Long> checkSumFiles;
-      checkSumFiles = fileController.filterFiles(nodeFiles,
-          LogAggregationIndexedFileController.CHECK_SUM_FILE_SUFFIX);
+      checkSumFiles = fileController.parseCheckSumFiles(nodeFiles);
-        FileStatus checkSum = fileController.getAllChecksumFiles(
-            checkSumFiles, thisNodeFile.getPath().getName());
+        Long checkSumIndex = checkSumFiles.get(
+            thisNodeFile.getPath().getName());
-        if (checkSum != null) {
-          endIndex = fileController.loadIndexedLogsCheckSum(
-             checkSum.getPath());
+        if (checkSumIndex != null) {
+          endIndex = checkSumIndex.longValue();
