HDFS-6702. Change DFSClient to pass the StorageType from the namenode to datanodes and change datanode to write block replicas using the specified storage type.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1612493 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.hdfs.protocol.DatanodeInfo;
+    final DatanodeInfo[] targets = PBHelper.convert(proto.getTargetsList());
+        PBHelper.convertStorageType(proto.getStorageType()),
-        PBHelper.convert(proto.getTargetsList()),
+        targets,
+        PBHelper.convertStorageTypes(proto.getTargetStorageTypesList(), targets.length),
+    final DatanodeInfo[] targets = PBHelper.convert(proto.getTargetsList());
-        PBHelper.convert(proto.getTargetsList()));
+        targets,
+        PBHelper.convertStorageTypes(proto.getTargetStorageTypesList(), targets.length));
+        PBHelper.convertStorageType(proto.getStorageType()),
