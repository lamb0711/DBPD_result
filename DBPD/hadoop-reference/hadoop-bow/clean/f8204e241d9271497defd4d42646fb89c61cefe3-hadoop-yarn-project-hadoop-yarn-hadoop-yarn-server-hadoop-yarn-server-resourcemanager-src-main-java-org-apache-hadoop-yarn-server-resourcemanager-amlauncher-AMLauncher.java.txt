YARN-2893. AMLaucher: sporadic job failures due to EOFException in readTokenStorageStream. (Zhihai Xu via gera)

+import org.apache.hadoop.classification.InterfaceAudience.Private;
-  private void setupTokens(
+  @Private
+  @VisibleForTesting
+  protected void setupTokens(
-    if (container.getTokens() != null) {
+    ByteBuffer tokens = container.getTokens();
+    if (tokens != null) {
-      dibb.reset(container.getTokens());
+      dibb.reset(tokens);
+      tokens.rewind();
