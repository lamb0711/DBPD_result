HADOOP-6591. HarFileSystem can handle paths with the whitespace characters.
(Rodrigo Schmidt via dhruba)



git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@923619 13f79535-47bb-0310-9956-ffa450edef68

+import java.io.UnsupportedEncodingException;
+import java.net.URLDecoder;
-  public static final int VERSION = 1;
+  public static final int VERSION = 2;
-    if (this.version != HarFileSystem.VERSION) {
+    // make it always backwards-compatible
+    if (this.version > HarFileSystem.VERSION) {
+  private String decodeFileName(String fname) 
+    throws UnsupportedEncodingException {
+    
+    if (version == 2){
+      return URLDecoder.decode(fname, "UTF-8");
+    }
+    return fname;
+  }
+  
+        parsed[0] = decodeFileName(parsed[0]);
-  private static class HarStatus {
+  private class HarStatus {
-    public HarStatus(String harString) {
+    public HarStatus(String harString) throws UnsupportedEncodingException {
-      this.name = splits[0];
+      this.name = decodeFileName(splits[0]);
-          children.add(splits[i]);
+          children.add(decodeFileName(splits[i]));
