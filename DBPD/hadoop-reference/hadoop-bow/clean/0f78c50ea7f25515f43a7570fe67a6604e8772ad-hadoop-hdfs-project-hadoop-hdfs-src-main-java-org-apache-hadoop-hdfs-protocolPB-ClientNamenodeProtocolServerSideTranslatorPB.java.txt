HDFS-4692. Use timestamp as default snapshot names.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1467706 13f79535-47bb-0310-9956-ffa450edef68

-  static final CreateSnapshotResponseProto VOID_CREATE_SNAPSHOT_RESPONSE =
-      CreateSnapshotResponseProto.newBuilder().build();
-      CreateSnapshotRequestProto request) throws ServiceException {
+      CreateSnapshotRequestProto req) throws ServiceException {
-      server.createSnapshot(request.getSnapshotRoot(),
-          request.getSnapshotName());
+      final CreateSnapshotResponseProto.Builder builder
+          = CreateSnapshotResponseProto.newBuilder();
+      final String snapshotPath = server.createSnapshot(req.getSnapshotRoot(),
+          req.hasSnapshotName()? req.getSnapshotName(): null);
+      if (snapshotPath != null) {
+        builder.setSnapshotPath(snapshotPath);
+      }
+      return builder.build();
-    return VOID_CREATE_SNAPSHOT_RESPONSE;
-      DeleteSnapshotRequestProto request) throws ServiceException {
+      DeleteSnapshotRequestProto req) throws ServiceException {
-      server
-          .deleteSnapshot(request.getSnapshotRoot(), request.getSnapshotName());
+      server.deleteSnapshot(req.getSnapshotRoot(), req.getSnapshotName());
