HDFS-5378. In CacheReport, don't send genstamp and length on the wire (Contributed by Colin Patrick McCabe)

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-4949@1534334 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.hadoop.hdfs.server.protocol.CacheReport;
-      StorageReport[] report, CacheReport[] cacheReport, int xmitsInProgress,
-      int xceiverCount, int failedVolumes) throws IOException {
+      StorageReport[] report, long dnCacheCapacity, long dnCacheUsed,
+      int xmitsInProgress, int xceiverCount,
+      int failedVolumes) throws IOException {
-        report[0].getBlockPoolUsed(), cacheReport[0].getCapacity(),
-        cacheReport[0].getUsed(), xceiverCount, xmitsInProgress, failedVolumes);
+        report[0].getBlockPoolUsed(), dnCacheCapacity, dnCacheUsed,
+        xceiverCount, xmitsInProgress, failedVolumes);
-      String poolId, long[] blocks) throws IOException {
+      String poolId, List<Long> blockIds) throws IOException {
-    BlockListAsLongs blist = new BlockListAsLongs(blocks);
-           + "from " + nodeReg + " " + blist.getNumberOfBlocks()
-           + " blocks");
+           + "from " + nodeReg + " " + blockIds.size() + " blocks");
-    namesystem.getCacheManager().processCacheReport(nodeReg, blist);
+    namesystem.getCacheManager().processCacheReport(nodeReg, blockIds);
