YARN-4711. NM is going down with NPE's due to single thread processing of events by Timeline client (Naganarasimha G R via sjlee)

-      } catch (Exception e) {
-        // TODO only handle exception for timelineServiceAddress being updated.
-        // skip retry for other exceptions.
+      } catch (IOException e) {
+        // handle exception for timelineServiceAddress being updated.
-  private void checkRetryWithSleep(int retries, Exception e) throws
-      YarnException, IOException {
+  private void checkRetryWithSleep(int retries, IOException e)
+      throws YarnException, IOException {
+        throw new YarnException("Interrupted while retrying to connect to ATS");
-      LOG.error("TimelineClient has reached to max retry times :" +
-          this.maxServiceRetries + " for service address: " +
-          timelineServiceAddress);
-      if (e instanceof YarnException) {
-        throw (YarnException)e;
-      } else if (e instanceof IOException) {
-        throw (IOException)e;
-      } else {
-        throw new YarnException(e);
-      }
+      StringBuilder msg =
+          new StringBuilder("TimelineClient has reached to max retry times : ");
+      msg.append(this.maxServiceRetries);
+      msg.append(" for service address: ");
+      msg.append(timelineServiceAddress);
+      LOG.error(msg.toString());
+      throw new IOException(msg.toString(), e);
-  private void putObjects(
+  protected void putObjects(
+   *
+   * @throws IOException
-  private int pollTimelineServiceAddress(int retries) {
+  private int pollTimelineServiceAddress(int retries) throws YarnException {
+        throw new YarnException("Interrupted while trying to connect ATS");
-      // timelineServiceAddress = getTimelineServiceAddress();
