HDFS-2752. HA: exit if multiple shared dirs are configured. Contributed by Eli Collins


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1240916 13f79535-47bb-0310-9956-ffa450edef68

+   * @return Collection of shared edits directories.
+   * @throws IOException if multiple shared edits directories are configured
-  public static List<URI> getNamespaceEditsDirs(Configuration conf) {
+  public static List<URI> getNamespaceEditsDirs(Configuration conf)
+      throws IOException {
+    List<URI> sharedDirs = getSharedEditsDirs(conf);
+
+    // Fail until multiple shared edits directories are supported (HDFS-2782)
+    if (sharedDirs.size() > 1) {
+      throw new IOException(
+          "Multiple shared edits directories are not yet supported");
+    }
+
-    for (URI dir : getSharedEditsDirs(conf)) {
+    for (URI dir : sharedDirs) {
