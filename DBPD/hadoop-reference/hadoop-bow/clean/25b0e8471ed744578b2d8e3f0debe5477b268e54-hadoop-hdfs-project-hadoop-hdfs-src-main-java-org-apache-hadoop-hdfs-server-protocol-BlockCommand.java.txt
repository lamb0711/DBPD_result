HDFS-6702. Change DFSClient to pass the StorageType from the namenode to datanodes and change datanode to write block replicas using the specified storage type.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1612493 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.hdfs.StorageType;
+  final StorageType[][] targetStorageTypes;
+    targetStorageTypes = new StorageType[blocks.length][];
+      targetStorageTypes[i] = DatanodeStorageInfo.toStorageTypes(p.targets);
+  private static final StorageType[][] EMPTY_TARGET_STORAGE_TYPES = {};
-        EMPTY_TARGET_STORAGEIDS);
+        EMPTY_TARGET_STORAGE_TYPES, EMPTY_TARGET_STORAGEIDS);
-      DatanodeInfo[][] targets, String[][] targetStorageIDs) {
+      DatanodeInfo[][] targets, StorageType[][] targetStorageTypes,
+      String[][] targetStorageIDs) {
+    this.targetStorageTypes = targetStorageTypes;
+  public StorageType[][] getTargetStorageTypes() {
+    return targetStorageTypes;
+  }
+
