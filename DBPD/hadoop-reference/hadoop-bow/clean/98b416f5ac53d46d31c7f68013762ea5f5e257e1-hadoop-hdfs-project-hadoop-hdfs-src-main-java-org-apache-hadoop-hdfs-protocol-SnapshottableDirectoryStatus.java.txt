HDFS-4801. lsSnapshottableDir throws IllegalArgumentException when root is snapshottable.  Contributed by Jing Zhao


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1479709 13f79535-47bb-0310-9956-ffa450edef68

-    String parentFullPathStr = (parentFullPath == null || parentFullPath.length == 0) ? null
-        : DFSUtil.bytes2String(parentFullPath);
-    return parentFullPathStr == null ? new Path(dirStatus.getLocalName())
-        : new Path(parentFullPathStr, dirStatus.getLocalName());
+    String parentFullPathStr = 
+        (parentFullPath == null || parentFullPath.length == 0) ? 
+            null : DFSUtil.bytes2String(parentFullPath);
+    if (parentFullPathStr == null
+        && dirStatus.getLocalNameInBytes().length == 0) {
+      // root
+      return new Path("/");
+    } else {
+      return parentFullPathStr == null ? new Path(dirStatus.getLocalName())
+          : new Path(parentFullPathStr, dirStatus.getLocalName());
+    }
