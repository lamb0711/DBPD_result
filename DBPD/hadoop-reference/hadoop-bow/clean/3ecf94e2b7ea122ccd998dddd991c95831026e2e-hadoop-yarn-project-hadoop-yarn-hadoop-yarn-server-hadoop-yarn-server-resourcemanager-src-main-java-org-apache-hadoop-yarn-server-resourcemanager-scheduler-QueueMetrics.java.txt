Merge r1480440 through r1480820 from trunk.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1480824 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.yarn.util.BuilderUtils;
+  @Metric("Allocated CPU in virtual cores") MutableGaugeInt allocatedVCores;
+  @Metric("Available CPU in virtual cores") MutableGaugeInt availableVCores;
+  @Metric("Pending CPU allocation in virtual cores") MutableGaugeInt pendingVCores;
+  @Metric("Reserved CPU in virtual cores") MutableGaugeInt reservedVCores;
+    availableVCores.set(limit.getVirtualCores());
+    pendingVCores.incr(res.getVirtualCores());
+    pendingVCores.decr(res.getVirtualCores());
+    allocatedVCores.incr(res.getVirtualCores() * containers);
+    allocatedVCores.decr(res.getVirtualCores() * containers);
+    reservedVCores.incr(res.getVirtualCores());
+    reservedVCores.decr(res.getVirtualCores());
+  
+  public Resource getAllocatedResources() {
+    return BuilderUtils.newResource(allocatedMB.value(), 0);
+  }
+  
+  public int getAllocatedVirtualCores() {
+    return allocatedVCores.value();
+  }
+  
+  public int getAvailableVirtualCores() {
+    return availableVCores.value();
+  }
+  
+  public int getPendingVirtualCores() {
+    return pendingVCores.value();
+  }
+  
+  public int getReservedVirtualCores() {
+    return reservedVCores.value();
+  }
