HDDS-2174. Delete GDPR Encryption Key from metadata when a Key is deleted

Signed-off-by: Anu Engineer <aengineer@apache.org>

+import org.apache.hadoop.ozone.OmUtils;
-      //Check if key with same keyName exists in deletedTable and then
-      // insert/update accordingly.
-      if(repeatedOmKeyInfo == null) {
-        repeatedOmKeyInfo = new RepeatedOmKeyInfo(keyInfo);
-      } else {
-        repeatedOmKeyInfo.addOmKeyInfo(keyInfo);
-      }
+      repeatedOmKeyInfo = OmUtils.prepareKeyForDelete(keyInfo,
+          repeatedOmKeyInfo);
-        if(repeatedOmKeyInfo == null) {
-          repeatedOmKeyInfo = new RepeatedOmKeyInfo(keyInfo);
-        } else {
-          repeatedOmKeyInfo.addOmKeyInfo(keyInfo);
-        }
+        repeatedOmKeyInfo = OmUtils.prepareKeyForDelete(
+            keyInfo, repeatedOmKeyInfo);
-            RepeatedOmKeyInfo repeatedOmKeyInfo = metadataManager.
-                getDeletedTable().get(oldPartKeyInfo.getPartName());
-            if(repeatedOmKeyInfo == null) {
-              repeatedOmKeyInfo = new RepeatedOmKeyInfo(
-                  OmKeyInfo.getFromProtobuf(oldPartKeyInfo.getPartKeyInfo()));
-            } else {
-              repeatedOmKeyInfo.addOmKeyInfo(
-                  OmKeyInfo.getFromProtobuf(oldPartKeyInfo.getPartKeyInfo()));
-            }
+            OmKeyInfo partKey = OmKeyInfo.getFromProtobuf(
+                oldPartKeyInfo.getPartKeyInfo());
+
+            RepeatedOmKeyInfo repeatedOmKeyInfo =
+                metadataManager.getDeletedTable()
+                    .get(oldPartKeyInfo.getPartName());
+
+            repeatedOmKeyInfo = OmUtils.prepareKeyForDelete(
+                partKey, repeatedOmKeyInfo);
+
-            RepeatedOmKeyInfo repeatedOmKeyInfo = metadataManager.
-                getDeletedTable().get(partKeyInfo.getPartName());
-            if(repeatedOmKeyInfo == null) {
-              repeatedOmKeyInfo = new RepeatedOmKeyInfo(currentKeyPartInfo);
-            } else {
-              repeatedOmKeyInfo.addOmKeyInfo(currentKeyPartInfo);
-            }
+            RepeatedOmKeyInfo repeatedOmKeyInfo =
+                metadataManager.getDeletedTable()
+                    .get(partKeyInfo.getPartName());
+
+            repeatedOmKeyInfo = OmUtils.prepareKeyForDelete(
+                currentKeyPartInfo, repeatedOmKeyInfo);
