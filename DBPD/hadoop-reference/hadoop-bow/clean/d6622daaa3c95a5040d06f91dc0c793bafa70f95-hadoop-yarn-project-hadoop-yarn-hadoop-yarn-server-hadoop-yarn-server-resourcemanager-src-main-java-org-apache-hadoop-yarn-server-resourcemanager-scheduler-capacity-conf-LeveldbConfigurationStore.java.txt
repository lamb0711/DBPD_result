YARN-7046. Add closing logic to configuration store

+import com.google.common.annotations.VisibleForTesting;
-  private static final Version CURRENT_VERSION_INFO = Version
+  @VisibleForTesting
+  protected static final Version CURRENT_VERSION_INFO = Version
-      this.db = initDatabase(schedConf);
+      initDatabase(schedConf);
-  private DB initDatabase(Configuration config) throws Exception {
+  private void initDatabase(Configuration config) throws Exception {
-          return -1;
+          return 1;
-          return 1;
-        } else if (key1Str.equals(LOG_KEY)) {
-        } else if (key2Str.equals(LOG_KEY)) {
+        } else if (key1Str.equals(LOG_KEY)) {
+        } else if (key2Str.equals(LOG_KEY)) {
+          return -1;
-    return db;
+  public void close() throws IOException {
+    if (db != null) {
+      db.close();
+    }
+  }
+
+  @Override
+
+    if (mutations == null) {
+      return new LinkedList<>();
+    }
-    itr.seek(bytes(LOG_KEY));
+    itr.seekToFirst();
-    itr.next();
-      config.set(new String(entry.getKey(), StandardCharsets.UTF_8),
-          new String(entry.getValue(), StandardCharsets.UTF_8));
+      String key = new String(entry.getKey(), StandardCharsets.UTF_8);
+      String value = new String(entry.getValue(), StandardCharsets.UTF_8);
+      if (key.equals(LOG_KEY) || key.equals(VERSION_KEY)) {
+        break;
+      }
+      config.set(key, value);
+  @VisibleForTesting
+  protected LinkedList<LogMutation> getLogs() throws Exception {
+    return deserLogMutations(db.get(bytes(LOG_KEY)));
+  }
+
