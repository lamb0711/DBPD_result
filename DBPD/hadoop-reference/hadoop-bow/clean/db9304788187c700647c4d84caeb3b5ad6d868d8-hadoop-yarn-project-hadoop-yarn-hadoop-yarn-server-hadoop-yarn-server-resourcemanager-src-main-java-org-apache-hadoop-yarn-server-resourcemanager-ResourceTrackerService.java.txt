YARN-3964. Support NodeLabelsProvider at Resource Manager side.
Contributed by Dian Fu.

-import java.util.HashSet;
-import org.apache.hadoop.yarn.api.records.NodeLabel;
+import org.apache.hadoop.yarn.server.resourcemanager.nodelabels.NodeLabelsUtils;
+  private boolean isDelegatedCentralizedNodeLabelsConf;
+    isDelegatedCentralizedNodeLabelsConf = YarnConfiguration
+        .isDelegatedCentralizedNodeLabelConfiguration(conf);
-  static Set<String> convertToStringSet(Set<NodeLabel> nodeLabels) {
-    if (null == nodeLabels) {
-      return null;
-    }
-    Set<String> labels = new HashSet<String>();
-    for (NodeLabel label : nodeLabels) {
-      labels.add(label.getName());
-    }
-    return labels;
-  }
-
-    Set<String> nodeLabels = convertToStringSet(request.getNodeLabels());
+    Set<String> nodeLabels = NodeLabelsUtils.convertToStringSet(
+        request.getNodeLabels());
+    } else if (isDelegatedCentralizedNodeLabelsConf) {
+      this.rmContext.getRMDelegatedNodeLabelsUpdater().updateNodeLabels(nodeId);
-            convertToStringSet(request.getNodeLabels()), nodeId);
+            NodeLabelsUtils.convertToStringSet(request.getNodeLabels()),
+            nodeId);
