HDDS-624.PutBlock fails with Unexpected Storage Container Exception.
Contributed by  Arpit Agarwal.

+import org.apache.hadoop.hdds.conf.OzoneConfiguration;
+import java.util.Optional;
+import java.util.function.Supplier;
-  private Configuration conf;
+  private Optional<Configuration> optionalConf = Optional.empty();
-    this.conf = configuration;
+    this.optionalConf = Optional.of(configuration);
-    MetadataStore store = null;
+    final Configuration conf = optionalConf.orElseGet(
+        () -> new OzoneConfiguration());
-      dbType = conf == null ?
-          OzoneConfigKeys.OZONE_METADATA_STORE_IMPL_DEFAULT :
-          conf.getTrimmed(OzoneConfigKeys.OZONE_METADATA_STORE_IMPL,
+      dbType = conf.getTrimmed(OzoneConfigKeys.OZONE_METADATA_STORE_IMPL,
-      store = new LevelDBStore(dbFile, options);
+      return new LevelDBStore(dbFile, options);
-      String rocksDbStat = conf == null ?
-          OZONE_METADATA_STORE_ROCKSDB_STATISTICS_DEFAULT :
-          conf.getTrimmed(OZONE_METADATA_STORE_ROCKSDB_STATISTICS,
-              OZONE_METADATA_STORE_ROCKSDB_STATISTICS_DEFAULT);
+      String rocksDbStat = conf.getTrimmed(
+          OZONE_METADATA_STORE_ROCKSDB_STATISTICS,
+          OZONE_METADATA_STORE_ROCKSDB_STATISTICS_DEFAULT);
-      store = new RocksDBStore(dbFile, opts);
-    } else {
-      throw new IllegalArgumentException("Invalid argument for "
-          + OzoneConfigKeys.OZONE_METADATA_STORE_IMPL
-          + ". Expecting " + OZONE_METADATA_STORE_IMPL_LEVELDB
-          + " or " + OZONE_METADATA_STORE_IMPL_ROCKSDB
-          + ", but met " + dbType);
+      return new RocksDBStore(dbFile, opts);
-    return store;
+    
+    throw new IllegalArgumentException("Invalid argument for "
+        + OzoneConfigKeys.OZONE_METADATA_STORE_IMPL
+        + ". Expecting " + OZONE_METADATA_STORE_IMPL_LEVELDB
+        + " or " + OZONE_METADATA_STORE_IMPL_ROCKSDB
+        + ", but met " + dbType);
