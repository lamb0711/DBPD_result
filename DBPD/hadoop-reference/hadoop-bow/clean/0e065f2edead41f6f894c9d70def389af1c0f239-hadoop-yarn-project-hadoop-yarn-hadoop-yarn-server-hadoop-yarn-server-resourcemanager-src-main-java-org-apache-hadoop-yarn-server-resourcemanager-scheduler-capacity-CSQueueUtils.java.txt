YARN-6195. Export UsedCapacity and AbsoluteUsedCapacity to JMX. Contributed by Benson Qiu

-import java.util.HashSet;
-      final Resource totalPartitionResource, final Resource minimumAllocation,
-      ResourceUsage queueResourceUsage, QueueCapacities queueCapacities,
-      String nodePartition) {
+      final Resource totalPartitionResource, String nodePartition,
+      AbstractCSQueue childQueue) {
+    QueueCapacities queueCapacities = childQueue.getQueueCapacities();
+    CSQueueMetrics queueMetrics = childQueue.getMetrics();
+    ResourceUsage queueResourceUsage = childQueue.getQueueResourceUsage();
+    Resource minimumAllocation = childQueue.getMinimumAllocation();
+
+    // QueueMetrics does not support per-label capacities,
+    // so we report values only for the default partition.
+    if (nodePartition.equals(CommonNodeLabelsManager.NO_LABEL)) {
+      queueMetrics.setUsedCapacity(
+          queueCapacities.getUsedCapacity(RMNodeLabelsManager.NO_LABEL));
+      queueMetrics.setAbsoluteUsedCapacity(
+          queueCapacities.getAbsoluteUsedCapacity(
+              RMNodeLabelsManager.NO_LABEL));
+    }
-  
+
-      final ResourceCalculator rc, final Resource cluster, final Resource minimumAllocation,
-      final CSQueue childQueue, final RMNodeLabelsManager nlm, 
+      final ResourceCalculator rc, final Resource cluster,
+      final AbstractCSQueue childQueue, final RMNodeLabelsManager nlm,
-    
+
-            minimumAllocation, queueResourceUsage, queueCapacities, partition);
+            partition, childQueue);
-          minimumAllocation, queueResourceUsage, queueCapacities, nodePartition);
+          nodePartition, childQueue);
