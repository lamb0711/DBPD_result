HADOOP-14965. S3a input stream "normal" fadvise mode to be adaptive

-  private final S3AInputPolicy inputPolicy;
+  private S3AInputPolicy inputPolicy;
-    this.inputPolicy = inputPolicy;
+    setInputPolicy(inputPolicy);
+   * Set/update the input policy of the stream.
+   * This updates the stream statistics.
+   * @param inputPolicy new input policy.
+   */
+  private void setInputPolicy(S3AInputPolicy inputPolicy) {
+    this.inputPolicy = inputPolicy;
+    streamStatistics.inputPolicySet(inputPolicy.ordinal());
+  }
+
+  /**
-        " streamPosition={}, nextReadPosition={}",
-        uri, reason, targetPos, contentRangeFinish, length,  pos, nextReadPos);
+        " streamPosition={}, nextReadPosition={}, policy={}",
+        uri, reason, targetPos, contentRangeFinish, length,  pos, nextReadPos,
+        inputPolicy);
+      // if the stream is in "Normal" mode, switch to random IO at this
+      // point, as it is indicative of columnar format IO
+      if (inputPolicy.equals(S3AInputPolicy.Normal)) {
+        LOG.info("Switching to Random IO seek policy");
+        setInputPolicy(S3AInputPolicy.Random);
+      }
+        LOG.debug("Statistics of stream {}\n{}", key, streamStatistics);
+      // normal is considered sequential until a backwards seek switches
+      // it to 'Random'
