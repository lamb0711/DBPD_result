HDFS-11769. Ozone: KSM: Add createVolume API. Contributed by Mukul Kumar Singh.

+import com.google.common.annotations.VisibleForTesting;
-import org.apache.hadoop.ksm.helpers.VolumeArgs;
+import org.apache.hadoop.ksm.helpers.KsmVolumeArgs;
-import static org.apache.hadoop.ozone.ksm.KSMConfigKeys.OZONE_KSM_ADDRESS_KEY;
+import static org.apache.hadoop.ozone.ksm.KSMConfigKeys
+    .OZONE_KSM_ADDRESS_KEY;
-import static org.apache.hadoop.ozone.protocol.proto.KeySpaceManagerProtocolProtos
-    .KeyspaceManagerService.newReflectiveBlockingService;
+import static org.apache.hadoop.ozone.protocol.proto
+    .KeySpaceManagerProtocolProtos.KeyspaceManagerService
+    .newReflectiveBlockingService;
-  // TODO: Support JMX
+  private final VolumeManager volumeManager;
+  private final KSMMetrics metrics;
-
-    //TODO : Add call to register MXBean for JMX.
+    volumeManager = new VolumeManagerImpl(this, conf);
+    metrics = KSMMetrics.create();
+  public KSMMetrics getMetrics() {
+    return metrics;
+  }
+
+  /**
+   * Returns listening address of Key Space Manager RPC server.
+   *
+   * @return listen address of Key Space Manager RPC server
+   */
+  @VisibleForTesting
+  public InetSocketAddress getClientRpcAddress() {
+    return ksmRpcAddress;
+  }
+    volumeManager.start();
+   * Stop service.
+   */
+  public void stop() {
+    try {
+      ksmRpcServer.stop();
+      volumeManager.stop();
+    } catch (IOException e) {
+      LOG.info("Key Space Manager stop failed.", e);
+    }
+  }
+
+  /**
-      LOG.info("Interrupted during KeyspaceManager join.");
+      LOG.info("Interrupted during KeyspaceManager join.", e);
-  public void createVolume(VolumeArgs args) throws IOException {
-
+  public void createVolume(KsmVolumeArgs args) throws IOException {
+    metrics.incNumVolumeCreates();
+    volumeManager.createVolume(args);
-  public VolumeArgs getVolumeinfo(String volume) throws IOException {
+  public KsmVolumeArgs getVolumeInfo(String volume) throws IOException {
-  public List<VolumeArgs> listVolumeByUser(String userName, String prefix,
+  public List<KsmVolumeArgs> listVolumeByUser(String userName, String prefix,
-  public List<VolumeArgs> listAllVolumes(String prefix, String prevKey, long
+  public List<KsmVolumeArgs> listAllVolumes(String prefix, String prevKey, long
