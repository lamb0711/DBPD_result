HDFS-9734. Refactoring of checksum failure report related codes. Contributed by Kai Zheng.

Change-Id: Ie69a77e3498a360959f8e213c51fb2b17c28b64a

+import org.apache.hadoop.hdfs.DFSUtilClient.CorruptedBlocks;
-  private void readOneStripe(
-      Map<ExtendedBlock, Set<DatanodeInfo>> corruptedBlockMap)
+  private void readOneStripe(CorruptedBlocks corruptedBlocks)
-          blks, blockReaders, corruptedBlockMap);
+          blks, blockReaders, corruptedBlocks);
-      final Map<ExtendedBlock, Set<DatanodeInfo>> corruptedBlockMap) {
+      final CorruptedBlocks corruptedBlocks) {
-              corruptedBlockMap);
+              corruptedBlocks);
-      Map<ExtendedBlock, Set<DatanodeInfo>> corruptedBlockMap)
+      CorruptedBlocks corruptedBlocks)
-      addIntoCorruptedBlockMap(currentBlock, currentNode,
-          corruptedBlockMap);
+      corruptedBlocks.addCorruptedBlock(currentBlock, currentNode);
-    Map<ExtendedBlock, Set<DatanodeInfo>> corruptedBlockMap =
-        new ConcurrentHashMap<>();
+
+    CorruptedBlocks corruptedBlocks = new CorruptedBlocks();
-            readOneStripe(corruptedBlockMap);
+            readOneStripe(corruptedBlocks);
-        reportCheckSumFailure(corruptedBlockMap,
+        reportCheckSumFailure(corruptedBlocks,
-      long end, byte[] buf, int offset,
-      Map<ExtendedBlock, Set<DatanodeInfo>> corruptedBlockMap)
+      long end, byte[] buf, int offset, CorruptedBlocks corruptedBlocks)
-            blks, preaderInfos, corruptedBlockMap);
+            blks, preaderInfos, corruptedBlocks);
-    final Map<ExtendedBlock, Set<DatanodeInfo>> corruptedBlockMap;
+    final CorruptedBlocks corruptedBlocks;
-        Map<ExtendedBlock, Set<DatanodeInfo>> corruptedBlockMap) {
+                 CorruptedBlocks corruptedBlocks) {
-      this.corruptedBlockMap = corruptedBlockMap;
+      this.corruptedBlocks = corruptedBlocks;
-          block.getBlock(), corruptedBlockMap);
+          block.getBlock(), corruptedBlocks);
-        BlockReaderInfo[] readerInfos,
-        Map<ExtendedBlock, Set<DatanodeInfo>> corruptedBlockMap) {
+        BlockReaderInfo[] readerInfos, CorruptedBlocks corruptedBlocks) {
-          corruptedBlockMap);
+          corruptedBlocks);
-        BlockReaderInfo[] readerInfos,
-        Map<ExtendedBlock, Set<DatanodeInfo>> corruptedBlockMap) {
+        BlockReaderInfo[] readerInfos, CorruptedBlocks corruptedBlocks) {
-          corruptedBlockMap);
+          corruptedBlocks);
