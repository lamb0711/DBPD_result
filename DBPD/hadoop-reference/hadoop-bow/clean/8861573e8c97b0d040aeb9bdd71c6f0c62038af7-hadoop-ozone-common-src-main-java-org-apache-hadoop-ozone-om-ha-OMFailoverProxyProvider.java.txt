HDDS-1717. MR Job fails as OMFailoverProxyProvider has dependency hadoop-3.2

Closes #1056

-import org.apache.hadoop.security.SecurityUtil;
-  private Map<String, OMProxyInfo> omProxies;
+  private Map<String, ProxyInfo<OzoneManagerProtocolPB>> omProxies;
+  private Map<String, OMProxyInfo> omProxyInfos;
-  /**
-   * Class to store proxy information.
-   */
-  public class OMProxyInfo
-      extends FailoverProxyProvider.ProxyInfo<OzoneManagerProtocolPB> {
-    private InetSocketAddress address;
-    private Text dtService;
-
-    OMProxyInfo(OzoneManagerProtocolPB proxy, String proxyInfoStr,
-        Text dtService,
-        InetSocketAddress addr) {
-      super(proxy, proxyInfoStr);
-      this.address = addr;
-      this.dtService = dtService;
-    }
-
-    public InetSocketAddress getAddress() {
-      return address;
-    }
-
-    public Text getDelegationTokenService() {
-      return dtService;
-    }
-  }
-
+    this.omProxyInfos = new HashMap<>();
-        InetSocketAddress addr = NetUtils.createSocketAddr(rpcAddrStr);
+        OMProxyInfo omProxyInfo = new OMProxyInfo(nodeId, rpcAddrStr);
-        // Add the OM client proxy info to list of proxies
-        if (addr != null) {
-          Text dtService = SecurityUtil.buildTokenService(addr);
-          StringBuilder proxyInfo = new StringBuilder()
-              .append(nodeId).append("(")
-              .append(NetUtils.getHostPortString(addr)).append(")");
-          OMProxyInfo omProxyInfo = new OMProxyInfo(null,
-              proxyInfo.toString(), dtService, addr);
+        if (omProxyInfo.getAddress() != null) {
+
+          ProxyInfo<OzoneManagerProtocolPB> proxyInfo =
+              new ProxyInfo(null, omProxyInfo.toString());
-          omProxies.put(nodeId, omProxyInfo);
+          omProxies.put(nodeId, proxyInfo);
+          omProxyInfos.put(nodeId, omProxyInfo);
-
-  public synchronized OMProxyInfo getProxy() {
-    OMProxyInfo currentOMProxyInfo = omProxies.get(currentProxyOMNodeId);
-    createOMProxyIfNeeded(currentOMProxyInfo);
-    return currentOMProxyInfo;
+  public synchronized ProxyInfo getProxy() {
+    ProxyInfo currentProxyInfo = omProxies.get(currentProxyOMNodeId);
+    createOMProxyIfNeeded(currentProxyInfo, currentProxyOMNodeId);
+    return currentProxyInfo;
-   * Creates OM proxy object if it does not already exist.
+   * Creates proxy object if it does not already exist.
-  private OMProxyInfo createOMProxyIfNeeded(OMProxyInfo proxyInfo) {
+  private void createOMProxyIfNeeded(ProxyInfo proxyInfo,
+      String nodeId) {
+      InetSocketAddress address = omProxyInfos.get(nodeId).getAddress();
-        proxyInfo.proxy = createOMProxy(proxyInfo.address);
+        proxyInfo.proxy = createOMProxy(address);
-            this.getClass().getSimpleName(), proxyInfo.address, ioe);
+            this.getClass().getSimpleName(), address, ioe);
-    return proxyInfo;
+  }
+
+  public synchronized Text getCurrentProxyDelegationToken() {
+    return omProxyInfos.get(currentProxyOMNodeId).getDelegationTokenService();
-    for (OMProxyInfo proxy : omProxies.values()) {
+    for (ProxyInfo<OzoneManagerProtocolPB> proxy : omProxies.values()) {
-  public List<OMProxyInfo> getOMProxies() {
-    return new ArrayList<>(omProxies.values());
+  public List<ProxyInfo> getOMProxies() {
+    return new ArrayList<ProxyInfo>(omProxies.values());
+  }
+
+  @VisibleForTesting
+  public List<OMProxyInfo> getOMProxyInfos() {
+    return new ArrayList<OMProxyInfo>(omProxyInfos.values());
