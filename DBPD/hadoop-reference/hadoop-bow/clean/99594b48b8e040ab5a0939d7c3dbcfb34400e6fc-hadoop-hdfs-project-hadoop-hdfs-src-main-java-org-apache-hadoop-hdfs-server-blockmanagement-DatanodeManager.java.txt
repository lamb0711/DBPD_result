HDFS-13075. [SPS]: Provide External Context implementation. Contributed by Uma Maheswara Rao G.

+import org.apache.hadoop.fs.StorageType;
+
+  public boolean verifyTargetDatanodeHasSpaceForScheduling(DatanodeInfo dn,
+      StorageType type, long estimatedSize) {
+    namesystem.readLock();
+    try {
+      DatanodeDescriptor datanode =
+          blockManager.getDatanodeManager().getDatanode(dn.getDatanodeUuid());
+      if (datanode == null) {
+        LOG.debug("Target datanode: " + dn + " doesn't exists");
+        return false;
+      }
+      return null != datanode.chooseStorage4Block(type, estimatedSize);
+    } finally {
+      namesystem.readUnlock();
+    }
+  }
+
