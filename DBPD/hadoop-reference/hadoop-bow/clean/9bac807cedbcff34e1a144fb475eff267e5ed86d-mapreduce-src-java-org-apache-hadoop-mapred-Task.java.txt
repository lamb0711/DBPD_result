MAPREDUCE-2187. Reporter sends progress during sort/merge. Contributed by Anupam Seth.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1152964 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.mapreduce.MRJobConfig;
+  public static final long DEFAULT_COMBINE_RECORDS_BEFORE_PROGRESS = 10000;
-    public CombineOutputCollector(Counters.Counter outCounter) {
+    private Progressable progressable;
+    private long progressBar;
+
+    public CombineOutputCollector(Counters.Counter outCounter, Progressable progressable, Configuration conf) {
+      this.progressable=progressable;
+      progressBar = conf.getLong(MRJobConfig.COMBINE_RECORDS_BEFORE_PROGRESS, DEFAULT_COMBINE_RECORDS_BEFORE_PROGRESS);
+    
+
+      if ((outCounter.getValue() % progressBar) == 0) {
+        progressable.progress();
+      }
