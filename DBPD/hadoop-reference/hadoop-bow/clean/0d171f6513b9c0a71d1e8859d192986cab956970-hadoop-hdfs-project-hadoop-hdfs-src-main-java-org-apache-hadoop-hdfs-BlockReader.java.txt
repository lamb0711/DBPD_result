Merge trunk into HA branch


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1202013 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.hadoop.fs.PositionedReadable;
-import org.apache.hadoop.fs.Seekable;
-
-public interface BlockReader extends Seekable, PositionedReadable {
+public interface BlockReader {
-  /**
-   * Read a single byte, returning -1 at enf of stream.
-   */
-  int read() throws IOException;
-
-   * kind of like readFully(). Only reads as much as possible.
-   * And allows use of protected readFully().
+   * Read exactly the given amount of data, throwing an exception
+   * if EOF is reached before that amount
+   */
+  void readFully(byte[] buf, int readOffset, int amtToRead) throws IOException;
+
+  /**
+   * Similar to {@link #readFully(byte[], int, int)} except that it will
+   * not throw an exception on EOF. However, it differs from the simple
+   * {@link #read(byte[], int, int)} call in that it is guaranteed to
+   * read the data if it is available. In other words, if this call
+   * does not throw an exception, then either the buffer has been
+   * filled or the next call will return EOF.
