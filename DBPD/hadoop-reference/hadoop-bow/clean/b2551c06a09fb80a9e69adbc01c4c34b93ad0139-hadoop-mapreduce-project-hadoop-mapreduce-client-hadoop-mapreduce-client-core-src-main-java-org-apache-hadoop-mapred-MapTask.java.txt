Import initial code for MAPREDUCE-2841 (native output collector)

Contributed by:
  Binglin Chang
  Yang Dong
  Sean Zhong
  Manu Zhang
  Zhongliang Zhu
  Vincent Wang
  Yan Dong
  Cheng Lian
  Xusen Yin
  Fangqin Dai
  Jiang Weihua
  Gansha Wu
  Avik Dey


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/MR-2841@1611413 13f79535-47bb-0310-9956-ffa450edef68

-    LOG.info("Map output collector class = " + collector.getClass().getName());
-    collector.init(context);
-    return collector;
+
+    try {
+      collector.init(context);
+    } catch (Exception e) {
+      LOG.warn("Nativetask falling back to Java MapOutputCollector", e);
+      collector = new MapOutputBuffer();
+      collector.init(context);
+    } finally {
+      LOG.info("Map output collector class = " + collector.getClass().getName());
+      return collector;
+    }
