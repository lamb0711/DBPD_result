YARN-9440. Improve diagnostics for scheduler and app activities. Contributed by Tao Yang.

-import org.slf4j.Logger;
-import org.slf4j.LoggerFactory;
+import java.util.Map;
+import java.util.stream.Collectors;
-  protected String nodeId;
-  protected String queueName;
-  protected String appPriority;
-  protected String allocatedContainerId;
-  protected String allocationState;
-  protected String diagnostic;
-  protected String timeStamp;
-  protected List<ActivityNodeInfo> allocationAttempt;
-
-  private static final Logger LOG =
-      LoggerFactory.getLogger(AppAllocationInfo.class);
+  private String nodeId;
+  private String queueName;
+  private String appPriority;
+  private long timestamp;
+  private String dateTime;
+  private String allocationState;
+  private List<AppRequestAllocationInfo> requestAllocation;
-    this.allocationAttempt = new ArrayList<>();
-
+    this.requestAllocation = new ArrayList<>();
-    this.allocatedContainerId = allocation.getContainerId();
+    this.timestamp = allocation.getTime();
+    this.dateTime = new Date(allocation.getTime()).toString();
-    this.diagnostic = allocation.getDiagnostic();
-
-    Date date = new Date();
-    date.setTime(allocation.getTime());
-    this.timeStamp = date.toString();
-
-    for (ActivityNode attempt : allocation.getAllocationAttempts()) {
-      ActivityNodeInfo containerInfo = new ActivityNodeInfo(attempt);
-      this.allocationAttempt.add(containerInfo);
+    Map<String, List<ActivityNode>> requestToActivityNodes =
+        allocation.getAllocationAttempts().stream().collect(Collectors
+            .groupingBy((e) -> e.getRequestPriority() + "_" + e
+                .getAllocationRequestId(), Collectors.toList()));
+    for (List<ActivityNode> requestActivityNodes : requestToActivityNodes
+        .values()) {
+      AppRequestAllocationInfo requestAllocationInfo =
+          new AppRequestAllocationInfo(requestActivityNodes);
+      this.requestAllocation.add(requestAllocationInfo);
+
+  public String getNodeId() {
+    return nodeId;
+  }
+
+  public String getQueueName() {
+    return queueName;
+  }
+
+  public String getAppPriority() {
+    return appPriority;
+  }
+
+  public long getTimestamp() {
+    return timestamp;
+  }
+
+  public String getDateTime() {
+    return dateTime;
+  }
+
+  public String getAllocationState() {
+    return allocationState;
+  }
+
+  public List<AppRequestAllocationInfo> getRequestAllocation() {
+    return requestAllocation;
+  }
