YARN-9439. Support asynchronized scheduling mode and multi-node lookup mechanism for app activities. Contributed by Tao Yang.

-      NodeId nodeId = getRecordingNodeId(activitiesManager, node);
-      if (nodeId == null) {
+      if (activitiesManager == null) {
+      NodeId nodeId = getRecordingNodeId(activitiesManager, node);
-      NodeId nodeId = getRecordingNodeId(activitiesManager, node);
-      if (nodeId == null) {
+      if (activitiesManager == null) {
+      NodeId nodeId = getRecordingNodeId(activitiesManager, node);
-      NodeId nodeId = getRecordingNodeId(activitiesManager, node);
-      if (nodeId == null) {
+      if (activitiesManager == null) {
+      NodeId nodeId = getRecordingNodeId(activitiesManager, node);
-      NodeId nodeId = getRecordingNodeId(activitiesManager, node);
-      if (nodeId == null) {
+      if (activitiesManager == null) {
+      NodeId nodeId = getRecordingNodeId(activitiesManager, node);
-      NodeId nodeId = getRecordingNodeId(activitiesManager, node);
-      if (nodeId == null) {
+      if (activitiesManager == null) {
+      NodeId nodeId = getRecordingNodeId(activitiesManager, node);
