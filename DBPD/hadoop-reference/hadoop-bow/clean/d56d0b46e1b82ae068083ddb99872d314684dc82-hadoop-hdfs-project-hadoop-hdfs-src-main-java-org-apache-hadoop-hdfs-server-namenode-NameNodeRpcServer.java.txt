commit correct version of HDFS-5121

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-4949@1520090 13f79535-47bb-0310-9956-ffa450edef68

-import java.util.NoSuchElementException;
-import org.apache.hadoop.fs.BatchedRemoteIterator.BatchedEntries;
+import org.apache.hadoop.hdfs.protocol.CachePoolInfo;
-import org.apache.hadoop.hdfs.protocol.CachePoolInfo;
-    private final String pool;
+    private final Long poolId;
-        int maxRepliesPerRequest, String pool) {
+        int maxRepliesPerRequest, Long poolId) {
-      this.pool = pool;
+      this.poolId = poolId;
-        Long nextKey, int maxRepliesPerRequest) throws IOException {
+        Long prevKey, int maxRepliesPerRequest) throws IOException {
-          namesystem.listPathCacheEntries(nextKey, pool,
+          namesystem.listPathCacheEntries(prevKey, poolId,
-    public Long elementToNextKey(PathCacheEntry entry) {
+    public Long elementToPrevKey(PathCacheEntry entry) {
-  
+
-  public RemoteIterator<PathCacheEntry> listPathCacheEntries(long prevId, String pool,
-      int maxReplies) throws IOException {
-    return new ServerSidePathCacheEntriesIterator(prevId, maxReplies, pool);
+  public RemoteIterator<PathCacheEntry> listPathCacheEntries(long prevId,
+      long poolId, int maxReplies) throws IOException {
+    return new ServerSidePathCacheEntriesIterator(prevId, maxReplies, poolId);
-  public void addCachePool(CachePoolInfo info) throws IOException {
-    namesystem.addCachePool(info);
+  public CachePool addCachePool(CachePoolInfo info) throws IOException {
+    return namesystem.addCachePool(info);
-  public void modifyCachePool(CachePoolInfo info) throws IOException {
-    namesystem.modifyCachePool(info);
+  public void modifyCachePool(long poolId, CachePoolInfo info)
+      throws IOException {
+    namesystem.modifyCachePool(poolId, info);
-  public void removeCachePool(String cachePoolName) throws IOException {
-    namesystem.removeCachePool(cachePoolName);
+  public void removeCachePool(long poolId) throws IOException {
+    namesystem.removeCachePool(poolId);
-      extends BatchedRemoteIterator<String, CachePoolInfo> {
+      extends BatchedRemoteIterator<Long, CachePool> {
-    public ServerSideCachePoolIterator(String prevKey, int maxRepliesPerRequest) {
-      super(prevKey, maxRepliesPerRequest);
+    public ServerSideCachePoolIterator(long prevId, int maxRepliesPerRequest) {
+      super(prevId, maxRepliesPerRequest);
-    public BatchedEntries<CachePoolInfo> makeRequest(String prevKey,
+    public BatchedEntries<CachePool> makeRequest(Long prevId,
-      return new BatchedListEntries<CachePoolInfo>(
-          namesystem.listCachePools(prevKey, maxRepliesPerRequest));
+      return new BatchedListEntries<CachePool>(
+          namesystem.listCachePools(prevId, maxRepliesPerRequest));
-    public String elementToNextKey(CachePoolInfo element) {
-      return element.getPoolName();
+    public Long elementToPrevKey(CachePool element) {
+      return element.getId();
-  public RemoteIterator<CachePoolInfo> listCachePools(String prevKey,
+  public RemoteIterator<CachePool> listCachePools(long prevPoolId,
-    return new ServerSideCachePoolIterator(prevKey, maxRepliesPerRequest);
+    return new ServerSideCachePoolIterator(prevPoolId, maxRepliesPerRequest);
