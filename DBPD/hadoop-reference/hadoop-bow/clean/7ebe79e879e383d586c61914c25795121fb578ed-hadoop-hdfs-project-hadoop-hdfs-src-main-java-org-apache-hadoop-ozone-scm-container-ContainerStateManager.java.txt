HDFS-12720. Ozone: Ratis options are not passed from KSM Client protobuf helper correctly. Contributed by Mukul Kumar Singh.

-        if (info.getAllocated() + size <= this.containerSize) {
-
+        if (info.canAllocate(size, this.containerSize)) {
-          // We should close this container.
-          LOG.info("Moving {} to containerCloseQueue.", info.toString());
-          containerCloseQueue.add(info);
-          //TODO: Next JIRA will handle these containers to close.
+          if (info.getState() != LifeCycleState.CLOSED) {
+            // We should close this container.
+            LOG.info("Moving {} to containerCloseQueue.", info.toString());
+            info.setState(LifeCycleState.CLOSED);
+            containerCloseQueue.add(info);
+            //TODO: Next JIRA will handle these containers to close.
+            //TODO: move container to right queue
+          }
