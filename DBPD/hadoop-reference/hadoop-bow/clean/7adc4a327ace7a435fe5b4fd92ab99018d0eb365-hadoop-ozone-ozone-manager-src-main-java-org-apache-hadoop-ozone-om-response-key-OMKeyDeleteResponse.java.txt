HDDS-1775. Make OM KeyDeletingService compatible with HA model (#1063)



+import org.apache.hadoop.ozone.OmUtils;
+  private long deleteTimestamp;
-  public OMKeyDeleteResponse(OmKeyInfo omKeyInfo, OMResponse omResponse) {
+  public OMKeyDeleteResponse(OmKeyInfo omKeyInfo, long deletionTime,
+      OMResponse omResponse) {
+    this.deleteTimestamp = deletionTime;
+        // If a deleted key is put in the table where a key with the same
+        // name already exists, then the old deleted key information would be
+        // lost. To differentiate between keys with same name in
+        // deletedTable, we add the timestamp to the key name.
+        String deleteKeyName = OmUtils.getDeletedKeyName(
+            ozoneKey, deleteTimestamp);
-            ozoneKey, omKeyInfo);
+            deleteKeyName, omKeyInfo);
