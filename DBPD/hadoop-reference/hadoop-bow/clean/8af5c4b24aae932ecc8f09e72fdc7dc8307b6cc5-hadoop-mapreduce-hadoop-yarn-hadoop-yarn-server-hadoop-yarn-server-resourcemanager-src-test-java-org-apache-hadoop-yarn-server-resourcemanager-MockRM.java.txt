MAPREDUCE-2649. Handling of finished applications in RM. Contributed by Thomas Graves.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1160521 13f79535-47bb-0310-9956-ffa450edef68

-    RMApp app = getRMContext().getRMApps().get(appId);
+    RMApp app = null;
+    while ((app == null) && timeoutSecs++ < 20) {
+      app = getRMContext().getRMApps().get(appId);
+      Thread.sleep(500);
+    }
+    timeoutSecs = 0;
-    return new ClientRMService(getRMContext(),
-        clientToAMSecretManager, getResourceScheduler(), masterService) {
+    return new ClientRMService(getRMContext(), getResourceScheduler()) {
