HDFS-11769. Ozone: KSM: Add createVolume API. Contributed by Mukul Kumar Singh.

+import org.apache.hadoop.ksm.helpers.KsmVolumeArgs;
+import org.apache.hadoop.ksm.protocolPB.KeySpaceManagerProtocolClientSideTranslatorPB;
-import java.util.*;
+import java.util.Date;
+import java.util.Set;
+import java.util.TimeZone;
+import java.util.Locale;
+import java.util.HashSet;
+import java.util.Arrays;
+import java.util.List;
-      storageContainerLocation;
+      storageContainerLocationClient;
+  private final KeySpaceManagerProtocolClientSideTranslatorPB
+      keySpaceManagerClient;
+   * @param keySpaceManagerClient KeySpaceManager proxy
-      storageContainerLocation) {
-    this.storageContainerLocation = storageContainerLocation;
+                                       storageContainerLocation,
+      KeySpaceManagerProtocolClientSideTranslatorPB
+                                       keySpaceManagerClient) {
+    this.keySpaceManagerClient = keySpaceManagerClient;
+    this.storageContainerLocationClient = storageContainerLocation;
-    String containerKey = buildContainerKey(args.getVolumeName());
-    XceiverClientSpi xceiverClient = acquireXceiverClient(containerKey);
-    try {
-      VolumeInfo volume = new VolumeInfo();
-      volume.setVolumeName(args.getVolumeName());
-      volume.setQuota(args.getQuota());
-      volume.setOwner(new VolumeOwner(args.getUserName()));
-      volume.setCreatedOn(dateToString(new Date()));
-      volume.setCreatedBy(args.getAdminName());
-      KeyData containerKeyData = fromVolumeToContainerKeyData(
-          xceiverClient.getPipeline().getContainerName(), containerKey, volume);
-      putKey(xceiverClient, containerKeyData, args.getRequestID());
-    } finally {
-      xceiverClientManager.releaseClient(xceiverClient);
-    }
+    long quota = args.getQuota() == null ?
+        Long.MAX_VALUE : args.getQuota().sizeInBytes();
+    KsmVolumeArgs volumeArgs = KsmVolumeArgs.newBuilder()
+        .setAdminName(args.getAdminName())
+        .setOwnerName(args.getUserName())
+        .setVolume(args.getVolumeName())
+        .setQuotaInBytes(quota)
+        .build();
+    keySpaceManagerClient.createVolume(volumeArgs);
-   * Acquires an {@link XceiverClientSpi} connected to a {@link Pipeline} of nodes
-   * capable of serving container protocol operations.  The container is
-   * selected based on the specified container key.
+   * Acquires an {@link XceiverClientSpi} connected to a {@link Pipeline}
+   * of nodes capable of serving container protocol operations.
+   * The container is selected based on the specified container key.
-        storageContainerLocation.getStorageContainerLocations(
+        storageContainerLocationClient.getStorageContainerLocations(
