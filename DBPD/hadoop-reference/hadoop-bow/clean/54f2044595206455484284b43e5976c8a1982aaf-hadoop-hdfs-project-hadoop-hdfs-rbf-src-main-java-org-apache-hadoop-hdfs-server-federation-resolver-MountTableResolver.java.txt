HDFS-13857. RBF: Choose to enable the default nameservice to read/write files. Contributed by yanghuafeng.

+import static org.apache.hadoop.hdfs.server.federation.router.RBFConfigKeys.DFS_ROUTER_DEFAULT_NAMESERVICE_ENABLE;
+import static org.apache.hadoop.hdfs.server.federation.router.RBFConfigKeys.DFS_ROUTER_DEFAULT_NAMESERVICE_ENABLE_DEFAULT;
+  /** If use default nameservice to read and write files. */
+  private boolean defaultNSEnable = true;
+    this.defaultNSEnable = conf.getBoolean(
+        DFS_ROUTER_DEFAULT_NAMESERVICE_ENABLE,
+        DFS_ROUTER_DEFAULT_NAMESERVICE_ENABLE_DEFAULT);
+
+      this.defaultNSEnable = false;
-      LOG.info("Default name service: {}", this.defaultNameService);
+      String enable = this.defaultNSEnable ? "enabled" : "disabled";
+      LOG.info("Default name service: {}, {} to read or write",
+          this.defaultNameService, enable);
-  public PathLocation lookupLocation(final String path) {
+  public PathLocation lookupLocation(final String path) throws IOException {
+      if (!defaultNSEnable) {
+        throw new IOException("Cannot find locations for " + path + ", " +
+            "because the default nameservice is disabled to read or write");
+      }
+
+  @VisibleForTesting
+  public String getDefaultNameService() {
+    return defaultNameService;
+  }
+
+  @VisibleForTesting
+  public void setDefaultNameService(String defaultNameService) {
+    this.defaultNameService = defaultNameService;
+  }
+
+  @VisibleForTesting
+  public boolean isDefaultNSEnable() {
+    return defaultNSEnable;
+  }
+
+  @VisibleForTesting
+  public void setDefaultNSEnable(boolean defaultNSRWEnable) {
+    this.defaultNSEnable = defaultNSRWEnable;
+  }
