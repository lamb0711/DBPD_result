Reverting the previous trunk merge since it added other unintended changes in addition


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1177127 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.hadoop.hdfs.web.ParamFilter;
-import org.apache.hadoop.hdfs.web.resources.RenewerParam;
-import com.sun.jersey.spi.container.ResourceFilters;
-
-@ResourceFilters(ParamFilter.class)
-  public static final Log LOG = LogFactory.getLog(NamenodeWebHdfsMethods.class);
-
-  private static final ThreadLocal<String> REMOTE_ADDRESS = new ThreadLocal<String>(); 
-
-  /** @return the remote client address. */
-  public static String getRemoteAddress() {
-    return REMOTE_ADDRESS.get();
-  }
+  private static final Log LOG = LogFactory.getLog(NamenodeWebHdfsMethods.class);
-        REMOTE_ADDRESS.set(request.getRemoteAddr());
-        try {
-
-        } finally {
-          REMOTE_ADDRESS.set(null);
-        }
-        REMOTE_ADDRESS.set(request.getRemoteAddr());
-        try {
-
-        } finally {
-          REMOTE_ADDRESS.set(null);
-        }
-      @QueryParam(RenewerParam.NAME) @DefaultValue(RenewerParam.DEFAULT)
-          final RenewerParam renewer,
-    return get(ugi, delegation, ROOT, op, offset, length, renewer, bufferSize);
+    return get(ugi, delegation, ROOT, op, offset, length, bufferSize);
-      @QueryParam(RenewerParam.NAME) @DefaultValue(RenewerParam.DEFAULT)
-          final RenewerParam renewer,
-          + Param.toSortedString(", ", offset, length, renewer, bufferSize));
+          + Param.toSortedString(", ", offset, length, bufferSize));
-        REMOTE_ADDRESS.set(request.getRemoteAddr());
-        try {
-    case GETFILEBLOCKLOCATIONS:
-    {
-      final long offsetValue = offset.getValue();
-      final Long lengthValue = length.getValue();
-      final LocatedBlocks locatedblocks = np.getBlockLocations(fullpath,
-          offsetValue, lengthValue != null? lengthValue: offsetValue + 1);
-      final String js = JsonUtil.toJsonString(locatedblocks);
-      return Response.ok(js).type(MediaType.APPLICATION_JSON).build();
-    }
-    case GETDELEGATIONTOKEN:
-    {
-      final Token<? extends TokenIdentifier> token = generateDelegationToken(
-          namenode, ugi, renewer.getValue());
-      final String js = JsonUtil.toJsonString(token);
-      return Response.ok(js).type(MediaType.APPLICATION_JSON).build();
-    }
-
-        } finally {
-          REMOTE_ADDRESS.set(null);
-        }
-        REMOTE_ADDRESS.set(request.getRemoteAddr());
-        try {
-
-
-        } finally {
-          REMOTE_ADDRESS.set(null);
-        }
