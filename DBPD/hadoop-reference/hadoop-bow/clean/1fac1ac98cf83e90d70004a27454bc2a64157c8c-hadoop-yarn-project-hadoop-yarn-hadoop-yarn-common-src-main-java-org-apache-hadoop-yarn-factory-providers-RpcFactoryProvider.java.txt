YARN-708. Moved RecordFactory classes to hadoop-yarn-api, and put some miscellaneous fixes to the interfaces. Contributed by Siddharth Seth.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1485478 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.commons.logging.Log;
-import org.apache.commons.logging.LogFactory;
-import org.apache.hadoop.yarn.factories.impl.pb.RpcClientFactoryPBImpl;
-import org.apache.hadoop.yarn.factories.impl.pb.RpcServerFactoryPBImpl;
-  private static final Log LOG = LogFactory.getLog(RpcFactoryProvider.class);
-    String serverFactoryClassName = conf.get(YarnConfiguration.IPC_SERVER_FACTORY);
-    if (serverFactoryClassName == null) {
-      if (conf.get(YarnConfiguration.IPC_SERIALIZER_TYPE, YarnConfiguration.DEFAULT_IPC_SERIALIZER_TYPE).equals(YarnConfiguration.DEFAULT_IPC_SERIALIZER_TYPE)) {
-        return RpcServerFactoryPBImpl.get();
-      } else {
-        throw new YarnException("Unknown serializer: [" + conf.get(YarnConfiguration.IPC_SERIALIZER_TYPE) + "]. Use keys: [" + YarnConfiguration.IPC_CLIENT_FACTORY + "][" + YarnConfiguration.IPC_SERVER_FACTORY + "] to specify factories");
-      }
-    } else {
-      return (RpcServerFactory) getFactoryClassInstance(serverFactoryClassName);
-    }
+    String serverFactoryClassName = conf.get(
+        YarnConfiguration.IPC_SERVER_FACTORY_CLASS,
+        YarnConfiguration.DEFAULT_IPC_SERVER_FACTORY_CLASS);
+    return (RpcServerFactory) getFactoryClassInstance(serverFactoryClassName);
-  
+
-    String clientFactoryClassName = conf.get(YarnConfiguration.IPC_CLIENT_FACTORY);
-    if (clientFactoryClassName == null) {
-      if (conf.get(YarnConfiguration.IPC_SERIALIZER_TYPE, YarnConfiguration.DEFAULT_IPC_SERIALIZER_TYPE).equals(YarnConfiguration.DEFAULT_IPC_SERIALIZER_TYPE)) {
-        return RpcClientFactoryPBImpl.get();
-      } else {
-        throw new YarnException("Unknown serializer: [" + conf.get(YarnConfiguration.IPC_SERIALIZER_TYPE) + "]. Use keys: [" + YarnConfiguration.IPC_CLIENT_FACTORY + "][" + YarnConfiguration.IPC_SERVER_FACTORY + "] to specify factories");
-      }
-    } else {
-      return(RpcClientFactory) getFactoryClassInstance(clientFactoryClassName);
-    }
+    String clientFactoryClassName = conf.get(
+        YarnConfiguration.IPC_CLIENT_FACTORY_CLASS,
+        YarnConfiguration.DEFAULT_IPC_CLIENT_FACTORY_CLASS);
+    return (RpcClientFactory) getFactoryClassInstance(clientFactoryClassName);
