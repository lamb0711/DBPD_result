Merge trunk into HA branch


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1170378 13f79535-47bb-0310-9956-ffa450edef68

-  private RMAppManager rmAppManager;
+  protected RMAppManager rmAppManager;
-    clientRM = createClientRMService();
-    addService(clientRM);
-
+
+    clientRM = createClientRMService();
+    addService(clientRM);
-        conf.getClass(RMConfig.RESOURCE_SCHEDULER, 
+        conf.getClass(YarnConfiguration.RM_SCHEDULER, 
-        conf.get(YarnConfiguration.RM_WEBAPP_BIND_ADDRESS,
-        YarnConfiguration.DEFAULT_RM_WEBAPP_BIND_ADDRESS)).
+        conf.get(YarnConfiguration.RM_WEBAPP_ADDRESS,
+        YarnConfiguration.DEFAULT_RM_WEBAPP_ADDRESS)).
-    SecurityUtil.login(conf, RMConfig.RM_KEYTAB,
-        YarnConfiguration.RM_SERVER_PRINCIPAL_KEY);
+    SecurityUtil.login(conf, YarnConfiguration.RM_KEYTAB,
+        YarnConfiguration.RM_PRINCIPAL);
-    return new ClientRMService(this.rmContext, scheduler);
+    return new ClientRMService(this.rmContext, scheduler, this.rmAppManager);
