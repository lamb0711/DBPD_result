YARN-9267. General improvements in FpgaResourceHandlerImpl. Contributed by Peter Bacsko.

-import org.apache.hadoop.yarn.server.nodemanager.containermanager.resourceplugin.fpga.FpgaDiscoverer;
+    // SHA-256 hash of the uploaded aocx file
+    private String aocxHash;
+    public String getAocxHash() {
+      return aocxHash;
+    }
+
+    public void setAocxHash(String hash) {
+      this.aocxHash = hash;
+    }
+
-          this.major + ", Minor: " + this.minor + ", IPID: " + this.IPID + ")";
+          this.major + ", Minor: " + this.minor + ", IPID: " +
+          this.IPID + ", Hash: " + this.aocxHash + ")";
-      FpgaDevice device, String newIPID) {
+      FpgaDevice device, String newIPID, String newHash) {
+      FpgaDevice fpga = usedFpgas.get(index);
+      fpga.setIPID(newIPID);
+      fpga.setAocxHash(newHash);
-   * @param IPIDPreference allocate slot with this IPID first
+   * @param ipidHash hash of the localized aocx file
-      Container container, String IPIDPreference) throws ResourceHandlerException {
+      Container container, String ipidHash) throws ResourceHandlerException {
-        if ( null != currentAvailableFpga.get(i).getIPID() &&
-            currentAvailableFpga.get(i).getIPID().equalsIgnoreCase(IPIDPreference)) {
+        String deviceIPIDhash = currentAvailableFpga.get(i).getAocxHash();
+        if (deviceIPIDhash != null &&
+            deviceIPIDhash.equalsIgnoreCase(ipidHash)) {
