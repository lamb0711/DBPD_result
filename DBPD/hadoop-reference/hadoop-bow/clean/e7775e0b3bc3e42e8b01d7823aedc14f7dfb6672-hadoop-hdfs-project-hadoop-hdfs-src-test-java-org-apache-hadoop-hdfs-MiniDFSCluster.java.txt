HDFS-2805. Add a test for a federated cluster with HA NNs. Contributed by Brandon Li.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1236471 13f79535-47bb-0310-9956-ffa450edef68

+    // If we have more than one nameservice, need to enumerate them in the
+    // config.
+    if (federation) {      
+      List<String> allNsIds = Lists.newArrayList();
+      for (MiniDFSNNTopology.NSConf nameservice : nnTopology.getNameservices()) {
+        allNsIds.add(nameservice.getId());
+      }
+      conf.set(DFS_FEDERATION_NAMESERVICES, Joiner.on(",").join(allNsIds));
+    }
+    
-    List<String> nsIds = Lists.newArrayList();
-      nsIds.add(nameservice.getId());
+
-    if (federation) {
-      // If we have more than one nameservice, need to enumerate them in the
-      // config.
-      conf.set(DFS_FEDERATION_NAMESERVICES, Joiner.on(",").join(nsIds));
-    }
-    
+
