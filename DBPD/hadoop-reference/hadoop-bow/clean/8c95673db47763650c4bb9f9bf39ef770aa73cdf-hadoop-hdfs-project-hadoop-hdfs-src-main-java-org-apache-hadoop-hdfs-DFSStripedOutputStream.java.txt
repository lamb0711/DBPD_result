HDFS-8366. Erasure Coding: Make the timeout parameter of polling blocking queue configurable in DFSStripedOutputStream. Contributed by Li Bo

+import org.apache.hadoop.hdfs.client.HdfsClientConfigKeys;
+import org.apache.hadoop.hdfs.client.impl.DfsClientConf;
+    private final DfsClientConf conf;
-    Coordinator(final int numDataBlocks, final int numAllBlocks) {
+    Coordinator(final DfsClientConf conf, final int numDataBlocks,
+                final int numAllBlocks) {
+      this.conf = conf;
-        return endBlocks.get(i).poll(30, TimeUnit.SECONDS);
+        return endBlocks.get(i).poll(
+            conf.getStripedWriteMaxSecondsGetEndedBlock(),
+            TimeUnit.SECONDS);
-        lb = stripedBlocks.get(i).poll(90, TimeUnit.SECONDS);
+        lb = stripedBlocks.get(i).poll(
+            conf.getStripedWriteMaxSecondsGetStripedBlock(),
+            TimeUnit.SECONDS);
-  /** Buffers for writing the data and parity cells of a strip. */
+  /** Buffers for writing the data and parity cells of a stripe. */
-    coordinator = new Coordinator(numDataBlocks, numAllBlocks);
+    coordinator = new Coordinator(dfsClient.getConf(), numDataBlocks, numAllBlocks);
