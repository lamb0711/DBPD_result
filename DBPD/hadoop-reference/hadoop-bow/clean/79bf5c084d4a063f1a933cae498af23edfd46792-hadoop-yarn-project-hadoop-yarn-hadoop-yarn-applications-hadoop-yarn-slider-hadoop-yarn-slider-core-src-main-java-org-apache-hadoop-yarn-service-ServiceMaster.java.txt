YARN-7029. Add more UTs in yarn-native-services. Contributed by Jian He

+import org.apache.hadoop.yarn.exceptions.YarnException;
+import org.apache.hadoop.yarn.service.utils.ServiceApiUtil;
-import org.apache.hadoop.yarn.service.utils.ServiceApiUtil;
+import org.apache.slider.core.exceptions.BadClusterStateException;
+import java.io.IOException;
+  protected ServiceContext context;
-    ServiceContext context = new ServiceContext();
-    Path appDir = new Path(amArgs.getAppDefPath()).getParent();
+    context = new ServiceContext();
+    Path appDir = getAppDir();
-    context.application = ServiceApiUtil
-        .loadApplicationFrom(fs, new Path(amArgs.getAppDefPath()));
-    LOG.info(context.application.toString());
-    ContainerId amContainerId = ContainerId.fromString(SliderUtils
-        .mandatoryEnvVariable(
-            ApplicationConstants.Environment.CONTAINER_ID.name()));
+    loadApplicationJson(context, fs);
+
+    ContainerId amContainerId = getAMContainerId();
+
-    ServiceScheduler scheduler = new ServiceScheduler(context);
+    ServiceScheduler scheduler = createServiceScheduler(context);
+  protected ContainerId getAMContainerId() throws BadClusterStateException {
+    return ContainerId.fromString(SliderUtils.mandatoryEnvVariable(
+        ApplicationConstants.Environment.CONTAINER_ID.name()));
+  }
+
+  protected Path getAppDir() {
+    return new Path(amArgs.getAppDefPath()).getParent();
+  }
+
+  protected ServiceScheduler createServiceScheduler(ServiceContext context)
+      throws IOException, YarnException {
+    return new ServiceScheduler(context);
+  }
+
+  protected void loadApplicationJson(ServiceContext context,
+      SliderFileSystem fs) throws IOException {
+    context.application = ServiceApiUtil
+        .loadApplicationFrom(fs, new Path(amArgs.getAppDefPath()));
+    LOG.info(context.application.toString());
+  }
