HDFS-9063. Correctly handle snapshot path for getContentSummary. Contributed by Jing Zhao.

-  public ContentSummaryComputationContext computeContentSummary(
+  public ContentSummaryComputationContext computeContentSummary(int snapshotId,
-    return referred.computeContentSummary(summary);
+    return referred.computeContentSummary(snapshotId, summary);
-        ContentSummaryComputationContext summary) {
+        int snapshotId, ContentSummaryComputationContext summary) {
+      final int s = snapshotId < lastSnapshotId ? snapshotId : lastSnapshotId;
-          summary.getBlockStoragePolicySuite(), getStoragePolicyID(), false,
-          lastSnapshotId);
+          summary.getBlockStoragePolicySuite(), getStoragePolicyID(), false, s);
