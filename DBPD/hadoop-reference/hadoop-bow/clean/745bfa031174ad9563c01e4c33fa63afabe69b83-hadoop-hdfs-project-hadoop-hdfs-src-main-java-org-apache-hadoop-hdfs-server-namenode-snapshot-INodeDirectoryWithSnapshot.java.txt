HDFS-4749. Use INodeId to identify the corresponding directory node in FSImage saving/loading.  Contributed by Jing Zhao


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1475902 13f79535-47bb-0310-9956-ffa450edef68

-import java.util.Map;
-import org.apache.hadoop.hdfs.server.namenode.INodeReference.WithCount;
+import org.apache.hadoop.hdfs.server.namenode.INodeReference.WithCount;
-    /** @return The list of INodeDirectory contained in the deleted list */
-    private List<INodeDirectory> getDirsInDeleted() {
-      List<INodeDirectory> dirList = new ArrayList<INodeDirectory>();
+    /** Get the list of INodeDirectory contained in the deleted list */
+    private void getDirsInDeleted(List<INodeDirectory> dirList) {
-      return dirList;
-   * 
-   * @param snapshotDirMap A snapshot-to-directory-list map for returning.
-   * @return The number of directories returned.
-  public int getSnapshotDirectory(
-      Map<Snapshot, List<INodeDirectory>> snapshotDirMap) {
-    int dirNum = 0;
+  public void getSnapshotDirectory(List<INodeDirectory> snapshotDir) {
-      List<INodeDirectory> list = sdiff.getChildrenDiff().getDirsInDeleted();
-      if (list.size() > 0) {
-        snapshotDirMap.put(sdiff.snapshot, list);
-        dirNum += list.size();
-      }
+      sdiff.getChildrenDiff().getDirsInDeleted(snapshotDir);
-    return dirNum;
