HDFS-11469. Ozone: SCM: Container allocation based on node report. Contributed by Xiaoyu Yao.

-  public boolean waitForHeartbeatThead() {
+  @Override
+  public boolean waitForHeartbeatProcessed() {
-    executorService.shutdown();
+    executorService.shutdown();
-   * Return a list of node stats.
-   * @return a list of individual node stats (live/stale but not dead).
+   * Return a map of node stats.
+   * @return a map of individual node stats (live/stale but not dead).
-  public List<SCMNodeStat> getNodeStats(){
-    return nodeStats.entrySet().stream().map(
-        entry -> nodeStats.get(entry.getKey())).collect(Collectors.toList());
+  public Map<String, SCMNodeStat> getNodeStats() {
+    return Collections.unmodifiableMap(nodeStats);
+  }
+
+  /**
+   * Return the node stat of the specified datanode.
+   * @param datanodeID - datanode ID.
+   * @return node stat if it is live/stale, null if it is dead or does't exist.
+   */
+  @Override
+  public SCMNodeStat getNodeStat(DatanodeID datanodeID) {
+    return nodeStats.get(datanodeID.getDatanodeUuid());
