HDFS-13072. Ozone: DatanodeStateMachine: Handling Uncaught Exception in command handler thread. Contributed by Nanda kumar.

-    cmdProcessThread = new Thread(processCommandQueue);
-    cmdProcessThread.setDaemon(true);
-    cmdProcessThread.setName("Command processor thread");
-    cmdProcessThread.setUncaughtExceptionHandler((Thread t, Throwable e) -> {
+    cmdProcessThread = getCommandHandlerThread(processCommandQueue);
+    cmdProcessThread.start();
+  }
+
+  private Thread getCommandHandlerThread(Runnable processCommandQueue) {
+    Thread handlerThread = new Thread(processCommandQueue);
+    handlerThread.setDaemon(true);
+    handlerThread.setName("Command processor thread");
+    handlerThread.setUncaughtExceptionHandler((Thread t, Throwable e) -> {
-      cmdProcessThread.start();
+      getCommandHandlerThread(processCommandQueue).start();
-    cmdProcessThread.start();
+    return handlerThread;
