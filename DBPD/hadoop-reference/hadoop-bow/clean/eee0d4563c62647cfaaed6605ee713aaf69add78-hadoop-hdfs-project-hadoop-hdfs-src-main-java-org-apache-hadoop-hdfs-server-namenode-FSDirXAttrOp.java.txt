HDFS-8900. Compact XAttrs to optimize memory footprint. (yliu)

-      final String xaName = XAttrHelper.getPrefixName(xattr);
+      final String xaName = XAttrHelper.getPrefixedName(xattr);
-  static List<XAttr> getXAttrs(FSDirectory fsd, INode inode, int snapshotId)
-      throws IOException {
+  static XAttr getXAttrByPrefixedName(FSDirectory fsd, INode inode,
+      int snapshotId, String prefixedName) throws IOException {
-      return XAttrStorage.readINodeXAttrs(inode, snapshotId);
+      return XAttrStorage.readINodeXAttrByPrefixedName(inode, snapshotId,
+          prefixedName);
-  static XAttr unprotectedGetXAttrByName(
-      INode inode, int snapshotId, String xAttrName)
+  static XAttr unprotectedGetXAttrByPrefixedName(
+      INode inode, int snapshotId, String prefixedName)
-    List<XAttr> xAttrs = XAttrStorage.readINodeXAttrs(inode, snapshotId);
-    if (xAttrs == null) {
-      return null;
-    }
-    for (XAttr x : xAttrs) {
-      if (XAttrHelper.getPrefixName(x)
-          .equals(xAttrName)) {
-        return x;
-      }
-    }
-    return null;
+    return XAttrStorage.readINodeXAttrByPrefixedName(inode, snapshotId,
+        prefixedName);
-    if (fsd.getXattrMaxSize() == 0) {
-      return;
-    }
