HDDS-265. Move numPendingDeletionBlocks and deleteTransactionId from ContainerData to KeyValueContainerData. Contributed by LiXin Ge.

-import org.apache.hadoop.hdds.protocol.proto.HddsProtos;
-import org.apache.hadoop.hdds.protocol.proto
-    .StorageContainerDatanodeProtocolProtos.ContainerInfo;
-import static org.apache.hadoop.hdds.protocol.datanode.proto.ContainerProtos
-    .Result.INVALID_CONTAINER_STATE;
-
-      long containerId = container.getContainerData().getContainerID();
-      ContainerInfo.Builder ciBuilder = ContainerInfo.newBuilder();
-      ContainerData containerData = container.getContainerData();
-      ciBuilder.setContainerID(containerId)
-          .setReadCount(containerData.getReadCount())
-          .setWriteCount(containerData.getWriteCount())
-          .setReadBytes(containerData.getReadBytes())
-          .setWriteBytes(containerData.getWriteBytes())
-          .setUsed(containerData.getBytesUsed())
-          .setState(getState(containerData))
-          .setDeleteTransactionId(containerData.getDeleteTransactionId());
-
-      crBuilder.addReports(ciBuilder.build());
+      crBuilder.addReports(container.getContainerReport());
-  /**
-   * Returns LifeCycle State of the container.
-   * @param containerData - ContainerData
-   * @return LifeCycle State of the container
-   * @throws StorageContainerException
-   */
-  private HddsProtos.LifeCycleState getState(ContainerData containerData)
-      throws StorageContainerException {
-    HddsProtos.LifeCycleState state;
-    switch (containerData.getState()) {
-    case OPEN:
-      state = HddsProtos.LifeCycleState.OPEN;
-      break;
-    case CLOSING:
-      state = HddsProtos.LifeCycleState.CLOSING;
-      break;
-    case CLOSED:
-      state = HddsProtos.LifeCycleState.CLOSED;
-      break;
-    default:
-      throw new StorageContainerException("Invalid Container state found: " +
-          containerData.getContainerID(), INVALID_CONTAINER_STATE);
-    }
-    return state;
-  }
-
-        .filter(e -> e.getValue().getContainerType()
-            == ContainerProtos.ContainerType.KeyValueContainer)
+        .filter(e -> deletionPolicy.isValidContainerType(
+            e.getValue().getContainerType()))
