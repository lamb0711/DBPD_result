HDFS-3452. BKJM:Switch from standby to active fails and NN gets shut down due to delay in clearing of lock. Contributed by Uma Maheswara Rao G.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1343913 13f79535-47bb-0310-9956-ffa450edef68

-  private final WriteLock wl;
-  protected BookKeeperEditLogOutputStream(Configuration conf,
-                                          LedgerHandle lh, WriteLock wl)
+  protected BookKeeperEditLogOutputStream(Configuration conf, LedgerHandle lh)
-    this.wl = wl;
-    this.wl.acquire();
-    wl.release();
-    wl.checkWriteLock();
-
-    wl.checkWriteLock();
-
-    synchronized(this) {
+    synchronized (this) {
-    wl.checkWriteLock();
-
-    wl.checkWriteLock();
-
