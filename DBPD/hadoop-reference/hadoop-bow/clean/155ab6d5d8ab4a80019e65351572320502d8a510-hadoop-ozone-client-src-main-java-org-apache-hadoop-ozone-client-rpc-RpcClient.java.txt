HDDS-1098. Introduce Retry Policy in Ozone Client. Contributed by Shashikant Banerjee.

+  private final int maxRetryCount;
+    maxRetryCount =
+        conf.getInt(OzoneConfigKeys.OZONE_CLIENT_MAX_RETRIES, OzoneConfigKeys.
+            OZONE_CLIENT_MAX_RETRIES_DEFAULT);
-    KeyOutputStream groupOutputStream =
+    KeyOutputStream keyOutputStream =
+            .setMaxRetryCount(maxRetryCount)
-    groupOutputStream.addPreallocateBlocks(
+    keyOutputStream.addPreallocateBlocks(
-    final FileEncryptionInfo feInfo = groupOutputStream
+    final FileEncryptionInfo feInfo = keyOutputStream
-          groupOutputStream, OzoneKMSUtil.getCryptoCodec(conf, feInfo),
+          keyOutputStream, OzoneKMSUtil.getCryptoCodec(conf, feInfo),
-      return new OzoneOutputStream(groupOutputStream);
+      return new OzoneOutputStream(keyOutputStream);
-    KeyOutputStream groupOutputStream =
+    KeyOutputStream keyOutputStream =
+            .setMaxRetryCount(maxRetryCount)
-    groupOutputStream.addPreallocateBlocks(
+    keyOutputStream.addPreallocateBlocks(
-    return new OzoneOutputStream(groupOutputStream);
+    return new OzoneOutputStream(keyOutputStream);
