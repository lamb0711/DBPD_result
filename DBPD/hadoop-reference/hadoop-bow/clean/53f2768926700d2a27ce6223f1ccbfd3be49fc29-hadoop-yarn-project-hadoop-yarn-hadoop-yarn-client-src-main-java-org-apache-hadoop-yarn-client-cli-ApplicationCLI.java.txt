YARN-7724. yarn application status should support application name. Contributed by Jian He

-          "Prints the status of the application.");
+          "Prints the status of the application. If app ID is"
+              + " provided, it prints the generic YARN application status."
+              + " If name is provided, it prints the application specific"
+              + " status based on app's own implementation, and -appTypes"
+              + " option must be specified unless it is the default"
+              + " yarn-service type.");
-      opts.getOption(STATUS_CMD).setArgName("Application ID");
+      opts.getOption(STATUS_CMD).setArgName("Application Name or ID");
-      if (hasAnyOtherCLIOptions(cliParser, opts, STATUS_CMD)) {
+      if (hasAnyOtherCLIOptions(cliParser, opts, STATUS_CMD, APP_TYPE_CMD)) {
-        ApplicationReport report = printApplicationReport(cliParser
-            .getOptionValue(STATUS_CMD));
-        if (report == null) {
-          exitCode = -1;
-        } else {
-          exitCode = 0;
-          String appType = report.getApplicationType();
+        String appIdOrName = cliParser.getOptionValue(STATUS_CMD);
+        try {
+          // try parsing appIdOrName, if it succeeds, it means it's appId
+          ApplicationId.fromString(appIdOrName);
+          exitCode = printApplicationReport(appIdOrName);
+        } catch (IllegalArgumentException e) {
+          // not appId format, it could be appName.
+          // Print app specific report, if app-type is not provided,
+          // assume it is yarn-service type.
+          AppAdminClient client = AppAdminClient
+              .createAppAdminClient(getSingleAppTypeFromCLI(cliParser),
+                  getConf());
-            AppAdminClient client = AppAdminClient.createAppAdminClient(appType,
-                getConf());
-            sysout.println("Detailed Application Status :");
-            sysout.println(client.getStatusString(cliParser.getOptionValue(
-                STATUS_CMD)));
-          } catch (IllegalArgumentException e) {
-            // app type does not have app admin client implementation
+            sysout.println(client.getStatusString(appIdOrName));
+            exitCode = 0;
+          } catch (ApplicationNotFoundException exception) {
+            System.err.println("Application with name '" + appIdOrName
+                + "' doesn't exist in RM or Timeline Server.");
+            return -1;
-  private ApplicationReport printApplicationReport(String applicationId)
+  private int printApplicationReport(String applicationId)
-      return null;
+      return -1;
-      return null;
+      return -1;
-    return appReport;
+    return 0;
