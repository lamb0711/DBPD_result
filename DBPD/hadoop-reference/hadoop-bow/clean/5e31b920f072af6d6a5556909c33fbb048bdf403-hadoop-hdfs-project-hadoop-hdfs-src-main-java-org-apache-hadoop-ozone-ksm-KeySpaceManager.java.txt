HDFS-12871. Ozone: Service Discovery: Adding REST server details in ServiceList. Contributed by Nanda Kumar.

+import org.apache.hadoop.hdfs.protocol.proto.HdfsProtos;
-import org.apache.hadoop.scm.protocolPB.ScmBlockLocationProtocolClientSideTranslatorPB;
+import org.apache.hadoop.scm.protocol.StorageContainerLocationProtocol;
+import org.apache.hadoop.scm.protocolPB
+    .ScmBlockLocationProtocolClientSideTranslatorPB;
+import org.apache.hadoop.scm.protocolPB
+    .StorageContainerLocationProtocolClientSideTranslatorPB;
+import org.apache.hadoop.scm.protocolPB.StorageContainerLocationProtocolPB;
+import java.util.EnumSet;
+import static org.apache.hadoop.ozone.protocol.proto.OzoneProtos
+    .NodeState.HEALTHY;
+  private final StorageContainerLocationProtocol scmContainerClient;
+    scmContainerClient = getScmContainerClient(configuration);
+  /**
+   * Returns a scm container client.
+   *
+   * @return {@link StorageContainerLocationProtocol}
+   * @throws IOException
+   */
+  private static StorageContainerLocationProtocol getScmContainerClient(
+      OzoneConfiguration conf) throws IOException {
+    RPC.setProtocolEngine(conf, StorageContainerLocationProtocolPB.class,
+        ProtobufRpcEngine.class);
+    long scmVersion =
+        RPC.getProtocolVersion(StorageContainerLocationProtocolPB.class);
+    InetSocketAddress scmAddr = OzoneClientUtils.getScmAddressForClients(
+        conf);
+    StorageContainerLocationProtocolClientSideTranslatorPB scmContainerClient =
+        new StorageContainerLocationProtocolClientSideTranslatorPB(
+            RPC.getProxy(StorageContainerLocationProtocolPB.class, scmVersion,
+                scmAddr, UserGroupInformation.getCurrentUser(), conf,
+                NetUtils.getDefaultSocketFactory(conf),
+                Client.getRpcTimeout(conf)));
+    return scmContainerClient;
+  }
+
+    services.add(ksmServiceInfoBuilder.build());
-
-    // TODO: REST servers (datanode) details to be added later.
-
-    services.add(ksmServiceInfoBuilder.build());
+
+    List<OzoneProtos.Node> nodes = scmContainerClient.queryNode(
+        EnumSet.of(HEALTHY), OzoneProtos.QueryScope.CLUSTER, "")
+        .getNodesList();
+
+    for (OzoneProtos.Node node : nodes) {
+      HdfsProtos.DatanodeIDProto datanode = node.getNodeID();
+
+      ServiceInfo.Builder dnServiceInfoBuilder = ServiceInfo.newBuilder()
+          .setNodeType(OzoneProtos.NodeType.DATANODE)
+          .setHostname(datanode.getHostName());
+
+      dnServiceInfoBuilder.addServicePort(ServicePort.newBuilder()
+          .setType(ServicePort.Type.HTTP)
+          .setValue(datanode.getInfoPort())
+          .build());
+
+      if (datanode.hasInfoSecurePort() && datanode.getInfoSecurePort() > 0) {
+        dnServiceInfoBuilder.addServicePort(ServicePort.newBuilder()
+            .setType(ServicePort.Type.HTTPS)
+            .setValue(datanode.getInfoSecurePort())
+            .build());
+      }
+      services.add(dnServiceInfoBuilder.build());
+    }
+
