HADOOP-16959. Resolve hadoop-cos dependency conflict. Contributed by Yang Yu.

-    if (null != dir) {
-      if (!dir.exists()) {
-        LOG.debug("Buffer dir: [{}] does not exists. create it first.",
-            dirPath);
-        if (dir.mkdirs()) {
-          if (!dir.setWritable(true) || !dir.setReadable(true)
-              || !dir.setExecutable(true)) {
-            LOG.warn("Set the buffer dir: [{}]'s permission [writable,"
-                + "readable, executable] failed.", dir.getAbsolutePath());
-          }
-          LOG.debug("Buffer dir: [{}] is created successfully.",
-              dir.getAbsolutePath());
-        } else {
-          // Once again, check if it has been created successfully.
-          // Prevent problems created by multiple processes at the same time.
-          if (!dir.exists()) {
-            throw new IOException("buffer dir:" + dir.getAbsolutePath()
-                + " is created unsuccessfully");
-          }
+    if (!dir.exists()) {
+      LOG.debug("Buffer dir: [{}] does not exists. create it first.",
+          dirPath);
+      if (dir.mkdirs()) {
+        if (!dir.setWritable(true) || !dir.setReadable(true)
+            || !dir.setExecutable(true)) {
+          LOG.warn("Set the buffer dir: [{}]'s permission [writable,"
+              + "readable, executable] failed.", dir.getAbsolutePath());
+        LOG.debug("Buffer dir: [{}] is created successfully.",
+            dir.getAbsolutePath());
-        LOG.debug("buffer dir: {} already exists.", dirPath);
+        // Once again, check if it has been created successfully.
+        // Prevent problems created by multiple processes at the same time.
+        if (!dir.exists()) {
+          throw new IOException("buffer dir:" + dir.getAbsolutePath()
+              + " is created unsuccessfully");
+        }
-      throw new IOException("creating buffer dir: " + dir.getAbsolutePath()
-          + "unsuccessfully.");
+      LOG.debug("buffer dir: {} already exists.", dirPath);
