HADOOP-13427. Eliminate needless uses of FileSystem#{exists(), isFile(), isDirectory()}. Contributed by Steve Loughran and Mingliang Liu

+import java.io.FileNotFoundException;
-      FileSystem fs = stateFilename.getFileSystem(conf);
-      if (fs.exists(stateFilename)) {
-        reloadState(stateFilename, conf);
-      } else {
-        throw new RuntimeException("No latest state persist directory found!" 
+      if (!reloadState(stateFilename, conf)) {
+        throw new RuntimeException("No latest state persist directory found!"
-  private void reloadState(Path stateFile, Configuration conf) 
-  throws Exception {
-    FileSystem fs = stateFile.getFileSystem(conf);
-    if (fs.exists(stateFile)) {
+  private boolean reloadState(Path stateFile, Configuration configuration)
+      throws Exception {
+    FileSystem fs = stateFile.getFileSystem(configuration);
+    try (FSDataInputStream in = fs.open(stateFile)) {
-      FSDataInputStream in = fs.open(stateFile);
-      
-      in.close();
-    } else {
+      return true;
+    } catch (FileNotFoundException e) {
+      return false;
-}
+}
