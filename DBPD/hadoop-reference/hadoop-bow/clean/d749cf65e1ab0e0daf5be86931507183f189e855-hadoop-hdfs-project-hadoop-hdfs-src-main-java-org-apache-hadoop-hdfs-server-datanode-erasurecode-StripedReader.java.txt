HDFS-9833. Erasure coding: recomputing block checksum on the fly by reconstructing the missed/corrupt block data. Contributed by Rakesh R.

-import org.apache.hadoop.hdfs.protocol.ErasureCodingPolicy;
-import org.apache.hadoop.hdfs.protocol.ExtendedBlock;
-import org.apache.hadoop.hdfs.server.protocol.BlockECReconstructionCommand.BlockECReconstructionInfo;
-                Configuration conf,
-                BlockECReconstructionInfo reconstructionInfo) {
+      Configuration conf, StripedReconstructionInfo stripedReconInfo) {
-    ErasureCodingPolicy ecPolicy = reconstructionInfo.getErasureCodingPolicy();
-    dataBlkNum = ecPolicy.getNumDataUnits();
-    parityBlkNum = ecPolicy.getNumParityUnits();
+    dataBlkNum = stripedReconInfo.getEcPolicy().getNumDataUnits();
+    parityBlkNum = stripedReconInfo.getEcPolicy().getNumParityUnits();
-    ExtendedBlock blockGroup = reconstructionInfo.getExtendedBlock();
-    int cellsNum = (int)((blockGroup.getNumBytes() - 1) / ecPolicy.getCellSize()
-        + 1);
+    int cellsNum = (int) ((stripedReconInfo.getBlockGroup().getNumBytes() - 1)
+        / stripedReconInfo.getEcPolicy().getCellSize() + 1);
-    liveIndices = reconstructionInfo.getLiveBlockIndices();
-    sources = reconstructionInfo.getSourceDnInfos();
+    this.liveIndices = stripedReconInfo.getLiveIndices();
+    assert liveIndices != null;
+    this.sources = stripedReconInfo.getSources();
+    assert sources != null;
