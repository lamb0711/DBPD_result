MAPREDUCE-5550. Task Status message (reporter.setStatus) not shown in UI with Hadoop 2.0 (Gera Shegalov via Sandy Ryza)

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1552808 13f79535-47bb-0310-9956-ffa450edef68

+    report.setStatus("Moving average: " + Math.random());
+    ApplicationAttemptId appAttemptId = ApplicationAttemptId.newInstance(
+        id.getTaskId().getJobId().getAppId(), 0);
+    ContainerId containerId = ContainerId.newInstance(appAttemptId, 0);
+
+    if (id.getTaskId().getTaskType() == TaskType.REDUCE) {
+      report.setShuffleFinishTime(
+          (report.getFinishTime() + report.getStartTime()) / 2);
+      report.setSortFinishTime(
+          (report.getFinishTime() + report.getShuffleFinishTime()) / 2);
+    }
+
+    report.setContainerId(containerId);
+    report.setDiagnosticInfo(DIAGS.next());
+    report.setStateString("Moving average " + Math.random());
-    final List<String> diags = Lists.newArrayList();
-    diags.add(DIAGS.next());
-        return 0;
+        return report.getStartTime();
-        return 0;
+        return report.getFinishTime();
-        return diags;
+        return Lists.newArrayList(report.getDiagnosticInfo());
-        return 0;
+        return report.getShuffleFinishTime();
-        return 0;
+        return report.getSortFinishTime();
