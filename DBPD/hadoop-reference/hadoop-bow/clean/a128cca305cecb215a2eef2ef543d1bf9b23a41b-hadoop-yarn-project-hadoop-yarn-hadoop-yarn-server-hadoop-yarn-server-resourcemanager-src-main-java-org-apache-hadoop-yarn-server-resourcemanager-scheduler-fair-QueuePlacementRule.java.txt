YARN-2669. FairScheduler: queue names shouldn't allow periods (Wei Yan via Sandy Ryza)

+import org.apache.commons.logging.Log;
+import org.apache.commons.logging.LogFactory;
-  
+  public static final Log LOG =
+      LogFactory.getLog(QueuePlacementRule.class.getName());
+
-      return "root." + user;
+      return "root." + cleanName(user);
-      return "root." + groups.getGroups(user).get(0);
+      return "root." + cleanName(groups.getGroups(user).get(0));
-        String group = groupNames.get(i);
+        String group = cleanName(groupNames.get(i));
-          return "root." + groupNames.get(i);
+          return "root." + group;
-        return queueName + "." + user;
+        return queueName + "." + cleanName(user);
+
+  /**
+   * Replace the periods in the username or groupname with "_dot_".
+   */
+  protected String cleanName(String name) {
+    if (name.contains(".")) {
+      String converted = name.replaceAll("\\.", "_dot_");
+      LOG.warn("Name " + name + " is converted to " + converted
+          + " when it is used as a queue name.");
+      return converted;
+    } else {
+      return name;
+    }
+  }
