MAPREDUCE-7164. FileOutputCommitter does not report progress while merging paths. Contributed by Kuhu Shukla

+import org.apache.hadoop.util.Progressable;
-          mergePaths(fs, stat, finalOutput);
+          mergePaths(fs, stat, finalOutput, context);
-      final Path to) throws IOException {
+      final Path to, JobContext context) throws IOException {
+    reportProgress(context);
-          renameOrMerge(fs, from, to);
+          renameOrMerge(fs, from, to, context);
-            mergePaths(fs, subFrom, subTo);
+            mergePaths(fs, subFrom, subTo, context);
-        renameOrMerge(fs, from, to);
+        renameOrMerge(fs, from, to, context);
-  private void renameOrMerge(FileSystem fs, FileStatus from, Path to)
-      throws IOException {
+  private void reportProgress(JobContext context) {
+    if (context instanceof Progressable) {
+      ((Progressable) context).progress();
+    }
+  }
+
+  private void renameOrMerge(FileSystem fs, FileStatus from, Path to,
+      JobContext context) throws IOException {
-        mergePaths(fs, subFrom, subTo);
+        mergePaths(fs, subFrom, subTo, context);
-          mergePaths(fs, taskAttemptDirStatus, outputPath);
+          mergePaths(fs, taskAttemptDirStatus, outputPath, context);
-          mergePaths(fs, from, outputPath);
+          mergePaths(fs, from, outputPath, context);
