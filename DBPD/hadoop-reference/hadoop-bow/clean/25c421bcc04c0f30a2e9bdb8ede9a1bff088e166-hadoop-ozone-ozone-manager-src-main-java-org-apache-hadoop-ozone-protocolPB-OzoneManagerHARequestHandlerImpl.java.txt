HDDS-1393. Convert all OM Bucket related operations to HA model. (#704)



+import org.apache.hadoop.ozone.om.helpers.OmBucketArgs;
+import org.apache.hadoop.ozone.om.helpers.OmBucketInfo;
+    .CreateBucketRequest;
+import org.apache.hadoop.ozone.protocol.proto.OzoneManagerProtocolProtos
+    .CreateBucketResponse;
+import org.apache.hadoop.ozone.protocol.proto.OzoneManagerProtocolProtos
+    .DeleteBucketRequest;
+import org.apache.hadoop.ozone.protocol.proto.OzoneManagerProtocolProtos
+    .DeleteBucketResponse;
+import org.apache.hadoop.ozone.protocol.proto.OzoneManagerProtocolProtos
+    .SetBucketPropertyRequest;
+import org.apache.hadoop.ozone.protocol.proto.OzoneManagerProtocolProtos
+    .SetBucketPropertyResponse;
+import org.apache.hadoop.ozone.protocol.proto.OzoneManagerProtocolProtos
+    case CreateBucket:
+      newOmRequest = handleCreateBucketStart(omRequest);
+      break;
+    case SetBucketProperty:
+      newOmRequest = handleSetBucketPropertyStart(omRequest);
+      break;
+    case DeleteBucket:
+      newOmRequest = handleDeleteBucketRequestStart(omRequest);
+      break;
+      case CreateBucket:
+        responseBuilder.setCreateBucketResponse(
+            handleCreateBucketApply(omRequest));
+        break;
+      case SetBucketProperty:
+        responseBuilder.setSetBucketPropertyResponse(
+            handleSetBucketPropertyApply(omRequest));
+        break;
+      case DeleteBucket:
+        responseBuilder.setDeleteBucketResponse(
+            handleDeleteBucketApply(omRequest));
+        break;
+  private OMRequest handleCreateBucketStart(OMRequest omRequest)
+      throws IOException {
+
+    CreateBucketRequest createBucketRequest =
+        omRequest.getCreateBucketRequest();
+
+    OmBucketInfo omBucketInfo =
+        getOzoneManagerServerProtocol().startCreateBucket(
+        OmBucketInfo.getFromProtobuf(createBucketRequest.getBucketInfo()));
+
+    CreateBucketRequest newCreateBucketRequest =
+        CreateBucketRequest.newBuilder().setBucketInfo(
+            omBucketInfo.getProtobuf()).build();
+    return omRequest.toBuilder().setCreateBucketRequest(newCreateBucketRequest)
+        .build();
+
+  }
+
+
+  private CreateBucketResponse handleCreateBucketApply(OMRequest omRequest)
+      throws IOException {
+    CreateBucketRequest createBucketRequest =
+        omRequest.getCreateBucketRequest();
+
+    getOzoneManagerServerProtocol().applyCreateBucket(
+        OmBucketInfo.getFromProtobuf(createBucketRequest.getBucketInfo()));
+
+    return CreateBucketResponse.newBuilder().build();
+  }
+
+
+  private OMRequest handleDeleteBucketRequestStart(OMRequest omRequest)
+      throws IOException {
+
+    DeleteBucketRequest deleteBucketRequest =
+        omRequest.getDeleteBucketRequest();
+    getOzoneManagerServerProtocol().startDeleteBucket(
+        deleteBucketRequest.getVolumeName(),
+        deleteBucketRequest.getBucketName());
+
+    return omRequest;
+  }
+
+  private DeleteBucketResponse handleDeleteBucketApply(OMRequest omRequest)
+      throws IOException {
+
+    DeleteBucketRequest deleteBucketRequest =
+        omRequest.getDeleteBucketRequest();
+
+    getOzoneManagerServerProtocol().applyDeleteBucket(
+        deleteBucketRequest.getVolumeName(),
+        deleteBucketRequest.getBucketName());
+
+    return DeleteBucketResponse.newBuilder().build();
+  }
+
+  private OMRequest handleSetBucketPropertyStart(
+      OMRequest omRequest) throws IOException {
+    SetBucketPropertyRequest setBucketPropertyRequest =
+        omRequest.getSetBucketPropertyRequest();
+
+    OmBucketInfo omBucketInfo =
+        getOzoneManagerServerProtocol().startSetBucketProperty(
+        OmBucketArgs.getFromProtobuf(setBucketPropertyRequest.getBucketArgs()));
+
+    SetBucketPropertyRequest newSetBucketPropertyRequest =
+        SetBucketPropertyRequest.newBuilder()
+            .setBucketInfo(omBucketInfo.getProtobuf()).build();
+
+    return omRequest.toBuilder().setSetBucketPropertyRequest(
+        newSetBucketPropertyRequest).build();
+  }
+
+  private SetBucketPropertyResponse handleSetBucketPropertyApply(
+      OMRequest omRequest) throws IOException {
+    SetBucketPropertyRequest setBucketPropertyRequest =
+        omRequest.getSetBucketPropertyRequest();
+
+    getOzoneManagerServerProtocol().applySetBucketProperty(
+        OmBucketInfo.getFromProtobuf(setBucketPropertyRequest.getBucketInfo()));
+
+    return SetBucketPropertyResponse.newBuilder().build();
+  }
+
+
+
