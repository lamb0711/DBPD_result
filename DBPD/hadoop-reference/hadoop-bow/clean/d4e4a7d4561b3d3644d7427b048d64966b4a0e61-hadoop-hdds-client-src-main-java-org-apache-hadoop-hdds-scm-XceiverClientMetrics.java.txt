HDDS-1317. KeyOutputStream#write throws ArrayIndexOutOfBoundsException when running RandomWrite MR examples. Contributed by Shashikant Banerjee.

+import com.google.common.annotations.VisibleForTesting;
+  private @Metric MutableCounterLong totalOps;
+  private MutableCounterLong[] opsArray;
+    this.opsArray = new MutableCounterLong[numEnumEntries];
+      opsArray[i] = registry
+          .newCounter("opCount" + ContainerProtos.Type.forNumber(i + 1),
+              "number of" + ContainerProtos.Type.forNumber(i + 1) + " ops",
+              (long) 0);
+    totalOps.incr();
+    opsArray[type.ordinal()].incr();
+  @VisibleForTesting
+  public long getTotalOpCount() {
+    return totalOps.value();
+  }
+
+  @VisibleForTesting
+  public long getContainerOpCountMetrics(ContainerProtos.Type type) {
+    return opsArray[type.ordinal()].value();
+  }
+
