HDFS-11469. Ozone: SCM: Container allocation based on node report. Contributed by Xiaoyu Yao.

+import org.apache.commons.io.IOUtils;
+import org.apache.hadoop.scm.client.ScmClient;
-  /** SCM mxbean*/
+  /** SCM mxbean. */
-    return scmContainerManager.allocateContainer(containerName);
+    return scmContainerManager.allocateContainer(containerName,
+        ScmClient.ReplicationFactor.ONE);
+  }
+
+  /**
+   * Asks SCM where a container should be allocated. SCM responds with the set
+   * of datanodes that should be used creating this container.
+   *
+   * @param containerName - Name of the container.
+   * @param replicationFactor - replication factor.
+   * @return Pipeline.
+   * @throws IOException
+   */
+  @Override
+  public Pipeline allocateContainer(String containerName,
+      ScmClient.ReplicationFactor replicationFactor) throws IOException {
+    return scmContainerManager.allocateContainer(containerName,
+        replicationFactor);
+    IOUtils.closeQuietly(scmContainerManager);
