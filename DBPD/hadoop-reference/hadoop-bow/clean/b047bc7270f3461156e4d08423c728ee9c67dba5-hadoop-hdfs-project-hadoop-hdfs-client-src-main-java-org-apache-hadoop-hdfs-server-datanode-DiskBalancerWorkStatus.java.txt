HDFS-10560. DiskBalancer: Reuse ObjectMapper instance to improve the performance. Contributed by Yiqun Lin.

+import org.codehaus.jackson.map.ObjectReader;
+  private static final ObjectMapper MAPPER = new ObjectMapper();
+  private static final ObjectMapper MAPPER_WITH_INDENT_OUTPUT =
+      new ObjectMapper().enable(
+          SerializationConfig.Feature.INDENT_OUTPUT);
+  private static final ObjectReader READER_WORKSTATUS =
+      new ObjectMapper().reader(DiskBalancerWorkStatus.class);
+  private static final ObjectReader READER_WORKENTRY = new ObjectMapper()
+      .reader(defaultInstance().constructCollectionType(List.class,
+          DiskBalancerWorkEntry.class));
-    ObjectMapper mapper = new ObjectMapper();
-    this.currentState = mapper.readValue(currentState,
-        defaultInstance().constructCollectionType(
-            List.class, DiskBalancerWorkEntry.class));
+    this.currentState = READER_WORKENTRY.readValue(currentState);
-    ObjectMapper mapper = new ObjectMapper();
-    mapper.enable(SerializationConfig.Feature.INDENT_OUTPUT);
-    return mapper.writeValueAsString(currentState);
+    return MAPPER_WITH_INDENT_OUTPUT.writeValueAsString(currentState);
-    ObjectMapper mapper = new ObjectMapper();
-    return mapper.writeValueAsString(this);
-
+    return MAPPER.writeValueAsString(this);
-    ObjectMapper mapper = new ObjectMapper();
-    return mapper.readValue(json, DiskBalancerWorkStatus.class);
+    return READER_WORKSTATUS.readValue(json);
