HDFS-7864. Erasure Coding: Update safemode calculation for striped blocks. Contributed by GAO Rui.

+    final int minStorage = curBlock.isStriped() ?
+        ((BlockInfoStriped) curBlock).getDataBlockNum() : minReplication;
-        Math.min(numNodes, minReplication));
+        Math.min(numNodes, minStorage), curBlock);
-          namesystem.incrementSafeBlockCount(numOfReplicas);
+          namesystem.incrementSafeBlockCount(numOfReplicas, storedBlock);
-      namesystem.incrementSafeBlockCount(numCurrentReplica);
+      namesystem.incrementSafeBlockCount(numCurrentReplica, storedBlock);
-   * @return the block that is stored in blockMap.
+   * @return the block that is stored in blocksMap.
-      namesystem.incrementSafeBlockCount(numCurrentReplica);
+      namesystem.incrementSafeBlockCount(numCurrentReplica, storedBlock);
