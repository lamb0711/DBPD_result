HDDS-1054. List Multipart uploads in a bucket (#1277)


+import org.apache.hadoop.ozone.client.OzoneMultipartUploadList;
-
+      @QueryParam("uploads") String uploads,
+    if (uploads != null) {
+      return listMultipartUploads(bucketName, prefix);
+    }
+
+  public Response listMultipartUploads(
+      @PathParam("bucket") String bucketName,
+      @QueryParam("prefix") String prefix)
+      throws OS3Exception, IOException {
+
+    OzoneBucket bucket = getBucket(bucketName);
+
+    OzoneMultipartUploadList ozoneMultipartUploadList =
+        bucket.listMultipartUploads(prefix);
+
+    ListMultipartUploadsResult result = new ListMultipartUploadsResult();
+    result.setBucket(bucketName);
+
+    ozoneMultipartUploadList.getUploads().forEach(upload -> result.addUpload(
+        new ListMultipartUploadsResult.Upload(
+            upload.getKeyName(),
+            upload.getUploadId(),
+            upload.getCreationTime(),
+            S3StorageType.fromReplicationType(upload.getReplicationType(),
+                upload.getReplicationFactor())
+        )));
+    return Response.ok(result).build();
+  }
