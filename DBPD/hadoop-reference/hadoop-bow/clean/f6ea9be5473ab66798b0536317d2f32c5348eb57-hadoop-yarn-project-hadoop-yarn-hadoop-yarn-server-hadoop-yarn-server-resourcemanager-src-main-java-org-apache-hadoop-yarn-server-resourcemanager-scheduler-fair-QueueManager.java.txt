YARN-5264. Store all queue-specific information in FSQueue. (Yufei Gu via kasha)

+    rootQueue.init();
-    
+
-  
+
-
-        try {
-          leafQueue.setPolicy(queueConf.getDefaultSchedulingPolicy());
-        } catch (AllocationConfigurationException ex) {
-          LOG.warn("Failed to set default scheduling policy "
-              + queueConf.getDefaultSchedulingPolicy()
-              + " on new leaf queue.", ex);
-        }
-
-
-        try {
-          newParent.setPolicy(queueConf.getDefaultSchedulingPolicy());
-        } catch (AllocationConfigurationException ex) {
-          LOG.warn("Failed to set default scheduling policy "
-              + queueConf.getDefaultSchedulingPolicy()
-              + " on new parent queue.", ex);
-        }
-
+      queue.init();
-      Resource maxChild = queueConf.getMaxChildResources(parent.getName());
+      Resource maxChild = parent.getMaxChildQueueResource();
-        queueConf.setMaxResources(child.getName(), maxChild);
+        child.setMaxShare(maxChild);
-      // Update queue metrics
-      FSQueueMetrics queueMetrics = queue.getMetrics();
-      queueMetrics.setMinShare(queue.getMinShare());
-      queueMetrics.setMaxShare(queue.getMaxShare());
-      // Set scheduling policies and update queue metrics
-      try {
-        SchedulingPolicy policy = queueConf.getSchedulingPolicy(queue.getName());
-        policy.initialize(scheduler.getClusterResource());
-        queue.setPolicy(policy);
-
-        queueMetrics.setMaxApps(queueConf.getQueueMaxApps(queue.getName()));
-        queueMetrics.setSchedulingPolicy(policy.getName());
-      } catch (AllocationConfigurationException ex) {
-        LOG.warn("Cannot apply configured scheduling policy to queue "
-            + queue.getName(), ex);
-      }
+      queue.init();
