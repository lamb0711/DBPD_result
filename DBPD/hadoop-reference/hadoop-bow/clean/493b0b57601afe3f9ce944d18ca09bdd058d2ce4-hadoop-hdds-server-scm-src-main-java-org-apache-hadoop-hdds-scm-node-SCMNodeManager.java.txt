HDDS-1787. NPE thrown while trying to find DN closest to client. Contributed by Sammi Chen. (#1094)


+import org.apache.hadoop.hdds.scm.net.InnerNode;
-    LOG.debug("Get node for {} return {}", address, (node == null ?
-        "not found" : node.getNetworkFullPath()));
-    return node == null ? null : (DatanodeDetails)node;
+
+    if (node != null) {
+      if (node instanceof InnerNode) {
+        LOG.warn("Get node for {} return {}, it's an inner node, " +
+            "not a datanode", address, node.getNetworkFullPath());
+      } else {
+        LOG.debug("Get node for {} return {}", address,
+            node.getNetworkFullPath());
+        return (DatanodeDetails)node;
+      }
+    } else {
+      LOG.warn("Cannot find node for {}", address);
+    }
+    return null;
