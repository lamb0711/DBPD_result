YARN-2468. Enhanced NodeManager to support log handling APIs (YARN-2569) for use by long running services. Contributed by Xuan Gong.

+import org.apache.hadoop.yarn.api.records.LogAggregationContext;
-
+import com.google.common.annotations.VisibleForTesting;
+  Path getRemoteAppLogDir(ApplicationId appId, String user) {
+    return LogAggregationUtils.getRemoteAppLogDir(this.remoteRootLogDir, appId,
+        user, this.remoteRootLogDirSuffix);
+  }
+
+
-      Map<ApplicationAccessType, String> appAcls) {
+      Map<ApplicationAccessType, String> appAcls,
+      LogAggregationContext logAggregationContext) {
-      initAppAggregator(appId, user, credentials, logRetentionPolicy, appAcls);
+      initAppAggregator(appId, user, credentials, logRetentionPolicy, appAcls,
+          logAggregationContext);
-      Map<ApplicationAccessType, String> appAcls) {
+      Map<ApplicationAccessType, String> appAcls,
+      LogAggregationContext logAggregationContext) {
-            appAcls);
+            appAcls, logAggregationContext, this.context);
-            appStartEvent.getApplicationAcls());
+            appStartEvent.getApplicationAcls(),
+            appStartEvent.getLogAggregationContext());
+
+  @VisibleForTesting
+  public ConcurrentMap<ApplicationId, AppLogAggregator> getAppLogAggregators() {
+    return this.appLogAggregators;
+  }
+
+  @VisibleForTesting
+  public NodeId getNodeId() {
+    return this.nodeId;
+  }
