HDFS-11469. Ozone: SCM: Container allocation based on node report. Contributed by Xiaoyu Yao.

+import org.apache.hadoop.scm.client.ScmClient;
+    return allocateContainer(containerName, ScmClient.ReplicationFactor.ONE);
+  }
+
+  /**
+   * Asks SCM where a container should be allocated. SCM responds with the set
+   * of datanodes that should be used creating this container. Ozone/SCM only
+   * supports replication factor of either 1 or 3.
+   *
+   * @param containerName - Name of the container.
+   * @param replicationFactor - replication factor.
+   * @return Pipeline.
+   * @throws IOException
+   */
+  @Override
+  public Pipeline allocateContainer(String containerName,
+      ScmClient.ReplicationFactor replicationFactor) throws IOException {
-
-        .setContainerName(containerName).build();
+        .setContainerName(containerName).setReplicationFactor(PBHelperClient
+            .convertReplicationFactor(replicationFactor)).build();
-    final  ContainerResponseProto response;
+    final ContainerResponseProto response;
