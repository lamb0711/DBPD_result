HADOOP-7013. Add boolean field isCorrupt to BlockLocation. Contributed by Patrick Kling.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1035923 13f79535-47bb-0310-9956-ffa450edef68

+  private boolean corrupt;
+    this(names, hosts, offset, length, false);
+  }
+
+  /**
+   * Constructor with host, name, offset, length and corrupt flag
+   */
+  public BlockLocation(String[] names, String[] hosts, long offset, 
+                       long length, boolean corrupt) {
+    this.corrupt = corrupt;
-    this(names, hosts, offset, length);
+    this(names, hosts, topologyPaths, offset, length, false);
+  }
+
+  /**
+   * Constructor with host, name, network topology, offset, length 
+   * and corrupt flag
+   */
+  public BlockLocation(String[] names, String[] hosts, String[] topologyPaths,
+                       long offset, long length, boolean corrupt) {
+    this(names, hosts, offset, length, corrupt);
-  
+
+  /**
+   * Get the corrupt flag.
+   */
+  public boolean isCorrupt() {
+    return corrupt;
+  }
+
+   * Set the corrupt flag.
+   */
+  public void setCorrupt(boolean corrupt) {
+    this.corrupt = corrupt;
+  }
+
+  /**
+    out.writeBoolean(corrupt);
+    this.corrupt = in.readBoolean();
+    if (corrupt) {
+      result.append("(corrupt)");
+    }
