HDDS-656. Add logic for pipeline report and action processing in new pipeline code. Contributed by Lokesh Jain.

-import org.apache.hadoop.hdds.protocol.proto.HddsProtos.LifeCycleState;
+import org.apache.hadoop.hdds.scm.XceiverClientRatis;
+import org.apache.hadoop.hdds.scm.pipeline.Pipeline.PipelineState;
+  private final Configuration conf;
-      PipelineStateManager stateManager) {
+      PipelineStateManager stateManager, Configuration conf) {
+    this.conf = conf;
-    stateManager.getPipelines(ReplicationType.RATIS)
+    stateManager.getPipelinesByType(ReplicationType.RATIS)
-    return Pipeline.newBuilder()
+    Pipeline pipeline = Pipeline.newBuilder()
-        .setState(LifeCycleState.ALLOCATED)
+        .setState(PipelineState.ALLOCATED)
+    initializePipeline(pipeline);
+    return pipeline;
-        .setState(LifeCycleState.ALLOCATED)
+        .setState(PipelineState.ALLOCATED)
+
+  private void initializePipeline(Pipeline pipeline)
+      throws IOException {
+    // TODO: remove old code in XceiverClientRatis#newXceiverClientRatis
+    try (XceiverClientRatis client =
+        XceiverClientRatis.newXceiverClientRatis(pipeline, conf)) {
+      client.createPipeline();
+    }
+  }
