Merge branch 'trunk' into HDFS-6584

-  private int epoch = 0;
+  private long epoch = 0L;
-  public synchronized int getAndIncrementEpoch() throws Exception {
-    int currentEpoch = epoch;
+  public synchronized long getAndIncrementEpoch() throws Exception {
+    long currentEpoch = epoch;
