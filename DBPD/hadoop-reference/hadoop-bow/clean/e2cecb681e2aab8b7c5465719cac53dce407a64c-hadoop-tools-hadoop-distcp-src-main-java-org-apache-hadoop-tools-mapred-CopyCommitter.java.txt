HADOOP-15850. CopyCommitter#concatFileChunks should check that the blocks per chunk is not 0. Contributed by Ted Yu.

Signed-off-by: Wei-Chiu Chuang <weichiu@apache.org>

+  private int blocksPerChunk = 0;
+    blocksPerChunk = context.getConfiguration().getInt(
+        DistCpOptionSwitch.BLOCKS_PER_CHUNK.getConfigLabel(), 0);
+    LOG.debug("blocks per chunk {}", blocksPerChunk);
-    concatFileChunks(conf);
+    if (blocksPerChunk > 0) {
+      concatFileChunks(conf);
+    }
