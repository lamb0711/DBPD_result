HADOOP-9151 Include RPC error info in RpcResponseHeader instead of sending it separately (sanjay Radia)


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1454593 13f79535-47bb-0310-9956-ffa450edef68

+    response.setServerIpcVersionNum(Server.CURRENT_VERSION);
-    } else {
-      if (status == RpcStatusProto.FATAL) {
-        response.setServerIpcVersionNum(Server.CURRENT_VERSION);
-      }
+    } else { // Rpc Failure
+      response.setExceptionClassName(errorClass);
+      response.setErrorMsg(error);
-      WritableUtils.writeString(out, errorClass);
-      WritableUtils.writeString(out, error);
