MAPREDUCE-3147. Handle leaf queues with the same name properly. (Ravi Prakash via mahadev)

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1211243 13f79535-47bb-0310-9956-ffa450edef68

-  private void initializeQueues(CapacitySchedulerConfiguration conf) {
+  private void initializeQueues(CapacitySchedulerConfiguration conf)
+    throws IOException {
-      QueueHook hook) {
+      QueueHook hook) throws IOException {
+    if(queue instanceof LeafQueue == true && queues.containsKey(queueName)
+      && queues.get(queueName) instanceof LeafQueue == true) {
+      throw new IOException("Two leaf queues were named " + queueName
+        + ". Leaf queue names must be distinct");
+    }
