HDFS-5542. Fix TODO and clean up the code in HDFS-2832. (Contributed by szetszwo)

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2832@1544664 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.commons.logging.Log;
-import org.apache.commons.logging.LogFactory;
-import org.apache.hadoop.classification.InterfaceAudience;
-import org.apache.hadoop.hdfs.StorageType;
-import org.apache.hadoop.hdfs.server.common.Util;
+import java.util.regex.Pattern;
-import static java.util.regex.Pattern.compile;
+import org.apache.hadoop.classification.InterfaceAudience;
+import org.apache.hadoop.hdfs.StorageType;
+import org.apache.hadoop.hdfs.server.common.Util;
-  public static final Log LOG = LogFactory.getLog(StorageLocation.class);
-  // Regular expression that describes a storage uri with a storage type.
-  // e.g. [Disk]/storages/storage1/
-  private static final String rawStringRegex = "^\\[(\\w*)\\](.+)$";
+  /** Regular expression that describes a storage uri with a storage type.
+   *  e.g. [Disk]/storages/storage1/
+   */
+  private static final Pattern regex = Pattern.compile("^\\[(\\w*)\\](.+)$");
-  StorageLocation(URI uri) {
-    this(StorageType.DISK, uri);
-  }
-
-  StorageLocation(StorageType storageType, URI uri) {
+  private StorageLocation(StorageType storageType, URI uri) {
-      throw new IllegalArgumentException(
-          "Got an Unsupported URI schema in " + uri + ". Ignoring ...");
+      throw new IllegalArgumentException("Unsupported URI schema in " + uri);
-  public URI getUri() {
+  URI getUri() {
-  public static StorageLocation parse(String rawLocation) throws IOException {
-    Matcher matcher = compile(rawStringRegex).matcher(rawLocation);
-    StorageType storageType = StorageType.DISK;
+  static StorageLocation parse(String rawLocation) throws IOException {
+    Matcher matcher = regex.matcher(rawLocation);
+    StorageType storageType = StorageType.DEFAULT;
-        try {
-          storageType = StorageType.valueOf(classString.toUpperCase());
-        } catch (RuntimeException re) {
-          LOG.error("Unable to parse storage type: " + re.toString() +
-                    ". Using the default storage type for directory " +
-                    location);
-        }
+        storageType = StorageType.valueOf(classString.toUpperCase());
+  @Override
-    return "[" + storageType.toString() + "]" + file.toURI().toString();
+    return "[" + storageType + "]" + file.toURI();
