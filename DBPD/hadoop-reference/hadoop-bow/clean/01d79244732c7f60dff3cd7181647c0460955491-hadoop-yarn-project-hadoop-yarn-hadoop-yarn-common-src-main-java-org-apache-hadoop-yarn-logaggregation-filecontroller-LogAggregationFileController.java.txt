YARN-9814. JobHistoryServer can't delete aggregated files, if remote app root directory is created by NodeManager. Contributed by Adam Antal.

-import org.apache.hadoop.yarn.exceptions.YarnException;
-        String primaryGroupName = null;
-        try {
-          primaryGroupName = loginUser.getPrimaryGroupName();
-        } catch (IOException e) {
-          LOG.warn("No primary group found. The remote root log directory" +
-              " will be created with the HDFS superuser being its group " +
-              "owner. JobHistoryServer may be unable to read the directory.");
+        String primaryGroupName = conf.get(
+            YarnConfiguration.NM_REMOTE_APP_LOG_DIR_GROUPNAME);
+        if (primaryGroupName == null || primaryGroupName.isEmpty()) {
+          try {
+            primaryGroupName = loginUser.getPrimaryGroupName();
+          } catch (IOException e) {
+            LOG.warn("No primary group found. The remote root log directory" +
+                    " will be created with the HDFS superuser being its " +
+                    "group owner. JobHistoryServer may be unable to read " +
+                    "the directory.");
+          }
+        } else {
+          if (LOG.isDebugEnabled()) {
+            LOG.debug("The group of remote root log directory has been " +
+                "determined by the configuration and set to " +
+                primaryGroupName);
+          }
