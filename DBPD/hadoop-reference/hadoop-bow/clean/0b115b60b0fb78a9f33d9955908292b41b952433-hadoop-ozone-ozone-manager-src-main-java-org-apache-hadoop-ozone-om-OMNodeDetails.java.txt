HDDS-1371. OMSnapshotProvider to download DB checkpoint from leader OM. (#703)


+import org.apache.commons.lang3.StringUtils;
+import org.apache.hadoop.http.HttpConfig;
+import static org.apache.hadoop.ozone.OzoneConsts.OM_RATIS_SNAPSHOT_BEFORE_DB_CHECKPOINT;
+import static org.apache.hadoop.ozone.OzoneConsts.OZONE_OM_DB_CHECKPOINT_HTTP_ENDPOINT;
+
+  private String httpAddress;
+  private String httpsAddress;
-      InetSocketAddress rpcAddr, int rpcPort, int ratisPort) {
+      InetSocketAddress rpcAddr, int rpcPort, int ratisPort,
+      String httpAddress, String httpsAddress) {
+    this.httpAddress = httpAddress;
+    this.httpsAddress = httpsAddress;
+    private String httpAddr;
+    private String httpsAddr;
+    public Builder setHttpAddress(String httpAddress) {
+      this.httpAddr = httpAddress;
+      return this;
+    }
+
+    public Builder setHttpsAddress(String httpsAddress) {
+      this.httpsAddr = httpsAddress;
+      return this;
+    }
+
-          ratisPort);
+          ratisPort, httpAddr, httpsAddr);
+
+  public String getOMDBCheckpointEnpointUrl(HttpConfig.Policy httpPolicy) {
+    if (httpPolicy.isHttpEnabled()) {
+      if (StringUtils.isNotEmpty(httpAddress)) {
+        return "http://" + httpAddress + OZONE_OM_DB_CHECKPOINT_HTTP_ENDPOINT
+            + "?" + OM_RATIS_SNAPSHOT_BEFORE_DB_CHECKPOINT + "=true";
+      }
+    } else {
+      if (StringUtils.isNotEmpty(httpsAddress)) {
+        return "https://" + httpsAddress + OZONE_OM_DB_CHECKPOINT_HTTP_ENDPOINT
+            + "?" + OM_RATIS_SNAPSHOT_BEFORE_DB_CHECKPOINT + "=true";
+      }
+    }
+    return null;
+  }
