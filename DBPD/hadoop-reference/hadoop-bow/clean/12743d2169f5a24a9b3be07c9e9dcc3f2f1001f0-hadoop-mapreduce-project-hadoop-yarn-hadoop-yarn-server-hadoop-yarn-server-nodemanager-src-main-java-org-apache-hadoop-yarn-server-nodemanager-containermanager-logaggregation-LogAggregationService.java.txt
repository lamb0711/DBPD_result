MAPREDUCE-2792. Replace usage of node ip-addresses with hostnames. Contributed by Vinod K V.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1178631 13f79535-47bb-0310-9956-ffa450edef68

-import java.net.InetSocketAddress;
-import org.apache.hadoop.net.NetUtils;
+import org.apache.hadoop.yarn.server.nodemanager.Context;
+  private final Context context;
-  public LogAggregationService(DeletionService deletionService) {
+  public LogAggregationService(Context context,
+      DeletionService deletionService) {
+    this.context = context;
-    String address =
-        getConfig().get(YarnConfiguration.NM_ADDRESS, YarnConfiguration.DEFAULT_NM_ADDRESS);
-    InetSocketAddress cmBindAddress = NetUtils.createSocketAddr(address);
-    try {
-      this.nodeFile =
-          InetAddress.getLocalHost().getHostAddress() + "_"
-              + cmBindAddress.getPort();
-    } catch (UnknownHostException e) {
-      throw new YarnException(e);
-    }
+    // NodeId is only available during start, the following cannot be moved
+    // anywhere else.
+    this.nodeFile = this.context.getNodeId().toString();
