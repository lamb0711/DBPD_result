HDFS-8823. Move replication factor into individual blocks. Contributed by Haohui Mai.

+    FSNamesystem fsn = fsd.getFSNamesystem();
-        fsd.getFSNamesystem().removeSnapshottableDirs(snapshottableDirs);
+        fsd.updateReplicationFactor(context.collectedBlocks()
+                                        .toUpdateReplicationInfo());
+        fsn.removeSnapshottableDirs(snapshottableDirs);
