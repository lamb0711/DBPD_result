HDDS-1649. On installSnapshot notification from OM leader, download checkpoint and reload OM state (#948)


-   * Returns OzoneManager StateMachine.
+   * Initializes and returns OzoneManager StateMachine.
-    return  new OzoneManagerStateMachine(this);
+    return new OzoneManagerStateMachine(this);
+  }
+
+  @VisibleForTesting
+  public OzoneManagerStateMachine getOmStateMachine() {
+    return omStateMachine;
+    RaftServerConfigKeys.Log.Appender.setInstallSnapshotEnabled(properties,
+        false);
+    final int logPurgeGap = conf.getInt(
+        OMConfigKeys.OZONE_OM_RATIS_LOG_PURGE_GAP,
+        OMConfigKeys.OZONE_OM_RATIS_LOG_PURGE_GAP_DEFAULT);
+    RaftServerConfigKeys.Log.setPurgeGap(properties, logPurgeGap);
