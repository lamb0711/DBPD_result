YARN-7142. Support placement policy in yarn native services. (Gour Saha via wangda)

Change-Id: I166c67a7a34430627c17365f60bac75b6da1b434

-import org.apache.hadoop.yarn.service.api.records.Service;
+import org.apache.hadoop.yarn.service.api.records.PlacementConstraint;
+import org.apache.hadoop.yarn.service.api.records.Service;
-import org.apache.hadoop.yarn.service.provider.AbstractClientProvider;
-import org.apache.hadoop.yarn.service.provider.ProviderFactory;
-import org.apache.hadoop.yarn.service.monitor.probe.MonitorUtils;
+import org.apache.hadoop.yarn.service.monitor.probe.MonitorUtils;
+import org.apache.hadoop.yarn.service.provider.AbstractClientProvider;
+import org.apache.hadoop.yarn.service.provider.ProviderFactory;
+    validatePlacementPolicy(service.getComponents(), componentNames);
+  private static void validatePlacementPolicy(List<Component> components,
+      Set<String> componentNames) {
+    for (Component comp : components) {
+      if (comp.getPlacementPolicy() != null) {
+        for (PlacementConstraint constraint : comp.getPlacementPolicy()
+            .getConstraints()) {
+          for (String targetTag : constraint.getTargetTags()) {
+            if (!comp.getName().equals(targetTag)) {
+              throw new IllegalArgumentException(String.format(
+                  RestApiErrorMessages.ERROR_PLACEMENT_POLICY_TAG_NAME_NOT_SAME,
+                  targetTag, comp.getName(), comp.getName(), comp.getName()));
+            }
+          }
+        }
+      }
+    }
+  }
+
