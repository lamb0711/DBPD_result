HDFS-11778. Ozone: KSM: add getBucketInfo. Contributed by Nandakumar Vadivelu.

+import org.apache.hadoop.hdfs.protocolPB.PBHelperClient;
-import org.apache.hadoop.ksm.helpers.KsmBucketArgs;
+import org.apache.hadoop.ksm.helpers.KsmBucketInfo;
+import java.util.stream.Collectors;
-    KsmBucketArgs.Builder builder = KsmBucketArgs.newBuilder();
-    args.getAddAcls().forEach(acl ->
-        builder.addAddAcl(KSMPBHelper.convertOzoneAcl(acl)));
-    args.getRemoveAcls().forEach(acl ->
-        builder.addRemoveAcl(KSMPBHelper.convertOzoneAcl(acl)));
+    KsmBucketInfo.Builder builder = KsmBucketInfo.newBuilder();
-        .setBucketName(args.getBucketName())
-        .setIsVersionEnabled(getBucketVersioningProtobuf(
-            args.getVersioning()))
-        .setStorageType(args.getStorageType());
+        .setBucketName(args.getBucketName());
+    if(args.getAddAcls() != null) {
+      builder.setAcls(args.getAddAcls().stream().map(
+          KSMPBHelper::convertOzoneAcl).collect(Collectors.toList()));
+    }
+    if(args.getStorageType() != null) {
+      builder.setStorageType(PBHelperClient.convertStorageType(
+          args.getStorageType()));
+    }
+    if(args.getVersioning() != null) {
+      builder.setIsVersionEnabled(getBucketVersioningProtobuf(
+          args.getVersioning()));
+    }
-      throws IOException, OzoneException {
-    String containerKey = buildContainerKey(args.getVolumeName(),
-        args.getBucketName());
-    XceiverClientSpi xceiverClient = acquireXceiverClient(containerKey);
-    try {
-      KeyData containerKeyData = containerKeyDataForRead(
-          xceiverClient.getPipeline().getContainerName(), containerKey);
-      GetKeyResponseProto response = getKey(xceiverClient, containerKeyData,
-          args.getRequestID());
-      return fromContainerKeyValueListToBucket(
-          response.getKeyData().getMetadataList());
-    } finally {
-      xceiverClientManager.releaseClient(xceiverClient);
+      throws IOException {
+    String volumeName = args.getVolumeName();
+    String bucketName = args.getBucketName();
+    KsmBucketInfo ksmBucketInfo = keySpaceManagerClient.getBucketInfo(
+        volumeName, bucketName);
+    BucketInfo bucketInfo = new BucketInfo(ksmBucketInfo.getVolumeName(),
+        ksmBucketInfo.getBucketName());
+    if(ksmBucketInfo.getIsVersionEnabled()) {
+      bucketInfo.setVersioning(Versioning.ENABLED);
+    } else {
+      bucketInfo.setVersioning(Versioning.DISABLED);
+    bucketInfo.setStorageType(PBHelperClient.convertStorageType(
+        ksmBucketInfo.getStorageType()));
+    bucketInfo.setAcls(ksmBucketInfo.getAcls().stream().map(
+        KSMPBHelper::convertOzoneAcl).collect(Collectors.toList()));
+    return bucketInfo;
