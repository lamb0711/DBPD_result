Merge branch 'HDFS-12943' into trunk

+    // TODO: we should probably have a separate state OBSERVER for RBF and
+    // treat it differently.
+    case OBSERVER:
