HDFS-9314. Improve BlockPlacementPolicyDefault's picking of excess replicas. (Xiao Chen via mingma)

-   *         Note that this is different from BlockPlacementPolicyDefault which
-   *       will keep the # of racks after deletion. With upgrade domain policy,
-   *       given # of racks is still >= 2 after deletion, the data availability
-   *       model remains the same as BlockPlacementPolicyDefault (only supports
-   *       one rack failure).
+   *         Note that this is similar to BlockPlacementPolicyDefault which
+   *       will at most reduce the # of racks by 1, and never reduce it to < 2.
+   *       With upgrade domain policy, given # of racks is still >= 2 after
+   *       deletion, the data availability model remains the same as
+   *       BlockPlacementPolicyDefault (only supports one rack failure).
-   *       With BlockPlacementPolicyDefault policy, the remaining replicas
-   *       after deletion are {d1, d2, d3(or d4)} which has 3 racks.
+   *       With BlockPlacementPolicyDefault policy, any of the 4 with the worst
+   *       condition will be deleted, which in worst case has 2 racks remain.
-      Collection<DatanodeStorageInfo> exactlyOne) {
+      Collection<DatanodeStorageInfo> exactlyOne,
+      Map<String, List<DatanodeStorageInfo>> rackMap) {
-      return super.pickupReplicaSet(moreThanOne, exactlyOne);
+      return super.pickupReplicaSet(moreThanOne, exactlyOne, rackMap);
