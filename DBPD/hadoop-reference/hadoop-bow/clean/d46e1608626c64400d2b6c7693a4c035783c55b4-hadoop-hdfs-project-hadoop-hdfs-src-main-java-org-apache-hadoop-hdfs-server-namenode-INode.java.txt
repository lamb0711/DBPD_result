HDFS-4877. Snapshot: fix the scenario where a directory is renamed under its prior descendant. Contributed by Jing Zhao.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1490421 13f79535-47bb-0310-9956-ffa450edef68

-   *          inodeMap         
+   *          inodeMap
-      List<INode> removedINodes) throws QuotaExceededException;
+      List<INode> removedINodes, boolean countDiffChange)
+      throws QuotaExceededException;
-  public void addSpaceConsumed(long nsDelta, long dsDelta, boolean verify,
-      int snapshotId) throws QuotaExceededException {
+  public void addSpaceConsumed(long nsDelta, long dsDelta, boolean verify) 
+      throws QuotaExceededException {
-      parent.addSpaceConsumed(nsDelta, dsDelta, verify, snapshotId);
-    }
-  }
-
-  public void addSpaceConsumedToRenameSrc(long nsDelta, long dsDelta,
-      boolean verify, int snapshotId) throws QuotaExceededException {
-    if (parent != null) {
-      parent.addSpaceConsumedToRenameSrc(nsDelta, dsDelta, verify, snapshotId);
+      parent.addSpaceConsumed(nsDelta, dsDelta, verify);
