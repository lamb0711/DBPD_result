HDFS-14010. Pass correct DF usage to ReservedSpaceCalculator builder. Contributed by Virajith Jalaparti.

+    if (this.usage != null) {
+      reserved = new ReservedSpaceCalculator.Builder(conf)
+          .setUsage(this.usage).setStorageType(storageType).build();
+    } else {
+      reserved = null;
+      LOG.warn("Setting reserved to null as usage is null");
+    }
-    this.reserved = new ReservedSpaceCalculator.Builder(conf)
-        .setUsage(usage).setStorageType(storageType).build();
-    return reserved.getReserved();
+    return reserved != null ? reserved.getReserved() : 0;
