HDFS-12299. Race Between update pipeline and DN Re-Registration

-  private void updatePipeline(long newGS) throws IOException {
+  @VisibleForTesting
+  public void updatePipeline(long newGS) throws IOException {
