HDFS-8823. Move replication factor into individual blocks. Contributed by Haohui Mai.

-import org.apache.hadoop.hdfs.protocol.Block;
-    final int numExpected = bc.getPreferredBlockReplication();
+    final int numExpected = block.getReplication();
-    if (!blockManager.isNeededReplication(block, numExpected, numLive)) {
+    if (!blockManager.isNeededReplication(block, numLive)) {
-  private static void logBlockReplicationInfo(Block block, BlockCollection bc,
+  private static void logBlockReplicationInfo(BlockInfo block,
+      BlockCollection bc,
-    int curExpectedReplicas = bc.getPreferredBlockReplication();
+    int curExpectedReplicas = block.getReplication();
-        if (blockManager.isNeededReplication(block,
-            bc.getPreferredBlockReplication(), liveReplicas)) {
+        if (blockManager.isNeededReplication(block, liveReplicas)) {
-                bc.getPreferredBlockReplication());
+                block.getReplication());
