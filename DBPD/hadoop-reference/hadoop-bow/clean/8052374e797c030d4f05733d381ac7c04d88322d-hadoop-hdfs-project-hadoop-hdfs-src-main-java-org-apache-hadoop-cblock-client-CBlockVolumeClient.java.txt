Block Storage: volume creation times out while creating 3TB volume because of too many containers. Contributed by Mukul Kumar Singh.

+import org.apache.hadoop.cblock.CBlockConfigKeys;
-  private final OzoneConfiguration conf;
-    this.conf = conf;
-    long version = RPC.getProtocolVersion(CBlockServiceProtocolPB.class);
-    InetSocketAddress address = OzoneClientUtils.getCblockServiceRpcAddr(conf);
-    // currently the largest supported volume is about 8TB, which might take
-    // > 20 seconds to finish creating containers. thus set timeout to 30 sec.
-    cblockClient = new CBlockServiceProtocolClientSideTranslatorPB(
-        RPC.getProtocolProxy(CBlockServiceProtocolPB.class, version,
-            address, UserGroupInformation.getCurrentUser(), conf,
-            NetUtils.getDefaultSocketFactory(conf), 30000, RetryPolicies
-                .retryUpToMaximumCountWithFixedSleep(300, 1, TimeUnit
-                    .SECONDS)).getProxy());
+    this(conf, null);
-    this.conf = conf;
+    InetSocketAddress address = serverAddress != null ? serverAddress :
+        OzoneClientUtils.getCblockServiceRpcAddr(conf);
+    int rpcTimeout =
+        conf.getInt(CBlockConfigKeys.DFS_CBLOCK_RPC_TIMEOUT_SECONDS,
+        CBlockConfigKeys.DFS_CBLOCK_RPC_TIMEOUT_SECONDS_DEFAULT) * 1000;
-            serverAddress, UserGroupInformation.getCurrentUser(), conf,
-            NetUtils.getDefaultSocketFactory(conf), 30000, RetryPolicies
-                .retryUpToMaximumCountWithFixedSleep(300, 1, TimeUnit
-                    .SECONDS)).getProxy());
+            address, UserGroupInformation.getCurrentUser(), conf,
+            NetUtils.getDefaultSocketFactory(conf), rpcTimeout, RetryPolicies
+                .retryUpToMaximumCountWithFixedSleep(
+                    300, 1, TimeUnit.SECONDS)).getProxy());
