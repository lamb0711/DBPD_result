HDFS-8232. Missing datanode counters when using Metrics2 sink interface. Contributed by Anu Engineer.

-import java.util.ArrayList;
-import java.util.Collection;
+import org.apache.hadoop.hdfs.server.datanode.metrics.DataNodeMetricHelper;
+import org.apache.hadoop.metrics2.MetricsCollector;
-import org.apache.hadoop.util.DiskChecker.DiskErrorException;
+  /**
+   * Get metrics from the metrics source
+   *
+   * @param collector to contain the resulting metrics snapshot
+   * @param all if true, return all metrics even if unchanged.
+   */
+  @Override
+  public void getMetrics(MetricsCollector collector, boolean all) {
+    try {
+      DataNodeMetricHelper.getMetrics(collector, this, "SimulatedFSDataset");
+    } catch (Exception e){
+        //ignore Exceptions
+    }
+  }
+
