HDFS-4914. Use DFSClient.Conf instead of Configuration.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1494854 13f79535-47bb-0310-9956-ffa450edef68

-  private final long prefetchSize;
-  private final int timeWindow;
-  private final int nCachedConnRetry;
-
-      dfsClient.conf.getInt(DFSConfigKeys.
-        DFS_CLIENT_READ_SHORTCIRCUIT_STREAMS_CACHE_SIZE_KEY,
-        DFSConfigKeys.DFS_CLIENT_READ_SHORTCIRCUIT_STREAMS_CACHE_SIZE_DEFAULT),
-      dfsClient.conf.getLong(DFSConfigKeys.
-        DFS_CLIENT_READ_SHORTCIRCUIT_STREAMS_CACHE_EXPIRY_MS_KEY,
-        DFSConfigKeys.DFS_CLIENT_READ_SHORTCIRCUIT_STREAMS_CACHE_EXPIRY_MS_DEFAULT));
-    prefetchSize = dfsClient.getConf().prefetchSize;
-    timeWindow = dfsClient.getConf().timeWindow;
-    nCachedConnRetry = dfsClient.getConf().nCachedConnRetry;
+        dfsClient.getConf().shortCircuitStreamsCacheSize,
+        dfsClient.getConf().shortCircuitStreamsCacheExpiryMs);
-    LocatedBlocks newInfo = dfsClient.getLocatedBlocks(src, 0, prefetchSize);
+    final LocatedBlocks newInfo = dfsClient.getLocatedBlocks(src, 0);
-        cdp = DFSUtil.createClientDatanodeProtocolProxy(
-            datanode, dfsClient.conf, dfsClient.getConf().socketTimeout,
+        cdp = DFSUtil.createClientDatanodeProtocolProxy(datanode,
+            dfsClient.getConfiguration(), dfsClient.getConf().socketTimeout,
-        LocatedBlocks newBlocks;
-        newBlocks = dfsClient.getLocatedBlocks(src, offset, prefetchSize);
+        final LocatedBlocks newBlocks = dfsClient.getLocatedBlocks(src, offset);
-    LocatedBlocks newBlocks;
-    newBlocks = dfsClient.getLocatedBlocks(src, offset, prefetchSize);
+    final LocatedBlocks newBlocks = dfsClient.getLocatedBlocks(src, offset);
-            chosenNode.getXferAddr(dfsClient.connectToDnViaHostname());
+            chosenNode.getXferAddr(dfsClient.getConf().connectToDnViaHostname);
+          final int timeWindow = dfsClient.getConf().timeWindow;
-      return new BlockReaderLocal(dfsClient.conf, file,
+      return new BlockReaderLocal(dfsClient.getConf(), file,
-        return BlockReaderFactory.getLegacyBlockReaderLocal(dfsClient.ugi,
-            dfsClient.conf, clientName, block, blockToken, chosenNode,
-            dfsClient.hdfsTimeout, startOffset,dfsClient.connectToDnViaHostname());
+        return BlockReaderFactory.getLegacyBlockReaderLocal(dfsClient,
+            clientName, block, blockToken, chosenNode, startOffset);
+    final int nCachedConnRetry = dfsClient.getConf().nCachedConnRetry;
-            dfsClient.conf, file, block, blockToken, startOffset,
+            dfsClient.getConf(), file, block, blockToken, startOffset,
-            dfsClient.conf, file, block, blockToken, startOffset,
+            dfsClient.getConf(), file, block, blockToken, startOffset,
-            dfsClient.conf, file, block, blockToken, startOffset,
+            dfsClient.getConf(), file, block, blockToken, startOffset,
-        dfsClient.conf, file, block, blockToken, startOffset,
+        dfsClient.getConf(), file, block, blockToken, startOffset,
