Merge trunk into HA branch


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1196458 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.concurrent.ThreadFactory;
+import org.apache.hadoop.mapred.JobACLsManager;
+import com.google.common.util.concurrent.ThreadFactoryBuilder;
+
-  private static final int DEFAULT_LOADEDJOB_CACHE_SIZE = 2000;
+  private static final int DEFAULT_LOADEDJOB_CACHE_SIZE = 5;
+  private JobACLsManager aclsMgr;
+  
-    
+    this.aclsMgr = new JobACLsManager(conf);
-    cleanerScheduledExecutor = new ScheduledThreadPoolExecutor(1);
+      cleanerScheduledExecutor = new ScheduledThreadPoolExecutor(1,
+          new ThreadFactoryBuilder().setNameFormat("LogCleaner").build()
+      );
+      ThreadFactory tf = new ThreadFactoryBuilder()
+        .setNameFormat("MoveIntermediateToDone Thread #%d")
+        .build();
-          TimeUnit.HOURS, new LinkedBlockingQueue<Runnable>());
+          TimeUnit.HOURS, new LinkedBlockingQueue<Runnable>(), tf);
-            metaInfo.getConfFile());
+            metaInfo.getConfFile(), this.aclsMgr);
