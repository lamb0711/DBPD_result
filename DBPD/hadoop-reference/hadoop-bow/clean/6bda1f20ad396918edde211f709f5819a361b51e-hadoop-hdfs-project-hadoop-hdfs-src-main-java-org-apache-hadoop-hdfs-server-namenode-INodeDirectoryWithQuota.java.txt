HDFS-4700. Fix the undo section of rename with snapshots.  Contributed by Jing Zhao


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1468632 13f79535-47bb-0310-9956-ffa450edef68

-  public final void addSpaceConsumed(final long nsDelta, final long dsDelta)
-      throws QuotaExceededException {
+  public final void addSpaceConsumed(final long nsDelta, final long dsDelta,
+      boolean verify) throws QuotaExceededException {
-      // (1) verify quota in this inode  
-      verifyQuota(nsDelta, dsDelta);
+      // (1) verify quota in this inode
+      if (verify) {
+        verifyQuota(nsDelta, dsDelta);
+      }
-      super.addSpaceConsumed(nsDelta, dsDelta);
+      super.addSpaceConsumed(nsDelta, dsDelta, verify);
-      super.addSpaceConsumed(nsDelta, dsDelta);
+      super.addSpaceConsumed(nsDelta, dsDelta, verify);
