YARN-759. Create Command enum in AllocateResponse (bikas)

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1490470 13f79535-47bb-0310-9956-ffa450edef68

-    if (allocateResponse.getResync()) {
-      LOG.info("Event from RM: shutting down Application Master");
-      // This can happen if the RM has been restarted. If it is in that state,
-      // this application must clean itself up.
-      eventHandler.handle(new JobEvent(this.getJob().getID(),
-                                       JobEventType.JOB_AM_REBOOT));
-      throw new YarnRuntimeException("Resource Manager doesn't recognize AttemptId: " +
-                               this.getContext().getApplicationID());
+    if (allocateResponse.getAMCommand() != null) {
+      switch(allocateResponse.getAMCommand()) {
+      case AM_RESYNC:
+      case AM_SHUTDOWN:
+        LOG.info("Event from RM: shutting down Application Master");
+        // This can happen if the RM has been restarted. If it is in that state,
+        // this application must clean itself up.
+        eventHandler.handle(new JobEvent(this.getJob().getID(),
+                                         JobEventType.JOB_AM_REBOOT));
+        throw new YarnRuntimeException("Resource Manager doesn't recognize AttemptId: " +
+                                 this.getContext().getApplicationID());
+      default:
+        String msg =
+              "Unhandled value of AMCommand: " + allocateResponse.getAMCommand();
+        LOG.error(msg);
+        throw new YarnRuntimeException(msg);
+      }
