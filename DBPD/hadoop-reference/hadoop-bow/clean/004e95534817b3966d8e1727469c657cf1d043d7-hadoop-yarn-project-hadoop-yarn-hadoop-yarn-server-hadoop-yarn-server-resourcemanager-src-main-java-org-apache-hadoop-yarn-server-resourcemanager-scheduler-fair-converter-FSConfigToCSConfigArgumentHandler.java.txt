YARN-10167. FS-CS Converter: Need to validate c-s.xml after converting. Contributed by Peter Bacsko

+  private ConvertedConfigValidator validator;
+    this.validator = new ConvertedConfigValidator();
-  FSConfigToCSConfigArgumentHandler(ConversionOptions conversionOptions) {
+  FSConfigToCSConfigArgumentHandler(ConversionOptions conversionOptions,
+      ConvertedConfigValidator validator) {
+    this.validator = validator;
+    SKIP_VERIFICATION("skip verification", "s",
+        "skip-verification",
+        "Skips the verification of the converted configuration", false),
+
+      String outputDir = converterParams.getOutputDirectory();
+      boolean skipVerification =
+          cliParser.hasOption(CliOption.SKIP_VERIFICATION.shortSwitch);
+      if (outputDir != null && !skipVerification) {
+        validator.validateConvertedConfig(
+            converterParams.getOutputDirectory());
+      }
+    } catch (VerificationException e) {
+      Throwable cause = e.getCause();
+      String msg = "Verification failed: " + e.getCause().getMessage();
+      conversionOptions.handleVerificationFailure(cause, msg);
+      retVal = -1;
-  static void logAndStdErr(Exception e, String msg) {
-    LOG.debug("Stack trace", e);
+  static void logAndStdErr(Throwable t, String msg) {
+    LOG.debug("Stack trace", t);
