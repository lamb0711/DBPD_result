HDFS-11339. Support File IO sampling for Datanode IO profiling hooks. Contributed by Hanisha Koneru.

+import org.apache.commons.logging.Log;
+import org.apache.commons.logging.LogFactory;
+import org.jboss.netty.util.internal.ThreadLocalRandom;
+  static final Log LOG = LogFactory.getLog(ProfilingFileIoEvents.class);
+  private final int sampleRangeMax;
+      double fileIOSamplingFraction = conf.getDouble(DFSConfigKeys
+              .DFS_DATANODE_FILEIO_PROFILING_SAMPLING_FRACTION_KEY,
+          DFSConfigKeys
+              .DFS_DATANODE_FILEIO_PROFILING_SAMPLING_FRACTION_DEAFULT);
+      if (fileIOSamplingFraction > 1) {
+        LOG.warn(DFSConfigKeys
+            .DFS_DATANODE_FILEIO_PROFILING_SAMPLING_FRACTION_KEY +
+            " value cannot be more than 1. Setting value to 1");
+        fileIOSamplingFraction = 1;
+      }
+      sampleRangeMax = (int) (fileIOSamplingFraction * Integer.MAX_VALUE);
+      sampleRangeMax = 0;
-    if (isEnabled) {
+    if (isEnabled && ThreadLocalRandom.current().nextInt() < sampleRangeMax) {
-    if (isEnabled) {
+    if (isEnabled && begin != 0) {
