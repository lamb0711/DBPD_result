HDFS-14545. RBF: Router should support GetUserMappingsProtocol. Contributed by Ayush Saxena.

-import org.apache.hadoop.security.Groups;
-import org.apache.hadoop.security.authorize.ProxyUsers;
+import org.apache.hadoop.tools.GetUserMappingsProtocol;
+import org.apache.hadoop.tools.proto.GetUserMappingsProtocolProtos;
+import org.apache.hadoop.tools.protocolPB.GetUserMappingsProtocolPB;
+import org.apache.hadoop.tools.protocolPB.GetUserMappingsProtocolServerSideTranslatorPB;
-public class RouterRpcServer extends AbstractService
-    implements ClientProtocol, NamenodeProtocol, RefreshUserMappingsProtocol {
+public class RouterRpcServer extends AbstractService implements ClientProtocol,
+    NamenodeProtocol, RefreshUserMappingsProtocol, GetUserMappingsProtocol {
+  /** Other protocol calls. */
+  private final RouterUserProtocol routerProto;
+    GetUserMappingsProtocolServerSideTranslatorPB getUserMappingXlator =
+        new GetUserMappingsProtocolServerSideTranslatorPB(this);
+    BlockingService getUserMappingService =
+        GetUserMappingsProtocolProtos.GetUserMappingsProtocolService.
+        newReflectiveBlockingService(getUserMappingXlator);
+
+    DFSUtil.addPBProtocol(conf, GetUserMappingsProtocolPB.class,
+        getUserMappingService, this.rpcServer);
+    this.routerProto = new RouterUserProtocol(this);
-    LOG.info("Refresh user groups mapping in Router.");
-    Groups.getUserToGroupsMappingService().refresh();
+    routerProto.refreshUserToGroupsMappings();
-    LOG.info("Refresh superuser groups configuration in Router.");
-    ProxyUsers.refreshSuperUserGroupsConfiguration();
+    routerProto.refreshSuperUserGroupsConfiguration();
+  }
+
+  @Override
+  public String[] getGroupsForUser(String user) throws IOException {
+    return routerProto.getGroupsForUser(user);
