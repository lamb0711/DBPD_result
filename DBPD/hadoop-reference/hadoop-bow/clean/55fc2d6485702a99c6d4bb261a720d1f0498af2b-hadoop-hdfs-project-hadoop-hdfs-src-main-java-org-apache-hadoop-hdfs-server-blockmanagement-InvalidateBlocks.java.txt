HDFS-12891. Do not invalidate blocks if toInvalidate is empty. Contributed by Zsolt Venczel.

-    if (toInvalidate.size() > 0 && getBlockSetsSize(dn) == 0) {
-      remove(dn);
+    if (toInvalidate.size() > 0) {
+      if (getBlockSetsSize(dn) == 0) {
+        remove(dn);
+      }
+      dn.addBlocksToBeInvalidated(toInvalidate);
-    dn.addBlocksToBeInvalidated(toInvalidate);
