HADOOP-15418. Hadoop KMSAuthenticationFilter needs to use getPropsByPrefix instead of iterator to avoid ConcurrentModificationException. Contributed by lqjack and Suma Shivaprasad

+import com.google.common.annotations.VisibleForTesting;
-    Properties props = new Properties();
+
-    for (Map.Entry<String, String> entry : conf) {
-      String name = entry.getKey();
-      if (name.startsWith(CONFIG_PREFIX)) {
-        String value = conf.get(name);
-        name = name.substring(CONFIG_PREFIX.length());
-        props.setProperty(name, value);
-      }
+    return getKMSConfiguration(conf);
+  }
+
+  @VisibleForTesting
+  Properties getKMSConfiguration(Configuration conf) {
+    Properties props = new Properties();
+
+    Map<String, String> propsWithPrefixMap = conf.getPropsWithPrefix(
+        CONFIG_PREFIX);
+
+    for (Map.Entry<String, String> entry : propsWithPrefixMap.entrySet()) {
+      props.setProperty(entry.getKey(), entry.getValue());
+
