HDFS-13211. Fix a bug in DirectoryDiffList.getMinListForRange.  Contributed by Shashikant Banerjee

+
+    @Override
+    public String toString() {
+      return "->" + skipTo;
+    }
+
+
+    @Override
+    public String toString() {
+      return diff != null ? "" + diff.getSnapshotId() : "?";
+    }
-  public static DirectoryDiffList createSkipList(int capacity, int interval,
-      int skipLevel) {
-    DirectoryDiffList list =
-        new DirectoryDiffList(capacity, interval, skipLevel);
-    return list;
-  }
-
-   * @param fromIndex index from where the summation has to start
-   * @param toIndex   index till where the summation has to end
+   * @param fromIndex index from where the summation has to start(inclusive)
+   * @param toIndex   index till where the summation has to end(exclusive)
-    final int toSnapshotId = get(toIndex).getSnapshotId();
+    final int toSnapshotId = get(toIndex - 1).getSnapshotId();
+      if (current.getDiff().compareTo(toSnapshotId) == 0) {
+        break;
+      }
+
+  @Override
+  public String toString() {
+    final StringBuilder b = new StringBuilder(getClass().getSimpleName());
+    b.append("\nhead: ").append(head).append(head.skipDiffList);
+    for (SkipListNode n : skipNodeList) {
+      b.append("\n  ").append(n).append(n.skipDiffList);
+    }
+    return b.toString();
+  }
