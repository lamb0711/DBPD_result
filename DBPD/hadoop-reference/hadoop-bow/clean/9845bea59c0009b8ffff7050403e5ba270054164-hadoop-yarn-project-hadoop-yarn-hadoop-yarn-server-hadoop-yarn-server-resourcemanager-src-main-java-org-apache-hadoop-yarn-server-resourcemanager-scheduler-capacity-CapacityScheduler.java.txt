YARN-6689. PlacementRule should be configurable. (Jonathan Hung via xgong)

+import org.apache.hadoop.yarn.server.resourcemanager.placement.PlacementFactory;
+    // Initialize placement rules
+    Collection<String> placementRuleStrs = conf.getStringCollection(
+        YarnConfiguration.QUEUE_PLACEMENT_RULES);
-
-    // Initialize UserGroupMappingPlacementRule
-    // TODO, need make this defineable by configuration.
-    UserGroupMappingPlacementRule ugRule = getUserGroupMappingPlacementRule();
-    if (null != ugRule) {
-      placementRules.add(ugRule);
+    if (placementRuleStrs.isEmpty()) {
+      PlacementRule ugRule = getUserGroupMappingPlacementRule();
+      if (null != ugRule) {
+        placementRules.add(ugRule);
+      }
+    } else {
+      for (String placementRuleStr : placementRuleStrs) {
+        switch (placementRuleStr) {
+        case YarnConfiguration.USER_GROUP_PLACEMENT_RULE:
+          PlacementRule ugRule = getUserGroupMappingPlacementRule();
+          if (null != ugRule) {
+            placementRules.add(ugRule);
+          }
+          break;
+        default:
+          try {
+            PlacementRule rule = PlacementFactory.getPlacementRule(
+                placementRuleStr, conf);
+            if (null != rule) {
+              placementRules.add(rule);
+            }
+          } catch (ClassNotFoundException cnfe) {
+            throw new IOException(cnfe);
+          }
+        }
+      }
-
