YARN-2003. Support for Application priority : Changes in RM and Capacity Scheduler. (Sunil G via wangda)

+import org.apache.hadoop.yarn.api.records.ApplicationSubmissionContext;
+import org.apache.hadoop.yarn.api.records.Priority;
+  private final Priority appPriority;
-  public AppAddedSchedulerEvent(
-      ApplicationId applicationId, String queue, String user) {
-    this(applicationId, queue, user, false, null);
+  public AppAddedSchedulerEvent(ApplicationId applicationId, String queue,
+      String user) {
+    this(applicationId, queue, user, false, null, Priority.newInstance(0));
-      String user, ReservationId reservationID) {
-    this(applicationId, queue, user, false, reservationID);
+      String user, ReservationId reservationID, Priority appPriority) {
+    this(applicationId, queue, user, false, reservationID, appPriority);
+  }
+
+  public AppAddedSchedulerEvent(String user,
+      ApplicationSubmissionContext submissionContext, boolean isAppRecovering) {
+    this(submissionContext.getApplicationId(), submissionContext.getQueue(),
+        user, isAppRecovering, submissionContext.getReservationID(),
+        submissionContext.getPriority());
-      String user, boolean isAppRecovering, ReservationId reservationID) {
+      String user, boolean isAppRecovering, ReservationId reservationID,
+      Priority appPriority) {
+    this.appPriority = appPriority;
+
+  public Priority getApplicatonPriority() {
+    return appPriority;
+  }
