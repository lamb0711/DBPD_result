HDFS-13033: [SPS]: Implement a mechanism to do file block movements for external SPS. Contributed by Rakesh R.

-      final BlockMoveTaskHandler blockMovementTaskHandler) {
+      final BlockMoveTaskHandler blockMovementTaskHandler,
+      final BlockMovementListener blockMovementListener) {
-        storageMovementNeeded);
+        storageMovementNeeded, blockMovementListener);
+                itemInfo.increRetryCount();
-        } else {
-          // none of the blocks found its eligible targets for satisfying the
-          // storage policy.
+        } else
+          if (status != BlocksMovingAnalysis.Status.BLOCKS_TARGETS_PAIRED) {
+          // Check if the previous block was successfully paired. Here the
+          // status will set to NO_BLOCKS_TARGETS_PAIRED only when none of the
+          // blocks of a file found its eligible targets to satisfy the storage
+          // policy.
-      } else {
-        if (hasLowRedundancyBlocks) {
-          status = BlocksMovingAnalysis.Status.FEW_LOW_REDUNDANCY_BLOCKS;
-        }
+      } else if (hasLowRedundancyBlocks
+          && status != BlocksMovingAnalysis.Status.BLOCKS_TARGETS_PAIRED) {
+        // Check if the previous block was successfully paired.
+        status = BlocksMovingAnalysis.Status.FEW_LOW_REDUNDANCY_BLOCKS;
-        blockMoveTaskHandler.submitMoveTask(blkMovingInfo,
-            storageMovementsMonitor);
+        blockMoveTaskHandler.submitMoveTask(blkMovingInfo);
-  public void handleStorageMovementAttemptFinishedBlks(
+  public void notifyStorageMovementAttemptFinishedBlks(
-  BlockMovementListener getAttemptedItemsMonitor() {
+  BlockStorageMovementAttemptedItems getAttemptedItemsMonitor() {
