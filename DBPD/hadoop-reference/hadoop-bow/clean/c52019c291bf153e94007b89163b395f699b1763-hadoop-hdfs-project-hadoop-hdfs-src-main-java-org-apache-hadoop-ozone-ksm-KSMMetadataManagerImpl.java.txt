HDFS-12539. Ozone: refactor some functions in KSMMetadataManagerImpl to be more readable and reusable. Contributed by Yuanbo Liu.

-  private String getBucketKeyPrefix(String volume, String bucket) {
+  /**
+   * @param volume
+   * @param bucket
+   * @return
+   */
+  private String getBucketWithDBPrefix(String volume, String bucket) {
-  private String getKeyKeyPrefix(String volume, String bucket, String key) {
+  private String getKeyWithDBPrefix(String volume, String bucket, String key) {
-  public byte[] getDBKeyForKey(String volume, String bucket, String key) {
-    String keyKeyString = OzoneConsts.KSM_KEY_PREFIX + volume
-        + OzoneConsts.KSM_KEY_PREFIX + bucket + OzoneConsts.KSM_KEY_PREFIX
-        + key;
-    return DFSUtil.string2Bytes(keyKeyString);
+  public byte[] getDBKeyBytes(String volume, String bucket, String key) {
+    return DFSUtil.string2Bytes(getKeyWithDBPrefix(volume, bucket, key));
-    String keyRootName = OzoneConsts.KSM_KEY_PREFIX + volume
-        + OzoneConsts.KSM_KEY_PREFIX + bucket + OzoneConsts.KSM_KEY_PREFIX;
+    String keyRootName = getKeyWithDBPrefix(volume, bucket, null);
-        String bucketNamePrefix = getBucketKeyPrefix(volumeName, bucketPrefix);
+        String bucketNamePrefix =
+                getBucketWithDBPrefix(volumeName, bucketPrefix);
-    MetadataKeyFilter filter =
-        new KeyPrefixFilter(getKeyKeyPrefix(volumeName, bucketName, keyPrefix));
+    MetadataKeyFilter filter = new KeyPrefixFilter(
+                getKeyWithDBPrefix(volumeName, bucketName, keyPrefix));
-          getDBKeyForKey(volumeName, bucketName, startKey),
+          getDBKeyBytes(volumeName, bucketName, startKey),
