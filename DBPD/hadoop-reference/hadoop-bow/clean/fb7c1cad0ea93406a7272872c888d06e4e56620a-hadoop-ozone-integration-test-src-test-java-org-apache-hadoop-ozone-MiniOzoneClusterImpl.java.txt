Revert "HDDS-1384. TestBlockOutputStreamWithFailures is failing"

This reverts commit dead9b4049484c31e0608956e53a9ef07a45819d.

-import java.net.ServerSocket;
-import java.util.concurrent.atomic.AtomicInteger;
-    private static AtomicInteger lastUsedPort =
-        new AtomicInteger(1000);
-
-
-      String scmAddress = scm.getDatanodeRpcAddress().getHostString() +
+      configureHddsDatanodes();
+      String scmAddress =  scm.getDatanodeRpcAddress().getHostString() +
-
-        configureHddsDatanodes(dnConf);
-      conf.set(ScmConfigKeys.OZONE_SCM_CLIENT_ADDRESS_KEY,
-          "127.0.0.1:" + findPort());
-      conf.set(ScmConfigKeys.OZONE_SCM_BLOCK_CLIENT_ADDRESS_KEY,
-          "127.0.0.1:" + findPort());
-      conf.set(ScmConfigKeys.OZONE_SCM_DATANODE_ADDRESS_KEY,
-          "127.0.0.1:" + findPort());
-      conf.set(ScmConfigKeys.OZONE_SCM_HTTP_ADDRESS_KEY,
-          "127.0.0.1:" + findPort());
+      conf.set(ScmConfigKeys.OZONE_SCM_CLIENT_ADDRESS_KEY, "127.0.0.1:0");
+      conf.set(ScmConfigKeys.OZONE_SCM_BLOCK_CLIENT_ADDRESS_KEY, "127.0.0.1:0");
+      conf.set(ScmConfigKeys.OZONE_SCM_DATANODE_ADDRESS_KEY, "127.0.0.1:0");
+      conf.set(ScmConfigKeys.OZONE_SCM_HTTP_ADDRESS_KEY, "127.0.0.1:0");
-      conf.set(OMConfigKeys.OZONE_OM_ADDRESS_KEY, "127.0.0.1:" + findPort());
-      conf.set(OMConfigKeys.OZONE_OM_HTTP_ADDRESS_KEY,
-          "127.0.0.1:" + findPort());
+      conf.set(OMConfigKeys.OZONE_OM_ADDRESS_KEY, "127.0.0.1:0");
+      conf.set(OMConfigKeys.OZONE_OM_HTTP_ADDRESS_KEY, "127.0.0.1:0");
-    /**
-     * Return an available TCP port if available.
-     * <p>
-     * As we have a static counter the port should be unique inside the JVM..
-     */
-    private int findPort() {
-      while (lastUsedPort.get() < 65536) {
-        try {
-          int nextPort = lastUsedPort.incrementAndGet();
-          ServerSocket socket = new ServerSocket(nextPort);
-          socket.close();
-          return nextPort;
-        } catch (IOException ex) {
-          //port is not available, let's try the next one.
-          continue;
-        }
-      }
-      throw new RuntimeException("No available port");
-    }
-
-    private void configureHddsDatanodes(OzoneConfiguration dnConf) {
-      dnConf.set(ScmConfigKeys.HDDS_REST_HTTP_ADDRESS_KEY,
-          "0.0.0.0:" + findPort());
-      dnConf.set(HddsConfigKeys.HDDS_DATANODE_HTTP_ADDRESS_KEY,
-          "0.0.0.0:" + findPort());
-      dnConf.set(HDDS_DATANODE_PLUGINS_KEY,
+    private void configureHddsDatanodes() {
+      conf.set(ScmConfigKeys.HDDS_REST_HTTP_ADDRESS_KEY, "0.0.0.0:0");
+      conf.set(HddsConfigKeys.HDDS_DATANODE_HTTP_ADDRESS_KEY, "0.0.0.0:0");
+      conf.set(HDDS_DATANODE_PLUGINS_KEY,
-      dnConf.setBoolean(OzoneConfigKeys.DFS_CONTAINER_IPC_RANDOM_PORT,
+      conf.setBoolean(OzoneConfigKeys.DFS_CONTAINER_IPC_RANDOM_PORT,
-      dnConf.setBoolean(OzoneConfigKeys.DFS_CONTAINER_RATIS_IPC_RANDOM_PORT,
+      conf.setBoolean(OzoneConfigKeys.DFS_CONTAINER_RATIS_IPC_RANDOM_PORT,
