YARN-6877. Create an abstract log reader for extendability. Contributed by Xuan Gong.

+import java.util.HashSet;
+import org.apache.hadoop.yarn.logaggregation.ContainerLogsRequest;
+import org.apache.hadoop.yarn.logaggregation.filecontroller.LogAggregationFileControllerFactory;
-import org.apache.hadoop.yarn.logaggregation.LogToolUtils;
+  private final LogAggregationFileControllerFactory factory;
+    this.factory = new LogAggregationFileControllerFactory(conf);
-        byte[] buf = new byte[65535];
-        boolean findLogs = LogToolUtils.outputAggregatedContainerLog(conf,
-            appId, appOwner, containerIdStr, nodeId, logFile, bytes, os, buf);
+        ContainerLogsRequest request = new ContainerLogsRequest();
+        request.setAppId(appId);
+        request.setAppOwner(appOwner);
+        request.setContainerId(containerIdStr);
+        request.setBytes(bytes);
+        request.setNodeId(nodeId);
+        Set<String> logTypes = new HashSet<>();
+        logTypes.add(logFile);
+        request.setLogTypes(logTypes);
+        boolean findLogs = factory.getFileControllerForRead(appId, appOwner)
+            .readAggregatedLogs(request, os);
-      List<ContainerLogMeta> containerLogMeta = LogToolUtils
-          .getContainerLogMetaFromRemoteFS(conf, appId, containerIdStr,
-              nodeId, appOwner);
+      ContainerLogsRequest request = new ContainerLogsRequest();
+      request.setAppId(appId);
+      request.setAppOwner(appOwner);
+      request.setContainerId(containerIdStr);
+      request.setNodeId(nodeId);
+      List<ContainerLogMeta> containerLogMeta = factory
+          .getFileControllerForRead(appId, appOwner)
+          .readAggregatedLogsMeta(request);
