HADOOP-15295. Remove redundant logging related to tags from Configuration. Contributed by Ajay Kumar.

-  private static final Set<String> TAGS = new HashSet<>();
+  private static final Set<String> TAGS = ConcurrentHashMap.newKeySet();
-    this.removeUndeclaredTags(properties);
+    this.addTags(properties);
-   * Removes undeclared tags and related properties from propertyTagsMap.
-   * Its required because ordering of properties in xml config files is not
-   * guaranteed.
+   * Add tags defined in HADOOP_SYSTEM_TAGS, HADOOP_CUSTOM_TAGS.
-  private void removeUndeclaredTags(Properties prop) {
+  public void addTags(Properties prop) {
-    if (prop.containsKey(CommonConfigurationKeys.HADOOP_SYSTEM_TAGS)){
-      String systemTags = prop.getProperty(CommonConfigurationKeys
-              .HADOOP_SYSTEM_TAGS);
-      Arrays.stream(systemTags.split(",")).forEach(tag -> TAGS.add(tag));
-    }
-    // Get all custom tags
-    if (prop.containsKey(CommonConfigurationKeys.HADOOP_CUSTOM_TAGS)) {
-      String customTags = prop.getProperty(CommonConfigurationKeys
-          .HADOOP_CUSTOM_TAGS);
-      Arrays.stream(customTags.split(",")).forEach(tag -> TAGS.add(tag));
+    try {
+      if (prop.containsKey(CommonConfigurationKeys.HADOOP_SYSTEM_TAGS)) {
+        String systemTags = prop.getProperty(CommonConfigurationKeys
+            .HADOOP_SYSTEM_TAGS);
+        Arrays.stream(systemTags.split(",")).forEach(tag -> TAGS.add(tag));
+      }
+      // Get all custom tags
+      if (prop.containsKey(CommonConfigurationKeys.HADOOP_CUSTOM_TAGS)) {
+        String customTags = prop.getProperty(CommonConfigurationKeys
+            .HADOOP_CUSTOM_TAGS);
+        Arrays.stream(customTags.split(",")).forEach(tag -> TAGS.add(tag));
+      }
+
+    } catch (Exception ex) {
+      LOG.trace("Error adding tags in configuration", ex);
-    Set undeclaredTags = propertyTagsMap.keySet();
-    if (undeclaredTags.retainAll(TAGS)) {
-      LOG.info("Removed undeclared tags:");
-    }
-      tagStr = tagStr.trim();
+        tagStr = tagStr.trim();
