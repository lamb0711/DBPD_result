YARN-8379. Improve balancing resources in already satisfied queues by using Capacity Scheduler preemption. Contributed by Zian Chen.

-import java.util.HashSet;
-        preemptionContext, true);
+        preemptionContext, true, false);
+    Map<ApplicationAttemptId, Set<RMContainer>> curCandidates = new HashMap<>();
-          ApplicationAttemptId appId = c.getApplicationAttemptId();
-          Set<RMContainer> containers = selectedCandidates.get(appId);
-          if (null == containers) {
-            containers = new HashSet<>();
-            selectedCandidates.put(appId, containers);
-          }
+          // Add to preemptMap
+          CapacitySchedulerPreemptionUtils.addToPreemptMap(selectedCandidates,
+              curCandidates, c.getApplicationAttemptId(), c);
-          containers.add(c);
-    return selectedCandidates;
+    return curCandidates;
