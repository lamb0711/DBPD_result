HDFS-12069. Ozone: Create a general abstraction for metadata store. Contributed by Weiwei Yang.

-import org.apache.hadoop.utils.LevelDBStore;
+import org.apache.hadoop.utils.MetadataStore;
+import org.apache.hadoop.utils.MetadataStoreBuilder;
-   * @return LevelDB handle.
+   * @return MetadataStore handle.
-  public static LevelDBStore getDB(ContainerData container,
+  public static MetadataStore getDB(ContainerData container,
-      LevelDBStore db = cache.getDB(container.getContainerName());
+      MetadataStore db = cache.getDB(container.getContainerName());
-        db = new LevelDBStore(
-            new File(container.getDBPath()),
-            false);
+        db = MetadataStoreBuilder.newBuilder()
+            .setDbFile(new File(container.getDBPath()))
+            .setCreateIfMissing(false)
+            .build();
-    LevelDBStore[] handles = new LevelDBStore[cache.values().size()];
+    MetadataStore[] handles = new MetadataStore[cache.values().size()];
-    for (LevelDBStore db : handles) {
+    for (MetadataStore db : handles) {
