HADOOP-13427. Eliminate needless uses of FileSystem#{exists(), isFile(), isDirectory()}. Contributed by Steve Loughran and Mingliang Liu

-    boolean targetIsFile = targetFS.isFile(targetPath);
+    boolean targetExists = false;
+    boolean targetIsFile = false;
+    try {
+      targetIsFile = targetFS.getFileStatus(targetPath).isFile();
+      targetExists = true;
+    } catch (FileNotFoundException ignored) {
+    }
-    if (options.shouldAtomicCommit() && targetFS.exists(targetPath)) {
+    if (options.shouldAtomicCommit() && targetExists) {
-      if (targetFS.isFile(target) || !targetPathExists) {
+      if (!targetPathExists || targetFS.isFile(target)) {
-    if (fs.exists(pathToListFile)) {
-      fs.delete(pathToListFile, false);
-    }
+    fs.delete(pathToListFile, false);
