HADOOP-13130. s3a failures can surface as RTEs, not IOEs. (Steve Loughran)

+import com.amazonaws.AmazonClientException;
+
+import static org.apache.hadoop.fs.s3a.S3AUtils.*;
+
-   * @throws IOException
+   * @throws IOException on any failure to open the object
-    GetObjectRequest request = new GetObjectRequest(bucket, key)
-        .withRange(targetPos, requestedStreamLen);
-    wrappedStream = client.getObject(request).getObjectContent();
+    try {
+      GetObjectRequest request = new GetObjectRequest(bucket, key)
+          .withRange(targetPos, requestedStreamLen);
+      wrappedStream = client.getObject(request).getObjectContent();
-    if (wrappedStream == null) {
-      throw new IOException("Null IO stream from reopen of (" + reason +  ") "
-          + uri);
+      if (wrappedStream == null) {
+        throw new IOException("Null IO stream from reopen of (" + reason +  ") "
+            + uri);
+      }
+    } catch (AmazonClientException e) {
+      throw translateException("Reopen at position " + targetPos, uri, e);
-    lazySeek(nextReadPos, 1);
+      lazySeek(nextReadPos, 1);
-    lazySeek(nextReadPos, len);
-    streamStatistics.readOperationStarted(nextReadPos, len);
+    try {
+      lazySeek(nextReadPos, len);
+    } catch (EOFException e) {
+      // the end of the file has moved
+      return -1;
+    }
+      streamStatistics.readOperationStarted(nextReadPos, len);
