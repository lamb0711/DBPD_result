YARN-10130. FS-CS converter: Do not allow output dir to be the same as input dir. Contributed by Adam Antal

+import org.apache.hadoop.yarn.conf.YarnConfiguration;
+  private static final String ALREADY_CONTAINS_EXCEPTION_MSG =
+      "The %s (provided with %s|%s arguments) contains " +
+          "the %s provided with the %s|%s options.";
+  private static final String ALREADY_CONTAINS_FILE_EXCEPTION_MSG =
+      "The %s %s (provided with %s|%s arguments) already contains a file " +
+          "or directory named %s which will be the output of the conversion!";
+
+    checkOutputDirDoesNotContainXmls(yarnSiteXmlFile, outputDir);
+  private static void checkOutputDirDoesNotContainXmls(String yarnSiteXmlFile,
+      String outputDir) {
+    if (yarnSiteXmlFile == null || outputDir == null) {
+      return;
+    }
+
+    // check whether yarn-site.xml is not in the output folder
+    File xmlFile = new File(yarnSiteXmlFile);
+    File xmlParentFolder = xmlFile.getParentFile();
+    File output = new File(outputDir);
+    if (output.equals(xmlParentFolder)) {
+      throw new IllegalArgumentException(
+          String.format(ALREADY_CONTAINS_EXCEPTION_MSG,
+              CliOption.OUTPUT_DIR.name, CliOption.OUTPUT_DIR.shortSwitch,
+              CliOption.OUTPUT_DIR.longSwitch, CliOption.YARN_SITE.name,
+              CliOption.YARN_SITE.shortSwitch,
+              CliOption.YARN_SITE.longSwitch));
+    }
+
+    // check whether the output folder does not contain nor yarn-site.xml
+    // neither capacity-scheduler.xml
+    checkFileNotInOutputDir(output,
+        YarnConfiguration.YARN_SITE_CONFIGURATION_FILE);
+    checkFileNotInOutputDir(output,
+        YarnConfiguration.CS_CONFIGURATION_FILE);
+  }
+
+  private static void checkFileNotInOutputDir(File output, String fileName) {
+    File file = new File(output, fileName);
+    if (file.exists()) {
+      throw new IllegalArgumentException(
+          String.format(ALREADY_CONTAINS_FILE_EXCEPTION_MSG,
+              CliOption.OUTPUT_DIR.name, output,
+              CliOption.OUTPUT_DIR.shortSwitch,
+              CliOption.OUTPUT_DIR.longSwitch,
+              fileName));
+    }
+  }
+
