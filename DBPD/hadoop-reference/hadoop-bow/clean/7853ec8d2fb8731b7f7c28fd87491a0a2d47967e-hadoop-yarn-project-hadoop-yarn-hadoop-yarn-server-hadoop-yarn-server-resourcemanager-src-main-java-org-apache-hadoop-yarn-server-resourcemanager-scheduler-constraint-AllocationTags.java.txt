YARN-8013. Support application tags when defining application namespaces for placement constraints. Contributed by Weiwei Yang.

-import com.google.common.collect.ImmutableSet;
-  private AllocationTagNamespace ns;
+  private TargetApplicationsNamespace ns;
+  private ApplicationId applicationId;
-  private AllocationTags(AllocationTagNamespace namespace,
+  private AllocationTags(TargetApplicationsNamespace namespace,
+  private AllocationTags(TargetApplicationsNamespace namespace,
+      Set<String> allocationTags, ApplicationId currentAppId) {
+    this.ns = namespace;
+    this.tags = allocationTags;
+    this.applicationId = currentAppId;
+  }
+
-  public AllocationTagNamespace getNamespace() {
+  public TargetApplicationsNamespace getNamespace() {
+  public ApplicationId getCurrentApplicationId() {
+    return this.applicationId;
+  }
+
-    AllocationTagNamespace namespace = new AllocationTagNamespace.AppID(appId);
+    TargetApplicationsNamespace namespace =
+        new TargetApplicationsNamespace.AppID(appId);
-    AllocationTagNamespace namespace = new AllocationTagNamespace.All();
+    TargetApplicationsNamespace namespace =
+        new TargetApplicationsNamespace.All();
-      ApplicationId currentApp, Set<ApplicationId> allIds, Set<String> tags)
-      throws InvalidAllocationTagsQueryException {
-    AllocationTagNamespace namespace = new AllocationTagNamespace.NotSelf();
-    TargetApplications ta = new TargetApplications(currentApp, allIds);
-    namespace.evaluate(ta);
-    return new AllocationTags(namespace, tags);
+      ApplicationId currentApp, Set<String> tags) {
+    TargetApplicationsNamespace namespace =
+        new TargetApplicationsNamespace.NotSelf();
+    return new AllocationTags(namespace, tags, currentApp);
-  public static AllocationTags newAllocationTags(
-      AllocationTagNamespace namespace, Set<String> tags) {
-    return new AllocationTags(namespace, tags);
+  public static AllocationTags createAllocationTags(
+      ApplicationId currentApplicationId, String namespaceString,
+      Set<String> tags) throws InvalidAllocationTagsQueryException {
+    TargetApplicationsNamespace namespace = TargetApplicationsNamespace
+        .parse(namespaceString);
+    return new AllocationTags(namespace, tags, currentApplicationId);
