HDDS-935. Avoid creating an already created container on a datanode in case of disk removal followed by datanode restart. Contributed by Shashikant Banerjee.

+import java.util.Set;
+import java.util.concurrent.ConcurrentSkipListSet;
-
+  private final ConcurrentSkipListSet<Long> missingContainerSet =
+      new ConcurrentSkipListSet<>();
+    containerMap.keySet().stream().collect(Collectors.toSet());
+
+  public Set<Long> getMissingContainerSet() {
+    return missingContainerSet;
+  }
+
+  /**
+   * Builds the missing container set by taking a diff total no containers
+   * actually found and number of containers which actually got created.
+   * This will only be called during the initialization of Datanode Service
+   * when  it still not a part of any write Pipeline.
+   * @param createdContainerSet ContainerId set persisted in the Ratis snapshot
+   */
+  public void buildMissingContainerSet(Set<Long> createdContainerSet) {
+    missingContainerSet.addAll(createdContainerSet);
+    missingContainerSet.removeAll(containerMap.keySet());
+  }
