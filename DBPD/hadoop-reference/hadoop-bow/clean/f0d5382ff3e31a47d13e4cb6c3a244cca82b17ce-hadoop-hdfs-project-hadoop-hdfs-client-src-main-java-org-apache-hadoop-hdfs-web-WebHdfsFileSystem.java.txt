HDFS-6962. ACL inheritance conflicts with umaskmode. Contributed by Chris Nauroth.

+import org.apache.hadoop.fs.permission.FsCreateModes;
-    return permission.applyUMask(FsPermission.getUMask(getConf()));
+    return FsCreateModes.applyUMask(permission,
+        FsPermission.getUMask(getConf()));
+    final FsPermission modes = applyUMask(permission);
-        new PermissionParam(applyUMask(permission))
+        new PermissionParam(modes.getMasked()),
+        new UnmaskedPermissionParam(modes.getUnmasked())
+    final FsPermission modes = applyUMask(permission);
-        new PermissionParam(applyUMask(permission)),
+        new PermissionParam(modes.getMasked()),
+        new UnmaskedPermissionParam(modes.getUnmasked()),
+    final FsPermission modes = applyUMask(permission);
-        new PermissionParam(applyUMask(permission)),
+        new PermissionParam(modes.getMasked()),
+        new UnmaskedPermissionParam(modes.getUnmasked()),
