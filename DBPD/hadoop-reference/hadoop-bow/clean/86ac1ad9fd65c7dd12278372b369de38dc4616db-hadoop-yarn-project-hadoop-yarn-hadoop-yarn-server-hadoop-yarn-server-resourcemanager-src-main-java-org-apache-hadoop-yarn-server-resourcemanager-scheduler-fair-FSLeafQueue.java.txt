YARN-5453. FairScheduler#update may skip update demand resource of child queue/app if current demand reached maxResource. (sandflee via kasha)

-        if (Resources.equals(demand, maxShare)) {
-          break;
-        }
-        updateDemandForApp(sched, maxShare);
+        updateDemandForApp(sched);
-        if (Resources.equals(demand, maxShare)) {
-          break;
-        }
-        updateDemandForApp(sched, maxShare);
+        updateDemandForApp(sched);
+    // Cap demand to maxShare to limit allocation to maxShare
+    demand = Resources.componentwiseMin(demand, maxShare);
-  private void updateDemandForApp(FSAppAttempt sched, Resource maxRes) {
+  private void updateDemandForApp(FSAppAttempt sched) {
-    demand = Resources.componentwiseMin(demand, maxRes);
