YARN-4766. NM should not aggregate logs older than the retention policy (haibochen via rkanter)

+  /**
+   * The value will be set when the application is recovered from state store.
+   * We use this value in AppLogAggregatorImpl to determine, if log retention
+   * policy is enabled, if we need to upload old application log files. Files
+   * older than retention policy will not be uploaded but scheduled for
+   * deletion.
+   */
+  private final long recoveredAppLogInitedTime;
-    this(appId, user, credentials, appAcls, null);
+    this(appId, user, credentials, appAcls, null, -1);
+    this(appId, user, credentials, appAcls, logAggregationContext, -1);
+  }
+
+  public LogHandlerAppStartedEvent(ApplicationId appId, String user,
+      Credentials credentials, Map<ApplicationAccessType, String> appAcls,
+      LogAggregationContext logAggregationContext, long appLogInitedTime) {
+    this.recoveredAppLogInitedTime = appLogInitedTime;
+
+  public long getRecoveredAppLogInitedTime() {
+    return this.recoveredAppLogInitedTime;
+  }
