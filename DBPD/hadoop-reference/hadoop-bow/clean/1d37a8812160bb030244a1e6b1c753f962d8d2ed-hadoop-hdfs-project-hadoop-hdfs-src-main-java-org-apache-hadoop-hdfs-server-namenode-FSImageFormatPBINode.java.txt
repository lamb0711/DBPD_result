HDFS-8854. Erasure coding: add ECPolicy to replace schema+cellSize in hadoop-hdfs. Contributed by Walter Su.

+import org.apache.hadoop.hdfs.protocol.ErasureCodingPolicy;
-import org.apache.hadoop.io.erasurecode.ECSchema;
-      ECSchema schema = ErasureCodingSchemaManager.getSystemDefaultSchema();
+      ErasureCodingPolicy ecPolicy = ErasureCodingPolicyManager.getSystemDefaultPolicy();
-      if (isStriped) {
-        Preconditions.checkState(f.hasStripingCellSize());
-      }
-          blocks[i] = new BlockInfoStriped(PBHelper.convert(b), schema,
-              (int)f.getStripingCellSize());
+          blocks[i] = new BlockInfoStriped(PBHelper.convert(b), ecPolicy);
-            ucBlk = new BlockInfoUnderConstructionStriped(striped,
-                schema, (int)f.getStripingCellSize());
+            ucBlk = new BlockInfoUnderConstructionStriped(striped, ecPolicy);
-      if (n.isStriped()) {
-        if (blocks != null && blocks.length > 0) {
-          BlockInfo firstBlock = blocks[0];
-          Preconditions.checkState(firstBlock.isStriped());
-          b.setStripingCellSize(((BlockInfoStriped)firstBlock).getCellSize());
-        } else {
-          b.setStripingCellSize(HdfsConstants.BLOCK_STRIPED_CELL_SIZE);
-        }
-      }
-
