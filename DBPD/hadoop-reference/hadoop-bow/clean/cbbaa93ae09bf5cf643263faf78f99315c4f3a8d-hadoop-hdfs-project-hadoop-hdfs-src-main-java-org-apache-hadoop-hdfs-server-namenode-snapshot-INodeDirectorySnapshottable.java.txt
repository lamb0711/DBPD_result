HDFS-4317. Change INode and its subclasses to support HDFS-4103.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1422748 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.hadoop.hdfs.server.namenode.INodeDirectoryWithQuota;
-public class INodeDirectorySnapshottable extends INodeDirectoryWithQuota {
+public class INodeDirectorySnapshottable extends INodeDirectoryWithSnapshot {
-    long nsq = -1L;
-    long dsq = -1L;
-
-    if (dir instanceof INodeDirectoryWithQuota) {
-      final INodeDirectoryWithQuota q = (INodeDirectoryWithQuota)dir;
-      nsq = q.getNsQuota();
-      dsq = q.getDsQuota();
-    }
-    return new INodeDirectorySnapshottable(nsq, dsq, dir, snapshotQuota);
+    return new INodeDirectorySnapshottable(dir, snapshotQuota);
-  private INodeDirectorySnapshottable(long nsQuota, long dsQuota,
-      INodeDirectory dir, final int snapshotQuota) {
-    super(nsQuota, dsQuota, dir);
+  private INodeDirectorySnapshottable(INodeDirectory dir,
+      final int snapshotQuota) {
+    super(dir, true);
-    s.getRoot().setModificationTime(timestamp);
-    setModificationTime(timestamp);
+    s.getRoot().updateModificationTime(timestamp);
+    updateModificationTime(timestamp);
