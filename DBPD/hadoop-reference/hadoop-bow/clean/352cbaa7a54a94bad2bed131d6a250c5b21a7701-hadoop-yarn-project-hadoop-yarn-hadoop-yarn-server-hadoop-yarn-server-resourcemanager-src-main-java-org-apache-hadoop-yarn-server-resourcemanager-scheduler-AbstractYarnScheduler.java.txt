YARN-4862. Handle duplicate completed containers in RMNodeImpl. Contributed by Rohith Sharma K S

+import org.apache.hadoop.yarn.server.resourcemanager.rmnode.RMNodeFinishedContainersPulledByAMEvent;
+   * @param nodeId NodeId corresponding to the NodeManager
-      completedContainers, Resource releasedResources) {
+      completedContainers, Resource releasedResources, NodeId nodeId) {
+    List<ContainerId> untrackedContainerIdList = new ArrayList<ContainerId>();
-      completedContainer(getRMContainer(containerId),
+      completedContainer(container,
+      } else {
+        // Add containers which are untracked by RM.
+        untrackedContainerIdList.add(containerId);
+
+    // Acknowledge NM to remove RM-untracked-containers from NM context.
+    if (!untrackedContainerIdList.isEmpty()) {
+      this.rmContext.getDispatcher().getEventHandler()
+          .handle(new RMNodeFinishedContainersPulledByAMEvent(nodeId,
+              untrackedContainerIdList));
+    }
+
-        releasedResources);
+        releasedResources, nm.getNodeID());
+
