HDFS-11914. Add more diagnosis info for fsimage transfer failure. Contributed by Yongjun Zhang.

+    long total = 0;
+    int num = 1;
+    IOException ioe = null;
+    String reportStr = "Sending fileName: " + localfile.getAbsolutePath()
+      + ", fileSize: " + localfile.length() + ".";
-      int num = 1;
-        
+
+        total += num;
-      LOG.info("Connection closed by client");
+      reportStr += " Connection closed by client.";
+      ioe = e;
+    } catch (IOException ie) {
+      ioe = ie;
+      throw ie;
+      reportStr += " Sent total: " + total +
+          " bytes. Size of last segment intended to send: " + num
+          + " bytes.";
+      if (ioe != null) {
+        LOG.info(reportStr, ioe);
+      } else {
+        LOG.info(reportStr);
+      }
