HDFS-4143. Change blocks to private in INodeFile and renames isLink() to isSymlink() in INode.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1405237 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.Arrays;
-import com.google.common.base.Joiner;
-
-    assert allBlocksComplete() :
-      "Can't finalize inode " + this + " since it contains " +
-      "non-complete blocks! Blocks are: " + blocksAsString();
+    assert allBlocksComplete() : "Can't finalize inode " + this
+      + " since it contains non-complete blocks! Blocks are "
+      + Arrays.asList(getBlocks());
-    for (BlockInfo b : blocks) {
+    for (BlockInfo b : getBlocks()) {
+    final BlockInfo[] blocks = getBlocks();
-    blocks = newlist;
+    setBlocks(newlist);
-                                          DatanodeDescriptor[] targets)
-  throws IOException {
-    if (blocks == null || blocks.length == 0) {
-      throw new IOException("Trying to update non-existant block. " +
-          "File is empty.");
+      DatanodeDescriptor[] targets) throws IOException {
+    if (numBlocks() == 0) {
+      throw new IOException("Failed to set last block: File is empty.");
-  
-  private String blocksAsString() {
-    return Joiner.on(",").join(this.blocks);
-  }
