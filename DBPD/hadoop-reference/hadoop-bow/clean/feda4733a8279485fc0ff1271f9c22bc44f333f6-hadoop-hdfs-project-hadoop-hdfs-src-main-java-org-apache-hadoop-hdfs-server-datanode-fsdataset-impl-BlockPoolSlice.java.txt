HDFS-7143. Fix findbugs warnings in HDFS-6581 branch. (Contributed by Tsz Wo Nicholas Sze)

+import org.apache.commons.logging.Log;
+import org.apache.commons.logging.LogFactory;
+import org.apache.hadoop.io.nativeio.NativeIO;
+  static final Log LOG = LogFactory.getLog(BlockPoolSlice.class);
+
-          File targetBlockFile = new File(targetDir, blockFile.getName());
-          File targetMetaFile = new File(targetDir, metaFile.getName());
-            FsDatasetImpl.LOG.warn("Failed to move " + blockFile + " to " + targetDir);
+            LOG.warn("Failed to mkdirs " + targetDir);
-          metaFile.renameTo(targetMetaFile);
-          blockFile.renameTo(targetBlockFile);
+          final File targetMetaFile = new File(targetDir, metaFile.getName());
+          try {
+            NativeIO.renameTo(metaFile, targetMetaFile);
+          } catch (IOException e) {
+            LOG.warn("Failed to move meta file from "
+                + metaFile + " to " + targetMetaFile, e);
+            continue;
+
+          }
+
+          final File targetBlockFile = new File(targetDir, blockFile.getName());
+          try {
+            NativeIO.renameTo(blockFile, targetBlockFile);
+          } catch (IOException e) {
+            LOG.warn("Failed to move block file from "
+                + blockFile + " to " + targetBlockFile, e);
+            continue;
+          }
-            FsDatasetImpl.LOG.warn("Failed to move " + blockFile + " to " + targetDir);
+            LOG.warn("Failed to move " + blockFile + " to " + targetDir);
+    if (LOG.isDebugEnabled()) {
+      LOG.debug("resolveDuplicateReplicas decide to keep " + replicaToKeep
+          + ".  Will try to delete " + replicaToDelete);
+    }
+
-    replicaToDelete.getBlockFile().delete();
-    replicaToDelete.getMetaFile().delete();
-
-    FsDatasetImpl.LOG.info(
-        "resolveDuplicateReplicas keeping " + replicaToKeep.getBlockFile() +
-        ", deleting " + replicaToDelete.getBlockFile());
+    final File blockFile = replicaToDelete.getBlockFile();
+    if (!blockFile.delete()) {
+      LOG.warn("Failed to delete block file " + blockFile);
+    }
+    final File metaFile = replicaToDelete.getMetaFile();
+    if (!metaFile.delete()) {
+      LOG.warn("Failed to delete meta file " + metaFile);
+    }
