HDDS-251. Integrate BlockDeletingService in KeyValueHandler. Contributed by Lokesh Jain

+import org.apache.hadoop.ozone.container.common
+    .interfaces.ContainerDeletionChoosingPolicy;
-  // TODO: Implement BlockDeletingService
-  public List<ContainerData> chooseContainerForBlockDeletion(
-      int count) throws StorageContainerException {
-    return null;
+  public List<ContainerData> chooseContainerForBlockDeletion(int count,
+      ContainerDeletionChoosingPolicy deletionPolicy)
+      throws StorageContainerException {
+    Map<Long, ContainerData> containerDataMap = containerMap.entrySet().stream()
+        .filter(e -> e.getValue().getContainerType()
+            == ContainerProtos.ContainerType.KeyValueContainer)
+        .collect(Collectors.toMap(Map.Entry::getKey,
+            e -> e.getValue().getContainerData()));
+    return deletionPolicy
+        .chooseContainerForBlockDeletion(count, containerDataMap);
