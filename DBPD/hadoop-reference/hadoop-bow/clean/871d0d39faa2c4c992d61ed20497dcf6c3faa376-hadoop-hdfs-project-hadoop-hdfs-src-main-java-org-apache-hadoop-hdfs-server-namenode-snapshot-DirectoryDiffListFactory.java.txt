HDFS-13223. Reduce DiffListBySkipList memory usage.  Contributed by Shashikant Banerjee

-import org.apache.commons.logging.Log;
+import org.slf4j.Logger;
+import java.util.Random;
+import java.util.concurrent.ThreadLocalRandom;
-  public static void init(int skipInterval, int maxLevels, Log log) {
+  public static void init(int interval, int maxSkipLevels, Logger log) {
+    DirectoryDiffListFactory.skipInterval = interval;
+    DirectoryDiffListFactory.maxLevels = maxSkipLevels;
+
-      constructor = c -> new DiffListBySkipList(c, skipInterval, maxLevels);
+      constructor = c -> new DiffListBySkipList(c);
+  private static volatile int skipInterval;
+  private static volatile int maxLevels;
+
+  /**
+   * Returns the level of a skip list node.
+   * @return A value in the range 0 to maxLevels.
+   */
+  public static int randomLevel() {
+    final Random r = ThreadLocalRandom.current();
+    for (int level = 0; level < maxLevels; level++) {
+      // skip to the next level with probability 1/skipInterval
+      if (r.nextInt(skipInterval) > 0) {
+        return level;
+      }
+    }
+    return maxLevels;
+  }
+
+
