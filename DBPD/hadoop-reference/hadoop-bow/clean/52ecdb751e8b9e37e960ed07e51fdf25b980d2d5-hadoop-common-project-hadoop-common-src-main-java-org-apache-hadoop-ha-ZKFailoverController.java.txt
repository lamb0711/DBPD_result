HDFS-3412. Fix findbugs warnings in auto-HA branch. Contributed by Todd Lipcon.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-3042@1338817 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.hadoop.util.Tool;
-public abstract class ZKFailoverController implements Tool {
+public abstract class ZKFailoverController {
-  private Configuration conf;
+  protected Configuration conf;
+  protected final HAServiceTarget localTarget;
-  private HAServiceTarget localTarget;
-
-  @Override
-  public void setConf(Configuration conf) {
+  protected ZKFailoverController(Configuration conf, HAServiceTarget localTarget) {
+    this.localTarget = localTarget;
-    localTarget = getLocalTarget();
-  protected abstract HAServiceTarget getLocalTarget();
-  @Override
-  public Configuration getConf() {
-    return conf;
+  public HAServiceTarget getLocalTarget() {
+    return localTarget;
-
-  @Override
+  
-  State getLastHealthState() {
+  synchronized State getLastHealthState() {
+
+  private synchronized void setLastHealthState(HealthMonitor.State newState) {
+    LOG.info("Local service " + localTarget +
+        " entered state: " + newState);
+    lastHealthState = newState;
+  }
-      return "Elector callbacks for " + localTarget;
+      synchronized (ZKFailoverController.this) {
+        return "Elector callbacks for " + localTarget;
+      }
-      LOG.info("Local service " + localTarget +
-          " entered state: " + newState);
-      lastHealthState = newState;
+      setLastHealthState(newState);
