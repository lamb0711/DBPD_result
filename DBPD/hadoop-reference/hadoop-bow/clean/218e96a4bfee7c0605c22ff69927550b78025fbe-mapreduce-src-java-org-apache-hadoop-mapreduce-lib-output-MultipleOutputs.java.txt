Merge trunk into HA branch after mavenization of hadoop-common

(no conflicts, straight SVN merge)


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1153931 13f79535-47bb-0310-9956-ffa450edef68

+  /**
+   * Cached TaskAttemptContext which uses the job's configured settings
+   */
+  private TaskAttemptContext jobOutputFormatContext;
-    TaskAttemptContext taskContext = 
-      new TaskAttemptContextImpl(context.getConfiguration(), 
-                                 context.getTaskAttemptID(),
-                                 new WrappedStatusReporter(context));
-    getRecordWriter(taskContext, baseOutputPath).write(key, value);
+    if (jobOutputFormatContext == null) {
+      jobOutputFormatContext = 
+        new TaskAttemptContextImpl(context.getConfiguration(), 
+                                   context.getTaskAttemptID(),
+                                   new WrappedStatusReporter(context));
+    }
+    getRecordWriter(jobOutputFormatContext, baseOutputPath).write(key, value);
