HDFS-8854. Erasure coding: add ECPolicy to replace schema+cellSize in hadoop-hdfs. Contributed by Walter Su.

-import org.apache.hadoop.hdfs.protocol.proto.ErasureCodingProtos.GetECSchemasRequestProto;
-import org.apache.hadoop.hdfs.protocol.proto.ErasureCodingProtos.GetECSchemasResponseProto;
+import org.apache.hadoop.hdfs.protocol.proto.ErasureCodingProtos.GetErasureCodingPoliciesRequestProto;
+import org.apache.hadoop.hdfs.protocol.proto.ErasureCodingProtos.GetErasureCodingPoliciesResponseProto;
-import org.apache.hadoop.hdfs.protocol.proto.HdfsProtos.ECSchemaProto;
+import org.apache.hadoop.hdfs.protocol.proto.HdfsProtos.ErasureCodingPolicyProto;
-import org.apache.hadoop.io.erasurecode.ECSchema;
+import org.apache.hadoop.hdfs.protocol.ErasureCodingPolicy;
-  private final static GetECSchemasRequestProto
-  VOID_GET_ECSCHEMAS_REQUEST = GetECSchemasRequestProto
+  private final static GetErasureCodingPoliciesRequestProto
+  VOID_GET_EC_POLICIES_REQUEST = GetErasureCodingPoliciesRequestProto
-  public void createErasureCodingZone(String src, ECSchema schema, int cellSize)
+  public void createErasureCodingZone(String src, ErasureCodingPolicy ecPolicy)
-    if (schema != null) {
-      builder.setSchema(PBHelper.convertECSchema(schema));
-    }
-    if (cellSize > 0) {
-      builder.setCellSize(cellSize);
+    if (ecPolicy != null) {
+      builder.setEcPolicy(PBHelper.convertErasureCodingPolicy(ecPolicy));
-  public ECSchema[] getECSchemas() throws IOException {
+  public ErasureCodingPolicy[] getErasureCodingPolicies() throws IOException {
-      GetECSchemasResponseProto response = rpcProxy.getECSchemas(null,
-          VOID_GET_ECSCHEMAS_REQUEST);
-      ECSchema[] schemas = new ECSchema[response.getSchemasCount()];
+      GetErasureCodingPoliciesResponseProto response = rpcProxy
+          .getErasureCodingPolicies(null, VOID_GET_EC_POLICIES_REQUEST);
+      ErasureCodingPolicy[] ecPolicies =
+          new ErasureCodingPolicy[response.getEcPoliciesCount()];
-      for (ECSchemaProto schemaProto : response.getSchemasList()) {
-        schemas[i++] = PBHelper.convertECSchema(schemaProto);
+      for (ErasureCodingPolicyProto ecPolicyProto : response.getEcPoliciesList()) {
+        ecPolicies[i++] = PBHelper.convertErasureCodingPolicy(ecPolicyProto);
-      return schemas;
+      return ecPolicies;
