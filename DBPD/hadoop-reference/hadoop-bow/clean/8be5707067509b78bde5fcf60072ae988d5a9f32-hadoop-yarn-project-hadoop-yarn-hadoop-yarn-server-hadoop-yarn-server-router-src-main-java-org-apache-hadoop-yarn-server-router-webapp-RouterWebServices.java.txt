YARN-7276. Federation Router Web Service fixes. Contributed by Inigo Goiri.

-  protected RequestInterceptorChainWrapper getInterceptorChain() {
+  protected RequestInterceptorChainWrapper getInterceptorChain(
+      final HttpServletRequest hsr) {
+    if (hsr != null) {
+      user = hsr.getRemoteUser();
+    }
-      user = UserGroupInformation.getCurrentUser().getUserName();
+      if (user == null || user.equals("")) {
+        // Yarn Router user
+        user = UserGroupInformation.getCurrentUser().getUserName();
+      }
-      LOG.error("IOException " + e.getMessage());
+      LOG.error("Cannot get user: {}", e.getMessage());
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(null);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(null);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(null);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(null);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(null);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(null);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(hsr);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(req);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(req);
-    RequestInterceptorChainWrapper pipeline = getInterceptorChain();
+    RequestInterceptorChainWrapper pipeline = getInterceptorChain(req);
