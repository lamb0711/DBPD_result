YARN-10083. Provide utility to ask whether an application is in final status. Contributed by Adam Antal

+
+import com.sun.jersey.api.client.Client;
+import com.sun.jersey.api.client.ClientResponse;
+import com.sun.jersey.api.client.WebResource;
+import org.apache.hadoop.conf.Configuration;
+import org.apache.hadoop.yarn.webapp.util.WebAppUtils;
+
+import javax.ws.rs.core.MediaType;
+
+  /**
+   * Redirect the {@link ContainerLogsRequest} to the NodeManager's
+   * NMWebServices.
+   *
+   * @param conf Configuration object
+   * @param webServiceClient client
+   * @param request the request for container logs
+   * @param logFile name of the log file
+   * @return response from NMWebServices
+   */
+  public static ClientResponse getResponseFromNMWebService(Configuration conf,
+      Client webServiceClient, ContainerLogsRequest request, String logFile) {
+    WebResource webResource =
+        webServiceClient.resource(WebAppUtils.getHttpSchemePrefix(conf)
+            + request.getNodeHttpAddress());
+    return webResource.path("ws").path("v1").path("node")
+        .path("containers").path(request.getContainerId()).path("logs")
+        .path(logFile)
+        .queryParam("size", Long.toString(request.getBytes()))
+        .accept(MediaType.TEXT_PLAIN).get(ClientResponse.class);
+  }
