HADOOP-13529. Do some code refactoring. Contributed by Genmao Yu.

-
