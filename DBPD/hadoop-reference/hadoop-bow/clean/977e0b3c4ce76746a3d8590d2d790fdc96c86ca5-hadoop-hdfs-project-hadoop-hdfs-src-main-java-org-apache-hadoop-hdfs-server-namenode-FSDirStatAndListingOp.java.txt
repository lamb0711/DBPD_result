HDFS-8335. FSNamesystem should construct FSPermissionChecker only if permission is enabled. Contributed by Gabor Liptak.

-    FSPermissionChecker pc = fsd.getPermissionChecker();
-    final String src = fsd.resolvePath(pc, srcArg, pathComponents);
-    final INodesInPath iip = fsd.getINodesInPath(src, true);
+    String src = null;
+
+    if (fsd.isPermissionEnabled()) {
+      FSPermissionChecker pc = fsd.getPermissionChecker();
+      src = fsd.resolvePath(pc, srcArg, pathComponents);
+    } else {
+      src = FSDirectory.resolvePath(srcArg, pathComponents, fsd);
+    }
+    final INodesInPath iip = fsd.getINodesInPath(src, true);
+      FSPermissionChecker pc = fsd.getPermissionChecker();
-    FSPermissionChecker pc = fsd.getPermissionChecker();
-    src = fsd.resolvePath(pc, src, pathComponents);
-    final INodesInPath iip = fsd.getINodesInPath(src, resolveLink);
+      FSPermissionChecker pc = fsd.getPermissionChecker();
+      src = fsd.resolvePath(pc, src, pathComponents);
+      final INodesInPath iip = fsd.getINodesInPath(src, resolveLink);
+    } else {
+      src = FSDirectory.resolvePath(src, pathComponents, fsd);
-    return getFileInfo(fsd, src, resolveLink,
-        FSDirectory.isReservedRawName(srcArg));
+    return getFileInfo(fsd, src, FSDirectory.isReservedRawName(srcArg),
+                       resolveLink);
