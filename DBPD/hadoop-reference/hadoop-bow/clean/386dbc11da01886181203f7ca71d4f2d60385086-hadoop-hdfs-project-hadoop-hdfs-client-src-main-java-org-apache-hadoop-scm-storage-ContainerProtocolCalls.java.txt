HDFS-11196. Ozone: Improve logging and error handling in the container layer. Contributed by Anu Engineer.

-import static java.net.HttpURLConnection.HTTP_BAD_REQUEST;
-import static java.net.HttpURLConnection.HTTP_INTERNAL_ERROR;
-
-import java.io.IOException;
-
-
+import org.apache.hadoop.hdfs.ozone.protocol.proto.ContainerProtos
+    .GetSmallFileRequestProto;
+import org.apache.hadoop.hdfs.ozone.protocol.proto.ContainerProtos
+    .GetSmallFileResponseProto;
+    .PutSmallFileRequestProto;
+import org.apache.hadoop.hdfs.ozone.protocol.proto.ContainerProtos
-import org.apache.hadoop.hdfs.ozone.protocol.proto.ContainerProtos
-    .PutSmallFileRequestProto;
-import org.apache.hadoop.hdfs.ozone.protocol.proto.ContainerProtos
-    .GetSmallFileResponseProto;
-import org.apache.hadoop.hdfs.ozone.protocol.proto.ContainerProtos
-    .GetSmallFileRequestProto;
+import org.apache.hadoop.scm.container.common.helpers.StorageContainerException;
+
+import java.io.IOException;
-    validateContainerResponse(response, traceID);
+    validateContainerResponse(response);
-    validateContainerResponse(response, traceID);
+    validateContainerResponse(response);
-    validateContainerResponse(response, traceID);
+    validateContainerResponse(response);
-    validateContainerResponse(response, traceID);
+    validateContainerResponse(response);
-    validateContainerResponse(response, traceID);
+    validateContainerResponse(response);
-    validateContainerResponse(response, traceID);
+    validateContainerResponse(response);
-    validateContainerResponse(response, traceID);
+    validateContainerResponse(response);
-   * @param traceID container protocol call args
-      ContainerCommandResponseProto response, String traceID
-  ) throws IOException {
-    // TODO : throw the right type of exception
-    switch (response.getResult()) {
-    case SUCCESS:
-      break;
-    case MALFORMED_REQUEST:
-      throw new IOException(HTTP_BAD_REQUEST +
-          ":Bad container request: " + traceID);
-    case UNSUPPORTED_REQUEST:
-      throw new IOException(HTTP_INTERNAL_ERROR +
-          "Unsupported container request: " + traceID);
-    case CONTAINER_INTERNAL_ERROR:
-      throw new IOException(HTTP_INTERNAL_ERROR +
-          "Container internal error:" + traceID);
-    default:
-      throw new IOException(HTTP_INTERNAL_ERROR +
-          "Unrecognized container response:" + traceID);
+      ContainerCommandResponseProto response
+  ) throws StorageContainerException {
+    if (response.getResult() == ContainerProtos.Result.SUCCESS) {
+      return;
+    throw new StorageContainerException(
+        response.getMessage(), response.getResult());
