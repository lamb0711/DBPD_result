YARN-5314. Fixed a ConcurrentModificationException in ATS v1.5 EntityGroupFSTimelineStore. Contributed by Li Lu.

-import org.apache.hadoop.fs.FileSystem;
-import org.apache.hadoop.fs.Path;
-import org.codehaus.jackson.JsonFactory;
-import org.codehaus.jackson.map.ObjectMapper;
-import java.util.ArrayList;
-import java.util.List;
-  private FileSystem fs;
-  public EntityCacheItem(TimelineEntityGroupId gId, Configuration config,
-      FileSystem fs) {
+  public EntityCacheItem(TimelineEntityGroupId gId, Configuration config) {
-    this.fs = fs;
-   * @param jsonFactory JSON factory for the storage
-   * @param objMapper Object mapper for the storage
-      JsonFactory jsonFactory, ObjectMapper objMapper,
-        List<LogInfo> removeList = new ArrayList<>();
-          for (LogInfo log : appLogs.getDetailLogs()) {
-            LOG.debug("Try refresh logs for {}", log.getFilename());
-            // Only refresh the log that matches the cache id
-            if (log.matchesGroupId(groupId)) {
-              Path appDirPath = appLogs.getAppDirPath();
-              if (fs.exists(log.getPath(appDirPath))) {
-                LOG.debug("Refresh logs for cache id {}", groupId);
-                log.parseForStore(tdm, appDirPath, appLogs.isDone(),
-                    jsonFactory, objMapper, fs);
-              } else {
-                // The log may have been removed, remove the log
-                removeList.add(log);
-                LOG.info("File {} no longer exists, removing it from log list",
-                    log.getPath(appDirPath));
-              }
-            }
-          }
+          // Load data from appLogs to tdm
+          appLogs.loadDetailLog(tdm, groupId);
-        appLogs.getDetailLogs().removeAll(removeList);
