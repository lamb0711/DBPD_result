HDFS-4914. Use DFSClient.Conf instead of Configuration.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1494854 13f79535-47bb-0310-9956-ffa450edef68

-import java.io.DataInputStream;
-import org.apache.hadoop.conf.Configuration;
-
+import java.io.DataInputStream;
-  private static int getSlowReadBufferNumChunks(Configuration conf,
+  private static int getSlowReadBufferNumChunks(int bufSize,
-
-    int bufSize =
-        conf.getInt(DFSConfigKeys.DFS_CLIENT_READ_SHORTCIRCUIT_BUFFER_SIZE_KEY,
-            DFSConfigKeys.DFS_CLIENT_READ_SHORTCIRCUIT_BUFFER_SIZE_DEFAULT);
-
-  public BlockReaderLocal(Configuration conf, String filename,
+  public BlockReaderLocal(DFSClient.Conf conf, String filename,
-    if (!verifyChecksum) {
-      this.verifyChecksum = false; 
-    } else {
-      this.verifyChecksum = !conf.getBoolean(DFSConfigKeys.
-          DFS_CLIENT_READ_SHORTCIRCUIT_SKIP_CHECKSUM_KEY, 
-        DFSConfigKeys.DFS_CLIENT_READ_SHORTCIRCUIT_SKIP_CHECKSUM_DEFAULT);
-    }
+    this.verifyChecksum = verifyChecksum && !conf.skipShortCircuitChecksums;
-      int chunksPerChecksumRead = getSlowReadBufferNumChunks(conf, bytesPerChecksum);
+      int chunksPerChecksumRead = getSlowReadBufferNumChunks(
+          conf.shortCircuitBufferSize, bytesPerChecksum);
-      if (!success) {
+      if (success) {
+        if (LOG.isDebugEnabled()) {
+          LOG.debug("Created BlockReaderLocal for file " + filename
+              + " block " + block + " in datanode " + datanodeID);
+        }
+      } else {
