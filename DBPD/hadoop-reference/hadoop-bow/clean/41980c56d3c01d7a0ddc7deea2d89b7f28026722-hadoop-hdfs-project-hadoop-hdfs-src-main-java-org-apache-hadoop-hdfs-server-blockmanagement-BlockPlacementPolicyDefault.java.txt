HDFS-7208. NN doesn't schedule replication when a DN storage fails.  Contributed by Ming Ma

+
+    if (storage.getState() == State.FAILED) {
+      logNodeIsNotChosen(storage, "storage has failed");
+      return false;
+    }
+
