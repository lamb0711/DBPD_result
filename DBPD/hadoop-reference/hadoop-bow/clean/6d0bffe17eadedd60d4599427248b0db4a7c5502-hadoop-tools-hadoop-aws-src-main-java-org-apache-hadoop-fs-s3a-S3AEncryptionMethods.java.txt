HADOOP-14556. S3A to support Delegation Tokens.

Contributed by Steve Loughran and Daryn Sharp.

+ *
+ * There's two enum values for the two client encryption mechanisms the AWS
+ * S3 SDK supports, even though these are not currently supported in S3A.
+ * This is to aid supporting CSE in some form in future, fundamental
+ * issues about file length of encrypted data notwithstanding.
+ *
-  SSE_S3("AES256"),
-  SSE_KMS("SSE-KMS"),
-  SSE_C("SSE-C"),
-  NONE("");
+  NONE("", false),
+  SSE_S3("AES256", true),
+  SSE_KMS("SSE-KMS", true),
+  SSE_C("SSE-C", true),
+  CSE_KMS("CSE-KMS", false),
+  CSE_CUSTOM("CSE-CUSTOM", false);
-      = "Unknown Server Side Encryption algorithm ";
+      = "Unknown encryption algorithm ";
+  private boolean serverSide;
-  S3AEncryptionMethods(String method) {
+  S3AEncryptionMethods(String method, final boolean serverSide) {
+    this.serverSide = serverSide;
+  /**
+   * Flag to indicate this is a server-side encryption option.
+   * @return true if this is server side.
+   */
+  public boolean isServerSide() {
+    return serverSide;
+  }
-    switch(name) {
-    case "AES256":
-      return SSE_S3;
-    case "SSE-KMS":
-      return SSE_KMS;
-    case "SSE-C":
-      return SSE_C;
-    default:
-      throw new IOException(UNKNOWN_ALGORITHM + name);
+    for (S3AEncryptionMethods v : values()) {
+      if (v.getMethod().equals(name)) {
+        return v;
+      }
+    throw new IOException(UNKNOWN_ALGORITHM + name);
