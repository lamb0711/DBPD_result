HDFS-13077. [SPS]: Fix review comments of external storage policy satisfier. Contributed by Rakesh R.

+  private final int spsOutstandingPathsLimit;
-
+    // StoragePolicySatisfier(SPS) configs
-    String spsModeVal =
-        conf.get(
-            DFSConfigKeys.DFS_STORAGE_POLICY_SATISFIER_MODE_KEY,
-            DFSConfigKeys.DFS_STORAGE_POLICY_SATISFIER_MODE_DEFAULT);
+    String spsModeVal = conf.get(
+        DFSConfigKeys.DFS_STORAGE_POLICY_SATISFIER_MODE_KEY,
+        DFSConfigKeys.DFS_STORAGE_POLICY_SATISFIER_MODE_DEFAULT);
+    spsOutstandingPathsLimit = conf.getInt(
+        DFSConfigKeys.DFS_SPS_MAX_OUTSTANDING_PATHS_KEY,
+        DFSConfigKeys.DFS_SPS_MAX_OUTSTANDING_PATHS_DEFAULT);
+    if (spsMode != StoragePolicySatisfierMode.INTERNAL) {
+      LOG.debug("Satisfier is not running inside namenode, so status "
+          + "can't be returned.");
+      throw new IOException("Satisfier is not running inside namenode, "
+          + "so status can't be returned.");
+    }
+   * Verify that satisfier queue limit exceeds allowed outstanding limit.
+   */
+  public void verifyOutstandingSPSPathQLimit() throws IOException {
+    long size = spsPaths.size();
+    // Checking that the SPS call Q exceeds the allowed limit.
+    if (spsOutstandingPathsLimit - size <= 0) {
+      LOG.debug("Satisifer Q - outstanding limit:{}, current size:{}",
+          spsOutstandingPathsLimit, size);
+      throw new IOException("Outstanding satisfier queue limit: "
+          + spsOutstandingPathsLimit + " exceeded, try later!");
+    }
+  }
+
+  /**
