HDFS-4914. Use DFSClient.Conf instead of Configuration.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1494854 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.commons.logging.LogFactory;
+import org.apache.hadoop.HadoopIllegalArgumentException;
-
-  public static final Log LOG = LogFactory.getLog(DomainSocketFactory.class);
+  private static final Log LOG = BlockReaderLocal.LOG;
-    String feature = null;
+    final String feature;
+    } else {
+      feature = null;
-    if (feature != null) {
+
+    if (feature == null) {
+      LOG.debug("Both short-circuit local reads and UNIX domain socket are disabled.");
+    } else {
-        LOG.warn(feature + " is disabled because you have not set " +
-            DFSConfigKeys.DFS_DOMAIN_SOCKET_PATH_KEY);
+        throw new HadoopIllegalArgumentException(feature + " is enabled but "
+            + DFSConfigKeys.DFS_DOMAIN_SOCKET_PATH_KEY + " is not set.");
-        LOG.warn(feature + " is disabled because " +
-              DomainSocket.getLoadingFailureReason());
+        LOG.warn(feature + " cannot be used because "
+            + DomainSocket.getLoadingFailureReason());
-        LOG.debug(feature + "is enabled.");
+        LOG.debug(feature + " is enabled.");
-    if ((conf.domainSocketDataTraffic == false) &&
-        ((!conf.shortCircuitLocalReads) || conf.useLegacyBlockReaderLocal)) {
+    if (!conf.domainSocketDataTraffic &&
+        (!conf.shortCircuitLocalReads || conf.useLegacyBlockReaderLocal)) {
