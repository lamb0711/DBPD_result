HDFS-12506. Ozone: ListBucket is too slow. Contributed by Weiwei Yang.

+import static org.apache.hadoop.ozone.OzoneConsts.KSM_BUCKET_PREFIX;
-          LOG.error("Exception inserting key {}", keyString, ex);
+          LOG.error("Exception inserting key {} type {}", keyString, type, ex);
-    } else {
-      int count = key.length() - key.replace(KSM_VOLUME_PREFIX, "").length();
-      // NOTE : when delimiter gets changed, will need to change this part
-      if (count == 1) {
-        return KeyType.VOLUME;
-      } else if (count == 2) {
-        return KeyType.BUCKET;
-      } else if (count >= 3) {
-        return KeyType.KEY;
-      } else {
-        return KeyType.UNKNOWN;
-      }
+    } else if (key.startsWith(KSM_VOLUME_PREFIX)) {
+      return key.replaceFirst(KSM_VOLUME_PREFIX, "")
+          .contains(KSM_BUCKET_PREFIX) ? KeyType.BUCKET : KeyType.VOLUME;
+    }else {
+      return KeyType.KEY;
