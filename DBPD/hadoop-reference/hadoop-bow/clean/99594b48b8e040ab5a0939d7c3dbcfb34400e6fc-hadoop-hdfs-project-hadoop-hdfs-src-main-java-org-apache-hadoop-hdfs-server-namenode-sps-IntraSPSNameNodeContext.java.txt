HDFS-13075. [SPS]: Provide External Context implementation. Contributed by Uma Maheswara Rao G.

-import org.apache.hadoop.hdfs.server.blockmanagement.BlockCollection;
-  public boolean hasLowRedundancyBlocks(long inodeID) {
-    namesystem.readLock();
-    try {
-      BlockCollection bc = namesystem.getBlockCollection(inodeID);
-      if (bc == null) {
-        return false;
-      }
-      return blockManager.hasLowRedundancyBlocks(bc);
-    } finally {
-      namesystem.readUnlock();
-    }
+  public boolean hasLowRedundancyBlocks(long inodeId) {
+    return blockManager.hasLowRedundancyBlocks(inodeId);
-  public boolean verifyTargetDatanodeHasSpaceForScheduling(DatanodeInfo dn,
-      StorageType type, long blockSize) {
+  public boolean checkDNSpaceForScheduling(DatanodeInfo dn, StorageType type,
+      long blockSize) {
+
+  @Override
+  public void close() throws IOException {
+    // Nothing to clean.
+  }
