HADOOP-6394. Add a helper class to simplify FileContext related tests and improve code reusability. Contributed by Jitendra Nath Pandey.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@891511 13f79535-47bb-0310-9956-ffa450edef68

-import java.util.EnumSet;
+import static org.apache.hadoop.fs.FileContextTestHelper.*;
+
-public class FileContextPermissionBase {  
-  static final String TEST_ROOT_DIR = new Path(System.getProperty(
-      "test.build.data", "/tmp")).toString().replace(' ', '_')
-      + "/" + TestLocalFileSystemPermission.class.getSimpleName() + "_";
+public abstract class FileContextPermissionBase {  
-  protected Path getTestRootRelativePath(String pathString) {
-    return fc.makeQualified(new Path(TEST_ROOT_DIR, pathString));
-  }
-  
-  private Path rootPath = null;
-  protected Path getTestRootPath() {
-    if (rootPath == null) {
-      rootPath = fc.makeQualified(new Path(TEST_ROOT_DIR));
-    }
-    return rootPath;   
-  }
-
-
-    fc.mkdir(getTestRootPath(), FileContext.DEFAULT_PERM, true);
+    fc.mkdir(getTestRootPath(fc), FileContext.DEFAULT_PERM, true);
-    fc.delete(getTestRootPath(), true);
+    fc.delete(getTestRootPath(fc), true);
-
-  private Path writeFile(FileContext theFc, String name) throws IOException {
-    Path f = getTestRootRelativePath(name);
-    FSDataOutputStream stm = theFc.create(f, EnumSet.of(CreateFlag.CREATE));
-    stm.writeBytes("42\n");
-    stm.close();
-    return f;
-  }
-
-    Path f = writeFile(fc, filename);
+    Path f = createFile(fc, filename);
-    Path f = writeFile(fc, filename);
+    Path f = createFile(fc, filename);
-    Path f = writeFile(fc, filename);
+    Path f = createFile(fc, filename);
