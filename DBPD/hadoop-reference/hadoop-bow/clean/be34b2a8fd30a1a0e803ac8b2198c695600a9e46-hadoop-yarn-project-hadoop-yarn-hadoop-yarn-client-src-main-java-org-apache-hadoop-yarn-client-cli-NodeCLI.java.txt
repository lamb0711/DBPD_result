YARN-1126. Add validation of users input nodes-states options to nodes CLI. Contributed by Wei Yan.

-        "Works with -list to filter nodes based on input comma-separated list of node states.");
+        "Works with -list to filter nodes based on input comma-separated " +
+        "list of node states. " + getAllValidNodeStates());
+    if (args != null && args.length > 0) {
+      for (int i = args.length - 1; i >= 0; i--) {
+        if (args[i].equalsIgnoreCase("-" + NODE_ALL)) {
+          args[i] = "-" + NODE_ALL;
+        }
+      }
+    }
+
-              nodeStates.add(NodeState.valueOf(
-                  org.apache.hadoop.util.StringUtils.toUpperCase(type.trim())));
+              try {
+                nodeStates.add(NodeState.valueOf(
+                    org.apache.hadoop.util.StringUtils.toUpperCase(
+                            type.trim())));
+              } catch (IllegalArgumentException ex) {
+                sysout.println("The node state " + type + " is invalid.");
+                sysout.println(getAllValidNodeStates());
+                return exitCode;
+              }
+
+  private String getAllValidNodeStates() {
+    StringBuilder sb = new StringBuilder();
+    sb.append("The valid node state can be one of the following: ");
+    for (NodeState state : NodeState.values()) {
+      sb.append(state).append(",");
+    }
+    String output = sb.toString();
+    return output.substring(0, output.length() - 1) + ".";
+  }
