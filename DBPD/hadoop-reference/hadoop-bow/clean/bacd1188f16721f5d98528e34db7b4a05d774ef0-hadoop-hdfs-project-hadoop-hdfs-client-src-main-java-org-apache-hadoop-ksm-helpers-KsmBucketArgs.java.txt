HDFS-11880. Ozone: KSM: Remove protobuf formats from KSM wrappers. Contributed by Nandakumar Vadivelu.

+import java.util.stream.Collectors;
-import org.apache.hadoop.hdfs.protocol.proto
-    .HdfsProtos.StorageTypeProto;
+import org.apache.hadoop.fs.StorageType;
+import org.apache.hadoop.hdfs.protocolPB.PBHelperClient;
+import org.apache.hadoop.ozone.OzoneAcl;
-import org.apache.hadoop.ozone.protocol.proto
-    .KeySpaceManagerProtocolProtos.OzoneAclInfo;
+import org.apache.hadoop.ozone.protocolPB.KSMPBHelper;
-  private List<OzoneAclInfo> addAcls;
+  private List<OzoneAcl> addAcls;
-  private List<OzoneAclInfo> removeAcls;
+  private List<OzoneAcl> removeAcls;
-  private StorageTypeProto storageType;
+  private StorageType storageType;
-      List<OzoneAclInfo> addAcls, List<OzoneAclInfo> removeAcls,
-      Boolean isVersionEnabled, StorageTypeProto storageType) {
+      List<OzoneAcl> addAcls, List<OzoneAcl> removeAcls,
+      Boolean isVersionEnabled, StorageType storageType) {
-  public List<OzoneAclInfo> getAddAcls() {
+  public List<OzoneAcl> getAddAcls() {
-  public List<OzoneAclInfo> getRemoveAcls() {
+  public List<OzoneAcl> getRemoveAcls() {
-  public StorageTypeProto getStorageType() {
+  public StorageType getStorageType() {
-    private List<OzoneAclInfo> addAcls;
-    private List<OzoneAclInfo> removeAcls;
+    private List<OzoneAcl> addAcls;
+    private List<OzoneAcl> removeAcls;
-    private StorageTypeProto storageType;
+    private StorageType storageType;
-    public Builder setAddAcls(List<OzoneAclInfo> acls) {
+    public Builder setAddAcls(List<OzoneAcl> acls) {
-    public Builder setRemoveAcls(List<OzoneAclInfo> acls) {
+    public Builder setRemoveAcls(List<OzoneAcl> acls) {
-    public Builder setStorageType(StorageTypeProto storage) {
+    public Builder setStorageType(StorageType storage) {
-      builder.addAllAddAcls(addAcls);
+      builder.addAllAddAcls(addAcls.stream().map(
+          KSMPBHelper::convertOzoneAcl).collect(Collectors.toList()));
-      builder.addAllRemoveAcls(removeAcls);
+      builder.addAllRemoveAcls(removeAcls.stream().map(
+          KSMPBHelper::convertOzoneAcl).collect(Collectors.toList()));
-      builder.setStorageType(storageType);
+      builder.setStorageType(
+          PBHelperClient.convertStorageType(storageType));
-        bucketArgs.getAddAclsList(),
-        bucketArgs.getRemoveAclsList(),
-        bucketArgs.hasIsVersionEnabled() ? bucketArgs.getIsVersionEnabled() :
-        null,
-        bucketArgs.hasStorageType() ? bucketArgs.getStorageType() : null);
+        bucketArgs.getAddAclsList().stream().map(
+            KSMPBHelper::convertOzoneAcl).collect(Collectors.toList()),
+        bucketArgs.getRemoveAclsList().stream().map(
+            KSMPBHelper::convertOzoneAcl).collect(Collectors.toList()),
+        bucketArgs.hasIsVersionEnabled() ?
+            bucketArgs.getIsVersionEnabled() : null,
+        bucketArgs.hasStorageType() ? PBHelperClient.convertStorageType(
+            bucketArgs.getStorageType()) : null);
