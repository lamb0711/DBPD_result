Merge trunk into branch


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-3077@1396918 13f79535-47bb-0310-9956-ffa450edef68

+  private final String pattern;
-        resource.getVisibility());
+        resource.getVisibility(),
+        resource.getPattern());
-      LocalResourceVisibility visibility) {
+      LocalResourceVisibility visibility, String pattern) {
+    this.pattern = pattern;
-    return loc.hashCode() ^
+    int hash = loc.hashCode() ^
+    if(pattern != null) {
+      hash = hash ^ pattern.hashCode();
+    }
+    return hash;
+    String pattern = getPattern();
+    String otherPattern = other.getPattern();
+    boolean patternEquals = (pattern == null && otherPattern == null) || 
+       (pattern != null && otherPattern != null && pattern.equals(otherPattern)); 
-           getType() == other.getType();
+           getType() == other.getType() &&
+           patternEquals;
+        if (0 == ret) {
+          String pattern = getPattern();
+          String otherPattern = other.getPattern();
+          if (pattern == null && otherPattern == null) {
+            ret = 0;
+          } else if (pattern == null) {
+            ret = -1;
+          } else if (otherPattern == null) {
+            ret = 1;
+          } else {
+            ret = pattern.compareTo(otherPattern);    
+          }
+        }
+  public String getPattern() {
+    return pattern;
+  }
+  
+  @Override
-
+  
+  @Override
+  public void setPattern(String pattern) {
+    throw new UnsupportedOperationException();
+  }
+  
-    sb.append(getType()).append(" }");
+    sb.append(getType()).append(", ");
+    sb.append(getPattern()).append(" }");
