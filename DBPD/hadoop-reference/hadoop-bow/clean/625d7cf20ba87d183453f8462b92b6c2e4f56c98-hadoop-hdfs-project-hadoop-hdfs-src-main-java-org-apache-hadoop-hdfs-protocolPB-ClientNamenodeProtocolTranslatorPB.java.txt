HDFS-4087. Protocol changes for listSnapshots functionality. Contributed by Brandon Li.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1400698 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.hdfs.protocol.SnapshotInfo;
+import org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos.ListSnapshotsRequestProto;
+import org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos.ListSnapshotsResponseProto;
+import org.apache.hadoop.hdfs.protocol.proto.HdfsProtos.SnapshotInfoProto;
-    
+  }
+
+  @Override
+  public SnapshotInfo[] listSnapshots(String snapshotRoot) throws IOException {
+    SnapshotInfo[] sinfo = null;
+    ListSnapshotsRequestProto req = null;
+
+    req = ListSnapshotsRequestProto.newBuilder().setSnapshotRoot(snapshotRoot)
+        .build();
+    try {
+      ListSnapshotsResponseProto resp = rpcProxy.listSnapshots(null, req);
+      sinfo = new SnapshotInfo[resp.getSnapshotsCount()];
+      for (int i = 0; i < resp.getSnapshotsCount(); i++) {
+        SnapshotInfoProto siProto = resp.getSnapshots(i);
+        sinfo[i] = new SnapshotInfo(siProto.getSnapshotName(), resp
+            .getSnapshots(i).getSnapshotRoot(), siProto.getCreateTime(),
+            siProto.getPermission(), siProto.getOwner(), siProto.getGroup());
+      }
+      return sinfo;
+    } catch (ServiceException e) {
+      throw ProtobufHelper.getRemoteException(e);
+    }
