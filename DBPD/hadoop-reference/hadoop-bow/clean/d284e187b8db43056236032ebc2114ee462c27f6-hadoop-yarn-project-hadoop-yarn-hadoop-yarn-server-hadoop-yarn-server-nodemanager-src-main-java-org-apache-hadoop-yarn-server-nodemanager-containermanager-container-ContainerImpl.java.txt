YARN-2046. Out of band heartbeats are sent only on container kill and possibly too early. Contributed by Ming Ma

+import org.apache.hadoop.yarn.server.nodemanager.Context;
+  private Context context;
-      NMStateStoreService stateStore, ContainerLaunchContext launchContext,
-      Credentials creds, NodeManagerMetrics metrics,
-      ContainerTokenIdentifier containerTokenIdentifier) {
+      ContainerLaunchContext launchContext, Credentials creds,
+      NodeManagerMetrics metrics,
+      ContainerTokenIdentifier containerTokenIdentifier, Context context) {
-    this.stateStore = stateStore;
+    this.stateStore = context.getNMStateStore();
+    this.context = context;
-      NMStateStoreService stateStore, ContainerLaunchContext launchContext,
-      Credentials creds, NodeManagerMetrics metrics,
+      ContainerLaunchContext launchContext, Credentials creds,
+      NodeManagerMetrics metrics,
-      String diagnostics, boolean wasKilled, Resource recoveredCapability) {
-    this(conf, dispatcher, stateStore, launchContext, creds, metrics,
-        containerTokenIdentifier);
+      String diagnostics, boolean wasKilled, Resource recoveredCapability,
+      Context context) {
+    this(conf, dispatcher, launchContext, creds, metrics,
+        containerTokenIdentifier, context);
-      if (container.getCurrentState() 
+      if (container.getCurrentState()
+      container.context.getNodeStatusUpdater().sendOutofBandHeartBeat();
