HDFS-13300. Ozone: Remove DatanodeID dependency from HDSL and Ozone.
Contributed by Nanda kumar.

+import org.apache.hadoop.hdfs.server.datanode.DataNode;
+import org.apache.hadoop.hdsl.protocol.DatanodeDetails;
+
+import org.apache.hadoop.util.ServicePlugin;
+    String path = GenericTestUtils.getTempPath(
+        MiniOzoneClassicCluster.class.getSimpleName() + "datanode");
+    dnConf.setStrings(ScmConfigKeys.OZONE_SCM_DATANODE_ID,
+        path + "/" + i + "-datanode.id");
-        getDataNodes().get(dnIndex).getDatanodeId().getOzoneRestPort());
+        getOzoneRestPort(getDataNodes().get(dnIndex)));
+  public static DatanodeDetails getDatanodeDetails(DataNode dataNode) {
+    DatanodeDetails datanodeDetails = null;
+    for (ServicePlugin plugin : dataNode.getPlugins()) {
+      if (plugin instanceof HdslDatanodeService) {
+        datanodeDetails = ((HdslDatanodeService) plugin).getDatanodeDetails();
+      }
+    }
+    return datanodeDetails;
+  }
+
+  public static int getOzoneRestPort(DataNode dataNode) {
+    return getDatanodeDetails(dataNode).getOzoneRestPort();
+  }
+
-          "org.apache.hadoop.ozone.HdslServerPlugin,"
-              + "org.apache.hadoop.ozone.web.ObjectStoreRestPlugin");
+          "org.apache.hadoop.ozone.web.ObjectStoreRestPlugin," +
+          "org.apache.hadoop.ozone.HdslDatanodeService");
-
-      // TODO : Fix this, we need a more generic mechanism to map
-      // different datanode ID for different datanodes when we have lots of
-      // datanodes in the cluster.
-      conf.setStrings(ScmConfigKeys.OZONE_SCM_DATANODE_ID,
-          scmPath.toString() + "/datanode.id");
