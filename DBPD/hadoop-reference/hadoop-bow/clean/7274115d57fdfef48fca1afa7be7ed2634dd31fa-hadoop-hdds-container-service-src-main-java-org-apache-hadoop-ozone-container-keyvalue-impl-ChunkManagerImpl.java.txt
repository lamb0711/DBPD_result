HDDS-890. Handle OverlappingFileLockException during writeStateMachineData in ContainerStateMachine. Contributed by Shashikant Banerjee.

-   * @param stage - Stage of the Chunk operation
+   * @param dispatcherContext - dispatcherContextInfo
-      ByteBuffer data, DispatcherContext.WriteChunkStage stage)
+      ByteBuffer data, DispatcherContext dispatcherContext)
-
+    Preconditions.checkNotNull(dispatcherContext);
+    DispatcherContext.WriteChunkStage stage = dispatcherContext.getStage();
-      File tmpChunkFile = getTmpChunkFile(chunkFile, info);
+      File tmpChunkFile = getTmpChunkFile(chunkFile, dispatcherContext);
+        // While committing a chunk , just rename the tmp chunk file which has
+        // the same term and log index appended as the current transaction
-   * @param readFromTmpFile whether to read from tmp chunk file or not.
+   * @param dispatcherContext dispatcher context info.
-      boolean readFromTmpFile) throws StorageContainerException {
+      DispatcherContext dispatcherContext) throws StorageContainerException {
-        if (!chunkFile.exists() && readFromTmpFile) {
-          chunkFile = getTmpChunkFile(chunkFile, info);
+        if (!chunkFile.exists() && dispatcherContext.isReadFromTmpFile()) {
+          chunkFile = getTmpChunkFile(chunkFile, dispatcherContext);
-   * @param chunkFile
-   * @param info
+   * @param chunkFile chunkFileName
+   * @param dispatcherContext dispatcher context info
-  private File getTmpChunkFile(File chunkFile, ChunkInfo info)
-      throws StorageContainerException {
+  private File getTmpChunkFile(File chunkFile,
+      DispatcherContext dispatcherContext)  {
-            OzoneConsts.CONTAINER_TEMPORARY_CHUNK_PREFIX);
+            OzoneConsts.CONTAINER_TEMPORARY_CHUNK_PREFIX +
+            OzoneConsts.CONTAINER_CHUNK_NAME_DELIMITER +
+            dispatcherContext.getTerm() +
+            OzoneConsts.CONTAINER_CHUNK_NAME_DELIMITER +
+            dispatcherContext.getLogIndex());
