HDFS-5378. In CacheReport, don't send genstamp and length on the wire (Contributed by Colin Patrick McCabe)

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-4949@1534334 13f79535-47bb-0310-9956-ffa450edef68

-import java.util.ArrayList;
+import java.util.List;
-import org.apache.hadoop.hdfs.server.protocol.CacheReport;
-      StorageReport[] reports, CacheReport[] cacheReports, int xmitsInProgress,
-      int xceiverCount, int failedVolumes) throws IOException {
+      StorageReport[] reports, long dnCacheCapacity, long dnCacheUsed,
+          int xmitsInProgress, int xceiverCount, int failedVolumes)
+              throws IOException {
-    for (CacheReport r : cacheReports) {
-      builder.addCacheReports(PBHelper.convert(r));
+    if (dnCacheCapacity != 0) {
+      builder.setDnCacheCapacity(dnCacheCapacity);
-    
+    if (dnCacheUsed != 0) {
+      builder.setDnCacheUsed(dnCacheUsed);
+    }
-      String poolId, long[] blocks) throws IOException {
+      String poolId, List<Long> blockIds) throws IOException {
-    for (int i=0; i<blocks.length; i++) {
-      builder.addBlocks(blocks[i]);
+    for (Long blockId : blockIds) {
+      builder.addBlocks(blockId);
