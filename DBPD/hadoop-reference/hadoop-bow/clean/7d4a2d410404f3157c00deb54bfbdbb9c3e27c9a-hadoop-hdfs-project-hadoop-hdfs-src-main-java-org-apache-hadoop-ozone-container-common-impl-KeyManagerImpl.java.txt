HDFS-11569. Ozone: Implement listKey function for KeyManager. Contributed by Weiwei Yang.

+import org.apache.hadoop.ozone.container.common.helpers.FilteredKeys;
+import org.apache.hadoop.ozone.container.common.helpers.FilteredKeys.KeyPrefixFilter;
+import org.apache.hadoop.ozone.container.common.helpers.FilteredKeys.PreKeyFilter;
-  public List<KeyData> listKey(Pipeline pipeline, String prefix, String
-      prevKey, int count) {
-    // TODO : Implement listKey function.
-    return null;
+  public List<KeyData> listKey(
+      Pipeline pipeline, String prefix, String prevKey, int count)
+      throws StorageContainerException {
+    Preconditions.checkNotNull(pipeline,
+        "Pipeline cannot be null.");
+    Preconditions.checkArgument(count > 0,
+        "Count must be a positive number.");
+    ContainerData cData = containerManager.readContainer(pipeline
+        .getContainerName());
+    LevelDBStore db = KeyUtils.getDB(cData, conf);
+    try (FilteredKeys filteredKeys = new FilteredKeys(db, count)) {
+      filteredKeys.addKeyFilter(new KeyPrefixFilter(prefix));
+      filteredKeys.addKeyFilter(new PreKeyFilter(db, prevKey));
+      return filteredKeys.getFilteredKeys();
+    }
