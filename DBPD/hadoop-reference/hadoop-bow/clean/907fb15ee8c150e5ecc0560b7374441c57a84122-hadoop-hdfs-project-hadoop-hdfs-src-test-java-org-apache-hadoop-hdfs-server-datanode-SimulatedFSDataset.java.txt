HDFS-5480. Update Balancer for HDFS-2832. (Contributed by szetszwo)

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2832@1540547 13f79535-47bb-0310-9956-ffa450edef68

-import java.util.*;
+import java.util.ArrayList;
+import java.util.HashMap;
+import java.util.LinkedList;
+import java.util.List;
+import java.util.Map;
+import org.apache.hadoop.hdfs.server.protocol.DatanodeStorage;
-    private final String storageUuid = "SimulatedStorage-UUID";
+    private final String storageUuid = "SimulatedStroage-" + DatanodeStorage.newStorageID();
-    private long capacity;  // in bytes
+    private final long capacity;  // in bytes
-    synchronized long getCapacity() {
+    long getCapacity() {
-    public String getStorageUuid() {
+    String getStorageUuid() {
+
+    synchronized StorageReport getStorageReport(String bpid) {
+      return new StorageReport(getStorageUuid(), false, getCapacity(),
+          getUsed(), getFree(), map.get(bpid).getUsed());
+    }
-      this.datanodeUuid = "unknownStorageId-" + UUID.randomUUID();
+      this.datanodeUuid = "SimulatedDatanode-" + DataNode.generateUuid();
+
-    reports.put("", getBlockReport(bpid));
+    reports.put(storage.storageUuid, getBlockReport(bpid));
-    return new StorageReport[0];
+    return new StorageReport[] {storage.getStorageReport(bpid)};
