YARN-8967. Change FairScheduler to use PlacementRule interface. Contributed by Wilfred Spiegelenburg.

-   * Set a rule to generate the parent queue dynamically.
+   * Set a rule to generate the parent queue dynamically. The parent rule
+   * should only be called on rule creation when the policy is read from the
+   * configuration.
-  void setParentRule(PlacementRule parent) {
+  public void setParentRule(PlacementRule parent) {
-  PlacementRule getParentRule() {
+  @VisibleForTesting
+  public PlacementRule getParentRule() {
+   * Get the create flag as set during the config setup.
+   * @return The value of the {@link #createQueue} flag
+   */
+  public boolean getCreateFlag() {
+    return createQueue;
+  }
+
+  /**
-      return Boolean.parseBoolean(create);
+      return create.isEmpty() || Boolean.parseBoolean(create);
