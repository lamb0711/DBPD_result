HDFS-4230. Support listing of all the snapshottable directories.  Contributed by Jing Zhao


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1429643 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.hdfs.DFSUtil;
+import org.apache.hadoop.hdfs.protocol.SnapshottableDirectoryStatus;
+  /**
+   * @return All the current snapshottable directories
+   */
+  public SnapshottableDirectoryStatus[] getSnapshottableDirListing() {
+    if (snapshottables.isEmpty()) {
+      return null;
+    }
+    
+    SnapshottableDirectoryStatus[] status = 
+        new SnapshottableDirectoryStatus[snapshottables.size()];
+    for (int i = 0; i < snapshottables.size(); i++) {
+      INodeDirectorySnapshottable dir = snapshottables.get(i);
+      status[i] = new SnapshottableDirectoryStatus(dir.getModificationTime(),
+          dir.getAccessTime(), dir.getFsPermission(), dir.getUserName(),
+          dir.getGroupName(), dir.getLocalNameBytes(), dir.getNumSnapshots(),
+          dir.getSnapshotQuota(), dir.getParent() == null ? new byte[0]
+              : DFSUtil.string2Bytes(dir.getParent().getFullPathName()));
+    }
+    return status;
+  }
+  
+  /**
+   * Remove snapshottable directories from {@link #snapshottables}
+   * @param toRemoveList A list of INodeDirectorySnapshottable to be removed
+   */
+  public void removeSnapshottableDirs(
+      List<INodeDirectorySnapshottable> toRemoveList) {
+    if (toRemoveList != null) {
+      this.snapshottables.removeAll(toRemoveList);
+    }
+  }
