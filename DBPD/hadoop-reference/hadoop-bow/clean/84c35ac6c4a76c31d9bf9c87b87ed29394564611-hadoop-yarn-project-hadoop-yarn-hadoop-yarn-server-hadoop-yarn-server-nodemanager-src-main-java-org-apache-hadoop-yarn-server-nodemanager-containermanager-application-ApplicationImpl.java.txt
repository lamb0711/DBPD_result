YARN-4711. NM is going down with NPE's due to single thread processing of events by Timeline client (Naganarasimha G R via sjlee)

+import org.apache.hadoop.yarn.server.nodemanager.timelineservice.NMTimelinePublisher;
-  private TimelineClient timelineClient;
-        createAndStartTimelineClient(conf);
+        context.getNMTimelinePublisher().createTimelineClient(appId);
-  private void createAndStartTimelineClient(Configuration conf) {
-    // create and start timeline client
-    this.timelineClient = TimelineClient.createTimelineClient(appId);
-    timelineClient.init(conf);
-    timelineClient.start();
-  }
-
-  public TimelineClient getTimelineClient() {
-    return timelineClient;
-  }
-
-  @Override
-      TimelineClient timelineClient = app.getTimelineClient();
-      if (timelineClient != null) {
-        timelineClient.stop();
+      NMTimelinePublisher nmTimelinePublisher =
+          app.context.getNMTimelinePublisher();
+      if (nmTimelinePublisher != null) {
+        nmTimelinePublisher.stopTimelineClient(app.getAppId());
