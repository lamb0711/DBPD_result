YARN-9037. [CSI] Ignore volume resource in resource calculators based on tags. Contributed by Sunil Govindan.

+  public static final String EXTERNAL_VOLUME_RESOURCE_TAG = "system:csi-volume";
+  private static volatile Map<String, ResourceInformation> nonCountableResourceTypes;
+  private static volatile int numNonCountableResourceTypes = -1;
+    nonCountableResourceTypes = new HashMap<>();
+    numNonCountableResourceTypes = nonCountableResourceTypes.size();
+    List<ResourceInformation> nonCountableResources = new ArrayList<>();
+        if (resInfo.getTags() != null && resInfo.getTags()
+            .contains(EXTERNAL_VOLUME_RESOURCE_TAG)) {
+          nonCountableResources.add(resInfo);
+          continue;
+        }
+
+    // Add all non-countable resource types to the end of the resource array.
+    for(ResourceInformation resInfo: nonCountableResources) {
+      resourceTypesArray[index] = ResourceInformation.newInstance(resInfo);
+      nonCountableResourceTypes.put(resInfo.getName(), resInfo);
+      index++;
+    }
+  public static int getNumberOfCountableResourceTypes() {
+    if (numKnownResourceTypes < 0) {
+      initializeResourceTypesIfNeeded();
+    }
+    return numKnownResourceTypes - numNonCountableResourceTypes;
+  }
+
+    numNonCountableResourceTypes = nonCountableResourceTypes.size();
