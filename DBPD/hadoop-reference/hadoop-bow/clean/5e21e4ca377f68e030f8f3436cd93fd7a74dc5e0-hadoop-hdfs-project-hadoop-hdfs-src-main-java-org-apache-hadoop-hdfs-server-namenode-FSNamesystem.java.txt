HDFS-6353. Check and make checkpoint before stopping the NameNode. Contributed by Jing Zhao.

-   * 
-   * @throws AccessControlException if superuser privilege is violated.
-   * @throws IOException if 
-  void saveNamespace() throws AccessControlException, IOException {
+  boolean saveNamespace(final long timeWindow, final long txGap)
+      throws IOException {
+    boolean saved = false;
-      getFSImage().saveNamespace(this);
+      saved = getFSImage().saveNamespace(timeWindow, txGap, this);
-    LOG.info("New namespace image has been created");
+    if (saved) {
+      LOG.info("New namespace image has been created");
+    }
+    return saved;
