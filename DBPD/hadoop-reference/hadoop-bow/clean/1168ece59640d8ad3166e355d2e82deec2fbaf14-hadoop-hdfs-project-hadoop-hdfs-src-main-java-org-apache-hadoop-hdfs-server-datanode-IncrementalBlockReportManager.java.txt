HDFS-11534. Add counters for number of blocks in pending IBR. Contributed by Xiaobing Zhou.

+    private DataNodeMetrics dnMetrics;
+    PerStorageIBR(final DataNodeMetrics dnMetrics) {
+      this.dnMetrics = dnMetrics;
+    }
+
+      increaseBlocksCounter(rdbi);
+    }
+
+    private void increaseBlocksCounter(
+        final ReceivedDeletedBlockInfo receivedDeletedBlockInfo) {
+      switch (receivedDeletedBlockInfo.getStatus()) {
+      case RECEIVING_BLOCK:
+        dnMetrics.incrBlocksReceivingInPendingIBR();
+        break;
+      case RECEIVED_BLOCK:
+        dnMetrics.incrBlocksReceivedInPendingIBR();
+        break;
+      case DELETED_BLOCK:
+        dnMetrics.incrBlocksDeletedInPendingIBR();
+        break;
+      default:
+        break;
+      }
+      dnMetrics.incrBlocksInPendingIBR();
+  private DataNodeMetrics dnMetrics;
-  IncrementalBlockReportManager(final long ibrInterval) {
+  IncrementalBlockReportManager(
+      final long ibrInterval,
+      final DataNodeMetrics dnMetrics) {
+    this.dnMetrics = dnMetrics;
+
+    /* set blocks to zero */
+    this.dnMetrics.resetBlocksInPendingIBR();
+
-      String bpid, DataNodeMetrics metrics) throws IOException {
+      String bpid) throws IOException {
-      metrics.addIncrementalBlockReport(monotonicNow() - startTime);
+
+        dnMetrics.addIncrementalBlockReport(monotonicNow() - startTime);
-      perStorage = new PerStorageIBR();
+      perStorage = new PerStorageIBR(dnMetrics);
