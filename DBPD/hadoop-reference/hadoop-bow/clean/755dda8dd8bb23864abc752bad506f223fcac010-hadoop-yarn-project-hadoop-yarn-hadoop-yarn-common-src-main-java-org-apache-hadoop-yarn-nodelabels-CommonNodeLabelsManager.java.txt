YARN-4405. Support node label store in non-appendable file system. Contributed by Wangda Tan

+import org.apache.hadoop.util.ReflectionUtils;
+  boolean isCentralizedConfiguration() {
+    return isCentralizedNodeLabelConfiguration;
+  }
+
-    this.store = new FileSystemNodeLabelsStore(this);
+    this.store =
+        ReflectionUtils
+            .newInstance(
+                conf.getClass(YarnConfiguration.FS_NODE_LABELS_STORE_IMPL_CLASS,
+                    FileSystemNodeLabelsStore.class, NodeLabelsStore.class),
+                conf);
+    this.store.setNodeLabelsManager(this);
-    this.store.recover(!isCentralizedNodeLabelConfiguration);
+    this.store.recover();
