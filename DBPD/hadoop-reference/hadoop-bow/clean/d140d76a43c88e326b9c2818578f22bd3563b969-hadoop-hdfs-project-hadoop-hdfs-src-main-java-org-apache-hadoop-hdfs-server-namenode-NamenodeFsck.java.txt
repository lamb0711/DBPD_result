HDFS-7467. Provide storage tier information for a directory via fsck. (Benoy Antony)

+import java.util.Arrays;
+import org.apache.hadoop.fs.StorageType;
+  private boolean showStoragePolcies = false;
+  private StoragePolicySummary storageTypeSummary = null;
+      else if (key.equals("storagepolicies")) { this.showStoragePolcies = true; }
+        if (this.showStoragePolcies) {
+          storageTypeSummary = new StoragePolicySummary(
+              namenode.getNamesystem().getBlockManager().getStoragePolicies());
+        }
+
+        if (this.showStoragePolcies) {
+          out.print(storageTypeSummary.toString());
+        }
+
-      NumberReplicas numberReplicas = namenode.getNamesystem().getBlockManager().countNodes(block.getLocalBlock());
+      NumberReplicas numberReplicas =
+          namenode.getNamesystem().getBlockManager().countNodes(block.getLocalBlock());
+      //keep track of storage tier counts
+      if (this.showStoragePolcies && lBlk.getStorageTypes() != null) {
+        StorageType[] storageTypes = lBlk.getStorageTypes();
+        storageTypeSummary.add(Arrays.copyOf(storageTypes, storageTypes.length),
+            fsn.getBlockManager().getStoragePolicy(file.getStoragePolicy()));
+      }
