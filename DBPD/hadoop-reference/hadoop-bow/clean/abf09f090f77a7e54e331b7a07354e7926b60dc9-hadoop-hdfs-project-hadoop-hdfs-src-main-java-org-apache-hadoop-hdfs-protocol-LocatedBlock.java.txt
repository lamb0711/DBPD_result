HDFS-4990. Change BlockPlacementPolicy to choose storages instead of datanodes.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2832@1524444 13f79535-47bb-0310-9956-ffa450edef68

-  public static LocatedBlock createLocatedBlock(ExtendedBlock b,
-      DatanodeStorageInfo[] storages, long startOffset, boolean corrupt) {
-    final DatanodeInfo[] locs = new DatanodeInfo[storages.length];
-    final String[] storageIDs = new String[storages.length];
-    final StorageType[] storageType = new StorageType[storages.length];
-    for(int i = 0; i < storages.length; i++) {
-      locs[i] = storages[i].getDatanodeDescriptor();
-      storageIDs[i] = storages[i].getStorageID();
-      storageType[i] = storages[i].getStorageType();
-    }
-    return new LocatedBlock(b, locs, storageIDs, storageType, startOffset, corrupt);
+  public LocatedBlock(ExtendedBlock b, DatanodeStorageInfo[] storages) {
+    this(b, storages, -1, false); // startOffset is unknown
+
+  public LocatedBlock(ExtendedBlock b, DatanodeStorageInfo[] storages,
+      long startOffset, boolean corrupt) {
+    this(b, DatanodeStorageInfo.toDatanodeInfos(storages),
+        DatanodeStorageInfo.toStorageIDs(storages),
+        DatanodeStorageInfo.toStorageTypes(storages),
+        startOffset, corrupt); // startOffset is unknown
+  }
+
