HADOOP-6394. Add a helper class to simplify FileContext related tests and improve code reusability. Contributed by Jitendra Nath Pandey.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@891511 13f79535-47bb-0310-9956-ffa450edef68

-import java.util.EnumSet;
+import org.junit.Before;
+import static org.apache.hadoop.fs.FileContextTestHelper.*;
+
-      "build/test/data") + "/testContextURI";
+  "build/test/data") + "/testContextURI";
-  private static int BLOCK_SIZE = 1024;
-
-  private static byte[] data = new byte[BLOCK_SIZE * 2]; // two blocks of data
-  {
-    for (int i = 0; i < data.length; i++) {
-      data[i] = (byte) (i % 10);
-    }
-  }
-
-  // Helper method to create file and write data to file
-  protected void createFile(Path path, FileContext fc) throws IOException {
-    FSDataOutputStream out = fc.create(path, EnumSet.of(CreateFlag.CREATE),
-        Options.CreateOpts.createParent());
-    out.write(data, 0, data.length);
-    out.close();
-  }
+  @Before
+  public void setUp() throws Exception { }
-      createFile(testPath, fc1);
+      createFile(fc1, testPath);
-      createFile(testPath, fc1);
+      createFile(fc1, testPath);
-    createFile(testPath, fc1);
+    createFile(fc1, testPath);
-      createFile(testPath, fc2);
+      createFile(fc2, testPath);
-    createFile(testPath, fc1);
+    createFile(fc1, testPath);
-    createFile(qualifiedPath("test/hadoop/file", fc2), fc1);
+    createFile(fc1, qualifiedPath("test/hadoop/file", fc2));
-    createFile(testPath, fc1);
+    createFile(fc1, testPath);
-    createFile(testPath, fc1);
+    createFile(fc1, testPath);
-    createFile(testPath, fc1);
+    createFile(fc1, testPath);
-    createFile(testPath, fc1);
+    createFile(fc1, testPath);
-    createFile(path2, fc1);
+    createFile(fc1, path2);
