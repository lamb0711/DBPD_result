HDFS-12387. Ozone: Support Ratis as a first class replication mechanism. Contributed by Anu Engineer.

-
+   *
+   * Translates a list of nodes, ordered such that the first is the leader, into
+   * a corresponding {@link Pipeline} object.
+   *
+   * @param nodes - list of datanodes on which we will allocate the container.
+   * The first of the list will be the leader node.
+   * @return pipeline corresponding to nodes
+   */
+  public static Pipeline newPipelineFromNodes(final List<DatanodeID> nodes) {
+    Preconditions.checkNotNull(nodes);
+    Preconditions.checkArgument(nodes.size() > 0);
+    String leaderId = nodes.get(0).getDatanodeUuid();
+    Pipeline pipeline = new Pipeline(leaderId);
+    for (DatanodeID node : nodes) {
+      pipeline.addMember(node);
+    }
+
+    // A Standalone pipeline is always open, no action from the client
+    // is needed to make it open.
+    pipeline.setType(ReplicationType.STAND_ALONE);
+    pipeline.setLifeCycleState(OzoneProtos.LifeCycleState.OPEN);
+    return pipeline;
+  }
+
+  /**
+   *
-   * @throws IllegalArgumentException
+   * @throws IllegalArgumentException If an pipeline type gets added
+   * and this function is not modified we will throw.
-    switch(replicationType){
+    switch (replicationType) {
-   *
