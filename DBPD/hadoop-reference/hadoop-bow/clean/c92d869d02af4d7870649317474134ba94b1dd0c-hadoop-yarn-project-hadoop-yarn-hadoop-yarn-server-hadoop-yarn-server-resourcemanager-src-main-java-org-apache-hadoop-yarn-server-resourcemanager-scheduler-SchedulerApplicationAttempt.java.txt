Merge r1609845 through r1619277 from trunk.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-6584@1619293 13f79535-47bb-0310-9956-ffa450edef68

-import com.google.common.base.Preconditions;
+import java.util.HashSet;
+import java.util.Set;
-import org.apache.hadoop.yarn.exceptions.YarnRuntimeException;
+import com.google.common.base.Preconditions;
+  // This pendingRelease is used in work-preserving recovery scenario to keep
+  // track of the AM's outstanding release requests. RM on recovery could
+  // receive the release request form AM before it receives the container status
+  // from NM for recovery. In this case, the to-be-recovered containers reported
+  // by NM should not be recovered.
+  private Set<ContainerId> pendingRelease = null;
+
-    
+    this.pendingRelease = new HashSet<ContainerId>();
+  public Set<ContainerId> getPendingRelease() {
+    return this.pendingRelease;
+  }
+
