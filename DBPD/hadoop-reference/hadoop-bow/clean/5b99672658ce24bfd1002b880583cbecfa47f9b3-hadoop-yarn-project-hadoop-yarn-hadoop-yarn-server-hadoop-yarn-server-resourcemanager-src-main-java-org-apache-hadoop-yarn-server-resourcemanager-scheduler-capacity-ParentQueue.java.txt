YARN-897. Ensure child queues are ordered correctly to account for completed containers. Contributed by Djellel Eddine Difallah.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1505146 13f79535-47bb-0310-9956-ffa450edef68

-        LOG.info("Re-sorting queues since queue: " + childQueue.getQueuePath() + 
+        LOG.info("Re-sorting assigned queue: " + childQueue.getQueuePath() + 
-      RMContainer rmContainer, ContainerStatus containerStatus, RMContainerEventType event) {
+      RMContainer rmContainer, ContainerStatus containerStatus, 
+      RMContainerEventType event, CSQueue completedChildQueue) {
+      // reinsert the updated queue
+      for (Iterator<CSQueue> iter=childQueues.iterator(); iter.hasNext();) {
+        CSQueue csqueue = iter.next();
+        if(csqueue.equals(completedChildQueue))
+        {
+          iter.remove();
+          LOG.info("Re-sorting completed queue: " + csqueue.getQueuePath() + 
+              " stats: " + csqueue);
+          childQueues.add(csqueue);
+          break;
+        }
+      }
+      
+        // complete my parent
-            node, rmContainer, null, event);
+            node, rmContainer, null, event, this);
