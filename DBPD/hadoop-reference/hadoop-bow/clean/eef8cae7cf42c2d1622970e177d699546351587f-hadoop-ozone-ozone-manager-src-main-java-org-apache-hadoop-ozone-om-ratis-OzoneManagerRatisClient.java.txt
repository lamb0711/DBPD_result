HDDS-1262. In OM HA OpenKey call Should happen only leader OM. (#626)


+import org.apache.hadoop.ozone.protocol.proto.OzoneManagerProtocolProtos;
+import org.apache.ratis.protocol.StateMachineException;
+import static org.apache.hadoop.ozone.om.exceptions.OMException.STATUS_CODE;
+
+      if (e.getCause() instanceof StateMachineException) {
+        OMResponse.Builder omResponse = OMResponse.newBuilder();
+        omResponse.setCmdType(request.getCmdType());
+        omResponse.setSuccess(false);
+        omResponse.setMessage(e.getCause().getMessage());
+        omResponse.setStatus(parseErrorStatus(e.getCause().getMessage()));
+        return omResponse.build();
+      }
+  private OzoneManagerProtocolProtos.Status parseErrorStatus(String message) {
+    if (message.contains(STATUS_CODE)) {
+      String errorCode = message.substring(message.indexOf(STATUS_CODE) +
+          STATUS_CODE.length());
+      LOG.debug("Parsing error message for error code " +
+          errorCode);
+      return OzoneManagerProtocolProtos.Status.valueOf(errorCode.trim());
+    } else {
+      return OzoneManagerProtocolProtos.Status.INTERNAL_ERROR;
+    }
+
+  }
+
