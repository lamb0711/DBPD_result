HADOOP-10221. Add a plugin to specify SaslProperties for RPC protocol based on connection properties. (Contributed by Benoy Antony and Daryn Sharp)

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1579382 13f79535-47bb-0310-9956-ffa450edef68

+  private static SaslPropertiesResolver resolver;
-  public SaslServer create(Connection connection,
+  public SaslServer create(final Connection connection,
+                           final Map<String,?> saslProperties,
-                SaslRpcServer.SASL_PROPS, callback);
+                saslProperties, callback);
-          SaslRpcServer.SASL_PROPS, callback);
+          saslProperties, callback);
-    String[] qop = conf.getStrings("hadoop.rpc.protection",
-        QualityOfProtection.AUTHENTICATION.toString());
-    
-    for (int i=0; i < qop.length; i++) {
-        qop[i] = QualityOfProtection.valueOf(qop[i].toUpperCase()).getSaslQop();
-    }
-    
-    SASL_PROPS.put(Sasl.QOP, StringUtils.join(",", qop));
-    SASL_PROPS.put(Sasl.SERVER_AUTH, "true");
-    saslFactory = new FastSaslServerFactory(SASL_PROPS);
+    // passing null so factory is populated with all possibilities.  the
+    // properties passed when instantiating a server are what really matter
+    saslFactory = new FastSaslServerFactory(null);
