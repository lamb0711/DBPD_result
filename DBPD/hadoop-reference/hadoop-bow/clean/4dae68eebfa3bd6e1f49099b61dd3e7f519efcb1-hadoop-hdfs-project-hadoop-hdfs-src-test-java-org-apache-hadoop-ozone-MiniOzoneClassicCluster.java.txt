HDFS-12741. Ozone: KSM: ADD support for KSM --createObjectStore command. Contributed by Shashikant Banerjee.

+import org.apache.hadoop.ozone.ksm.KSMStorage;
-  private final KeySpaceManager ksm;
+  private KeySpaceManager ksm;
+    private Optional<String> ksmId = Optional.empty();
+    public Builder setKsmId(String kId) {
+      ksmId = Optional.of(kId);
+      return this;
+    }
+
+      initializeKSM();
-      KeySpaceManager ksm = new KeySpaceManager(conf);
+      KeySpaceManager ksm = KeySpaceManager.createKSM(null, conf);
-      scmStore.setClusterId(clusterId.orElse(runID.toString()));
-      scmStore.setScmId(scmId.orElse(UUID.randomUUID().toString()));
+      if (!clusterId.isPresent()) {
+        clusterId = Optional.of(runID.toString());
+      }
+      scmStore.setClusterId(clusterId.get());
+      if (!scmId.isPresent()) {
+        scmId = Optional.of(UUID.randomUUID().toString());
+      }
+      scmStore.setScmId(scmId.get());
+    private void initializeKSM() throws IOException {
+      KSMStorage ksmStore = new KSMStorage(conf);
+      ksmStore.setClusterId(clusterId.get());
+      ksmStore.setScmId(scmId.get());
+      ksmStore.setKsmId(ksmId.orElse(UUID.randomUUID().toString()));
+      ksmStore.initialize();
+    }
+
