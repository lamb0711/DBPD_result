MAPREDUCE-5411. Refresh size of loaded job cache on history server. Contributed by Ashwin Shankar


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1508220 13f79535-47bb-0310-9956-ffa450edef68

+    } else if ("-refreshLoadedJobCache".equals(cmd)) {
+      System.err.println("Usage: mapred hsadmin [-refreshLoadedJobCache]");
+      System.err.println("           [-refreshLoadedJobCache]");
+        + " [-refreshLoadedJobCache]"
+    String refreshLoadedJobCache = "-refreshLoadedJobCache: Refresh loaded job cache of Job history server\n";
+
-
+    } else if ("refreshLoadedJobCache".equals(cmd)) {
+      System.out.println(refreshLoadedJobCache);
+      System.out.println(refreshLoadedJobCache);
+  private int refreshLoadedJobCache() throws IOException {
+    // Refresh the loaded job cache
+    Configuration conf = getConf();
+    InetSocketAddress address = conf.getSocketAddr(
+        JHAdminConfig.JHS_ADMIN_ADDRESS,
+        JHAdminConfig.DEFAULT_JHS_ADMIN_ADDRESS,
+        JHAdminConfig.DEFAULT_JHS_ADMIN_PORT);
+
+    HSAdminRefreshProtocol refreshProtocol = HSProxies.createProxy(conf,
+        address, HSAdminRefreshProtocol.class,
+        UserGroupInformation.getCurrentUser());
+
+    refreshProtocol.refreshLoadedJobCache();
+    return 0;
+  }
+    
+        || "-refreshLoadedJobCache".equals(cmd)
+    } else if ("-refreshLoadedJobCache".equals(cmd)) {
+      exitCode = refreshLoadedJobCache();
