HDFS-4434. Reverting change r1470089 that merges trunk to HDFS-2802.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1470194 13f79535-47bb-0310-9956-ffa450edef68

-import com.google.common.annotations.VisibleForTesting;
-
-    protected LocalWrapperScriptBuilder(Path containerWorkDir) {
-      this.wrapperScriptPath = new Path(containerWorkDir,
-        Shell.appendScriptExtension("default_container_executor"));
+    protected LocalWrapperScriptBuilder(Path wrapperScriptPath) {
+      this.wrapperScriptPath = wrapperScriptPath;
-      super(containerWorkDir);
+      super(new Path(containerWorkDir, "default_container_executor.sh"));
-      String exec = Shell.isSetsidAvailable? "exec setsid" : "exec";
+      String exec = ContainerExecutor.isSetsidAvailable? "exec setsid" : "exec";
-      super(containerWorkDir);
+      super(new Path(containerWorkDir, "default_container_executor.cmd"));
-    LOG.debug("Sending signal " + signal.getValue() + " to pid " + pid
+    final String sigpid = ContainerExecutor.isSetsidAvailable
+        ? "-" + pid
+        : pid;
+    LOG.debug("Sending signal " + signal.getValue() + " to pid " + sigpid
-    if (!containerIsAlive(pid)) {
+    if (!containerIsAlive(sigpid)) {
-      killContainer(pid, signal);
+      killContainer(sigpid, signal);
-      if (!containerIsAlive(pid)) {
+      if (!containerIsAlive(sigpid)) {
-  @VisibleForTesting
-  public static boolean containerIsAlive(String pid) throws IOException {
+  private boolean containerIsAlive(String pid) throws IOException {
-      new ShellCommandExecutor(Shell.getCheckProcessIsAliveCommand(pid))
-        .execute();
+      new ShellCommandExecutor(getCheckProcessIsAliveCommand(pid)).execute();
-    new ShellCommandExecutor(Shell.getSignalKillCommand(signal.getValue(), pid))
+    new ShellCommandExecutor(getSignalKillCommand(signal.getValue(), pid))
