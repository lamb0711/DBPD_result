HDDS-1579. Create OMDoubleBuffer metrics. (#871)



+import com.google.common.annotations.VisibleForTesting;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
+
+import org.apache.hadoop.ozone.om.ratis.metrics.OzoneManagerDoubleBufferMetrics;
-
-import org.slf4j.Logger;
-import org.slf4j.LoggerFactory;
+  private OzoneManagerDoubleBufferMetrics ozoneManagerDoubleBufferMetrics;
+  private long maxFlushedTransactionsInOneIteration;
-
+    this.ozoneManagerDoubleBufferMetrics =
+        OzoneManagerDoubleBufferMetrics.create();
-
+
+
+          // set metrics.
+          updateMetrics(flushedTransactionsSize);
+   * Update OzoneManagerDoubleBuffer metrics values.
+   * @param flushedTransactionsSize
+   */
+  private void updateMetrics(
+      long flushedTransactionsSize) {
+    ozoneManagerDoubleBufferMetrics.incrTotalNumOfFlushOperations();
+    ozoneManagerDoubleBufferMetrics.incrTotalSizeOfFlushedTransactions(
+        flushedTransactionsSize);
+    if (maxFlushedTransactionsInOneIteration < flushedTransactionsSize) {
+      maxFlushedTransactionsInOneIteration = flushedTransactionsSize;
+      ozoneManagerDoubleBufferMetrics
+          .setMaxNumberOfTransactionsFlushedInOneIteration(
+              flushedTransactionsSize);
+    }
+  }
+
+  /**
+
+      // stop metrics.
+      ozoneManagerDoubleBufferMetrics.unRegister();
+  @VisibleForTesting
+  public OzoneManagerDoubleBufferMetrics getOzoneManagerDoubleBufferMetrics() {
+    return ozoneManagerDoubleBufferMetrics;
+  }
+
