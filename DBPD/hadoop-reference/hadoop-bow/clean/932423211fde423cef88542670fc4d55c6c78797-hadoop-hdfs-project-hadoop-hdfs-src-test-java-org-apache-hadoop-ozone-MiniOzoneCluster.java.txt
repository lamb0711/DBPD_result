HDFS-11469. Ozone: SCM: Container allocation based on node report. Contributed by Xiaoyu Yao.

-public class MiniOzoneCluster extends MiniDFSCluster implements Closeable {
+public final class MiniOzoneCluster extends MiniDFSCluster
+    implements Closeable {
+  public void waitForHeartbeatProcessed() throws TimeoutException,
+      InterruptedException {
+    GenericTestUtils.waitFor(() ->
+            scm.getScmNodeManager().waitForHeartbeatProcessed(), 100,
+        4 * 1000);
+    GenericTestUtils.waitFor(() ->
+            scm.getScmNodeManager().getStats().getCapacity() > 0, 100,
+        4 * 1000);
+  }
+
+    @Override
+    public Builder storageCapacities(long[] capacities) {
+      super.storageCapacities(capacities);
+      return this;
+    }
+
-
