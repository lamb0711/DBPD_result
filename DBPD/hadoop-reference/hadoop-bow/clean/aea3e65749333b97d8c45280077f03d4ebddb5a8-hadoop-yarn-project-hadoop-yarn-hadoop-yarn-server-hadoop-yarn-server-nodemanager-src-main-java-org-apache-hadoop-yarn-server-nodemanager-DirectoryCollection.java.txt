YARN-5137. Make DiskChecker pluggable in NodeManager. (Yufei Gu via rchiang)

-import org.apache.hadoop.util.DiskChecker;
+import org.apache.hadoop.util.DiskValidator;
+import org.apache.hadoop.util.DiskValidatorFactory;
+import org.apache.hadoop.conf.Configuration;
+import org.apache.hadoop.yarn.conf.YarnConfiguration;
+import org.apache.hadoop.yarn.exceptions.YarnRuntimeException;
+  private final Configuration conf;
+  private final DiskValidator diskValidator;
+    conf = new YarnConfiguration();
+    try {
+      diskValidator = DiskValidatorFactory.getInstance(
+          conf.get(YarnConfiguration.DISK_VALIDATOR));
+      LOG.info("Disk Validator: " + YarnConfiguration.DISK_VALIDATOR +
+          " is loaded.");
+    } catch (Exception e) {
+      throw new YarnRuntimeException(e);
+    }
+
-        DiskChecker.checkDir(testDir);
+        diskValidator.checkStatus(testDir);
-      DiskChecker.checkDir(target);
+      diskValidator.checkStatus(target);
