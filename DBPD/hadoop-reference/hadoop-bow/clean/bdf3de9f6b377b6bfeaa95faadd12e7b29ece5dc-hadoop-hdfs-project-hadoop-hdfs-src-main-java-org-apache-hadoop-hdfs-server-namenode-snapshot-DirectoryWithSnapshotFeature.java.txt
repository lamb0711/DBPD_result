HDFS-6593. Move SnapshotDiffInfo out of INodeDirectorySnapshottable. Contributed by Jing Zhao.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1605169 13f79535-47bb-0310-9956-ffa450edef68

-import java.util.ArrayList;
-import org.apache.hadoop.hdfs.protocol.SnapshotDiffReport.DiffReportEntry;
-import org.apache.hadoop.hdfs.protocol.SnapshotDiffReport.DiffType;
-import org.apache.hadoop.hdfs.server.namenode.snapshot.INodeDirectorySnapshottable.SnapshotDiffInfo.RenameEntry;
-
-    /**
-     * Interpret the diff and generate a list of {@link DiffReportEntry}.
-     * @param parentPath The relative path of the parent.
-     * @param fromEarlier True indicates {@code diff=later-earlier},
-     *                    False indicates {@code diff=earlier-later}
-     * @return A list of {@link DiffReportEntry} as the diff report.
-     */
-    public List<DiffReportEntry> generateReport(byte[][] parentPath,
-        boolean fromEarlier, Map<Long, RenameEntry> renameMap) {
-      List<DiffReportEntry> list = new ArrayList<DiffReportEntry>();
-      List<INode> created = getList(ListType.CREATED);
-      List<INode> deleted = getList(ListType.DELETED);
-      byte[][] fullPath = new byte[parentPath.length + 1][];
-      System.arraycopy(parentPath, 0, fullPath, 0, parentPath.length);
-      for (INode cnode : created) {
-        RenameEntry entry = renameMap.get(cnode.getId());
-        if (entry == null || !entry.isRename()) {
-          fullPath[fullPath.length - 1] = cnode.getLocalNameBytes();
-          list.add(new DiffReportEntry(fromEarlier ? DiffType.CREATE
-              : DiffType.DELETE, fullPath));
-        }
-      }
-      for (INode dnode : deleted) {
-        RenameEntry entry = renameMap.get(dnode.getId());
-        if (entry != null && entry.isRename()) {
-          list.add(new DiffReportEntry(DiffType.RENAME,
-              fromEarlier ? entry.getSourcePath() : entry.getTargetPath(),
-              fromEarlier ? entry.getTargetPath() : entry.getSourcePath()));
-        } else {
-          fullPath[fullPath.length - 1] = dnode.getLocalNameBytes();
-          list.add(new DiffReportEntry(fromEarlier ? DiffType.DELETE
-              : DiffType.CREATE, fullPath));
-        }
-      }
-      return list;
-    }
