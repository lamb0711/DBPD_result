HDFS-4487. Fix snapshot diff report for HDFS-4446.  Contributed by Jing Zhao


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1446385 13f79535-47bb-0310-9956-ffa450edef68

-  /** Compare snapshot IDs with null <= s for any snapshot s. */
+  /**
+   * Compare snapshot IDs. Null indicates the current status thus is greater
+   * than non-null snapshots.
+   */
+      // null means the current state, thus should be the largest
-        return right == null? 0: -1;
+        return right == null? 0: 1;
-        return right == null? 1: left.id - right.id; 
+        return right == null? -1: left.id - right.id; 
-        if (ID_COMPARATOR.compare(latest, s) < 0) {
+        if (latest == null
+            || (s != null && ID_COMPARATOR.compare(latest, s) < 0)) {
+  
+  /** 
+   * Get the name of the given snapshot. 
+   * @param s The given snapshot.
+   * @return The name of the snapshot, or an empty string if {@code s} is null
+   */
+  public static String getSnapshotName(Snapshot s) {
+    return s != null ? s.getRoot().getLocalName() : "";
+  }
