YARN-4712. CPU Usage Metric is not captured properly in YARN-2928. (Naganarasimha G R via Varun Saxena)

-  public void reportContainerResourceUsage(Container container, String pId,
-      Long pmemUsage, Float cpuUsageTotalCoresPercentage) {
+  public void reportContainerResourceUsage(Container container, Long pmemUsage,
+      Float cpuUsagePercentPerCore) {
-        cpuUsageTotalCoresPercentage !=
-            ResourceCalculatorProcessTree.UNAVAILABLE) {
+        cpuUsagePercentPerCore != ResourceCalculatorProcessTree.UNAVAILABLE) {
-        memoryMetric.setId(ContainerMetric.MEMORY.toString() + pId);
+        memoryMetric.setId(ContainerMetric.MEMORY.toString());
-      if (cpuUsageTotalCoresPercentage !=
-          ResourceCalculatorProcessTree.UNAVAILABLE) {
+      if (cpuUsagePercentPerCore != ResourceCalculatorProcessTree.UNAVAILABLE) {
-        cpuMetric.setId(ContainerMetric.CPU.toString() + pId);
-        cpuMetric.addValue(currentTimeMillis, cpuUsageTotalCoresPercentage);
+        cpuMetric.setId(ContainerMetric.CPU.toString());
+        cpuMetric.addValue(currentTimeMillis,
+            Math.round(cpuUsagePercentPerCore));
-      dispatcher.getEventHandler().handle(
-          new TimelinePublishEvent(entity, container.getContainerId()
+      dispatcher.getEventHandler()
+          .handle(new TimelinePublishEvent(entity, container.getContainerId()
