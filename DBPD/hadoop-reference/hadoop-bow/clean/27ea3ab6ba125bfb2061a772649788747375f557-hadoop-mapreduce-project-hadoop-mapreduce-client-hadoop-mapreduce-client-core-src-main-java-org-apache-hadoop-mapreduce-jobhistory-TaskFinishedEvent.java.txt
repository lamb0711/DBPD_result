MAPREDUCE-4128. AM Recovery expects all attempts of a completed task to also be completed. (Bikas Saha via bobby)


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1325765 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.mapreduce.TaskAttemptID;
+  private TaskAttemptID successfulAttemptId;
+   * @param attemptId Task Attempt ID of the successful attempt for this task
-  public TaskFinishedEvent(TaskID id, long finishTime,
+  public TaskFinishedEvent(TaskID id, TaskAttemptID attemptId, long finishTime,
+    this.successfulAttemptId = attemptId;
+      if(successfulAttemptId != null)
+      {
+        datum.successfulAttemptId = new Utf8(successfulAttemptId.toString());
+      }
+    if (datum.successfulAttemptId != null) {
+      this.successfulAttemptId = TaskAttemptID
+          .forName(datum.successfulAttemptId.toString());
+    }
+  /** Get successful task attempt id */
+  public TaskAttemptID getSuccessfulTaskAttemptId() {
+    if(successfulAttemptId != null)
+    {
+      return TaskAttemptID.forName(successfulAttemptId.toString());
+    }
+    return null;
+  }
