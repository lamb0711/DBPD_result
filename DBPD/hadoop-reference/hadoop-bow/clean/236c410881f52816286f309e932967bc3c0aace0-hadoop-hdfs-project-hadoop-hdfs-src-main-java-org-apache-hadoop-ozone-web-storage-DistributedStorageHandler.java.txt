HDFS-11776. Ozone: KSM: add SetBucketProperty. Contributed by Nandakumar Vadivelu.

+import org.apache.hadoop.ksm.helpers.KsmBucketArgs;
+import org.apache.hadoop.ozone.web.request.OzoneAcl;
-    throw new UnsupportedOperationException("setBucketAcls not implemented");
+    List<OzoneAcl> removeAcls = args.getRemoveAcls();
+    List<OzoneAcl> addAcls = args.getAddAcls();
+    if(removeAcls != null || addAcls != null) {
+      KsmBucketArgs.Builder builder = KsmBucketArgs.newBuilder();
+      builder.setVolumeName(args.getVolumeName())
+          .setBucketName(args.getBucketName());
+      if(removeAcls != null && !removeAcls.isEmpty()) {
+        builder.setRemoveAcls(args.getRemoveAcls().stream().map(
+            KSMPBHelper::convertOzoneAcl).collect(Collectors.toList()));
+      }
+      if(addAcls != null && !addAcls.isEmpty()) {
+        builder.setAddAcls(args.getAddAcls().stream().map(
+            KSMPBHelper::convertOzoneAcl).collect(Collectors.toList()));
+      }
+      keySpaceManagerClient.setBucketProperty(builder.build());
+    }
-    throw new UnsupportedOperationException(
-        "setBucketVersioning not implemented");
+    KsmBucketArgs.Builder builder = KsmBucketArgs.newBuilder();
+    builder.setVolumeName(args.getVolumeName())
+        .setBucketName(args.getBucketName())
+        .setIsVersionEnabled(getBucketVersioningProtobuf(
+            args.getVersioning()));
+    keySpaceManagerClient.setBucketProperty(builder.build());
-    throw new UnsupportedOperationException(
-        "setBucketStorageClass not implemented");
+    KsmBucketArgs.Builder builder = KsmBucketArgs.newBuilder();
+    builder.setVolumeName(args.getVolumeName())
+        .setBucketName(args.getBucketName())
+        .setStorageType(PBHelperClient.convertStorageType(
+            args.getStorageType()));
+    keySpaceManagerClient.setBucketProperty(builder.build());
