Merging r1533208 through r1534278 from trunk to branch HDFS-2832

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2832@1534279 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.hadoop.fs.UnresolvedLinkException;
-  private long bytesCurBlock = 0; // bytes writen in current block
+  private long bytesCurBlock = 0; // bytes written in current block
-        Packet one = null;
-
+        Packet one;
-            nodes = nextBlockOutputStream(src);
+            nodes = nextBlockOutputStream();
-          if (one.isHeartbeatPacket()) {  //heartbeat packet
-          }
-          
-    // Processes reponses from the datanodes.  A packet is removed 
+    // Processes responses from the datanodes.  A packet is removed
-              "Ack for unkown seqno should be a failed ack: " + ack;
+              "Ack for unknown seqno should be a failed ack: " + ack;
-            Packet one = null;
+            Packet one;
-              throw new IOException("Responseprocessor: Expecting seqno " +
+              throw new IOException("ResponseProcessor: Expecting seqno " +
-    private DatanodeInfo[] nextBlockOutputStream(String client) throws IOException {
+    private DatanodeInfo[] nextBlockOutputStream() throws IOException {
-        DatanodeInfo[] excludedNodes) 
-        throws IOException, UnresolvedLinkException {
+        DatanodeInfo[] excludedNodes)  throws IOException {
-   * @param client
+   * @param client client
-          // the MAX_PACKETS iength.
+          // the MAX_PACKETS length.
-      // update length in NN is requried, then persist block locations on
+      // update length in NN is required, then persist block locations on
