HDDS-2007. Make ozone fs shell command work with OM HA service ids	 (#1360)


+   * @param omServiceId
+   *        Service ID of OzoneManager HA cluster.
+   *
+   * @param config
+   *        Configuration to be used for OzoneClient creation
+   *
+   * @return OzoneClient
+   *
+   * @throws IOException
+   */
+  public static OzoneClient getRpcClient(String omHost, Integer omRpcPort,
+      String omServiceId, Configuration config) throws IOException {
+    Preconditions.checkNotNull(omHost);
+    Preconditions.checkNotNull(omRpcPort);
+    Preconditions.checkNotNull(omServiceId);
+    Preconditions.checkNotNull(config);
+    config.set(OZONE_OM_ADDRESS_KEY, omHost + ":" + omRpcPort);
+    return getRpcClient(omServiceId, config);
+  }
+
+  /**
+   * Returns an OzoneClient which will use RPC protocol.
+   *
+   * @param omHost
+   *        hostname of OzoneManager to connect.
+   *
+   * @param omRpcPort
+   *        RPC port of OzoneManager.
+   *
+   * @param omServiceId
+   *        Service ID of OzoneManager HA cluster.
+   *
+   * @param config
+   *        Configuration to be used for OzoneClient creation
+   *
+   * @return OzoneClient
+   *
+   * @throws IOException
+   */
+  public static OzoneClient getRpcClient(String omServiceId,
+      Configuration config) throws IOException {
+    Preconditions.checkNotNull(omServiceId);
+    Preconditions.checkNotNull(config);
+    // Won't set OZONE_OM_ADDRESS_KEY here since service id is passed directly,
+    // leaving OZONE_OM_ADDRESS_KEY value as is.
+    return getClient(getClientProtocol(config, omServiceId), config);
+  }
+
+  /**
+   * Returns an OzoneClient which will use RPC protocol.
+   *
+    return getClientProtocol(config, null);
+  }
+
+  /**
+   * Returns an instance of Protocol class.
+   *
+   *
+   * @param config
+   *        Configuration used to initialize ClientProtocol.
+   *
+   * @return ClientProtocol
+   *
+   * @throws IOException
+   */
+  private static ClientProtocol getClientProtocol(Configuration config,
+      String omServiceId) throws IOException {
-      return new RpcClient(config);
+      return new RpcClient(config, omServiceId);
