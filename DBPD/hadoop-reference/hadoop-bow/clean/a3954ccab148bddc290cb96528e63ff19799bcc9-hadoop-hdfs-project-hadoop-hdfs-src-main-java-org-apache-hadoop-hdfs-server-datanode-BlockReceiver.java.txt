HDFS-9807. Add an optional StorageID to writes. Contributed by Ewan Higgs

-      final boolean pinning) throws IOException {
+      final boolean pinning,
+      final String storageId) throws IOException {
+            + ", storageID=" + (storageId != null ? storageId : "null")
-        replicaHandler = datanode.data.createTemporary(storageType, block);
+        replicaHandler =
+            datanode.data.createTemporary(storageType, storageId, block);
-          replicaHandler = datanode.data.createRbw(storageType, block, allowLazyPersist);
+          replicaHandler = datanode.data.createRbw(storageType, storageId,
+              block, allowLazyPersist);
-              datanode.data.createTemporary(storageType, block);
+              datanode.data.createTemporary(storageType, storageId, block);
