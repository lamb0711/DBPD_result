YARN-2496. Enhanced Capacity Scheduler to have basic support for allocating resources based on node-labels. Contributed by Wangda Tan.
YARN-2500. Ehnaced ResourceManager to support schedulers allocating resources based on node-labels. Contributed by Wangda Tan.

+  
-    List<ResourceRequest> reqs = createReq(new String[]{host}, memory, 1, numContainers);
+    return allocate(host, memory, numContainers, releases, null);
+  }
+  
+  public AllocateResponse allocate(
+      String host, int memory, int numContainers,
+      List<ContainerId> releases, String labelExpression) throws Exception {
+    List<ResourceRequest> reqs =
+        createReq(new String[] { host }, memory, 1, numContainers,
+            labelExpression);
+  
+  public List<ResourceRequest> createReq(String[] hosts, int memory, int priority,
+      int containers) throws Exception {
+    return createReq(hosts, memory, priority, containers, null);
+  }
-      int containers) throws Exception {
+      int containers, String labelExpression) throws Exception {
-          containers);
+          containers, labelExpression);
-          priority, containers);
+          priority, containers, labelExpression);
-        priority, containers);
+        priority, containers, labelExpression);
-
+  }
+  
+  public ResourceRequest createResourceReq(String resource, int memory, int priority,
+      int containers) throws Exception {
+    return createResourceReq(resource, memory, priority, containers, null);
-      int containers) throws Exception {
+      int containers, String labelExpression) throws Exception {
+    if (labelExpression != null) {
+     req.setNodeLabelExpression(labelExpression); 
+    }
