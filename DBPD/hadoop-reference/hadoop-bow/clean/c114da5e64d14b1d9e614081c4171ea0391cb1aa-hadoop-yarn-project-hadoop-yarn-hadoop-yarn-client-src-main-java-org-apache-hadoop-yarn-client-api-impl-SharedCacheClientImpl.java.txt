YARN-7250. Update Shared cache client api to use URLs.

-import java.net.URI;
-import java.net.URISyntaxException;
+import org.apache.hadoop.yarn.api.records.URL;
-  public Path use(ApplicationId applicationId, String resourceKey,
-      String resourceName) throws YarnException {
+  public URL use(ApplicationId applicationId, String resourceKey)
+      throws YarnException {
-      if (resourcePath.getName().equals(resourceName)) {
-        // The preferred name is the same as the name of the item in the cache,
-        // so we skip generating the fragment to save space in the MRconfig.
-        return resourcePath;
-      } else {
-        // We are using the shared cache, and a preferred name has been
-        // specified that is different than the name of the resource in the
-        // shared cache. We need to set the fragment portion of the URI to
-        // preserve the desired name.
-        URI pathURI = resourcePath.toUri();
-        try {
-          // We assume that there is no existing fragment in the URI since the
-          // shared cache manager does not use fragments.
-          pathURI =
-              new URI(pathURI.getScheme(), pathURI.getSchemeSpecificPart(),
-                  resourceName);
-          resourcePath = new Path(pathURI);
-        } catch (URISyntaxException e) {
-          throw new YarnException(
-              "Could not create a new URI due to syntax errors: "
-                  + pathURI.toString(), e);
-        }
-      }
+      URL pathURL = URL.fromPath(resourcePath);
+      return pathURL;
+    } else {
+      // The resource was not in the cache.
+      return null;
-    return resourcePath;
