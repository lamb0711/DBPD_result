HDFS-5163. Miscellaneous cache pool RPC fixes (Contributed by Colin Patrick McCabe)

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-4949@1520665 13f79535-47bb-0310-9956-ffa450edef68

+    public boolean hasMore();
+    private final boolean hasMore;
-    public BatchedListEntries(List<E> entries) {
+    public BatchedListEntries(List<E> entries, boolean hasMore) {
+      this.hasMore = hasMore;
+
+    public boolean hasMore() {
+      return hasMore;
+    }
-  private final int maxRepliesPerRequest;
-  public BatchedRemoteIterator(K prevKey, int maxRepliesPerRequest) {
+  public BatchedRemoteIterator(K prevKey) {
-    this.maxRepliesPerRequest = maxRepliesPerRequest;
-   * @param maxRepliesPerRequest   The maximum number of replies to allow.
-  public abstract BatchedEntries<E> makeRequest(K prevKey,
-      int maxRepliesPerRequest) throws IOException;
+  public abstract BatchedEntries<E> makeRequest(K prevKey) throws IOException;
-    entries = makeRequest(prevKey, maxRepliesPerRequest);
-    if (entries.size() > maxRepliesPerRequest) {
-      throw new IOException("invalid number of replies returned: got " +
-          entries.size() + ", expected " + maxRepliesPerRequest +
-          " at most.");
-    }
+    entries = makeRequest(prevKey);
-      if (entries.size() < maxRepliesPerRequest) {
+      if (!entries.hasMore()) {
