YARN-3154. Added additional APIs in LogAggregationContext to avoid aggregating running logs of application when rolling is enabled. Contributed by Xuan Gong.

-import org.apache.hadoop.security.token.Token;
+  private final boolean logAggregationInRolling;
+    this.logAggregationInRolling =
+        this.rollingMonitorInterval <= 0 || this.logAggregationContext == null
+            || this.logAggregationContext.getRolledLogsIncludePattern() == null
+            || this.logAggregationContext.getRolledLogsIncludePattern()
+              .isEmpty() ? false : true;
-  private void uploadLogsForContainers() {
+  private void uploadLogsForContainers(boolean appFinished) {
-            aggregator.doContainerLogAggregation(writer);
+            aggregator.doContainerLogAggregation(writer, appFinished);
-          if (this.rollingMonitorInterval > 0) {
+          if (logAggregationInRolling) {
-            uploadLogsForContainers();
+            uploadLogsForContainers(false);
-    uploadLogsForContainers();
+    uploadLogsForContainers(true);
-    public Set<Path> doContainerLogAggregation(LogWriter writer) {
+    public Set<Path> doContainerLogAggregation(LogWriter writer,
+        boolean appFinished) {
-            this.uploadedFileMeta);
+            this.uploadedFileMeta, appFinished);
