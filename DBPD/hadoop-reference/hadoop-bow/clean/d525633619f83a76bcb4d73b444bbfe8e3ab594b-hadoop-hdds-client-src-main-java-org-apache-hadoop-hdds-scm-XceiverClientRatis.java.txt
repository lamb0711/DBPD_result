HDDS-1395. Key write fails with BlockOutputStream has been closed exception (#749)

HDDS-1395. Key write fails with BlockOutputStream has been closed exception (#749).


+import org.apache.ratis.protocol.GroupMismatchException;
-  static final Logger LOG = LoggerFactory.getLogger(XceiverClientRatis.class);
+  public static final Logger LOG =
+      LoggerFactory.getLogger(XceiverClientRatis.class);
-    CompletableFuture<RaftClientReply> replyFuture = getClient()
-        .sendWatchAsync(index, RaftProtos.ReplicationLevel.ALL_COMMITTED);
+      CompletableFuture<RaftClientReply> replyFuture = getClient()
+          .sendWatchAsync(index, RaftProtos.ReplicationLevel.ALL_COMMITTED);
-    } catch (TimeoutException toe) {
-      LOG.warn("3 way commit failed ", toe);
+    } catch (Exception e) {
+      Throwable t = HddsClientUtils.checkForException(e);
+      LOG.warn("3 way commit failed ", e);
+      if (t instanceof GroupMismatchException) {
+        throw e;
+      }
