YARN-8776. Implement Container Exec feature in LinuxContainerExecutor. Contributed by Eric Yang

-import java.io.ByteArrayInputStream;
-import java.io.ByteArrayOutputStream;
-import java.io.InputStream;
-import java.io.OutputStream;
-import java.nio.charset.Charset;
-    // TODO: calls PrivilegedOperationExecutor and return IOStream pairs
-    InputStream in = null;
-    OutputStream out = null;
-    int byteSize = 4000;
+    IOStreamPair res;
-      in = new ByteArrayInputStream(
-          "This is input command".getBytes(Charset.forName("UTF-8")));
-      out = new ByteArrayOutputStream(byteSize);
-    } catch (IllegalArgumentException e) {
-      LOG.error("Failed to execute command to container runtime", e);
+      res = linuxContainerRuntime.execContainer(ctx);
+    } catch (ContainerExecutionException e) {
+      int retCode = e.getExitCode();
+      if (retCode != 0) {
+        return new IOStreamPair(null, null);
+      }
+      LOG.warn("Error in executing container interactive shell"
+          + ctx + " exit = " + retCode, e);
+      logOutput(e.getOutput());
+      throw new ContainerExecutionException(
+          "Error in executing container interactive shel" + ctx.getContainer()
+          .getContainerId().toString() + " exit = " + retCode);
-    IOStreamPair pair = new IOStreamPair(in, out);
-    System.out.println(pair);
-    return new IOStreamPair(in, out);
+    return res;
