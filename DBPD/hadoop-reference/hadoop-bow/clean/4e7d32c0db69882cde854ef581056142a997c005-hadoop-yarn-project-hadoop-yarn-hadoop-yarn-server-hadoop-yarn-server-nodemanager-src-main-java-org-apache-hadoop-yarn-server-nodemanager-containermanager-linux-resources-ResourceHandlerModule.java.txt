YARN-1856. Added cgroups based memory monitoring for containers as another alternative to custom memory-monitoring. Contributed by Varun Vasudev.

+  private static volatile CGroupsMemoryResourceHandlerImpl
+      cGroupsMemoryResourceHandler;
-  getTrafficControlBandwidthHandler(Configuration conf)
+    getTrafficControlBandwidthHandler(Configuration conf)
-  getOutboundBandwidthResourceHandler(Configuration conf)
+    getOutboundBandwidthResourceHandler(Configuration conf)
+  public static MemoryResourceHandler getMemoryResourceHandler(
+      Configuration conf) throws ResourceHandlerException {
+    if (conf.getBoolean(YarnConfiguration.NM_MEMORY_RESOURCE_ENABLED,
+        YarnConfiguration.DEFAULT_NM_MEMORY_RESOURCE_ENABLED)) {
+      return getCgroupsMemoryResourceHandler(conf);
+    }
+    return null;
+  }
+
+  private static CGroupsMemoryResourceHandlerImpl
+    getCgroupsMemoryResourceHandler(
+      Configuration conf) throws ResourceHandlerException {
+    if (cGroupsMemoryResourceHandler == null) {
+      synchronized (MemoryResourceHandler.class) {
+        if (cGroupsMemoryResourceHandler == null) {
+          cGroupsMemoryResourceHandler =
+              new CGroupsMemoryResourceHandlerImpl(getCGroupsHandler(conf));
+        }
+      }
+    }
+    return cGroupsMemoryResourceHandler;
+  }
+
+    addHandlerIfNotNull(handlerList, getMemoryResourceHandler(conf));
