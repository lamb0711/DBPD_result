Reverting the previous trunk merge since it added other unintended changes in addition


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1177127 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.hadoop.yarn.event.EventHandler;
-  @SuppressWarnings("rawtypes")
-  private EventHandler handler;
+
+     // TODO - ATTEMPT_KILLED not sent right now but should handle if 
+     // attempt starts sending
+
-        RMAppEventType.KILL, new KillAppAndAttemptTransition())
+        RMAppEventType.KILL, new AppKilledTransition())
-        RMAppEventType.KILL, new KillAppAndAttemptTransition())
+        RMAppEventType.KILL, new AppKilledTransition())
-        RMAppEventType.KILL, new KillAppAndAttemptTransition())
+        RMAppEventType.KILL, new AppKilledTransition())
-    this.handler = dispatcher.getEventHandler();
-          this.diagnostics.toString(), trackingUrl, 
-          this.startTime, this.finishTime);
+          this.diagnostics.toString(), trackingUrl, this.startTime);
-    handler.handle(
+    dispatcher.getEventHandler().handle(
-  private static class AppKilledTransition extends FinalTransition {
-    @Override
+  private static final class AppKilledTransition extends FinalTransition {
-  private static class KillAppAndAttemptTransition extends AppKilledTransition {
-    @SuppressWarnings("unchecked")
-    @Override
-    public void transition(RMAppImpl app, RMAppEvent event) {
-      app.handler.handle(new RMAppAttemptEvent(app.currentAttempt.getAppAttemptId(), 
-          RMAppAttemptEventType.KILL));
-      super.transition(app, event);
-    }
-  }
-        app.handler.handle(
+        app.dispatcher.getEventHandler().handle(
-      app.handler.handle(
+      app.dispatcher.getEventHandler().handle(
-      
-      RMAppFailedAttemptEvent failedEvent = ((RMAppFailedAttemptEvent)event);
+
-        + " times due to " + failedEvent.getDiagnostics()
-        + ". Failing the application.";
+        + " times. Failing the application.";
