MAPREDUCE-3975. Default value not set for Configuration parameter mapreduce.job.local.dir (Eric Payne via bobby)



git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1297825 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.fs.LocalDirAllocator;
+   * @throws IOException 
-  private static void configureLocalDirs(Task task, JobConf job) {
+  private static void configureLocalDirs(Task task, JobConf job) throws IOException {
+    LocalDirAllocator lDirAlloc = new LocalDirAllocator(MRConfig.LOCAL_DIR);
+    Path workDir = lDirAlloc.getLocalPathForWrite("work", job);
+    FileSystem lfs = FileSystem.getLocal(job).getRaw();
+    if (!lfs.mkdirs(workDir)) {
+        throw new IOException("Mkdirs failed to create "
+            + workDir.toString());
+    }
+    job.set(MRJobConfig.JOB_LOCAL_DIR,workDir.toString());
