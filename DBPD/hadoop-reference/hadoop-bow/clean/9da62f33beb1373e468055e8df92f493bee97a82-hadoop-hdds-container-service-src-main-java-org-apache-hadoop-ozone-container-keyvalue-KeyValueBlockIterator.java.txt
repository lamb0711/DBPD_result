Merge branch 'trunk' into HDDS-1535
-import org.apache.hadoop.utils.MetadataStore;
+import org.apache.hadoop.ozone.container.common.utils.ContainerCache.ReferenceCountedDB;
+import java.io.Closeable;
-public class KeyValueBlockIterator implements BlockIterator<BlockData> {
+public class KeyValueBlockIterator implements BlockIterator<BlockData>,
+    Closeable {
+  private final ReferenceCountedDB db;
-    MetadataStore metadataStore = BlockUtils.getDB(keyValueContainerData, new
+    db = BlockUtils.getDB(keyValueContainerData, new
-    blockIterator = metadataStore.iterator();
+    blockIterator = db.getStore().iterator();
+
+  public void close() {
+    db.close();
+  }
