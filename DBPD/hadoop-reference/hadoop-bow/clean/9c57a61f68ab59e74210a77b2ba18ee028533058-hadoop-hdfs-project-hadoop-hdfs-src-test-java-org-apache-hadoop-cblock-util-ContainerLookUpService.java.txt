HDFS-11424. Block Storage: add container representation to meta data. Contributed Chen Liang.

+import org.apache.hadoop.ozone.container.ContainerTestHelper;
+import org.apache.hadoop.scm.container.common.helpers.Pipeline;
+import java.io.IOException;
-   * @return
+   * @return the corresponding pipeline instance (create if not exist)
-  public static ContainerDescriptor lookUp(String containerID) {
+  public static ContainerDescriptor lookUp(String containerID)
+      throws IOException {
-      System.err.println("A container id never seen, return a new one " +
-          "for testing purpose:" + containerID);
-      containers.put(containerID, new ContainerDescriptor(containerID));
+      Pipeline pipeline = ContainerTestHelper.createSingleNodePipeline(
+          containerID);
+      ContainerDescriptor cd = new ContainerDescriptor(containerID);
+      cd.setPipeline(pipeline);
+      containers.put(containerID, cd);
-  public static void addContainer(String containerID) {
-    containers.put(containerID, new ContainerDescriptor(containerID));
+  public static void addContainer(String containerID) throws IOException {
+    Pipeline pipeline = ContainerTestHelper.createSingleNodePipeline(
+        containerID);
+    ContainerDescriptor cd = new ContainerDescriptor(containerID);
+    cd.setPipeline(pipeline);
+    containers.put(containerID, cd);
-}
+}
