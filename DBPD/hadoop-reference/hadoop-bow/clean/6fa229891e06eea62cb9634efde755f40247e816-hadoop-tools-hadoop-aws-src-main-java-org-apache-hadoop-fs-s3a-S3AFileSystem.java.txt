HADOOP-15625. S3A input stream to use etags/version number to detect changed source files.

Author: Ben Roling <ben.roling@gmail.com>

Initial patch from Brahma Reddy Battula.

+import org.apache.hadoop.fs.s3a.impl.ChangeDetectionPolicy;
+  private ChangeDetectionPolicy changeDetectionPolicy;
+      changeDetectionPolicy = ChangeDetectionPolicy.getPolicy(conf);
+      LOG.debug("Change detection policy = {}", changeDetectionPolicy);
+   * Get the change detection policy for this FS instance.
+   * @return the change detection policy
+   */
+  @VisibleForTesting
+  ChangeDetectionPolicy getChangeDetectionPolicy() {
+    return changeDetectionPolicy;
+  }
+
+  /**
-      readContext = createReadContext(fileStatus, policy, readAheadRange2);
+      // TODO support change detection policy from options?
+      readContext = createReadContext(
+          fileStatus,
+          policy,
+          changeDetectionPolicy,
+          readAheadRange2);
-      readContext = createReadContext(fileStatus, inputPolicy, readAhead);
+      readContext = createReadContext(
+          fileStatus,
+          inputPolicy,
+          changeDetectionPolicy,
+          readAhead);
+      final ChangeDetectionPolicy changePolicy,
+        changePolicy,
-        createReadContext(fileStatus, inputPolicy, ra),
+        createReadContext(fileStatus, inputPolicy, changeDetectionPolicy, ra),
