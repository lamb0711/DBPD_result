HDDS-2161. Create RepeatedKeyInfo structure to be saved in deletedTable

Signed-off-by: Anu Engineer <aengineer@apache.org>

-import org.apache.hadoop.ozone.OmUtils;
+import org.apache.hadoop.ozone.om.helpers.RepeatedOmKeyInfo;
-  private long deleteTimeStamp;
-      String openKey, long deleteTimeStamp,
-      OmKeyInfo deletePartKeyInfo, OmMultipartKeyInfo omMultipartKeyInfo,
+      String openKey, OmKeyInfo deletePartKeyInfo,
+      OmMultipartKeyInfo omMultipartKeyInfo,
-    this.deleteTimeStamp = deleteTimeStamp;
+      RepeatedOmKeyInfo repeatedOmKeyInfo =
+          omMetadataManager.getDeletedTable().get(openKey);
+      if(repeatedOmKeyInfo == null) {
+        repeatedOmKeyInfo = new RepeatedOmKeyInfo(deletePartKeyInfo);
+      } else {
+        repeatedOmKeyInfo.addOmKeyInfo(deletePartKeyInfo);
+      }
-          OmUtils.getDeletedKeyName(openKey, deleteTimeStamp),
-          deletePartKeyInfo);
+          openKey,
+          repeatedOmKeyInfo);
+        RepeatedOmKeyInfo repeatedOmKeyInfo = omMetadataManager.
+            getDeletedTable().get(oldMultipartKeyInfo.getPartName());
+        if(repeatedOmKeyInfo == null) {
+          repeatedOmKeyInfo = new RepeatedOmKeyInfo(
+              OmKeyInfo.getFromProtobuf(oldMultipartKeyInfo.getPartKeyInfo()));
+        } else {
+          repeatedOmKeyInfo.addOmKeyInfo(
+              OmKeyInfo.getFromProtobuf(oldMultipartKeyInfo.getPartKeyInfo()));
+        }
+
-            OmUtils.getDeletedKeyName(oldMultipartKeyInfo.getPartName(),
-                deleteTimeStamp),
-            OmKeyInfo.getFromProtobuf(oldMultipartKeyInfo.getPartKeyInfo()));
+            oldMultipartKeyInfo.getPartName(),
+            repeatedOmKeyInfo);
