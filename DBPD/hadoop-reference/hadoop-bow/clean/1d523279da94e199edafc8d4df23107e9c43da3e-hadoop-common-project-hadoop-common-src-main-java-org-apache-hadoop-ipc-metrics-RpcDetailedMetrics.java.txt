HDFS-14084. Need for more stats in DFSClient. Contributed by Pranay Singh.

Signed-off-by: Wei-Chiu Chuang <weichiu@apache.org>

+  RpcDetailedMetrics(String clientId) {
+    name = "RpcDetailedActivityForClient"+ clientId;
+    registry = new MetricsRegistry("rpcdetailed")
+        .tag("client", "RPC client", clientId);
+    LOG.debug(registry.info().toString());
+  }
+
+  public static RpcDetailedMetrics create(String clientId) {
+    RpcDetailedMetrics m = new RpcDetailedMetrics(clientId);
+    return DefaultMetricsSystem.instance().register(m.name, null, m);
+  }
+
-  public void addProcessingTime(String name, int processingTime) {
-    rates.add(name, processingTime);
+  public void addProcessingTime(String metName, long processingTime) {
+    rates.add(metName, processingTime);
-  public void addDeferredProcessingTime(String name, long processingTime) {
-    deferredRpcRates.add(name, processingTime);
+  public void addDeferredProcessingTime(String metName, long processingTime) {
+    deferredRpcRates.add(metName, processingTime);
+  }
+
+  public MutableRatesWithAggregation getMutableRates() {
+    return rates;
