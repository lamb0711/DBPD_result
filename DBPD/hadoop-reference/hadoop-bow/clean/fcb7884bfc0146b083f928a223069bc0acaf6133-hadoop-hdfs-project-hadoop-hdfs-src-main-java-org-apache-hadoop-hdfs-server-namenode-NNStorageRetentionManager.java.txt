HDFS-8178. QJM doesn't move aside stale inprogress edits files. Contributed by Istvan Fajth.

Signed-off-by: Wei-Chiu Chuang <weichiu@apache.org>

-  static interface StoragePurger {
+  interface StoragePurger {
+    void markStale(EditLogFile log);
-      LOG.info("Purging old edit log " + log);
+      LOG.info("Purging old edit log {}", log);
-      LOG.info("Purging old image " + image);
+      LOG.info("Purging old image {}", image);
-        LOG.warn("Could not delete " + file);
+        LOG.warn("Could not delete {}", file);
+
+    public void markStale(EditLogFile log){
+      try {
+        log.moveAsideStaleInprogressFile();
+      } catch (IOException e) {
+        // It is ok to just log the rename failure and go on, we will try next
+        // time just as with deletions.
+        LOG.warn("Could not mark {} as stale", log, e);
+      }
+    }
