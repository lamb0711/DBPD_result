HDDS-1525. Mapreduce failure when using Hadoop 2.7.5

Closes #1065

-import java.util.List;
+import java.util.List;
+import java.util.stream.Collectors;
-import org.apache.hadoop.ozone.om.helpers.OzoneFileStatus;
-    LinkedList<OzoneFileStatus> statuses = new LinkedList<>();
-    List<OzoneFileStatus> tmpStatusList;
+    LinkedList<FileStatus> statuses = new LinkedList<>();
+    List<FileStatus> tmpStatusList;
-          adapter.listStatus(pathToKey(f), false, startKey, numEntries);
+          adapter.listStatus(pathToKey(f), false, startKey, numEntries, uri,
+              workingDir, getUsername())
+              .stream()
+              .map(this::convertFileStatus)
+              .collect(Collectors.toList());
+
-    for (OzoneFileStatus status : statuses) {
-      status.makeQualified(uri, status.getPath().makeQualified(uri, workingDir),
-          getUsername(), getUsername());
-    }
+
-
-    return adapter.getFileStatus(key)
-        .makeQualified(uri, qualifiedPath, getUsername(), getUsername());
+    FileStatus status = convertFileStatus(
+        adapter.getFileStatus(key, uri, qualifiedPath, getUsername()));
+    return status;
+
+  private FileStatus convertFileStatus(
+      FileStatusAdapter fileStatusAdapter) {
+
+    Path symLink = null;
+    try {
+      fileStatusAdapter.getSymlink();
+    } catch (Exception ex) {
+      //NOOP: If not symlink symlink remains null.
+    }
+
+    return new FileStatus(
+        fileStatusAdapter.getLength(),
+        fileStatusAdapter.isDir(),
+        fileStatusAdapter.getBlockReplication(),
+        fileStatusAdapter.getBlocksize(),
+        fileStatusAdapter.getModificationTime(),
+        fileStatusAdapter.getAccessTime(),
+        new FsPermission(fileStatusAdapter.getPermission()),
+        fileStatusAdapter.getOwner(),
+        fileStatusAdapter.getGroup(),
+        symLink,
+        fileStatusAdapter.getPath()
+    );
+
+  }
