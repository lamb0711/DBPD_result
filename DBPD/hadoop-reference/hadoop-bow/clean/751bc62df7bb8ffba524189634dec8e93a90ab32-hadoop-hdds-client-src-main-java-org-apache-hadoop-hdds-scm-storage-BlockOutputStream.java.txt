Merge branch 'HDDS-4' into trunk

+import org.apache.hadoop.hdds.scm.pipeline.Pipeline;
-   * @param xceiverClient        client to perform container calls
+   * @param pipeline             pipeline where block will be written
-      XceiverClientManager xceiverClientManager, XceiverClientSpi xceiverClient,
+      XceiverClientManager xceiverClientManager, Pipeline pipeline,
-      long streamBufferMaxSize, long watchTimeout,
-      List<ByteBuffer> bufferList, Checksum checksum) {
+      long streamBufferMaxSize, long watchTimeout, List<ByteBuffer> bufferList,
+      Checksum checksum) throws IOException {
-    this.xceiverClient = xceiverClient;
+    this.xceiverClient = xceiverClientManager.acquireClient(pipeline);
-          cleanup();
+          cleanup(false);
-  public void cleanup() {
+  public void cleanup(boolean invalidateClient) {
-      xceiverClientManager.releaseClient(xceiverClient);
+      xceiverClientManager.releaseClient(xceiverClient, invalidateClient);
