HADOOP-6585.  Add FileStatus#isDirectory and isFile.  Contributed by Eli Collins.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@949658 13f79535-47bb-0310-9956-ffa450edef68

-    if (srcStatus == null) {
-      throw new FileNotFoundException("rename source " + src + " not found.");
-    }
-      if (srcStatus.isDir() != dstStatus.isDir()) {
-        throw new IOException("Source " + src + " Destination " + dst
-            + " both should be either file or directory");
+      // It's OK to rename a file to a symlink and vice versa
+      if (srcStatus.isDirectory() != dstStatus.isDirectory()) {
+        throw new IOException("Source " + src + " and destination " + dst
+            + " must both be directories");
-        throw new FileAlreadyExistsException("rename destination " + dst
+        throw new FileAlreadyExistsException("Rename destination " + dst
-      if (dstStatus.isDir()) {
+      if (dstStatus.isDirectory()) {
-              "rename cannot overwrite non empty destination directory " + dst);
+              "Rename cannot overwrite non empty destination directory " + dst);
-      final FileStatus parentStatus = getFileLinkStatus(parent);
-      if (parentStatus == null) {
-        throw new FileNotFoundException("rename destination parent " + parent
-            + " not found.");
-      }
-      if (!parentStatus.isDir() && !parentStatus.isSymlink()) {
-        throw new ParentNotDirectoryException("rename destination parent "
+      final FileStatus parentStatus = getFileStatus(parent);
+      if (parentStatus.isFile()) {
+        throw new ParentNotDirectoryException("Rename destination parent "
