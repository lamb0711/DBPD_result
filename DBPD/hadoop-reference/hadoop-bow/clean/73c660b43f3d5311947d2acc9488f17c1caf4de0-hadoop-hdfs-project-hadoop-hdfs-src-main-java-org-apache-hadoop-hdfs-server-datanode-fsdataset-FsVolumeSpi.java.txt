HDFS-13958. Miscellaneous Improvements for FsVolumeSpi. Contributed by BELUGA BEHR.

-import java.util.LinkedList;
+import java.util.Collection;
-import org.apache.hadoop.hdfs.server.datanode.FileIoProvider;
+import org.apache.hadoop.hdfs.server.datanode.FileIoProvider;
-      } else if (blockSuffix == null) {
-        return new File(new File(volume.getBaseURI()).getAbsolutePath(),
-            metaSuffix);
-      } else {
-        return new File(new File(volume.getBaseURI()).getAbsolutePath(),
-            blockSuffix + metaSuffix);
+      String fileSuffix = metaSuffix;
+      if (blockSuffix != null) {
+        fileSuffix = blockSuffix + metaSuffix;
+      }
+      return new File(new File(volume.getBaseURI()).getAbsolutePath(),
+          fileSuffix);
-    @Override // Comparable
+    @Override
-      if (blockId < b.blockId) {
-        return -1;
-      } else if (blockId == b.blockId) {
-        return 0;
-      } else {
-        return 1;
-      }
+      return Long.compare(this.blockId, b.blockId);
-    @Override // Object
+    @Override
-    @Override // Object
+    @Override
-      return (int)(blockId^(blockId>>>32));
+      return Long.hashCode(this.blockId);
-  LinkedList<ScanInfo> compileReport(String bpid,
-      LinkedList<ScanInfo> report, ReportCompiler reportCompiler)
+  void compileReport(String bpid,
+      Collection<ScanInfo> report, ReportCompiler reportCompiler)
