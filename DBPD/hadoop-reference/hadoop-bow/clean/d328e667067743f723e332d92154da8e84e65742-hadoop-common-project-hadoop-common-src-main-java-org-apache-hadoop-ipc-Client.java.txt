HADOOP-13227. AsyncCallHandler should use an event driven architecture to handle async calls.

+  private static final ThreadLocal<Object> EXTERNAL_CALL_HANDLER
+      = new ThreadLocal<>();
-  public static void setCallIdAndRetryCount(int cid, int rc) {
+  public static void setCallIdAndRetryCount(int cid, int rc,
+                                            Object externalHandler) {
+    EXTERNAL_CALL_HANDLER.set(externalHandler);
+    private final Object externalHandler;
+
+      this.externalHandler = EXTERNAL_CALL_HANDLER.get();
+
+      if (externalHandler != null) {
+        synchronized (externalHandler) {
+          externalHandler.notify();
+        }
+      }
