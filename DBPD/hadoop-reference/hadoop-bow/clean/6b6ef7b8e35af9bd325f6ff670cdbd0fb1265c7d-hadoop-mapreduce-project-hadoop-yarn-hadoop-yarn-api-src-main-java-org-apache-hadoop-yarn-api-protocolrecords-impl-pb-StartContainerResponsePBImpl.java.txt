MAPREDUCE-2947. Fixed race condition in AuxiliaryServices. Contributed by Vinod K V.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1166849 13f79535-47bb-0310-9956-ffa450edef68

-  public StartContainerResponseProto getProto() {
+  public synchronized StartContainerResponseProto getProto() {
-  private void mergeLocalToBuilder() {
+  private synchronized void mergeLocalToBuilder() {
-  private void mergeLocalToProto() {
+  private synchronized void mergeLocalToProto() {
-  private void maybeInitBuilder() {
+  private synchronized void maybeInitBuilder() {
-  public Map<String, ByteBuffer> getAllServiceResponse() {
+  public synchronized Map<String, ByteBuffer> getAllServiceResponse() {
-  public ByteBuffer getServiceResponse(String key) {
+  public synchronized ByteBuffer getServiceResponse(String key) {
-  private void initServiceResponse() {
+  private synchronized void initServiceResponse() {
-  public void addAllServiceResponse(final Map<String, ByteBuffer> serviceResponse) {
+  public synchronized void addAllServiceResponse(final Map<String, ByteBuffer> serviceResponse) {
-  private void addServiceResponseToProto() {
+  private synchronized void addServiceResponseToProto() {
-      public Iterator<StringBytesMapProto> iterator() {
+      public synchronized Iterator<StringBytesMapProto> iterator() {
-          public void remove() {
+          public synchronized void remove() {
-          public StringBytesMapProto next() {
+          public synchronized StringBytesMapProto next() {
-          public boolean hasNext() {
+          public synchronized boolean hasNext() {
-  public void setServiceResponse(String key, ByteBuffer val) {
+  public synchronized void setServiceResponse(String key, ByteBuffer val) {
-  public void removeServiceResponse(String key) {
+  public synchronized void removeServiceResponse(String key) {
-  public void clearServiceResponse() {
+  public synchronized void clearServiceResponse() {
