YARN-5363. For AM containers, or for containers of running-apps, "yarn logs" incorrectly only (tries to) shows syslog file-type by default. (Contributed by Vinod Kumar Vavilapalli)

+
+
-import org.apache.hadoop.yarn.logaggregation.LogCLIHelpers;
-import org.apache.hadoop.yarn.util.ConverterUtils;
+import org.apache.hadoop.yarn.logaggregation.LogCLIHelpers;
-  private static final String CONTAINER_LOG_FILES = "logFiles";
+  private static final String PER_CONTAINER_LOG_FILES_OPTION = "log_files";
-      if (commandLine.hasOption(CONTAINER_LOG_FILES)) {
-        logFiles = commandLine.getOptionValues(CONTAINER_LOG_FILES);
+      if (commandLine.hasOption(PER_CONTAINER_LOG_FILES_OPTION)) {
+        logFiles = commandLine.getOptionValues(PER_CONTAINER_LOG_FILES_OPTION);
-    if(logFiles != null) {
-      List<String> logs = Arrays.asList(logFiles);
-      if(logs.contains("ALL") || logs.contains(".*")) {
-        return true;
-      }
+
+    // If no value is specified for the PER_CONTAINER_LOG_FILES_OPTION option,
+    // we will assume all logs.
+    if (logFiles == null || logFiles.length == 0) {
+      return true;
+
+    List<String> logs = Arrays.asList(logFiles);
+    if (logs.contains("ALL") || logs.contains(".*")) {
+      return true;
+    }
+
-      // filter the log files based on the given --logFiles pattern
+      // filter the log files based on the given -log_files pattern
-        + "By default, it will only print syslog if the application is running."
-        + " Work with -logFiles to get other logs. If specified, the"
+        + "By default, it will print all available logs."
+        + " Work with -log_files to get only specific logs. If specified, the"
-        + "By default, it will only print out syslog. Work with -logFiles "
-        + "to get other logs");
+        + "By default, it will print all available logs. Work with -log_files "
+        + "to get only specific logs.");
-    Option logFileOpt = new Option(CONTAINER_LOG_FILES, true,
+    Option logFileOpt = new Option(PER_CONTAINER_LOG_FILES_OPTION, true,
-    printOpts.addOption(commandOpts.getOption(CONTAINER_LOG_FILES));
+    printOpts.addOption(commandOpts.getOption(PER_CONTAINER_LOG_FILES_OPTION));
-    List<String> logFiles = request.getLogTypes();
-    // if we do not specify the value for CONTAINER_LOG_FILES option,
-    // we will only output syslog
-    if (logFiles == null || logFiles.isEmpty()) {
-      logFiles = Arrays.asList("syslog");
-    }
-    request.setLogTypes(logFiles);
+
-    List<String> logFiles = request.getLogTypes();
-      // if we do not specify the value for CONTAINER_LOG_FILES option,
-      // we will only output syslog
-      if (logFiles == null || logFiles.isEmpty()) {
-        logFiles = Arrays.asList("syslog");
-      }
-      request.setLogTypes(logFiles);
-      // if we do not specify the value for CONTAINER_LOG_FILES option,
-      // we will only output syslog
-      List<String> logFiles = newOptions.getLogTypes();
-      if (logFiles == null || logFiles.isEmpty()) {
-        logFiles = Arrays.asList("syslog");
-        newOptions.setLogTypes(logFiles);
-      }
