Rebase onto latest trunk. minor conflicts

+  @Private
+  @Unstable
