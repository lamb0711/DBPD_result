HDFS-7034. Archival Storage: Fix TestBlockPlacement and TestStorageMover. Contributed by Jing Zhao.

+import com.google.common.annotations.VisibleForTesting;
+import org.apache.hadoop.fs.FSDataOutputStream;
+import org.apache.hadoop.hdfs.DFSConfigKeys;
+  private static boolean createIdFile = true;
+  @VisibleForTesting
+  public static void setCreateIdFile(boolean create) {
+    createIdFile = create;
+  }
+
-    // Exit if there is another one running.
-    out = checkAndMarkRunning(); 
-    if (out == null) {
+    // if it is for test, we do not create the id file
+    out = createIdFile ? checkAndMarkRunning() : null;
+    if (createIdFile && out == null) {
+      // Exit if there is another one running.
-      final DataOutputStream out = fs.create(idPath);
+      final FSDataOutputStream out = fs.create(idPath);
-      out.flush();
+      out.hflush();
