Merge r1415804 through r1419190 from trunk.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1419193 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.concurrent.ConcurrentMap;
+import org.apache.hadoop.yarn.api.records.ApplicationId;
+import org.apache.hadoop.yarn.server.resourcemanager.RMContext;
-import org.apache.hadoop.yarn.webapp.view.JQueryUI.Render;
-  final AppsList list;
+  final ConcurrentMap<ApplicationId, RMApp> apps;
-  @Inject public FairSchedulerAppsBlock(AppsList list, 
+  @Inject public FairSchedulerAppsBlock(RMContext rmContext, 
-    this.list = list;
+    apps = rmContext.getRMApps();
-    int i = 0;
-    for (RMApp app : list.apps.values()) {
+    for (RMApp app : apps.values()) {
-      if (list.rendering != Render.HTML && ++i >= 20) break;
-
-    if (list.rendering == Render.JS_ARRAY) {
-      echo("<script type='text/javascript'>\n",
-           "var appsData=");
-      list.toDataTableArrays(reqAppStates, writer());
-      echo("\n</script>\n");
-    }
