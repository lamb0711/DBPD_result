HDFS-4798. Update computeContentSummary() for the reference nodes in snapshots.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1479671 13f79535-47bb-0310-9956-ffa450edef68

-  public final Content.CountsMap computeContentSummary(Content.CountsMap countsMap) {
-    return referred.computeContentSummary(countsMap);
-  }
-
-  @Override
-  public final Content.Counts computeContentSummary(Content.Counts counts) {
+  public Content.Counts computeContentSummary(Content.Counts counts) {
+    public final Content.Counts computeContentSummary(Content.Counts counts) {
+      //only count diskspace for WithName
+      final Quota.Counts q = Quota.Counts.newInstance();
+      computeQuotaUsage(q, false, lastSnapshotId);
+      counts.add(Content.DISKSPACE, q.get(Quota.DISKSPACE));
+      return counts;
+    }
+
+    @Override
