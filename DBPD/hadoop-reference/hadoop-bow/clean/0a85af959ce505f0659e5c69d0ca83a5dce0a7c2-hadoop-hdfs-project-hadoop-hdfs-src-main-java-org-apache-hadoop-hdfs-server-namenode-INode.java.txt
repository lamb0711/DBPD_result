HDFS-13101. Yet another fsimage corruption related to snapshot. Contributed by Shashikant Banerjee.

+import org.apache.hadoop.hdfs.server.namenode.INodeReference.WithCount;
+  /**
+   * @return true if this is a reference and the reference count is 1;
+   *         otherwise, return false.
+   */
+  public boolean isLastReference() {
+    final INodeReference ref = getParentReference();
+    if (!(ref instanceof WithCount)) {
+      return false;
+    }
+    return ((WithCount)ref).getReferenceCount() == 1;
+  }
+
