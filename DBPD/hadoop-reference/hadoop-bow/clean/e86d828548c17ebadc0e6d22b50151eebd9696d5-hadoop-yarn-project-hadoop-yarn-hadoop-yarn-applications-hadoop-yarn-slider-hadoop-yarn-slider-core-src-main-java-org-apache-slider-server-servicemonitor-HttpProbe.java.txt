YARN-6716. Native services support for specifying component start order. Contributed by Billie Rinaldi

+import org.apache.slider.server.appmaster.state.RoleInstance;
+import java.util.Map;
-  private final URL url;
+  private static final String HOST_TOKEN = "${THIS_HOST}";
+
+  private final String urlString;
-  public HttpProbe(URL url, int timeout, int min, int max, Configuration conf) throws IOException {
+  public HttpProbe(String url, int timeout, int min, int max, Configuration
+      conf) {
-    this.url = url;
+    this.urlString = url;
-  public static HttpURLConnection getConnection(URL url, int timeout) throws IOException {
+  public static HttpProbe create(Map<String, String> props)
+      throws IOException {
+    String urlString = getProperty(props, WEB_PROBE_URL, null);
+    new URL(urlString);
+    int timeout = getPropertyInt(props, WEB_PROBE_CONNECT_TIMEOUT,
+        WEB_PROBE_CONNECT_TIMEOUT_DEFAULT);
+    int minSuccess = getPropertyInt(props, WEB_PROBE_MIN_SUCCESS,
+        WEB_PROBE_MIN_SUCCESS_DEFAULT);
+    int maxSuccess = getPropertyInt(props, WEB_PROBE_MAX_SUCCESS,
+        WEB_PROBE_MAX_SUCCESS_DEFAULT);
+    return new HttpProbe(urlString, timeout, minSuccess, maxSuccess, null);
+  }
+
+
+  private static HttpURLConnection getConnection(URL url, int timeout) throws
+      IOException {
-  public ProbeStatus ping(boolean livePing) {
+  public ProbeStatus ping(RoleInstance roleInstance) {
+    String ip = roleInstance.ip;
+    if (ip == null) {
+      status.fail(this, new IOException("IP is not available yet"));
+      return status;
+    }
+
-      if (log.isDebugEnabled()) {
-        // LOG.debug("Fetching " + url + " with timeout " + timeout);
-      }
+      URL url = new URL(urlString.replace(HOST_TOKEN, ip));
-    } catch (IOException e) {
-      String error = "Probe " + url + " failed: " + e;
+    } catch (Throwable e) {
+      String error = "Probe " + urlString + " failed for IP " + ip + ": " + e;
