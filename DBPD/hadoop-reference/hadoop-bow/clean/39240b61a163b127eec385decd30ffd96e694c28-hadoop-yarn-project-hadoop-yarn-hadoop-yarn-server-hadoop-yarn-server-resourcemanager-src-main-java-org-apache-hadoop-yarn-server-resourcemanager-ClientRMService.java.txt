YARN-7043. Cleanup ResourceProfileManager. (wangda)

Change-Id: I463356f37bf1f6a3f1fc3c594c79916e8c0ab913

-import org.apache.hadoop.yarn.exceptions.ResourceProfilesNotEnabledException;
+import org.apache.hadoop.yarn.util.resource.ResourceUtils;
-    response.setResourceProfiles(getResourceProfiles());
+    response.setResourceProfiles(resourceProfilesManager.getResourceProfiles());
-    Map<String, Resource> profiles = getResourceProfiles();
-    if (!profiles.containsKey(request.getProfileName())) {
-      throw new YarnException(
-          "Resource profile '" + request.getProfileName() + "' not found");
-    }
-    response.setResource(profiles.get(request.getProfileName()));
+    response.setResource(
+        resourceProfilesManager.getProfile(request.getProfileName()));
-  private Map<String, Resource> getResourceProfiles() throws YarnException {
-    boolean resourceProfilesEnabled = getConfig()
-        .getBoolean(YarnConfiguration.RM_RESOURCE_PROFILES_ENABLED,
-            YarnConfiguration.DEFAULT_RM_RESOURCE_PROFILES_ENABLED);
-    if (!resourceProfilesEnabled) {
-      throw new ResourceProfilesNotEnabledException(
-          "Resource profiles are not enabled");
-    }
-    return resourceProfilesManager.getResourceProfiles();
-  }
-
-    response.setResourceTypeInfo(
-        resourceProfilesManager.getAllResourceTypeInfo());
+    response.setResourceTypeInfo(ResourceUtils.getResourcesTypeInfo());
