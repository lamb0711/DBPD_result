HADOOP-8077. HA: fencing method should be able to be configured on a per-NN or per-NS basis. Contributed by Todd Lipcon.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1310173 13f79535-47bb-0310-9956-ffa450edef68

-  public static final String CONF_METHODS_KEY =
-    "dfs.ha.fencing.methods";
-  
-  public NodeFencer(Configuration conf)
+  NodeFencer(Configuration conf, String spec)
-    this.methods = parseMethods(conf);
+    this.methods = parseMethods(conf, spec);
-  public static NodeFencer create(Configuration conf)
+  public static NodeFencer create(Configuration conf, String confKey)
-    String confStr = conf.get(CONF_METHODS_KEY);
+    String confStr = conf.get(confKey);
-    return new NodeFencer(conf);
+    return new NodeFencer(conf, confStr);
-  private static List<FenceMethodWithArg> parseMethods(Configuration conf)
+  private static List<FenceMethodWithArg> parseMethods(Configuration conf,
+      String spec)
-    String confStr = conf.get(CONF_METHODS_KEY);
-    String[] lines = confStr.split("\\s*\n\\s*");
+    String[] lines = spec.split("\\s*\n\\s*");
