HDFS-3062. Fix bug which prevented MR job submission from creating delegation tokens on an HA cluster. Contributed by Mingjie Lai.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1301285 13f79535-47bb-0310-9956-ffa450edef68

+
+  /**
+   * Get a canonical service name for this file system. If the URI is logical,
+   * the hostname part of the URI will be returned.
+   * @return a service string that uniquely identifies this file system.
+   */
+  @Override
+  public String getCanonicalServiceName() {
+    if (HAUtil.isLogicalUri(getConf(), getUri())) {
+      return getUri().getHost();
+    } else {
+      return super.getCanonicalServiceName();
+    }
+  }
