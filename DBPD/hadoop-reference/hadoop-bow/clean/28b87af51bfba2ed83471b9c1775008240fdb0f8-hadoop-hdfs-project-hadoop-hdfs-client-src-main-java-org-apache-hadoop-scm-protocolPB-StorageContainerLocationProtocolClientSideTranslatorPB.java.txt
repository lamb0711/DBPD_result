HDFS-13013. Fix closeContainer API with the right container state change. Contributed by Xiaoyu Yao.

-import org.apache.hadoop.ozone.protocol.proto.StorageContainerLocationProtocolProtos.CloseContainerRequestProto;
-import org.apache.hadoop.ozone.protocol.proto.StorageContainerLocationProtocolProtos.NotifyObjectCreationStageRequestProto;
+import org.apache.hadoop.ozone.protocol.proto.StorageContainerLocationProtocolProtos.ObjectStageChangeRequestProto;
+   * @param op operation type (e.g., create, close, delete)
-  public void notifyObjectCreationStage(
-      NotifyObjectCreationStageRequestProto.Type type,
-      String name,
-      NotifyObjectCreationStageRequestProto.Stage stage) throws IOException {
+  public void notifyObjectStageChange(
+      ObjectStageChangeRequestProto.Type type, String name,
+      ObjectStageChangeRequestProto.Op op,
+      ObjectStageChangeRequestProto.Stage stage) throws IOException {
-    NotifyObjectCreationStageRequestProto request =
-        NotifyObjectCreationStageRequestProto.newBuilder()
+    ObjectStageChangeRequestProto request =
+        ObjectStageChangeRequestProto.newBuilder()
+            .setOp(op)
-      rpcProxy.notifyObjectCreationStage(NULL_RPC_CONTROLLER, request);
+      rpcProxy.notifyObjectStageChange(NULL_RPC_CONTROLLER, request);
-  public void closeContainer(String containerName) throws IOException {
-    Preconditions.checkState(!Strings.isNullOrEmpty(containerName),
-        "Container name cannot be null or empty");
-    CloseContainerRequestProto request = CloseContainerRequestProto
-        .newBuilder()
-        .setContainerName(containerName)
-        .build();
-    try {
-      rpcProxy.closeContainer(NULL_RPC_CONTROLLER, request);
-    } catch (ServiceException e) {
-      throw ProtobufHelper.getRemoteException(e);
-    }
-  }
-
-  @Override
