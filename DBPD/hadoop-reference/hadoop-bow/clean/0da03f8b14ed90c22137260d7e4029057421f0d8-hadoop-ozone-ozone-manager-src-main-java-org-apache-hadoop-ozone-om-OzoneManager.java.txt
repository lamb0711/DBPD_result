HDDS-391. Simplify Audit Framework to make audit logging easier to use.
Contributed by Dinesh Chitlangia.

+import org.apache.hadoop.ozone.audit.Auditor;
-import org.apache.logging.log4j.Level;
-    implements OzoneManagerProtocol, OMMXBean {
+    implements OzoneManagerProtocol, OMMXBean, Auditor {
-      AUDIT.logWriteFailure(Level.ERROR,
+      AUDIT.logWriteFailure(
-              (args == null) ? null : args.toAuditMap()), ex);
+              (args == null) ? null : args.toAuditMap(), ex)
+      );
-          auditMap), ex);
+          auditMap, ex)
+      );
-          auditMap), ex);
+          auditMap, ex));
-          OMAction.CHECK_VOLUME_ACCESS, auditMap), ex);
+          OMAction.CHECK_VOLUME_ACCESS, auditMap, ex));
-          auditMap), ex);
+          auditMap, ex));
-          buildAuditMap(volume)), ex);
+          buildAuditMap(volume), ex));
-          auditMap), ex);
+          auditMap, ex));
-          auditMap), ex);
+          auditMap, ex));
-          (bucketInfo == null) ? null : bucketInfo.toAuditMap()), ex);
+          (bucketInfo == null) ? null : bucketInfo.toAuditMap(), ex));
-          auditMap), ex);
+          auditMap, ex));
-          auditMap), ex);
+          auditMap, ex));
-          (args == null) ? null : args.toAuditMap()), ex);
+          (args == null) ? null : args.toAuditMap(), ex));
-          auditMap), ex);
+          auditMap, ex));
-          auditMap), ex);
+          auditMap, ex));
-          (args == null) ? null : args.toAuditMap()), ex);
+          (args == null) ? null : args.toAuditMap(), ex));
-          auditMap), e);
+          auditMap, e));
-          (args == null) ? null : args.toAuditMap()), ex);
+          (args == null) ? null : args.toAuditMap(), ex));
-          auditMap), ex);
+          auditMap, ex));
-          (args == null) ? null : args.toAuditMap()), ex);
+          (args == null) ? null : args.toAuditMap(), ex));
-          auditMap), ex);
+          auditMap, ex));
-  // TODO: Temporary method until AuditMessage is simplified
-  private AuditMessage buildAuditMessageForSuccess(AuditAction op,
+  @Override
+  public AuditMessage buildAuditMessageForSuccess(AuditAction op,
-    return new AuditMessage(
-      (Server.getRemoteUser() == null) ? null :
-              Server.getRemoteUser().getUserName(),
-      (Server.getRemoteIp() == null) ? null :
-          Server.getRemoteIp().getHostAddress(), op.toString(), auditMap,
-      AuditEventStatus.SUCCESS.toString());
+    return new AuditMessage.Builder()
+        .setUser((Server.getRemoteUser() == null) ? null :
+            Server.getRemoteUser().getUserName())
+        .atIp((Server.getRemoteIp() == null) ? null :
+            Server.getRemoteIp().getHostAddress())
+        .forOperation(op.getAction())
+        .withParams(auditMap)
+        .withResult(AuditEventStatus.SUCCESS.toString())
+        .withException(null)
+        .build();
-  // TODO: Temporary method until AuditMessage is simplified
-  private AuditMessage buildAuditMessageForFailure(AuditAction op,
-      Map<String, String> auditMap) {
-    return new AuditMessage(
-      (Server.getRemoteUser() == null) ? null :
-              Server.getRemoteUser().getUserName(),
-      (Server.getRemoteIp() == null) ? null :
-          Server.getRemoteIp().getHostAddress(), op.toString(), auditMap,
-      AuditEventStatus.FAILURE.toString());
+  @Override
+  public AuditMessage buildAuditMessageForFailure(AuditAction op,
+      Map<String, String> auditMap, Throwable throwable) {
+    return new AuditMessage.Builder()
+        .setUser((Server.getRemoteUser() == null) ? null :
+            Server.getRemoteUser().getUserName())
+        .atIp((Server.getRemoteIp() == null) ? null :
+            Server.getRemoteIp().getHostAddress())
+        .forOperation(op.getAction())
+        .withParams(auditMap)
+        .withResult(AuditEventStatus.FAILURE.toString())
+        .withException(throwable)
+        .build();
