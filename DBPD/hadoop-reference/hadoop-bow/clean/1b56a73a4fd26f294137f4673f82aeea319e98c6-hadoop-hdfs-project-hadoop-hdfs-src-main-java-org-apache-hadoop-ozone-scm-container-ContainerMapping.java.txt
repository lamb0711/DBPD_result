HDFS-12680. Ozone: SCM: Lease support for container creation. Contributed by Nandakumar.

+import org.apache.hadoop.ozone.lease.Lease;
+import org.apache.hadoop.ozone.lease.LeaseException;
+import org.apache.hadoop.ozone.lease.LeaseManager;
+import org.apache.hadoop.scm.ScmConfigKeys;
+  private final LeaseManager<ContainerInfo> containerLeaseManager;
+
+    long containerCreationLeaseTimeout = conf.getLong(
+        ScmConfigKeys.OZONE_SCM_CONTAINER_CREATION_LEASE_TIMEOUT,
+        ScmConfigKeys.OZONE_SCM_CONTAINER_CREATION_LEASE_TIMEOUT_DEFAULT);
+    LOG.trace("Starting Container Lease Manager.");
+    containerLeaseManager = new LeaseManager<>(containerCreationLeaseTimeout);
+    containerLeaseManager.start();
+      if (event == OzoneProtos.LifeCycleEvent.BEGIN_CREATE) {
+        // Acquire lease on container
+        Lease<ContainerInfo> containerLease =
+            containerLeaseManager.acquire(containerInfo);
+        // Register callback to be executed in case of timeout
+        containerLease.registerCallBack(() -> {
+          containerStateManager.updateContainerState(
+              new BlockContainerInfo(containerInfo, 0),
+              OzoneProtos.LifeCycleEvent.TIMEOUT);
+          return null;
+        });
+      } else if (event == OzoneProtos.LifeCycleEvent.COMPLETE_CREATE) {
+        // Release the lease on container
+        containerLeaseManager.release(containerInfo);
+      }
+    } catch (LeaseException e) {
+      throw new IOException("Lease Exception.", e);
+    if (containerLeaseManager != null) {
+      containerLeaseManager.shutdown();
+    }
