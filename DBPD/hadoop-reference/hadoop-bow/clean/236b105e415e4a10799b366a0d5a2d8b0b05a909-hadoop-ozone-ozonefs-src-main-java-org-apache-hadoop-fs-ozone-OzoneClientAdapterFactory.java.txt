HDDS-1089. Disable OzoneFSStorageStatistics for hadoop versions older than 2.8.
Contributed by Elek, Marton.

+import java.lang.reflect.InvocationTargetException;
-      String bucketStr, OzoneFSStorageStatistics storageStatistics)
+      String bucketStr) throws IOException {
+    return createAdapter(volumeStr, bucketStr,
+        (aClass) -> (OzoneClientAdapter) aClass
+            .getConstructor(String.class, String.class)
+            .newInstance(
+                volumeStr,
+                bucketStr));
+  }
+
+
+  public static OzoneClientAdapter createAdapter(
+      String volumeStr,
+      String bucketStr,
+      OzoneFSStorageStatistics storageStatistics)
+    return createAdapter(volumeStr, bucketStr,
+        (aClass) -> (OzoneClientAdapter) aClass
+            .getConstructor(String.class, String.class,
+                OzoneFSStorageStatistics.class)
+            .newInstance(
+                volumeStr,
+                bucketStr,
+                storageStatistics));
+  }
+
+  public static OzoneClientAdapter createAdapter(
+      String volumeStr,
+      String bucketStr,
+      OzoneClientAdapterCreator creator) throws IOException {
-      OzoneClientAdapter ozoneClientAdapter = (OzoneClientAdapter) classLoader
-          .loadClass("org.apache.hadoop.fs.ozone.OzoneClientAdapterImpl")
-          .getConstructor(String.class, String.class,
-              OzoneFSStorageStatistics.class)
-          .newInstance(
-              volumeStr,
-              bucketStr, storageStatistics);
+      Class<?> aClass = classLoader
+          .loadClass("org.apache.hadoop.fs.ozone.OzoneClientAdapterImpl");
+      OzoneClientAdapter ozoneClientAdapter =
+          creator.createOzoneClientAdapter(aClass);
+  /**
+   * Interface to create OzoneClientAdapter implementation with reflection.
+   */
+  @FunctionalInterface
+  interface OzoneClientAdapterCreator {
+    OzoneClientAdapter createOzoneClientAdapter(Class<?> clientAdapter)
+        throws NoSuchMethodException, IllegalAccessException,
+        InvocationTargetException, InstantiationException;
+  }
+
