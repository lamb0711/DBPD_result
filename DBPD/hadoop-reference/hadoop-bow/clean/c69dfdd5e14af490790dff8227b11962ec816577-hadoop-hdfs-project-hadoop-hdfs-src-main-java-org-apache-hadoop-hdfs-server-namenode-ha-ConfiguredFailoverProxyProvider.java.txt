HDFS-2958. Sweep for remaining proxy construction which doesn't go through failover path.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1294811 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.hadoop.hdfs.protocol.ClientProtocol;
-import org.apache.hadoop.hdfs.server.protocol.NamenodeProtocol;
+import org.apache.hadoop.hdfs.NameNodeProxies;
-        if (NamenodeProtocol.class.equals(xface)) {
-          current.namenode = DFSUtil.createNNProxyWithNamenodeProtocol(
-              current.address, conf, ugi, false);
-        } else if (ClientProtocol.class.equals(xface)) {
-          current.namenode = DFSUtil.createNNProxyWithClientProtocol(
-              current.address, conf, ugi, false);
-        } else {
-          throw new IllegalStateException(
-              "Upsupported protocol found when creating the proxy conection to NameNode. "
-                  + ((xface != null) ? xface.getClass().getName() : xface)
-                  + " is not supported by " + this.getClass().getName());
-        }
+        current.namenode = NameNodeProxies.createNonHAProxy(conf,
+            current.address, xface, ugi, false).getProxy();
