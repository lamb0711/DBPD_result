HADOOP-17065. Add Network Counters to ABFS (#2056)


Contributed by Mehakmeet Singh.

+import org.apache.hadoop.fs.azurebfs.AbfsStatistic;
+  private AbfsCounters abfsCounters;
+    this.abfsCounters = client.getAbfsCounters();
+    this.abfsCounters = client.getAbfsCounters();
+      incrementCounter(AbfsStatistic.CONNECTIONS_MADE, 1);
-      AbfsClientThrottlingIntercept.sendingRequest(operationType);
+      AbfsClientThrottlingIntercept.sendingRequest(operationType, abfsCounters);
+        incrementCounter(AbfsStatistic.SEND_REQUESTS, 1);
+        incrementCounter(AbfsStatistic.BYTES_SENT, bufferLength);
+      incrementCounter(AbfsStatistic.GET_RESPONSES, 1);
+      incrementCounter(AbfsStatistic.BYTES_RECEIVED,
+          httpOperation.getBytesReceived());
+
+  /**
+   * Incrementing Abfs counters with a long value.
+   *
+   * @param statistic the Abfs statistic that needs to be incremented.
+   * @param value     the value to be incremented by.
+   */
+  private void incrementCounter(AbfsStatistic statistic, long value) {
+    if (abfsCounters != null) {
+      abfsCounters.incrementCounter(statistic, value);
+    }
+  }
