HDDS-2200 : Recon does not handle the NULL snapshot from OM DB cleanly.

Signed-off-by: Anu Engineer <aengineer@apache.org>

+import java.io.File;
-  @Inject
+  private ReconUtils reconUtils;
-  private ReconUtils reconUtils;
+  public ReconContainerDBProvider(OzoneConfiguration configuration,
+                                  ReconUtils reconUtils) {
+    this.configuration = configuration;
+    this.reconUtils = reconUtils;
+  }
-    DBStore dbStore = getNewDBStore(configuration, reconUtils);
+    DBStore dbStore;
+    File reconDbDir =
+        reconUtils.getReconDbDir(configuration, OZONE_RECON_DB_DIR);
+    File lastKnownOMSnapshot =
+        reconUtils.getLastKnownDB(reconDbDir, RECON_CONTAINER_DB);
+    if (lastKnownOMSnapshot != null) {
+      dbStore = getDBStore(configuration, reconUtils,
+          lastKnownOMSnapshot.getName());
+    } else {
+      dbStore = getNewDBStore(configuration, reconUtils);
+    }
-  public static DBStore getNewDBStore(OzoneConfiguration configuration,
-                                      ReconUtils reconUtils) {
+  private static DBStore getDBStore(OzoneConfiguration configuration,
+                            ReconUtils reconUtils, String dbName) {
-    String dbName = RECON_CONTAINER_DB + "_" + System.currentTimeMillis();
+
+  static DBStore getNewDBStore(OzoneConfiguration configuration,
+                               ReconUtils reconUtils) {
+    String dbName = RECON_CONTAINER_DB + "_" + System.currentTimeMillis();
+    return getDBStore(configuration, reconUtils, dbName);
+  }
