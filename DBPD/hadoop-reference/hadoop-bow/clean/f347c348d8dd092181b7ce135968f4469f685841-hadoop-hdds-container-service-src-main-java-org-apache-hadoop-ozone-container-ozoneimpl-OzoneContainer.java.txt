Add support for checksum verification in data scrubber

Signed-off-by: Anu Engineer <aengineer@apache.org>

-import org.apache.hadoop.hdds.HddsConfigKeys;
+import java.util.List;
-  private ContainerScrubber scrubber;
+  private ContainerMetadataScanner metadataScanner;
+  private List<ContainerDataScanner> dataScanners;
-    this.scrubber = null;
+    this.metadataScanner = null;
-    boolean enabled = config.getBoolean(
-        HddsConfigKeys.HDDS_CONTAINERSCRUB_ENABLED,
-        HddsConfigKeys.HDDS_CONTAINERSCRUB_ENABLED_DEFAULT);
+    ContainerScrubberConfiguration c = config.getObject(
+        ContainerScrubberConfiguration.class);
+    boolean enabled = c.isEnabled();
+    long metadataScanInterval = c.getMetadataScanInterval();
+    long bytesPerSec = c.getBandwidthPerVolume();
-      LOG.info("Background container scrubber has been disabled by {}",
-              HddsConfigKeys.HDDS_CONTAINERSCRUB_ENABLED);
+      LOG.info("Background container scanner has been disabled.");
-      if (this.scrubber == null) {
-        this.scrubber = new ContainerScrubber(config, controller);
+      if (this.metadataScanner == null) {
+        this.metadataScanner = new ContainerMetadataScanner(controller,
+            metadataScanInterval);
-      scrubber.up();
+      this.metadataScanner.start();
+
+      dataScanners = new ArrayList<>();
+      for (HddsVolume v : volumeSet.getVolumesList()) {
+        ContainerDataScanner s = new ContainerDataScanner(controller,
+            v, bytesPerSec);
+        s.start();
+        dataScanners.add(s);
+      }
-    if (scrubber == null) {
+    if (metadataScanner == null) {
-    scrubber.down();
+    metadataScanner.shutdown();
+    metadataScanner = null;
+    for (ContainerDataScanner s : dataScanners) {
+      s.shutdown();
+    }
