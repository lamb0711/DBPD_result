YARN-6933. [YARN-3926] ResourceUtils.DISALLOWED_NAMES check is duplicated. Contributed by Manikandan R.

-import java.util.HashSet;
-import java.util.Set;
-  private static final Set<String> DISALLOWED_NAMES = new HashSet<>();
-  static {
-    DISALLOWED_NAMES.add("memory");
-    DISALLOWED_NAMES.add(MEMORY);
-    DISALLOWED_NAMES.add(VCORES);
-  }
-
-  private static void checkMandatatoryResources(
+  private static void checkMandatoryResources(
+    /*
+     * Supporting 'memory' also as invalid resource name, in addition to
+     * 'MEMORY' for historical reasons
+     */
+    String key = "memory";
+    if (resourceInformationMap.containsKey(key)) {
+      LOG.warn("Attempt to define resource '" + key +
+          "', but it is not allowed.");
+      throw new YarnRuntimeException("Attempt to re-define mandatory resource '"
+          + key + "'.");
+    }
+
-  private static void addManadtoryResources(
+  private static void addMandatoryResources(
-        if (DISALLOWED_NAMES.contains(resourceName)) {
-          throw new YarnRuntimeException(
-              "Resource type cannot be named '" + resourceName
-                  + "'. That name is disallowed.");
-        }
-    checkMandatatoryResources(resourceInformationMap);
-    addManadtoryResources(resourceInformationMap);
+    checkMandatoryResources(resourceInformationMap);
+    addMandatoryResources(resourceInformationMap);
-          addManadtoryResources(nodeResources);
-          checkMandatatoryResources(nodeResources);
+          addMandatoryResources(nodeResources);
+          checkMandatoryResources(nodeResources);
