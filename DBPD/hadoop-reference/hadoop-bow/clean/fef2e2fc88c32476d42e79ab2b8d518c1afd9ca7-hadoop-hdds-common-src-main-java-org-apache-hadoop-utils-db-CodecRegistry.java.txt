HDDS-1176. Allow persisting X509CertImpl to SCM certificate table. Contributed by Xiaoyu Yao.

-  public <T> T asObject(byte[] rawData, Class<T> format) throws IOException {
+  public <T> T asObject(byte[] rawData, Class<T> format)
+      throws IOException {
-    if (valueCodecs.containsKey(format)) {
-      return (T) valueCodecs.get(format).fromPersistedFormat(rawData);
-    } else {
-      throw new IllegalStateException(
-          "Codec is not registered for type: " + format);
-    }
+    Codec codec = getCodec(format);
+    return (T) codec.fromPersistedFormat(rawData);
+    Codec<T> codec = getCodec(object);
+    return codec.toPersistedFormat(object);
+  }
+
+  /**
+   * Get codec for the typed object including class and subclass.
+   * @param object typed object.
+   * @return Codec for the typed object.
+   * @throws IOException
+   */
+  private <T> Codec getCodec(T object) throws IOException {
+    return getCodec(format);
+  }
+
+
+  /**
+   * Get codec for the typed object including class and subclass.
+   * @param <T>    Type of the typed object.
+   * @return Codec for the typed object.
+   * @throws IOException
+   */
+  private <T> Codec getCodec(Class<T> format) throws IOException {
+    Codec<T> codec;
-      Codec<T> codec = (Codec<T>) valueCodecs.get(format);
-      return codec.toPersistedFormat(object);
+      codec = (Codec<T>) valueCodecs.get(format);
+    } else if (valueCodecs.containsKey(format.getSuperclass())) {
+      codec = (Codec<T>) valueCodecs.get(format.getSuperclass());
+    return codec;
