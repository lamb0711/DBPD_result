HDFS-4446. Support file snapshots with diff lists.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1443825 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.hadoop.hdfs.server.namenode.snapshot.INodeFileSnapshot;
-import org.apache.hadoop.hdfs.server.namenode.snapshot.INodeFileUnderConstructionSnapshot;
+import org.apache.hadoop.hdfs.server.namenode.snapshot.INodeFileWithSnapshot;
-    if (node instanceof INodeFileSnapshot
-        || node instanceof INodeFileUnderConstructionSnapshot) {
-      out.writeLong(node.computeFileSize(true));
-      if (node instanceof INodeFileUnderConstructionSnapshot) {
-        out.writeBoolean(true);
-        writeString(((INodeFileUnderConstruction) node).getClientName(), out);
-        writeString(((INodeFileUnderConstruction) node).getClientMachine(), out);
-      } else {
-        out.writeBoolean(false);
-      }
+//  TODO: fix snapshot fsimage
+    if (node instanceof INodeFileWithSnapshot) {
+      out.writeLong(node.computeFileSize(true, null));
+      out.writeBoolean(false);
