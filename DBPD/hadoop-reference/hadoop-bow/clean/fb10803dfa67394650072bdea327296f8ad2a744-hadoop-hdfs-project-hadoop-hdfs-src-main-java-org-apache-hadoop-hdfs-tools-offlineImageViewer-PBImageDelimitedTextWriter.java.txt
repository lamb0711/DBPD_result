HDFS-13818. Extend OIV to detect FSImage corruption. Contributed by Adam Antal.

Signed-off-by: Wei-Chiu Chuang <weichiu@apache.org>

-import org.apache.commons.lang3.StringUtils;
-import org.apache.commons.text.StringEscapeUtils;
-  static final String DEFAULT_DELIMITER = "\t";
-  private final String delimiter;
-
-    super(out, tempPath);
-    this.delimiter = delimiter;
+    super(out, delimiter, tempPath);
-  private void append(StringBuffer buffer, int field) {
-    buffer.append(delimiter);
-    buffer.append(field);
-  }
-
-  private void append(StringBuffer buffer, long field) {
-    buffer.append(delimiter);
-    buffer.append(field);
-  }
-
-  static final String CRLF = StringUtils.CR + StringUtils.LF;
-
-  private void append(StringBuffer buffer, String field) {
-    buffer.append(delimiter);
-
-    String escapedField = StringEscapeUtils.escapeCsv(field);
-    if (escapedField.contains(CRLF)) {
-      escapedField = escapedField.replace(CRLF, "%x0D%x0A");
-    } else if (escapedField.contains(StringUtils.LF)) {
-      escapedField = escapedField.replace(StringUtils.LF, "%x0A");
-    }
-
-    buffer.append(escapedField);
-  }
-
+
+  @Override
+  public void afterOutput() {
+    // do nothing
+  }
