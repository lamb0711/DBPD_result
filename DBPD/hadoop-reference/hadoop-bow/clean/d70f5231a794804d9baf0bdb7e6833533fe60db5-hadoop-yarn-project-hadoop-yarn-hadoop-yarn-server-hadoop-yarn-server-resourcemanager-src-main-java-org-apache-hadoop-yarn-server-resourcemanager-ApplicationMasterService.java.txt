YARN-9640. Slow event processing could cause too many attempt unregister events. Contributed by Bibin A Chundatt.

+  private final ConcurrentHashMap<ApplicationAttemptId, Boolean>
+      finishedAttemptCache = new ConcurrentHashMap<>();
-      this.amLivelinessMonitor.receivedPing(applicationAttemptId);
-      this.amsProcessingChain.finishApplicationMaster(
-          applicationAttemptId, request, response);
+      if (finishedAttemptCache.putIfAbsent(applicationAttemptId, true)
+          == null) {
+        this.amsProcessingChain
+            .finishApplicationMaster(applicationAttemptId, request, response);
+      }
+      this.amLivelinessMonitor.receivedPing(applicationAttemptId);
+    finishedAttemptCache.remove(attemptId);
+    responseMap.clear();
+    finishedAttemptCache.clear();
