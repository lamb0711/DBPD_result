HDFS-2731. Add command to bootstrap the Standby Node's name directories from the Active NameNode. Contributed by Todd Lipcon.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1299807 13f79535-47bb-0310-9956-ffa450edef68

-import java.util.Collections;
+import org.apache.hadoop.hdfs.server.protocol.NamespaceInfo;
-  public void format(String clusterId) throws IOException {
+  public void format(NamespaceInfo nsInfo) throws IOException {
+    Preconditions.checkArgument(nsInfo.getLayoutVersion() == 0 ||
+        nsInfo.getLayoutVersion() == HdfsConstants.LAYOUT_VERSION,
+        "Bad layout version: %s", nsInfo.getLayoutVersion());
+    
+    this.setStorageInfo(nsInfo);
+    this.blockpoolID = nsInfo.getBlockPoolID();
+    for (Iterator<StorageDirectory> it =
+                           dirIterator(); it.hasNext();) {
+      StorageDirectory sd = it.next();
+      format(sd);
+    }
+  }
+  
+  public static NamespaceInfo newNamespaceInfo()
+      throws UnknownHostException {
+    return new NamespaceInfo(
+        newNamespaceID(),
+        newClusterID(),
+        newBlockPoolID(),
+        0L, 0);
+  }
+  
+  public void format() throws IOException {
-    this.namespaceID = newNamespaceID();
-    this.clusterID = clusterId;
-    this.blockpoolID = newBlockPoolID();
-    this.cTime = 0L;
-  private int newNamespaceID() {
+  private static int newNamespaceID() {
-  String newBlockPoolID() throws UnknownHostException{
+  static String newBlockPoolID() throws UnknownHostException{
