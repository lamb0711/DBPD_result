HADOOP-15655. Enhance KMS client retry behavior. Contributed by Kitti Nanasi.

-  private <T> T doOp(ProviderCallable<T> op, int currPos)
-      throws IOException {
+  private <T> T doOp(ProviderCallable<T> op, int currPos,
+      boolean isIdempotent) throws IOException {
-          action = retryPolicy.shouldRetry(ioe, 0, numFailovers, false);
+          action = retryPolicy.shouldRetry(ioe, 0, numFailovers, isIdempotent);
-    }, nextIdx());
+    }, nextIdx(), false);
-    }, nextIdx());
+    }, nextIdx(), false);
-    }, nextIdx());
+    }, nextIdx(), false);
-      }, nextIdx());
+      }, nextIdx(), true);
-      }, nextIdx());
+      }, nextIdx(), true);
-      }, nextIdx());
+      }, nextIdx(), true);
-      }, nextIdx());
+      }, nextIdx(), true);
-    }, nextIdx());
+    }, nextIdx(), true);
-    }, nextIdx());
+    }, nextIdx(), true);
-    }, nextIdx());
+    }, nextIdx(), true);
-    }, nextIdx());
+    }, nextIdx(), true);
-    }, nextIdx());
+    }, nextIdx(), true);
+
-    }, nextIdx());
+    }, nextIdx(), true);
-    }, nextIdx());
+    }, nextIdx(), false);
-      }, nextIdx());
+      }, nextIdx(), false);
-    }, nextIdx());
+    }, nextIdx(), false);
-    }, nextIdx());
+    }, nextIdx(), false);
-      }, nextIdx());
+      }, nextIdx(), false);
