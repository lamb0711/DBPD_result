HDFS-10808. DiskBalancer does not execute multi-steps plan-redux. Contributed by Anu Engineer.

-                planFile, planID);
-        try {
-          for (Map.Entry<VolumePair, DiskBalancerWorkItem> entry :
-              workMap.entrySet()) {
-            blockMover.copyBlocks(entry.getKey(), entry.getValue());
-          }
-        } finally {
-          blockMover.setExitFlag();
+            planFile, planID);
+        for (Map.Entry<VolumePair, DiskBalancerWorkItem> entry :
+            workMap.entrySet()) {
+          blockMover.setRunnable();
+          blockMover.copyBlocks(entry.getKey(), entry.getValue());
-        LOG.info("Maximum error count exceeded. Error count: {} Max error:{} "
-            , item.getErrorCount(), item.getMaxDiskErrors());
+        LOG.info("Maximum error count exceeded. Error count: {} Max error:{} ",
+            item.getErrorCount(), item.getMaxDiskErrors());
-              break;
+              this.setExitFlag();
+              continue;
-              break;
+              this.setExitFlag();
+              continue;
-              break;
+              this.setExitFlag();
+              continue;
-              break;
+              continue;
-              break;
+              this.setExitFlag();
+              continue;
