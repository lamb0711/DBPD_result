HDFS-13307. RBF: Improve the use of setQuota command. Contributed by liuhongtong.

-          System.err.println("Cannot parse nsQuota: " + parameters[i]);
+          throw new IllegalArgumentException(
+              "Cannot parse nsQuota: " + parameters[i]);
-          System.err.println("Cannot parse ssQuota: " + parameters[i]);
+          throw new IllegalArgumentException(
+              "Cannot parse ssQuota: " + parameters[i]);
-      System.err.println("Input quota value should be a positive number.");
-      return false;
+      throw new IllegalArgumentException(
+          "Input quota value should be a positive number.");
+    }
+
+    if (nsQuota == HdfsConstants.QUOTA_DONT_SET &&
+        ssQuota == HdfsConstants.QUOTA_DONT_SET) {
+      throw new IllegalArgumentException(
+          "Must specify at least one of -nsQuota and -ssQuota.");
-      return false;
+      throw new IOException(mount + " doesn't exist in mount table.");
-      // If nsQuota or ssQuota was unset, reset corresponding usage
-      // value to zero.
-      if (nsQuota == HdfsConstants.QUOTA_DONT_SET) {
+      // If nsQuota and ssQuota were unset, clear nsQuota and ssQuota.
+      if (nsQuota == HdfsConstants.QUOTA_DONT_SET &&
+          ssQuota == HdfsConstants.QUOTA_DONT_SET) {
-      }
-
-      if (nsQuota == HdfsConstants.QUOTA_DONT_SET) {
+      } else {
+        // If nsQuota or ssQuota was unset, use the value in mount table.
+        if (nsQuota == HdfsConstants.QUOTA_DONT_SET) {
+          nsQuota = existingEntry.getQuota().getQuota();
+        }
+        if (ssQuota == HdfsConstants.QUOTA_DONT_SET) {
+          ssQuota = existingEntry.getQuota().getSpaceQuota();
+        }
