YARN-9038. [CSI] Add ability to publish/unpublish volumes on node managers. Contributed by Weiwei Yang.

+import org.apache.hadoop.yarn.api.protocolrecords.NodePublishVolumeResponse;
+import org.apache.hadoop.yarn.api.protocolrecords.NodeUnpublishVolumeResponse;
+import org.apache.hadoop.yarn.api.protocolrecords.impl.pb.NodePublishVolumeRequestPBImpl;
+import org.apache.hadoop.yarn.api.protocolrecords.impl.pb.NodePublishVolumeResponsePBImpl;
+import org.apache.hadoop.yarn.api.protocolrecords.impl.pb.NodeUnpublishVolumeRequestPBImpl;
+import org.apache.hadoop.yarn.api.protocolrecords.impl.pb.NodeUnpublishVolumeResponsePBImpl;
+
+  @Override
+  public CsiAdaptorProtos.NodePublishVolumeResponse nodePublishVolume(
+      RpcController controller,
+      CsiAdaptorProtos.NodePublishVolumeRequest request)
+      throws ServiceException {
+    try {
+      NodePublishVolumeRequestPBImpl req =
+          new NodePublishVolumeRequestPBImpl(request);
+      NodePublishVolumeResponse response = real.nodePublishVolume(req);
+      return ((NodePublishVolumeResponsePBImpl) response).getProto();
+    } catch (YarnException | IOException e) {
+      throw new ServiceException(e);
+    }
+  }
+
+  @Override
+  public CsiAdaptorProtos.NodeUnpublishVolumeResponse nodeUnpublishVolume(
+      RpcController controller,
+      CsiAdaptorProtos.NodeUnpublishVolumeRequest request)
+      throws ServiceException {
+    try {
+      NodeUnpublishVolumeRequestPBImpl req =
+          new NodeUnpublishVolumeRequestPBImpl(request);
+      NodeUnpublishVolumeResponse response = real.nodeUnpublishVolume(req);
+      return ((NodeUnpublishVolumeResponsePBImpl) response).getProto();
+    } catch (YarnException | IOException e) {
+      throw new ServiceException(e);
+    }
+  }
