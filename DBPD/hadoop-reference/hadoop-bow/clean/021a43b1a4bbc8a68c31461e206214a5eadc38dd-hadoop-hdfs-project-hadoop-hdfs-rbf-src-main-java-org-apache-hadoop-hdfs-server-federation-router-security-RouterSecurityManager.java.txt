HDFS-13972. RBF: Support for Delegation Token (WebHDFS). Contributed by CR Hota.

+import org.apache.hadoop.hdfs.server.federation.router.Router;
+import org.apache.hadoop.security.Credentials;
+import java.net.InetSocketAddress;
+  /**
+   * @param token token to renew
+   * @return new expiryTime of the token
+   * @throws SecretManager.InvalidToken if {@code token} is invalid
+   * @throws IOException on errors
+   */
+  /**
+   * @param token token to cancel
+   * @throws IOException on error
+   */
+   * A utility method for creating credentials.
+   * Used by web hdfs to return url encoded token.
+   */
+  public static Credentials createCredentials(
+      final Router router, final UserGroupInformation ugi,
+      final String renewer) throws IOException {
+    final Token<DelegationTokenIdentifier> token =
+        router.getRpcServer().getDelegationToken(new Text(renewer));
+    if (token == null) {
+      return null;
+    }
+    final InetSocketAddress addr = router.getRpcServerAddress();
+    SecurityUtil.setTokenService(token, addr);
+    final Credentials c = new Credentials();
+    c.addToken(new Text(ugi.getShortUserName()), token);
+    return c;
+  }
+
+  /**
+   * Delegation token verification.
+   * Used by web hdfs to verify url encoded token.
+   */
+  public void verifyToken(DelegationTokenIdentifier identifier,
+      byte[] password) throws SecretManager.InvalidToken {
+    this.dtSecretManager.verifyToken(identifier, password);
+  }
+
+  /**
