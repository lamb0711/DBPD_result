YARN-7072. Add a new log aggregation file format controller. Contributed by Xuan Gong.

+import java.io.PrintStream;
+import java.nio.file.Files;
+import java.nio.file.Paths;
+import org.apache.hadoop.fs.Path;
+
+  /**
+   * Create the container log file under given (local directory/nodeId) and
+   * return the PrintStream object.
+   * @param localDir the Local Dir
+   * @param nodeId the NodeId
+   * @param containerId the ContainerId
+   * @return the printStream object
+   * @throws IOException if an I/O error occurs
+   */
+  public static PrintStream createPrintStream(String localDir, String nodeId,
+      String containerId) throws IOException {
+    PrintStream out = System.out;
+    if(localDir != null && !localDir.isEmpty()) {
+      Path nodePath = new Path(localDir, LogAggregationUtils
+          .getNodeString(nodeId));
+      Files.createDirectories(Paths.get(nodePath.toString()));
+      Path containerLogPath = new Path(nodePath, containerId);
+      out = new PrintStream(containerLogPath.toString(), "UTF-8");
+    }
+    return out;
+  }
