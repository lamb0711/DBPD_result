HDFS-4078. Handle replication in snapshots.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1400743 13f79535-47bb-0310-9956-ffa450edef68

-    short repl = trgInode.getBlockReplication();
+    final short repl = trgInode.getFileReplication();
-      if(repl != srcInode.getBlockReplication()) {
+      if(repl != srcInode.getFileReplication()) {
-            + repl + " vs. " + srcInode.getBlockReplication());
+            + repl + " vs. " + srcInode.getFileReplication());
+    //TODO SNAPSHOT: INodeFileUnderConstruction with link
-                                    file.getBlockReplication(),
+                                    file.getFileReplication(),
-      replication = pendingFile.getBlockReplication();
+      replication = pendingFile.getFileReplication();
-        dir.updateSpaceConsumed(path, 0, -diff * fileINode.getBlockReplication());
+        dir.updateSpaceConsumed(path, 0, -diff*fileINode.getFileReplication());
