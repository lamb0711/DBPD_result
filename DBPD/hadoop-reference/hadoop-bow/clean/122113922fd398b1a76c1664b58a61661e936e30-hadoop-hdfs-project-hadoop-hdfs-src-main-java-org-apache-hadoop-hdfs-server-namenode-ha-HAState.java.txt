Merging trunk to HDFS-1623 branch.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1177117 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.hadoop.hdfs.server.namenode.NameNode;
-  protected final void setStateInternal(final NameNode nn, final HAState s)
+  protected final void setStateInternal(final HAContext context, final HAState s)
-    exitState(nn);
-    nn.setState(s);
-    s.enterState(nn);
+    exitState(context);
+    context.setState(s);
+    s.enterState(context);
-   * @param nn Namenode
+   * @param context HA context
-  protected abstract void enterState(final NameNode nn)
+  public abstract void enterState(final HAContext context)
-   * @param nn Namenode
+   * @param context HA context
-  protected abstract void exitState(final NameNode nn)
+  public abstract void exitState(final HAContext context)
-   * @param nn Namenode
+   * @param context HA context
-  public void setState(NameNode nn, HAState s) throws ServiceFailedException {
+  public void setState(HAContext context, HAState s) throws ServiceFailedException {
-   * @param nn Namenode
+   * @param context HA context
-  public void checkOperation(final NameNode nn, final OperationCategory op)
+  public void checkOperation(final HAContext context, final OperationCategory op)
-        + nn.getState();
+        + context.getState();
