YARN-4304. AM max resource configuration per partition to be displayed/updated correctly in UI and in various partition related metrics. (Sunil G via wangda)

+import java.util.ArrayList;
+
+import org.apache.hadoop.yarn.server.resourcemanager.nodelabels.RMNodeLabelsManager;
+import org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.QueueCapacities;
+import org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.UserInfo;
-    userAMResourceLimit = new ResourceInfo(q.getUserAMResourceLimit());
+    ArrayList<UserInfo> usersList = users.getUsersList();
+    if (usersList.isEmpty()) {
+      // If no users are present, consider AM Limit for that queue.
+      userAMResourceLimit = resources.getPartitionResourceUsageInfo(
+          RMNodeLabelsManager.NO_LABEL).getAMLimit();
+    } else {
+      userAMResourceLimit = usersList.get(0).getResourceUsageInfo()
+          .getPartitionResourceUsageInfo(RMNodeLabelsManager.NO_LABEL)
+          .getAMLimit();
+    }
-    resources = new ResourceUsageInfo(queueResourceUsage);
+    resources = new ResourcesInfo(queueResourceUsage);
+  }
+
+  @Override
+  protected void populateQueueCapacities(QueueCapacities qCapacities) {
+    capacities = new QueueCapacitiesInfo(qCapacities);
