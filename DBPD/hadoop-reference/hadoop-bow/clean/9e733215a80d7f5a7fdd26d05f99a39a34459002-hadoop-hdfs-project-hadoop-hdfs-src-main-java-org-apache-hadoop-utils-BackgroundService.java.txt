HDFS-12327. Ozone: support setting timeout in background service. Contributed by Yiqun Lin.

+import java.util.concurrent.TimeoutException;
-  private static final Logger LOG =
+  @VisibleForTesting
+  public static final Logger LOG =
+  private final long serviceTimeout;
-      TimeUnit unit, int threadPoolSize) {
+      TimeUnit unit, int threadPoolSize, long serviceTimeout) {
+    this.serviceTimeout = serviceTimeout;
-          // TODO timeout in case task hangs
-          BackgroundTaskResult result = taskResultFuture.get();
+          BackgroundTaskResult result = serviceTimeout > 0
+              ? taskResultFuture.get(serviceTimeout, TimeUnit.MILLISECONDS)
+              : taskResultFuture.get();
+        } catch (TimeoutException e) {
+          LOG.warn("Background task executes timed out, "
+              + "retrying in next interval", e);
