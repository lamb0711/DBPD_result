HDFS-8450. Erasure Coding: Consolidate erasure coding zone related implementation into a single class (Contributed by Rakesh R)

-  ECSchema getECSchema(INodesInPath iip) throws IOException {
-    ErasureCodingZone ecZone = getECZone(iip);
+  ECSchema getErasureCodingSchema(INodesInPath iip) throws IOException {
+    ErasureCodingZone ecZone = getErasureCodingZone(iip);
-  ErasureCodingZone getECZone(INodesInPath iip) throws IOException {
+  ErasureCodingZone getErasureCodingZone(INodesInPath iip) throws IOException {
-    Preconditions.checkNotNull(iip);
+    Preconditions.checkNotNull(iip, "INodes cannot be null");
-          ECSchema schema = dir.getFSNamesystem().getECSchemaManager()
-              .getSchema(schemaName);
+          ECSchema schema = dir.getFSNamesystem()
+              .getErasureCodingSchemaManager().getSchema(schemaName);
-  XAttr createErasureCodingZone(String src, ECSchema schema, int cellSize)
-      throws IOException {
+  List<XAttr> createErasureCodingZone(final INodesInPath srcIIP,
+      ECSchema schema, int cellSize) throws IOException {
-    final INodesInPath srcIIP = dir.getINodesInPath4Write(src, false);
+    Preconditions.checkNotNull(srcIIP, "INodes cannot be null");
+    String src = srcIIP.getPath();
-              "non-empty directory.");
+              "non-empty directory " + src);
-    if (srcIIP != null &&
-        srcIIP.getLastINode() != null &&
+    if (srcIIP.getLastINode() != null &&
-          "for a file.");
+          "for a file " + src);
-    if (getECSchema(srcIIP) != null) {
+    if (getErasureCodingSchema(srcIIP) != null) {
-    return ecXAttr;
+    return xattrs;
-    final ErasureCodingZone srcZone = getECZone(srcIIP);
-    final ErasureCodingZone dstZone = getECZone(dstIIP);
+    final ErasureCodingZone srcZone = getErasureCodingZone(srcIIP);
+    final ErasureCodingZone dstZone = getErasureCodingZone(dstIIP);
