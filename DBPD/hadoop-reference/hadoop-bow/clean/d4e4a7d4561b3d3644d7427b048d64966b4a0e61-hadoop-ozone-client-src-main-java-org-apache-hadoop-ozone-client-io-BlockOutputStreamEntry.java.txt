HDDS-1317. KeyOutputStream#write throws ArrayIndexOutOfBoundsException when running RandomWrite MR examples. Contributed by Shashikant Banerjee.

+import com.google.common.annotations.VisibleForTesting;
-  long getTotalSuccessfulFlushedData() throws IOException {
+  long getTotalAckDataLength() {
-      return out.getTotalSuccessfulFlushedData();
+      return out.getTotalAckDataLength();
+  @VisibleForTesting
