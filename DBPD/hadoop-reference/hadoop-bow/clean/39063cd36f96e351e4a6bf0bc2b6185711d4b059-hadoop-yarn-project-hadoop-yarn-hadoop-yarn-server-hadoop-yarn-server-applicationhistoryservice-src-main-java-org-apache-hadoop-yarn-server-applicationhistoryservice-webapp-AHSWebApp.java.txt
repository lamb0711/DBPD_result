YARN-2676. Enhanced Timeline auth-filter to support proxy users. Contributed by Zhijie Shen.

-import org.apache.hadoop.classification.InterfaceAudience.Private;
-import org.apache.hadoop.yarn.server.timeline.security.TimelineDelegationTokenSecretManagerService;
-import com.google.common.annotations.VisibleForTesting;
-
-  private TimelineDelegationTokenSecretManagerService secretManagerService;
-  private static AHSWebApp instance = null;
-
-  public static AHSWebApp getInstance() {
-    if (instance == null) {
-      instance = new AHSWebApp();
-    }
-    return instance;
-  }
-
-  @Private
-  @VisibleForTesting
-  public static void resetInstance() {
-    instance = null;
-  }
-
-  private AHSWebApp() {
-
+  public AHSWebApp(TimelineDataManager timelineDataManager,
+      ApplicationHistoryManager applicationHistoryManager) {
+    this.timelineDataManager = timelineDataManager;
+    this.applicationHistoryManager = applicationHistoryManager;
-  public void setApplicationHistoryManager(
-      ApplicationHistoryManager applicationHistoryManager) {
-    this.applicationHistoryManager = applicationHistoryManager;
-  }
-
-  public TimelineDelegationTokenSecretManagerService
-      getTimelineDelegationTokenSecretManagerService() {
-    return secretManagerService;
-  }
-
-  public void setTimelineDelegationTokenSecretManagerService(
-      TimelineDelegationTokenSecretManagerService secretManagerService) {
-    this.secretManagerService = secretManagerService;
-  }
-
-  public void setTimelineDataManager(TimelineDataManager timelineDataManager) {
-    this.timelineDataManager = timelineDataManager;
-  }
-
-    bind(TimelineDelegationTokenSecretManagerService.class).toInstance(
-        secretManagerService);
