HDDS-1089. Disable OzoneFSStorageStatistics for hadoop versions older than 2.8.
Contributed by Elek, Marton.

-      storageStatistics = (OzoneFSStorageStatistics)
-          GlobalStorageStatistics.INSTANCE
-              .put(OzoneFSStorageStatistics.NAME,
-                  OzoneFSStorageStatistics::new);
+      try {
+        //register only to the GlobalStorageStatistics if the class exists.
+        //This is required to support hadoop versions <2.7
+        Class.forName("org.apache.hadoop.fs.GlobalStorageStatistics");
+        storageStatistics = (OzoneFSStorageStatistics)
+            GlobalStorageStatistics.INSTANCE
+                .put(OzoneFSStorageStatistics.NAME,
+                    OzoneFSStorageStatistics::new);
+      } catch (ClassNotFoundException e) {
+        //we don't support storage statistics for hadoop2.7 and older
+      }
+
-        this.adapter =
-            OzoneClientAdapterFactory.createAdapter(volumeStr, bucketStr,
-                storageStatistics);
+        try {
+          //register only to the GlobalStorageStatistics if the class exists.
+          //This is required to support hadoop versions <2.7
+          Class.forName("org.apache.hadoop.fs.GlobalStorageStatistics");
+          this.adapter =
+              OzoneClientAdapterFactory.createAdapter(volumeStr, bucketStr,
+                  storageStatistics);
+        } catch (ClassNotFoundException e) {
+          this.adapter =
+              OzoneClientAdapterFactory.createAdapter(volumeStr, bucketStr);
+        }
-    storageStatistics.incrementCounter(Statistic.INVOCATION_OPEN, 1);
+    if (storageStatistics != null) {
+      storageStatistics.incrementCounter(Statistic.INVOCATION_OPEN, 1);
+    }
-    storageStatistics.incrementCounter(Statistic.INVOCATION_CREATE, 1);
+    if (storageStatistics != null) {
+      storageStatistics.incrementCounter(Statistic.INVOCATION_CREATE, 1);
+    }
-    storageStatistics.incrementCounter(
-        Statistic.INVOCATION_CREATE_NON_RECURSIVE, 1);
+    if (storageStatistics != null) {
+      storageStatistics.incrementCounter(
+          Statistic.INVOCATION_CREATE_NON_RECURSIVE, 1);
+    }
-    storageStatistics.incrementCounter(Statistic.INVOCATION_RENAME, 1);
+    if (storageStatistics != null) {
+      storageStatistics.incrementCounter(Statistic.INVOCATION_RENAME, 1);
+    }
-    storageStatistics.incrementCounter(Statistic.INVOCATION_DELETE, 1);
+    if (storageStatistics != null) {
+      storageStatistics.incrementCounter(Statistic.INVOCATION_DELETE, 1);
+    }
-    storageStatistics.incrementCounter(Statistic.INVOCATION_LIST_STATUS, 1);
+    if (storageStatistics != null) {
+      storageStatistics.incrementCounter(Statistic.INVOCATION_LIST_STATUS, 1);
+    }
-    storageStatistics.incrementCounter(Statistic.INVOCATION_GET_FILE_STATUS, 1);
+    if (storageStatistics != null) {
+      storageStatistics
+          .incrementCounter(Statistic.INVOCATION_GET_FILE_STATUS, 1);
+    }
