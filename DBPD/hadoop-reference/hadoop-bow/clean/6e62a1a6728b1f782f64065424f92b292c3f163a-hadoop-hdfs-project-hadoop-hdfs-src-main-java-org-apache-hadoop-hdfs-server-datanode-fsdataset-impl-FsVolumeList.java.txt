HDFS-7430. Refactor the BlockScanner to use O(1) memory and use multiple threads (cmccabe)

+import org.apache.hadoop.hdfs.server.datanode.BlockScanner;
+  private final BlockScanner blockScanner;
-  FsVolumeList(int failedVols,
+  FsVolumeList(int failedVols, BlockScanner blockScanner,
+    this.blockScanner = blockScanner;
-   * @param newVolume the instance of new FsVolumeImpl.
+   *
+   * @param ref       a reference to the new FsVolumeImpl instance.
-  void addVolume(FsVolumeImpl newVolume) {
+  void addVolume(FsVolumeReference ref) {
-      volumeList.add(newVolume);
+      volumeList.add((FsVolumeImpl)ref.getVolume());
-                  "retry to remove volume: " + newVolume);
+                  "retry to remove volume: " + ref.getVolume().getStorageID());
-
-    FsDatasetImpl.LOG.info("Added new volume: " + newVolume.toString());
+    if (blockScanner != null) {
+      blockScanner.addVolumeScanner(ref);
+    }
+    FsDatasetImpl.LOG.info("Added new volume: " +
+        ref.getVolume().getStorageID());
+          if (blockScanner != null) {
+            blockScanner.removeVolumeScanner(target);
+          }
