HDFS-7824. GetContentSummary API and its namenode implementation for Storage Type Quota/Usage. (Contributed by Xiaoyu Yao)

-    final Content.Counts counts = summary.getCounts();
+    final ContentCounts counts = summary.getCounts();
+    long fileLen = 0;
-      counts.add(Content.LENGTH, computeFileSize());
-      counts.add(Content.FILE, 1);
+      fileLen = computeFileSize();
+      counts.addContent(Content.FILE, 1);
-      counts.add(Content.FILE, n);
+      counts.addContent(Content.FILE, n);
-        counts.add(Content.LENGTH, diffs.getLast().getFileSize());
+        fileLen =  diffs.getLast().getFileSize();
-        counts.add(Content.LENGTH, computeFileSize());
+        fileLen = computeFileSize();
-    counts.add(Content.DISKSPACE, storagespaceConsumed());
+    counts.addContent(Content.LENGTH, fileLen);
+    counts.addContent(Content.DISKSPACE, storagespaceConsumed());
+
+    if (getStoragePolicyID() != BlockStoragePolicySuite.ID_UNSPECIFIED){
+      BlockStoragePolicy bsp = summary.getBlockStoragePolicySuite().
+          getPolicy(getStoragePolicyID());
+      List<StorageType> storageTypes = bsp.chooseStorageTypes(getFileReplication());
+      for (StorageType t : storageTypes) {
+        if (!t.supportTypeQuota()) {
+          continue;
+        }
+        counts.addTypeSpace(t, fileLen);
+      }
+    }
