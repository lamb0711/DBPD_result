YARN-3100. Made YARN authorization pluggable. Contributed by Jian He.

+import org.apache.hadoop.yarn.security.YarnAuthorizationProvider;
-
+  private YarnAuthorizationProvider authorizer;
+ 
-
+    authorizer = YarnAuthorizationProvider.getInstance(yarnConf);
+    setQueueAcls(authorizer, queues);
+    setQueueAcls(authorizer, queues);
-  
+
+  @VisibleForTesting
+  public static void setQueueAcls(YarnAuthorizationProvider authorizer,
+      Map<String, CSQueue> queues) throws IOException {
+    for (CSQueue queue : queues.values()) {
+      AbstractCSQueue csQueue = (AbstractCSQueue) queue;
+      authorizer.setPermission(csQueue.getPrivilegedEntity(),
+        csQueue.getACLs(), UserGroupInformation.getCurrentUser());
+    }
+  }
+
