HDDS-1393. Convert all OM Bucket related operations to HA model. (#704)



+
-    bucketManager = new BucketManagerImpl(metadataManager, getKmsProvider());
+    bucketManager = new BucketManagerImpl(metadataManager, getKmsProvider(),
+        isRatisEnabled);
+  @Override
+  @Override
+  public OmBucketInfo startCreateBucket(OmBucketInfo omBucketInfo)
+      throws IOException {
+    Preconditions.checkNotNull(omBucketInfo);
+    if(isAclEnabled) {
+      checkAcls(ResourceType.BUCKET, StoreType.OZONE, ACLType.CREATE,
+          omBucketInfo.getVolumeName(), omBucketInfo.getBucketName(), null);
+    }
+
+    return bucketManager.createBucket(omBucketInfo);
+  }
+
+  @Override
+  public void applyCreateBucket(OmBucketInfo omBucketInfo) throws IOException {
+    // TODO: Need to add metrics and Audit log for HA requests
+    bucketManager.applyCreateBucket(omBucketInfo);
+  }
+
+
+  @Override
+  public void startDeleteBucket(String volumeName, String bucketName)
+      throws IOException {
+    // TODO: Need to add metrics and Audit log for HA requests
+    if(isAclEnabled) {
+      checkAcls(ResourceType.BUCKET, StoreType.OZONE, ACLType.CREATE,
+          volumeName, bucketName, null);
+    }
+
+    bucketManager.deleteBucket(volumeName, bucketName);
+  }
+
+
+  @Override
+  public void applyDeleteBucket(String volumeName, String bucketName)
+      throws IOException {
+    // TODO: Need to add metrics and Audit log for HA requests
+    bucketManager.applyDeleteBucket(volumeName, bucketName);
+  }
+
+
+  @Override
+  public OmBucketInfo startSetBucketProperty(OmBucketArgs omBucketArgs)
+      throws IOException {
+    Preconditions.checkNotNull(omBucketArgs);
+    // TODO: Need to add metrics and Audit log for HA requests
+    if(isAclEnabled) {
+      checkAcls(ResourceType.BUCKET, StoreType.OZONE, ACLType.CREATE,
+          omBucketArgs.getVolumeName(), omBucketArgs.getBucketName(), null);
+    }
+    return bucketManager.setBucketProperty(omBucketArgs);
+  }
+
+
+  @Override
+  public void applySetBucketProperty(OmBucketInfo omBucketInfo)
+      throws IOException {
+    // TODO: Need to add metrics and Audit log for HA requests
+    bucketManager.applySetBucketProperty(omBucketInfo);
+  }
+
