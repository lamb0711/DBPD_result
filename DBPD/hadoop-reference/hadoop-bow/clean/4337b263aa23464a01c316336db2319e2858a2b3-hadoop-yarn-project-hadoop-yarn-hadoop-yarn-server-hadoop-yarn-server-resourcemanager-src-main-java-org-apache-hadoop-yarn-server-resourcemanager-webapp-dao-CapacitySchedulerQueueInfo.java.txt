YARN-4162. CapacityScheduler: Add resource usage by partition and queue capacity by partition to REST API. (Naganarasimha G R via wangda)

+  protected QueueCapacitiesInfo capacities;
+  protected ResourceUsageInfo resources;
-  CapacitySchedulerQueueInfo(CSQueue q, String nodeLabel) {
-    QueueCapacities qCapacities = q.getQueueCapacities();
-    ResourceUsage queueResourceUsage = q.getQueueResourceUsage();
+  CapacitySchedulerQueueInfo(CSQueue q) {
-    capacity = qCapacities.getCapacity(nodeLabel) * 100;
-    usedCapacity = qCapacities.getUsedCapacity(nodeLabel) * 100;
+    capacity = q.getCapacity() * 100;
+    usedCapacity = q.getUsedCapacity() * 100;
-    maxCapacity = qCapacities.getMaximumCapacity(nodeLabel);
+    maxCapacity = q.getMaximumCapacity();
-        cap(qCapacities.getAbsoluteCapacity(nodeLabel), 0f, 1f) * 100;
+        cap(q.getAbsoluteCapacity(), 0f, 1f) * 100;
-        cap(qCapacities.getAbsoluteMaximumCapacity(nodeLabel), 0f, 1f) * 100;
+        cap(q.getAbsoluteMaximumCapacity(), 0f, 1f) * 100;
-        cap(qCapacities.getAbsoluteUsedCapacity(nodeLabel), 0f, 1f) * 100;
+        cap(q.getAbsoluteUsedCapacity(), 0f, 1f) * 100;
-    resourcesUsed = new ResourceInfo(queueResourceUsage.getUsed(nodeLabel));
+    resourcesUsed = new ResourceInfo(q.getUsedResources());
+    QueueCapacities qCapacities = q.getQueueCapacities();
+    capacities = new QueueCapacitiesInfo(qCapacities);
+
+    ResourceUsage queueResourceUsage = q.getQueueResourceUsage();
+    populateQueueResourceUsage(queueResourceUsage);
+  }
+
+  protected void populateQueueResourceUsage(ResourceUsage queueResourceUsage) {
+    resources = new ResourceUsageInfo(queueResourceUsage, false);
+
+  public QueueCapacitiesInfo getCapacities() {
+    return capacities;
+  }
+
+  public ResourceUsageInfo getResources() {
+    return resources;
+  }
