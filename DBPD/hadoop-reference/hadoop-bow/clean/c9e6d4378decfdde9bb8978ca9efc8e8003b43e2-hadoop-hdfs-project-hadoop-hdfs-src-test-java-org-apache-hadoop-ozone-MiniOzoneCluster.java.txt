HDFS-11769. Ozone: KSM: Add createVolume API. Contributed by Mukul Kumar Singh.

+import org.apache.hadoop.ozone.ksm.KSMConfigKeys;
+import org.apache.hadoop.ozone.ksm.KeySpaceManager;
-import org.apache.hadoop.scm.protocolPB.StorageContainerLocationProtocolClientSideTranslatorPB;
+import org.apache.hadoop.scm.protocolPB
+    .StorageContainerLocationProtocolClientSideTranslatorPB;
+  private final KeySpaceManager ksm;
-  private MiniOzoneCluster(Builder builder, StorageContainerManager scm)
+  private MiniOzoneCluster(Builder builder, StorageContainerManager scm,
+                           KeySpaceManager ksm)
+    this.ksm = ksm;
-    if (scm == null) {
-      return;
+
+    if (ksm != null) {
+      LOG.info("Shutting down the keySpaceManager");
+      ksm.stop();
+      ksm.join();
-    LOG.info("Shutting down the StorageContainerManager");
-    scm.stop();
-    scm.join();
+
+    if (scm != null) {
+      LOG.info("Shutting down the StorageContainerManager");
+      scm.stop();
+      scm.join();
+    }
+  public KeySpaceManager getKeySpaceManager() {
+    return this.ksm;
+  }
+
+      conf.set(KSMConfigKeys.OZONE_KSM_ADDRESS_KEY, "127.0.0.1:0");
+
+      KeySpaceManager ksm = new KeySpaceManager(conf);
+      ksm.start();
+
-      MiniOzoneCluster cluster = new MiniOzoneCluster(this, scm);
+      MiniOzoneCluster cluster = new MiniOzoneCluster(this, scm, ksm);
