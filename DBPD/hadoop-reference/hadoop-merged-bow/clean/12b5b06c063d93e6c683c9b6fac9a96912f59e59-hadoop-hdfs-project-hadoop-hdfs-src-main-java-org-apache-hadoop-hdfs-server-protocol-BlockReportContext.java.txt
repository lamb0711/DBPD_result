HDFS-7923. The DataNodes should rate-limit their full block reports by asking the NN on heartbeat messages (cmccabe)

+  /**
+   * The total number of RPCs contained in the block report.
+   */
+
+  /**
+   * The index of this particular RPC.
+   */
+
+  /**
+   * A 64-bit ID which identifies the block report as a whole.
+   */
-  public BlockReportContext(int totalRpcs, int curRpc, long reportId) {
+  /**
+   * The lease ID which this block report is using, or 0 if this block report is
+   * bypassing rate-limiting.
+   */
+  private final long leaseId;
+
+  public BlockReportContext(int totalRpcs, int curRpc,
+                            long reportId, long leaseId) {
+    this.leaseId = leaseId;
+
+  public long getLeaseId() {
+    return leaseId;
+  }

INS23 INS31 INS29 INS29 INS29 INS29 INS83 INS83 INS39 INS59 INS44 INS83 INS39 INS42 INS8 INS65 INS65 INS65 INS65 INS42 INS39 INS42 INS21 INS41 INS66 INS66 INS66 INS66 INS66 INS7 INS42 INS22 INS42 INS52 INS42