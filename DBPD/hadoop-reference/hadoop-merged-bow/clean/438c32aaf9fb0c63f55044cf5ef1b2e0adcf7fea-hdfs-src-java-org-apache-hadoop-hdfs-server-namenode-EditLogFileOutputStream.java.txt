HDFS-2149. Move EditLogOp serialization formats into FsEditLogOp implementations. Contributed by Ivan Kelly.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1151238 13f79535-47bb-0310-9956-ffa450edef68

+  private FSEditLogOp.Writer writer;
+    writer = new FSEditLogOp.Writer(bufCurrent);
-  public void write(int b) throws IOException {
-    bufCurrent.write(b);
-  }
-
-  /** {@inheritDoc} */
-  @Override
-  void write(byte op, Writable... writables) throws IOException {
+  void write(FSEditLogOp op) throws IOException {
-    write(op);
-    for (Writable w : writables) {
-      w.write(bufCurrent);
-    }
+    
+    writer.writeOp(op);
+
+  /** {@inheritDoc} */
+  @Override
+  void writeRaw(byte[] bytes, int offset, int length) throws IOException {
+    bufCurrent.write(bytes, offset, length);
+  }
+
+        writer = null;
+      writer = null;
-    write(FSEditLogOpCodes.OP_INVALID.getOpCode()); // insert eof marker
+    bufCurrent.write(FSEditLogOpCodes.OP_INVALID.getOpCode()); // insert eof marker
+    writer = new FSEditLogOp.Writer(bufCurrent);

INS23 INS31 INS83 INS43 INS59 MOV29 MOV78 MOV39 UPD42 MOV42 INS44 MOV44 INS44 MOV43 MOV8 INS40 INS42 INS21 UPD43 UPD42 MOV21 INS5 INS42 UPD42 INS39 INS42 INS21 INS7 UPD42 INS39 INS85 INS7 INS42 INS14 UPD42 UPD42 UPD42 UPD42 INS42 INS42 INS21 INS42 INS42 INS14 INS43 INS42 INS7 INS43 INS42 INS40 INS21 INS42 INS33 INS40 INS7 INS42 INS33 DEL83 DEL31 DEL39 DEL42 DEL44 DEL42 DEL42 DEL32 DEL21 DEL42 DEL43 DEL42 DEL44 DEL42 DEL8 DEL70