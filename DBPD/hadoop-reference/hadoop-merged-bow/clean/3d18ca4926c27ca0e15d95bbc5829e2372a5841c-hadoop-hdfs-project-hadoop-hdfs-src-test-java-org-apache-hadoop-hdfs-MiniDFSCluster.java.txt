HDFS-13459. Ozone: Clean-up of ozone related change from MiniDFSCluste. Contributed by Nandakumar.

-    public Configuration getConf() {
-      return conf;
-    }
-
-    public DataNode getDatanode() {
-      return datanode;
-    }
-
+    Preconditions.checkArgument(nnTopology.countNameNodes() > 0,
+        "empty NN topology: no namenodes specified!");
+
-      setupDatanodeAddress(i, dnConf, setupHostsFile, checkDataNodeAddrConfig);
+      setupDatanodeAddress(dnConf, setupHostsFile, checkDataNodeAddrConfig);
-          addr.getAddress().getHostAddress() + ":" + dnprop.ipcPort);
+          addr.getAddress().getHostAddress() + ":" + dnprop.ipcPort); 
-   * For examples,
-   * <li><base directory>/data/dn0_data0</li>
-   * <li><base directory>/data/dn0_data1</li>
-   * <li><base directory>/data/dn1_data0</li>
-   * <li><base directory>/data/dn1_data1</li>
+   * <li><base directory>/data/data<2*dnIndex + 1></li>
+   * <li><base directory>/data/data<2*dnIndex + 2></li>
-  public static File getStorageDir(int dnIndex, int dirIndex) {
+  public File getStorageDir(int dnIndex, int dirIndex) {
-  private static String getStorageDirPath(int dnIndex, int dirIndex) {
-    return "data/dn" + dnIndex + "_data" + dirIndex;
+  private String getStorageDirPath(int dnIndex, int dirIndex) {
+    return "data/data" + (storagesPerDatanode * dnIndex + 1 + dirIndex);
-  protected void setupDatanodeAddress(
-      int i, Configuration dnConf, boolean setupHostsFile,
-      boolean checkDataNodeAddrConfig) throws IOException {
+  protected void setupDatanodeAddress(Configuration conf, boolean setupHostsFile,
+                           boolean checkDataNodeAddrConfig) throws IOException {
-      String hostsFile = dnConf.get(DFS_HOSTS, "").trim();
+      String hostsFile = conf.get(DFS_HOSTS, "").trim();
-        dnConf.setIfUnset(DFS_DATANODE_ADDRESS_KEY, address);
+        conf.setIfUnset(DFS_DATANODE_ADDRESS_KEY, address);
-        dnConf.set(DFS_DATANODE_ADDRESS_KEY, address);
+        conf.set(DFS_DATANODE_ADDRESS_KEY, address);
-        dnConf.setIfUnset(DFS_DATANODE_ADDRESS_KEY, "127.0.0.1:0");
+        conf.setIfUnset(DFS_DATANODE_ADDRESS_KEY, "127.0.0.1:0");
-        dnConf.set(DFS_DATANODE_ADDRESS_KEY, "127.0.0.1:0");
+        conf.set(DFS_DATANODE_ADDRESS_KEY, "127.0.0.1:0");
-      dnConf.setIfUnset(DFS_DATANODE_HTTP_ADDRESS_KEY, "127.0.0.1:0");
-      dnConf.setIfUnset(DFS_DATANODE_IPC_ADDRESS_KEY, "127.0.0.1:0");
+      conf.setIfUnset(DFS_DATANODE_HTTP_ADDRESS_KEY, "127.0.0.1:0");
+      conf.setIfUnset(DFS_DATANODE_IPC_ADDRESS_KEY, "127.0.0.1:0");
-      dnConf.set(DFS_DATANODE_HTTP_ADDRESS_KEY, "127.0.0.1:0");
-      dnConf.set(DFS_DATANODE_IPC_ADDRESS_KEY, "127.0.0.1:0");
+      conf.set(DFS_DATANODE_HTTP_ADDRESS_KEY, "127.0.0.1:0");
+      conf.set(DFS_DATANODE_IPC_ADDRESS_KEY, "127.0.0.1:0");

INS21 UPD42 INS32 UPD66 UPD66 INS42 INS42 INS27 INS45 UPD45 INS36 INS32 INS34 INS27 INS42 INS42 INS27 MOV42 UPD42 UPD42 UPD42 UPD42 INS27 INS34 INS42 MOV42 UPD42 UPD42 UPD42 UPD42 UPD42 DEL83 DEL42 DEL43 DEL42 DEL42 DEL41 DEL8 DEL31 DEL83 DEL42 DEL43 DEL42 DEL42 DEL41 DEL8 DEL31 DEL42 DEL66 DEL66 DEL66 DEL83 DEL83 DEL45 DEL39 DEL42 DEL44