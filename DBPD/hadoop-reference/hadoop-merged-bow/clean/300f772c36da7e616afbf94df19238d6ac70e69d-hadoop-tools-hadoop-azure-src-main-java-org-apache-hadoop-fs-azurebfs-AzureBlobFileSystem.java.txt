HADOOP-15940. ABFS: For HNS account, avoid unnecessary get call when doing Rename.

Contributed by Da Zhou <da.zhou@microsoft.com>

(cherry picked from commit 1a3a4960d91aa594283e447963fb2e407d4c6af5)

+    Path qualifiedSrcPath = makeQualified(src);
+    Path qualifiedDstPath = makeQualified(dst);
-    final FileStatus dstFileStatus = tryGetFileStatus(dst);
+    // rename under same folder;
+    if(makeQualified(parentFolder).equals(qualifiedDstPath)) {
+      return tryGetFileStatus(qualifiedSrcPath) != null;
+    }
+
+    FileStatus dstFileStatus = null;
+    if (qualifiedSrcPath.equals(qualifiedDstPath)) {
+      // rename to itself
+      // - if it doesn't exist, return false
+      // - if it is file, return true
+      // - if it is dir, return false.
+      dstFileStatus = tryGetFileStatus(qualifiedDstPath);
+      if (dstFileStatus == null) {
+        return false;
+      }
+      return dstFileStatus.isDirectory() ? false : true;
+    }
+
+    // Non-HNS account need to check dst status on driver side.
+    if (!abfsStore.getIsNamespaceEnabled() && dstFileStatus == null) {
+      dstFileStatus = tryGetFileStatus(qualifiedDstPath);
+    }
+
-          return src.equals(dst);
+          return qualifiedSrcPath.equals(qualifiedDstPath);
-
-      Path qualifiedSrcPath = makeQualified(src);
-      Path qualifiedDstPath = makeQualified(adjustedDst);
+      qualifiedDstPath = makeQualified(adjustedDst);

MOV60 INS25 INS60 INS25 INS25 MOV43 INS32 INS8 MOV43 INS59 INS32 INS8 INS27 INS8 UPD42 INS32 INS42 INS42 INS41 INS42 INS33 INS42 INS42 INS42 INS21 INS25 INS41 INS38 INS27 INS21 INS21 UPD42 INS42 INS42 INS27 INS7 INS27 INS8 INS16 INS32 INS42 INS33 INS7 INS7 INS32 INS33 INS42 INS32 INS42 INS33 INS41 INS32 INS9 INS9 INS42 INS42 INS42 INS32 INS42 MOV32 INS42 INS42 INS42 INS42 INS9 INS42 INS42 INS42 INS42 UPD42 UPD42 DEL83 DEL42 DEL59 DEL60