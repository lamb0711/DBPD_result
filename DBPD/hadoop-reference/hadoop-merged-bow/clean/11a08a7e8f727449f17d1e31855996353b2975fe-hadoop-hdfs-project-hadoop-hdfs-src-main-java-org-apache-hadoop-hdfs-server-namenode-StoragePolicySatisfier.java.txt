HDFS-11338: [SPS]: Fix timeout issue in unit tests caused by longger NN down time. Contributed by Wei Zhou and Rakesh R

-   * Stop storage policy satisfier demon thread.
+   * Deactivates storage policy satisfier by stopping its services.
-   * @param reconfigStop
+   * @param reconfig
+   *          true represents deactivating SPS service as requested by admin,
+   *          false otherwise
-  public synchronized void stop(boolean reconfigStop) {
+  public synchronized void deactivate(boolean reconfig) {
+
-    try {
-      storagePolicySatisfierThread.join(3000);
-    } catch (InterruptedException ie) {
-    }
-    this.storageMovementsMonitor.stop();
-    if (reconfigStop) {
+    this.storageMovementsMonitor.deactivate();
+    if (reconfig) {
+   * Timed wait to stop storage policy satisfier daemon threads.
+   */
+  public synchronized void stopGracefully() {
+    if (isRunning) {
+      deactivate(true);
+    }
+    this.storageMovementsMonitor.stopGracefully();
+    if (storagePolicySatisfierThread == null) {
+      return;
+    }
+    try {
+      storagePolicySatisfierThread.join(3000);
+    } catch (InterruptedException ie) {
+    }
+  }
+
+  /**
-        this.storageMovementsMonitor.stop();
+        this.storageMovementsMonitor.stopGracefully();
-          this.storageMovementsMonitor.stop();
+          this.storageMovementsMonitor.stopGracefully();

INS31 UPD42 INS29 INS83 INS83 INS39 INS42 INS8 UPD42 INS65 INS25 INS21 INS25 MOV54 UPD66 UPD42 INS66 INS66 UPD42 INS66 INS42 INS8 INS32 INS27 INS8 UPD42 INS21 INS22 INS42 INS42 INS33 INS41 INS32 INS52 INS42 INS42 INS9 UPD42 UPD42