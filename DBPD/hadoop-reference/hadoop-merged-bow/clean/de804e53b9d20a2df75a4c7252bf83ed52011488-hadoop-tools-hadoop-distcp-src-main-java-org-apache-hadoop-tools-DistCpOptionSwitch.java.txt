HADOOP-15281. Distcp to add no-rename copy option.

Contributed by Andrew Olson.

-          + " strings for paths to be excluded from the copy."));
+          + " strings for paths to be excluded from the copy.")),
+
+  /**
+   * Write directly to the final location, avoiding the creation and rename
+   * of temporary files.
+   * This is typically useful in cases where the target filesystem
+   * implementation does not support atomic rename operations, such as with
+   * the S3AFileSystem which translates file renames to potentially very
+   * expensive copy-then-delete operations.
+   */
+  DIRECT_WRITE(DistCpConstants.CONF_LABEL_DIRECT_WRITE,
+      new Option("direct", false, "Write files directly to the"
+          + " target location, avoiding temporary file rename."));

INS72 INS29 INS42 INS40 INS14 INS65 INS43 INS45 INS9 INS27 INS66 INS66 INS66 INS66 INS66 INS66 INS42 INS45 INS45