HDFS-12106: [SPS]: Improve storage policy satisfier configurations. Contributed by Surendra Singh Lilhore.

-              + " the policy.\nIN_PROGRESS : Satisfying the storage policy for"
-              + " path.\nSUCCESS : Storage policy satisfied for the path.\n"
+              + " the policy.\n"
+              + "IN_PROGRESS : Satisfying the storage policy for"
+              + " path.\n"
+              + "SUCCESS : Storage policy satisfied for the path.\n"
+              + "FAILURE : Few blocks failed to move.\n"
-
-      while (true) {
+      boolean running = true;
+      while (running) {
-        if (StoragePolicySatisfyPathStatus.SUCCESS.equals(status)) {
+        switch (status) {
+        case SUCCESS:
+        case FAILURE:
+        case NOT_AVAILABLE:
+          running = false;
+          break;
+        case PENDING:
+        case IN_PROGRESS:
+          System.out.println(status);
+        default:
+          System.err.println("Unexpected storage policy satisfyer status,"
+              + " Exiting");
+          running = false;
-        System.out.println(status);
+

INS60 INS39 INS59 INS42 INS42 INS9 INS50 INS45 UPD45 INS45 UPD45 INS45 INS42 INS49 INS49 INS49 MOV21 INS21 INS10 INS49 INS49 MOV21 INS49 INS21 INS21 INS10 INS42 INS42 INS42 INS7 INS42 INS42 INS32 INS7 INS42 INS9 UPD40 MOV40 UPD42 MOV42 INS27 INS42 INS9 INS45 INS45 DEL9 DEL42 DEL32 DEL10 DEL8 DEL25