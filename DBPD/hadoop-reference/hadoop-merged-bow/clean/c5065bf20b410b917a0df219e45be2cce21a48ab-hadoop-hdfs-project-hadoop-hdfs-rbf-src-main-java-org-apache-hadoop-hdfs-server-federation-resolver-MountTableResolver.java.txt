HDFS-13845. RBF: The default MountTableResolver should fail resolving multi-destination paths. Contributed by yanghuafeng.

-  private static PathLocation buildLocation(
-      final String path, final MountTable entry) {
-
+  private PathLocation buildLocation(
+      final String path, final MountTable entry) throws IOException {
+
+    List<RemoteLocation> dests = entry.getDestinations();
+    if (getClass() == MountTableResolver.class && dests.size() > 1) {
+      throw new IOException("Cannnot build location, "
+          + getClass().getSimpleName()
+          + " should not resolve multiple destinations for " + path);
+    }
+
-    for (RemoteLocation oneDst : entry.getDestinations()) {
+    for (RemoteLocation oneDst : dests) {

INS43 INS42 INS60 INS25 INS74 INS59 INS27 INS8 INS42 INS43 INS43 INS42 MOV32 INS27 INS27 INS53 INS42 INS42 INS32 INS57 INS32 INS34 INS14 INS42 INS43 INS42 INS42 INS43 INS27 INS42 INS42 INS45 INS32 INS45 INS42 INS32 INS42 INS42 DEL83