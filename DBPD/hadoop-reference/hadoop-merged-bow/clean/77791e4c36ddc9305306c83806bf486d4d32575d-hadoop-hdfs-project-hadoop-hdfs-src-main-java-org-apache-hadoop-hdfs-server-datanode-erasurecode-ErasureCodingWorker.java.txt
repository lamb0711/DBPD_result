HDFS-12044. Mismatch between BlockManager.maxReplicationStreams and ErasureCodingWorker.stripedReconstructionPool pool size causes slow and bursty recovery. (Contributed by Lei (Eddy) Xu)

+import java.util.concurrent.LinkedBlockingQueue;
-        numThreads, 60, "StripedBlockReconstruction-", false);
+        numThreads, 60, new LinkedBlockingQueue<>(),
+        "StripedBlockReconstruction-", false);
+      int xmitsSubmitted = 0;
+        // It may throw IllegalArgumentException from task#stripedReader
+        // constructor.
+          // See HDFS-12044. We increase xmitsInProgress even the task is only
+          // enqueued, so that
+          //   1) NN will not send more tasks than what DN can execute and
+          //   2) DN will not throw away reconstruction tasks, and instead keeps
+          //      an unbounded number of tasks in the executor's task queue.
+          xmitsSubmitted = task.getXmits();
+          getDatanode().incrementXmitsInProcess(xmitsSubmitted);
+        getDatanode().decrementXmitsInProgress(xmitsSubmitted);

INS26 INS40 INS60 INS14 INS39 INS59 INS74 INS42 INS34 INS43 INS21 INS42 INS21 INS21 INS32 INS7 INS32 INS32 INS42 INS42 INS42 INS32 INS32 INS42 INS42 INS42 INS42 INS42 INS42