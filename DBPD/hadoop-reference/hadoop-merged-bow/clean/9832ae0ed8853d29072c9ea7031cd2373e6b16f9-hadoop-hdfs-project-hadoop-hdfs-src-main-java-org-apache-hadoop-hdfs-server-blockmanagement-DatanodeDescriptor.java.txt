HDFS-11482. Add storage type demand to into DFSNetworkTopology#chooseRandom. Contributed by Chen Liang.

+
+  public boolean hasStorageType(StorageType type) {
+    for (DatanodeStorageInfo dnStorage : getStorageInfos()) {
+      if (dnStorage.getStorageType() == type) {
+        return true;
+      }
+    }
+    return false;
+  }

INS31 INS83 INS39 INS42 INS44 INS8 INS43 INS42 INS70 INS41 INS42 INS44 INS32 INS8 INS9 INS43 INS42 INS42 INS25 INS42 INS27 INS8 INS32 INS42 INS41 INS42 INS42 INS9