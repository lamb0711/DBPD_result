HDFS-8055. NullPointerException when topology script is missing. Contributed by Anu Engineer.

-      String rName = dnsToSwitchMapping.resolve(hosts).get(0);
-      if (rName != null)
-        client = new NodeBase(rName + NodeBase.PATH_SEPARATOR_STR + targethost);
+      List<String> resolvedHosts = dnsToSwitchMapping.resolve(hosts);
+      if (resolvedHosts != null && !resolvedHosts.isEmpty()) {
+        String rName = resolvedHosts.get(0);
+        if (rName != null) {
+          client = new NodeBase(rName + NodeBase.PATH_SEPARATOR_STR +
+            targethost);
+        }
+      } else {
+        LOG.error("Node Resolution failed. Please make sure that rack " +
+          "awareness scripts are functional.");
+      }

INS25 INS74 INS27 INS8 INS8 INS43 INS43 UPD42 MOV32 INS27 INS38 INS60 MOV25 INS21 INS42 INS42 INS42 INS33 INS32 MOV43 INS59 INS8 INS32 INS42 INS42 INS42 INS32 MOV21 INS42 INS42 INS27 INS42 INS42 INS34 INS45 INS45 DEL42 DEL34 DEL32