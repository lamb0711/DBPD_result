HDFS-12069. Ozone: Create a general abstraction for metadata store. Contributed by Weiwei Yang.

-import org.apache.hadoop.utils.LevelDBStore;
+import org.apache.hadoop.utils.MetadataStore;
+import org.apache.hadoop.utils.MetadataStoreBuilder;
-  public static Path createMetadata(Path containerPath) throws IOException {
+  public static Path createMetadata(Path containerPath, Configuration conf)
+      throws IOException {
-    LevelDBStore store =
-        new LevelDBStore(metadataPath.resolve(OzoneConsts.CONTAINER_DB)
-            .toFile(), true);
+    MetadataStore store = MetadataStoreBuilder.newBuilder()
+        .setConf(conf)
+        .setCreateIfMissing(true)
+        .setDbFile(metadataPath.resolve(OzoneConsts.CONTAINER_DB).toFile())
+        .build();
-    LevelDBStore db = KeyUtils.getDB(containerData, conf);
+    MetadataStore db = KeyUtils.getDB(containerData, conf);

MOV26 INS26 UPD40 INS40 INS44 INS43 INS42 INS42 UPD43 UPD43 UPD42 INS32 UPD42 INS32 INS42 INS32 INS42 MOV32 INS32 INS42 INS9 INS32 INS42 INS42 INS42 INS42 DEL42 DEL43 DEL9 DEL14