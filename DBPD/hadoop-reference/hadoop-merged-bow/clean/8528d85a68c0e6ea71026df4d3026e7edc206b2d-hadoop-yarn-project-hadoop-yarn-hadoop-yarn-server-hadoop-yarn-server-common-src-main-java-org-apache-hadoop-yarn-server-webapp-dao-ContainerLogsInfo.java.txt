YARN-6099. Improve webservice to list aggregated log files. Contributed by Xuan Gong.

-import com.google.common.annotations.VisibleForTesting;
-import java.util.Map;
-import java.util.Map.Entry;
-import org.apache.hadoop.classification.InterfaceAudience.Private;
+import org.apache.hadoop.yarn.logaggregation.ContainerLogMeta;
+import org.apache.hadoop.yarn.logaggregation.ContainerLogType;
+import org.apache.hadoop.yarn.logaggregation.PerContainerLogFileInfo;
- *   <li>The filename of the container log.</li>
- *   <li>The size of the container log.</li>
+ *   <li>A list of {@link PerContainerLogFileInfo}.</li>
+ *   <li>The container Id.</li>
+ *   <li>The NodeManager Id.</li>
+ *   <li>The logType: could be local or aggregated</li>
-  protected List<ContainerLogInfo> containerLogsInfo;
+  protected List<PerContainerLogFileInfo> containerLogsInfo;
+
+  @XmlElement(name = "logType")
+  protected String logType;
+
+  @XmlElement(name = "containerId")
+  protected String containerId;
+
+  @XmlElement(name = "nodeId")
+  protected String nodeId;
-  public ContainerLogsInfo(Map<String, String> containerLogMeta)
+  public ContainerLogsInfo(ContainerLogMeta logMeta, ContainerLogType logType)
-    this.containerLogsInfo = new ArrayList<ContainerLogInfo>();
-    for (Entry<String, String> meta : containerLogMeta.entrySet()) {
-      ContainerLogInfo info = new ContainerLogInfo(meta.getKey(),
-          meta.getValue());
-      containerLogsInfo.add(info);
-    }
+    this.containerLogsInfo = new ArrayList<PerContainerLogFileInfo>(
+        logMeta.getContainerLogMeta());
+    this.logType = logType.toString();
+    this.containerId = logMeta.getContainerId();
+    this.nodeId = logMeta.getNodeId();
-  public List<ContainerLogInfo> getContainerLogsInfo() {
+  public List<PerContainerLogFileInfo> getContainerLogsInfo() {
-  /**
-   * It includes the log meta-data of a container.
-   *
-   */
-  @Private
-  @VisibleForTesting
-  public static class ContainerLogInfo {
-    private String fileName;
-    private String fileSize;
+  public String getLogType() {
+    return this.logType;
+  }
-    //JAXB needs this
-    public ContainerLogInfo() {}
+  public String getContainerId() {
+    return this.containerId;
+  }
-    public ContainerLogInfo(String fileName, String fileSize) {
-      this.setFileName(fileName);
-      this.setFileSize(fileSize);
-    }
-
-    public String getFileName() {
-      return fileName;
-    }
-
-    public void setFileName(String fileName) {
-      this.fileName = fileName;
-    }
-
-    public String getFileSize() {
-      return fileSize;
-    }
-
-    public void setFileSize(String fileSize) {
-      this.fileSize = fileSize;
-    }
+  public String getNodeId() {
+    return this.nodeId;

MOV26 MOV26 MOV26 UPD40 UPD40 UPD40 INS23 INS23 MOV23 MOV31 MOV31 MOV31 MOV31 UPD74 INS77 INS83 MOV43 INS59 INS77 UPD83 MOV83 MOV43 MOV59 INS77 UPD83 MOV43 UPD42 MOV43 UPD74 MOV43 UPD42 MOV43 UPD42 MOV43 UPD42 INS66 INS65 INS66 UPD66 UPD66 INS66 UPD43 INS42 INS80 INS42 INS42 INS80 UPD42 INS42 INS80 UPD42 UPD43 UPD42 UPD43 UPD42 MOV21 INS21 UPD43 INS41 INS41 INS42 UPD42 INS42 INS45 INS42 INS45 INS42 INS45 UPD42 UPD42 INS7 INS7 INS7 UPD42 INS22 INS22 INS22 INS22 INS32 INS22 INS32 INS22 INS32 INS52 INS42 MOV52 UPD42 MOV42 MOV52 UPD42 MOV42 UPD74 INS32 INS52 INS42 UPD42 MOV42 INS42 INS52 INS42 UPD42 MOV42 INS42 INS52 INS42 INS42 INS42 UPD43 INS42 INS42 UPD42 DEL40 DEL26 DEL52 DEL42 DEL32 DEL52 DEL42 DEL32 DEL83 DEL42 DEL42 DEL43 DEL42 DEL43 DEL74 DEL42 DEL44 DEL42 DEL43 DEL74 DEL42 DEL44 DEL42 DEL42 DEL32 DEL42 DEL43 DEL42 DEL42 DEL43 DEL42 DEL42 DEL32 DEL42 DEL42 DEL32 DEL14 DEL59 DEL60 DEL42 DEL42 DEL42 DEL32 DEL21 DEL8 DEL70 DEL8 DEL31 DEL42 DEL39 DEL42 DEL43 DEL42 DEL44 DEL22 DEL42 DEL7 DEL21 DEL39 DEL42 DEL43 DEL42 DEL44 DEL22 DEL42 DEL7 DEL21 DEL66 DEL65 DEL29 DEL42 DEL78 DEL42 DEL78 DEL83 DEL83 DEL42 DEL23 DEL83 DEL42 DEL8 DEL31 DEL83 DEL42 DEL43 DEL42 DEL42 DEL41 DEL8 DEL31 DEL55