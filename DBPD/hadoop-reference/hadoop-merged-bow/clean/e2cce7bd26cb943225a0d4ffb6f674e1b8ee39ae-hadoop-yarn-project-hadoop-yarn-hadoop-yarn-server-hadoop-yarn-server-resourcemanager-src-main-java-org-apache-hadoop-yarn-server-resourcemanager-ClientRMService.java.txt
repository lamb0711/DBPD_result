YARN-727, MAPREDUCE-5325. ClientRMProtocol.getAllApplications should accept ApplicationType as a parameter. Contributed by Xuan Gong.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1501599 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.Set;
-import org.apache.hadoop.yarn.api.protocolrecords.GetAllApplicationsRequest;
-import org.apache.hadoop.yarn.api.protocolrecords.GetAllApplicationsResponse;
+import org.apache.hadoop.yarn.api.protocolrecords.GetApplicationsRequest;
+import org.apache.hadoop.yarn.api.protocolrecords.GetApplicationsResponse;
-  public GetAllApplicationsResponse getAllApplications(
-      GetAllApplicationsRequest request) throws YarnException {
+  public GetApplicationsResponse getApplications(
+      GetApplicationsRequest request) throws YarnException {
+    Set<String> applicationTypes = request.getApplicationTypes();
+    boolean bypassFilter = applicationTypes.isEmpty();
+      if (!(bypassFilter || applicationTypes.contains(application
+          .getApplicationType()))) {
+        continue;
+      }
-    GetAllApplicationsResponse response = 
-      recordFactory.newRecordInstance(GetAllApplicationsResponse.class);
+    GetApplicationsResponse response =
+      recordFactory.newRecordInstance(GetApplicationsResponse.class);

INS26 INS40 UPD40 UPD40 UPD43 UPD42 UPD42 UPD43 INS60 INS60 UPD42 INS74 INS59 INS39 INS59 UPD43 INS43 INS43 INS42 INS32 INS42 INS32 INS25 UPD42 INS42 INS42 INS42 INS42 INS42 INS42 INS38 INS8 INS36 INS18 UPD43 INS27 UPD42 INS42 INS32 INS42 INS42 INS32 INS42 INS42