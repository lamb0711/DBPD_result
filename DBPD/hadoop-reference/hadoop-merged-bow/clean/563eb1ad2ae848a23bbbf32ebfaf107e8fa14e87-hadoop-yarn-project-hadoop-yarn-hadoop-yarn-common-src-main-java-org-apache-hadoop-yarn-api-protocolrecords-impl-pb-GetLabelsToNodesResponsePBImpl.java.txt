YARN-3583. Support of NodeLabel object instead of plain String in YarnClient side. (Sunil G via wangda)

+import org.apache.hadoop.yarn.api.records.NodeLabel;
+import org.apache.hadoop.yarn.api.records.impl.pb.NodeLabelPBImpl;
-
+import org.apache.hadoop.yarn.proto.YarnProtos.NodeLabelProto;
-  private Map<String, Set<NodeId>> labelsToNodes;
+  private Map<NodeLabel, Set<NodeId>> labelsToNodes;
-    this.labelsToNodes = new HashMap<String, Set<NodeId>>();
+    this.labelsToNodes = new HashMap<NodeLabel, Set<NodeId>>();
-      if(!setNodes.isEmpty()) {
-        this.labelsToNodes.put(c.getNodeLabels(), setNodes);
+      if (!setNodes.isEmpty()) {
+        this.labelsToNodes
+            .put(new NodeLabelPBImpl(c.getNodeLabels()), setNodes);
-              Iterator<Entry<String, Set<NodeId>>> iter =
+              Iterator<Entry<NodeLabel, Set<NodeId>>> iter =
-                Entry<String, Set<NodeId>> now = iter.next();
+                Entry<NodeLabel, Set<NodeId>> now = iter.next();
-                    .setNodeLabels(now.getKey()).addAllNodeId(nodeProtoSet)
+                    .setNodeLabels(convertToProtoFormat(now.getKey()))
+                    .addAllNodeId(nodeProtoSet)
+  private NodeLabelProto convertToProtoFormat(NodeLabel l) {
+    return ((NodeLabelPBImpl)l).getProto();
+  }
+
-  public void setLabelsToNodes(Map<String, Set<NodeId>> map) {
+  public void setLabelsToNodes(Map<NodeLabel, Set<NodeId>> map) {
-  public Map<String, Set<NodeId>> getLabelsToNodes() {
+  public Map<NodeLabel, Set<NodeId>> getLabelsToNodes() {

INS26 INS26 INS26 INS40 INS40 INS40 INS31 UPD74 INS83 INS43 INS42 INS44 INS8 UPD74 MOV74 UPD43 INS42 INS43 INS42 INS41 INS74 UPD43 UPD42 INS42 INS32 MOV43 INS43 MOV74 UPD42 INS36 INS42 INS42 UPD74 INS11 UPD43 INS43 INS42 UPD42 INS42 INS14 INS43 MOV32 INS42 UPD74 UPD74 UPD43 UPD74 UPD42 UPD43 UPD42 INS32 INS42 MOV32 DEL42 DEL43 DEL74