HADOOP-15659. Code changes for bug fix and new tests.
Contributed by Da Zhou.

-    if (result.getStatusCode() > HttpURLConnection.HTTP_BAD_REQUEST) {
+    if (result.getStatusCode() >= HttpURLConnection.HTTP_BAD_REQUEST) {

UPD27