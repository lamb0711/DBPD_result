HDFS-3987. Support webhdfs over HTTPS. Contributed by Haohui Mai.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1543962 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.hdfs.web.SWebHdfsFileSystem;
+import org.apache.hadoop.hdfs.web.WebHdfsFileSystem;
-   * @param conf configuration
-  public static Map<String, Map<String, InetSocketAddress>> getHaNnHttpAddresses(
-      Configuration conf) {
-    return getAddresses(conf, null, DFSConfigKeys.DFS_NAMENODE_HTTP_ADDRESS_KEY);
+  public static Map<String, Map<String, InetSocketAddress>> getHaNnWebHdfsAddresses(
+      Configuration conf, String scheme) {
+    if (WebHdfsFileSystem.SCHEME.equals(scheme)) {
+      return getAddresses(conf, null,
+          DFSConfigKeys.DFS_NAMENODE_HTTP_ADDRESS_KEY);
+    } else if (SWebHdfsFileSystem.SCHEME.equals(scheme)) {
+      return getAddresses(conf, null,
+          DFSConfigKeys.DFS_NAMENODE_HTTPS_ADDRESS_KEY);
+    } else {
+      throw new IllegalArgumentException("Unsupported scheme: " + scheme);
+    }
-  public static InetSocketAddress[] resolve(URI uri, int schemeDefaultPort,
-      Configuration conf) throws IOException {
+  public static InetSocketAddress[] resolveWebHdfsUri(URI uri, Configuration conf)
+      throws IOException {
+    int defaultPort;
+    String scheme = uri.getScheme();
+    if (WebHdfsFileSystem.SCHEME.equals(scheme)) {
+      defaultPort = DFSConfigKeys.DFS_NAMENODE_HTTP_PORT_DEFAULT;
+    } else if (SWebHdfsFileSystem.SCHEME.equals(scheme)) {
+      defaultPort = DFSConfigKeys.DFS_NAMENODE_HTTPS_PORT_DEFAULT;
+    } else {
+      throw new IllegalArgumentException("Unsupported scheme: " + scheme);
+    }
+
-          schemeDefaultPort);
+          defaultPort);
-          .getHaNnHttpAddresses(conf);
+          .getHaNnWebHdfsAddresses(conf, scheme);

INS26 INS26 INS40 INS40 UPD42 INS44 INS8 UPD42 INS43 INS42 INS25 INS60 INS60 INS25 INS42 INS32 MOV8 INS25 INS39 INS59 INS43 INS59 INS32 INS8 INS25 INS40 INS42 INS42 INS32 INS8 INS8 INS42 INS42 INS42 INS32 INS40 INS42 INS42 INS21 INS32 INS8 INS8 INS40 INS42 INS42 INS41 INS53 INS42 INS42 INS7 INS40 INS42 INS42 INS21 INS53 INS32 INS14 INS42 INS40 INS7 INS14 INS42 INS42 INS33 INS40 INS43 INS27 INS42 INS40 INS43 INS27 UPD42 UPD42 INS42 INS42 INS45 INS42 INS42 INS45 INS42 DEL42 DEL66 DEL65 DEL39 DEL42 DEL44