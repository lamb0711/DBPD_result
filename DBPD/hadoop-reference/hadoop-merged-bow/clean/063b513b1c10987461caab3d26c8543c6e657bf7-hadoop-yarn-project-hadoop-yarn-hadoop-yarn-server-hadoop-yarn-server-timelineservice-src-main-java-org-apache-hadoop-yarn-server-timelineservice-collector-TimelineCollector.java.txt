YARN-6357. Implement putEntitiesAsync API in TimelineCollector (Haibo Chen via Varun Saxena)

-      LOG.debug("SUCCESS - TIMELINE V2 PROTOTYPE");
-    TimelineCollectorContext context = getTimelineEntityContext();
+    TimelineWriteResponse response = writeTimelineEntities(entities);
+    flushBufferedTimelineEntities();
+
+    return response;
+  }
+
+  private TimelineWriteResponse writeTimelineEntities(
+      TimelineEntities entities) throws IOException {
+    final TimelineCollectorContext context = getTimelineEntityContext();
-        context.getFlowName(), context.getFlowVersion(), context.getFlowRunId(),
-        context.getAppId(), entities);
+        context.getFlowName(), context.getFlowVersion(),
+        context.getFlowRunId(), context.getAppId(), entities);
+  }
+
+  /**
+   * Flush buffered timeline entities, if any.
+   * @throws IOException if there is any exception encountered while
+   *      flushing buffered entities.
+   */
+  private void flushBufferedTimelineEntities() throws IOException {
+    writer.flush();
+   * @throws IOException if there is any exception encounted while putting
+   *     entities.
-      UserGroupInformation callerUgi) {
-    // TODO implement
+      UserGroupInformation callerUgi) throws IOException {
+
+    writeTimelineEntities(entities);

INS31 INS31 INS8 INS83 INS43 INS42 INS44 INS43 MOV8 MOV60 INS29 INS83 INS39 INS42 INS43 INS8 INS43 MOV25 INS60 INS21 INS41 INS42 INS43 INS42 INS42 INS65 INS65 INS42 INS21 INS65 INS42 INS21 INS43 INS59 INS32 INS42 INS42 INS83 INS66 INS42 INS66 INS66 INS32 INS42 INS66 INS66 INS32 INS42 INS42 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS42 DEL42 DEL42 DEL45 DEL32 DEL21