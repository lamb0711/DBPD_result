HDFS-7824. GetContentSummary API and its namenode implementation for Storage Type Quota/Usage. (Contributed by Xiaoyu Yao)

-    final Content.Counts counts = summary.getCounts();
+    final ContentCounts counts = summary.getCounts();
+    long fileLen = 0;
-      counts.add(Content.LENGTH, computeFileSize());
-      counts.add(Content.FILE, 1);
+      fileLen = computeFileSize();
+      counts.addContent(Content.FILE, 1);
-      counts.add(Content.FILE, n);
+      counts.addContent(Content.FILE, n);
-        counts.add(Content.LENGTH, diffs.getLast().getFileSize());
+        fileLen =  diffs.getLast().getFileSize();
-        counts.add(Content.LENGTH, computeFileSize());
+        fileLen = computeFileSize();
-    counts.add(Content.DISKSPACE, storagespaceConsumed());
+    counts.addContent(Content.LENGTH, fileLen);
+    counts.addContent(Content.DISKSPACE, storagespaceConsumed());
+
+    if (getStoragePolicyID() != BlockStoragePolicySuite.ID_UNSPECIFIED){
+      BlockStoragePolicy bsp = summary.getBlockStoragePolicySuite().
+          getPolicy(getStoragePolicyID());
+      List<StorageType> storageTypes = bsp.chooseStorageTypes(getFileReplication());
+      for (StorageType t : storageTypes) {
+        if (!t.supportTypeQuota()) {
+          continue;
+        }
+        counts.addTypeSpace(t, fileLen);
+      }
+    }

INS60 INS21 INS25 UPD43 INS39 INS59 INS32 INS27 INS8 INS42 INS42 INS34 INS42 INS42 INS40 INS42 UPD42 INS32 INS40 INS60 INS60 INS70 INS7 INS42 INS43 INS59 INS74 INS59 INS44 INS42 INS8 INS42 MOV32 UPD42 UPD42 INS42 INS42 INS32 INS43 INS43 INS42 INS32 INS43 INS42 INS25 INS21 INS7 INS7 INS32 INS42 INS32 INS42 INS42 INS42 INS42 INS32 INS42 INS38 INS8 INS32 INS42 MOV32 INS42 MOV32 INS42 INS42 INS42 INS42 INS32 INS18 INS42 INS42 INS42 INS42 INS42 INS42 DEL40 DEL42 DEL42 DEL40 DEL32 DEL42 DEL42 DEL40 DEL32 DEL42 DEL42 DEL40 DEL32