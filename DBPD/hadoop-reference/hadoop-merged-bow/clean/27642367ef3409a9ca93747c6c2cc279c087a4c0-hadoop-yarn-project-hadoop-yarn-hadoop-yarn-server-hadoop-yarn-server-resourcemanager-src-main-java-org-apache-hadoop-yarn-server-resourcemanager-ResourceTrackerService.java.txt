YARN-9011. Race condition during decommissioning. Contributed by Peter Bacsko

-    if (rmNode != null &&
-        rmNode.getState().equals(NodeState.DECOMMISSIONING)) {
-      return true;
+
+    if (rmNode != null) {
+      NodeState state = rmNode.getState();
+
+      if (state == NodeState.DECOMMISSIONING ||
+          (state == NodeState.RUNNING &&
+          this.nodesListManager.isGracefullyDecommissionableNode(rmNode))) {
+        return true;
+      }
+

INS25 MOV27 INS8 INS60 MOV25 INS43 INS59 INS27 INS42 INS42 MOV32 INS27 INS36 INS42 INS40 INS27 INS27 INS32 INS42 INS40 INS22 INS42 INS42 INS52 INS42 DEL42 DEL40 DEL32 DEL27