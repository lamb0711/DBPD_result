Merge trunk into branch


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-3077@1396918 13f79535-47bb-0310-9956-ffa450edef68

-import java.util.Iterator;
+  private boolean isOracle = false;
-    
+    if(driverClassName.toLowerCase().contains("oracle")) {
+      isOracle = true;
+    }
-    String dropAccess = "DROP TABLE Access";
+    String dropAccess = "DROP TABLE HAccess";
-
+	String dataType = "BIGINT NOT NULL";
+	if(isOracle) {
+	  dataType = "NUMBER(19) NOT NULL";
+	}
-      "Access(url      VARCHAR(100) NOT NULL," +
+      "HAccess(url      VARCHAR(100) NOT NULL," +
-            " time     BIGINT NOT NULL, " +
+            " time     " + dataType + ", " +
-              " pageview     BIGINT NOT NULL, " +
+              " pageview     " + dataType + ", " +
-          "INSERT INTO Access(url, referrer, time)" +
+          "INSERT INTO HAccess(url, referrer, time)" +
-    String countAccessQuery = "SELECT COUNT(*) FROM Access";
+    String countAccessQuery = "SELECT COUNT(*) FROM HAccess";
-    Job job = new Job(conf);
+    Job job = Job.getInstance(conf);
-    DBInputFormat.setInput(job, AccessRecord.class, "Access"
+    DBInputFormat.setInput(job, AccessRecord.class, "HAccess"

INS23 INS83 INS39 INS59 INS42 INS9 INS25 INS60 INS25 INS32 INS8 MOV43 INS59 INS42 INS8 INS43 MOV43 INS59 INS32 INS42 INS45 INS21 UPD45 INS42 INS45 INS21 INS42 UPD45 INS42 INS32 UPD45 INS42 INS42 INS7 INS7 INS27 INS42 INS45 INS27 INS42 INS45 INS42 INS42 INS42 INS42 INS9 INS42 INS45 MOV45 UPD45 MOV45 MOV45 UPD45 MOV45 MOV45 MOV45 UPD45 MOV45 UPD45 DEL40 DEL26 DEL42 DEL43 DEL42 DEL42 DEL14 DEL59