Merge r1476453 through r1477867 from trunk.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1477868 13f79535-47bb-0310-9956-ffa450edef68

+    /** Supported list of Windows access right flags */
+    public static enum AccessRight {
+      ACCESS_READ (0x0001),      // FILE_READ_DATA
+      ACCESS_WRITE (0x0002),     // FILE_WRITE_DATA
+      ACCESS_EXECUTE (0x0020);   // FILE_EXECUTE
+
+      private final int accessRight;
+      AccessRight(int access) {
+        accessRight = access;
+      }
+
+      public int accessRight() {
+        return accessRight;
+      }
+    };
+
+    /** Windows only method used to check if the current process has requested
+     *  access rights on the given path. */
+    private static native boolean access0(String path, int requestedAccess);
+
+    /**
+     * Checks whether the current process has desired access rights on
+     * the given path.
+     * 
+     * Longer term this native function can be substituted with JDK7
+     * function Files#isReadable, isWritable, isExecutable.
+     *
+     * @param path input path
+     * @param desiredAccess ACCESS_READ, ACCESS_WRITE or ACCESS_EXECUTE
+     * @return true if access is allowed
+     * @throws IOException I/O exception on error
+     */
+    public static boolean access(String path, AccessRight desiredAccess)
+        throws IOException {
+      return access0(path, desiredAccess.accessRight());
+    }
+

INS71 INS31 INS31 INS29 INS83 INS83 INS42 INS72 INS72 INS72 INS23 INS31 INS31 INS29 INS83 INS83 INS83 INS39 INS42 INS44 INS44 INS29 INS83 INS83 INS39 INS42 INS44 INS44 INS43 INS8 INS65 INS42 INS34 INS42 INS34 INS42 INS34 INS83 INS83 INS39 INS59 INS42 INS44 INS8 INS83 INS39 INS42 INS8 INS65 INS43 INS42 INS39 INS42 INS65 INS65 INS65 INS65 INS65 INS43 INS42 INS43 INS42 INS42 INS41 INS66 INS42 INS39 INS42 INS21 INS41 INS66 INS66 INS42 INS66 INS66 INS66 INS66 INS42 INS66 INS42 INS66 INS66 INS42 INS66 INS42 INS42 INS32 INS7 INS42 INS42 INS42 INS32 INS42 INS42 INS42 INS42