HADOOP-13188 S3A file-create should throw error rather than overwrite directories. Contributed by Steve Loughran

+    S3AFileStatus status = null;
+    try {
+      // get the status or throw an FNFE
+      status = getFileStatus(f);
-    if (!overwrite && exists(f)) {
-      throw new FileAlreadyExistsException(f + " already exists");
+      // if the thread reaches here, there is something at the path
+      if (status.isDirectory()) {
+        // path references a directory: automatic error
+        throw new FileAlreadyExistsException(f + " is a directory");
+      }
+      if (!overwrite) {
+        // path references a file and overwrite is disabled
+        throw new FileAlreadyExistsException(f + " already exists");
+      }
+      LOG.debug("Overwriting file {}", f);
+    } catch (FileNotFoundException e) {
+      // this means the file is not found
+

INS60 INS54 INS43 INS59 INS8 INS12 INS42 INS42 INS33 INS21 INS25 MOV25 INS21 INS44 INS8 INS7 INS32 INS8 MOV38 INS32 INS43 INS42 INS42 INS32 INS42 INS42 INS53 INS42 INS42 INS45 INS42 INS42 INS42 INS42 INS14 INS43 INS27 INS42 INS42 INS45 DEL42 DEL42 DEL32 DEL27