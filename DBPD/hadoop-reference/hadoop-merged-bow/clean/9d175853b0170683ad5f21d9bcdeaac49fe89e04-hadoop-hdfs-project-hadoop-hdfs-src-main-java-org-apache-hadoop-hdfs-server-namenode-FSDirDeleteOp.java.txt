HDFS-10997. Reduce number of path resolving methods. Contributed by Daryn Sharp.

+import org.apache.hadoop.fs.ParentNotDirectoryException;
+import org.apache.hadoop.hdfs.server.namenode.FSDirectory.DirOp;
+import java.io.FileNotFoundException;
-    final INodesInPath iip = fsd.resolvePathForWrite(pc, src, false);
+    final INodesInPath iip = fsd.resolvePath(pc, src, DirOp.WRITE_LINK);
+   * @throws ParentNotDirectoryException
+   * @throws UnresolvedLinkException
+   * @throws FileNotFoundException
-          throws AccessControlException, UnresolvedLinkException {
+          throws AccessControlException, UnresolvedLinkException,
+          ParentNotDirectoryException {
-      if (fsd.isNonEmptyDirectory(fsd.getINodesInPath4Write(
-              descendant, false))) {
+      INodesInPath subdirIIP = fsd.getINodesInPath(descendant, DirOp.WRITE);
+      if (fsd.isNonEmptyDirectory(subdirIIP)) {

INS26 INS26 INS26 INS40 INS40 INS40 INS43 INS65 INS65 INS65 INS42 INS42 INS42 INS42 INS60 UPD42 INS40 INS43 INS59 INS42 INS42 INS32 UPD42 MOV42 INS42 INS42 INS42 INS40 DEL9 DEL42 DEL42 DEL9 DEL32