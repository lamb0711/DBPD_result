HDFS-4686. Update quota computation for rename and INodeReference.  Contributed by Jing Zhao


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1471647 13f79535-47bb-0310-9956-ffa450edef68

-      int dstSnapshotId = Snapshot.INVALID_ID;
-      if (!isWithName) {
-        dstSnapshotId = in.readInt();
-      }
+      // lastSnapshotId for WithName node, dstSnapshotId for DstReference node
+      int snapshotId = in.readInt();
+      
-        return new INodeReference.WithName(null, withCount, localName);
+          return new INodeReference.WithName(null, withCount, localName,
+              snapshotId);
-            withCount, dstSnapshotId);
-        withCount.setParentReference(ref);
+            withCount, snapshotId);

UPD42 MOV32 INS42 UPD42 DEL40 DEL42 DEL38 DEL42 DEL7 DEL21 DEL8 DEL25 DEL42 DEL42 DEL42 DEL32 DEL21