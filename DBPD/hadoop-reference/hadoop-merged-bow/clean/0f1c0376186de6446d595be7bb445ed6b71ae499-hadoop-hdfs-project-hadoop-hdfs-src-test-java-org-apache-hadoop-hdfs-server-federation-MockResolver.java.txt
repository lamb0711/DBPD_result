HDFS-12620. Backporting HDFS-10467 to branch-2. Contributed by Inigo Goiri.

-    for (String key : this.locations.keySet()) {
+    // We go from the leaves to the root
+    List<String> keys = new ArrayList<>(this.locations.keySet());
+    Collections.sort(keys, Collections.reverseOrder());
+    for (String key : keys) {

INS60 INS21 INS74 INS59 INS32 INS42 INS43 INS43 INS42 INS14 INS42 INS42 INS42 INS32 INS42 INS42 INS74 MOV32 INS42 INS42 INS43 INS42