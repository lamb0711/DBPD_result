HDFS-13008. Ozone: Add DN container open/close state to container report. Contributed by  Xiaoyu Yao.

-  private boolean open;
+  private Long containerID;
+  private OzoneProtos.LifeCycleState state;
-  public ContainerData(String containerName, Configuration conf) {
+  public ContainerData(String containerName, Long containerID,
+      Configuration conf) {
-    this.open = true;
-
+    this.containerID = containerID;
+    this.state = OzoneProtos.LifeCycleState.OPEN;
-    ContainerData data = new ContainerData(protoData.getName(), conf);
+    ContainerData data = new ContainerData(protoData.getName(),
+        protoData.getContainerID(), conf);
-    if (protoData.hasOpen()) {
-      data.setOpen(protoData.getOpen());
-    } else {
-      data.setOpen(true);
+    if (protoData.hasState()) {
+      data.setState(protoData.getState());
+    builder.setContainerID(this.getContainerID());
-    builder.setOpen(this.isOpen());
+    builder.setState(this.getState());
+    if (this.getKeyCount() >= 0) {
+      builder.setKeyCount(this.getKeyCount());
+    }
+
+   * Get container ID.
+   * @return - container ID.
+   */
+  public synchronized Long getContainerID() {
+    return containerID;
+  }
+
+  public synchronized  void setState(OzoneProtos.LifeCycleState state) {
+    this.state = state;
+  }
+
+  public synchronized OzoneProtos.LifeCycleState getState() {
+    return this.state;
+  }
+
+  /**
-    return open;
+    return OzoneProtos.LifeCycleState.OPEN == state;
-    setOpen(false);
+    // TODO: closed or closing here
+    setState(OzoneProtos.LifeCycleState.CLOSED);
-  /**
-   * Sets the open or closed values.
-   * @param open
-   */
-  public synchronized void setOpen(boolean open) {
-    this.open = open;
-  }
-

MOV23 MOV31 INS23 INS31 INS31 INS43 INS83 INS43 INS59 INS44 MOV21 INS29 INS43 INS42 UPD42 INS83 INS83 INS43 INS42 INS8 MOV29 INS83 INS83 INS39 INS42 INS8 INS42 UPD42 INS40 INS42 INS43 INS42 INS21 INS21 INS25 INS65 INS65 INS42 INS43 UPD42 INS40 INS41 INS41 INS42 INS7 INS32 INS27 INS8 INS66 INS66 UPD42 INS40 INS22 INS27 INS42 INS22 INS40 UPD42 INS42 INS42 INS32 UPD42 INS32 INS34 INS21 UPD42 INS52 INS42 INS40 INS42 UPD42 INS40 UPD42 INS52 INS42 INS32 INS52 INS42 UPD42 INS52 INS42 INS32 UPD42 INS42 INS42 UPD42 INS42 INS42 INS32 UPD42 INS52 INS42 DEL39 DEL9 DEL42 DEL42 DEL9 DEL32 DEL21 DEL8 DEL39 DEL42 DEL66 DEL65 DEL42 DEL65 DEL29 DEL39 DEL9