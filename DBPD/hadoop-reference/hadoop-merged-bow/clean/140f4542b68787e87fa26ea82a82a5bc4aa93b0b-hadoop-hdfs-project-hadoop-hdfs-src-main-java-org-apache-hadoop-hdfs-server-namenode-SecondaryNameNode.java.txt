HDFS-6278. Create HTML5-based UI for SNN. Contributed by Haohui Mai.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1589613 13f79535-47bb-0310-9956-ffa450edef68

-import java.util.Collection;
-import java.util.Date;
-import java.util.Iterator;
-import java.util.List;
+import java.util.*;
+import com.google.common.collect.Lists;
+import org.apache.hadoop.metrics2.util.MBeans;
+import org.apache.hadoop.util.VersionInfo;
+
+import javax.management.ObjectName;
-public class SecondaryNameNode implements Runnable {
+public class SecondaryNameNode implements Runnable,
+        SecondaryNameNodeInfoMXBean {
-
+  private ObjectName nameNodeStatusBeanName;
-  @VisibleForTesting
-  List<URI> getCheckpointDirs() {
-    return ImmutableList.copyOf(checkpointDirs);
-  }
-  
+    nameNodeStatusBeanName = MBeans.register("SecondaryNameNode",
+            "SecondaryNameNodeInfo", this);
+
+    if (nameNodeStatusBeanName != null) {
+      MBeans.unregister(nameNodeStatusBeanName);
+      nameNodeStatusBeanName = null;
+    }
+  @Override // SecondaryNameNodeInfoMXXBean
+  public String getHostAndPort() {
+    return NetUtils.getHostPortString(nameNodeAddr);
+  }
+
+  @Override // SecondaryNameNodeInfoMXXBean
+  public long getStartTime() {
+    return starttime;
+  }
+
+  @Override // SecondaryNameNodeInfoMXXBean
+  public long getLastCheckpointTime() {
+    return lastCheckpointTime;
+  }
+
+  @Override // SecondaryNameNodeInfoMXXBean
+  public String[] getCheckpointDirectories() {
+    ArrayList<String> r = Lists.newArrayListWithCapacity(checkpointDirs.size());
+    for (URI d : checkpointDirs) {
+      r.add(d.toString());
+    }
+    return r.toArray(new String[r.size()]);
+  }
+
+  @Override // SecondaryNameNodeInfoMXXBean
+  public String[] getCheckpointEditlogDirectories() {
+    ArrayList<String> r = Lists.newArrayListWithCapacity(checkpointEditsDirs.size());
+    for (URI d : checkpointEditsDirs) {
+      r.add(d.toString());
+    }
+    return r.toArray(new String[r.size()]);
+  }
+
+  @Override // VersionInfoMXBean
+  public String getCompileInfo() {
+    return VersionInfo.getDate() + " by " + VersionInfo.getUser() +
+            " from " + VersionInfo.getBranch();
+  }
+
+  @Override // VersionInfoMXBean
+  public String getSoftwareVersion() {
+    return VersionInfo.getVersion();
+  }
+

MOV26 MOV26 MOV26 INS26 UPD40 INS40 UPD40 UPD40 UPD40 INS43 INS23 INS31 INS31 INS31 INS31 INS31 INS31 INS31 INS42 INS83 INS43 INS59 MOV78 INS83 INS43 INS42 INS8 INS78 INS83 INS39 INS42 INS8 INS78 INS83 INS39 INS42 INS8 INS78 INS83 INS5 INS42 INS8 INS78 INS83 INS5 INS42 MOV8 INS78 INS83 INS43 INS42 INS8 INS78 INS83 INS43 INS42 INS8 INS42 INS42 INS21 INS25 UPD42 INS42 INS41 INS42 INS41 INS42 INS41 INS42 INS43 INS85 INS60 INS70 INS41 INS42 INS43 INS85 INS60 INS70 INS42 INS42 INS41 INS42 INS42 INS41 INS7 INS27 INS8 INS32 INS42 INS42 INS42 INS74 INS59 INS44 INS42 INS8 INS32 INS42 INS74 INS59 INS44 INS42 INS8 INS27 INS32 INS42 INS32 INS42 INS33 INS21 INS21 INS42 INS42 INS42 UPD43 MOV43 INS43 INS42 INS32 MOV43 INS42 INS21 INS42 INS42 INS3 INS43 INS43 INS42 INS32 INS43 INS42 INS21 UPD42 UPD42 INS3 INS32 INS45 INS32 INS45 INS32 INS42 INS42 INS42 INS42 INS45 INS45 INS52 INS32 INS7 UPD42 INS42 INS42 INS42 INS32 INS32 INS5 INS32 INS42 INS42 INS42 INS42 INS32 INS42 INS32 INS5 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS33 INS42 INS42 INS42 INS42 INS32 INS43 INS85 INS42 INS42 INS42 INS42 INS42 INS42 INS32 INS43 INS85 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 DEL74 DEL42 DEL31 DEL42