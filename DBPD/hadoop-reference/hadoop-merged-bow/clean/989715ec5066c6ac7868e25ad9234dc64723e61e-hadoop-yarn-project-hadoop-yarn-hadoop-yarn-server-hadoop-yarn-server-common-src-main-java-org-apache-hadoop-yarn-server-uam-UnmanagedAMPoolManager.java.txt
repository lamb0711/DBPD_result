YARN-8893. [AMRMProxy] Fix thread leak in AMRMClientRelayer and UAM client. Contributed by Botong Huang.

+   * Shutdown an UAM client without killing it in YarnRM.
+   *
+   * @param uamId uam Id
+   * @throws YarnException if fails
+   */
+  public void shutDownConnections(String uamId)
+      throws YarnException {
+    if (!this.unmanagedAppMasterMap.containsKey(uamId)) {
+      throw new YarnException("UAM " + uamId + " does not exist");
+    }
+    LOG.info(
+        "Shutting down UAM id {} for application {} without killing the UAM",
+        uamId, this.appIdMap.get(uamId));
+    this.unmanagedAppMasterMap.remove(uamId).shutDownConnections();
+  }
+
+  /**
+   * Shutdown all UAM clients without killing them in YarnRM.
+   *
+   * @throws YarnException if fails
+   */
+  public void shutDownConnections() throws YarnException {
+    for (String uamId : this.unmanagedAppMasterMap.keySet()) {
+      shutDownConnections(uamId);
+    }
+  }
+
+  /**

INS31 INS31 INS29 INS83 INS39 INS42 INS44 INS43 INS8 INS29 INS83 INS39 INS42 INS43 INS8 INS65 INS65 INS65 INS43 INS42 INS42 INS25 INS21 INS21 INS65 INS65 INS42 INS70 INS66 INS42 INS66 INS42 INS66 INS42 INS38 INS8 INS32 INS32 INS66 INS42 INS66 INS44 INS32 INS8 INS32 INS53 INS42 INS42 INS45 INS42 INS32 INS32 INS42 INS43 INS42 INS22 INS42 INS21 INS22 INS42 INS42 INS14 INS22 INS42 INS42 INS22 INS42 INS42 INS42 INS52 INS42 INS32 INS52 INS42 INS43 INS27 INS52 INS42 INS52 INS42 INS42 INS42 INS42 INS45 INS42 INS45