HDFS-11068: [SPS]: Provide unique trackID to track the block movement sends to coordinator. Contributed by Rakesh R

+import org.apache.hadoop.hdfs.server.namenode.BlockStorageMovementInfosBatch;
-import org.apache.hadoop.hdfs.server.protocol.BlockReportContext;
-  /** A queue of blocks for moving its storage placements by this datanode. */
-  private final Queue<List<BlockMovingInfo>> storageMovementBlocks =
+  /**
+   * A queue of blocks corresponding to trackID for moving its storage
+   * placements by this datanode.
+   */
+  private final Queue<BlockStorageMovementInfosBatch> storageMovementBlocks =
+   * @param trackID
+   *          - unique identifier which will be used for tracking the given set
+   *          of blocks movement completion.
-  public void addBlocksToMoveStorage(
+  public void addBlocksToMoveStorage(long trackID,
-    storageMovementBlocks.offer(storageMismatchedBlocks);
+    synchronized (storageMovementBlocks) {
+      storageMovementBlocks.offer(
+          new BlockStorageMovementInfosBatch(trackID, storageMismatchedBlocks));
+    }
-   * @return block infos which needs to move its storage locations.
+   * @return block infos which needs to move its storage locations. This returns
+   *         list of blocks under one trackId.
-  public List<BlockMovingInfo> getBlocksToMoveStorages() {
-    return storageMovementBlocks.poll();
+  public BlockStorageMovementInfosBatch getBlocksToMoveStorages() {
+    synchronized (storageMovementBlocks) {
+      // TODO: Presently returning the list of blocks under one trackId.
+      // Need to limit the list of items into small batches with in trackId
+      // itself if blocks are many(For example: a file contains many blocks).
+      return storageMovementBlocks.poll();
+    }

MOV26 UPD40 UPD74 INS44 INS8 INS43 INS42 INS8 UPD43 MOV43 INS65 INS39 INS42 INS51 UPD42 MOV42 INS51 UPD66 INS66 UPD42 INS42 INS66 INS66 INS42 INS8 UPD66 INS66 INS42 MOV8 MOV21 INS14 INS43 INS42 INS42 INS42 DEL42 DEL43 DEL74 DEL42 DEL8 DEL43 DEL42 DEL43 DEL74 DEL42