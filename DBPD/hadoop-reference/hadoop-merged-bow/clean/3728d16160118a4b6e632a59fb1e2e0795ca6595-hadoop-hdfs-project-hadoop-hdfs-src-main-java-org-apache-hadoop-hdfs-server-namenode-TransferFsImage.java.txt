HDFS-3574. Fix small race and do some cleanup in GetImageServlet. Contributed by Todd Lipcon.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1356939 13f79535-47bb-0310-9956-ffa450edef68

+import javax.servlet.ServletOutputStream;
+import javax.servlet.ServletResponse;
-  static void getFileServer(OutputStream outstream, File localfile,
+  public static void getFileServer(ServletResponse response, File localfile,
+      FileInputStream infile,
-    FileInputStream infile = null;
+    ServletOutputStream out = null;
-      infile = new FileInputStream(localfile);
-      
+      out = response.getOutputStream();
-        outstream.write(buf, 0, num);
+        out.write(buf, 0, num);
-      if (infile != null) {
-        infile.close();
+      if (out != null) {
+        out.close();

INS26 INS26 INS40 INS40 INS83 INS44 UPD43 UPD42 MOV43 INS42 UPD42 INS43 MOV21 INS42 UPD42 UPD42 INS32 UPD42 INS42 INS42 UPD42 UPD42 DEL42 DEL43 DEL42 DEL14