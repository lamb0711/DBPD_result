HADOOP-16581. Revise ValueQueue to correctly replenish queues that go below the watermark (#1463)

In the existing implementation, the ValueQueue::getAtMost() method will only trigger a refill on a key queue if it has gone empty, instead of triggering a refill when it has gone below the watermark. Revise the test suite to correctly verify this behavior.
-          // Asynch task to fill > lowWatermark
-          if (i <= (int) (lowWatermark * numValues)) {
-            submitRefillTask(keyName, keyQueue);
-          }
-          return ekvs;
+
+          break;
+        } else {
+          ekvs.add(val);
-        ekvs.add(val);
+      }
+      // Schedule a refill task in case queue has gone below the watermark
+      if (keyQueue.size() < (int) (lowWatermark * numValues)) {
+        submitRefillTask(keyName, keyQueue);

MOV8 MOV60 MOV60 INS54 MOV41 MOV8 MOV12 INS24 MOV25 MOV58 MOV27 MOV37 INS8 UPD27 MOV21 MOV60 MOV21 MOV25 INS32 INS8 INS42 INS42 INS10 MOV21 DEL42 DEL41 DEL42 DEL24 DEL54 DEL8