HDFS-13958. Miscellaneous Improvements for FsVolumeSpi. Contributed by BELUGA BEHR.

+import static org.apache.hadoop.hdfs.DFSConfigKeys.DFS_PROVIDED_ALIASMAP_LOAD_RETRIES;
+
+import java.util.Collection;
-import java.util.LinkedList;
-import java.util.Set;
+import java.util.Set;
+import org.apache.hadoop.hdfs.server.common.HdfsServerConstants.ReplicaState;
-import org.apache.hadoop.hdfs.server.common.HdfsServerConstants.ReplicaState;
+import org.apache.hadoop.hdfs.server.datanode.DirectoryScanner.ReportCompiler;
+import org.apache.hadoop.hdfs.server.datanode.FileIoProvider;
+import org.apache.hadoop.hdfs.server.datanode.ReplicaBuilder;
-import org.apache.hadoop.hdfs.server.datanode.DirectoryScanner.ReportCompiler;
-import org.apache.hadoop.hdfs.server.datanode.FileIoProvider;
-import org.apache.hadoop.hdfs.server.datanode.ReplicaBuilder;
-import org.apache.hadoop.util.Timer;
-import org.apache.hadoop.util.DiskChecker.DiskErrorException;
+import org.apache.hadoop.util.DiskChecker.DiskErrorException;
+import org.apache.hadoop.util.ReflectionUtils;
+import org.apache.hadoop.util.Time;
+import org.apache.hadoop.util.Timer;
-import org.apache.hadoop.util.ReflectionUtils;
-import org.apache.hadoop.util.Time;
-
-import static org.apache.hadoop.hdfs.DFSConfigKeys.DFS_PROVIDED_ALIASMAP_LOAD_RETRIES;
-
-    public void compileReport(LinkedList<ScanInfo> report,
+    public void compileReport(Collection<ScanInfo> report,
-            throws IOException, InterruptedException {
+        throws IOException, InterruptedException {
-        report.add(new ScanInfo(region.getBlock().getBlockId(),
-            providedVolume, region,
-            region.getProvidedStorageLocation().getLength()));
+        report.add(new ScanInfo(region.getBlock().getBlockId(), providedVolume,
+            region, region.getProvidedStorageLocation().getLength()));
-    long numBlocks = 0;
+    long numBlocks = 0L;
-      lastBlockId = -1;
+      lastBlockId = -1L;
-    for(ProvidedBlockPoolSlice s : bpSlices.values()) {
+    for (ProvidedBlockPoolSlice s : bpSlices.values()) {
-  public LinkedList<ScanInfo> compileReport(String bpid,
-      LinkedList<ScanInfo> report, ReportCompiler reportCompiler)
-      throws InterruptedException, IOException {
-    LOG.info("Compiling report for volume: " + this + " bpid " + bpid);
-    if(bpSlices.containsKey(bpid)) {
+  public void compileReport(String bpid, Collection<ScanInfo> report,
+      ReportCompiler reportCompiler) throws InterruptedException, IOException {
+    LOG.info("Compiling report for volume: {}; bpid: {}", this, bpid);
+    if (bpSlices.containsKey(bpid)) {
-    return report;

MOV26 MOV26 MOV26 MOV26 MOV26 MOV26 MOV26 MOV26 MOV26 MOV26 MOV26 UPD40 INS39 UPD74 UPD74 UPD43 UPD43 UPD34 UPD42 INS45 INS52 INS42 UPD42 UPD34 DEL42 DEL43 DEL42 DEL43 DEL74 DEL45 DEL52 DEL45 DEL42 DEL27 DEL42 DEL41