HADOOP-15426 Make S3guard client resilient to DDB throttle events and network failures (Contributed by Steve Loughran)

+   * This increments both the instrumentation and storage statistics.
+   * This increments both the instrumentation and storage statistics.
-    instrumentation.incrementCounter(stat, 1);
-    storageStatistics.incrementCounter(stat, 1);
+    incrementStatistic(stat);
+   * Always increments the {@link Statistic#S3GUARD_METADATASTORE_RETRY}
+   * statistic/counter;
+   * if it is a throttling exception will update the associated
+   * throttled metrics/statistics.
+   *
+    incrementStatistic(S3GUARD_METADATASTORE_RETRY);
+    if (isThrottleException(ex)) {
+      incrementStatistic(S3GUARD_METADATASTORE_THROTTLED);
+      instrumentation.addValueToQuantiles(S3GUARD_METADATASTORE_THROTTLE_RATE, 1);
+    }

INS8 MOV21 INS21 INS25 INS66 INS66 INS66 INS65 INS66 INS66 INS66 INS32 INS32 INS8 UPD42 INS67 INS42 INS42 INS42 INS42 INS21 INS21 INS42 INS42 INS32 INS32 INS42 INS42 INS42 INS42 INS42 INS34 DEL42 DEL34 DEL42 DEL42 DEL42 DEL34 DEL32 DEL21 DEL8