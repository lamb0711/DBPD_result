HADOOP-16433. S3Guard: Filter expired entries and tombstones when listing with MetadataStore.listChildren().

Contributed by Gabor Bota.

This pulls the tracking of the lastUpdated timestamp of metadata entries up from the DDB metastore into all s3guard stores, and then uses this to filter out expired tombstones from listings.

Change-Id: I80f121236b49c75a024116f65a3ef29d3580b462

+      final PathMetadata pathMetadata = new PathMetadata(s);
+
-          S3Guard.putWithTtl(ms, new PathMetadata(s), timeProvider, null);
+          S3Guard.putWithTtl(ms, pathMetadata, timeProvider, null);
-      boolean updated = dirMeta.put(s);
+      boolean updated = dirMeta.put(pathMetadata);

INS60 INS83 INS43 INS59 INS42 INS42 MOV14 UPD42 INS42