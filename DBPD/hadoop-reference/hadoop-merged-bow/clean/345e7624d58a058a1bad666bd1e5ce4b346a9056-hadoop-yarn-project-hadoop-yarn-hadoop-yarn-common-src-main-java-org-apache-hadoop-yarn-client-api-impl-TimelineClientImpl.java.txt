YARN-8073 TimelineClientImpl doesn't honor yarn.timeline-service.versions configuration. Contributed by Rohith Sharma K S

-  private float timelineServiceVersion;
+  private boolean timelineServiceV15Enabled;
-    timelineServiceVersion =
-        conf.getFloat(YarnConfiguration.TIMELINE_SERVICE_VERSION,
-            YarnConfiguration.DEFAULT_TIMELINE_SERVICE_VERSION);
-    LOG.info("Timeline service address: " + getTimelineServiceAddress());
+
+    timelineServiceV15Enabled =
+        YarnConfiguration.timelineServiceV15Enabled(conf);
+
+    LOG.info("Timeline service address: " + getTimelineServiceAddress());
-    if (Float.compare(this.timelineServiceVersion, 1.5f) == 0) {
+    if (timelineServiceV15Enabled) {
-    if (Float.compare(this.timelineServiceVersion, 1.5f) != 0) {
+    if (!timelineServiceV15Enabled) {
-        "This API is not supported under current Timeline Service Version: "
-            + timelineServiceVersion);
+        "This API is not supported under current Timeline Service Version:");
-    if (Float.compare(this.timelineServiceVersion, 1.5f) != 0) {
+    if (!timelineServiceV15Enabled) {
-        "This API is not supported under current Timeline Service Version: "
-            + timelineServiceVersion);
+        "This API is not supported under current Timeline Service Version:");

UPD39 MOV21 MOV21 UPD42 INS42 INS38 INS38 UPD42 INS42 INS42 UPD42 UPD42 INS42 INS45 INS45 DEL40 DEL40 DEL42 DEL42 DEL52 DEL42 DEL22 DEL34 DEL32 DEL34 DEL27 DEL42 DEL42 DEL52 DEL42 DEL22 DEL34 DEL32 DEL34 DEL27 DEL45 DEL42 DEL27 DEL42 DEL42 DEL52 DEL42 DEL22 DEL34 DEL32 DEL34 DEL27 DEL45 DEL42 DEL27