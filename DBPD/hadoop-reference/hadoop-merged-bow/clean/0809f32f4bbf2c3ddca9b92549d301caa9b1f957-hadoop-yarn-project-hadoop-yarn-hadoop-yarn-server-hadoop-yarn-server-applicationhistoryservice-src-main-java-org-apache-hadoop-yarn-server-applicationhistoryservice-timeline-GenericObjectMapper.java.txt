Merge r1569890 through r1571508 from trunk.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-5535@1571509 13f79535-47bb-0310-9956-ffa450edef68

-package org.apache.hadoop.yarn.server.applicationhistoryservice.apptimeline;
-
-import org.apache.hadoop.classification.InterfaceAudience;
-import org.apache.hadoop.classification.InterfaceStability;
-import org.apache.hadoop.io.WritableUtils;
-import org.codehaus.jackson.map.ObjectMapper;
+package org.apache.hadoop.yarn.server.applicationhistoryservice.timeline;
-import java.util.Map.Entry;
+
+import org.apache.hadoop.classification.InterfaceAudience;
+import org.apache.hadoop.classification.InterfaceStability;
+import org.apache.hadoop.io.WritableUtils;
+import org.codehaus.jackson.map.ObjectMapper;
- * {@link LeveldbApplicationTimelineStore} to store and retrieve arbitrary
+ * {@link LeveldbTimelineStore} to store and retrieve arbitrary
-    if (b == null || b.length == 0)
+    return read(b, 0);
+  }
+
+  /**
+   * Deserializes an Object from a byte array at a specified offset, assuming
+   * the bytes were created with {@link #write(Object)}.
+   *
+   * @param b A byte array
+   * @param offset Offset into the array
+   * @return An Object
+   * @throws IOException
+   */
+  public static Object read(byte[] b, int offset) throws IOException {
+    if (b == null || b.length == 0) {
-    ByteArrayInputStream bais = new ByteArrayInputStream(b);
+    }
+    ByteArrayInputStream bais = new ByteArrayInputStream(b, offset,
+        b.length - offset);

MOV26 MOV26 MOV26 MOV26 UPD40 INS31 INS8 INS29 INS83 INS83 INS43 INS42 INS44 INS44 INS43 MOV8 INS41 INS65 INS65 INS65 INS65 INS65 INS42 INS5 INS42 INS39 INS42 INS42 UPD42 INS32 INS66 INS66 INS65 INS66 INS42 INS66 INS42 INS66 INS66 INS42 INS39 INS85 INS8 MOV43 INS42 INS42 INS34 INS68 MOV41 INS42 INS69 MOV43 INS42 INS27 INS43 INS40 INS42 INS42 DEL40 DEL26