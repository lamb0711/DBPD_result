YARN-6099. Improve webservice to list aggregated log files. Contributed by Xuan Gong.

+import org.apache.hadoop.yarn.logaggregation.PerContainerLogFileInfo;
-  private List<PerLogFileInfo> getContainerLogFiles(Configuration conf,
-      String containerIdStr, String nodeHttpAddress) throws IOException {
-    List<PerLogFileInfo> logFileInfos = new ArrayList<>();
+  private List<PerContainerLogFileInfo> getContainerLogFiles(
+      Configuration conf, String containerIdStr, String nodeHttpAddress)
+      throws IOException {
+    List<PerContainerLogFileInfo> logFileInfos = new ArrayList<>();
-          JSONArray array = json.getJSONArray("containerLogInfo");
+          JSONArray array = json.getJSONArray("containerLogsInfo");
-            String fileName = array.getJSONObject(i).getString("fileName");
-            String fileSize = array.getJSONObject(i).getString("fileSize");
-            logFileInfos.add(new PerLogFileInfo(fileName, fileSize));
+            JSONObject log = array.getJSONObject(i);
+            Object ob = log.get("containerLogInfo");
+            if (ob instanceof JSONArray) {
+              JSONArray obArray = (JSONArray)ob;
+              for (int j = 0; j < obArray.length(); j++) {
+                logFileInfos.add(generatePerContainerLogFileInfoFromJSON(
+                    obArray.getJSONObject(j)));
+              }
+            } else if (ob instanceof JSONObject) {
+              logFileInfos.add(generatePerContainerLogFileInfoFromJSON(
+                  (JSONObject)ob));
+            }
+  private PerContainerLogFileInfo generatePerContainerLogFileInfoFromJSON(
+      JSONObject meta) throws JSONException {
+    String fileName = meta.has("fileName") ?
+        meta.getString("fileName") : "N/A";
+    String fileSize = meta.has("fileSize") ?
+        meta.getString("fileSize") : "N/A";
+    String lastModificationTime = meta.has("lastModifiedTime") ?
+        meta.getString("lastModifiedTime") : "N/A";
+    return new PerContainerLogFileInfo(fileName, fileSize,
+        lastModificationTime);
+  }
+
+
-          "LogType", "LogLength");
+          "LogFile", "LogLength", "LastModificationTime");
-      List<PerLogFileInfo> infos = getContainerLogFiles(
+      List<PerContainerLogFileInfo> infos = getContainerLogFiles(
-      for (PerLogFileInfo info : infos) {
+      for (PerContainerLogFileInfo info : infos) {
-            info.getFileName(), info.getFileLength());
+            info.getFileName(), info.getFileSize(),
+            info.getLastModifiedTime());
-  private static class PerLogFileInfo {
-    private String fileName;
-    private String fileLength;
-    public PerLogFileInfo(String fileName, String fileLength) {
-      setFileName(fileName);
-      setFileLength(fileLength);
-    }
-
-    public String getFileName() {
-      return fileName;
-    }
-
-    public void setFileName(String fileName) {
-      this.fileName = fileName;
-    }
-
-    public String getFileLength() {
-      return fileLength;
-    }
-
-    public void setFileLength(String fileLength) {
-      this.fileLength = fileLength;
-    }
-  }
-
-    List<PerLogFileInfo> allLogFileInfos=
+    List<PerContainerLogFileInfo> allLogFileInfos=
-    for (PerLogFileInfo fileInfo : allLogFileInfos) {
+    for (PerContainerLogFileInfo fileInfo : allLogFileInfos) {

INS26 INS40 INS31 UPD74 INS83 INS43 INS42 INS44 INS43 INS8 UPD43 UPD42 MOV42 INS43 INS42 UPD42 MOV42 INS60 INS60 INS60 INS41 UPD42 UPD74 UPD42 MOV42 MOV43 INS59 MOV43 INS59 MOV43 INS59 INS14 UPD74 UPD43 INS42 INS16 INS42 INS16 INS42 INS16 INS43 INS42 INS42 INS42 UPD43 UPD43 UPD42 INS32 INS32 INS45 INS32 INS32 INS45 INS32 INS32 INS45 UPD42 MOV42 UPD74 UPD42 UPD42 UPD42 MOV42 UPD42 MOV42 INS45 UPD42 MOV42 UPD42 MOV42 INS45 INS42 INS42 INS45 INS42 INS42 INS45 INS42 INS42 INS45 INS42 INS42 INS45 UPD45 INS45 UPD43 UPD43 UPD42 UPD42 INS32 UPD42 INS42 INS42 INS60 INS25 UPD45 INS43 INS43 INS59 INS62 INS8 INS25 INS42 INS42 MOV32 INS42 INS42 INS32 INS42 INS43 INS60 INS24 INS62 INS8 INS42 INS42 INS45 INS42 INS43 INS59 INS58 INS27 INS37 INS8 INS42 INS43 MOV21 INS42 INS42 INS11 INS39 INS59 INS42 INS32 INS42 INS21 INS42 INS43 INS42 INS42 INS34 INS42 INS42 INS32 INS32 INS42 INS42 INS42 INS32 INS42 INS11 INS42 MOV32 INS43 INS42 UPD42 UPD42 INS42 DEL42 DEL42 DEL45 DEL32 DEL42 DEL43 DEL42 DEL42 DEL14 DEL42 DEL42 DEL45 DEL32 DEL59 DEL60 DEL83 DEL83 DEL42 DEL83 DEL43 DEL42 DEL59 DEL23 DEL83 DEL43 DEL42 DEL59 DEL23 DEL83 DEL42 DEL42 DEL44 DEL43 DEL42 DEL44 DEL32 DEL21 DEL32 DEL21 DEL8 DEL31 DEL83 DEL42 DEL43 DEL42 DEL42 DEL41 DEL8 DEL31 DEL83 DEL39 DEL42 DEL42 DEL43 DEL42 DEL44 DEL52 DEL42 DEL22 DEL42 DEL7 DEL21 DEL8 DEL31 DEL83 DEL42 DEL43 DEL42 DEL42 DEL41 DEL8 DEL31 DEL83 DEL39 DEL42 DEL43 DEL42 DEL44 DEL52 DEL42 DEL22 DEL42 DEL7 DEL21 DEL8 DEL31 DEL55