Merge r1609845 through r1614231 from trunk.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-6584@1614234 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.hdfs.server.protocol.DatanodeStorageReport;
-      throw new IOException("Cannot find datanode report");
+      throw new IOException("Failed to get datanode report for " + type
+          + " datanodes.");
+  public DatanodeStorageReport[] getDatanodeStorageReport(
+      DatanodeReportType type) throws IOException {
+    final DatanodeStorageReport[] reports = namesystem.getDatanodeStorageReport(type);
+    if (reports == null ) {
+      throw new IOException("Failed to get datanode storage report for " + type
+          + " datanodes.");
+    }
+    return reports;
+  }
+
+  @Override // ClientProtocol

INS26 INS40 INS31 INS78 INS83 INS5 INS42 INS44 INS43 INS8 INS42 INS43 INS85 INS43 INS42 INS42 INS60 INS25 INS41 INS42 INS42 INS83 INS5 INS59 INS27 INS8 INS42 INS43 INS85 INS42 INS32 INS42 INS33 INS53 INS42 INS42 INS42 INS42 INS14 INS27 INS43 INS27 INS45 INS42 INS45 INS42 INS45 INS42 INS45 DEL45