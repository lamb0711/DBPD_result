HDFS-5222. Move block schedule information from DatanodeDescriptor to DatanodeStorageInfo.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2832@1526215 13f79535-47bb-0310-9956-ffa450edef68

-    if (requiredSize > storage.getRemaining()) {
+    final long scheduledSize = blockSize = storage.getBlocksScheduled();
+    if (requiredSize > storage.getRemaining() - scheduledSize) {
-    //TODO: move getBlocksScheduled() to DatanodeStorageInfo. 
-    long remaining = node.getRemaining() - 
-                     (node.getBlocksScheduled() * blockSize); 
-    // check the remaining capacity of the target machine
-    if (requiredSize > remaining) {
-      logNodeIsNotChosen(storage, "the node does not have enough space ");
-      return false;
-    }
-      
+

MOV25 INS83 INS27 UPD42 INS7 INS42 UPD27 MOV27 MOV42 INS42 INS32 UPD42 UPD42 MOV42 MOV42 DEL42 DEL42 DEL32 DEL32 DEL42 DEL27 DEL36 DEL27 DEL42 DEL42 DEL27 DEL42 DEL42 DEL45 DEL32 DEL21 DEL9 DEL41 DEL8 DEL25