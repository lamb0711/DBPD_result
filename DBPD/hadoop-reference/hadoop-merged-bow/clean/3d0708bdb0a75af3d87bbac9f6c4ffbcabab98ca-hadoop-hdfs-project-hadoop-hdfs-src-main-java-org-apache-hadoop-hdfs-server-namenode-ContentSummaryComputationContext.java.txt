HDFS-7824. GetContentSummary API and its namenode implementation for Storage Type Quota/Usage. (Contributed by Xiaoyu Yao)

+import com.google.common.base.Preconditions;
-  private Content.Counts counts = null;
+  private BlockStoragePolicySuite bsps = null;
+  private ContentCounts counts = null;
-    this.counts = Content.Counts.newInstance();
+    this.counts = new ContentCounts.Builder().build();
-  public ContentSummaryComputationContext() {
+  public ContentSummaryComputationContext(BlockStoragePolicySuite bsps) {
+    this.bsps = bsps;
-    long currentCount = counts.get(Content.FILE) +
-        counts.get(Content.SYMLINK) +
-        counts.get(Content.DIRECTORY) +
-        counts.get(Content.SNAPSHOTTABLE_DIRECTORY);
+    long currentCount = counts.getFileCount() +
+        counts.getSymlinkCount() +
+        counts.getDirectoryCount() +
+        counts.getSnapshotableDirectoryCount();
-  public Content.Counts getCounts() {
+  public ContentCounts getCounts() {
-      return fsn.getBlockManager().getStoragePolicySuite();
+    Preconditions.checkState((bsps != null || fsn != null),
+        "BlockStoragePolicySuite must be either initialized or available via" +
+            " FSNameSystem");
+    return (bsps != null) ? bsps:
+        fsn.getBlockManager().getStoragePolicySuite();

INS26 INS40 INS23 INS83 INS43 INS59 UPD43 INS44 UPD43 INS42 INS42 INS33 INS42 INS43 INS42 INS21 INS42 INS21 INS42 INS7 INS32 INS16 INS22 INS42 INS42 INS42 INS36 INS27 INS36 INS42 MOV32 INS14 UPD42 INS52 INS42 INS27 INS45 INS45 INS27 INS43 UPD42 UPD42 UPD42 UPD42 INS27 INS27 INS42 INS33 INS40 INS42 INS33 INS42 INS33 DEL40 DEL40 DEL40 DEL40 DEL40 DEL40 DEL40