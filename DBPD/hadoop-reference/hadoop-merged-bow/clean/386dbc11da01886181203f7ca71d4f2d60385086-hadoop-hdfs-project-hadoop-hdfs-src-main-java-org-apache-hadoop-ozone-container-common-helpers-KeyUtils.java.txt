HDFS-11196. Ozone: Improve logging and error handling in the container layer. Contributed by Anu Engineer.

+import org.apache.hadoop.scm.container.common.helpers.StorageContainerException;
+import static org.apache.hadoop.hdfs.ozone.protocol.proto.ContainerProtos
+    .Result.UNABLE_TO_READ_METADATA_DB;
+
-   * @throws IOException
+   * @throws StorageContainerException
-                                   ContainerCache cache) throws IOException {
+                                   ContainerCache cache)
+      throws StorageContainerException {
-    LevelDBStore db = cache.getDB(container.getContainerName());
-    if (db == null) {
-      db = getDB(container.getDBPath());
-      cache.putDB(container.getContainerName(), db);
+    try {
+      LevelDBStore db = cache.getDB(container.getContainerName());
+      if (db == null) {
+        db = getDB(container.getDBPath());
+        cache.putDB(container.getContainerName(), db);
+      }
+      return db;
+    } catch (IOException ex) {
+      String message = "Unable to open DB. DB Name: %s, Path: %s. ex: %s"
+          .format(container.getContainerName(), container.getDBPath(), ex);
+      throw new StorageContainerException(message, UNABLE_TO_READ_METADATA_DB);
-    return db;
-      getKeyDataResponse(ContainerProtos.ContainerCommandRequestProto msg
-                       , KeyData data) {
+      getKeyDataResponse(ContainerProtos.ContainerCommandRequestProto msg,
+      KeyData data) {

INS26 INS26 INS40 INS40 INS43 INS8 INS42 MOV21 MOV21 INS54 UPD42 MOV8 INS12 INS44 INS8 MOV43 INS42 INS60 INS53 INS43 INS59 INS14 INS42 INS42 INS32 INS43 INS42 INS42 INS45 INS42 INS32 INS32 INS42 INS42 INS42 INS42 INS42 INS42