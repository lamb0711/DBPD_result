HDFS-8321. CacheDirectives and CachePool operations should throw RetriableException in safemode. Contributed by Haohui Mai.

-      if (isInSafeMode()) {
-        throw new SafeModeException(
-            "Cannot add cache directive", safeMode);
-      }
+      checkNameNodeSafeMode("Cannot add cache directive");
-      if (isInSafeMode()) {
-        throw new SafeModeException(
-            "Cannot add cache directive", safeMode);
-      }
+      checkNameNodeSafeMode("Cannot add cache directive");
-      if (isInSafeMode()) {
-        throw new SafeModeException(
-            "Cannot remove cache directives", safeMode);
-      }
+      checkNameNodeSafeMode("Cannot remove cache directives");
-      if (isInSafeMode()) {
-        throw new SafeModeException(
-            "Cannot add cache pool " + req.getPoolName(), safeMode);
-      }
+      checkNameNodeSafeMode("Cannot add cache pool"
+          + (req == null ? null : req.getPoolName()));
-      if (isInSafeMode()) {
-        throw new SafeModeException(
-            "Cannot modify cache pool " + req.getPoolName(), safeMode);
-      }
+      checkNameNodeSafeMode("Cannot modify cache pool"
+          + (req == null ? null : req.getPoolName()));
-      if (isInSafeMode()) {
-        throw new SafeModeException(
-            "Cannot remove cache pool " + cachePoolName, safeMode);
-      }
+      checkNameNodeSafeMode("Cannot modify cache pool" + cachePoolName);

INS21 INS21 INS21 INS21 INS21 INS21 INS32 INS32 INS32 INS32 INS32 INS32 UPD42 MOV42 INS45 UPD42 MOV42 INS45 UPD42 MOV42 INS45 UPD42 MOV42 INS27 UPD42 MOV42 INS27 UPD42 MOV42 INS27 UPD45 MOV45 INS36 UPD45 MOV45 INS36 UPD45 MOV45 MOV42 INS16 INS16 INS27 INS33 MOV32 INS27 INS33 MOV32 INS42 INS33 INS42 INS33 DEL32 DEL42 DEL43 DEL45 DEL42 DEL14 DEL53 DEL8 DEL25 DEL32 DEL42 DEL43 DEL45 DEL42 DEL14 DEL53 DEL8 DEL25 DEL32 DEL42 DEL43 DEL45 DEL42 DEL14 DEL53 DEL8 DEL25 DEL32 DEL42 DEL43 DEL27 DEL42 DEL14 DEL53 DEL8 DEL25 DEL32 DEL42 DEL43 DEL27 DEL42 DEL14 DEL53 DEL8 DEL25 DEL32 DEL42 DEL43 DEL27 DEL42 DEL14 DEL53 DEL8 DEL25