YARN-684. ContainerManager.startContainer should use ContainerTokenIdentifier instead of the entire Container. Contributed by Vinod Kumar Vavilapalli.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1488085 13f79535-47bb-0310-9956-ffa450edef68

-import java.io.IOException;
-import org.apache.hadoop.yarn.util.BuilderUtils;
-                    + rsrcReqs.getContainer().getContainer().getId());
+                    + rsrcReqs.getContainer().getContainerId());
-                        .getContainer().getId(), req, new Path("file:///local"
+                        .getContainerId(), req, new Path("file:///local"
-              new ContainerEvent(container.getContainer().getId(),
+              new ContainerEvent(container.getContainerId(),
-        ContainerId containerId = container.getContainer().getId();
+        ContainerId containerId = container.getContainerId();
-      org.apache.hadoop.yarn.api.records.Container container,
-  protected ContainerTokenIdentifier getContainerTokenIdentifier(
-      UserGroupInformation remoteUgi,
-      org.apache.hadoop.yarn.api.records.Container container)
-      throws YarnRemoteException {
-    try {
-      return new ContainerTokenIdentifier(container.getId(),
-        container.getNodeHttpAddress(), remoteUgi.getUserName(),
-        container.getResource(), System.currentTimeMillis() + 100000l, 123,
-        BuilderUtils.newContainerTokenIdentifier(
-          container.getContainerToken()).getRMIdentifer());
-    } catch (IOException e) {
-      throw new YarnRemoteException(e);
-    }
+  protected ContainerTokenIdentifier
+      getContainerTokenIdentifier(UserGroupInformation remoteUgi,
+          ContainerTokenIdentifier containerTokenId) throws YarnRemoteException {
+    return containerTokenId;

INS8 MOV43 UPD42 MOV41 INS42 INS32 MOV42 UPD42 MOV42 INS32 MOV42 UPD42 MOV42 MOV32 UPD42 INS42 INS27 INS45 INS42 INS45 MOV32 MOV32 UPD42 UPD42 DEL40 DEL26 DEL40 DEL26 DEL42 DEL42 DEL45 DEL42 DEL45 DEL27 DEL32 DEL42 DEL32 DEL32 DEL42 DEL32 DEL32 DEL42 DEL32 DEL40 DEL43 DEL42 DEL44 DEL40 DEL43 DEL42 DEL42 DEL32 DEL42 DEL42 DEL32 DEL42 DEL42 DEL32 DEL42 DEL42 DEL32 DEL42 DEL42 DEL32 DEL34 DEL27 DEL34 DEL42 DEL42 DEL42 DEL42 DEL32 DEL32 DEL42 DEL32 DEL14 DEL8 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL14 DEL53 DEL8 DEL12 DEL54 DEL8