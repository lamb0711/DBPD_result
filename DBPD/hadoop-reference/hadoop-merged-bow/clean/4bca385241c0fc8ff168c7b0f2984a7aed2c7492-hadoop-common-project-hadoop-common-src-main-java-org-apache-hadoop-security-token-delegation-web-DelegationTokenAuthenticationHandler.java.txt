HADOOP-12082 Support multiple authentication schemes via AuthenticationFilter

+  AuthenticationHandler getAuthHandler() {
+    return authHandler;
+  }
+
+  /**
+   * This method checks if the given HTTP request corresponds to a management
+   * operation.
+   *
+   * @param request The HTTP request
+   * @return true if the given HTTP request corresponds to a management
+   *         operation false otherwise
+   * @throws IOException In case of I/O error.
+   */
+  protected final boolean isManagementOperation(HttpServletRequest request)
+      throws IOException {
+    String op = ServletUtils.getParameter(request,
+        KerberosDelegationTokenAuthenticator.OP_PARAM);
+    op = (op != null) ? StringUtils.toUpperCase(op) : null;
+    return DELEGATION_TOKEN_OPS.contains(op) &&
+        !request.getMethod().equals("OPTIONS");
+  }
+
-    if (DELEGATION_TOKEN_OPS.contains(op) &&
-        !request.getMethod().equals("OPTIONS")) {
+    if (isManagementOperation(request)) {

INS31 INS31 INS43 INS42 INS8 INS29 INS83 INS83 INS39 INS42 INS44 INS43 INS8 INS42 INS41 INS65 INS65 INS65 INS65 INS43 INS42 INS42 INS60 INS21 INS41 INS42 INS66 INS66 INS42 INS66 INS66 INS66 INS42 INS66 INS42 INS43 INS59 INS7 MOV27 INS32 INS42 INS42 INS32 INS42 INS16 INS42 INS42 INS42 INS42 INS42 INS40 INS36 INS32 INS33 INS27 INS42 INS42 INS42 INS42 INS33