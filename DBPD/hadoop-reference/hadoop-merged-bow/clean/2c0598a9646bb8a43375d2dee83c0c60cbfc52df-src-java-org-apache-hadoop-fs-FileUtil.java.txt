HADOOP-6536. Fixes FileUtil.fullyDelete() not to delete the contents of the sym-linked directory. Contributed by Ravi Gummadi

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@965725 13f79535-47bb-0310-9956-ffa450edef68

+   * (1) If dir is symlink to a file, the symlink is deleted. The file pointed
+   *     to by the symlink is not deleted.
+   * (2) If dir is symlink to a directory, symlink is deleted. The directory
+   *     pointed to by symlink is not deleted.
+   * (3) If dir is a normal file, it is deleted.
+   * (4) If dir is a normal directory, then dir and all its contents recursively
+   *     are deleted.
+    if (dir.delete()) {
+      // dir is (a) normal file, (b) symlink to a file, (c) empty directory or
+      // (d) symlink to a directory
+      return true;
+    }
+
+    // handle nonempty directory deletion
+   * If dir is a symlink to a directory, all the contents of the actual
+   * directory pointed to by dir will be deleted.
-          if (!contents[i].delete()) {
+          if (!contents[i].delete()) {// normal file or symlink to another file
-          //try deleting the directory
-          // this might be a symlink
+          // Either directory or symlink to another directory.
+          // Try deleting the directory as this might be a symlink

INS25 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS32 INS8 INS66 INS66 INS42 INS42 INS41 INS9