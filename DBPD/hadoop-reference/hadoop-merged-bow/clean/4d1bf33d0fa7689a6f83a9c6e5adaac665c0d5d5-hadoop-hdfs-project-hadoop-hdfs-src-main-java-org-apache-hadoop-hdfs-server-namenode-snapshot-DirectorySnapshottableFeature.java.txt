HDFS-12947. Limit the number of Snapshots allowed to be created for a Snapshottable Directory.  Contributed by Shashikant Banerjee

-  static final int SNAPSHOT_LIMIT = 1 << 16;
+  static final int SNAPSHOT_QUOTA_DEFAULT = 1 << 16;
-  private int snapshotQuota = SNAPSHOT_LIMIT;
+  private int snapshotQuota = SNAPSHOT_QUOTA_DEFAULT;
-      final LeaseManager leaseManager, final boolean captureOpenFiles)
+      final LeaseManager leaseManager, final boolean captureOpenFiles,
+      int maxSnapshotLimit)
+    } else if (n + 1 > maxSnapshotLimit) {
+      throw new SnapshotException(
+          "Failed to add snapshot: there are already " + n
+              + " snapshot(s) and the max snapshot limit is "
+              + maxSnapshotLimit);

INS44 UPD42 UPD42 INS39 INS42 INS25 INS27 INS8 INS27 INS42 INS53 INS42 INS34 INS14 INS43 INS27 INS42 INS45 INS42 INS45 INS42