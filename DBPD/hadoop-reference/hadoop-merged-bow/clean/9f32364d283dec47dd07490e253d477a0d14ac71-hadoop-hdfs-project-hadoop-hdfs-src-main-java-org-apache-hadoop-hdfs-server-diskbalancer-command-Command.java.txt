HDFS-11038. DiskBalancer: support running multiple commands in single test. Contributed by Xiaobing Zhou.

+import java.io.Closeable;
-public abstract class Command extends Configured {
+public abstract class Command extends Configured implements Closeable {
+   * Cleans any resources held by this command.
+   * <p>
+   * The main goal is to delete id file created in
+   * {@link org.apache.hadoop.hdfs.server.balancer
+   * .NameNodeConnector#checkAndMarkRunning}
+   * , otherwise, it's not allowed to run multiple commands in a row.
+   * </p>
+   */
+  @Override
+  public void close() throws IOException {
+    if (fs != null) {
+      fs.close();
+    }
+  }
+
+  /**

INS26 INS40 INS43 INS31 INS42 INS29 INS78 INS83 INS39 INS42 INS43 INS8 INS65 INS42 INS42 INS25 INS66 INS66 INS66 INS65 INS66 INS66 INS27 INS8 INS67 INS42 INS33 INS21 INS40 INS42 INS32 INS42 INS42