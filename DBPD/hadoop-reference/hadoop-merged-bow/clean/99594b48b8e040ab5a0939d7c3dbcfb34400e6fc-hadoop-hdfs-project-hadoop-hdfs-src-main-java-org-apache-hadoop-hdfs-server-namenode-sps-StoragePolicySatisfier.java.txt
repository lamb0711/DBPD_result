HDFS-13075. [SPS]: Provide External Context implementation. Contributed by Uma Maheswara Rao G.

+        } else {
+          LOG.info("Namenode is in safemode. It will retry again.");
+          Thread.sleep(3000);
-      boolean goodTargetDn = ctxt.verifyTargetDatanodeHasSpaceForScheduling(
-          source, t, blockInfo.getBlockSize());
+      boolean goodTargetDn =
+          ctxt.checkDNSpaceForScheduling(source, t, blockInfo.getBlockSize());
-      List<DatanodeInfo> nodesWithStorages = locsForExpectedStorageTypes
-          .getNodesWithStorages(t);
+      List<DatanodeInfo> nodesWithStorages =
+          locsForExpectedStorageTypes.getNodesWithStorages(t);
-          boolean goodTargetDn = ctxt.verifyTargetDatanodeHasSpaceForScheduling(
-              target, t, block.getBlockSize());
+          boolean goodTargetDn =
+              ctxt.checkDNSpaceForScheduling(target, t, block.getBlockSize());

INS8 UPD42 INS21 INS21 INS32 INS32 INS42 INS42 INS45 INS42 INS42 INS34 UPD42