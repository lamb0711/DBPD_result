HDFS-2943. Expose last checkpoint time and transaction stats as JMX metrics. Contributed by Aaron T. Myers.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1243822 13f79535-47bb-0310-9956-ffa450edef68

+  
+  @Metric({"TransactionsSinceLastCheckpoint",
+      "Number of transactions since last checkpoint"})
+  public long getTransactionsSinceLastCheckpoint() {
+    return getEditLog().getLastWrittenTxId() -
+        getFSImage().getStorage().getMostRecentCheckpointTxId();
+  }
+  
+  @Metric({"TransactionsSinceLastLogRoll",
+      "Number of transactions since last edit log roll"})
+  public long getTransactionsSinceLastLogRoll() {
+    return (getEditLog().getLastWrittenTxId() -
+        getEditLog().getCurSegmentTxId()) + 1;
+  }
+  
+  @Metric({"LastWrittenTransactionId", "Transaction ID written to the edit log"})
+  public long getLastWrittenTransactionId() {
+    return getEditLog().getLastWrittenTxId();
+  }
+  
+  @Metric({"LastCheckpointTime",
+      "Time in milliseconds since the epoch of the last checkpoint"})
+  public long getLastCheckpointTime() {
+    return getFSImage().getStorage().getMostRecentCheckpointTime();
+  }

INS31 INS31 INS31 INS31 INS79 INS83 INS39 INS42 INS8 INS79 INS83 INS39 INS42 INS8 INS79 INS83 INS39 INS42 INS8 INS79 INS83 INS39 INS42 INS8 INS42 INS4 INS41 INS42 INS4 INS41 INS42 INS4 INS41 INS42 INS4 INS41 INS45 INS45 INS27 INS45 INS45 INS27 INS45 INS45 INS32 INS45 INS45 INS32 INS32 INS32 INS36 INS34 INS32 INS42 INS32 INS42 INS32 INS42 INS32 INS42 INS27 INS42 INS32 INS42 INS42 INS32 INS42 INS32 INS32 INS42 INS42 INS32 INS42 INS32 INS42 INS42 INS42