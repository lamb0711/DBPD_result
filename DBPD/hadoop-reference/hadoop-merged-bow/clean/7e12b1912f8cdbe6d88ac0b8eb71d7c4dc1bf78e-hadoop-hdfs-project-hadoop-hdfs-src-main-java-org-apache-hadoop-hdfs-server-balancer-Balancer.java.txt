HDFS-6796. Improve the argument check during balancer command line parsing.  Contributed by Benoy Antony


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1615107 13f79535-47bb-0310-9956-ffa450edef68

-            checkArgument(args.length >= 2, "args = " + Arrays.toString(args));
-              i++;
+              checkArgument(++i < args.length,
+                "Threshold value is missing: args = " + Arrays.toString(args));
-              i++;
+              checkArgument(++i < args.length,
+                "Policy value is missing: args = " + Arrays.toString(args));
-              i++;
+              checkArgument(++i < args.length,
+                  "List of nodes to exclude | -f <filename> is missing: args = "
+                  + Arrays.toString(args));
-                nodesTobeExcluded = Util.getHostListFromFile(args[++i]);
+                checkArgument(++i < args.length,
+                    "File containing nodes to exclude is not specified: args = "
+                    + Arrays.toString(args));
+                nodesTobeExcluded = Util.getHostListFromFile(args[i]);
-              i++;
+              checkArgument(++i < args.length,
+                "List of nodes to include | -f <filename> is missing: args = "
+                + Arrays.toString(args));
-                nodesTobeIncluded = Util.getHostListFromFile(args[++i]);
+                checkArgument(++i < args.length,
+                    "File containing nodes to include is not specified: args = "
+                    + Arrays.toString(args));
+                nodesTobeIncluded = Util.getHostListFromFile(args[i]);
-          if (!nodesTobeExcluded.isEmpty() && !nodesTobeIncluded.isEmpty()) {
-            System.err.println(
-                "-exclude and -include options cannot be specified together.");
-            throw new IllegalArgumentException(
-                "-exclude and -include options cannot be specified together.");
-          }
+          checkArgument(nodesTobeExcluded.isEmpty() || nodesTobeIncluded.isEmpty(),
+              "-exclude and -include options cannot be specified together.");

MOV21 UPD42 UPD27 MOV27 MOV32 MOV32 MOV21 UPD27 INS32 INS38 UPD45 INS42 INS27 INS27 INS32 INS42 INS38 INS40 INS45 INS32 INS42 INS27 INS27 INS21 INS32 INS42 INS42 INS42 INS42 MOV38 INS40 INS45 INS32 INS32 INS42 INS27 INS27 INS21 INS42 INS42 INS42 INS42 INS27 INS27 MOV38 INS40 INS45 INS32 INS32 INS38 INS40 INS45 INS32 INS42 INS42 INS42 INS42 INS27 INS27 INS42 INS42 INS42 INS42 INS42 INS38 INS40 INS45 INS32 INS42 INS42 INS42 INS42 INS42 DEL34 DEL42 DEL37 DEL21 DEL42 DEL37 DEL42 DEL37 DEL42 DEL37 DEL40 DEL38 DEL38 DEL42 DEL43 DEL45 DEL14 DEL53 DEL8 DEL25