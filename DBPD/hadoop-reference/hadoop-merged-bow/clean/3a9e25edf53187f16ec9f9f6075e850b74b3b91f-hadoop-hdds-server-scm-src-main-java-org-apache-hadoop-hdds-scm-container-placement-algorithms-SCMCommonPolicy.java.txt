HDDS-199. Implement ReplicationManager to handle underreplication of closed containers. Contributed by Elek Marton.

+   *
+   * @param excludedNodes - datanodes with existing replicas
-  public List<DatanodeDetails> chooseDatanodes(int nodesRequired, final long
-      sizeRequired) throws SCMException {
+  public List<DatanodeDetails> chooseDatanodes(
+      List<DatanodeDetails> excludedNodes,
+      int nodesRequired, final long sizeRequired) throws SCMException {
+    healthyNodes.removeAll(excludedNodes);

INS44 INS65 INS74 INS42 INS21 INS42 INS66 INS43 INS43 INS32 INS42 INS42 INS42 INS42 INS42