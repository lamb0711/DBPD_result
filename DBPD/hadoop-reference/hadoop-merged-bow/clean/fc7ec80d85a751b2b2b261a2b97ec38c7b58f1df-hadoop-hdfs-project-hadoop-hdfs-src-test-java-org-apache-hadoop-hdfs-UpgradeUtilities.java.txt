Merge branch 'HDFS-9806' into trunk

-      properties.setProperty("storageID", sd.getStorageUuid());
-      Storage.writeProperties(sd.getVersionFile(), properties);
+      if (properties != null) {
+        properties.setProperty("storageID", sd.getStorageUuid());
+        Storage.writeProperties(sd.getVersionFile(), properties);
+      }
-      StorageInfo version, String bpid) throws IOException {
-    createDataNodeVersionFile(parent, version, bpid, bpid);
+      StorageInfo version, String bpid, Configuration conf)
+          throws IOException {
+    createDataNodeVersionFile(parent, version, bpid, bpid, conf);
-      StorageInfo version, String bpid, String bpidToWrite) throws IOException {
+      StorageInfo version, String bpid, String bpidToWrite, Configuration conf)
+          throws IOException {
-      DataStorage.createStorageID(sd, false);
+      DataStorage.createStorageID(sd, false, conf);

INS44 INS44 INS43 INS42 INS43 INS42 INS42 INS42 INS25 INS42 INS27 INS8 INS42 INS33 MOV21 MOV21 INS42