HDFS-14084. Need for more stats in DFSClient. Contributed by Pranay Singh.

Signed-off-by: Wei-Chiu Chuang <weichiu@apache.org>

+import org.apache.hadoop.metrics2.MetricStringBuilder;
+import org.apache.hadoop.metrics2.lib.MutableRatesWithAggregation;
-        startTime = Time.now();
+        startTime = System.currentTimeMillis();
-      
+
-        long callTime = Time.now() - startTime;
-        LOG.debug("Call: " + method.getName() + " took " + callTime + "ms");
+        long callTime = System.currentTimeMillis() - startTime;
+        if (callTime > 0) {
+          MetricStringBuilder rb =
+              new MetricStringBuilder(null, "", " = ", "\n");
+          client.updateMetrics(method.getName(), callTime);
+          MutableRatesWithAggregation rates =
+              client.getRpcDetailedMetrics().getMutableRates();
+          rates.snapshot(rb, true);
+          LOG.debug("RPC Client stats: {}", rb);
+        }
-      
+

INS26 INS26 INS40 INS40 INS25 INS27 INS8 INS42 INS34 INS60 INS21 INS60 INS21 MOV21 UPD42 UPD42 INS43 INS59 INS32 INS43 INS59 INS32 UPD42 UPD42 INS42 INS42 INS14 INS42 INS42 MOV32 INS42 INS42 INS42 INS32 INS42 INS42 INS42 INS9 INS45 INS42 INS43 INS33 INS45 INS45 INS45 INS32 INS42 INS42 INS42 INS42 DEL45 DEL45 DEL42 DEL45 DEL27