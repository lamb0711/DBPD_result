HDFS-5008. Make ClientProtocol#abandonBlock() idempotent. Contributed by Jing Zhao.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1505761 13f79535-47bb-0310-9956-ffa450edef68

-  void removeLastBlock(Block oldblock) throws IOException {
+  boolean removeLastBlock(Block oldblock) throws IOException {
-    if (blocks == null) {
-      throw new IOException("Trying to delete non-existant block " + oldblock);
+    if (blocks == null || blocks.length == 0) {
+      return false;
-      throw new IOException("Trying to delete non-last block " + oldblock);
+      return false;
+    return true;

UPD39 INS41 INS27 INS8 INS9 MOV27 INS27 INS41 INS41 INS40 INS34 INS9 INS9 DEL42 DEL43 DEL45 DEL42 DEL27 DEL14 DEL53 DEL8 DEL42 DEL43 DEL45 DEL42 DEL27 DEL14 DEL53