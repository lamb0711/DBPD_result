HDFS-10837. Standardize serializiation of WebHDFS DirectoryListing.

+  private static Map<String, Object> toJson(final DirectoryListing listing)
+      throws IOException {
+    final Map<String, Object> m = new TreeMap<>();
+    // Serialize FileStatus[] to a FileStatuses map
+    m.put("partialListing", toJsonMap(listing.getPartialListing()));
+    // Simple int
+    m.put("remainingEntries", listing.getRemainingEntries());
+
+    return m;
+  }
+
-
-    final Map<String, Object> m = new TreeMap<>();
-    m.put("partialListing", toJsonArray(listing.getPartialListing()));
-    m.put("remainingEntries", listing.getRemainingEntries());
-    return MAPPER.writeValueAsString(m);
+    return toJsonString(DirectoryListing.class, toJson(listing));
-  private static Object[] toJsonArray(HdfsFileStatus[] statuses) throws
+  private static Map<String, Object> toJsonMap(HdfsFileStatus[] statuses) throws
-    if (statuses.length == 0) {
-      return EMPTY_OBJECT_ARRAY;
-    }
-    final Object[] a = new Object[statuses.length];
+
+    final Map<String, Object> fileStatuses = new TreeMap<>();
+    final Map<String, Object> fileStatus = new TreeMap<>();
+    fileStatuses.put("FileStatuses", fileStatus);
+    final Object[] array = new Object[statuses.length];
+    fileStatus.put("FileStatus", array);
-      a[i] = toJsonMap(statuses[i]);
+      array[i] = toJsonMap(statuses[i]);
-    return a;
+
+    return fileStatuses;

INS31 UPD83 INS74 INS42 INS83 INS83 MOV43 INS42 INS44 INS43 INS8 INS74 UPD42 INS43 INS43 INS43 INS83 INS43 INS42 INS42 MOV25 INS41 INS43 INS43 INS43 INS60 INS60 INS21 INS21 INS42 INS42 INS42 INS42 INS42 INS32 INS42 INS42 MOV42 INS83 INS74 INS59 INS83 INS74 INS59 INS32 INS32 UPD42 INS42 INS57 INS32 INS43 INS43 INS43 INS42 INS14 INS43 INS43 INS43 INS42 INS14 INS42 INS42 INS45 INS42 UPD42 INS42 INS42 INS45 INS42 UPD42 INS43 INS42 INS42 INS42 INS42 INS42 INS74 INS42 INS42 INS42 INS74 INS42 INS43 INS43 INS42 INS42 UPD42 DEL42 DEL42 DEL42 DEL42 DEL32 DEL43 DEL85 DEL5 DEL40 DEL34 DEL27 DEL42 DEL41 DEL8 DEL25