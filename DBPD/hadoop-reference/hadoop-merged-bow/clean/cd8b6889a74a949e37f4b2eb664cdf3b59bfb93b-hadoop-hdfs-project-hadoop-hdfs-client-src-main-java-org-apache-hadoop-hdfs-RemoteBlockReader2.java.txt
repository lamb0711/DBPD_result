HDFS-9579. Provide bytes-read-by-network-distance metrics at FileSystem.Statistics level (Ming Ma via sjlee)

-import org.apache.hadoop.net.NetUtils;
-  /**
-   * True if we are reading from a local DataNode.
-   */
-  private final boolean isLocal;
-
+  private final int networkDistance;
+
-      DatanodeID datanodeID, PeerCache peerCache, Tracer tracer) {
-    this.isLocal = DFSUtilClient.isLocalAddress(NetUtils.
-        createSocketAddr(datanodeID.getXferAddr()));
+      DatanodeID datanodeID, PeerCache peerCache, Tracer tracer,
+      int networkDistance) {
+    this.networkDistance = networkDistance;
-      Tracer tracer) throws IOException {
+      Tracer tracer,
+      int networkDistance) throws IOException {
-        peerCache, tracer);
+        peerCache, tracer, networkDistance);
-  public boolean isLocal() {
-    return isLocal;
-  }
-
-  @Override
+
+  @Override
+  public int getNetworkDistance() {
+    return networkDistance;
+  }

MOV23 MOV31 UPD39 INS44 MOV21 INS44 UPD39 UPD42 UPD42 INS39 INS42 INS39 INS42 UPD42 INS42 INS42 UPD42 DEL40 DEL26 DEL66 DEL65 DEL29 DEL42 DEL42 DEL42 DEL42 DEL42 DEL42 DEL32 DEL32 DEL32