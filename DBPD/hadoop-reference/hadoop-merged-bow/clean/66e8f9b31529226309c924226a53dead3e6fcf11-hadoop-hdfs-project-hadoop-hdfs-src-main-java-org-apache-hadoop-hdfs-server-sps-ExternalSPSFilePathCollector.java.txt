HDFS-13381 : [SPS]: Use DFSUtilClient#makePathFromFileId() to prepare satisfier file path. Contributed by Rakesh R.

+import org.apache.hadoop.hdfs.DFSUtilClient;
-public class ExternalSPSFilePathCollector implements FileCollector <String>{
+public class ExternalSPSFilePathCollector implements FileCollector {
-  private SPSService<String> service;
+  private SPSService service;
-  public ExternalSPSFilePathCollector(SPSService<String> service) {
+  public ExternalSPSFilePathCollector(SPSService service) {
-  private long processPath(String startID, String childPath) {
+  private long processPath(Long startID, String childPath) {
-        children = dfs.getClient().listPaths(childPath, lastReturnedName,
-            false);
+        children = dfs.getClient().listPaths(childPath,
+            lastReturnedName, false);
-        String childFullPath = child.getFullName(childPath);
-          service.addFileToProcess(
-              new ItemInfo<String>(startID, childFullPath), false);
+          service.addFileToProcess(new ItemInfo(startID, child.getFileId()),
+              false);
+          String childFullPathName = child.getFullName(childPath);
-            if (!childFullPath.endsWith(Path.SEPARATOR)) {
-              childFullPath = childFullPath + Path.SEPARATOR;
+            if (!childFullPathName.endsWith(Path.SEPARATOR)) {
+              childFullPathName = childFullPathName + Path.SEPARATOR;
-            pendingWorkCount += processPath(startID, childFullPath);
+            pendingWorkCount += processPath(startID, childFullPathName);
-  public void scanAndCollectFiles(String path) throws IOException {
+  public void scanAndCollectFiles(long pathId) throws IOException {
-    long pendingSatisfyItemsCount = processPath(path, path);
+    Path filePath = DFSUtilClient.makePathFromFileId(pathId);
+    long pendingSatisfyItemsCount = processPath(pathId, filePath.toString());
-          + "inodeId:{}", path);
-      service.addAllFilesToProcess(path, new ArrayList<>(), true);
+          + "inodeId:{}", pathId);
+      service.addAllFilesToProcess(pathId, new ArrayList<>(), true);
-      service.markScanCompletedForPath(path);
+      service.markScanCompletedForPath(pathId);

INS26 INS40 MOV43 MOV43 MOV43 UPD43 INS39 UPD42 INS60 UPD42 INS43 INS59 INS42 INS42 INS32 INS42 INS42 INS42 UPD42 INS32 UPD42 MOV42 INS42 UPD42 UPD42 UPD42 MOV60 UPD42 MOV43 INS32 INS42 INS42 UPD42 UPD42 UPD42 UPD42 DEL42 DEL43 DEL74 DEL42 DEL43 DEL74 DEL42 DEL43 DEL74 DEL42 DEL43 DEL74 DEL42 DEL42 DEL43