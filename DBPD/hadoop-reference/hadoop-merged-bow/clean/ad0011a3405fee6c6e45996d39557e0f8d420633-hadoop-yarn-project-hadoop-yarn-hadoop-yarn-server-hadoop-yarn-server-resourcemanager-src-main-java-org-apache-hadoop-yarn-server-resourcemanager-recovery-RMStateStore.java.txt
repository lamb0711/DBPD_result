YARN-1082. Create base directories on HDFS after RM login to ensure RM recovery doesn't fail in secure mode. Contributed by Vinod K V.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1516337 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.service.AbstractService;
-public abstract class RMStateStore {
+public abstract class RMStateStore extends AbstractService {
+
+  public RMStateStore() {
+    super(RMStateStore.class.getName());
+  }
+
-  public void setDispatcher(Dispatcher dispatcher) {
+  public void setRMDispatcher(Dispatcher dispatcher) {
-  public synchronized void init(Configuration conf) throws Exception{    
+  public synchronized void serviceInit(Configuration conf) throws Exception{    
-    dispatcher.start();
-    
+  
+  protected synchronized void serviceStart() throws Exception {
+    dispatcher.start();
+    startInternal();
+  }
-   * The base class is initialized and the event dispatcher is ready to use at
-   * this point
-  
-  public synchronized void close() throws Exception {
+
+  /**
+   * Derived classes start themselves using this method.
+   * The base class is started and the event dispatcher is ready to use at
+   * this point
+   */
+  protected abstract void startInternal() throws Exception;
+
+  public synchronized void serviceStop() throws Exception {

INS26 INS40 INS43 INS31 INS31 INS31 INS42 INS83 INS42 INS8 UPD42 UPD42 INS83 INS83 INS39 INS42 INS43 INS8 INS29 INS83 INS83 INS39 INS42 MOV44 MOV43 UPD42 INS43 UPD42 INS46 INS42 MOV21 INS21 INS65 INS42 INS32 INS32 INS66 UPD66 UPD66 INS57 INS42 INS42 INS43 INS42