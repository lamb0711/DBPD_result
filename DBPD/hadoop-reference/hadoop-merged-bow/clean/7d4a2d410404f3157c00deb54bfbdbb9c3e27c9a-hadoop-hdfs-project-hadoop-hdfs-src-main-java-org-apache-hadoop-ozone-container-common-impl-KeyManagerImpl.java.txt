HDFS-11569. Ozone: Implement listKey function for KeyManager. Contributed by Weiwei Yang.

+import org.apache.hadoop.ozone.container.common.helpers.FilteredKeys;
+import org.apache.hadoop.ozone.container.common.helpers.FilteredKeys.KeyPrefixFilter;
+import org.apache.hadoop.ozone.container.common.helpers.FilteredKeys.PreKeyFilter;
-  public List<KeyData> listKey(Pipeline pipeline, String prefix, String
-      prevKey, int count) {
-    // TODO : Implement listKey function.
-    return null;
+  public List<KeyData> listKey(
+      Pipeline pipeline, String prefix, String prevKey, int count)
+      throws StorageContainerException {
+    Preconditions.checkNotNull(pipeline,
+        "Pipeline cannot be null.");
+    Preconditions.checkArgument(count > 0,
+        "Count must be a positive number.");
+    ContainerData cData = containerManager.readContainer(pipeline
+        .getContainerName());
+    LevelDBStore db = KeyUtils.getDB(cData, conf);
+    try (FilteredKeys filteredKeys = new FilteredKeys(db, count)) {
+      filteredKeys.addKeyFilter(new KeyPrefixFilter(prefix));
+      filteredKeys.addKeyFilter(new PreKeyFilter(db, prevKey));
+      return filteredKeys.getFilteredKeys();
+    }

INS26 INS26 INS26 INS40 INS40 INS40 INS43 INS8 INS42 INS21 INS21 INS60 INS60 INS54 INS32 INS32 INS43 INS59 INS43 INS59 INS58 INS8 INS42 INS42 INS42 INS45 INS42 INS42 INS27 INS45 INS42 INS42 INS32 INS42 INS42 INS32 INS43 INS59 INS21 INS21 MOV41 INS42 INS34 INS42 INS42 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS14 INS32 INS32 INS32 INS42 INS42 INS43 INS42 INS42 INS42 INS42 INS14 INS42 INS42 INS14 INS42 INS42 INS42 INS43 INS42 INS43 INS42 INS42 INS42 INS42 DEL33 DEL8