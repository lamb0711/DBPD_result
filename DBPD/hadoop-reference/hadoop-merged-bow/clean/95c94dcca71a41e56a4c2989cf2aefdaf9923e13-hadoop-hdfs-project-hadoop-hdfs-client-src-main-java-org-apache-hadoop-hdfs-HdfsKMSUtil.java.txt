HADOOP-16350. Ability to tell HDFS client not to request KMS Information from NameNode. Ccontributed  by Greg Senia, Ajay Kumar.

+import static org.apache.hadoop.fs.CommonConfigurationKeys.DFS_CLIENT_IGNORE_NAMENODE_DEFAULT_KMS_URI;
+import static org.apache.hadoop.fs.CommonConfigurationKeys.DFS_CLIENT_IGNORE_NAMENODE_DEFAULT_KMS_URI_DEFAULT;
-      // NN is old and doesn't report provider, so use conf.
-      if (keyProviderUriStr == null) {
+      // Check if NN provided uri is not null and ignore property is false.
+      if (keyProviderUriStr != null && !conf.getBoolean(
+          DFS_CLIENT_IGNORE_NAMENODE_DEFAULT_KMS_URI,
+          DFS_CLIENT_IGNORE_NAMENODE_DEFAULT_KMS_URI_DEFAULT)) {
+        if (!keyProviderUriStr.isEmpty()) {
+          keyProviderUri = URI.create(keyProviderUriStr);
+        }
+      }
+      // Fallback to configuration.
+      if (keyProviderUri == null) {
+        // Either NN is old and doesn't report provider or ignore NN KMS
+        // provider property is set to true, so use conf.
-      } else if (!keyProviderUriStr.isEmpty()) {
-        keyProviderUri = URI.create(keyProviderUriStr);

INS26 INS26 INS40 INS40 INS25 INS27 INS8 INS27 MOV8 INS27 INS38 MOV25 INS42 INS33 MOV42 MOV33 INS32 INS42 INS42 INS42 INS42 DEL27