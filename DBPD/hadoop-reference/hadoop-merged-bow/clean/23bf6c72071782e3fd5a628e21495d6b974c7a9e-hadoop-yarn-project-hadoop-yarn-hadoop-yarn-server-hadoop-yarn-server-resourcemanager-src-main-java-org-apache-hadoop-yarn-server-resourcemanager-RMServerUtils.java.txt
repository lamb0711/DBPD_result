YARN-3100. Made YARN authorization pluggable. Contributed by Jian He.

+import org.apache.hadoop.yarn.security.YarnAuthorizationProvider;
-  public static UserGroupInformation verifyAccess(
-      AccessControlList acl, String method, final Log LOG)
+  public static UserGroupInformation verifyAdminAccess(
+      YarnAuthorizationProvider authorizer, String method, final Log LOG)
-    return verifyAccess(acl, method, "AdminService", LOG);
+    return verifyAdminAccess(authorizer, method, "AdminService", LOG);
-   * @param acl the {@link AccessControlList} to check against
+   * @param authorizer the {@link AccessControlList} to check against
-   * @param module, like AdminService or NodeLabelManager
+   * @param module like AdminService or NodeLabelManager
-  public static UserGroupInformation verifyAccess(
-      AccessControlList acl, String method, String module, final Log LOG)
+  public static UserGroupInformation verifyAdminAccess(
+      YarnAuthorizationProvider authorizer, String method, String module,
+      final Log LOG)
-      RMAuditLogger.logFailure("UNKNOWN", method, acl.toString(),
+      RMAuditLogger.logFailure("UNKNOWN", method, "",
-    if (!acl.isUserAllowed(user)) {
+    if (!authorizer.isAdmin(user)) {
-      RMAuditLogger.logFailure(user.getShortUserName(), method,
-          acl.toString(), module,
-          RMAuditLogger.AuditConstants.UNAUTHORIZED_USER);
+      RMAuditLogger.logFailure(user.getShortUserName(), method, "", module,
+        RMAuditLogger.AuditConstants.UNAUTHORIZED_USER);

INS26 INS40 UPD42 UPD42 UPD43 UPD42 UPD43 UPD42 UPD42 UPD42 INS42 UPD66 UPD42 UPD42 UPD42 UPD42 UPD42 INS45 INS45 DEL42 DEL42 DEL32 DEL42 DEL42 DEL32