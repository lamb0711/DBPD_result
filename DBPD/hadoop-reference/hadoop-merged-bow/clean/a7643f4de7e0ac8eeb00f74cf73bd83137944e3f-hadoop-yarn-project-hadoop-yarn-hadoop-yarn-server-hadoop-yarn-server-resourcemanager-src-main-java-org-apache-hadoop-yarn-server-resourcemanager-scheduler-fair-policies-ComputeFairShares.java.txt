YARN-2026. Fair scheduler: Consider only active queues for computing fairshare. (Ashwin Shankar via kasha)

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1616915 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.ArrayList;
-  
+
+  /**
+   * Compute fair share of the given schedulables.Fair share is an allocation of
+   * shares considering only active schedulables ie schedulables which have
+   * running apps.
+   * 
+   * @param schedulables
+   * @param totalResources
+   * @param type
+   */
+  public static void computeShares(
+      Collection<? extends Schedulable> schedulables, Resource totalResources,
+      ResourceType type) {
+    Collection<Schedulable> activeSchedulables = new ArrayList<Schedulable>();
+    for (Schedulable sched : schedulables) {
+      if (sched.isActive()) {
+        activeSchedulables.add(sched);
+      } else {
+        setResourceValue(0, sched.getFairShare(), type);
+      }
+    }
+
+    computeSharesInternal(activeSchedulables, totalResources, type);
+  }
+
-  public static void computeShares(
+  private static void computeSharesInternal(

INS26 INS40 INS31 INS29 INS83 INS83 INS39 INS42 INS44 INS44 INS44 INS8 UPD83 UPD42 INS65 INS65 INS65 INS65 INS74 INS42 INS43 INS42 INS43 INS42 INS60 INS70 INS21 INS66 INS66 INS66 INS42 INS42 INS42 INS43 INS76 INS42 INS42 INS74 INS59 INS44 INS42 INS8 INS32 INS42 INS43 INS43 INS43 INS42 INS14 INS43 INS42 INS25 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS74 INS42 INS32 INS8 INS8 INS43 INS43 INS42 INS42 INS21 INS21 INS42 INS42 INS32 INS32 INS42 INS42 INS42 INS42 INS34 INS32 INS42 INS42 INS42