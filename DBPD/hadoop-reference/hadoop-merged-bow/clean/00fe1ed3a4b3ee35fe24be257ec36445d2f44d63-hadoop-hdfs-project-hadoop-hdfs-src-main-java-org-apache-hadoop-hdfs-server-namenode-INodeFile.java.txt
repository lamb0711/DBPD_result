HDFS-6757. Simplify lease manager with INodeID. Contributed by Haohui Mai.

-  public QuotaCounts cleanSubtree(BlockStoragePolicySuite bsps, final int snapshot,
-                                  int priorSnapshotId,
+  public QuotaCounts cleanSubtree(
+      BlockStoragePolicySuite bsps, final int snapshot, int priorSnapshotId,
-      final List<INode> removedINodes) {
+      final List<INode> removedINodes, List<Long> removedUCFiles) {
+
-        destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes);
+        destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes,
+                                removedUCFiles);
+        FileUnderConstructionFeature uc = getFileUnderConstructionFeature();
-        FileUnderConstructionFeature uc = getFileUnderConstructionFeature();
+          if (removedUCFiles != null) {
+            removedUCFiles.add(getId());
+          }
-  public void destroyAndCollectBlocks(BlockStoragePolicySuite bsps,
-      BlocksMapUpdateInfo collectedBlocks, final List<INode> removedINodes) {
+  public void destroyAndCollectBlocks(
+      BlockStoragePolicySuite bsps, BlocksMapUpdateInfo collectedBlocks,
+      final List<INode> removedINodes, List<Long> removedUCFiles) {
+    if (isUnderConstruction() && removedUCFiles != null) {
+      removedUCFiles.add(getId());
+    }

INS44 INS44 INS74 INS42 INS74 INS42 INS25 INS43 INS43 INS43 INS43 INS27 INS8 INS42 INS42 INS42 INS42 INS32 INS27 INS21 INS42 INS42 INS33 INS32 INS42 INS42 INS32 INS42 INS42 INS25 INS27 INS8 INS42 INS33 INS21 INS32 INS42 INS42 INS32 INS42