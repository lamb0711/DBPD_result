HDFS-8311. DataStreamer.transfer() should timeout the socket InputStream. (Esteban Gutierrez via Yongjun Zhang)

+      final long readTimeout = dfsClient.getDatanodeReadTimeout(2);
-      InputStream unbufIn = NetUtils.getInputStream(sock);
+      InputStream unbufIn = NetUtils.getInputStream(sock, readTimeout);
+        long readTimeout = dfsClient.getDatanodeReadTimeout(nodes.length);
-        InputStream unbufIn = NetUtils.getInputStream(s);
+        InputStream unbufIn = NetUtils.getInputStream(s, readTimeout);

INS60 INS83 INS39 INS59 INS42 INS32 INS60 INS42 INS42 INS34 INS42 INS39 INS59 INS42 INS32 INS42 INS42 INS40 INS42