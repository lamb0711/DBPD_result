MAPREDUCE-3050. Add ability to get resource usage information for applications and nodes. Contributed by Robert Evans.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1177859 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.yarn.server.resourcemanager.scheduler.QueueMetrics;
+import org.apache.hadoop.yarn.server.resourcemanager.scheduler.SchedulerAppReport;
+  @Override
+  public QueueMetrics getRootQueueMetrics() {
+    return root.getMetrics();
+  }
+
-
+  
-  public synchronized Resource getUsedResource(NodeId nodeId) {
-    return nodes.get(nodeId).getUsedResource();
-  }
-
-  public synchronized Resource getAvailableResource(NodeId nodeId) {
-    return nodes.get(nodeId).getAvailableResource();
-  }
-
-    for (RMContainer rmContainer : application.getAllReservedContainers()) {
+    for (RMContainer rmContainer : application.getReservedContainers()) {
+  @Override
+  public SchedulerAppReport getSchedulerAppInfo(
+      ApplicationAttemptId applicationAttemptId) {
+    SchedulerApp app = getApplication(applicationAttemptId);
+    return app == null ? null : new SchedulerAppReport(app);
+  }
+  
-    return new SchedulerNodeReport(
-        node.getUsedResource(), node.getNumContainers());
+    return node == null ? null : new SchedulerNodeReport(node);

INS26 INS26 MOV31 MOV31 INS40 INS40 INS78 UPD43 UPD42 INS78 UPD43 UPD42 INS42 UPD42 INS42 UPD42 UPD43 UPD42 INS60 INS41 UPD42 INS43 INS59 INS16 INS16 UPD42 MOV42 UPD42 UPD42 INS42 INS42 INS32 INS27 INS33 INS14 INS27 INS33 INS14 UPD42 MOV42 UPD42 MOV42 INS42 INS33 INS43 INS42 INS42 INS33 MOV43 INS42 INS42 DEL83 DEL42 DEL43 DEL42 DEL44 DEL42 DEL42 DEL32 DEL83 DEL42 DEL32 DEL42 DEL32 DEL41 DEL42 DEL42 DEL32 DEL42 DEL42 DEL32 DEL14