HDDS-1072. Implement RetryProxy and FailoverProxy for OM client.

+
+import com.google.protobuf.ServiceException;
+
-  private final String omID;
+  private final String omNodeID;
-  private OzoneManagerRatisClient(String omId, RaftGroup raftGroup,
+  private OzoneManagerRatisClient(String omNodeId, RaftGroup raftGroup,
-    this.omID = omId;
+    this.omNodeID = omNodeId;
-      String omId, RaftGroup raftGroup, Configuration conf) {
+      String omNodeId, RaftGroup raftGroup, Configuration conf) {
-    return new OzoneManagerRatisClient(omId, raftGroup,
+    return new OzoneManagerRatisClient(omNodeId, raftGroup,
-        raftGroup.getGroupId().getUuid().toString(), omID);
+        raftGroup.getGroupId().getUuid().toString(), omNodeID);
-    raftClient = OMRatisHelper.newRaftClient(rpcType, omID, raftGroup,
+    raftClient = OMRatisHelper.newRaftClient(rpcType, omNodeID, raftGroup,
-  public OMResponse sendCommand(OMRequest request) {
+  public OMResponse sendCommand(OMRequest request) throws ServiceException {
-      LOG.error("Failed to execute command: " + request, e);
-      return OMRatisHelper.getErrorResponse(request.getCmdType(), e);
+      throw new ServiceException(e);
+
-                    .convertByteStringToOMResponse(reply.getMessage()
-                        .getContent());
+                    .getOMResponseFromRaftClientReply(reply);
+

INS26 INS40 INS43 UPD42 UPD42 UPD42 INS42 UPD42 UPD42 UPD42 UPD42 UPD42 INS53 INS14 INS43 INS42 INS42 UPD42 MOV42 DEL42 DEL42 DEL45 DEL42 DEL27 DEL42 DEL32 DEL21 DEL42 DEL42 DEL42 DEL42 DEL32 DEL42 DEL32 DEL41 DEL42 DEL32 DEL42 DEL32