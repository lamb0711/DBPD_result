HDFS-10715. NPE when applying AvailableSpaceBlockPlacementPolicy. Contributed by Guangbin Zhu.

-    int ret = compareDataNode(a, b);
-    if (ret == 0) {
-      return a;
-    } else if (ret < 0) {
-      return (RAND.nextInt(100) < balancedPreference) ? a : b;
+    if (a != null && b != null){
+      int ret = compareDataNode(a, b);
+      if (ret == 0) {
+        return a;
+      } else if (ret < 0) {
+        return (RAND.nextInt(100) < balancedPreference) ? a : b;
+      } else {
+        return (RAND.nextInt(100) < balancedPreference) ? b : a;
+      }
-      return (RAND.nextInt(100) < balancedPreference) ? b : a;
+      return a == null ? b : a;

INS25 INS27 INS8 INS8 INS27 INS27 MOV60 MOV25 INS41 INS42 INS33 INS42 INS33 INS16 INS27 INS42 INS42 INS42 INS33