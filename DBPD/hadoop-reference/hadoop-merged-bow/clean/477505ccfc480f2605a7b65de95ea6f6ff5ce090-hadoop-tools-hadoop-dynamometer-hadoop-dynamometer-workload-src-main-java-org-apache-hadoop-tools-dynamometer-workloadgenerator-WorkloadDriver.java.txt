HDFS-14824. [Dynamometer] Dynamometer in org.apache.hadoop.tools does not output the benchmark results. (#1685)



-import org.apache.hadoop.io.NullWritable;
-import org.apache.hadoop.mapreduce.lib.output.NullOutputFormat;
-    Class<? extends WorkloadMapper<?, ?>> mapperClass = getMapperClass(
+    Class<? extends WorkloadMapper<?, ?, ?, ?>> mapperClass = getMapperClass(
-      long startTimestampMs, Class<? extends WorkloadMapper<?, ?>> mapperClass)
-      throws IOException, InstantiationException, IllegalAccessException {
+      long startTimestampMs, Class<? extends WorkloadMapper<?, ?, ?, ?>>
+      mapperClass) throws IOException, InstantiationException,
+      IllegalAccessException {
-    job.setOutputFormatClass(NullOutputFormat.class);
-    job.setInputFormatClass(mapperClass.newInstance().getInputFormat(conf));
-    job.setOutputFormatClass(NullOutputFormat.class);
-    job.setNumReduceTasks(0);
-    job.setMapOutputKeyClass(NullWritable.class);
-    job.setMapOutputValueClass(NullWritable.class);
-    job.setOutputKeyClass(NullWritable.class);
-    job.setOutputValueClass(NullWritable.class);
+    mapperClass.newInstance().configureJob(job);
-  private Class<? extends WorkloadMapper<?, ?>> getMapperClass(String className)
-      throws ClassNotFoundException {
+  private Class<? extends WorkloadMapper<?, ?, ?, ?>> getMapperClass(
+      String className) throws ClassNotFoundException {
-    return (Class<? extends WorkloadMapper<?, ?>>) mapperClass;
+    return (Class<? extends WorkloadMapper<?, ?, ?, ?>>) mapperClass;
-    WorkloadMapper<?, ?> mapper = getMapperClass(mapperClassName).newInstance();
+    WorkloadMapper<?, ?, ?, ?> mapper = getMapperClass(mapperClassName)
+        .newInstance();

UPD74 UPD74 MOV43 UPD76 UPD74 UPD76 MOV32 UPD74 UPD74 UPD76 UPD74 UPD42 UPD42 MOV43 INS76 INS76 UPD74 MOV43 INS76 INS76 UPD74 INS76 INS76 MOV43 UPD76 INS76 INS76 UPD74 MOV43 INS76 INS76 DEL40 DEL26 DEL40 DEL26 DEL42 DEL42 DEL42 DEL43 DEL57 DEL32 DEL21 DEL42 DEL42 DEL32 DEL42 DEL42 DEL42 DEL43 DEL57 DEL32 DEL21 DEL42 DEL42 DEL34 DEL32 DEL21 DEL42 DEL42 DEL42 DEL43 DEL57 DEL32 DEL21 DEL42 DEL42 DEL42 DEL43 DEL57 DEL32 DEL21 DEL42 DEL42 DEL42 DEL43 DEL57 DEL32 DEL21 DEL42 DEL42 DEL42 DEL43 DEL57 DEL32 DEL21