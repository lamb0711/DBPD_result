HDFS-12609. Ozone: SCM: Refactoring of chill mode logic in NodeManager. Contributed by Nandakumar.

-   * Reports if we have exited out of chill mode.
-   *
-   * @return true if we are out of chill mode.
-   */
-  @Override
-  public boolean isOutOfNodeChillMode() {
-    return !inStartupChillMode.get() && !inManualChillMode.get();
-  }
-
-  /**
-   * Clears the manual chill mode.
-   */
-  @Override
-  public void clearChillModeFlag() {
-    LOG.info("Clearing manual chill mode flag.");
-    this.inManualChillMode.getAndSet(false);
-  }
-
-  /**
-      return "Still in chill mode, waiting on nodes to report in."
-          + getNodeStatus();
+      return "Still in chill mode, waiting on nodes to report in." +
+          String.format(" %d nodes reported, minimal %d nodes required.",
+              totalNodes.get(), getMinimumChillModeNodes());
-          getNodeStatus();
+          String.format(" %d nodes have reported in.", totalNodes.get());
-    return "Out of chill mode." + getNodeStatus();
-  }
-
-  /**
-   * Returns a node status string.
-   * @return - String
-   */
-  private String getNodeStatus() {
-    return isOutOfNodeChillMode() ?
-        String.format(" %d nodes have reported in.", totalNodes.get()) :
-        String.format(" %d nodes reported, minimal %d nodes required.",
-            totalNodes.get(), getMinimumChillModeNodes());
-  }
-
-  /**
-   * Returns the status of Manual chill Mode flag.
-   *
-   * @return true if forceEnterChillMode has been called, false if
-   * forceExitChillMode or status is not set. eg. clearChillModeFlag.
-   */
-  @Override
-  public boolean isInManualChillMode() {
-    return inManualChillMode.get();
+    return "Out of chill mode." +
+        String.format(" %d nodes have reported in.", totalNodes.get());
-      inStartupChillMode.getAndSet(false);
+      inStartupChillMode.set(false);
-      inManualChillMode.getAndSet(false);
+      inManualChillMode.set(false);
-   * Forcefully enters chill mode, even if all chill mode conditions are met.
+   * Puts the node manager into manual chill mode.
-  public void forceEnterChillMode() {
+  public void enterChillMode() {
-    inManualChillMode.getAndSet(true);
+    inManualChillMode.set(true);
+  }
+
+  /**
+   * Brings node manager out of manual chill mode.
+   */
+  @Override
+  public void exitChillMode() {
+    LOG.info("Leaving manual chill mode.");
+    inManualChillMode.set(false);
+  }
+
+  /**
+   * Returns true if node manager is out of chill mode, else false.
+   * @return true if out of chill mode, else false
+   */
+  @Override
+  public boolean isOutOfChillMode() {
+    return !(inStartupChillMode.get() || inManualChillMode.get());

MOV31 MOV31 MOV29 MOV78 UPD83 UPD42 INS8 UPD42 MOV78 INS42 MOV8 MOV78 UPD42 INS25 INS25 INS41 MOV32 MOV8 MOV32 INS8 INS27 MOV32 INS8 UPD66 UPD66 UPD66 UPD66 INS38 INS41 INS45 MOV32 INS21 INS21 UPD42 UPD42 INS36 INS27 INS27 INS32 INS32 INS27 INS45 MOV32 INS45 INS32 UPD42 INS42 INS42 INS45 INS42 INS42 INS9 MOV32 MOV32 INS42 INS42 INS45 INS32 INS42 INS42 DEL66 DEL65 DEL66 DEL65 DEL29 DEL42 DEL78 DEL83 DEL39 DEL42 DEL38 DEL38 DEL27 DEL41 DEL8 DEL31 DEL83 DEL42 DEL43 DEL42 DEL45 DEL42 DEL32 DEL27 DEL41 DEL8 DEL25 DEL45 DEL42 DEL32 DEL27 DEL41 DEL8 DEL25 DEL45 DEL42 DEL32 DEL27 DEL41 DEL8 DEL31 DEL66 DEL65 DEL66 DEL65 DEL29 DEL42 DEL32 DEL16 DEL42 DEL42 DEL42 DEL45 DEL32 DEL21 DEL52 DEL42 DEL22 DEL42 DEL9 DEL32 DEL21 DEL8 DEL66 DEL42 DEL42 DEL32