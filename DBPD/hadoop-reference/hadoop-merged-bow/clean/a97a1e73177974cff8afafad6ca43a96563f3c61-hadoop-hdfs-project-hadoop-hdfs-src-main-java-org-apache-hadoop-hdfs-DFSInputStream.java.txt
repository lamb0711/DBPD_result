HDFS-7494. Checking of closed in DFSInputStream#pread() should be protected by synchronization (Ted Yu via Colin P. McCabe)

+import java.util.concurrent.atomic.AtomicBoolean;
-  private boolean closed = false;
+  private AtomicBoolean closed = new AtomicBoolean(false);
-    if (closed) {
+    if (!closed.compareAndSet(false, true)) {
+      DFSClient.LOG.warn("DFSInputStream has been closed already");
-    closed = true;
-    if (closed) {
+    if (closed.get()) {
-    if (closed) {
+    if (closed.get()) {
-    if (closed) {
+    if (closed.get()) {
-    if (closed) {
+    if (closed.get()) {

INS26 INS40 INS43 INS42 INS14 INS25 INS43 INS9 INS38 INS8 INS32 INS32 INS32 INS32 INS42 INS32 INS21 INS41 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS9 INS9 INS32 INS40 INS42 INS45 DEL39 DEL9 DEL42 DEL41 DEL8 DEL25 DEL42 DEL9 DEL7 DEL21 DEL42 DEL42 DEL42 DEL42