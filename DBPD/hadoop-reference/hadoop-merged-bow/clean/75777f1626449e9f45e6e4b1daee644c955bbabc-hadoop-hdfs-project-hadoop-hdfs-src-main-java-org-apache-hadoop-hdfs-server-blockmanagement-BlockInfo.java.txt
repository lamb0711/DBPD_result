HDFS-5470. Add back trunk's reportDiff algorithm to the branch.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2832@1539504 13f79535-47bb-0310-9956-ffa450edef68

+   * Remove this block from the list of blocks related to the specified
+   * DatanodeDescriptor. Insert it into the head of the list of blocks.
+   *
+   * @return the new head of the list.
+   */
+  public BlockInfo moveBlockToHead(BlockInfo head, DatanodeStorageInfo storage,
+      int curIndex, int headIndex) {
+    if (head == this) {
+      return this;
+    }
+    BlockInfo next = this.setNext(curIndex, head);
+    BlockInfo prev = this.setPrevious(curIndex, null);
+
+    head.setPrevious(headIndex, this);
+    prev.setNext(prev.findStorageInfo(storage), next);
+    if (next != null)
+      next.setPrevious(next.findStorageInfo(storage), prev);
+    return this;
+  }
+
+  /**

INS31 INS29 INS83 INS43 INS42 INS44 INS44 INS44 INS44 INS8 INS65 INS65 INS42 INS43 INS42 INS43 INS42 INS39 INS42 INS39 INS42 INS25 INS60 INS60 INS21 INS21 INS25 INS41 INS66 INS66 INS66 INS42 INS42 INS27 INS8 INS43 INS59 INS43 INS59 INS32 INS32 INS27 INS21 INS52 INS42 INS52 INS41 INS42 INS42 INS32 INS42 INS42 INS32 INS42 INS42 INS42 INS52 INS42 INS42 INS32 INS42 INS42 INS33 INS32 INS52 INS52 INS42 INS42 INS42 INS52 INS42 INS42 INS33 INS42 INS42 INS42 INS42 INS42 INS32 INS42 INS42 INS42 INS42