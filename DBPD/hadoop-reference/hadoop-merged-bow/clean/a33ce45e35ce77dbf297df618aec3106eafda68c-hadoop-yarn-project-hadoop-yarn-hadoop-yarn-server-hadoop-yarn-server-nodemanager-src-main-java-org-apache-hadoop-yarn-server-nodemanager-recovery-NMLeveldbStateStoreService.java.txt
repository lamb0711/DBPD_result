YARN-5547. NMLeveldbStateStore should be more tolerant of unknown keys. Contributed by Ajith S

+import com.google.common.collect.ArrayListMultimap;
+import com.google.common.collect.ListMultimap;
+  /**
+   * Map of containerID vs List of unknown key suffixes.
+   */
+  private ListMultimap<ContainerId, String> containerUnknownKeySuffixes =
+      ArrayListMultimap.create();
+
-        throw new IOException("Unexpected container state key: " + key);
+        LOG.warn("the container " + containerId
+            + " will be killed because of the unknown key " + key
+            + " during recovery.");
+        containerUnknownKeySuffixes.put(containerId, suffix);
+        rcs.setRecoveryType(RecoveredContainerType.KILL);
+        List<String> unknownKeysForContainer = containerUnknownKeySuffixes
+            .removeAll(containerId);
+        for (String unknownKeySuffix : unknownKeysForContainer) {
+          batch.delete(bytes(keyPrefix + unknownKeySuffix));
+        }

INS26 INS26 INS40 INS40 INS23 INS29 INS83 INS74 INS59 INS65 INS43 INS43 INS43 INS42 INS32 INS66 INS42 INS42 INS42 INS42 INS42 INS60 INS70 INS74 INS59 INS44 INS42 INS8 INS43 INS43 INS42 INS32 INS43 INS42 INS21 INS42 INS42 INS42 INS42 INS42 INS42 INS32 INS42 INS42 INS32 INS42 INS27 INS42 INS42 INS21 INS21 INS21 INS32 INS32 INS32 INS42 INS42 INS27 INS42 INS42 INS42 INS42 INS42 INS42 INS40 UPD45 MOV45 INS42 INS45 MOV42 INS45 DEL42 DEL43 DEL27 DEL14 DEL53