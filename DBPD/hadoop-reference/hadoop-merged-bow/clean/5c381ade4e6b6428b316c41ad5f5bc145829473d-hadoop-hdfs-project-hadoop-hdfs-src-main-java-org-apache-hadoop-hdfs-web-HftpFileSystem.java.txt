HDFS-5339. WebHDFS URI does not accept logical nameservices when security is enabled. Contributed by Haohui Mai.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1573026 13f79535-47bb-0310-9956-ffa450edef68

-  protected TokenAspect<HftpFileSystem> tokenAspect;
+  protected TokenAspect<? extends HftpFileSystem> tokenAspect;
+  protected Text tokenServiceName;
-  protected void initTokenAspect(Configuration conf)
-      throws IOException {
-    tokenAspect = new TokenAspect<HftpFileSystem>(this, TOKEN_KIND);
+  protected void initTokenAspect() {
+    tokenAspect = new TokenAspect<HftpFileSystem>(this, tokenServiceName, TOKEN_KIND);
+    this.tokenServiceName = SecurityUtil.buildTokenService(nnUri);
-    initTokenAspect(conf);
+    initTokenAspect();

INS23 UPD74 INS83 INS43 INS59 MOV54 INS76 INS42 INS42 INS21 INS43 INS7 INS32 MOV42 INS22 INS32 INS42 INS42 INS52 INS42 INS42 UPD42 MOV42 UPD42 MOV42 DEL43 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL32