HADOOP-13483. File create should throw error rather than overwrite directories. Contributed by Genmao Yu.

+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
+  private static final Logger LOG =
+      LoggerFactory.getLogger(AliyunOSSFileSystem.class);
+    FileStatus status = null;
-    if (!overwrite && exists(path)) {
-      throw new FileAlreadyExistsException(path + " already exists");
+    try {
+      // get the status or throw a FNFE
+      status = getFileStatus(path);
+
+      // if the thread reaches here, there is something at the path
+      if (status.isDirectory()) {
+        // path references a directory
+        throw new FileAlreadyExistsException(path + " is a directory");
+      }
+      if (!overwrite) {
+        // path references a file and overwrite is disabled
+        throw new FileAlreadyExistsException(path + " already exists");
+      }
+      LOG.debug("Overwriting file {}", path);
+    } catch (FileNotFoundException e) {
+      // this means the file is not found
-   * @param bucketName the bucket this directory belongs to
+   * @param bucket the bucket this directory belongs to

INS26 INS26 INS40 INS40 INS23 INS83 INS83 INS83 INS43 INS59 INS42 INS42 INS32 INS60 INS54 INS42 INS42 INS57 INS43 INS59 INS8 INS12 UPD42 INS43 INS42 INS42 INS33 INS21 INS25 MOV25 INS21 INS44 INS8 INS42 INS7 INS32 INS8 MOV38 INS32 INS43 INS42 INS42 INS32 INS42 INS42 INS53 INS42 INS42 INS45 INS42 INS42 INS42 INS42 INS14 INS43 INS27 INS42 INS42 INS45 DEL42 DEL42 DEL32 DEL27