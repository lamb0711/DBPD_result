HDFS-13097: [SPS]: Fix the branch review comments(Part1). Contributed by Surendra Singh.

+import java.util.Arrays;
-      if (inodeHasSatisfyXAttr(inode)) {
-        throw new IOException(
-            "Cannot request to call satisfy storage policy on path "
+      if (inode.isFile() && inode.asFile().numBlocks() == 0) {
+        if (NameNode.LOG.isInfoEnabled()) {
+          NameNode.LOG.info(
+              "Skipping satisfy storage policy on path:{} as "
+                  + "this file doesn't have any blocks!",
+              inode.getFullPathName());
+        }
+      } else if (inodeHasSatisfyXAttr(inode)) {
+        NameNode.LOG
+            .warn("Cannot request to call satisfy storage policy on path: "
-      }
-      if (unprotectedSatisfyStoragePolicy(inode, fsd)) {
+      } else {
-        List<XAttr> xAttrs = Lists.newArrayListWithCapacity(1);
-        xAttrs.add(satisfyXAttr);
+        List<XAttr> xAttrs = Arrays.asList(satisfyXAttr);
+
+        // Adding directory in the pending queue, so FileInodeIdCollector
+        // process directory child in batch and recursively
+        fsd.getBlockManager().getSPSManager().addPathId(inode.getId());
-      fsd.getBlockManager().addSPSPathId(inode.getId());
+      fsd.getBlockManager().getSPSManager().addPathId(inode.getId());

INS26 INS40 INS25 INS27 INS8 MOV25 INS32 INS27 MOV25 MOV32 MOV8 MOV21 INS32 UPD42 INS42 INS42 INS32 INS34 INS32 INS8 INS21 MOV32 INS42 INS32 INS42 INS40 INS42 INS21 INS32 INS42 INS42 INS32 INS40 INS42 MOV27 INS32 UPD42 INS32 INS40 INS42 INS27 INS32 UPD45 INS42 UPD42 UPD42 INS32 INS42 UPD42 MOV42 INS42 INS45 INS45 INS42 INS42 UPD42 MOV42 INS42 DEL42 DEL43 DEL14 DEL53 DEL42 DEL42 DEL42 DEL32 DEL34