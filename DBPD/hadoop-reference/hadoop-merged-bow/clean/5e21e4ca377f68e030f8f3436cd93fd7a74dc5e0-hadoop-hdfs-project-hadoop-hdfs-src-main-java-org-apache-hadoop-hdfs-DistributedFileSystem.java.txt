HDFS-6353. Check and make checkpoint before stopping the NameNode. Contributed by Jing Zhao.

+import org.apache.hadoop.hdfs.protocol.ClientProtocol;
-   * 
-   * @see org.apache.hadoop.hdfs.protocol.ClientProtocol#saveNamespace()
+   *
+   * @param timeWindow NameNode can ignore this command if the latest
+   *                   checkpoint was done within the given time period (in
+   *                   seconds).
+   * @return true if a new checkpoint has been made
+   * @see ClientProtocol#saveNamespace(long, long)
-  public void saveNamespace() throws AccessControlException, IOException {
-    dfs.saveNamespace();
+  public boolean saveNamespace(long timeWindow, long txGap) throws IOException {
+    return dfs.saveNamespace(timeWindow, txGap);
-  
+
+  /**
+   * Save namespace image. NameNode always does the checkpoint.
+   */
+  public void saveNamespace() throws IOException {
+    saveNamespace(0, 0);
+  }
+

INS26 INS40 INS31 INS31 MOV29 MOV83 INS39 INS42 INS44 INS44 MOV43 INS8 INS29 INS83 MOV39 MOV42 UPD43 MOV43 MOV8 INS65 INS65 INS39 INS42 INS39 INS42 INS41 INS65 UPD42 INS42 INS66 INS66 INS66 INS66 INS32 INS66 INS42 INS69 INS69 INS42 INS42 INS42 INS42 INS34 INS34 INS39 INS39 DEL40 DEL42 DEL31