HDFS-6353. Check and make checkpoint before stopping the NameNode. Contributed by Jing Zhao.

-  private static final SaveNamespaceResponseProto VOID_SAVENAMESPACE_RESPONSE = 
-  SaveNamespaceResponseProto.newBuilder().build();
-
-  private static final RefreshNodesResponseProto VOID_REFRESHNODES_RESPONSE = 
+  private static final RefreshNodesResponseProto VOID_REFRESHNODES_RESPONSE =
-      server.saveNamespace();
-      return VOID_SAVENAMESPACE_RESPONSE;
+      final long timeWindow = req.hasTimeWindow() ? req.getTimeWindow() : 0;
+      final long txGap = req.hasTxGap() ? req.getTxGap() : 0;
+      boolean saved = server.saveNamespace(timeWindow, txGap);
+      return SaveNamespaceResponseProto.newBuilder().setSaved(saved).build();
-
-  
+

INS60 INS60 INS60 INS83 INS39 INS59 INS83 INS39 INS59 INS39 INS59 INS32 INS42 INS16 INS42 INS16 INS42 INS32 MOV32 INS42 INS32 INS32 INS34 INS32 INS32 INS34 MOV42 MOV42 INS42 INS42 INS42 UPD42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 DEL83 DEL83 DEL83 DEL42 DEL43 DEL42 DEL59 DEL23 DEL32 DEL21 DEL42