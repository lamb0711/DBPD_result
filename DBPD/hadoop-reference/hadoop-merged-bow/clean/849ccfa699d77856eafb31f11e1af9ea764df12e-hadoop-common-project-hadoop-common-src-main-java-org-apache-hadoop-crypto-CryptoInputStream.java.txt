Merge branch 'trunk' into HDFS-6581

-      return n;
+      
+      if (n >= 0) {
+        return unread + n;
+      } else {
+        if (unread == 0) {
+          return -1;
+        } else {
+          return unread;
+        }
+      }

INS25 INS27 INS8 INS8 INS42 INS34 MOV41 INS25 INS27 INS27 INS8 INS8 INS42 INS42 INS42 INS34 INS41 INS41 INS38 INS42 INS34 DEL42