HDFS-3190. Simple refactors in existing NN code to assist QuorumJournalManager extension. Contributed by Todd Lipcon.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1356525 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.hdfs.server.common.StorageErrorReporter;
-  private final NNStorage storage;
+  private final StorageErrorReporter errorReporter;
-  public FileJournalManager(StorageDirectory sd, NNStorage storage) {
+  public FileJournalManager(StorageDirectory sd,
+      StorageErrorReporter errorReporter) {
-    this.storage = storage;
+    this.errorReporter = errorReporter;
-      storage.reportErrorsOnDirectory(sd);
+      LOG.warn("Unable to start log segment " + txid +
+          " at " + currentInProgress + ": " +
+          e.getLocalizedMessage());
+      errorReporter.reportErrorOnFile(currentInProgress);
-      storage.reportErrorsOnDirectory(sd);
+      errorReporter.reportErrorOnFile(dstFile);

INS26 INS40 UPD43 UPD42 UPD42 UPD43 UPD42 UPD42 UPD42 UPD42 INS21 INS32 UPD42 UPD42 UPD42 INS42 INS42 INS27 UPD42 UPD42 UPD42 INS45 INS42 INS45 INS42 INS45 INS32 INS42 INS42