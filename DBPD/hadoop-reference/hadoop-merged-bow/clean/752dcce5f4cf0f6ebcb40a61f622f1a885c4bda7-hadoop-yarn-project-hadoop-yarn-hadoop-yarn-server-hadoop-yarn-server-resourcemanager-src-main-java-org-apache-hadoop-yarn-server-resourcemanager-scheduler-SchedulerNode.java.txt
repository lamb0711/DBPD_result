YARN-8511. When AM releases a container, RM removes allocation tags before it is released by NM. (Weiwei Yang via wangda)

Change-Id: I6f9f409f2ef685b405cbff547dea9623bf3322d9

+import org.apache.hadoop.yarn.server.resourcemanager.RMContext;
+  private final RMContext rmContext;
+    this.rmContext = node.getRMContext();
+
+    // We remove allocation tags when a container is actually
+    // released on NM. This is to avoid running into situation
+    // when AM releases a container and NM has some delay to
+    // actually release it, then the tag can still be visible
+    // at RM so that RM can respect it during scheduling new containers.
+    if (rmContext != null && rmContext.getAllocationTagsManager() != null) {
+      rmContext.getAllocationTagsManager()
+          .removeContainer(container.getNodeId(),
+              container.getId(), container.getAllocationTags());
+    }
+

INS26 INS40 INS23 INS83 INS83 INS43 INS59 INS42 INS42 INS21 INS25 INS7 INS27 INS8 INS22 INS32 INS27 INS27 INS21 INS52 INS42 INS42 INS42 INS42 INS33 INS32 INS33 INS32 INS42 INS42 INS32 INS42 INS32 INS32 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42