YARN-4095. Avoid sharing AllocatorPerContext object in LocalDirAllocator between ShuffleHandler and LocalDirsHandlerService. Contributed by Zhihai Xu

+import org.apache.hadoop.classification.InterfaceAudience.Private;
+  /**
+   * Good local directories, use internally,
+   * initial value is the same as NM_LOCAL_DIRS.
+   */
+  @Private
+  static final String NM_GOOD_LOCAL_DIRS =
+      YarnConfiguration.NM_PREFIX + "good-local-dirs";
+
+  /**
+   * Good log directories, use internally,
+   * initial value is the same as NM_LOG_DIRS.
+   */
+  @Private
+  static final String NM_GOOD_LOG_DIRS =
+      YarnConfiguration.NM_PREFIX + "good-log-dirs";
+
+
+      String local = conf.get(YarnConfiguration.NM_LOCAL_DIRS);
+      conf.set(NM_GOOD_LOCAL_DIRS,
+          (local != null) ? local : "");
-          YarnConfiguration.NM_LOCAL_DIRS);
-      logDirsAllocator = new LocalDirAllocator(YarnConfiguration.NM_LOG_DIRS);
+          NM_GOOD_LOCAL_DIRS);
+      String log = conf.get(YarnConfiguration.NM_LOG_DIRS);
+      conf.set(NM_GOOD_LOG_DIRS,
+          (log != null) ? log : "");
+      logDirsAllocator = new LocalDirAllocator(
+          NM_GOOD_LOG_DIRS);
-    conf.setStrings(YarnConfiguration.NM_LOCAL_DIRS,
+    conf.setStrings(NM_GOOD_LOCAL_DIRS,
-    conf.setStrings(YarnConfiguration.NM_LOG_DIRS,
+    conf.setStrings(NM_GOOD_LOG_DIRS,

INS26 INS40 INS23 INS23 INS29 INS78 INS83 INS83 INS43 INS59 INS29 INS78 INS83 INS83 INS43 INS59 INS65 INS42 INS42 INS42 INS27 INS65 INS42 INS42 INS42 INS27 MOV21 INS66 INS66 INS40 INS45 INS66 INS66 INS40 INS45 INS60 INS21 INS60 INS21 INS43 INS59 INS32 INS43 INS59 INS32 INS42 INS42 INS42 INS42 INS32 INS42 INS42 INS42 INS16 UPD42 INS42 INS42 INS32 INS42 INS42 INS42 INS16 UPD42 INS42 INS42 INS40 INS36 INS42 INS45 INS42 INS42 INS42 INS40 INS36 INS42 INS45 INS42 INS27 INS27 INS42 INS33 INS42 INS33 DEL40 DEL40 DEL40 DEL40