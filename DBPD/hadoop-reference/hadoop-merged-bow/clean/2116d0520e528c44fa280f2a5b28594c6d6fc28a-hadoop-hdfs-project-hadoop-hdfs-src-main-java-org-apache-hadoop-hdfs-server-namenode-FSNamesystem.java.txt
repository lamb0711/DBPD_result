HDFS-4148. Disallow write/modify operations on files and directories in a snapshot. Contributed by Brandon Li.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1409023 13f79535-47bb-0310-9956-ffa450edef68

-    final INodeFile trgInode = INodeFile.valueOf(dir.getINode(target), target);
+    final INodeFile trgInode = INodeFile.valueOf(dir.getMutableINode(target),
+        target);
-      final INodeFile srcInode = INodeFile.valueOf(dir.getINode(src), src);
+      final INodeFile srcInode = INodeFile.valueOf(dir.getMutableINode(src), src);
-      INode inode = dir.getINode(src);
+      INode inode = dir.getMutableINode(src);
-    boolean pathExists = dir.exists(src);
+    boolean pathExists = dir.existsMutable(src);
-    if (dir.isDir(src)) {
+    if (dir.isDirMutable(src)) {

UPD42 UPD42 UPD42 UPD42 UPD42