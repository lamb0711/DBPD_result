YARN-986. Changed client side to be able to figure out the right RM Delegation token for the right ResourceManager when HA is enabled. Contributed by Karthik Kambatla.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1574190 13f79535-47bb-0310-9956-ffa450edef68

-import java.net.InetSocketAddress;
+import org.apache.hadoop.yarn.client.ClientRMProxy;
-  private InetSocketAddress rmAddress;
+  private Text rmDTService;
-    this.rmAddress = conf.getSocketAddr(YarnConfiguration.RM_ADDRESS,
-          YarnConfiguration.DEFAULT_RM_ADDRESS,
-          YarnConfiguration.DEFAULT_RM_PORT);
-  InetSocketAddress getConnectAddress() {
-    return rmAddress;
+  public Text getRMDelegationTokenService() {
+    if (rmDTService == null) {
+      rmDTService = ClientRMProxy.getRMDelegationTokenService(conf);
+    }
+    return rmDTService;
-          client.getRMDelegationToken(renewer), rmAddress);
+          client.getRMDelegationToken(renewer), getRMDelegationTokenService());

MOV26 UPD40 UPD43 INS83 UPD43 UPD42 UPD42 UPD42 UPD42 INS25 INS27 INS8 UPD42 INS42 INS33 INS21 INS7 INS42 INS32 INS32 INS42 INS42 INS42 UPD42 MOV42 DEL52 DEL42 DEL22 DEL42 DEL42 DEL40 DEL40 DEL40 DEL32 DEL7 DEL21