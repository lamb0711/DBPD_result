YARN-3853. Add docker container runtime support to LinuxContainterExecutor. Contributed by Sidharta Seethana.

+import com.google.common.annotations.VisibleForTesting;
-    fullCommand.add(operation.getOperationType().getOption());
+
+    String cliSwitch = operation.getOperationType().getOption();
+
+    if (!cliSwitch.isEmpty()) {
+      fullCommand.add(cliSwitch);
+    }
+
+        LOG.debug("command array:");
+        LOG.debug(Arrays.toString(fullCommandArray));
-      throw new PrivilegedOperationException(e);
+
+      //stderr from shell executor seems to be stuffed into the exception
+      //'message' - so, we have to extract it and set it as the error out
+      throw new PrivilegedOperationException(e, e.getExitCode(),
+          exec.getOutput(), e.getMessage());
-    boolean noneArgsOnly = true;
+    boolean noTasks = true;
-      if (tasksFile.equals("none")) {
+      if (tasksFile.equals(PrivilegedOperation.CGROUP_ARG_NO_TASKS)) {
-      if (noneArgsOnly == false) {
+      if (noTasks == false) {
-        noneArgsOnly = false;
+        noTasks = false;
-    if (noneArgsOnly) {
-      finalOpArg.append("none"); //there were no tasks file to append
+    if (noTasks) {
+      finalOpArg.append(PrivilegedOperation.CGROUP_ARG_NO_TASKS); //there
+      // were no tasks file to append

INS26 INS40 INS60 INS25 INS43 INS59 INS38 INS8 UPD42 INS42 INS42 MOV32 INS32 MOV21 UPD42 INS42 INS42 INS42 INS21 INS21 INS40 UPD42 INS40 INS32 INS32 INS32 INS32 INS32 INS42 INS42 INS45 INS42 INS42 INS32 INS42 INS42 INS42 INS42 INS42 INS42 UPD42 INS42 INS42 INS42 DEL45 DEL45