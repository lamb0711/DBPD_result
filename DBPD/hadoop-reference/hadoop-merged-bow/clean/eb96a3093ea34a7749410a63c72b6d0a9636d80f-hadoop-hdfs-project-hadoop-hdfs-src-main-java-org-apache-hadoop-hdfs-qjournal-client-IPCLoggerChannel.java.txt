HDFS-14655. [SBN Read] Namenode crashes if one of The JN is down. Contributed by Ayush Saxena.

+import java.util.concurrent.LinkedBlockingQueue;
+import org.apache.hadoop.util.concurrent.HadoopThreadPoolExecutor;
-    return Executors.newCachedThreadPool(
-        new ThreadFactoryBuilder()
-            .setDaemon(true)
+    int numThreads =
+        conf.getInt(DFSConfigKeys.DFS_QJOURNAL_PARALLEL_READ_NUM_THREADS_KEY,
+            DFSConfigKeys.DFS_QJOURNAL_PARALLEL_READ_NUM_THREADS_DEFAULT);
+    return new HadoopThreadPoolExecutor(1, numThreads, 60L,
+        TimeUnit.SECONDS, new LinkedBlockingQueue<>(),
+        new ThreadFactoryBuilder().setDaemon(true)
-            .setUncaughtExceptionHandler(
-                UncaughtExceptionHandlers.systemExit())
+            .setUncaughtExceptionHandler(UncaughtExceptionHandlers.systemExit())

INS26 INS26 INS40 INS40 INS60 INS39 INS59 INS14 INS42 INS32 INS43 INS34 INS42 INS34 INS40 INS14 MOV32 INS42 INS42 INS40 INS40 INS42 INS74 INS43 INS42 DEL42 DEL42 DEL32