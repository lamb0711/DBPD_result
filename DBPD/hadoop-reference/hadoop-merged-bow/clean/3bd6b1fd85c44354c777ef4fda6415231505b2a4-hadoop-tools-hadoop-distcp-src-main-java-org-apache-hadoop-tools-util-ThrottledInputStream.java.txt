HADOOP-15292. Distcp's use of pread is slowing it down.
Contributed by Virajith Jalaparti.

-import org.apache.hadoop.fs.PositionedReadable;
+import org.apache.hadoop.fs.Seekable;
-public class ThrottledInputStream extends InputStream {
+public class ThrottledInputStream extends InputStream implements Seekable {
-  /**
-   * Read bytes starting from the specified position. This requires rawStream is
-   * an instance of {@link PositionedReadable}.
-   */
-  public int read(long position, byte[] buffer, int offset, int length)
-      throws IOException {
-    if (!(rawStream instanceof PositionedReadable)) {
-      throw new UnsupportedOperationException(
-          "positioned read is not supported by the internal stream");
-    }
-    throttle();
-    int readLen = ((PositionedReadable) rawStream).read(position, buffer,
-        offset, length);
-    if (readLen != -1) {
-      bytesRead += readLen;
-    }
-    return readLen;
-  }
-
+
+  private void checkSeekable() throws IOException {
+    if (!(rawStream instanceof Seekable)) {
+      throw new UnsupportedOperationException(
+          "seek operations are unsupported by the internal stream");
+    }
+  }
+
+  @Override
+  public void seek(long pos) throws IOException {
+    checkSeekable();
+    ((Seekable) rawStream).seek(pos);
+  }
+
+  @Override
+  public long getPos() throws IOException {
+    checkSeekable();
+    return ((Seekable) rawStream).getPos();
+  }
+
+  @Override
+  public boolean seekToNewSource(long targetPos) throws IOException {
+    checkSeekable();
+    return ((Seekable) rawStream).seekToNewSource(targetPos);
+  }

UPD40 INS43 INS31 INS31 INS31 INS31 INS42 INS83 INS39 INS42 MOV43 MOV8 INS78 MOV83 UPD39 MOV39 UPD42 MOV42 MOV44 INS43 INS8 INS78 INS83 INS39 INS42 INS43 INS8 INS78 INS83 INS39 INS42 MOV44 INS43 INS8 INS42 UPD42 INS42 INS21 INS21 INS42 INS42 INS21 INS41 INS42 UPD39 UPD42 INS42 INS21 INS41 INS32 INS32 INS32 INS32 INS32 INS32 INS42 INS36 INS42 INS42 INS42 INS36 INS42 INS42 INS36 INS42 INS42 INS11 INS11 INS11 UPD43 UPD45 INS43 INS42 INS43 INS42 INS43 INS42 UPD42 INS42 INS42 INS42 DEL66 DEL66 DEL42 DEL65 DEL66 DEL65 DEL29 DEL39 DEL85 DEL5 DEL42 DEL44 DEL39 DEL42 DEL44 DEL31 DEL42 DEL32 DEL21 DEL39 DEL42 DEL42 DEL43 DEL42 DEL11 DEL36 DEL42 DEL42 DEL42 DEL42 DEL42 DEL32 DEL59 DEL60 DEL42 DEL34 DEL38 DEL27 DEL42 DEL42 DEL7 DEL21 DEL8 DEL25 DEL42 DEL41