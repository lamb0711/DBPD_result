HADOOP-14556. S3A to support Delegation Tokens.

Contributed by Steve Loughran.

- * A duration with logging of final state at info in the {@code close()} call.
+ * A duration with logging of final state at info or debug
+ * in the {@code close()} call.
-   * Create the duration text from a {@code String.format()} code call.
+   * Should the log be at INFO rather than DEBUG.
+   */
+  private final boolean logAtInfo;
+
+  /**
+   * Create the duration text from a {@code String.format()} code call;
+   * log output at info level.
+    this(log, true, format, args);
+  }
+
+  /**
+   * Create the duration text from a {@code String.format()} code call
+   * and log either at info or debug.
+   * @param log log to write to
+   * @param logAtInfo should the log be at info, rather than debug
+   * @param format format string
+   * @param args list of arguments
+   */
+  public DurationInfo(Logger log,
+      boolean logAtInfo,
+      String format,
+      Object... args) {
-    log.info("Starting: {}", text);
+    this.logAtInfo = logAtInfo;
+    if (logAtInfo) {
+      log.info("Starting: {}", text);
+    } else {
+      log.debug("Starting: {}", text);
+    }
-    log.info(this.toString());
+    if (logAtInfo) {
+      log.info("{}", this);
+    } else {
+      log.debug("{}", this);
+    }

INS23 INS31 INS29 INS83 INS83 INS39 INS59 MOV29 INS83 INS42 INS44 INS44 INS44 INS8 INS29 INS44 INS8 UPD66 INS66 INS65 INS42 INS43 INS42 INS43 INS42 INS43 INS42 INS17 INS65 INS65 INS65 INS65 INS65 INS39 INS42 INS21 INS25 MOV21 INS25 INS66 UPD66 INS66 INS42 INS42 INS42 INS42 INS9 INS42 INS42 INS66 INS65 INS66 INS66 INS42 INS66 INS42 INS66 INS42 INS66 INS42 INS66 INS7 INS42 INS8 INS8 INS42 INS8 INS8 INS66 INS22 INS42 MOV21 INS21 MOV21 INS21 INS52 INS42 INS32 INS32 INS42 INS42 INS45 INS42 INS45 MOV52 INS42 INS42 INS45 INS52 DEL42 DEL32 DEL8