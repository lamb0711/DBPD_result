HDFS-13399. [SBN read] Make Client field AlignmentContext non-static. Contributed by Plamen Jeliazkov.
+    private RpcResponseHeaderProto bufferedHeader; // the response header
+    private Writable bufferedRv;                   // the byte response
+
+      this.bufferedRv = call.bufferedRv;
+      this.bufferedHeader = call.bufferedHeader;
+    public void setBufferedHeader(RpcResponseHeaderProto header) {
+      this.bufferedHeader = header;
+    }
+
+    public void setBufferedRv(Writable rv) {
+      this.bufferedRv = rv;
+    }
+
+      } else if (alignmentContext != null) {
+        // rebuild response with state context in header
+        RpcResponseHeaderProto.Builder responseHeader =
+            call.bufferedHeader.toBuilder();
+        alignmentContext.updateResponseState(responseHeader);
+        RpcResponseHeaderProto builtHeader = responseHeader.build();
+        setupResponse(call, builtHeader, call.bufferedRv);
-    if(alignmentContext != null) {
-      alignmentContext.updateResponseState(headerBuilder);
-    }
+    if (alignmentContext != null && call.bufferedHeader == null
+        && call.bufferedRv == null) {
+      call.setBufferedHeader(header);
+      call.setBufferedRv(rv);
+    }
+

INS23 INS23 INS31 INS31 INS83 INS43 INS59 INS83 INS43 INS59 INS83 INS39 INS42 INS44 INS8 INS83 INS39 INS42 INS44 INS8 INS25 INS42 INS42 INS42 INS42 INS21 INS21 INS43 INS42 INS21 INS43 INS42 INS21 INS27 INS8 INS7 INS7 INS42 INS7 INS42 INS7 INS25 INS27 INS27 INS21 INS21 INS22 INS40 INS22 INS40 INS22 INS42 INS22 INS42 INS27 INS8 MOV27 INS27 INS40 INS33 INS32 INS32 INS52 INS42 INS52 INS42 INS52 INS42 INS52 INS42 INS42 INS33 INS60 INS21 INS60 INS21 INS40 INS33 INS42 INS42 INS42 INS42 INS42 INS42 INS43 INS59 INS32 INS43 INS59 INS32 INS40 INS42 INS32 INS42 INS42 INS42 INS42 INS42 INS32 INS42 INS42 INS42 INS40 INS40 INS42 INS42 INS42 DEL42 DEL42 DEL42 DEL32 DEL21 DEL8 DEL25