MAPREDUCE-2863. Support web services for YARN and MR components. (Thomas Graves via vinodkv)


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1213975 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.hadoop.util.VersionInfo;
-import org.apache.hadoop.yarn.util.YarnVersionInfo;
+import org.apache.hadoop.util.StringUtils;
+import org.apache.hadoop.yarn.server.nodemanager.webapp.dao.NodeInfo;
+  private static final long BYTES_IN_MB = 1024 * 1024;
+
+      NodeInfo info = new NodeInfo(this.context, this.resourceView);
-              this.resourceView.getVmemAllocatedForContainers() + "bytes")
+              StringUtils.byteDesc(info.getTotalVmemAllocated() * BYTES_IN_MB))
-              this.resourceView.getPmemAllocatedForContainers() + "bytes")
+              StringUtils.byteDesc(info.getTotalPmemAllocated() * BYTES_IN_MB))
-              this.context.getNodeHealthStatus().getIsNodeHealthy())
+              info.getHealthStatus())
-                this.context.getNodeHealthStatus().getLastHealthReportTime()))
+              info.getLastNodeUpdateTime()))
-              this.context.getNodeHealthStatus().getHealthReport())
-          ._("Node Manager Version:", YarnVersionInfo.getBuildVersion() +
-              " on " + YarnVersionInfo.getDate())
-          ._("Hadoop Version:", VersionInfo.getBuildVersion() +
-              " on " + VersionInfo.getDate());
+              info.getHealthReport())
+          ._("Node Manager Version:", info.getNMBuildVersion() +
+              " on " + info.getNMVersionBuiltOn())
+          ._("Hadoop Version:", info.getHadoopBuildVersion() +
+              " on " + info.getHadoopVersionBuiltOn());

MOV26 UPD40 UPD40 INS23 INS83 INS83 INS83 INS39 INS59 INS42 INS27 INS34 INS34 INS60 INS43 INS59 INS42 INS42 INS14 INS43 MOV22 MOV22 INS42 UPD42 UPD42 UPD42 UPD42 INS42 UPD42 UPD42 UPD42 UPD42 INS32 UPD42 MOV42 UPD42 INS42 UPD42 INS32 INS42 INS42 UPD27 MOV27 INS42 INS42 UPD27 MOV27 INS42 INS42 INS42 UPD42 INS42 UPD42 DEL52 DEL42 DEL22 DEL45 DEL45 DEL32 DEL52 DEL42 DEL22 DEL42 DEL32 DEL52 DEL42 DEL22 DEL42 DEL32