HDFS-10225. DataNode hot swap drives should disallow storage type changes. Contributed by Lei (Eddy) Xu.

-   * configuration.
+   * configuration, or the storage type of a directory is changed.
+    // Use the existing StorageLocation to detect storage type changes.
+    Map<String, StorageLocation> existingLocations = new HashMap<>();
+    for (StorageLocation loc : getStorageLocations(this.conf)) {
+      existingLocations.put(loc.getFile().getCanonicalPath(), loc);
+    }
+
+          StorageLocation old = existingLocations.get(
+              location.getFile().getCanonicalPath());
+          if (old != null &&
+              old.getStorageType() != location.getStorageType()) {
+            throw new IOException("Changing storage type is not allowed.");
+          }

INS60 INS70 UPD66 INS74 INS59 INS44 INS32 INS8 INS43 INS43 INS43 INS42 INS14 INS43 INS42 INS42 INS22 INS21 INS42 INS42 INS42 INS74 INS42 INS52 INS42 INS32 INS43 INS42 INS42 INS32 INS42 INS42 INS32 INS42 INS42 INS42 INS60 INS25 INS43 INS59 INS27 INS8 INS42 INS42 INS32 INS27 INS27 INS53 INS42 INS42 INS32 INS42 INS33 INS32 INS32 INS14 INS32 INS42 INS42 INS42 INS42 INS42 INS43 INS45 INS42 INS42 INS42