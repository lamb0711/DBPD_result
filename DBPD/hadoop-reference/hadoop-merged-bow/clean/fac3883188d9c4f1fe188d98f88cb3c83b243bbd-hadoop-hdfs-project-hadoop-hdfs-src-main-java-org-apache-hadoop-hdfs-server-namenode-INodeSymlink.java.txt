HDFS-4503. Update computeContentSummary(..), spaceConsumedInTree(..) and diskspaceConsumed(..) in INode for snapshot.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1448373 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.hdfs.server.namenode.INode.Content.CountsMap.Key;
-
-  @Override
-  DirCounts spaceConsumedInTree(DirCounts counts) {
-    counts.nsCount += 1;
-    return counts;
-  }
-  long[] computeContentSummary(long[] summary) {
-    summary[1]++; // Increment the file count
-    return summary;
+  Quota.Counts computeQuotaUsage(final Quota.Counts counts) {
+    counts.add(Quota.NAMESPACE, 1);
+    return counts;
+  }
+
+  @Override
+  public Content.CountsMap computeContentSummary(
+      final Content.CountsMap countsMap) {
+    computeContentSummary(countsMap.getCounts(Key.CURRENT));
+    return countsMap;
+  }
+
+  @Override
+  public Content.Counts computeContentSummary(final Content.Counts counts) {
+    counts.add(Content.SYMLINK, 1);
+    return counts;

INS26 MOV31 INS40 INS31 UPD43 UPD42 MOV78 INS83 INS43 INS42 INS44 INS8 INS78 INS83 INS43 INS40 INS83 UPD43 INS40 INS83 INS43 INS42 INS21 INS41 INS42 INS40 INS83 INS43 UPD42 INS40 INS32 INS40 INS32 INS42 INS40 INS32 UPD42 INS42 INS42 INS40 INS34 INS42 INS32 INS42 INS42 INS40 INS34 INS42 INS42 INS40 DEL42 DEL42 DEL40 DEL34 DEL7 DEL39 DEL85 DEL5 DEL39 DEL85 DEL5 DEL42 DEL34 DEL2 DEL37