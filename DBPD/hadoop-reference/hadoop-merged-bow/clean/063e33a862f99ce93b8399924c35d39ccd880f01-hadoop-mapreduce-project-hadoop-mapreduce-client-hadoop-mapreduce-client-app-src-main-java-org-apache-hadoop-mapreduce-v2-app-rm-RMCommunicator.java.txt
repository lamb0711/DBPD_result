MAPREDUCE-3098. Fixed RM and MR AM to report YarnApplicationState and application's FinalStatus separately. Contributed by Hitesh Shah.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1177633 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.yarn.api.records.FinalApplicationStatus;
-  
+
-    String host = 
+    String host =
-      RegisterApplicationMasterResponse response = 
+      RegisterApplicationMasterResponse response =
-      String finalState = "RUNNING";
+      FinalApplicationStatus finishState = FinalApplicationStatus.UNDEFINED;
-        finalState = "SUCCEEDED";
+        finishState = FinalApplicationStatus.SUCCEEDED;
-        finalState = "KILLED";
+        finishState = FinalApplicationStatus.KILLED;
-        finalState = "FAILED";
+        finishState = FinalApplicationStatus.FAILED;
-      
-      String historyUrl = JobHistoryUtils.getHistoryUrl(getConfig(), 
+
+      String historyUrl = JobHistoryUtils.getHistoryUrl(getConfig(),
-      request.setFinalState(finalState.toString());
+      request.setFinishApplicationStatus(finishState);
-  
+

INS26 INS40 UPD43 UPD42 UPD42 INS40 UPD42 UPD42 MOV42 UPD42 INS40 UPD42 INS40 UPD42 INS40 DEL45 DEL45 DEL45 DEL45 DEL42 DEL32