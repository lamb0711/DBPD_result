HDFS-14161. RBF: Throw StandbyException instead of IOException so that client can retry when can not get connection. Contributed by Fei Hui.

-      throw new IOException("Cannot get a connection to " + rpcAddress);
+      throw new ConnectionNullException("Cannot get a connection to "
+          + rpcAddress);
+      String nsId = namenode.getNameserviceId();
+      String rpcAddress = namenode.getRpcAddress();
-        String nsId = namenode.getNameserviceId();
-        String rpcAddress = namenode.getRpcAddress();
+        } else if (ioe instanceof ConnectionNullException) {
+          if (this.rpcMonitor != null) {
+            this.rpcMonitor.proxyOpFailureCommunicate();
+          }
+          LOG.error("Get connection for {} {} error: {}", nsId, rpcAddress,
+              ioe.getMessage());
+          // Throw StandbyException so that client can retry
+          StandbyException se = new StandbyException(ioe.getMessage());
+          se.initCause(ioe);
+          throw se;
-        LOG.error("{} {} at {} is in Standby", nsId, nnId, addr);
+        LOG.error("{} {} at {} is in Standby: {}", nsId, nnId, addr,
+            ioe.getMessage());

MOV60 MOV60 UPD43 UPD42 UPD45 INS32 INS25 INS42 INS42 INS62 INS8 MOV8 INS42 INS43 INS25 INS21 INS60 INS21 INS53 INS42 INS27 INS8 INS32 INS43 INS59 INS32 INS42 INS22 INS33 INS21 INS42 INS42 INS45 INS42 INS42 INS32 INS42 INS42 INS14 INS42 INS42 INS42 INS52 INS42 INS32 INS42 INS42 INS43 INS32 INS22 INS42 INS42 INS42 INS42 INS52 INS42