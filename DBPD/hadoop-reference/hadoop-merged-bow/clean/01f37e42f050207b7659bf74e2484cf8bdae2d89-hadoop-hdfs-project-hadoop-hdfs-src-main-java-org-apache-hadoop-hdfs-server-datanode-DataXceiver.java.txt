HDFS-5390. Send one incremental block report per storage directory.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2832@1534891 13f79535-47bb-0310-9956-ffa450edef68

+    Replica replica;
+        replica = blockReceiver.getReplicaInfo();
-        datanode.data.recoverClose(block, latestGenerationStamp, minBytesRcvd);
+        replica =
+            datanode.data.recoverClose(block, latestGenerationStamp, minBytesRcvd);
-        datanode.closeBlock(block, DataNode.EMPTY_DEL_HINT);
+        datanode.closeBlock(
+            block, DataNode.EMPTY_DEL_HINT, replica.getStorageUuid());
-      datanode.notifyNamenodeReceivedBlock(block, delHint);
+      datanode.notifyNamenodeReceivedBlock(
+          block, delHint, blockReceiver.getReplicaInfo().getStorageUuid());

INS60 INS43 INS59 INS42 INS42 INS21 INS32 INS7 INS7 INS32 INS42 INS42 INS32 INS42 MOV32 INS32 INS42 INS42 INS42 INS42 INS42 INS42