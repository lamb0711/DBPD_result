HADOOP-15023. ValueQueue should also validate (int) (lowWatermark * numValues) > 0 on construction.

+    final int watermarkValue = (int) (numValues * lowWatermark);
+    Preconditions.checkArgument(watermarkValue > 0,
+        "(int) (\"numValues\" * \"lowWatermark\") must be > 0");
-                    refiller.fillQueueForKey(keyName, keyQueue,
-                        (int)(lowWatermark * numValues));
+                    refiller.fillQueueForKey(keyName, keyQueue, watermarkValue);

INS60 INS21 INS83 INS39 INS59 INS32 INS42 INS11 INS42 INS42 INS27 INS45 INS39 INS36 INS42 INS34 INS27 INS42 INS42 INS42 DEL39 DEL42 DEL42 DEL27 DEL36 DEL11