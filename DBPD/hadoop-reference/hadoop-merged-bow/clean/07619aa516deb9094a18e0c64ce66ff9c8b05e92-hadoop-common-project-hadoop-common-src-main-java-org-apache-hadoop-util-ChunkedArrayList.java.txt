HADOOP-11427. ChunkedArrayList: fix removal via iterator and implement get (cmccabe)

-    return Iterables.concat(chunks).iterator();
+    final Iterator<T> it = Iterables.concat(chunks).iterator();
+
+    return new Iterator<T>() {
+      @Override
+      public boolean hasNext() {
+        return it.hasNext();
+      }
+
+      @Override
+      public T next() {
+        return it.next();
+      }
+
+      @Override
+      public void remove() {
+        it.remove();
+        size--;
+      }
+    };
+    if (size == Integer.MAX_VALUE) {
+      throw new RuntimeException("Can't add an additional element to the " +
+          "list; list already has INT_MAX elements.");
+    }
-  public T get(int arg0) {
-    throw new UnsupportedOperationException(
-        this.getClass().getName() + " does not support random access");
+  public T get(int idx) {
+    if (idx < 0) {
+      throw new IndexOutOfBoundsException();
+    }
+    int base = 0;
+    Iterator<List<T>> it = chunks.iterator();
+    while (it.hasNext()) {
+      List<T> list = it.next();
+      int size = list.size();
+      if (idx < base + size) {
+        return list.get(idx - base);
+      }
+      base += size;
+    }
+    throw new IndexOutOfBoundsException();

INS74 INS8 INS43 INS43 INS60 INS41 INS25 UPD42 INS25 INS60 INS60 INS61 INS53 INS42 INS42 INS83 MOV74 INS59 INS14 INS27 INS8 INS27 INS8 INS39 INS59 INS74 INS59 INS32 INS8 INS14 INS42 MOV32 INS74 INS1 INS42 INS40 INS53 INS42 INS34 INS53 INS42 INS34 INS43 INS74 INS42 INS32 INS42 INS42 INS60 INS60 INS25 INS21 INS43 INS43 INS43 INS31 INS31 INS31 INS14 INS14 INS42 INS43 INS43 INS42 INS42 INS74 INS59 INS39 INS59 INS27 INS8 INS7 INS42 INS42 INS42 INS78 INS83 INS39 INS42 MOV8 INS78 INS83 INS43 INS42 INS8 INS78 INS83 INS39 INS42 INS8 INS43 INS27 UPD43 MOV43 INS42 INS42 INS43 INS43 INS42 INS32 INS42 INS32 INS42 INS27 INS41 INS42 INS42 INS42 INS42 INS42 INS41 INS42 INS21 INS21 INS42 INS45 INS45 UPD42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS32 INS32 INS32 INS32 INS37 INS42 INS42 INS27 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 DEL52 DEL42 DEL32 DEL42 DEL32 DEL45 DEL27 DEL14 DEL53