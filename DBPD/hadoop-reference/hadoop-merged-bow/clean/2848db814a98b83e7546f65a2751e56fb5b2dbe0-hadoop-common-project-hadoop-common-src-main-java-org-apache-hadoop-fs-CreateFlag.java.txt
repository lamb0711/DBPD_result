HDFS-3689. Add support for variable length block. Contributed by Jing Zhao.

+ * <li> LAZY_PERSIST - Create the block on transient storage (RAM) if
+ * available.</li>
+ * <li> APPEND_NEWBLOCK - Append data to a new block instead of end of the last
+ * partial block.</li>
-  LAZY_PERSIST((short) 0x10);
+  LAZY_PERSIST((short) 0x10),
+
+  /**
+   * Append data to a new block instead of the end of the last partial block.
+   * This is only useful for APPEND.
+   */
+  NEW_BLOCK((short) 0x20);
+
+  /**
+   * Validate the CreateFlag for the append operation. The flag must contain
+   * APPEND, and cannot contain OVERWRITE.
+   */
+  public static void validateForAppend(EnumSet<CreateFlag> flag) {
+    validate(flag);
+    if (!flag.contains(APPEND)) {
+      throw new HadoopIllegalArgumentException(flag
+          + " does not contain APPEND");
+    }
+  }

INS72 INS31 INS29 INS42 INS11 INS29 INS83 INS83 INS39 INS42 INS44 INS8 INS66 INS66 INS66 INS66 INS65 INS39 INS34 INS65 INS74 INS42 INS21 INS25 INS66 INS66 INS66 INS66 INS43 INS43 INS32 INS38 INS8 INS42 INS42 INS42 INS42 INS32 INS53 INS42 INS42 INS42 INS14 INS43 INS27 INS42 INS42 INS45