Merge HDFS-8394 from trunk: Move getAdditionalBlock() and related functionalities into a separate class.

-  public final short getReplication(int lastSnapshotId) {
-    if (lastSnapshotId != CURRENT_STATE_ID) {
-      return getFileReplication(lastSnapshotId);
-    } else {
-      return getBlockReplication();
-    }
-  }
-

DEL83 DEL83 DEL39 DEL42 DEL39 DEL42 DEL44 DEL42 DEL42 DEL27 DEL42 DEL42 DEL32 DEL41 DEL8 DEL42 DEL32 DEL41 DEL8 DEL25 DEL8 DEL31