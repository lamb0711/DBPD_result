HDDS-428. OzoneManager lock optimization.
Contributed by Nanda Kumar.

-import java.util.concurrent.locks.Lock;
-import java.util.concurrent.locks.ReadWriteLock;
-import java.util.concurrent.locks.ReentrantReadWriteLock;
-  // TODO: Make this lock move into Table instead of *ONE* lock for the whole
-  // DB.
-  private final ReadWriteLock lock;
+  private final OzoneManagerLock lock;
-    this.lock = new ReentrantReadWriteLock();
+    this.lock = new OzoneManagerLock(conf);
-   * Returns the read lock used on Metadata DB.
+   * Returns the OzoneManagerLock used on Metadata DB.
-   * @return readLock
+   * @return OzoneManagerLock
-  public Lock readLock() {
-    return lock.readLock();
-  }
-
-  /**
-   * Returns the write lock used on Metadata DB.
-   *
-   * @return writeLock
-   */
-  @Override
-  public Lock writeLock() {
-    return lock.writeLock();
+  public OzoneManagerLock getLock() {
+    return lock;

UPD43 UPD43 UPD42 UPD42 UPD42 UPD66 UPD66 INS42 UPD43 INS42 UPD42 DEL40 DEL26 DEL40 DEL26 DEL40 DEL26 DEL42 DEL42 DEL32 DEL66 DEL65 DEL66 DEL65 DEL29 DEL42 DEL78 DEL83 DEL42 DEL43 DEL42 DEL42 DEL42 DEL32 DEL41 DEL8 DEL31