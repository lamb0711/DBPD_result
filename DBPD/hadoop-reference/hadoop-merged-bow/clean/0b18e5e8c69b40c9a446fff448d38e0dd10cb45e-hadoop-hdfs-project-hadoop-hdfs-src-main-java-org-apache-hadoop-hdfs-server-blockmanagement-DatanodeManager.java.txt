HDFS-6481. DatanodeManager#getDatanodeStorageInfos() should check the length of storageIDs. (Contributed by szetszwo)

-      DatanodeID[] datanodeID, String[] storageIDs)
-          throws UnregisteredNodeException {
+      DatanodeID[] datanodeID, String[] storageIDs,
+      String format, Object... args) throws UnregisteredNodeException {
+    if (datanodeID.length != storageIDs.length) {
+      final String err = (storageIDs.length == 0?
+          "Missing storageIDs: It is likely that the HDFS client,"
+          + " who made this call, is running in an older version of Hadoop"
+          + " which does not support storageIDs."
+          : "Length mismatched: storageIDs.length=" + storageIDs.length + " != "
+          ) + " datanodeID.length=" + datanodeID.length;
+      throw new HadoopIllegalArgumentException(
+          err + ", "+ String.format(format, args));
+    }

INS44 INS44 INS43 INS42 INS43 INS42 INS25 INS42 INS42 INS27 INS8 INS40 INS40 INS60 INS53 INS83 INS43 INS59 INS14 INS42 INS42 INS27 INS43 INS27 INS36 INS45 INS40 INS42 INS42 INS45 INS32 INS16 INS42 INS42 INS42 INS42 INS27 INS27 INS27 INS40 INS34 INS45 INS45 INS45 INS45 INS40 INS45