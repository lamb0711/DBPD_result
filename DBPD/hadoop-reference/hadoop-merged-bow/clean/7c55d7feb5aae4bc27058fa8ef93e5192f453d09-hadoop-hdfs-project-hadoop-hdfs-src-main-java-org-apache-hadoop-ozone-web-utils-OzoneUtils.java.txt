HDFS-9960. OzoneHandler : Add localstorage support for keys. Contributed by Anu Engineer.

+import org.apache.hadoop.hdfs.server.datanode.fsdataset.LengthInputStream;
-import java.io.InputStream;
+import javax.ws.rs.core.MediaType;
-  public static final Charset ENCODING = Charset.forName("UTF-8");
+  public static final String ENCODING_NAME = "UTF-8";
+  public static final Charset ENCODING = Charset.forName(ENCODING_NAME);
-                                     InputStream stream) {
+                                     LengthInputStream stream) {
-    return Response.ok(stream)
+    return Response.ok(stream, MediaType.APPLICATION_OCTET_STREAM)
-        .header(HttpHeaders.CONTENT_TYPE, "application/octet-stream").build();
+        .header(HttpHeaders.CONTENT_LENGTH, stream.getLength())
+        .build();
+

MOV26 INS26 UPD40 INS40 INS23 INS83 INS83 INS83 INS43 INS59 INS42 INS42 INS45 UPD43 INS42 UPD42 UPD40 INS32 INS42 INS42 INS40 DEL45 DEL45