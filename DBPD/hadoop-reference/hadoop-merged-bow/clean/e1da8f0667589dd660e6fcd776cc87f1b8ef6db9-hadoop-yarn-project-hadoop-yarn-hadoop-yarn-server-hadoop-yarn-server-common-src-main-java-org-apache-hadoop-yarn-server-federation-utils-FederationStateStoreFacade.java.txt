YARN-5602. Utils for Federation State and Policy Store. (Giovanni Matteo Fumarola via Subru).

(cherry picked from commit 326a2e6bde1cf266ecc7d3b513cdaac6abcebbe4)

+import org.apache.hadoop.yarn.server.federation.store.exception.FederationStateStoreRetriableException;
+  /**
+   * Create a RetryPolicy for {@code FederationStateStoreFacade}. In case of
+   * failure, it retries for:
+   * <ul>
+   * <li>{@code FederationStateStoreRetriableException}</li>
+   * <li>{@code CacheLoaderException}</li>
+   * </ul>
+   *
+   * @param conf the updated configuration
+   * @return the RetryPolicy for FederationStateStoreFacade
+   */
-    RetryPolicy retryPolicy = RetryPolicies.exponentialBackoffRetry(
+    RetryPolicy basePolicy = RetryPolicies.exponentialBackoffRetry(
+    Map<Class<? extends Exception>, RetryPolicy> exceptionToPolicyMap =
+        new HashMap<Class<? extends Exception>, RetryPolicy>();
+    exceptionToPolicyMap.put(FederationStateStoreRetriableException.class,
+        basePolicy);
+    exceptionToPolicyMap.put(CacheLoaderException.class, basePolicy);
+    RetryPolicy retryPolicy = RetryPolicies.retryByException(
+        RetryPolicies.TRY_ONCE_THEN_FAIL, exceptionToPolicyMap);

INS26 INS40 INS29 INS65 INS65 INS65 INS60 INS21 INS21 INS60 INS66 INS65 INS66 INS66 INS66 INS66 INS65 INS66 INS66 INS65 INS66 INS66 INS42 INS66 INS66 INS74 INS59 INS32 INS32 INS43 INS59 INS66 INS66 INS66 UPD42 INS43 INS74 INS43 INS42 INS14 INS42 INS42 INS57 INS42 INS42 INS42 INS57 INS42 INS42 INS42 INS32 INS42 INS43 INS76 INS42 INS74 INS43 INS43 INS42 INS42 INS40 INS42 INS42 INS43 INS43 INS74 INS43 INS42 INS42 INS42 INS42 INS43 INS76 INS42 INS42 INS43 INS42