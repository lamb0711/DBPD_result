HADOOP-6560. Handle invalid har:// uri in HarFileSystem.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@910726 13f79535-47bb-0310-9956-ffa450edef68

-    String[] str = host.split("-", 2);
-    if (str[0] == null) {
-      throw new IOException("URI: " + rawURI + " is an invalid Har URI.");
+    if (host == null) {
+      throw new IOException("URI: " + rawURI
+          + " is an invalid Har URI since host==null."
+          + "  Expecting har://<scheme>-<host>/<path>.");
-    String underLyingScheme = str[0];
-    String underLyingHost = (str.length > 1)? str[1]:null;
+    int i = host.indexOf('-');
+    if (i < 0) {
+      throw new IOException("URI: " + rawURI
+          + " is an invalid Har URI since '-' not found."
+          + "  Expecting har://<scheme>-<host>/<path>.");
+    }
+    final String underLyingScheme = host.substring(0, i);
+    i++;
+    final String underLyingHost = i == host.length()? null: host.substring(i);

INS25 INS60 INS21 INS27 INS8 INS39 MOV59 UPD27 INS83 MOV43 INS37 INS83 MOV43 INS42 INS33 INS53 UPD42 INS42 INS34 INS32 INS42 INS14 UPD42 INS13 INS42 INS42 INS34 INS42 INS27 INS33 INS32 INS43 INS27 INS42 INS32 INS42 INS42 INS42 UPD42 MOV42 INS45 INS42 INS45 INS45 UPD45 INS45 INS42 INS42 DEL45 DEL34 DEL43 DEL85 DEL5 DEL60 DEL42 DEL34 DEL2 DEL33 DEL42 DEL34 DEL2 DEL40 DEL34 DEL27 DEL36 DEL42 DEL34 DEL2 DEL33