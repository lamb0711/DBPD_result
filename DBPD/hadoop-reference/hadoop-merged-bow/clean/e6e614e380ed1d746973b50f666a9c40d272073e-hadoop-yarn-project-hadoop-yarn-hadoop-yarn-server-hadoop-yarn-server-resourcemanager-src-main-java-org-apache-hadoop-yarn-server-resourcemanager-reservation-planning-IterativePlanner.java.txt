YARN-5329. Placement Agent enhancements required to support recurring reservations in ReservationSystem. (Carlo Curino via Subru).

+    // initialize periodicity
+    long period = 0;
+    if(reservation.getRecurrenceExpression() != null){
+      period = Long.parseLong(reservation.getRecurrenceExpression());
+    }
+
-              stageDeadline, user, reservationId);
+              stageDeadline, period, user, reservationId);
-      planLoads =
-          RLESparseResourceAllocation.merge(plan.getResourceCalculator(),
-              plan.getTotalCapacity(), planLoads,
-              oldRes.getResourcesOverTime(), RLEOperator.subtract, jobArrival,
-              jobDeadline);
+      planLoads = RLESparseResourceAllocation.merge(
+          plan.getResourceCalculator(), plan.getTotalCapacity(), planLoads,
+          oldRes.getResourcesOverTime(jobArrival, jobDeadline),
+          RLEOperator.subtract, jobArrival, jobDeadline);
-  protected Map<ReservationInterval, Resource> computeStageAllocation(
-      Plan plan, ReservationRequest rr, long stageArrivalTime,
-      long stageDeadline, String user, ReservationId oldId)
-      throws PlanningException {
+  protected Map<ReservationInterval, Resource> computeStageAllocation(Plan plan,
+      ReservationRequest rr, long stageArrivalTime, long stageDeadline,
+      long period, String user, ReservationId oldId) throws PlanningException {
-        planModifications, rr, stageArrivalTime, stageDeadline, user, oldId);
+        planModifications, rr, stageArrivalTime, stageDeadline, period, user,
+        oldId);

INS44 INS60 INS25 INS39 INS42 INS39 INS59 INS27 INS8 INS42 INS34 INS32 INS33 INS21 INS42 INS42 INS42 INS7 INS42 INS32 INS42 INS42 INS32 INS42 INS42 INS42 INS42 INS42