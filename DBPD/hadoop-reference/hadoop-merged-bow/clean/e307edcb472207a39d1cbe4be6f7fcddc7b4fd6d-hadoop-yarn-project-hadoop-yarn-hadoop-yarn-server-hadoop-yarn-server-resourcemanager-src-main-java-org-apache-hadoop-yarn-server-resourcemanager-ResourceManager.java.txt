YARN-7540 and YARN-7605. Convert yarn app cli to call yarn api services and implement doAs for Api Service REST API. Contributed by Eric Yang and Jian He

+import com.sun.jersey.spi.container.servlet.ServletContainer;
+
+    Map<String, String> params = new HashMap<String, String>();
+    if (getConfig().getBoolean(YarnConfiguration.YARN_API_SERVICES_ENABLE,
+        false)) {
+      String apiPackages = "org.apache.hadoop.yarn.service.webapp;" +
+          "org.apache.hadoop.yarn.webapp";
+      params.put("com.sun.jersey.config.property.resourceConfigClass",
+          "com.sun.jersey.api.core.PackagesResourceConfig");
+      params.put("com.sun.jersey.config.property.packages", apiPackages);
+    }
+
+            .withServlet("API-Service", "/app/*",
+                ServletContainer.class, params)
-    if (getConfig().getBoolean(YarnConfiguration.YARN_API_SERVICES_ENABLE,
-        false)) {
-      serviceConfig = new HashMap<String, String>();
-      String apiPackages = "org.apache.hadoop.yarn.service.webapp;" +
-          "org.apache.hadoop.yarn.webapp";
-      serviceConfig.put("PackageName", apiPackages);
-      serviceConfig.put("PathSpec", "/app/*");
-    }
-    webApp = builder.start(new RMWebApp(this), uiWebAppContext, serviceConfig);
+    webApp = builder.start(new RMWebApp(this), uiWebAppContext);

INS26 INS40 MOV25 INS60 INS74 INS59 INS43 INS43 INS43 INS42 MOV14 INS32 INS42 INS42 INS42 MOV32 INS42 INS42 UPD42 INS45 UPD45 UPD42 UPD45 INS42 UPD42 INS40 UPD42 UPD40 UPD42 UPD40 UPD42 UPD40 UPD42 INS45 INS45 INS57 INS42 INS43 INS42 DEL42 DEL7 DEL21 DEL42 DEL45 DEL40 DEL42 DEL42