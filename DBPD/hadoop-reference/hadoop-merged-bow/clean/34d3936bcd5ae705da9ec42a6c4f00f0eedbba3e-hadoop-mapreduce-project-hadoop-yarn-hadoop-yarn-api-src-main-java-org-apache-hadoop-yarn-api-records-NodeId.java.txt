MAPREDUCE-2965. Streamlined the methods hashCode(), equals(), compareTo() and toString() for all IDs. Contributed by Siddharth Seth.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1172212 13f79535-47bb-0310-9956-ffa450edef68

-public interface NodeId extends Comparable<NodeId> {
+public abstract class NodeId implements Comparable<NodeId> {
-  String getHost();
+  public abstract String getHost();
-  void setHost(String host);
+  public abstract void setHost(String host);
-  int getPort();
+  public abstract int getPort();
-  void setPort(int port);
+  public abstract void setPort(int port);
+
+  @Override
+  public String toString() {
+    return this.getHost() + ":" + this.getPort();
+  }
+
+  @Override
+  public int hashCode() {
+    final int prime = 31;
+    int result = 1;
+    result = prime * result + this.getHost().hashCode();
+    result = prime * result + this.getPort();
+    return result;
+  }
+
+  @Override
+  public boolean equals(Object obj) {
+    if (this == obj)
+      return true;
+    if (!super.equals(obj))
+      return false;
+    if (getClass() != obj.getClass())
+      return false;
+    NodeId other = (NodeId) obj;
+    if (!this.getHost().equals(other.getHost()))
+      return false;
+    if (this.getPort() != other.getPort())
+      return false;
+    return true;
+  }
+
+  @Override
+  public int compareTo(NodeId other) {
+    int hostCompare = this.getHost().compareTo(other.getHost());
+    if (hostCompare == 0) {
+      if (this.getPort() > other.getPort()) {
+        return 1;
+      } else if (this.getPort() < other.getPort()) {
+        return -1;
+      }
+      return 0;
+    }
+    return hostCompare;
+  }
+

INS83 INS31 INS31 INS31 INS31 INS83 INS83 INS83 INS83 INS83 INS83 INS83 INS83 INS78 INS83 INS43 INS42 INS8 INS78 INS83 INS39 INS42 INS8 INS78 INS83 INS39 INS42 INS44 INS8 INS78 INS83 INS39 INS42 INS44 INS8 INS42 INS42 INS41 INS42 INS60 INS60 INS21 INS21 INS41 INS42 INS43 INS42 INS25 INS25 INS25 INS60 INS25 INS25 INS41 INS42 INS43 INS42 INS60 INS25 INS41 INS27 INS83 INS39 INS59 INS39 INS59 INS7 INS7 INS42 INS42 INS27 INS41 INS38 INS41 INS27 INS41 INS43 INS59 INS38 INS41 INS27 INS41 INS9 INS42 INS39 INS59 INS27 INS8 INS42 INS32 INS45 INS32 INS42 INS34 INS42 INS34 INS42 INS27 INS42 INS27 INS52 INS42 INS9 INS48 INS9 INS32 INS32 INS9 INS42 INS42 INS11 INS32 INS9 INS32 INS32 INS9 INS42 INS32 INS42 INS34 INS25 INS41 INS52 INS42 INS52 INS42 INS27 INS32 INS27 INS32 INS42 INS42 INS42 INS42 INS42 INS43 INS42 INS32 INS42 INS32 INS52 INS42 INS42 INS42 INS32 INS42 INS32 INS27 INS8 INS25 INS34 INS42 INS42 INS32 INS42 INS42 INS42 INS52 INS42 INS42 INS52 INS42 INS42 INS42 INS52 INS42 INS42 INS42 INS32 INS32 INS41 INS27 INS8 INS52 INS42 INS52 INS42 INS42 INS42 INS34 INS32 INS32 INS41 INS52 INS42 INS42 INS42 INS38 INS34