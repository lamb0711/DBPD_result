HDFS-3689. Add support for variable length block. Contributed by Jing Zhao.

-    UPDATE_LENGTH;
+    UPDATE_LENGTH,
+
+    /**
+     * Sync the data to DataNode, close the current block, and allocate a new
+     * block
+     */
+    END_BLOCK;

INS72 INS29 INS42 INS65 INS66 INS66