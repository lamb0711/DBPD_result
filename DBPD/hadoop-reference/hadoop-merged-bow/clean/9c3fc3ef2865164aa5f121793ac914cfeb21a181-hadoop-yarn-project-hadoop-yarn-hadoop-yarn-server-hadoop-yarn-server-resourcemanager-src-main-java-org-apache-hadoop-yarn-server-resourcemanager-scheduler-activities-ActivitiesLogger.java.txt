YARN-7494. Add muti-node lookup mechanism and pluggable nodes sorting policies to optimize placement decision. Contributed by Sunil Govindan.

-import org.apache.hadoop.yarn.api.records.Container;
+import org.apache.hadoop.yarn.server.resourcemanager.scheduler.common.fica.FiCaSchedulerNode;
-      if (activitiesManager == null) {
+      if (node == null || activitiesManager == null) {
-      if (activitiesManager == null) {
+      if (node == null || activitiesManager == null) {
-        activitiesManager.addSchedulingActivityForNode(node.getNodeID(),
+        activitiesManager.addSchedulingActivityForNode(node,
-        activitiesManager.addSchedulingActivityForNode(node.getNodeID(),
+        activitiesManager.addSchedulingActivityForNode(node,
-      if (activitiesManager == null) {
+      if (node == null || activitiesManager == null) {
-        activitiesManager.addSchedulingActivityForNode(node.getNodeID(),
+        activitiesManager.addSchedulingActivityForNode(node,
-        activitiesManager.addSchedulingActivityForNode(node.getNodeID(),
+        activitiesManager.addSchedulingActivityForNode(node,
-        ActivitiesManager activitiesManager, NodeId nodeId, long currentTime,
+        ActivitiesManager activitiesManager, FiCaSchedulerNode node,
+        long currentTime,
-      if (activitiesManager == null) {
+      if (node == null || activitiesManager == null) {
-      activitiesManager.startAppAllocationRecording(nodeId, currentTime,
-          application);
+      activitiesManager
+          .startAppAllocationRecording(node.getNodeID(), currentTime,
+              application);
-      if (activitiesManager == null) {
+      if (node == null || activitiesManager == null) {
-      if (activitiesManager == null) {
+      if (node == null || activitiesManager == null) {
-    activitiesManager.addSchedulingActivityForNode(node.getNodeID(), parentName,
+    activitiesManager.addSchedulingActivityForNode(node, parentName,

MOV26 UPD40 UPD43 UPD42 INS27 INS27 INS27 UPD42 INS27 INS27 INS27 MOV42 INS27 MOV27 INS27 MOV27 INS27 MOV27 INS27 MOV27 MOV32 INS27 MOV27 INS27 MOV27 INS42 INS33 INS42 INS33 INS42 INS33 INS42 INS33 INS42 INS33 INS42 INS33 MOV42 MOV42 MOV42 INS42 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32 DEL42 DEL42 DEL32