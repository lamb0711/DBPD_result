Revert "HADOOP-11274. ConcurrentModificationException in Configuration Copy Constructor. Contributed by Junping Du."

This reverts commit 16b34824673f5a50d464727b8fad98470e5e984a.

-    synchronized(other) {
-      this.resources = (ArrayList<Resource>) other.resources.clone();
-      if (other.properties != null) {
-        this.properties = (Properties)other.properties.clone();
-      }
+   this.resources = (ArrayList<Resource>) other.resources.clone();
+   synchronized(other) {
+     if (other.properties != null) {
+       this.properties = (Properties)other.properties.clone();
+     }
-      if (other.overlay!=null) {
-        this.overlay = (Properties)other.overlay.clone();
-      }
+     if (other.overlay!=null) {
+       this.overlay = (Properties)other.overlay.clone();
+     }
-      this.updatingResource = new HashMap<String, String[]>(other.updatingResource);
-      this.finalParameters = new HashSet<String>(other.finalParameters);
-
-      this.classLoader = other.classLoader;
-      this.loadDefaults = other.loadDefaults;
-      setQuietMode(other.getQuietMode());
-    }
+     this.updatingResource = new HashMap<String, String[]>(other.updatingResource);
+     this.finalParameters = new HashSet<String>(other.finalParameters);
+   }
+   
+    this.classLoader = other.classLoader;
+    this.loadDefaults = other.loadDefaults;
+    setQuietMode(other.getQuietMode());
-    synchronized (this) {
-      if (!isDeprecated(name)) {
-        updatingResource.put(name, new String[] {newSource});
-        String[] altNames = getAlternativeNames(name);
-        if(altNames != null) {
-          for(String n: altNames) {
-            if(!n.equals(name)) {
-              getOverlay().setProperty(n, value);
-              getProps().setProperty(n, value);
-              updatingResource.put(n, new String[] {newSource});
-            }
+    if (!isDeprecated(name)) {
+      updatingResource.put(name, new String[] {newSource});
+      String[] altNames = getAlternativeNames(name);
+      if(altNames != null) {
+        for(String n: altNames) {
+          if(!n.equals(name)) {
+            getOverlay().setProperty(n, value);
+            getProps().setProperty(n, value);
+            updatingResource.put(n, new String[] {newSource});
-      else {
-        String[] names = handleDeprecation(deprecationContext.get(), name);
-        String altSource = "because " + name + " is deprecated";
-        for(String n : names) {
-          getOverlay().setProperty(n, value);
-          getProps().setProperty(n, value);
-          updatingResource.put(n, new String[] {altSource});
-        }
+    }
+    else {
+      String[] names = handleDeprecation(deprecationContext.get(), name);
+      String altSource = "because " + name + " is deprecated";
+      for(String n : names) {
+        getOverlay().setProperty(n, value);
+        getProps().setProperty(n, value);
+        updatingResource.put(n, new String[] {altSource});
-  public synchronized Set<String> getFinalParameters() {
+  public Set<String> getFinalParameters() {
-        synchronized(this) {
-          updatingResource.put(attr, source);
-        }
+        updatingResource.put(attr, source);
-      synchronized(this) {
-        finalParameters.add(attr);
-      }
+      finalParameters.add(attr);
-  public synchronized void readFields(DataInput in) throws IOException {
+  public void readFields(DataInput in) throws IOException {
+  //@Override
-  public synchronized void write(DataOutput out) throws IOException {
+  public void write(DataOutput out) throws IOException {

MOV8 MOV8 MOV8 INS51 MOV51 MOV21 MOV21 MOV21 MOV60 MOV25 MOV21 MOV21 MOV60 MOV25 INS42 INS8 MOV27 MOV8 INS42 MOV8 MOV25 MOV25 MOV21 MOV21 INS25 MOV38 MOV8 INS25 MOV21 MOV38 MOV8 DEL42 DEL51 DEL8 DEL52 DEL51 DEL8 DEL83 DEL52 DEL51 DEL25 DEL42 DEL52 DEL51 DEL8 DEL25 DEL8 DEL83 DEL83