HDFS-8468. 2 RPC calls for every file read in DFSClient#open(..) resulting in double Audit log entries (Contributed by Vinayakumar B)

-      HdfsFileStatus fileInfo = getFileInfo(src);
-      if (fileInfo != null) {
-        ECSchema schema = fileInfo.getECSchema();
+      LocatedBlocks locatedBlocks = getLocatedBlocks(src, 0);
+      if (locatedBlocks != null) {
+        ECSchema schema = locatedBlocks.getECSchema();
-              fileInfo.getStripeCellSize());
+              locatedBlocks.getStripeCellSize(), locatedBlocks);
+        return new DFSInputStream(this, src, verifyChecksum, locatedBlocks);
+      } else {
+        throw new IOException("Cannot open filename " + src);
-      return new DFSInputStream(this, src, verifyChecksum);

INS25 UPD43 MOV27 INS8 INS8 UPD42 UPD42 UPD42 MOV60 MOV25 MOV41 INS53 UPD42 INS34 INS14 INS42 INS43 INS27 UPD42 INS42 INS45 INS42 INS42 UPD42 DEL8 DEL25