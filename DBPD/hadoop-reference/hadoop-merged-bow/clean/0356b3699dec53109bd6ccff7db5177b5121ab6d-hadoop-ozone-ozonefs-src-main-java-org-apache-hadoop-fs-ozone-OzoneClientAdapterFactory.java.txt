HDDS-1333. OzoneFileSystem can't work with spark/hadoop2.7 because incompatible security classes. Contributed by Elek, Marton. (#653)

(cherry picked from commit 7ec6a31eb314b9ecc1c2affbcc7d63c07bd33523)

+import org.apache.hadoop.fs.StorageStatistics;
+
-    return createAdapter(volumeStr, bucketStr,
+    return createAdapter(volumeStr, bucketStr, true,
-      OzoneFSStorageStatistics storageStatistics)
-      throws IOException {
-    return createAdapter(volumeStr, bucketStr,
+      StorageStatistics storageStatistics) throws IOException {
+    return createAdapter(volumeStr, bucketStr, false,
+      boolean basic,
-    ClassLoader currentClassLoader = OzoneFileSystem.class.getClassLoader();
+    ClassLoader currentClassLoader =
+        OzoneClientAdapterFactory.class.getClassLoader();
-      Class<?> aClass = classLoader
-          .loadClass("org.apache.hadoop.fs.ozone.OzoneClientAdapterImpl");
+      Class<?> adapterClass = null;
+      if (basic) {
+        adapterClass = classLoader
+            .loadClass(
+                "org.apache.hadoop.fs.ozone.BasicOzoneClientAdapterImpl");
+      } else {
+        adapterClass = classLoader
+            .loadClass(
+                "org.apache.hadoop.fs.ozone.OzoneClientAdapterImpl");
+      }
-          creator.createOzoneClientAdapter(aClass);
+          creator.createOzoneClientAdapter(adapterClass);
-    ClassLoader currentClassLoader = OzoneFileSystem.class.getClassLoader();
+    ClassLoader currentClassLoader =
+        OzoneClientAdapterFactory.class.getClassLoader();

INS26 INS40 INS44 UPD43 INS39 INS42 UPD42 INS9 INS9 INS25 INS42 INS8 INS8 UPD43 UPD42 INS33 INS21 INS21 UPD43 UPD42 INS7 INS7 UPD42 UPD42 INS42 INS32 INS42 MOV32 INS42 INS42 INS45