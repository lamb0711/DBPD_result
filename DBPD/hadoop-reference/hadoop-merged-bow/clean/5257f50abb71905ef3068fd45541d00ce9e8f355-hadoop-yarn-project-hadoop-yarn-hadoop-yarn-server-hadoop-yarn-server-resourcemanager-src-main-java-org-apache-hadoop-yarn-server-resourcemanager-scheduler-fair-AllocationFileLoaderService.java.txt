YARN-8967. Change FairScheduler to use PlacementRule interface. Contributed by Wilfred Spiegelenburg.

+  private final FairScheduler scheduler;
-  public AllocationFileLoaderService() {
-    this(SystemClock.getInstance());
+  AllocationFileLoaderService(FairScheduler scheduler) {
+    this(SystemClock.getInstance(), scheduler);
-  public AllocationFileLoaderService(Clock clock) {
+  AllocationFileLoaderService(Clock clock, FairScheduler scheduler) {
+    this.scheduler = scheduler;
-    // Load placement policy and pass it configured queues
-    Configuration conf = getConfig();
-    QueuePlacementPolicy newPlacementPolicy =
-        getQueuePlacementPolicy(allocationFileParser, queueProperties, conf);
+    // Load placement policy
+    getQueuePlacementPolicy(allocationFileParser);
-        allocationFileParser, newPlacementPolicy, globalReservationQueueConfig);
+        allocationFileParser, globalReservationQueueConfig);
-  private QueuePlacementPolicy getQueuePlacementPolicy(
-      AllocationFileParser allocationFileParser,
-      QueueProperties queueProperties, Configuration conf)
+  private void getQueuePlacementPolicy(
+      AllocationFileParser allocationFileParser)
-      return QueuePlacementPolicy.fromXml(
+      QueuePlacementPolicy.fromXml(
-          queueProperties.getConfiguredQueues(), conf);
+          scheduler);
-      return QueuePlacementPolicy.fromConfiguration(conf,
-          queueProperties.getConfiguredQueues());
+      QueuePlacementPolicy.fromConfiguration(scheduler);

INS23 INS83 INS83 INS43 INS59 INS44 INS44 INS39 INS42 INS42 INS43 INS42 INS43 INS42 INS21 INS21 INS42 INS42 INS42 INS7 INS32 MOV43 INS22 INS42 MOV42 MOV42 INS21 INS21 INS52 INS42 MOV43 MOV32 INS32 UPD42 MOV42 MOV42 MOV42 UPD42 MOV42 DEL83 DEL83 DEL42 DEL43 DEL42 DEL42 DEL32 DEL59 DEL60 DEL42 DEL43 DEL42 DEL42 DEL42 DEL32 DEL59 DEL60 DEL42 DEL42 DEL43 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL44 DEL42 DEL32 DEL42 DEL41 DEL42 DEL42 DEL32 DEL32 DEL41