Merging r1547121 through r1547473 from trunk to branch HDFS-2832

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2832@1547492 13f79535-47bb-0310-9956-ffa450edef68

+    // Set the generation stamp for the block.
+    setGenerationStamp(genStamp);
-            + "from location: " + r);
+            + "from location: " + r.getExpectedStorageLocation());
-
-    // Set the generation stamp for the block.
-    setGenerationStamp(genStamp);
+    // Sort out invalid replicas.
+    setGenerationStampAndVerifyReplicas(block.getGenerationStamp());

MOV21 INS21 INS32 INS42 INS32 INS42 INS42 INS32 INS42 INS42 DEL42