HDDS-239. Add PipelineStateManager to track pipeline state transition. Contributed by Mukul Kumar Singh.

-import org.apache.hadoop.hdds.protocol.proto.HddsProtos.LifeCycleState;
-   * @return PipelineChannel.
+   * @return Pipeline.
-          // Start all channel names with "Ratis", easy to grep the logs.
+          // Start all pipeline names with "Ratis", easy to grep the logs.
-          Pipeline pipeline=
-              PipelineSelector.newPipelineFromNodes(newNodesList,
-              LifeCycleState.OPEN, ReplicationType.RATIS, factor, pipelineName);
-          try (XceiverClientRatis client =
-              XceiverClientRatis.newXceiverClientRatis(pipeline, conf)) {
-            client.createPipeline(pipeline.getPipelineName(), newNodesList);
-          } catch (IOException e) {
-            return null;
-          }
-          return pipeline;
+          return PipelineSelector.newPipelineFromNodes(newNodesList,
+              ReplicationType.RATIS, factor, pipelineName);
-  /**
-   * Creates a pipeline from a specified set of Nodes.
-   *
-   * @param pipelineID - Name of the pipeline
-   * @param datanodes - The list of datanodes that make this pipeline.
-   */
-  @Override
-  public void createPipeline(String pipelineID,
-                             List<DatanodeDetails> datanodes) {
-
+  public void initializePipeline(Pipeline pipeline) throws IOException {
+    //TODO:move the initialization from SCM to client
+    try (XceiverClientRatis client =
+        XceiverClientRatis.newXceiverClientRatis(pipeline, conf)) {
+      client.createPipeline(pipeline.getPipelineName(), pipeline.getMachines());
+    }

UPD42 MOV43 MOV43 UPD42 MOV54 UPD66 INS32 UPD42 MOV42 INS42 INS41 INS32 MOV42 MOV42 MOV42 MOV40 MOV42 MOV42 DEL40 DEL26 DEL42 DEL40 DEL32 DEL59 DEL60 DEL42 DEL41 DEL66 DEL65 DEL42 DEL66 DEL65 DEL42 DEL66 DEL65 DEL29 DEL42 DEL78 DEL42 DEL43 DEL42 DEL43 DEL42 DEL43 DEL74 DEL42 DEL44 DEL42 DEL44 DEL33 DEL41 DEL8 DEL12