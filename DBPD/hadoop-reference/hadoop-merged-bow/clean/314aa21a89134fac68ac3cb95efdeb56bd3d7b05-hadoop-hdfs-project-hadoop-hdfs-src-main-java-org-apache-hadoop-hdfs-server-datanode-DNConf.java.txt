HDFS-10279. Improve validation of the configured number of tolerated failed volumes. Contributed by Lin Yiqun.

+  private final int volFailuresTolerated;
+  private final int volsConfigured;
+
+
+    this.volFailuresTolerated =
+        conf.getInt(DFSConfigKeys.DFS_DATANODE_FAILED_VOLUMES_TOLERATED_KEY,
+            DFSConfigKeys.DFS_DATANODE_FAILED_VOLUMES_TOLERATED_DEFAULT);
+    String[] dataDirs =
+        conf.getTrimmedStrings(DFSConfigKeys.DFS_DATANODE_DATA_DIR_KEY);
+    this.volsConfigured = (dataDirs == null) ? 0 : dataDirs.length;
+
+  public int getVolFailuresTolerated() {
+    return volFailuresTolerated;
+  }
+
+  public int getVolsConfigured() {
+    return volsConfigured;
+  }

INS23 INS23 INS31 INS31 INS83 INS83 INS39 INS59 INS83 INS83 INS39 INS59 INS83 INS39 INS42 INS8 INS83 INS39 INS42 INS8 INS42 INS42 INS21 INS60 INS21 INS41 INS41 INS7 INS5 INS59 INS7 INS42 INS42 INS22 INS32 INS43 INS85 INS42 INS32 INS22 INS16 INS52 INS42 INS42 INS42 INS40 INS40 INS42 INS42 INS42 INS40 INS52 INS42 INS36 INS34 INS40 INS27 INS42 INS33