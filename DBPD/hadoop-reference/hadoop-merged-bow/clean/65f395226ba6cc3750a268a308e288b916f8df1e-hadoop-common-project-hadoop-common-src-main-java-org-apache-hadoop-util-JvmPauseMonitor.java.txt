HADOOP-12321. Make JvmPauseMonitor an AbstractService. (Sunil G via Stevel) [includes HDFS-8947 MAPREDUCE-6462 and YARN-4072]

+import org.apache.hadoop.service.AbstractService;
-public class JvmPauseMonitor {
+public class JvmPauseMonitor extends AbstractService {
-  
+
-  private final long warnThresholdMs;
+  private long warnThresholdMs;
-  
+
-  private final long infoThresholdMs;
+  private long infoThresholdMs;
-   
+
-  public JvmPauseMonitor(Configuration conf) {
+  public JvmPauseMonitor() {
+    super(JvmPauseMonitor.class.getName());
+  }
+
+  @Override
+  protected void serviceInit(Configuration conf) throws Exception {
+    super.serviceInit(conf);
-  
-  public void start() {
-    Preconditions.checkState(monitorThread == null,
-        "Already started");
+
+  @Override
+  protected void serviceStart() throws Exception {
-    if (shouldRun) {
-      monitorThread.start();
-    } else {
-      LOG.warn("stop() was called before start() completed");
-    }
+    monitorThread.start();
+    super.serviceStart();
-  
-  public void stop() {
+
+  @Override
+  protected void serviceStop() throws Exception {
-    if (isStarted()) {
+    if (monitorThread != null) {
+    super.serviceStop();
-  
+
+  @SuppressWarnings("resource")
-    new JvmPauseMonitor(new Configuration()).start();
+    JvmPauseMonitor monitor = new JvmPauseMonitor();
+    monitor.init(new Configuration());
+    monitor.start();

INS26 INS40 INS43 INS31 INS42 INS83 INS42 INS8 INS78 UPD83 INS39 UPD42 INS43 INS78 UPD83 UPD42 INS43 MOV21 INS78 UPD83 UPD42 INS43 INS79 INS46 INS42 INS42 INS21 INS42 INS42 MOV21 INS42 INS42 INS21 INS42 INS45 INS60 INS21 INS32 INS48 INS48 INS27 INS48 MOV43 INS59 INS32 INS57 INS42 INS42 INS42 INS42 INS42 INS33 INS42 INS42 INS14 INS42 UPD42 MOV14 INS42 INS42 INS43 INS43 INS42 INS42 DEL83 DEL83 DEL42 DEL42 DEL42 DEL33 DEL27 DEL45 DEL32 DEL42 DEL8 DEL42 DEL42 DEL45 DEL32 DEL21 DEL8 DEL25 DEL42 DEL32 DEL14