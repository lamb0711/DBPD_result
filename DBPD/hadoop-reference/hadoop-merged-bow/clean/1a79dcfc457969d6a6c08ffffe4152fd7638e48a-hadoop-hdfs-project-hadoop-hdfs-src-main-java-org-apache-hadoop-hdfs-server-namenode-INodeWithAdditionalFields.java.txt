HDFS-12143. Improve performance of getting and removing inode features. Contributed by Daryn Sharp.

-    Preconditions.checkState(size > 0, "Feature "
-        + f.getClass().getSimpleName() + " not found.");
+    if (size == 0) {
+      throwFeatureNotFoundException(f);
+    }
-      Preconditions.checkState(features[0] == f, "Feature "
-          + f.getClass().getSimpleName() + " not found.");
+      if (features[0] != f) {
+        throwFeatureNotFoundException(f);
+      }
-    Preconditions.checkState(!overflow && j == size - 1, "Feature "
-        + f.getClass().getSimpleName() + " not found.");
+    if (overflow || j != size - 1) {
+      throwFeatureNotFoundException(f);
+    }
+  private void throwFeatureNotFoundException(Feature f) {
+    throw new IllegalStateException(
+        "Feature " + f.getClass().getSimpleName() + " not found.");
+  }
+
-    for (Feature f : features) {
+    final int size = features.length;
+    for (int i=0; i < size; i++) {
+      Feature f = features[i];

INS31 INS83 INS39 INS42 MOV44 INS8 INS25 INS25 INS53 INS60 INS24 INS27 INS8 UPD27 MOV27 INS8 INS14 INS83 INS39 INS59 INS58 INS27 INS37 MOV8 MOV42 MOV34 INS21 INS25 INS42 UPD27 MOV21 INS43 MOV27 INS42 INS40 INS39 INS59 INS42 INS42 INS42 INS60 INS32 UPD27 MOV27 INS8 INS42 INS42 INS34 INS43 INS59 INS42 MOV42 MOV21 UPD42 UPD42 INS42 INS42 INS2 INS42 INS42 UPD42 MOV42 DEL42 DEL42 DEL27 DEL45 DEL42 DEL32 DEL42 DEL32 DEL45 DEL27 DEL32 DEL21 DEL42 DEL45 DEL42 DEL32 DEL42 DEL32 DEL45 DEL27 DEL42 DEL38 DEL42 DEL70