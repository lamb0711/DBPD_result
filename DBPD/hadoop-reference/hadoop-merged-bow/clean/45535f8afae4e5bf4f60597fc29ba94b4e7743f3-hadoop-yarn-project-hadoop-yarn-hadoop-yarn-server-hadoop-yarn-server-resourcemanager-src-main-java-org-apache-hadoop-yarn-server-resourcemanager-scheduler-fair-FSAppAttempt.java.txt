YARN-6895. [FairScheduler] Preemption reservation may cause regular reservation leaks. (Miklos Szegedi via Yufei Gu)

+  /**
+   * Get last computed minshare starvation.
+   *
+   * @return last computed minshare starvation
+   */
+  Resource getMinshareStarvation() {
+    return minshareStarvation;
+  }
+
+    // Reserve only, if app does not wait for preempted resources on the node,
+    // otherwise we may end up with duplicate reservations
+        !node.isPreemptedForApp(this) &&
-        now - lastTimeAtFairShare < getQueue().getFairSharePreemptionTimeout()) {
+        now - lastTimeAtFairShare <
+            getQueue().getFairSharePreemptionTimeout()) {
-   * Is application starved for fairshare or minshare
+   * Is application starved for fairshare or minshare.

INS31 INS29 INS43 INS42 INS8 INS65 INS65 INS42 INS41 INS66 INS66 INS42 UPD66 INS38 INS32 INS42 INS42 INS52