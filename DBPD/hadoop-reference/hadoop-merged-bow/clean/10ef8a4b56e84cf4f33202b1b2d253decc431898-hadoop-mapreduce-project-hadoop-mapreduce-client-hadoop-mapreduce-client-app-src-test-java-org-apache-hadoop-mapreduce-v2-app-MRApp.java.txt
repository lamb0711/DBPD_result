Merge trunk to HDFS-4685.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-4685@1562670 13f79535-47bb-0310-9956-ffa450edef68

+  
+  // Queue to pretend the RM assigned us
+  private String assignedQueue;
-    this(maps, reduces, autoComplete, testName, cleanOnStart, 1, clock);
+    this(maps, reduces, autoComplete, testName, cleanOnStart, 1, clock, null);
+  
+  public MRApp(int maps, int reduces, boolean autoComplete, String testName,
+      boolean cleanOnStart, String assignedQueue) {
+    this(maps, reduces, autoComplete, testName, cleanOnStart, 1,
+        new SystemClock(), assignedQueue);
+  }
-        new SystemClock());
+        new SystemClock(), null);
-      cleanOnStart, startCount, clock, unregistered);
+      cleanOnStart, startCount, clock, unregistered, null);
-      boolean cleanOnStart, int startCount, Clock clock) {
+      boolean cleanOnStart, int startCount, Clock clock, String assignedQueue) {
-      cleanOnStart, startCount, clock, true);
+      cleanOnStart, startCount, clock, true, assignedQueue);
-        cleanOnStart, startCount, new SystemClock(), unregistered);
+        cleanOnStart, startCount, new SystemClock(), unregistered, null);
-        cleanOnStart, startCount, new SystemClock(), true);
+        cleanOnStart, startCount, new SystemClock(), true, null);
-      boolean cleanOnStart, int startCount, Clock clock, boolean unregistered) {
+      boolean cleanOnStart, int startCount, Clock clock, boolean unregistered,
+      String assignedQueue) {
+    this.assignedQueue = assignedQueue;
+    if (assignedQueue != null) {
+      job.setQueueName(assignedQueue);
+    }

MOV31 MOV31 MOV31 INS23 INS31 INS83 INS43 INS59 INS44 INS8 MOV44 INS83 INS42 INS44 INS44 INS44 INS44 INS44 MOV44 MOV44 INS44 MOV8 MOV44 INS44 INS42 INS42 INS43 INS42 INS17 INS39 INS42 INS39 INS42 INS39 INS42 INS43 INS42 INS39 INS42 INS43 INS42 INS43 INS42 INS21 INS25 INS33 INS42 INS34 INS14 INS42 INS42 INS42 INS42 INS42 INS42 INS42 MOV14 INS33 INS42 INS33 INS42 INS42 INS9 UPD42 INS42 INS33 INS9 INS33 INS42 INS7 INS27 INS8 INS43 INS22 INS42 INS42 INS33 INS21 INS42 INS52 INS42 INS32 INS42 INS42 INS42 DEL42 DEL9 DEL9 DEL42