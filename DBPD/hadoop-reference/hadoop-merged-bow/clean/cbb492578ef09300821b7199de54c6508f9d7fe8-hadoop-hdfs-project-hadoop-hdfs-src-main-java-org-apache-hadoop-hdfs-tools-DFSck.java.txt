HDFS-7789. DFSck should resolve the path to support cross-FS symlinks. (gera)

+
+  private Path getResolvedPath(String dir) throws IOException {
+    Configuration conf = getConf();
+    Path dirPath = new Path(dir);
+    FileSystem fs = dirPath.getFileSystem(conf);
+    return fs.resolvePath(dirPath);
+  }
+
-    final FileSystem fs;
-    try {
-      fs = target.getFileSystem(conf);
-    } catch (IOException ioe) {
-      System.err.println("FileSystem is inaccessible due to:\n"
-          + StringUtils.stringifyException(ioe));
-      return null;
-    }
+    final FileSystem fs = target.getFileSystem(conf);
-    
+
-    final Path dirpath = new Path(dir);
-    final URI namenodeAddress = getCurrentNamenodeAddress(dirpath);
+    Path dirpath = null;
+    URI namenodeAddress = null;
+    try {
+      dirpath = getResolvedPath(dir);
+      namenodeAddress = getCurrentNamenodeAddress(dirpath);
+    } catch (IOException ioe) {
+      System.err.println("FileSystem is inaccessible due to:\n"
+          + StringUtils.stringifyException(ioe));
+    }
+

INS31 INS83 INS43 INS42 INS44 INS43 INS8 INS42 INS43 INS42 INS42 INS60 MOV60 INS60 INS41 INS60 MOV54 INS42 INS43 INS59 INS43 INS59 INS32 INS43 INS59 MOV43 INS59 INS42 INS42 INS32 UPD42 INS42 INS42 INS32 INS42 INS42 INS42 MOV32 INS42 INS42 INS33 INS42 INS33 INS21 INS42 INS42 INS42 INS42 INS7 INS42 INS32 UPD42 MOV32 INS42 INS42 DEL83 DEL83 DEL42 DEL59 DEL33 DEL41