HADOOP-14432. S3A copyFromLocalFile to be robust, tested. Contributed by Steve Loughran

-   * @param src path
+   * @param src Source path: must be on local filesystem
-   * overwrite==false
+   * overwrite==false, or if the destination is a directory.
+   * @throws FileNotFoundException if the source file does not exit
+   * @throws IllegalArgumentException if the source path is not on the local FS
-    final String key = pathToKey(dst);
-
-    if (!overwrite && exists(dst)) {
-      throw new FileAlreadyExistsException(dst + " already exists");
-    }
+    if (!srcfile.exists()) {
+      throw new FileNotFoundException("No file: " + src);
+    }
+    if (!srcfile.isFile()) {
+      throw new FileNotFoundException("Not a file: " + src);
+    }
+    try {
+      FileStatus status = getFileStatus(dst);
+      if (!status.isFile()) {
+        throw new FileAlreadyExistsException(dst + " exists and is not a file");
+      }
+      if (!overwrite) {
+        throw new FileAlreadyExistsException(dst + " already exists");
+      }
+    } catch (FileNotFoundException e) {
+      // no destination, all is well
+    }
+    final String key = pathToKey(dst);

MOV60 INS65 INS65 INS25 INS25 INS54 UPD66 UPD66 INS42 INS66 INS42 INS66 INS38 INS8 INS38 INS8 INS8 INS12 INS32 INS53 INS32 INS53 INS60 INS25 MOV25 INS44 INS8 INS42 INS42 INS14 INS42 INS42 INS14 INS43 INS59 INS38 INS8 MOV38 INS43 INS42 INS43 INS27 INS43 INS27 INS42 INS42 INS32 INS32 INS53 INS42 INS42 INS45 INS42 INS42 INS45 INS42 INS42 INS42 INS42 INS42 INS14 INS43 INS27 INS42 INS42 INS45 DEL42 DEL42 DEL32 DEL27