HDFS-7716. Erasure Coding: extend BlockInfo to handle EC info. Contributed by Jing Zhao.

+import org.apache.hadoop.hdfs.protocol.Block;
-  class BlockIterator implements Iterator<BlockInfoContiguous> {
-    private BlockInfoContiguous current;
+  class BlockIterator implements Iterator<BlockInfo> {
+    private BlockInfo current;
-    BlockIterator(BlockInfoContiguous head) {
+    BlockIterator(BlockInfo head) {
-    public BlockInfoContiguous next() {
-      BlockInfoContiguous res = current;
+    public BlockInfo next() {
+      BlockInfo res = current;
-  private volatile BlockInfoContiguous blockList = null;
+  private volatile BlockInfo blockList = null;
-  public AddBlockResult addBlock(BlockInfoContiguous b) {
+  public AddBlockResult addBlock(BlockInfo b, Block reportedBlock) {
-    b.addStorage(this);
-    blockList = b.listInsert(blockList, this);
-    numBlocks++;
+    b.addStorage(this, reportedBlock);
+    insertToList(b);
-  public boolean removeBlock(BlockInfoContiguous b) {
+  AddBlockResult addBlock(BlockInfoContiguous b) {
+    return addBlock(b, b);
+  }
+
+  public void insertToList(BlockInfo b) {
+    blockList = b.listInsert(blockList, this);
+    numBlocks++;
+  }
+
+  public boolean removeBlock(BlockInfo b) {
-  Iterator<BlockInfoContiguous> getBlockIterator() {
+  Iterator<BlockInfo> getBlockIterator() {
-
-  int moveBlockToHead(BlockInfoContiguous b, int curIndex, int headIndex) {
+  int moveBlockToHead(BlockInfo b, int curIndex, int headIndex) {
-  BlockInfoContiguous getBlockListHeadForTesting(){
+  BlockInfo getBlockListHeadForTesting(){
-    ADDED, REPLACED, ALREADY_EXIST;
+    ADDED, REPLACED, ALREADY_EXIST

INS26 INS40 INS31 INS31 UPD74 UPD43 INS44 INS43 INS42 MOV44 INS8 INS83 INS39 INS42 INS44 INS8 UPD74 INS44 UPD43 UPD43 UPD43 UPD43 UPD42 UPD43 INS43 INS42 INS21 INS42 INS41 INS43 INS42 MOV21 MOV21 UPD43 UPD43 INS43 INS42 UPD42 UPD42 UPD42 UPD43 UPD42 UPD42 INS42 INS32 INS32 INS42 UPD42 UPD42 INS42 UPD42 UPD43 INS42 INS42 INS42 INS42 INS42 INS42 UPD42