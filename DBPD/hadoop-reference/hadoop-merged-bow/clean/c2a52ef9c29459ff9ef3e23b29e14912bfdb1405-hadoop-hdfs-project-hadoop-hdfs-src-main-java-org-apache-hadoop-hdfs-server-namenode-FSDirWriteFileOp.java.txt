HDFS-11643. Add shouldReplicate option to create builder. Contributed by SammiChen.

-      String ecPolicyName, boolean logRetryEntry)
+      boolean shouldReplicate, String ecPolicyName, boolean logRetryEntry)
-          replication, blockSize, holder, clientMachine, ecPolicyName);
+          replication, blockSize, holder, clientMachine, shouldReplicate,
+          ecPolicyName);
-      String clientName, String clientMachine, String ecPolicyName)
-      throws IOException {
+      String clientName, String clientMachine, boolean shouldReplicate,
+      String ecPolicyName) throws IOException {
-      ErasureCodingPolicy ecPolicy;
-      if (!StringUtils.isEmpty(ecPolicyName)) {
-        ecPolicy = FSDirErasureCodingOp.getErasureCodingPolicyByName(
-            fsd.getFSNamesystem(), ecPolicyName);
-      } else {
-        ecPolicy = FSDirErasureCodingOp.unprotectedGetErasureCodingPolicy(
-            fsd.getFSNamesystem(), existing);
-      }
-      if (ecPolicy != null) {
-        isStriped = true;
+      ErasureCodingPolicy ecPolicy = null;
+      if (!shouldReplicate) {
+        if (!StringUtils.isEmpty(ecPolicyName)) {
+          ecPolicy = FSDirErasureCodingOp.getErasureCodingPolicyByName(
+              fsd.getFSNamesystem(), ecPolicyName);
+        } else {
+          ecPolicy = FSDirErasureCodingOp.unprotectedGetErasureCodingPolicy(
+              fsd.getFSNamesystem(), existing);
+        }
+        if (ecPolicy != null) {
+          isStriped = true;
+        }

INS44 INS44 INS39 INS42 INS39 INS42 INS25 INS38 INS8 INS33 INS42 MOV25 MOV25 INS42