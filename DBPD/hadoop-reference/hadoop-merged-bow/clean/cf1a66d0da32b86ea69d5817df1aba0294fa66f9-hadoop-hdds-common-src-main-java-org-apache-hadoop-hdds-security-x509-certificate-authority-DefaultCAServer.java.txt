HDDS-1101. SCM CA: Write Certificate information to SCM Metadata. Contributed by Anu Engineer.

+  private CertificateStore store;
-   *
-   * @param subject - String Subject
+   *  @param subject - String Subject
+   * @param certificateStore - A store used to persist Certificates.
-  public DefaultCAServer(String subject, String clusterID, String scmID) {
+  public DefaultCAServer(String subject, String clusterID, String scmID,
+                         CertificateStore certificateStore) {
+    this.store = certificateStore;
+        store.storeValidCertificate(xcert.getSerialNumber(),
+            CertificateCodec.getX509Certificate(xcert));
-    } catch (IOException | OperatorCreationException e) {
+    } catch (CertificateException | IOException | OperatorCreationException e) {
+      LOG.error("Unable to issue a certificate. {}", e);
-    return null;
+    CompletableFuture<Boolean> revoked = new CompletableFuture<>();
+    if (certificate == null) {
+      revoked.completeExceptionally(new SCMSecurityException(
+          "Certificate cannot be null"));
+      return revoked;
+    }
+    try {
+      store.revokeCertificate(certificate.getSerialNumber());
+    } catch (IOException ex) {
+      LOG.error("Revoking the certificate failed. {}", ex.getCause());
+      throw new SCMSecurityException(ex);
+    }
+    return revoked;

INS23 INS83 INS43 INS59 INS44 INS8 INS42 INS42 INS65 INS43 INS42 INS21 INS60 INS25 INS54 INS41 INS42 INS66 INS42 INS7 INS74 INS59 INS27 INS8 INS8 INS12 INS42 INS22 INS42 INS43 INS43 INS42 INS14 INS42 INS33 INS21 MOV41 INS21 INS44 INS8 INS52 INS42 INS21 UPD84 INS21 INS42 INS42 INS74 INS32 INS42 INS32 INS43 INS42 INS21 INS53 INS32 INS43 INS32 INS43 INS42 INS42 INS14 INS42 INS42 INS32 INS42 INS32 INS14 INS42 INS42 INS32 INS32 INS42 INS42 INS42 INS45 INS42 INS42 INS43 INS45 INS42 INS42 INS42 INS42 INS45 INS32 INS43 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 DEL33 DEL8