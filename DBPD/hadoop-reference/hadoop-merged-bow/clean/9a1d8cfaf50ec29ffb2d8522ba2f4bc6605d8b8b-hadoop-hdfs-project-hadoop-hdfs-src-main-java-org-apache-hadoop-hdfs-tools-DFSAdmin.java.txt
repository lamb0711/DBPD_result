HDFS-14678. Allow triggerBlockReport to a specific namenode. (#1252). Contributed by Leon Gao.


-    "\t[-triggerBlockReport [-incremental] <datanode_host:ipc_port>]\n" +
+    "\t[-triggerBlockReport [-incremental] <datanode_host:ipc_port> [-namenode <namenode_host:ipc_port>]]\n" +
+    // Block report to a specific namenode
+    InetSocketAddress namenodeAddr = null;
+    String nnHostPort = StringUtils.popOptionWithArgument("-namenode", args);
+    if (nnHostPort != null) {
+      namenodeAddr = NetUtils.createSocketAddr(nnHostPort);
+    }
+
+              setNamenodeAddr(namenodeAddr).
-        "block report on " + hostPort + ".");
+        "block report on " + hostPort +
+        (namenodeAddr == null ? "" : " to namenode " + nnHostPort) +
+        ".");
-      "-triggerBlockReport [-incremental] <datanode_host:ipc_port>\n"
+      "-triggerBlockReport [-incremental] <datanode_host:ipc_port> [-namenode <namenode_host:ipc_port>]\n"
-          + " [-triggerBlockReport [-incremental] <datanode_host:ipc_port>]");
+          + " [-triggerBlockReport [-incremental] <datanode_host:ipc_port> [-namenode <namenode_host:ipc_port>]]");
-      if ((argv.length != 2) && (argv.length != 3)) {
+      if ((argv.length < 2) || (argv.length > 5)) {

INS60 INS60 INS25 MOV25 UPD45 INS43 INS59 INS43 INS59 INS27 INS8 MOV32 MOV8 INS42 INS42 INS33 INS42 INS42 INS32 INS42 INS33 INS21 MOV32 MOV8 INS42 INS42 INS45 INS42 INS7 INS32 INS36 UPD45 MOV32 MOV8 INS42 INS32 INS42 INS42 MOV32 MOV42 INS16 MOV32 MOV8 INS42 INS42 INS42 UPD42 INS27 INS45 INS27 MOV32 MOV8 UPD42 INS42 INS42 INS33 INS45 INS42 MOV32 MOV8 UPD42 UPD42 MOV32 MOV8 MOV32 MOV8 MOV32 MOV8 MOV32 MOV8 MOV32 MOV8 MOV32 MOV8 MOV32 MOV8 MOV32 MOV8 MOV32 MOV8 MOV32 MOV8 MOV32 MOV8 MOV32 MOV8 MOV32 MOV8 MOV32 MOV8 MOV32 MOV8 MOV32 MOV8 MOV32 MOV8 MOV32 INS25 MOV32 MOV8 INS25 MOV32 INS8 MOV25 INS25 INS27 INS8 INS36 INS36 INS21 INS41 INS27 INS27 INS32 INS42 INS40 INS34 INS40 INS34 INS42 INS42 UPD45 DEL42 DEL40 DEL34 DEL27 DEL36 DEL40 DEL34 DEL27 DEL36 DEL27 DEL42 DEL42 DEL32 DEL21 DEL42 DEL41 DEL8 DEL25 DEL8 DEL25 DEL25