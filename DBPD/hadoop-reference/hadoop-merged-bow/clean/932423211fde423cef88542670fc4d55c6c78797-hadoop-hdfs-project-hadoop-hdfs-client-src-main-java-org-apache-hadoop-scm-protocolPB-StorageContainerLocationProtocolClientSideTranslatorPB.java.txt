HDFS-11469. Ozone: SCM: Container allocation based on node report. Contributed by Xiaoyu Yao.

+import org.apache.hadoop.scm.client.ScmClient;
+    return allocateContainer(containerName, ScmClient.ReplicationFactor.ONE);
+  }
+
+  /**
+   * Asks SCM where a container should be allocated. SCM responds with the set
+   * of datanodes that should be used creating this container. Ozone/SCM only
+   * supports replication factor of either 1 or 3.
+   *
+   * @param containerName - Name of the container.
+   * @param replicationFactor - replication factor.
+   * @return Pipeline.
+   * @throws IOException
+   */
+  @Override
+  public Pipeline allocateContainer(String containerName,
+      ScmClient.ReplicationFactor replicationFactor) throws IOException {
-
-        .setContainerName(containerName).build();
+        .setContainerName(containerName).setReplicationFactor(PBHelperClient
+            .convertReplicationFactor(replicationFactor)).build();
-    final  ContainerResponseProto response;
+    final ContainerResponseProto response;

INS26 INS40 INS31 MOV29 INS78 INS83 INS43 INS42 INS44 INS43 INS8 INS29 INS44 INS42 INS42 INS43 INS42 INS42 INS41 INS65 INS65 INS65 INS65 INS65 INS43 INS42 INS42 INS32 INS66 INS66 INS66 INS42 INS66 INS42 INS66 INS66 INS42 INS40 INS42 INS42 INS40 INS32 MOV32 INS42 INS42 INS32 UPD42 MOV42 INS42 INS42