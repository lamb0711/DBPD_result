HDFS-9100. HDFS Balancer does not respect dfs.client.use.datanode.hostname. Contributed by Casey Brotherton.

+import org.apache.hadoop.hdfs.client.HdfsClientConfigKeys;
+  private final boolean connectToDnViaHostname;
+
-            NetUtils.createSocketAddr(target.getDatanodeInfo().getXferAddr()),
-            HdfsConstants.READ_TIMEOUT);
+            NetUtils.createSocketAddr(target.getDatanodeInfo().
+                getXferAddr(Dispatcher.this.connectToDnViaHostname)),
+                HdfsConstants.READ_TIMEOUT);
+    this.connectToDnViaHostname = conf.getBoolean(
+        HdfsClientConfigKeys.DFS_CLIENT_USE_DN_HOSTNAME,
+        HdfsClientConfigKeys.DFS_CLIENT_USE_DN_HOSTNAME_DEFAULT);

INS26 INS40 INS23 INS83 INS83 INS39 INS59 INS42 INS21 INS7 INS22 INS32 INS52 INS42 INS42 INS42 INS40 INS40 INS22 INS52 INS42 INS42