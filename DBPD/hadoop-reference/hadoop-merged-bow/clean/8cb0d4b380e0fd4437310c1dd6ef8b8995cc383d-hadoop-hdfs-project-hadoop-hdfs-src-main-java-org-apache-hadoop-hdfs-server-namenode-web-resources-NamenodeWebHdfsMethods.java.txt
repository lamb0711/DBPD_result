HDFS-2432. Webhdfs: response FORBIDDEN when setReplication on non-files; clear umask before creating a flie; throw IllegalArgumentException if setOwner with both owner and group empty; throw FileNotFoundException if getFileStatus on non-existing files; fix bugs in getBlockLocations; and changed getFileChecksum json response root to "FileChecksum".


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1190077 13f79535-47bb-0310-9956-ffa450edef68

+import javax.ws.rs.core.Response.ResponseBuilder;
+import javax.ws.rs.core.Response.Status;
-      return Response.ok(js).type(MediaType.APPLICATION_JSON).build();
+      final ResponseBuilder r = b? Response.ok(): Response.status(Status.FORBIDDEN);
+      return r.entity(js).type(MediaType.APPLICATION_JSON).build();
+      if (owner.getValue() == null && group.getValue() == null) {
+        throw new IllegalArgumentException("Both owner and group are empty.");
+      }
+
-          offsetValue, lengthValue != null? lengthValue: offsetValue + 1);
+          offsetValue, lengthValue != null? lengthValue: Long.MAX_VALUE);
+      if (status == null) {
+        throw new FileNotFoundException("File does not exist: " + fullpath);
+      }
+

INS26 INS26 INS40 INS40 INS60 INS25 INS25 INS83 INS43 INS59 INS27 INS8 INS27 INS8 INS42 INS42 INS16 INS27 INS27 INS53 INS42 INS33 INS53 INS42 INS32 INS32 INS32 INS33 INS32 INS33 INS14 INS14 INS42 INS42 INS42 INS42 INS40 UPD42 UPD42 INS42 INS42 INS42 INS42 INS43 INS45 INS40 INS43 INS27 INS42 INS42 INS45 INS42 DEL42 DEL34 DEL27