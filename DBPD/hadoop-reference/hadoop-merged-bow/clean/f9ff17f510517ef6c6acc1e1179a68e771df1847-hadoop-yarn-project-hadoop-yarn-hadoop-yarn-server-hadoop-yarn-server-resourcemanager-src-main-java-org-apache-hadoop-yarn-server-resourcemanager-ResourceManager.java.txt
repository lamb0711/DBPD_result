Merge branch 'YARN-5734' into trunk. (xgong)

-      this.zkManager = createAndStartZKManager(conf);
+      this.zkManager = getAndStartZKManager(conf);
-   * Create and ZooKeeper Curator manager.
+   * Get ZooKeeper Curator manager, creating and starting if not exists.
-   * @return New ZooKeeper Curator manager.
+   * @return ZooKeeper Curator manager.
-  public ZKCuratorManager createAndStartZKManager(Configuration config)
-      throws IOException {
+  public synchronized ZKCuratorManager getAndStartZKManager(Configuration
+      config) throws IOException {
+    if (this.zkManager != null) {
+      return zkManager;
+    }
-    return manager;
-  }
-
-  /**
-   * Get the ZooKeeper Curator manager.
-   * @return ZooKeeper Curator manager.
-   */
-  public ZKCuratorManager getZKManager() {
-    return this.zkManager;
+    this.zkManager = manager;
+    return zkManager;

INS83 UPD42 MOV65 INS25 INS21 INS41 UPD66 INS27 INS8 INS7 INS42 INS22 INS33 MOV41 MOV22 INS42 INS52 INS42 UPD42 UPD42 DEL66 DEL65 DEL29 DEL83 DEL42 DEL43 DEL42 DEL41 DEL8 DEL31