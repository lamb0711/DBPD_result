YARN-4862. Handle duplicate completed containers in RMNodeImpl. Contributed by Rohith Sharma K S

+import org.apache.hadoop.yarn.server.resourcemanager.rmnode.RMNodeFinishedContainersPulledByAMEvent;
+   * @param nodeId NodeId corresponding to the NodeManager
-      completedContainers, Resource releasedResources) {
+      completedContainers, Resource releasedResources, NodeId nodeId) {
+    List<ContainerId> untrackedContainerIdList = new ArrayList<ContainerId>();
-      completedContainer(getRMContainer(containerId),
+      completedContainer(container,
+      } else {
+        // Add containers which are untracked by RM.
+        untrackedContainerIdList.add(containerId);
+
+    // Acknowledge NM to remove RM-untracked-containers from NM context.
+    if (!untrackedContainerIdList.isEmpty()) {
+      this.rmContext.getDispatcher().getEventHandler()
+          .handle(new RMNodeFinishedContainersPulledByAMEvent(nodeId,
+              untrackedContainerIdList));
+    }
+
-        releasedResources);
+        releasedResources, nm.getNodeID());
+

INS26 INS40 INS44 INS65 INS43 INS42 INS60 INS25 INS42 INS66 INS42 INS74 INS59 INS38 INS8 INS43 INS43 INS42 INS14 INS32 INS21 INS42 INS42 INS74 INS8 INS42 INS42 INS32 INS32 INS43 INS43 UPD42 MOV42 INS21 INS32 INS42 INS14 INS42 INS42 INS42 INS42 INS32 INS32 INS42 INS43 INS42 INS42 INS42 INS42 INS42 INS22 INS42 INS42 INS52 INS42 DEL42 DEL32