HDFS-14354: Refactor MappableBlock to align with the implementation of SCM cache. Contributed by Feilong He.

+  private final MappableBlockLoader mappableBlockLoader;
+
-  public FsDatasetCache(FsDatasetImpl dataset) {
+  public FsDatasetCache(FsDatasetImpl dataset) throws IOException {
+    this.mappableBlockLoader = new MemoryMappableBlockLoader();
-          mappableBlock = MappableBlock.
-              load(length, blockIn, metaIn, blockFileName);
+          mappableBlock = mappableBlockLoader.load(length, blockIn, metaIn,
+              blockFileName, key);
-          LOG.warn("Failed to cache " + key, e);
+          LOG.warn("Failed to cache the block [key=" + key + "]!", e);
-          if (mappableBlock != null) {
-            mappableBlock.close();
-          }
+          IOUtils.closeQuietly(mappableBlock);

INS23 INS83 INS83 INS43 INS59 INS43 INS42 INS42 INS42 INS21 INS7 INS22 INS14 INS52 INS42 INS43 INS42 MOV21 UPD42 UPD42 INS42 UPD42 INS42 UPD45 INS45 DEL42 DEL33 DEL27 DEL8 DEL25