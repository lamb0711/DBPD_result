YARN-6040. Introduce api independent PendingAsk to replace usage of ResourceRequest within Scheduler classes. (Wangda Tan via asuresh)

-import java.util.Arrays;
+import org.apache.hadoop.yarn.server.resourcemanager.scheduler.common.PendingAsk;
-  public Map<String, ResourceRequest> getResourceRequests(
-      SchedulerRequestKey schedulerKey) {
-    return appSchedulingInfo.getResourceRequests(schedulerKey);
-  }
-
-  
-  public ResourceRequest getResourceRequest(
+
+  public PendingAsk getPendingAsk(
-      return appSchedulingInfo.getResourceRequest(schedulerKey, resourceName);
-    } finally {
-      readLock.unlock();
-    }
-
-  }
-
-  public int getTotalRequiredResources(
-      SchedulerRequestKey schedulerKey) {
-    try {
-      readLock.lock();
-      ResourceRequest request =
-          getResourceRequest(schedulerKey, ResourceRequest.ANY);
-      return request == null ? 0 : request.getNumContainers();
+      return appSchedulingInfo.getPendingAsk(schedulerKey, resourceName);
-  public Resource getResource(SchedulerRequestKey schedulerKey) {
+  public int getOutstandingAsksCount(SchedulerRequestKey schedulerKey) {
+    return getOutstandingAsksCount(schedulerKey, ResourceRequest.ANY);
+  }
+
+  public int getOutstandingAsksCount(SchedulerRequestKey schedulerKey,
+      String resourceName) {
-      return appSchedulingInfo.getResource(schedulerKey);
+      SchedulingPlacementSet ps = appSchedulingInfo.getSchedulingPlacementSet(
+          schedulerKey);
+      return ps == null ? 0 : ps.getOutstandingAsksCount(resourceName);
-          Map<String, ResourceRequest> requests = getResourceRequests(
-              schedulerKey);
-          if (requests != null) {
+          SchedulingPlacementSet ps = getSchedulingPlacementSet(schedulerKey);
+          if (ps != null &&
+              ps.getOutstandingAsksCount(ResourceRequest.ANY) > 0) {
-            for (ResourceRequest request : requests.values()) {
-              LOG.debug("showRequests:" + " application=" + getApplicationId()
-                  + " request=" + request);
-            }
+            ps.showRequests();

MOV26 MOV31 UPD40 UPD43 UPD42 MOV44 INS39 UPD42 MOV44 INS42 INS44 UPD42 INS43 INS42 INS42 UPD42 INS40 UPD43 UPD42 UPD42 UPD42 INS42 UPD42 UPD42 UPD42 UPD42 INS42 INS43 INS27 UPD42 MOV42 UPD42 INS27 INS27 MOV21 UPD42 UPD42 MOV42 MOV33 INS32 INS34 INS42 INS42 INS40 UPD42 INS42 DEL42 DEL43 DEL42 DEL43 DEL42 DEL43 DEL74 DEL42 DEL42 DEL40 DEL83 DEL42 DEL43 DEL42 DEL42 DEL43 DEL42 DEL44 DEL42 DEL42 DEL32 DEL21 DEL42 DEL42 DEL42 DEL32 DEL41 DEL8 DEL42 DEL42 DEL32 DEL21 DEL8 DEL54 DEL8 DEL31 DEL42 DEL43 DEL43 DEL42 DEL43 DEL74 DEL27 DEL42 DEL45 DEL45 DEL27 DEL42 DEL32 DEL45 DEL42 DEL27 DEL42 DEL43 DEL42 DEL44 DEL42 DEL42 DEL32 DEL8 DEL70