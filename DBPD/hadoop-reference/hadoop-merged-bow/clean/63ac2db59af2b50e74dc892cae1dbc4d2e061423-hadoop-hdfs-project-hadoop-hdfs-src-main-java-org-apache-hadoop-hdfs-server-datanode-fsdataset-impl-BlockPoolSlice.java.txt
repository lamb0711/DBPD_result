HDFS-10312. Large block reports may fail to decode at NameNode due to 64 MB protobuf maximum length restriction. Contributed by Chris Nauroth.

+import org.apache.hadoop.fs.CommonConfigurationKeys;
+  private final int maxDataLength;
+
+    this.maxDataLength = conf.getInt(
+        CommonConfigurationKeys.IPC_MAXIMUM_DATA_LENGTH,
+        CommonConfigurationKeys.IPC_MAXIMUM_DATA_LENGTH_DEFAULT);
+
-      BlockListAsLongs blocksList =  BlockListAsLongs.readFrom(inputStream);
+      BlockListAsLongs blocksList =
+          BlockListAsLongs.readFrom(inputStream, maxDataLength);

INS26 INS40 INS23 INS83 INS83 INS39 INS59 INS42 INS21 INS7 INS22 INS32 INS52 INS42 INS42 INS42 INS40 INS40 INS42