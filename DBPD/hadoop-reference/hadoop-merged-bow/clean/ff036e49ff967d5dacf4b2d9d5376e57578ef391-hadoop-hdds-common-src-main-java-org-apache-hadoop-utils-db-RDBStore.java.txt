HDDS-357. Use DBStore and TableStore for OzoneManager non-background service.
Contributed by Nandakumar.

+
+    move(key, key, value, source, dest);
+  }
+
+  @Override
+  public void move(byte[] sourceKey, byte[] destKey, byte[] value, Table source,
+      Table dest) throws IOException {
-      batch.put(destTable.getHandle(), key, value);
-      batch.delete(sourceTable.getHandle(), key);
+      batch.put(destTable.getHandle(), destKey, value);
+      batch.delete(sourceTable.getHandle(), sourceKey);
-      LOG.error("Move of key failed. Key:{}", DFSUtil.bytes2String(key));
-      throw toIOException("Unable to move key: " + DFSUtil.bytes2String(key),
-          rockdbException);
+      LOG.error("Move of key failed. Key:{}", DFSUtil.bytes2String(sourceKey));
+      throw toIOException("Unable to move key: " +
+              DFSUtil.bytes2String(sourceKey), rockdbException);
+  @Override
+  public void write(WriteBatch batch) throws IOException {
+    try {
+      db.write(writeOptions, batch);
+    } catch (RocksDBException e) {
+      throw toIOException("Unable to write the batch.", e);
+    }
+  }
+

INS31 INS31 INS78 INS83 INS39 INS42 MOV44 INS44 INS44 INS44 INS43 INS8 INS44 INS44 INS78 INS83 INS39 INS42 INS44 INS43 INS8 INS42 INS5 INS42 INS43 INS42 INS43 INS42 INS42 INS21 INS5 INS42 INS5 INS42 INS42 INS43 INS42 INS42 INS54 INS39 INS85 INS42 INS42 INS32 INS39 INS85 INS39 INS85 INS42 INS8 INS12 INS42 INS42 INS42 INS42 INS42 INS42 INS21 INS44 INS8 INS32 INS43 INS42 INS53 UPD42 UPD42 INS42 INS42 INS42 INS42 INS42 INS32 INS42 INS45 INS42 UPD42 UPD42