HDFS-6977. Delete all copies when a block is deleted from the block space. (Arpit Agarwal)

-   * @return the new meta file.
+   * @return the new meta and block files.
-  static File copyBlockFiles(ReplicaInfo replicaInfo, File destRoot)
+  static File[] copyBlockFiles(ReplicaInfo replicaInfo, File destRoot)
-    return dstMeta;
+    return new File[] {dstMeta, dstFile};
-        File savedBlockFile = targetVolume.getBlockPoolSlice(bpid)
-                                          .lazyPersistReplica(replicaInfo);
-        lazyWriteReplicaTracker.recordEndLazyPersist(bpid, blockId, savedBlockFile);
+        File[] savedFiles = targetVolume.getBlockPoolSlice(bpid)
+                                        .lazyPersistReplica(replicaInfo);
+        lazyWriteReplicaTracker.recordEndLazyPersist(
+            bpid, blockId, savedFiles[0], savedFiles[1]);
-                        " to file " + savedBlockFile);
+                        " to file " + savedFiles[1]);

INS5 MOV43 INS85 UPD66 INS3 INS5 INS4 INS43 INS85 INS42 INS42 INS42 INS5 MOV43 INS85 UPD42 INS2 INS2 INS42 INS34 INS42 INS34 INS2 INS42 INS34 DEL42 DEL42 DEL42