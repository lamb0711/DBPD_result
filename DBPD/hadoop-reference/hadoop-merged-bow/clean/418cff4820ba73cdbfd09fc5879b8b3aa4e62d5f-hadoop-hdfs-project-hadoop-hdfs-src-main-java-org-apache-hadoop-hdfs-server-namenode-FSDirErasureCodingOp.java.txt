Merge remote-tracking branch 'apache-commit/trunk' into HDDS-48

+import org.apache.commons.lang.StringUtils;
-   * Check if the file or directory has an erasure coding policy.
+   * Get the erasure coding policy information for specified path and policy
+   * name. If ec policy name is given, it will be parsed and the corresponding
+   * policy will be returned. Otherwise, get the policy from the parents of the
+   * iip.
+   * @param ecPolicyName the ec policy name
-   * @return Whether the file or directory has an erasure coding policy.
+   * @return {@link ErasureCodingPolicy}, or null if no policy is found
-  static boolean hasErasureCodingPolicy(final FSNamesystem fsn,
-      final INodesInPath iip) throws IOException {
-    return unprotectedGetErasureCodingPolicy(fsn, iip) != null;
+  static ErasureCodingPolicy getErasureCodingPolicy(FSNamesystem fsn,
+      String ecPolicyName, INodesInPath iip) throws IOException {
+    ErasureCodingPolicy ecPolicy;
+    if (!StringUtils.isEmpty(ecPolicyName)) {
+      ecPolicy = FSDirErasureCodingOp.getErasureCodingPolicyByName(
+          fsn, ecPolicyName);
+    } else {
+      ecPolicy = FSDirErasureCodingOp.unprotectedGetErasureCodingPolicy(
+          fsn, iip);
+    }
+    return ecPolicy;

INS26 INS40 INS43 INS42 INS44 INS8 INS65 INS42 INS43 INS42 INS60 INS25 INS41 UPD66 INS66 INS66 INS66 INS42 INS66 INS66 INS65 UPD66 INS42 INS43 INS59 INS38 INS8 INS8 INS42 INS42 INS42 INS42 INS32 INS21 INS21 INS42 INS42 INS42 INS7 INS7 INS42 INS32 INS42 INS32 INS42 INS42 INS42 INS42 INS42 MOV42 MOV42 MOV42 DEL39 DEL42 DEL83 DEL83 DEL32 DEL33 DEL27 DEL41 DEL8