HDFS-10391. Always enable NameNode service RPC port. Contributed by Gergely Novak.

-   * based on the value of fallback returns null if the special
-   * address is not specified or returns the default namenode address
-   * to be used by both clients and services.
-  public static InetSocketAddress getServiceAddress(Configuration conf,
-                                                        boolean fallback) {
-    String addr = conf.getTrimmed(DFS_NAMENODE_SERVICE_RPC_ADDRESS_KEY);
-    if (addr == null || addr.isEmpty()) {
-      return fallback ? DFSUtilClient.getNNAddress(conf) : null;
+  public static InetSocketAddress getServiceAddress(Configuration conf) {
+    String address = conf.getTrimmed(DFS_NAMENODE_SERVICE_RPC_ADDRESS_KEY);
+    if (address == null || address.isEmpty()) {
+      InetSocketAddress rpcAddress = DFSUtilClient.getNNAddress(conf);
+      return NetUtils.createSocketAddr(rpcAddress.getHostName(),
+          HdfsClientConfigKeys.DFS_NAMENODE_SERVICE_RPC_PORT_DEFAULT);
-    return DFSUtilClient.getNNAddress(addr);
+    return NetUtils.createSocketAddr(address,
+        HdfsClientConfigKeys.DFS_NAMENODE_SERVICE_RPC_PORT_DEFAULT);
-    return NameNode.getServiceAddress(conf, false);
+    return NameNode.getServiceAddress(conf);
-   * Modifies the configuration passed to contain the service rpc address setting
+   * Modifies the configuration passed to contain the service rpc address
+   * setting.
+   * @return NameNode service RPC address in "host:port" string form
+   */
+  public String getServiceRpcAddressHostPortString() {
+    return NetUtils.getHostPortString(getServiceRpcAddress());
+  }
+
+  /**

INS31 INS29 INS83 INS43 INS42 INS8 INS65 INS42 INS41 UPD66 INS66 INS66 INS32 UPD42 INS60 UPD42 UPD42 UPD42 INS40 INS42 INS42 INS32 UPD42 UPD42 INS43 INS59 INS32 INS42 INS42 INS42 MOV32 INS42 INS42 INS32 INS40 INS42 INS42 DEL66 DEL66 DEL66 DEL39 DEL42 DEL44 DEL42 DEL33 DEL16 DEL9