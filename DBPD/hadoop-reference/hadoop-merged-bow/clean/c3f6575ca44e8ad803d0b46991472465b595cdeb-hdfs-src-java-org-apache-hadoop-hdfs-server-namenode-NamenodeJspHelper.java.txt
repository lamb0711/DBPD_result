HDFS-2147. Move cluster network topology to block management and fix some javac warnings.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1148112 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.net.NetworkTopology;
+import org.apache.hadoop.net.NodeBase;
+  /** @return the network topology. */
+  static NetworkTopology getNetworkTopology(final NameNode namenode) {
+    return namenode.getNamesystem().getBlockManager().getDatanodeManager(
+        ).getNetworkTopology();
+  }
+
+  /** @return a randomly chosen datanode. */
+  static DatanodeDescriptor getRandomDatanode(final NameNode namenode) {
+    return (DatanodeDescriptor)getNetworkTopology(namenode).chooseRandom(
+        NodeBase.ROOT);
+  }
+  
-    final DatanodeID datanode = nn.getNamesystem().getRandomDatanode();
+    final DatanodeID datanode = getRandomDatanode(nn);

INS26 INS26 INS40 INS40 INS31 INS31 INS29 INS83 INS43 INS42 INS44 INS8 INS29 INS83 INS43 INS42 INS44 INS8 INS65 INS42 INS83 INS43 INS42 INS41 INS65 INS42 INS83 INS43 INS42 INS41 INS66 INS42 INS32 INS66 INS42 INS11 INS32 INS42 INS43 INS32 INS32 INS42 INS42 INS32 INS42 INS40 UPD42 MOV42 UPD42 INS32 INS42 INS42 INS42 INS42 INS42 DEL42 DEL32