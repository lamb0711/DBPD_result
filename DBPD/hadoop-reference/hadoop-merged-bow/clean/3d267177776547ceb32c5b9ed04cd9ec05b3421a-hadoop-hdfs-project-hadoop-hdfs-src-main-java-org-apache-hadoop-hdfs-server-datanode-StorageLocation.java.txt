HDFS-11119. Support for parallel checking of StorageLocations on DataNode startup.

This closes #155.

-import org.apache.hadoop.fs.StorageType;
+import org.apache.hadoop.fs.StorageType;
-import org.apache.hadoop.hdfs.server.common.Storage;
+import org.apache.hadoop.hdfs.server.common.Storage;
+import org.apache.hadoop.hdfs.server.datanode.checker.Checkable;
+import org.apache.hadoop.hdfs.server.datanode.checker.VolumeCheckResult;
-public class StorageLocation implements Comparable<StorageLocation>{
-  final StorageType storageType;
+public class StorageLocation
+    implements Checkable<StorageLocation.CheckContext, VolumeCheckResult>,
+               Comparable<StorageLocation> {
+  private final StorageType storageType;
+
+  @Override  // Checkable
+  public VolumeCheckResult check(CheckContext context) throws IOException {
+    DiskChecker.checkDir(
+        context.localFileSystem,
+        new Path(baseURI),
+        context.expectedPermission);
+    return VolumeCheckResult.HEALTHY;
+  }
+
+  /**
+   * Class to hold the parameters for running a {@link #check}.
+   */
+  public static final class CheckContext {
+    private final LocalFileSystem localFileSystem;
+    private final FsPermission expectedPermission;
+
+    public CheckContext(LocalFileSystem localFileSystem,
+                        FsPermission expectedPermission) {
+      this.localFileSystem = localFileSystem;
+      this.expectedPermission = expectedPermission;
+    }
+  }

MOV26 MOV26 INS26 INS26 INS40 INS40 INS74 INS31 INS55 INS43 INS43 INS43 INS83 INS78 INS83 INS43 INS42 INS44 INS43 INS8 INS29 INS83 INS83 INS83 INS42 INS23 INS23 INS31 INS42 INS40 INS42 INS42 INS42 INS43 INS42 INS42 INS21 INS41 INS65 INS83 INS83 INS43 INS59 INS83 INS83 INS43 INS59 INS83 INS42 INS44 INS44 INS8 INS42 INS32 INS40 INS66 INS65 INS66 INS42 INS42 INS42 INS42 INS43 INS42 INS43 INS42 INS21 INS21 INS42 INS42 INS40 INS14 INS40 INS67 INS42 INS42 INS7 INS7 INS43 INS42 INS42 INS22 INS42 INS22 INS42 INS42 INS52 INS42 INS52 INS42