YARN-2496. Enhanced Capacity Scheduler to have basic support for allocating resources based on node-labels. Contributed by Wangda Tan.
YARN-2500. Ehnaced ResourceManager to support schedulers allocating resources based on node-labels. Contributed by Wangda Tan.

+import org.apache.hadoop.yarn.api.records.ApplicationSubmissionContext;
-                + applicationAttemptId.getApplicationId();
+                + appID;
-            .get(applicationAttemptId.getApplicationId()).getUser(),
+            .get(appID).getUser(),
-          applicationAttemptId.getApplicationId(), applicationAttemptId);
+          appID, applicationAttemptId);
+    ApplicationId appId = applicationAttemptId.getApplicationId();
-                + applicationAttemptId.getApplicationId();
+                + appId;
-                .get(applicationAttemptId.getApplicationId()).getUser(),
+                .get(appId).getUser(),
-            message, applicationAttemptId.getApplicationId(),
+            message, appId,
-          rmContext.getRMApps().get(applicationAttemptId.getApplicationId());
+          rmContext.getRMApps().get(appId);
+    ApplicationId applicationId = appAttemptId.getApplicationId();
-                + appAttemptId.getApplicationId()
+                + applicationId
-            this.rmContext.getRMApps().get(appAttemptId.getApplicationId())
+            this.rmContext.getRMApps().get(applicationId)
-            appAttemptId.getApplicationId(),
+            applicationId,
-
+      RMApp app =
+          this.rmContext.getRMApps().get(applicationId);
+      
+      // set label expression for Resource Requests
+      ApplicationSubmissionContext asc = app.getApplicationSubmissionContext();
+      for (ResourceRequest req : ask) {
+        if (null == req.getNodeLabelExpression()) {
+          req.setNodeLabelExpression(asc.getNodeLabelExpression());
+        }
+      }
+              
-            rScheduler.getMaximumResourceCapability());
+            rScheduler.getMaximumResourceCapability(), app.getQueue(),
+            rScheduler);
-      RMApp app =
-          this.rmContext.getRMApps().get(appAttemptId.getApplicationId());
-            + " to application: " + appAttemptId.getApplicationId());
+            + " to application: " + applicationId);

INS26 INS40 MOV60 MOV60 INS43 INS43 MOV60 INS42 UPD42 MOV32 INS42 UPD42 MOV32 INS60 INS70 INS43 INS59 INS44 INS42 INS8 INS60 INS60 INS42 INS42 INS32 INS43 INS42 INS25 MOV43 INS59 UPD42 MOV42 MOV43 INS59 UPD42 MOV42 INS42 INS42 INS42 INS27 INS8 UPD42 MOV42 INS42 INS27 UPD42 MOV42 INS42 INS27 UPD42 MOV42 INS33 INS32 INS21 INS32 INS42 INS42 INS45 INS42 INS45 INS42 INS45 INS42 INS42 INS32 INS42 INS42 INS42 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 INS42 INS42 INS32 INS42 INS42 DEL42 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32 DEL45 DEL27 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32 DEL45 DEL45 DEL27 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32 DEL42 DEL42 DEL32