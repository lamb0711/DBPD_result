HDDS-1337. Handle GroupMismatchException in OzoneClient. Contributed by Shashikant Banerjee.

+import java.util.concurrent.atomic.AtomicReference;
-  private IOException ioException;
+  private AtomicReference<IOException> ioException;
+    ioException = new AtomicReference<>(null);
-  @VisibleForTesting
-    return ioException;
+    return ioException.get();
-      ioException = new IOException(
-          "Unexpected Storage Container Exception: " + e.toString(), e);
+      setIoException(e);
-      throw ioException;
+      throw getIoException();
+      setIoException(e);
-      throw new IOException(
-          "Unexpected Storage Container Exception: " + e.toString(), e);
+      throw getIoException();
-        if (ioException == null) {
+        if (getIoException() == null) {
-        ioException = new IOException(
-            "Unexpected Storage Container Exception: " + e.toString(), e);
+        setIoException(e);
-        throw ioException;
+        throw getIoException();
-        ioException = new IOException(
-            "Unexpected Storage Container Exception: " + e.toString(), e);
+        setIoException(e);
-        throw ioException;
+        throw getIoException();
-      if (ioException != null) {
-        throw ioException;
+      IOException exception = getIoException();
+      if (exception != null) {
+        throw exception;
+
-    if (ioException != null) {
-      ioException =  new IOException(
+    if (getIoException() == null) {
+      IOException exception =  new IOException(
+      ioException.compareAndSet(null, exception);
-    } else if (ioException != null) {
+    } else if (getIoException() != null) {
-      throw ioException;
+      throw getIoException();

INS26 INS40 INS74 INS43 MOV43 INS21 INS42 INS7 INS32 UPD27 INS42 INS14 INS42 INS42 INS60 INS32 INS60 INS74 INS33 INS21 INS53 INS43 INS59 INS42 INS43 INS59 INS32 INS32 INS43 INS32 INS32 INS32 INS32 INS42 INS42 INS32 UPD42 INS42 INS42 MOV14 INS42 INS42 INS33 INS42 INS42 INS32 INS42 INS42 MOV42 INS42 INS42 MOV42 UPD42 MOV42 INS42 UPD42 INS42 INS32 INS32 INS32 INS32 INS42 MOV42 INS42 INS42 MOV42 INS42 INS32 INS42 DEL42 DEL78 DEL42 DEL42 DEL42 DEL43 DEL45 DEL42 DEL32 DEL27 DEL42 DEL14 DEL7 DEL42 DEL42 DEL43 DEL45 DEL32 DEL27 DEL42 DEL14 DEL53 DEL42 DEL42 DEL42 DEL43 DEL45 DEL42 DEL32 DEL27 DEL42 DEL14 DEL7 DEL42 DEL42 DEL42 DEL43 DEL45 DEL42 DEL32 DEL27 DEL42 DEL14 DEL7 DEL42 DEL42 DEL42 DEL7 DEL42 DEL42