YARN-1913. With Fair Scheduler, cluster can logjam when all resources are consumed by AMs (Wei Yan via Sandy Ryza)

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1599400 13f79535-47bb-0310-9956-ffa450edef68

+      // If this container is used to run AM, update the leaf queue's AM usage
+      if (app.getLiveContainers().size() == 1 &&
+          !app.getUnmanagedAM()) {
+        queue.addAMResourceUsage(container.getResource());
+      }
+
+        // Check the AM resource usage for the leaf queue
+        if (app.getLiveContainers().size() == 0
+            && !app.getUnmanagedAM()) {
+          if (!queue.canRunAppAM(app.getAMResource())) {
+            return Resources.none();
+          }
+        }
+

INS25 INS27 INS8 INS27 INS38 INS21 INS25 INS32 INS34 INS32 INS32 INS27 INS8 INS32 INS42 INS42 INS42 INS42 INS42 INS32 INS27 INS38 INS25 INS42 INS42 INS42 INS42 INS32 INS34 INS32 INS38 INS8 INS32 INS42 INS42 INS42 INS32 INS41 INS42 INS42 INS42 INS42 INS32 INS32 INS42 INS42 INS42 INS42