HDFS-2616. Change DatanodeProtocol#sendHeartbeat() to return HeartbeatResponse. (suresh)


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1208987 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.hdfs.server.protocol.HeartbeatResponse;
-  DatanodeCommand[] handleHeartbeat(DatanodeRegistration nodeReg,
+  HeartbeatResponse handleHeartbeat(DatanodeRegistration nodeReg,
-      if (cmds != null) {
-        return cmds;
+      if (cmds == null) {
+        DatanodeCommand cmd = upgradeManager.getBroadcastCommand();
+        if (cmd != null) {
+          cmds = new DatanodeCommand[] {cmd};
+        }
-
-      //check distributed upgrade
-      DatanodeCommand cmd = upgradeManager.getBroadcastCommand();
-      if (cmd != null) {
-        return new DatanodeCommand[] {cmd};
-      }
-      return null;
+      return new HeartbeatResponse(cmds);

INS26 INS40 INS43 UPD42 MOV42 INS25 MOV41 UPD27 MOV27 INS8 INS14 MOV60 MOV25 INS43 INS42 INS42 INS21 INS7 INS42 MOV3 DEL43 DEL85 DEL5 DEL41 DEL42 DEL8 DEL25 DEL33 DEL41