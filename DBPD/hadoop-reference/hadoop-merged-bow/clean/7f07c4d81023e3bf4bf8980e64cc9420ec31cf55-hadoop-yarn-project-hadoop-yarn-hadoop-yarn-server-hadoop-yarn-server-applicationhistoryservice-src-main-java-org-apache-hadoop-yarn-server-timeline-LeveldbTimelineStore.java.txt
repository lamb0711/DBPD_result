YARN-3530. ATS throws exception on trying to filter results without
otherinfo. Contributed by zhijie shen

+      if (fields == null) {
+        fields = EnumSet.allOf(Field.class);
+      }
-    if (fields == null) {
-      fields = EnumSet.allOf(Field.class);
-    }
-
+    // Even if other info and primary filter fields are not included, we
+    // still need to load them to match secondary filters when they are
+    // non-empty
+    if (fields == null) {
+      fields = EnumSet.allOf(Field.class);
+    }
+    boolean addPrimaryFilters = false;
+    boolean addOtherInfo = false;
+    if (secondaryFilters != null && secondaryFilters.size() > 0) {
+      if (!fields.contains(Field.PRIMARY_FILTERS)) {
+        fields.add(Field.PRIMARY_FILTERS);
+        addPrimaryFilters = true;
+      }
+      if (!fields.contains(Field.OTHER_INFO)) {
+        fields.add(Field.OTHER_INFO);
+        addOtherInfo = true;
+      }
+    }
+
+            // Remove primary filter and other info if they are added for
+            // matching secondary filters
+            if (addPrimaryFilters) {
+              entity.setPrimaryFilters(null);
+            }
+            if (addOtherInfo) {
+              entity.setOtherInfo(null);
+            }

MOV25 INS60 INS60 INS25 INS39 INS59 INS39 INS59 INS27 INS8 INS25 INS42 INS9 INS42 INS9 INS27 INS27 INS25 INS25 INS27 INS8 INS42 INS33 INS32 INS34 INS38 INS8 INS38 INS8 INS42 INS33 INS21 INS42 INS42 INS32 INS21 INS21 INS32 INS21 INS21 INS7 INS42 INS42 INS40 INS32 INS7 INS42 INS42 INS40 INS32 INS7 INS42 INS32 INS42 INS42 INS40 INS42 INS9 INS42 INS42 INS40 INS42 INS9 INS42 INS42 INS57 INS8 INS43 INS25 INS25 MOV21 INS42 INS42 MOV8 INS42 INS8 INS21 INS21 INS32 INS32 INS42 INS42 INS33 INS42 INS42 INS33