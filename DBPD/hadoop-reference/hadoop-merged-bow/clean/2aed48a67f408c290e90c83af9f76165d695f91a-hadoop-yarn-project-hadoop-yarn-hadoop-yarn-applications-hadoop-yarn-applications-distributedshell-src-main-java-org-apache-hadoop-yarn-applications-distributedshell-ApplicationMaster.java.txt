YARN-498. Unmanaged AM launcher does not set various constants in env for an AM, also does not handle failed AMs properly (Hitesh Shah via bikas)

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1460954 13f79535-47bb-0310-9956-ffa450edef68

-    if (envs.containsKey(ApplicationConstants.AM_APP_ATTEMPT_ID_ENV)) {
-      appAttemptID = ConverterUtils.toApplicationAttemptId(envs
-          .get(ApplicationConstants.AM_APP_ATTEMPT_ID_ENV));
-    } else if (!envs.containsKey(ApplicationConstants.AM_CONTAINER_ID_ENV)) {
+    if (!envs.containsKey(ApplicationConstants.AM_CONTAINER_ID_ENV)) {
+    if (!envs.containsKey(ApplicationConstants.APP_SUBMIT_TIME_ENV)) {
+      throw new RuntimeException(ApplicationConstants.APP_SUBMIT_TIME_ENV
+          + " not set in the environment");
+    }
+    if (!envs.containsKey(ApplicationConstants.NM_HOST_ENV)) {
+      throw new RuntimeException(ApplicationConstants.NM_HOST_ENV
+          + " not set in the environment");
+    }
+    if (!envs.containsKey(ApplicationConstants.NM_HTTP_PORT_ENV)) {
+      throw new RuntimeException(ApplicationConstants.NM_HTTP_PORT_ENV
+          + " not set in the environment");
+    }
+    if (!envs.containsKey(ApplicationConstants.NM_PORT_ENV)) {
+      throw new RuntimeException(ApplicationConstants.NM_PORT_ENV
+          + " not set in the environment");
+    }
+

MOV25 INS25 INS25 INS25 INS25 INS38 INS8 INS38 INS8 INS38 INS8 INS38 INS8 INS32 INS53 INS32 INS53 INS32 INS53 INS32 INS53 MOV42 MOV42 UPD40 MOV40 INS14 UPD42 MOV42 INS42 INS40 INS14 INS42 INS42 INS40 INS14 MOV42 UPD42 MOV42 UPD40 MOV40 INS14 INS43 INS27 INS43 INS27 INS43 INS27 INS43 INS27 INS42 INS40 INS45 INS42 INS40 INS45 INS42 INS40 INS45 INS42 INS40 INS45 DEL32 DEL42 DEL42 DEL32 DEL32 DEL7 DEL21 DEL8 DEL25