HDFS-5542. Fix TODO and clean up the code in HDFS-2832. (Contributed by szetszwo)

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2832@1544664 13f79535-47bb-0310-9956-ffa450edef68

-  //                 two maps. This might require some refactoring
-  //                 rewrite of FsDatasetImpl.
+  // two maps and move the perVolumeReplicaMap to FsVolumeImpl.
+  // This might require some refactoring.
-  public Replica recoverClose(ExtendedBlock b, long newGS,
+  public String recoverClose(ExtendedBlock b, long newGS,
-    return replicaInfo;
+    return replicaInfo.getStorageUuid();
-  /**
-   * Generates a block report from the in-memory block map.
-   */
-  @Override // FsDatasetSpi
-  public BlockListAsLongs getBlockReport(String bpid) {
-    return getBlockReportWithReplicaMap(bpid, volumeMap);
-  }
-
-        finalized.add(new FinalizedReplica(b));
+        finalized.add(new FinalizedReplica((FinalizedReplica)b));

UPD43 UPD42 INS32 INS42 INS42 INS43 INS11 INS42 MOV43 INS42 DEL42 DEL66 DEL65 DEL29 DEL42 DEL78 DEL83 DEL42 DEL43 DEL42 DEL42 DEL43 DEL42 DEL44 DEL42 DEL42 DEL42 DEL32 DEL41 DEL8 DEL31 DEL42