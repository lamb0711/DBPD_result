YARN-2740. Fix NodeLabelsManager to properly handle node label modifications when distributed node label configuration enabled. (Naganarasimha G R via wangda)

+  private boolean isDistributedNodeLabelConfiguration = false;
+
+
+    isDistributedNodeLabelConfiguration  =
+        YarnConfiguration.isDistributedNodeLabelConfiguration(conf);
+
-    this.store.recover();
+    this.store.recover(isDistributedNodeLabelConfiguration);
-    if (null != dispatcher) {
+    if (null != dispatcher && !isDistributedNodeLabelConfiguration) {
+      // In case of DistributedNodeLabelConfiguration, no need to save the the
+      // NodeLabels Mapping to the back-end store, as on RM restart/failover
+      // NodeLabels are collected from NM through Register/Heartbeat again
-        nodeLabels.add(NodeLabel.newInstance(label.getLabelName(),
-            label.getIsExclusive()));
+        if (!label.getLabelName().equals(NO_LABEL)) {
+          nodeLabels.add(NodeLabel.newInstance(label.getLabelName(),
+              label.getIsExclusive()));
+        }
-  

INS23 INS83 INS39 INS59 INS42 INS9 INS21 INS7 INS27 INS42 INS32 INS42 MOV27 INS38 INS42 INS42 INS42 INS42 INS8 INS25 INS38 MOV8 INS32 INS32 INS42 INS42 INS42 INS42