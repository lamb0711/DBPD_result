HDFS-15199. NPE in BlockSender. Contributed by Ayush Saxena.

-        /*
-         * If we got an EIO when reading files or transferTo the client socket,
-         * it's very likely caused by bad disk track or other file corruptions.
-         */
-        if (ioem.startsWith(EIO_ERROR)) {
-          throw new DiskFileCorruptException("A disk IO error occurred", e);
-        }
-        if (!ioem.startsWith("Broken pipe") && !ioem.startsWith("Connection reset")) {
-          LOG.error("BlockSender.sendChunks() exception: ", e);
-          datanode.getBlockScanner().markSuspectBlock(
-              ris.getVolumeRef().getVolume().getStorageID(),
-              block);
+        if (ioem != null) {
+          /*
+           * If we got an EIO when reading files or transferTo the client
+           * socket, it's very likely caused by bad disk track or other file
+           * corruptions.
+           */
+          if (ioem.startsWith(EIO_ERROR)) {
+            throw new DiskFileCorruptException("A disk IO error occurred", e);
+          }
+          if (!ioem.startsWith("Broken pipe")
+              && !ioem.startsWith("Connection reset")) {
+            LOG.error("BlockSender.sendChunks() exception: ", e);
+            datanode.getBlockScanner().markSuspectBlock(
+                ris.getVolumeRef().getVolume().getStorageID(), block);
+          }

INS25 INS27 INS8 INS42 INS33 MOV25 MOV25