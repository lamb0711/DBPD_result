YARN-5257. Fix unreleased resources and null dereferences (yufeigu via rkanter)

-        new FileOutputStream(filepath), Charset.forName("UTF-8"));) {
+        new FileOutputStream(filepath), Charset.forName("UTF-8"))) {

