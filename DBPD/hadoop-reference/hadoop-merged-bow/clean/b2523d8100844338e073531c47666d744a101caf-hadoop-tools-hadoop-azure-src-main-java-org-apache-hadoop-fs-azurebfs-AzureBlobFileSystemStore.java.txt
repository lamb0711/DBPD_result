HADOOP-15969. ABFS: getNamespaceEnabled can fail blocking user access thru ACLs.

Contributed by Da Zhou.

+import java.net.HttpURLConnection;
-      LOG.debug("getFilesystemProperties for filesystem: {}",
-          client.getFileSystem());
-
-      final AbfsRestOperation op = client.getFilesystemProperties();
-      isNamespaceEnabled = Boolean.parseBoolean(
-          op.getResult().getResponseHeader(HttpHeaderConfigurations.X_MS_NAMESPACE_ENABLED));
+      LOG.debug("Get root ACL status");
+      try {
+        client.getAclStatus(AbfsHttpConstants.FORWARD_SLASH + AbfsHttpConstants.ROOT_PATH);
+        isNamespaceEnabled = true;
+      } catch (AbfsRestOperationException ex) {
+        // Get ACL status is a HEAD request, its response doesn't contain errorCode
+        // So can only rely on its status code to determine its account type.
+        if (HttpURLConnection.HTTP_BAD_REQUEST != ex.getStatusCode()) {
+          throw ex;
+        }
+        isNamespaceEnabled = false;
+      }

INS26 INS40 INS21 INS54 INS32 INS8 INS12 MOV42 MOV42 UPD45 MOV45 INS21 INS21 INS44 INS8 INS32 INS7 INS43 INS42 INS25 MOV21 MOV42 UPD42 MOV42 INS27 INS42 INS9 UPD42 MOV42 INS27 INS8 INS40 INS40 INS40 INS32 INS53 INS9 UPD42 MOV42 UPD42 MOV42 INS42 DEL42 DEL42 DEL42 DEL42 DEL32 DEL42 DEL40 DEL32 DEL32 DEL32 DEL32 DEL21 DEL83 DEL43 DEL42 DEL32 DEL59 DEL60