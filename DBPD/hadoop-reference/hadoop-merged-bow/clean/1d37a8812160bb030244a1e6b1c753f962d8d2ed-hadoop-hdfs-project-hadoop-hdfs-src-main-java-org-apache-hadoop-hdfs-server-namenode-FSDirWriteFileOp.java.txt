HDFS-8854. Erasure coding: add ECPolicy to replace schema+cellSize in hadoop-hdfs. Contributed by Walter Su.

+import org.apache.hadoop.hdfs.protocol.ErasureCodingPolicy;
-import org.apache.hadoop.io.erasurecode.ECSchema;
-        ECSchema ecSchema = ecZone.getSchema();
-        short numDataUnits = (short) ecSchema.getNumDataUnits();
-        short numParityUnits = (short) ecSchema.getNumParityUnits();
+        ErasureCodingPolicy ecPolicy = ecZone.getErasureCodingPolicy();
+        short numDataUnits = (short) ecPolicy.getNumDataUnits();
+        short numParityUnits = (short) ecPolicy.getNumParityUnits();
-        blockInfo = new BlockInfoUnderConstructionStriped(block, ecSchema,
-            ecZone.getCellSize(),
+        blockInfo = new BlockInfoUnderConstructionStriped(block, ecPolicy,

MOV26 UPD40 UPD43 UPD42 UPD42 UPD42 INS42 UPD42 UPD42 DEL42 DEL42 DEL42 DEL32