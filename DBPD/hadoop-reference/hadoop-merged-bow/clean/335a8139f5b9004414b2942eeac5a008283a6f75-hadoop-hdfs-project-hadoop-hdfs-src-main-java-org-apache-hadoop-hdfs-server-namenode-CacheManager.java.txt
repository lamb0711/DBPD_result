HDFS-13820. Add an ability to disable CacheReplicationMonitor. Contributed by Hrishikesh Gadre.

Signed-off-by: Xiao Chen <xiao@apache.org>

+import static org.apache.hadoop.hdfs.DFSConfigKeys.DFS_NAMENODE_CACHING_ENABLED_KEY;
+import static org.apache.hadoop.hdfs.DFSConfigKeys.DFS_NAMENODE_CACHING_ENABLED_DEFAULT;
+   * Whether caching is enabled.
+   *
+   * If caching is disabled, we will not process cache reports or store
+   * information about what is cached where.  We also do not start the
+   * CacheReplicationMonitor thread.  This will save resources, but provide
+   * less functionality.
+   *
+   * Even when caching is disabled, we still store path-based cache
+   * information.  This information is stored in the edit log and fsimage.  We
+   * don't want to lose it just because a configuration setting was turned off.
+   * However, we will not act on this information if caching is disabled.
+   */
+  private final boolean enabled;
+
+  /**
+    this.enabled = conf.getBoolean(DFS_NAMENODE_CACHING_ENABLED_KEY,
+        DFS_NAMENODE_CACHING_ENABLED_DEFAULT);
-    this.cachedBlocks = new LightWeightGSet<CachedBlock, CachedBlock>(
+    this.cachedBlocks = enabled ? new LightWeightGSet<CachedBlock, CachedBlock>(
-              "cachedBlocks"));
+              "cachedBlocks")) : new LightWeightGSet<>(0);
+  }
+  public boolean isEnabled() {
+    return enabled;
+    if (!isEnabled()) {
+      LOG.info("Not starting CacheReplicationMonitor as name-node caching" +
+              " is disabled.");
+      return;
+    }
+
+    if (!isEnabled()) {
+      return;
+    }
+
+    if (!enabled) {
+      LOG.debug("Ignoring cache report from {} because {} = false. " +
+              "number of blocks: {}", datanodeID,
+              DFS_NAMENODE_CACHING_ENABLED_KEY, blockIds.size());
+      return;
+    }

INS26 INS26 INS40 INS40 INS23 INS31 INS29 INS83 INS83 INS39 INS59 INS83 INS39 INS42 INS8 INS65 INS42 INS21 INS41 INS25 INS25 INS25 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS7 INS42 INS38 INS8 INS38 INS8 INS38 INS8 INS22 INS32 INS16 INS32 INS21 INS41 INS32 INS41 INS42 INS21 INS41 INS52 INS42 INS42 INS42 INS42 INS42 INS42 MOV14 INS14 INS42 INS32 INS42 INS32 INS74 INS34 INS42 INS42 INS27 INS42 INS42 INS27 INS42 INS42 INS32 INS43 INS45 INS45 INS45 INS45 INS42 INS42 INS42