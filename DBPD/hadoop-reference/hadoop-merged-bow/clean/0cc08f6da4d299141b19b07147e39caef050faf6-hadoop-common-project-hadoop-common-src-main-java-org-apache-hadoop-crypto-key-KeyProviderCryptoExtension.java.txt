Merge from trunk to branch.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/fs-encryption@1618700 13f79535-47bb-0310-9956-ffa450edef68

+    private static final ThreadLocal<SecureRandom> RANDOM = 
+        new ThreadLocal<SecureRandom>() {
+      @Override
+      protected SecureRandom initialValue() {
+        return new SecureRandom();
+      }
+    };
-      SecureRandom random = SecureRandom.getInstance("SHA1PRNG");
-      random.nextBytes(newKey);
-      final byte[] iv = random.generateSeed(cipher.getBlockSize());
+      RANDOM.get().nextBytes(newKey);
+      final byte[] iv = new byte[cipher.getBlockSize()];
+      RANDOM.get().nextBytes(iv);

INS23 INS83 INS83 INS83 INS74 INS59 MOV21 INS43 INS43 INS42 INS14 INS21 INS42 INS42 INS74 INS1 INS32 INS5 INS43 INS43 INS31 INS32 INS42 INS42 INS39 INS85 INS3 INS32 UPD42 INS42 INS42 INS78 INS83 INS43 INS42 INS8 UPD42 MOV42 UPD42 MOV42 MOV5 MOV32 UPD42 MOV42 INS42 INS42 INS42 INS41 INS14 MOV43 DEL42 DEL45 DEL32 DEL59 DEL60 DEL42 DEL42 DEL32