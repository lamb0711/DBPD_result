HADOOP-6710. Symbolic umask for file creation is not conformant with posix.  Contributed by Suresh Srinivas.



git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@937577 13f79535-47bb-0310-9956-ffa450edef68

-    Pattern.compile("\\G\\s*([ugoa]*)([+=-]+)([rwx]+)([,\\s]*)\\s*");
+    Pattern.compile("\\G\\s*([ugoa]*)([+=-]+)([rwx]*)([,\\s]*)\\s*");
+  /**
+   * To be used for file/directory creation only. Symbolic umask is applied
+   * relative to file mode creation mask; the permission op characters '+'
+   * results in clearing the corresponding bit in the mask, '-' results in bits
+   * for indicated permission to be set in the mask.
+   * 
+   * For octal umask, the specified bits are set in the file mode creation mask.
+   * 
+   * @return umask
+   */
+    if (symbolic) {
+      // Return the complement of octal equivalent of umask that was computed
+      return (short) (~umaskMode & 0777);      
+    }

INS29 INS8 INS65 INS65 INS25 MOV41 UPD45 INS66 INS66 INS66 INS66 INS66 INS66 INS42 INS8 INS41 INS11 INS39 INS36 INS27 INS38 INS34 INS42 DEL8