HDFS-8151. Always use snapshot path as source when invalid snapshot names are used for diff based distcp. Contributed by Jing Zhao.

-      DistCp.LOG.warn(sourcePaths.size() + " source paths are provided");
-      return false;
+      throw new IllegalArgumentException(sourcePaths.size()
+          + " source paths are provided");
-      DistCp.LOG.warn("To use diff-based distcp, the FileSystems needs to" +
-          " be DistributedFileSystem");
-      return false;
+      throw new IllegalArgumentException("The FileSystems needs to" +
+          " be DistributedFileSystem for using snapshot-diff-based distcp");
+      // set the source path using the snapshot path
+      inputOptions.setSourcePaths(Arrays.asList(getSourceSnapshotPath(sourceDir,
+          inputOptions.getToSnapshot())));

INS53 INS53 INS21 MOV41 INS14 INS14 INS32 INS43 MOV27 INS43 INS27 INS42 INS42 INS32 INS42 INS42 UPD45 MOV45 UPD45 MOV45 INS42 INS42 INS32 INS42 INS42 INS32 INS42 INS42 DEL40 DEL42 DEL32 DEL21 DEL9 DEL41 DEL40 DEL42 DEL27 DEL32 DEL21 DEL9 DEL41