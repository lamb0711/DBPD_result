HADOOP-1540. Support file exclusion list in distcp. Contributed by Rich Haase.

+  private CopyFilter copyFilter;
+    copyFilter = CopyFilter.getCopyFilter(getConf());
+    copyFilter.initialize();
-                sourcePathRoot, options);
+                sourcePathRoot);
-   * @param options - Input options passed during DistCp invocation
-  protected boolean shouldCopy(Path path, DistCpOptions options) {
-    return true;
+  protected boolean shouldCopy(Path path) {
+    return copyFilter.shouldCopy(path);
-                 sourcePathRoot, options);
+                 sourcePathRoot);
-    writeToFileListing(fileListWriter, fileStatus, sourcePathRoot, options);
+    writeToFileListing(fileListWriter, fileStatus, sourcePathRoot);
-                                  Path sourcePathRoot,
-                                  DistCpOptions options) throws IOException {
+                                  Path sourcePathRoot) throws IOException {
-    FileStatus status = fileStatus;
-
-    if (!shouldCopy(fileStatus.getPath(), options)) {
+    if (!shouldCopy(fileStatus.getPath())) {
-        fileStatus.getPath())), status);
+        fileStatus.getPath())), fileStatus);

INS23 INS83 INS43 INS59 INS8 INS42 INS42 INS21 INS21 INS41 INS7 INS32 INS32 INS42 INS32 INS42 INS42 INS42 INS42 INS42 UPD42 INS42 INS42 INS32 INS42 DEL42 DEL42 DEL66 DEL65 DEL42 DEL43 DEL42 DEL44 DEL9 DEL41 DEL8 DEL42 DEL42 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL42 DEL59 DEL60 DEL42