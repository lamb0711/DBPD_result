Merge r1360400 through r1399945 from trunk.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1399950 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.util.Time;
-    MetricsSourceAdapter sa = conf != null
-        ? new MetricsSourceAdapter(prefix, name, desc, source,
-                                   injectedTags, period, conf)
-        : new MetricsSourceAdapter(prefix, name, desc, source,
-          injectedTags, period, config.subset(SOURCE_KEY));
+    MetricsSourceAdapter sa = new MetricsSourceAdapter(prefix, name, desc,
+        source, injectedTags, period, conf != null ? conf
+            : config.subset(SOURCE_KEY));
-            }
-            catch (Exception e) {
+            } catch (Exception e) {
+          @Override
-            }
-            catch (Exception e) {
+            } catch (Exception e) {
-    long startTime = System.currentTimeMillis();
+    long startTime = Time.now();
-    snapshotStat.add(System.currentTimeMillis() - startTime);
+    snapshotStat.add(Time.now() - startTime);
-      long startTime = System.currentTimeMillis();
+      long startTime = Time.now();
-      publishStat.add(System.currentTimeMillis() - startTime);
+      publishStat.add(Time.now() - startTime);
-      }
-      catch (Exception e) {
+      } catch (Exception e) {
-    }
-    catch (Exception e) {
+    } catch (Exception e) {
+  @Override

INS26 INS40 INS78 INS42 MOV43 INS14 MOV43 MOV42 MOV42 MOV42 MOV42 MOV42 MOV42 INS16 UPD42 UPD42 MOV27 INS42 MOV32 UPD42 UPD42 INS78 UPD42 UPD42 INS42 UPD42 UPD42 DEL42 DEL43 DEL42 DEL14 DEL42 DEL42 DEL42 DEL42 DEL42 DEL42 DEL14 DEL16