HDDS-1775. Make OM KeyDeletingService compatible with HA model (#1063)



+import org.apache.hadoop.ozone.OmUtils;
+  private long deleteTimestamp;
-  public OMKeyDeleteResponse(OmKeyInfo omKeyInfo, OMResponse omResponse) {
+  public OMKeyDeleteResponse(OmKeyInfo omKeyInfo, long deletionTime,
+      OMResponse omResponse) {
+    this.deleteTimestamp = deletionTime;
+        // If a deleted key is put in the table where a key with the same
+        // name already exists, then the old deleted key information would be
+        // lost. To differentiate between keys with same name in
+        // deletedTable, we add the timestamp to the key name.
+        String deleteKeyName = OmUtils.getDeletedKeyName(
+            ozoneKey, deleteTimestamp);
-            ozoneKey, omKeyInfo);
+            deleteKeyName, omKeyInfo);

INS26 INS40 INS23 INS83 INS39 INS59 INS44 INS42 INS39 INS42 INS21 INS7 INS22 INS42 INS52 INS42 INS60 INS43 INS59 INS42 INS42 INS32 UPD42 INS42 INS42 INS42 INS42