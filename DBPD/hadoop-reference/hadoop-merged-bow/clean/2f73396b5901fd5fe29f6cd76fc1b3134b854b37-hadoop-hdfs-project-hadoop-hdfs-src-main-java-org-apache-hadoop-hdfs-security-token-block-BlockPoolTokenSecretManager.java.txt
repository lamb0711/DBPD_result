HDFS-6708. StorageType should be encoded in the block token. Contributed by Ewan Higgs

+import org.apache.hadoop.fs.StorageType;
-   * See {@link BlockTokenSecretManager#checkAccess(BlockTokenIdentifier, 
-   *                String, ExtendedBlock, BlockTokenIdentifier.AccessMode)}
+   * See {@link BlockTokenSecretManager#checkAccess(BlockTokenIdentifier,
+   *                String, ExtendedBlock, BlockTokenIdentifier.AccessMode,
+   *                StorageType[])}
-      ExtendedBlock block, AccessMode mode) throws InvalidToken {
-    get(block.getBlockPoolId()).checkAccess(id, userId, block, mode);
+      ExtendedBlock block, AccessMode mode,
+      StorageType[] storageTypes) throws InvalidToken {
+    get(block.getBlockPoolId()).checkAccess(id, userId, block, mode,
+        storageTypes);
-   * See {@link BlockTokenSecretManager#checkAccess(Token, String, 
-   *                ExtendedBlock, BlockTokenIdentifier.AccessMode)}
+   * See {@link BlockTokenSecretManager#checkAccess(Token, String,
+   *                ExtendedBlock, BlockTokenIdentifier.AccessMode,
+   *                StorageType[])}.
-      String userId, ExtendedBlock block, AccessMode mode) throws InvalidToken {
-    get(block.getBlockPoolId()).checkAccess(token, userId, block, mode);
+      String userId, ExtendedBlock block, AccessMode mode,
+      StorageType[] storageTypes) throws InvalidToken {
+    get(block.getBlockPoolId()).checkAccess(token, userId, block, mode,
+        storageTypes);
-   * See {@link BlockTokenSecretManager#generateToken(ExtendedBlock, EnumSet)}
+   * See {@link BlockTokenSecretManager#generateToken(ExtendedBlock, EnumSet,
+   *  StorageType[])}
-      EnumSet<AccessMode> of) throws IOException {
-    return get(b.getBlockPoolId()).generateToken(b, of);
+      EnumSet<AccessMode> of, StorageType[] storageTypes) throws IOException {
+    return get(b.getBlockPoolId()).generateToken(b, of, storageTypes);

INS26 INS40 INS44 INS44 INS44 INS5 INS42 INS5 INS42 INS5 INS42 INS43 INS85 INS66 INS43 INS85 INS43 INS85 INS42 INS42 INS42 INS42 INS42 INS42 INS69 INS69 INS69 INS5 INS5 INS5 INS43 INS85 INS43 INS85 INS43 INS85 INS42 INS42 INS42