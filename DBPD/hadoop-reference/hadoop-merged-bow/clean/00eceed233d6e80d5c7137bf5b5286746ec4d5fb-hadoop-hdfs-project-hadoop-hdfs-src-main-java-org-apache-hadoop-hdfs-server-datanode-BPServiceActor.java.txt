HDFS-12570: [SPS]: Refactor Co-ordinator datanode logic to track the block storage movements. Contributed by Rakesh R.

+import org.apache.hadoop.hdfs.protocol.Block;
-import org.apache.hadoop.hdfs.server.protocol.BlocksStorageMovementResult;
+import org.apache.hadoop.hdfs.server.protocol.BlocksStorageMoveAttemptFinished;
-    BlocksStorageMovementResult[] blksMovementResults =
-        getBlocksMovementResults();
+    // Get the blocks storage move attempt finished blocks
+    List<Block> results = dn.getStoragePolicySatisfyWorker()
+        .getBlocksMovementsStatusHandler().getMoveAttemptFinishedBlocks();
+    BlocksStorageMoveAttemptFinished storageMoveAttemptFinishedBlks =
+        getStorageMoveAttemptFinishedBlocks(results);
-        blksMovementResults);
+        storageMoveAttemptFinishedBlks);
-        .remove(blksMovementResults);
+        .remove(results);
-  private BlocksStorageMovementResult[] getBlocksMovementResults() {
-    List<BlocksStorageMovementResult> trackIdVsMovementStatus = dn
-        .getStoragePolicySatisfyWorker().getBlocksMovementsStatusHandler()
-        .getBlksMovementResults();
-    BlocksStorageMovementResult[] blksMovementResult =
-        new BlocksStorageMovementResult[trackIdVsMovementStatus.size()];
-    trackIdVsMovementStatus.toArray(blksMovementResult);
+  private BlocksStorageMoveAttemptFinished getStorageMoveAttemptFinishedBlocks(
+      List<Block> finishedBlks) {
-    return blksMovementResult;
+    if (finishedBlks.isEmpty()) {
+      return null;
+    }
+
+    // Create BlocksStorageMoveAttemptFinished with currently finished
+    // blocks
+    Block[] blockList = new Block[finishedBlks.size()];
+    finishedBlks.toArray(blockList);
+    return new BlocksStorageMoveAttemptFinished(blockList);

INS26 INS40 UPD40 INS43 UPD42 INS44 INS8 INS60 UPD42 MOV42 UPD74 MOV74 INS42 INS25 MOV60 MOV21 MOV41 INS74 INS59 INS43 INS32 UPD43 INS32 INS8 UPD5 INS14 INS43 INS43 INS42 MOV32 UPD42 MOV42 UPD42 MOV32 INS42 INS42 UPD42 UPD42 MOV42 UPD42 MOV42 INS41 UPD43 UPD42 UPD42 UPD42 INS43 INS42 INS42 INS42 UPD42 INS42 UPD42 UPD42 INS33 UPD42 UPD5 INS42 INS42 INS42 UPD43 UPD42 UPD42 DEL42 DEL43 DEL85 DEL5 DEL43 DEL85 DEL5 DEL42 DEL42 DEL42 DEL32 DEL59 DEL60 DEL8