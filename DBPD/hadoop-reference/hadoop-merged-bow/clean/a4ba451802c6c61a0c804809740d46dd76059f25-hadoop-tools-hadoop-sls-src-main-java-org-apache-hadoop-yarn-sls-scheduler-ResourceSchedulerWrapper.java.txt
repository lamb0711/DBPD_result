YARN-1474. Make schedulers services. (Tsuyoshi Ozawa via kasha)

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1598908 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.yarn.server.resourcemanager.scheduler.AbstractYarnScheduler;
+import org.apache.hadoop.yarn.server.resourcemanager.scheduler.SchedulerApplicationAttempt;
+import org.apache.hadoop.yarn.server.resourcemanager.scheduler.SchedulerNode;
-public class ResourceSchedulerWrapper implements
-        SchedulerWrapper,ResourceScheduler,Configurable {
+final public class ResourceSchedulerWrapper
+    extends AbstractYarnScheduler<SchedulerApplicationAttempt, SchedulerNode>
+    implements SchedulerWrapper, ResourceScheduler, Configurable {
+  private RMContext rmContext;
+    super(ResourceSchedulerWrapper.class.getName());
+  @SuppressWarnings("unchecked")
-  public void reinitialize(Configuration entries, RMContext rmContext)
-          throws IOException {
-    scheduler.reinitialize(entries, rmContext);
+  public void serviceInit(Configuration conf) throws Exception {
+    ((AbstractYarnScheduler<SchedulerApplicationAttempt, SchedulerNode>)
+        scheduler).init(conf);
+    super.serviceInit(conf);
+  }
+
+  @SuppressWarnings("unchecked")
+  @Override
+  public void serviceStart() throws Exception {
+    ((AbstractYarnScheduler<SchedulerApplicationAttempt, SchedulerNode>)
+        scheduler).start();
+    super.serviceStart();
+  }
+
+  @SuppressWarnings("unchecked")
+  @Override
+  public void serviceStop() throws Exception {
+    ((AbstractYarnScheduler<SchedulerApplicationAttempt, SchedulerNode>)
+        scheduler).stop();
+    super.serviceStop();
+  }
+
+  @Override
+  public void setRMContext(RMContext rmContext) {
+    scheduler.setRMContext(rmContext);
+  }
+
+  @Override
+  public void reinitialize(Configuration conf, RMContext rmContext)
+      throws IOException {
+    scheduler.reinitialize(conf, rmContext);

INS26 INS26 INS26 INS40 INS40 INS40 INS83 INS74 INS23 INS31 INS31 INS31 INS31 INS43 INS43 INS43 INS83 INS43 INS59 INS79 INS78 INS83 INS39 INS42 MOV44 INS43 INS8 INS79 INS78 INS83 INS39 INS42 INS43 INS8 INS79 INS78 INS83 INS39 INS42 INS43 INS8 INS78 INS83 INS39 INS42 INS44 INS8 INS44 INS42 INS42 INS42 INS42 INS42 INS46 INS42 INS45 INS42 UPD42 INS42 INS21 INS21 INS42 INS45 INS42 INS42 INS21 INS21 INS42 INS45 INS42 INS42 INS21 INS21 INS42 INS43 INS42 INS21 INS43 INS42 INS32 INS32 INS48 INS32 INS48 INS32 INS48 INS42 INS32 INS42 INS57 INS42 INS36 INS42 INS42 INS42 INS42 INS36 INS42 INS42 INS36 INS42 INS42 INS42 INS42 INS42 UPD42 INS43 INS11 INS11 INS11 INS42 INS74 INS42 INS74 INS42 INS74 INS42 INS43 INS43 INS43 INS43 INS43 INS43 INS43 INS43 INS43 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42