YARN-5685. RM configuration allows all failover methods to disabled when automatic failover is enabled

+  @VisibleForTesting
+    verifyLeaderElection(conf);
-        msg.append(addSuffix(YarnConfiguration.RM_ADDRESS, id) + " ");
+        msg.append(addSuffix(YarnConfiguration.RM_ADDRESS, id)).append(" ");
+  /**
+   * This method validates that some leader election service is enabled. YARN
+   * allows leadership election to be disabled in the configuration, which
+   * breaks automatic failover. If leadership election is disabled, this
+   * method will throw an exception via
+   * {@link #throwBadConfigurationException(java.lang.String)}.
+   *
+   * @param conf the {@link Configuration} to validate
+   */
+  private static void verifyLeaderElection(Configuration conf) {
+    if (isAutomaticFailoverEnabled(conf) &&
+        !conf.getBoolean(YarnConfiguration.CURATOR_LEADER_ELECTOR,
+          YarnConfiguration.DEFAULT_CURATOR_LEADER_ELECTOR_ENABLED) &&
+        !isAutomaticFailoverEmbedded(conf)) {
+      throwBadConfigurationException(NO_LEADER_ELECTION_MESSAGE);
+    }
+  }
+
+  @VisibleForTesting
+  static final String NO_LEADER_ELECTION_MESSAGE =
+      "The yarn.resourcemanager.ha.automatic-failover.embedded "
+      + "and yarn.resourcemanager.ha.curator-leader-elector.enabled "
+      + "properties are both false. One of these two properties must "
+      + "be true when yarn.resourcemanager.ha.automatic-failover.enabled "
+      + "is true";
+

INS31 INS23 INS78 INS29 INS83 INS83 INS39 INS42 INS44 INS8 INS78 INS83 INS83 INS43 INS59 INS42 INS21 INS65 INS65 INS43 INS42 INS25 INS42 INS42 INS42 INS27 INS32 INS66 INS66 INS66 INS66 INS65 INS66 INS42 INS66 INS65 INS66 INS42 INS27 INS8 INS45 INS45 INS45 INS45 INS45 INS42 INS42 INS68 INS42 INS32 INS38 INS38 INS21 INS42 INS69 INS42 INS42 INS32 INS32 INS32 INS43 INS42 INS42 INS40 INS40 INS42 INS42 INS42 INS42 INS32 INS40 MOV32 INS42 INS45 MOV32 DEL45 DEL27