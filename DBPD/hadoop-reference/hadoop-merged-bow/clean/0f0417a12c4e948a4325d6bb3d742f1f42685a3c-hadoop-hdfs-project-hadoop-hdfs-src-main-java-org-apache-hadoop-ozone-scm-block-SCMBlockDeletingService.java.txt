HDFS-12673. Ozone: Log elapsed time for block deletion tasks. Contributed by Yiqun Lin.

+import org.apache.hadoop.util.Time;
+      int dnTxCount = 0;
+      long startTime = Time.monotonicNow();
-        transactions.getDatanodes().forEach(datanodeID -> {
-          List<DeletedBlocksTransaction> dnTXs =
-              transactions.getDatanodeTransactions(datanodeID);
+        for (DatanodeID datanodeID : transactions.getDatanodes()) {
+          List<DeletedBlocksTransaction> dnTXs = transactions
+              .getDatanodeTransactions(datanodeID);
+          dnTxCount += dnTXs.size();
-          LOG.info("Added delete block command for datanode {} in the queue,"
+          LOG.debug(
+              "Added delete block command for datanode {} in the queue,"
-
-        });
+        }
+
+      if (dnTxCount > 0) {
+        LOG.info("Totally added {} delete blocks command for"
+            + " {} datanodes, task elapsed time: {}ms",
+            dnTxCount, transactions.getDatanodes().size(),
+            Time.monotonicNow() - startTime);
+      }
+

INS26 INS40 INS60 INS60 INS25 INS39 INS59 INS39 INS59 INS27 INS8 INS42 INS34 INS42 INS32 INS70 INS42 INS34 INS21 INS42 INS42 INS44 MOV32 MOV8 INS32 INS43 INS42 INS21 INS42 INS42 INS27 INS42 INS32 INS27 INS42 INS7 INS45 INS45 INS32 INS42 INS32 INS42 INS42 INS32 UPD42 INS42 INS42 INS42 INS42 INS42 INS42 DEL42 DEL42 DEL59 DEL86 DEL32 DEL21