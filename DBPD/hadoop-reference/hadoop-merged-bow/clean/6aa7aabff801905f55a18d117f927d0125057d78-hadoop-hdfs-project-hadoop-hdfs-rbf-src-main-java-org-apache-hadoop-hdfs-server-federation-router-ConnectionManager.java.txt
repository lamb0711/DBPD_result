HDFS-14114. RBF: MIN_ACTIVE_RATIO should be configurable. Contributed by Fei Hui.

-  /** Minimum amount of active connections: 50%. */
-  protected static final float MIN_ACTIVE_RATIO = 0.5f;
-
-
+  /** Min ratio of active connections per user + nn. */
+  private final float minActiveRatio;
-    // Configure minimum and maximum connection pools
+    // Configure minimum, maximum and active connection pools
+    this.minActiveRatio = this.conf.getFloat(
+        RBFConfigKeys.DFS_ROUTER_NAMENODE_CONNECTION_MIN_ACTIVE_RATIO,
+        RBFConfigKeys.DFS_ROUTER_NAMENODE_CONNECTION_MIN_ACTIVE_RATIO_DEFAULT);
-              this.conf, nnAddress, ugi, this.minSize, this.maxSize, protocol);
+              this.conf, nnAddress, ugi, this.minSize, this.maxSize,
+              this.minActiveRatio, protocol);
+      float poolMinActiveRatio = pool.getMinActiveRatio();
-          active < MIN_ACTIVE_RATIO * total) {
+          active < poolMinActiveRatio * total) {
+            float poolMinActiveRatio = pool.getMinActiveRatio();
-                active >= MIN_ACTIVE_RATIO * total) {
+                active >= poolMinActiveRatio * total) {

MOV23 UPD83 UPD42 INS21 UPD66 INS7 INS22 INS32 INS60 INS52 INS42 INS22 INS42 INS40 INS40 INS39 INS59 INS52 INS42 INS42 INS32 INS42 INS42 UPD42 INS60 INS39 INS59 INS22 INS42 INS32 INS52 INS42 INS42 INS42 UPD42 DEL83 DEL34