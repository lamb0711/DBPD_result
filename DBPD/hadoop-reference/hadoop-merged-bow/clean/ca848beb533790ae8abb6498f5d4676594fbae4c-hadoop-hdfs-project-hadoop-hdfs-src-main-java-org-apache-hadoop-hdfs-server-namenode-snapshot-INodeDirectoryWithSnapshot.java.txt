HDFS-4647. Rename should call setLocalName after an inode is removed from snapshots.  Contributed by Arpit Agarwal


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1464795 13f79535-47bb-0310-9956-ffa450edef68

+    replaceRemovedChild(oldChild, ref);
+    return ref;
+  }
-    diffs.replaceChild(ListType.CREATED, oldChild, ref);
+  /** The child just has been removed, replace it with a reference. */
+  public void replaceRemovedChild(INode oldChild, INode newChild) {
-        diffs.replaceChild(ListType.DELETED, oldChild, ref));
-    return ref;
+        diffs.replaceChild(ListType.DELETED, oldChild, newChild));

INS31 INS29 INS83 INS39 INS42 INS44 INS44 INS8 INS65 INS43 INS42 INS43 INS42 INS21 INS66 INS42 INS42 INS32 UPD42 INS42 INS42 INS32 INS42 INS42 INS40 INS42 INS42 DEL42 DEL40 DEL42 DEL42 DEL42 DEL42 DEL40 DEL42 DEL42 DEL32 DEL32 DEL21