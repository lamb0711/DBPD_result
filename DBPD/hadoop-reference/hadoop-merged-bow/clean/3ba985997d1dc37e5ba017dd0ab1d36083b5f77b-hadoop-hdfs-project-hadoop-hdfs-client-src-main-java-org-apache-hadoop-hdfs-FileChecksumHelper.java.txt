HDFS-12931. Handle InvalidEncryptionKeyException during DistributedFileSystem#getFileChecksum. Contributed by Mukul Kumar Singh.

+import org.apache.hadoop.hdfs.protocol.datatransfer.InvalidEncryptionKeyException;
-    private boolean checksumBlock(
-        LocatedBlock locatedBlock) throws IOException {
+    private boolean checksumBlock(LocatedBlock locatedBlock) {
+        } catch (InvalidEncryptionKeyException iee) {
+          if (blockIdx > getLastRetriedIndex()) {
+            LOG.debug("Got invalid encryption key error in response to "
+                    + "OP_BLOCK_CHECKSUM for file {} for block {} from "
+                    + "datanode {}. Will retry " + "the block once.",
+                  getSrc(), block, datanodes[j]);
+            setLastRetriedIndex(blockIdx);
+            done = true; // actually it's not done; but we'll retry
+            blockIdx--; // repeat at i-th block
+            getClient().clearDataEncryptionKey();
+          }

INS26 INS40 INS12 INS44 INS8 INS43 INS42 INS25 INS42 INS27 INS8 INS42 INS32 INS21 INS21 INS21 INS21 INS21 INS42 INS32 INS32 INS7 INS37 INS32 INS42 INS42 INS27 INS32 INS42 INS2 INS42 INS42 INS42 INS9 INS42 INS32 INS42 INS45 INS45 INS45 INS45 INS42 INS42 INS42 INS42 DEL42 DEL43