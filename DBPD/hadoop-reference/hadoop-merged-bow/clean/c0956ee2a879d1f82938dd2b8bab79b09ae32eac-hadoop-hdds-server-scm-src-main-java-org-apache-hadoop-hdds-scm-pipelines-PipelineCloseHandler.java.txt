HDDS-476. Add Pipeline reports to make pipeline active on SCM restart.
Contributed by Mukul Kumar Singh.

-import org.apache.hadoop.hdds.scm.container.Mapping;
+import org.apache.hadoop.hdds.scm.container.common.helpers.Pipeline;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
-  private final Mapping mapping;
-  public PipelineCloseHandler(Mapping mapping) {
-    this.mapping = mapping;
+  private static final Logger LOG = LoggerFactory
+          .getLogger(PipelineCloseHandler.class);
+
+  private final PipelineSelector pipelineSelector;
+  public PipelineCloseHandler(PipelineSelector pipelineSelector) {
+    this.pipelineSelector = pipelineSelector;
-    mapping.handlePipelineClose(pipelineID);
+    Pipeline pipeline = pipelineSelector.getPipeline(pipelineID);
+    try {
+      if (pipeline != null) {
+        pipelineSelector.finalizePipeline(pipeline);
+      } else {
+        LOG.debug("pipeline:{} not found", pipelineID);
+      }
+    } catch (Exception e) {
+      LOG.info("failed to close pipeline:{}", pipelineID, e);
+    }

INS26 INS26 UPD40 INS40 INS40 INS23 INS83 UPD43 INS83 INS83 INS43 INS59 INS8 UPD42 UPD42 INS32 INS42 INS42 UPD43 UPD42 INS60 INS54 INS42 INS42 INS57 UPD42 INS43 INS59 INS8 INS12 INS43 UPD42 INS42 INS42 INS32 INS25 INS44 INS8 INS42 UPD42 INS42 INS42 INS42 INS27 INS8 INS8 INS43 INS42 INS21 INS42 INS33 MOV21 INS21 INS42 INS32 INS32 INS42 INS42 INS45 INS42 INS42 UPD42 UPD42 UPD42 INS42 INS42 INS45 INS42 DEL8