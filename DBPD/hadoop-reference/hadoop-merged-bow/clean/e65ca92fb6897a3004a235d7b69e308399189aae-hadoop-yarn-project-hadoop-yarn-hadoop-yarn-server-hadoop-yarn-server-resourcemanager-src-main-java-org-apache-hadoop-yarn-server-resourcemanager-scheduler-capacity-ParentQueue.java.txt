YARN-7482. Max applications calculation per queue has to be retrospected with absolute resource support. Contributed by Sunil G.

+
+    // Re-visit max applications for a queue based on absolute capacity if
+    // needed.
+    if (childQueue instanceof LeafQueue) {
+      LeafQueue leafQueue = (LeafQueue) childQueue;
+      CapacitySchedulerConfiguration conf = csContext.getConfiguration();
+      int maxApplications = (int) (conf.getMaximumSystemApplications()
+          * childQueue.getQueueCapacities().getAbsoluteCapacity(label));
+      leafQueue.setMaxApplications(maxApplications);
+
+      int maxApplicationsPerUser = Math.min(maxApplications,
+          (int) (maxApplications
+              * (leafQueue.getUsersManager().getUserLimit() / 100.0f)
+              * leafQueue.getUsersManager().getUserLimitFactor()));
+      leafQueue.setMaxApplicationsPerUser(maxApplicationsPerUser);
+      LOG.info("LeafQueue:" + leafQueue.getQueueName() + ", maxApplications="
+          + maxApplications + ", maxApplicationsPerUser="
+          + maxApplicationsPerUser + ", Abs Cap:"
+          + childQueue.getQueueCapacities().getAbsoluteCapacity(label));
+    }

INS25 INS62 INS8 INS42 INS43 INS60 INS60 INS60 INS21 INS60 INS21 INS21 INS42 INS43 INS59 INS43 INS59 INS39 INS59 INS32 INS39 INS59 INS32 INS32 INS42 INS42 INS11 INS42 INS42 INS32 INS42 INS11 INS42 INS42 INS42 INS42 INS32 INS42 INS42 INS42 INS42 INS42 INS27 INS43 INS42 INS42 INS42 INS39 INS36 INS42 INS42 INS42 INS11 INS45 INS32 INS45 INS42 INS45 INS42 INS45 INS32 INS42 INS27 INS39 INS36 INS42 INS42 INS32 INS42 INS42 INS32 INS32 INS27 INS42 INS42 INS42 INS42 INS32 INS42 INS42 INS42 INS36 INS32 INS42 INS42 INS27 INS32 INS42 INS32 INS34 INS42 INS42 INS32 INS42 INS42 INS42