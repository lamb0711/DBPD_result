HDFS-10689.  Hdfs dfs chmod should reset sticky bit permission when the bit is omitted in the octal mode. (Manoj Govindassamy via Lei Xu)

-      applyOctalPattern(modeStr, matcher);
+      applyOctalPattern(matcher);
-    boolean commaSeperated = false;
+    boolean commaSeparated = false;
-      if (i > 0 && (!commaSeperated || !matcher.find())) {
+      if (i > 0 && (!commaSeparated || !matcher.find())) {
-      commaSeperated = matcher.group(4).contains(",");
+      commaSeparated = matcher.group(4).contains(",");
-  private void applyOctalPattern(String modeStr, Matcher matcher) {
-    userType = groupType = othersType = '=';
+  private void applyOctalPattern(final Matcher matcher) {
+    // Matcher groups: 1: [01]  2: [0-7]{3}
+    final char typeApply = '=';
+    stickyBitType = typeApply;
+    userType = typeApply;
+    groupType = typeApply;
+    othersType = typeApply;
-    // Check if sticky bit is specified
+    // If sticky bit is specified get the bit, else
+    // default to reset for apply condition
-      stickyBitType = '=';
+    } else {
+      stickyMode = 0;

INS83 INS60 INS21 INS21 INS21 INS21 INS83 INS39 INS59 INS7 INS7 INS7 INS7 INS8 UPD42 INS42 INS13 INS42 INS42 MOV42 INS42 MOV42 INS42 MOV42 INS42 INS21 INS7 UPD42 INS42 INS34 UPD42 DEL42 DEL42 DEL43 DEL42 DEL44 DEL13 DEL7 DEL7 DEL7 DEL21 DEL42 DEL13 DEL7 DEL21