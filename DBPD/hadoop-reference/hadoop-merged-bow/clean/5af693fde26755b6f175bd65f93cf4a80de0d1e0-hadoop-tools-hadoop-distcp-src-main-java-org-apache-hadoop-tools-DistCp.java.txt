MAPREDUCE-6248. Exposed the internal MapReduce job's information as a public API in DistCp. Contributed by Jing Zhao.

+import org.apache.hadoop.classification.InterfaceAudience;
+import org.apache.hadoop.classification.InterfaceStability;
+@InterfaceAudience.Public
+@InterfaceStability.Evolving
-   * Priority of the ResourceManager shutdown hook.
+   * Priority of the shutdown hook.
-  public static final int SHUTDOWN_HOOK_PRIORITY = 30;
+  static final int SHUTDOWN_HOOK_PRIORITY = 30;
-  public static final Random rand = new Random();
+  static final Random rand = new Random();
-  public DistCp() {}
+  DistCp() {}
+  @Override
+    Job job = createAndSubmitJob();
+
+    if (inputOptions.shouldBlock()) {
+      waitForJobCompletion(job);
+    }
+    return job;
+  }
+
+  /**
+   * Create and submit the mapreduce job.
+   * @return The mapreduce job object that has been submitted
+   */
+  public Job createAndSubmitJob() throws Exception {
-
-    
-    if (inputOptions.shouldBlock() && !job.waitForCompletion(true)) {
-      throw new IOException("DistCp failure: Job " + jobID + " has failed: "
-          + job.getStatus().getFailureInfo());
-    }
+
+   * Wait for the given job to complete.
+   * @param job the given mapreduce job that has already been submitted
+   */
+  public void waitForJobCompletion(Job job) throws Exception {
+    assert job != null;
+    if (!job.waitForCompletion(true)) {
+      throw new IOException("DistCp failure: Job " + job.getJobID()
+          + " has failed: " + job.getStatus().getFailureInfo());
+    }
+  }
+
+  /**
-    public Cleanup(DistCp distCp) {
+    Cleanup(DistCp distCp) {

INS26 INS26 INS40 INS40 INS78 INS78 INS31 INS31 INS40 INS40 INS78 MOV29 INS83 INS43 INS42 INS43 INS8 INS29 UPD42 INS29 INS83 INS39 INS42 INS44 INS43 INS8 INS42 INS42 INS42 INS60 INS25 INS41 INS65 INS65 INS65 INS65 INS43 INS42 INS42 INS6 MOV25 UPD66 INS43 INS59 MOV32 INS8 INS42 INS66 INS66 INS66 INS42 INS66 INS42 INS27 MOV38 INS42 INS42 INS32 INS21 INS42 INS33 INS42 INS32 INS42 INS42 INS32 INS42 INS42 DEL83 DEL83 DEL83 DEL27 DEL42 DEL83