YARN-9194. Invalid event: REGISTERED and LAUNCH_FAILED at FAILED, and NullPointerException happens in RM while shutdown a NM. (lujie via wangda)

Change-Id: I4359f59a73a278a941f4bb9d106dd38c9cb471fe

+              RMAppAttemptEventType.LAUNCH_FAILED,
+              RMAppAttemptEventType.REGISTERED,
-      appAttempt.setMasterContainer(amContainerAllocation.getContainers()
-          .get(0));
+      Container amContainer = amContainerAllocation.getContainers().get(0);
-          .getRMContainer(appAttempt.getMasterContainer().getId());
+          .getRMContainer(amContainer.getId());
+      //while one NM is removed, the scheduler will clean the container,the
+      //following CONTAINER_FINISHED event will handle the cleaned container.
+      //so just return RMAppAttemptState.SCHEDULED
+      if (rmMasterContainer == null) {
+        return RMAppAttemptState.SCHEDULED;
+      }
+      appAttempt.setMasterContainer(amContainer);

INS60 INS25 INS21 INS43 INS59 MOV43 INS27 INS8 INS32 INS42 INS42 MOV32 INS42 INS33 INS41 INS42 INS42 INS42 MOV43 INS40 UPD42 MOV42 INS40 INS40 DEL42 DEL42 DEL32 DEL21 DEL42 DEL32