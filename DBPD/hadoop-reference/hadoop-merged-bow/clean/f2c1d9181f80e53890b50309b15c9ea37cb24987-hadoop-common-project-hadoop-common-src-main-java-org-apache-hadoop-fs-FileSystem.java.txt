HADOOP-13140. FileSystem#initialize must not attempt to create StorageStatistics objects with null or empty schemes (Mingliang Liu via cmccabe)

+import static com.google.common.base.Preconditions.checkArgument;
-    statistics = getStatistics(name.getScheme(), getClass());    
+    final String scheme;
+    if (name.getScheme() == null || name.getScheme().isEmpty()) {
+      scheme = getDefaultUri(conf).getScheme();
+    } else {
+      scheme = name.getScheme();
+    }
+    statistics = getStatistics(scheme, getClass());
+    checkArgument(scheme != null,
+        "No statistics is allowed for a file system with null scheme!");

INS26 INS40 INS8 INS60 INS25 INS21 MOV21 INS21 INS83 INS43 INS59 INS27 INS8 MOV8 INS7 INS32 INS42 INS42 INS27 INS32 INS21 INS42 INS32 INS42 INS27 INS45 INS32 INS33 INS32 INS42 INS7 INS42 INS42 MOV32 INS42 INS33 INS42 INS42 INS42 INS42 INS42 INS32 UPD42 MOV32 INS32 INS42 INS42 INS42 DEL42 DEL32