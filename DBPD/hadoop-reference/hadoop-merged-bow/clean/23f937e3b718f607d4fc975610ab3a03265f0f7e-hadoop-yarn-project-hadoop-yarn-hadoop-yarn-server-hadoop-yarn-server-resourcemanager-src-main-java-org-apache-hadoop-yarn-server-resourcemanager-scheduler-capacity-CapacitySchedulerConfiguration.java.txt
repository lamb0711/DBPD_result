YARN-2575. Create separate ACLs for Reservation create/update/delete/list ops (Sean Po via asuresh)

+import org.apache.hadoop.yarn.api.records.ReservationACL;
+  private static String getAclKey(ReservationACL acl) {
+    return "acl_" + StringUtils.toLowerCase(acl.toString());
+  }
+
+  @Override
+  public Map<ReservationACL, AccessControlList> getReservationAcls(String
+        queue) {
+    Map<ReservationACL, AccessControlList> resAcls = new HashMap<>();
+    for (ReservationACL acl : ReservationACL.values()) {
+      resAcls.put(acl, getReservationAcl(queue, acl));
+    }
+    return resAcls;
+  }
+
+  private AccessControlList getReservationAcl(String queue, ReservationACL
+        acl) {
+    String queuePrefix = getQueuePrefix(queue);
+    // The root queue defaults to all access if not defined
+    // Sub queues inherit access if not defined
+    String defaultAcl = ALL_ACL;
+    String aclString = get(queuePrefix + getAclKey(acl), defaultAcl);
+    return new AccessControlList(aclString);
+  }
+
+  private void setAcl(String queue, ReservationACL acl, String aclString) {
+    String queuePrefix = getQueuePrefix(queue);
+    set(queuePrefix + getAclKey(acl), aclString);
+  }
+
+  @VisibleForTesting
+  public void setReservationAcls(String queue,
+        Map<ReservationACL, AccessControlList> acls) {
+    for (Map.Entry<ReservationACL, AccessControlList> e : acls.entrySet()) {
+      setAcl(queue, e.getKey(), e.getValue().getAclString());
+    }
+  }
+

INS26 INS40 INS31 INS31 INS31 INS31 INS31 INS83 INS83 INS43 INS42 INS44 INS8 INS78 INS83 INS74 INS42 INS44 INS8 INS83 INS43 INS42 INS44 INS44 INS8 INS83 INS39 INS42 INS44 INS44 INS44 INS8 INS78 INS83 INS39 INS42 INS44 INS44 INS8 INS42 INS43 INS42 INS41 INS42 INS43 INS43 INS43 INS43 INS42 INS60 INS70 INS41 INS42 INS43 INS42 INS43 INS42 INS60 INS60 INS60 INS41 INS43 INS42 INS43 INS42 INS43 INS42 INS60 INS21 INS42 INS43 INS42 INS74 INS42 INS70 INS42 INS27 INS42 INS42 INS42 INS42 INS74 INS59 INS44 INS32 INS8 INS42 INS42 INS42 INS43 INS59 INS43 INS59 INS43 INS59 INS14 INS42 INS42 INS42 INS43 INS59 INS32 INS42 INS43 INS43 INS43 INS44 INS32 INS8 INS45 INS32 INS43 INS43 INS43 INS42 INS14 INS43 INS42 INS42 INS42 INS21 INS42 INS42 INS32 INS42 INS42 INS42 INS42 INS42 INS32 INS43 INS42 INS42 INS42 INS32 INS42 INS27 INS42 INS42 INS42 INS42 INS74 INS42 INS42 INS42 INS21 INS42 INS42 INS32 INS42 INS42 INS42 INS74 INS42 INS32 INS42 INS42 INS42 INS27 INS42 INS42 INS42 INS42 INS42 INS32 INS43 INS43 INS43 INS32 INS42 INS42 INS43 INS42 INS42 INS42 INS32 INS42 INS32 INS42 INS42 INS40 INS42 INS42 INS42 INS42 INS32 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS32 INS42 INS42 INS42