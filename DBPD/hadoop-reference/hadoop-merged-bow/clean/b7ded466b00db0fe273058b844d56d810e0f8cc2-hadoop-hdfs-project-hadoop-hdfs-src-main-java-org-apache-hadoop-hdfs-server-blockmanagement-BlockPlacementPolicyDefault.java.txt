HDFS-6920. Archival Storage: check the storage type of delNodeHintStorage when deleting a replica. Contributed by Tsz Wo Nicholas Sze.

-    final DatanodeStorageInfo storage = oldestHeartbeatStorage != null?
-        oldestHeartbeatStorage : minSpaceStorage;
+
+    final DatanodeStorageInfo storage;
+    if (oldestHeartbeatStorage != null) {
+      storage = oldestHeartbeatStorage;
+    } else if (minSpaceStorage != null) {
+      storage = minSpaceStorage;
+    } else {
+      return null;
+    }

INS60 INS25 MOV83 MOV43 INS59 MOV27 INS8 INS25 MOV42 INS21 INS27 INS8 INS8 INS7 INS42 INS33 INS21 INS41 INS42 INS42 INS7 INS33 INS42 INS42 DEL42 DEL42 DEL16 DEL59 DEL60