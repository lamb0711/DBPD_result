YARN-3361. CapacityScheduler side changes to support non-exclusive node labels. Contributed by Wangda Tan

+  private ResourceUsage appResourceUsage;
-      long epoch) {
+      long epoch, ResourceUsage appResourceUsage) {
+    this.appResourceUsage = appResourceUsage;
+        Resource increasedResource = Resources.multiply(request.getCapability(),
+            request.getNumContainers());
-            Resources.multiply(request.getCapability(),
-                request.getNumContainers()));
+            increasedResource);
+        appResourceUsage.incPending(request.getNodeLabelExpression(), increasedResource);
+          Resource decreasedResource =
+              Resources.multiply(lastRequestCapability, lastRequestContainers);
-              Resources.multiply(lastRequestCapability, lastRequestContainers));
+              decreasedResource);
+          appResourceUsage.decPending(lastRequest.getNodeLabelExpression(),
+              decreasedResource);
+    appResourceUsage.decPending(offSwitchRequest.getNodeLabelExpression(),
+        offSwitchRequest.getCapability());
-    ResourceRequest newRequest = ResourceRequest.newInstance(
-        request.getPriority(), request.getResourceName(),
-        request.getCapability(), 1, request.getRelaxLocality());
+    ResourceRequest newRequest =
+        ResourceRequest.newInstance(request.getPriority(),
+            request.getResourceName(), request.getCapability(), 1,
+            request.getRelaxLocality(), request.getNodeLabelExpression());

INS23 INS83 INS43 INS59 INS44 INS42 INS42 INS43 INS42 INS21 INS21 INS42 INS7 INS32 INS22 INS42 INS42 INS42 INS32 INS32 INS52 INS42 INS42 INS42 INS42 INS42 INS32 INS60 INS21 INS42 INS42 INS43 INS59 INS32 INS42 INS42 MOV32 INS42 INS42 INS42 INS32 INS42 INS60 INS21 INS42 INS42 INS43 INS59 INS32 INS42 INS42 MOV32 INS42 INS42 INS42 INS32 INS42 INS42 INS42