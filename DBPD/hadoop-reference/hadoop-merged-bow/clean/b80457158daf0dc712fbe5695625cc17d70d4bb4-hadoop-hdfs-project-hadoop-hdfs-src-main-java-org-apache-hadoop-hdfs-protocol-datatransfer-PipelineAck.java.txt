HDFS-7748. Separate ECN flags from the Status in the DataTransferPipelineAck. Contributed by Anu Engineer and Haohui Mai.

-    ArrayList<Integer> replyList = Lists.newArrayList();
+    ArrayList<Status> statusList = Lists.newArrayList();
+    ArrayList<Integer> flagList = Lists.newArrayList();
-      replyList.add(r);
+      statusList.add(StatusFormat.getStatus(r));
+      flagList.add(r);
-      .addAllReply(replyList)
+      .addAllReply(statusList)
+      .addAllFlag(flagList)
-   * get the ith reply
-   * @return the the ith reply
+   * get the header flag of ith reply
-  public int getReply(int i) {
-    return proto.getReply(i);
+  public int getHeaderFlag(int i) {
+    if (proto.getFlagCount() > 0) {
+      return proto.getFlag(i);
+    } else {
+      return combineHeader(ECN.DISABLED, proto.getReply(i));
+    }
+  }
+
+  public int getFlag(int i) {
+    return proto.getFlag(i);
-    for (int reply : proto.getReplyList()) {
-      if (StatusFormat.getStatus(reply) != Status.SUCCESS) {
+    for (Status s : proto.getReplyList()) {
+      if (s != Status.SUCCESS) {
-    for (int reply : proto.getReplyList()) {
+    for (Status s : proto.getReplyList()) {
-      Status s = StatusFormat.getStatus(reply);

INS31 INS42 INS8 INS83 INS39 INS42 INS44 INS8 INS60 INS25 INS39 INS42 INS41 INS74 MOV59 INS59 UPD66 INS27 INS8 MOV8 INS32 INS43 INS43 UPD42 INS42 INS32 INS21 INS32 INS32 INS34 INS41 INS42 INS42 INS42 MOV43 INS42 INS43 INS42 INS42 INS42 INS42 INS42 INS32 MOV32 INS42 INS42 INS42 INS32 INS32 INS42 INS42 INS42 INS32 UPD42 UPD42 INS42 INS42 INS42 INS42 INS42 INS40 MOV32 INS42 INS42 INS42 INS42 UPD42 UPD42 UPD42 DEL66 DEL65 DEL42 DEL39 DEL42 DEL42 DEL42 DEL42 DEL32 DEL39 DEL42 DEL42 DEL42 DEL42 DEL42 DEL32 DEL59 DEL60