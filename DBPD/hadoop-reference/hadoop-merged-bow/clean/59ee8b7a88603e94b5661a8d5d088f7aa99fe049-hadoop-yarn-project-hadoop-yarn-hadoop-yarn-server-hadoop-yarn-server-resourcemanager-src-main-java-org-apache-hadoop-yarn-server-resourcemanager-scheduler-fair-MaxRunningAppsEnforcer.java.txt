YARN-4329. [YARN-5437] Allow fetching exact reason as to why a submitted app
is in ACCEPTED state in Fair Scheduler (Contributed by Yufei Gu)

+import org.apache.hadoop.yarn.server.resourcemanager.scheduler.SchedulerApplicationAttempt.AMState;
+   *
+   * @param queue the current queue
+   * @param attempt the app attempt being checked
+   * @return true if the application is runnable; false otherwise
-  public boolean canAppBeRunnable(FSQueue queue, String user) {
+  public boolean canAppBeRunnable(FSQueue queue, FSAppAttempt attempt) {
+    boolean ret = true;
+    if (exceedUserMaxApps(attempt.getUser())) {
+      attempt.updateAMContainerDiagnostics(AMState.INACTIVATED,
+          "The user \"" + attempt.getUser() + "\" has reached the maximum limit"
+              + " of runnable applications.");
+      ret = false;
+    } else if (exceedQueueMaxRunningApps(queue)) {
+      attempt.updateAMContainerDiagnostics(AMState.INACTIVATED,
+          "The queue \"" + queue.getName() + "\" has reached the maximum limit"
+              + " of runnable applications.");
+      ret = false;
+    }
+
+    return ret;
+  }
+
+  /**
+   * Checks whether the number of user runnable apps exceeds the limitation.
+   *
+   * @param user the user name
+   * @return true if the number hits the limit; false otherwise
+   */
+  public boolean exceedUserMaxApps(String user) {
-      return false;
+      return true;
+
+    return false;
+  }
+
+  /**
+   * Recursively checks whether the number of queue runnable apps exceeds the
+   * limitation.
+   *
+   * @param queue the current queue
+   * @return true if the number hits the limit; false otherwise
+   */
+  public boolean exceedQueueMaxRunningApps(FSQueue queue) {
-        return false;
+        return true;
-    return true;
+    return false;
-      if (canAppBeRunnable(next.getQueue(), next.getUser())) {
+      if (canAppBeRunnable(next.getQueue(), next)) {

INS26 INS40 INS31 INS31 INS29 INS83 INS39 INS42 INS44 INS44 INS8 UPD42 INS29 INS83 INS39 INS42 MOV44 INS8 MOV65 INS65 INS65 INS65 INS43 INS42 INS43 INS42 INS60 INS25 INS41 INS65 INS65 INS65 MOV41 INS65 INS65 INS65 MOV61 MOV41 INS42 INS66 INS42 INS66 INS66 INS42 INS42 INS39 INS59 INS32 INS8 INS25 INS42 INS66 INS42 INS66 INS66 INS66 INS66 INS42 INS66 INS66 INS42 INS9 INS42 INS32 INS21 INS21 INS32 INS8 MOV41 INS42 INS42 INS32 INS7 INS42 INS42 INS21 INS21 INS42 INS42 INS40 INS27 INS42 INS9 INS32 INS7 INS41 MOV42 INS45 INS32 INS45 INS45 INS42 INS42 INS40 INS27 INS42 INS9 INS9 INS42 INS42 INS45 INS32 INS45 INS45 INS42 INS42 DEL42 DEL32