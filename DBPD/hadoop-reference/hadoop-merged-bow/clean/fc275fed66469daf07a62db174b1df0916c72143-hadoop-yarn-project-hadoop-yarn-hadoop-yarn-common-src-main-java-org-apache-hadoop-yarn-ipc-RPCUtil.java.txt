YARN-625. Move the utility method unwrapAndThrowException from YarnRemoteExceptionPBImpl to RPCUtil. Contributed by Siddharth Seth.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1478594 13f79535-47bb-0310-9956-ffa450edef68

+import java.io.IOException;
+import java.lang.reflect.UndeclaredThrowableException;
+
+import org.apache.hadoop.ipc.RemoteException;
+import org.apache.hadoop.yarn.exceptions.impl.pb.YarnRemoteExceptionPBImpl;
+import com.google.protobuf.ServiceException;
+
+  
+  /**
+   * Utility method that unwraps and throws appropriate exception.
+   * 
+   * @param se ServiceException
+   * @throws YarnRemoteException
+   * @throws UndeclaredThrowableException
+   */
+  public static YarnRemoteException unwrapAndThrowException(ServiceException se)
+      throws UndeclaredThrowableException {
+    if (se.getCause() instanceof RemoteException) {
+      try {
+        throw ((RemoteException) se.getCause())
+            .unwrapRemoteException(YarnRemoteExceptionPBImpl.class);
+      } catch (YarnRemoteException ex) {
+        return ex;
+      } catch (IOException e1) {
+        throw new UndeclaredThrowableException(e1);
+      }
+    } else if (se.getCause() instanceof YarnRemoteException) {
+      return (YarnRemoteException) se.getCause();
+    } else if (se.getCause() instanceof UndeclaredThrowableException) {
+      throw (UndeclaredThrowableException) se.getCause();
+    } else {
+      throw new UndeclaredThrowableException(se);
+    }
+  }

INS26 INS26 INS26 INS26 INS26 INS40 INS40 INS40 INS40 INS40 INS31 INS29 INS83 INS83 INS43 INS42 INS44 INS43 INS8 INS65 INS65 INS65 INS65 INS42 INS43 INS42 INS42 INS25 INS66 INS42 INS66 INS42 INS42 INS42 INS62 INS8 INS25 INS32 INS43 INS54 INS62 INS8 INS25 INS42 INS42 INS42 INS8 INS12 INS12 INS32 INS43 INS41 INS62 INS8 INS8 INS53 INS44 INS8 INS44 INS8 INS42 INS42 INS42 INS11 INS32 INS43 INS53 INS53 INS32 INS43 INS42 INS41 INS43 INS42 INS53 INS43 INS32 INS42 INS42 INS42 INS11 INS14 INS36 INS42 INS57 INS42 INS42 INS42 INS14 INS42 INS42 INS42 INS43 INS32 INS43 INS42 INS11 INS43 INS43 INS42 INS42 INS42 INS42 INS42 INS43 INS32 INS42 INS42 INS42 INS42 INS42