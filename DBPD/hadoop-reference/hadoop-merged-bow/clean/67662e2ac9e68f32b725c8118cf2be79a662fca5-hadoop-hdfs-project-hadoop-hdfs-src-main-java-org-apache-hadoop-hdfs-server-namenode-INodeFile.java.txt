HDFS-12840. Creating a file with non-default EC policy in a EC zone is not correctly serialized in the editlog. Contributed by Lei (Eddy) Xu.

+import org.apache.hadoop.io.erasurecode.ErasureCodeConstants;
-        Preconditions.checkArgument(replication != null &&
-            erasureCodingPolicyID == null);
-        Preconditions.checkArgument(replication >= 0 &&
+        Preconditions.checkArgument(erasureCodingPolicyID == null ||
+                erasureCodingPolicyID ==
+                    ErasureCodeConstants.REPLICATION_POLICY_ID);
+        Preconditions.checkArgument(replication != null && replication >= 0 &&
-
-   * @return The ID of the erasure coding policy on the file. -1 represents no
-   *          EC policy.
+   * @return The ID of the erasure coding policy on the file.
-    return -1;
+    return ErasureCodeConstants.REPLICATION_POLICY_ID;

INS26 INS40 UPD66 INS40 INS27 MOV27 INS27 MOV27 INS42 INS40 MOV27 DEL66 DEL34 DEL38