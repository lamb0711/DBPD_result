YARN-6811. [ATS1.5] All history logs should be kept under its own User Directory. Contributed by Rohith Sharma K S.

-    RemoteIterator<FileStatus> iter = list(activeRootPath);
+    int logsToScanCount = scanActiveLogs(activeRootPath);
+    metrics.addActiveLogDirScanTime(Time.monotonicNow() - startTime);
+    return logsToScanCount;
+  }
+
+  int scanActiveLogs(Path dir) throws IOException {
+    RemoteIterator<FileStatus> iter = list(dir);
-        LOG.debug("Unable to parse entry {}", name);
+        logsToScanCount += scanActiveLogs(stat.getPath());
-    metrics.addActiveLogDirScanTime(Time.monotonicNow() - startTime);
+        } else {
+          // check for user directory inside active path
+          RemoteIterator<FileStatus> iter = list(activeRootPath);
+          while (iter.hasNext()) {
+            Path child = new Path(iter.next().getPath().getName(),
+                applicationId.toString());
+            appDirPath = new Path(activeRootPath, child);
+            if (fs.exists(appDirPath)) {
+              appState = AppState.ACTIVE;
+              break;
+            }
+          }

INS31 MOV78 MOV78 INS39 INS42 INS43 INS8 INS44 INS42 MOV60 INS60 MOV21 INS41 INS43 INS42 INS60 INS39 INS59 INS42 INS42 INS74 INS59 INS42 INS32 INS43 INS43 INS42 INS32 INS25 INS42 INS42 INS42 INS42 INS42 INS42 MOV32 MOV8 INS8 MOV21 MOV25 INS7 MOV32 MOV8 INS8 INS42 INS32 MOV60 INS61 UPD42 MOV42 INS32 INS32 INS8 UPD42 MOV42 UPD42 MOV42 INS42 INS42 INS60 INS21 MOV25 INS43 INS59 INS7 INS32 INS8 INS42 INS42 INS14 INS42 INS14 INS42 INS42 INS42 INS21 INS10 INS43 INS32 INS32 INS43 INS42 INS42 INS7 INS42 INS32 INS42 INS42 INS42 INS42 INS42 INS40 INS32 INS42 INS42 INS42 DEL45 DEL32 DEL8