svn merge --reintegrate https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-5535 back to trunk.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1574259 13f79535-47bb-0310-9956-ffa450edef68

-import static org.apache.hadoop.hdfs.DFSConfigKeys.DFS_NAMENODE_HTTP_ADDRESS_KEY;
+import static org.apache.hadoop.hdfs.DFSConfigKeys.DFS_NAMENODE_HTTP_ADDRESS_KEY;
+
+    public void setDnArgs(String ... args) {
+      dnArgs = args;
+    }
+    if (operation == StartupOption.ROLLINGUPGRADE) {
+      return new String[]{operation.getName(),
+          operation.getRollingUpgradeStartupOption().name()};
+    }
-  public synchronized void restartNameNode() throws IOException {
+  public synchronized void restartNameNode(String... args) throws IOException {
-    restartNameNode(true);
+    restartNameNode(0, true, args);
-  
+
-  public synchronized void restartNameNode(int nnIndex, boolean waitActive)
-      throws IOException {
+  public synchronized void restartNameNode(int nnIndex, boolean waitActive,
+      String... args) throws IOException {
-    NameNode nn = NameNode.createNameNode(createArgs(startOpt), conf);
+    if (args.length != 0) {
+      startOpt = null;
+    } else {
+      args = createArgs(startOpt);
+    }
+    NameNode nn = NameNode.createNameNode(args, conf);
-    if (nameNodes.length == 0 || nameNodes[nnIndex] == null) {
+    if (nameNodes.length == 0 || nameNodes[nnIndex] == null
+        || nameNodes[nnIndex].nameNode == null) {

MOV26 INS31 INS44 INS44 INS83 INS39 INS42 INS44 INS8 INS25 INS43 INS42 INS43 INS42 INS25 INS43 INS42 INS21 INS27 INS8 INS42 INS42 INS27 INS8 INS8 INS27 INS42 INS7 INS42 INS40 INS41 INS34 INS42 INS40 INS34 INS21 INS21 MOV27 INS27 INS42 INS42 INS3 INS7 INS7 INS42 INS22 INS33 INS5 INS4 INS42 INS33 INS42 MOV32 INS2 INS42 INS43 INS85 INS32 INS32 INS42 INS42 INS42 INS42 INS42 INS32 INS42 INS42 INS42