Merge remote-tracking branch 'apache/trunk' into HDFS-7285

Conflicts:
	hadoop-hdfs-project/hadoop-hdfs-client/src/main/java/org/apache/hadoop/hdfs/DFSClient.java
	hadoop-hdfs-project/hadoop-hdfs-client/src/main/java/org/apache/hadoop/hdfs/DFSOutputStream.java
	hadoop-hdfs-project/hadoop-hdfs-client/src/main/proto/hdfs.proto
	hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/DFSConfigKeys.java
	hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/DFSUtil.java
	hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/protocolPB/PBHelper.java
	hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/DataNode.java
	hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSDirStatAndListingOp.java
	hadoop-hdfs-project/hadoop-hdfs/src/main/proto/DatanodeProtocol.proto
	hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/blockmanagement/TestBlockTokenWithDFS.java
	hadoop-hdfs-project/hadoop-hdfs/src/test/java/org/apache/hadoop/hdfs/server/namenode/TestFsck.java

Change-Id: Ic7946c4ea35bed587fe879ce58b959b25ecc0823

+import org.apache.hadoop.hdfs.client.HdfsClientConfigKeys;
-import org.apache.htrace.Sampler;
-import org.apache.htrace.Trace;
-import org.apache.htrace.TraceScope;
+import org.apache.htrace.core.TraceScope;
-        throw DFSUtil.toInterruptedIOException("take interrupted, i=" + i, ie);
+        throw DFSUtilClient.toInterruptedIOException("take interrupted, i=" + i, ie);
-        throw DFSUtil.toInterruptedIOException("take interrupted, i=" + i, e);
+        throw DFSUtilClient.toInterruptedIOException("take interrupted, i=" + i, e);
-            + DFSConfigKeys.DFS_BYTES_PER_CHECKSUM_KEY + " (="
+            + HdfsClientConfigKeys.DFS_BYTES_PER_CHECKSUM_KEY + " (="
-      throw DFSUtil.toInterruptedIOException(
+      throw DFSUtilClient.toInterruptedIOException(
-          throw DFSUtil.toInterruptedIOException("Interrupted when waiting" +
+          throw DFSUtilClient.toInterruptedIOException("Interrupted when waiting" +
-      TraceScope scope = Trace.startSpan("completeFile", Sampler.NEVER);
+      TraceScope scope = dfsClient.getTracer().newScope("completeFile");
-      throw DFSUtil.toInterruptedIOException(
+      throw DFSUtilClient.toInterruptedIOException(

MOV26 MOV26 UPD40 UPD40 UPD42 INS32 UPD42 UPD42 UPD42 UPD42 UPD40 INS42 UPD42 MOV42 UPD42 DEL40 DEL26 DEL40