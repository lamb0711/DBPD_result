HDFS-10675. Datanode support to read from external stores.

-    File parent = currentDir.getParentFile();
-    this.usage = new DF(parent, conf);
+    if (currentDir != null) {
+      File parent = currentDir.getParentFile();
+      this.usage = new DF(parent, conf);
+      cacheExecutor = initializeCacheExecutor(parent);
+      this.metrics = DataNodeVolumeMetrics.create(conf, parent.getPath());
+    } else {
+      this.usage = null;
+      cacheExecutor = null;
+      this.metrics = null;
+    }
-    cacheExecutor = initializeCacheExecutor(parent);
-    this.metrics = DataNodeVolumeMetrics.create(conf, getBaseURI().getPath());
-   * @return
+   * @return Disk usage excluding space used by HDFS and excluding space
+   * reserved for blocks open for write.
-    
+

INS25 INS27 INS8 INS8 INS66 INS66 INS42 INS33 MOV60 MOV21 MOV21 MOV21 INS21 INS21 INS21 INS7 INS7 INS7 INS22 INS33 INS42 INS33 INS22 INS33 INS52 INS42 INS52 INS42 UPD42 MOV42 DEL32