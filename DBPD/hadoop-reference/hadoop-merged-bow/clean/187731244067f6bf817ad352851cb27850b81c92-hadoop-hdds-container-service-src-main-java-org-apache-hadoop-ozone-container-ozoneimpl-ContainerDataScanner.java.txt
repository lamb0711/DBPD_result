HDDS-2238. Container Data Scrubber spams log in empty cluster

Signed-off-by: Anu Engineer <aengineer@apache.org>

-import org.apache.hadoop.conf.Configuration;
+  private final long dataScanInterval;
-  public ContainerDataScanner(Configuration conf,
+  public ContainerDataScanner(ContainerScrubberConfiguration conf,
-                              HddsVolume volume, long bytesPerSec) {
+                              HddsVolume volume) {
-    this.throttler = new HddsDataTransferThrottler(bytesPerSec);
-    this.canceler = new Canceler();
-    this.metrics = ContainerDataScrubberMetrics.create(conf,
-        volume.toString());
+    dataScanInterval = conf.getDataScanInterval();
+    throttler = new HddsDataTransferThrottler(conf.getBandwidthPerVolume());
+    canceler = new Canceler();
+    metrics = ContainerDataScrubberMetrics.create(volume.toString());
-    Iterator<Container> itr = controller.getContainers(volume);
+    Iterator<Container<?>> itr = controller.getContainers(volume);
-      metrics.incNumScanIterations();
-      LOG.info("Completed an iteration of container data scrubber in" +
-              " {} minutes." +
-              " Number of  iterations (since the data-node restart) : {}" +
-              ", Number of containers scanned in this iteration : {}" +
-              ", Number of unhealthy containers found in this iteration : {}",
-          TimeUnit.NANOSECONDS.toMinutes(totalDuration),
-          metrics.getNumScanIterations(),
-          metrics.getNumContainersScanned(),
-          metrics.getNumUnHealthyContainers());
+      if (metrics.getNumContainersScanned() > 0) {
+        metrics.incNumScanIterations();
+        LOG.info("Completed an iteration of container data scrubber in" +
+                " {} minutes." +
+                " Number of iterations (since the data-node restart) : {}" +
+                ", Number of containers scanned in this iteration : {}" +
+                ", Number of unhealthy containers found in this iteration : {}",
+            TimeUnit.NANOSECONDS.toMinutes(totalDuration),
+            metrics.getNumScanIterations(),
+            metrics.getNumContainersScanned(),
+            metrics.getNumUnHealthyContainers());
+      }
+      long elapsedMillis = TimeUnit.NANOSECONDS.toMillis(totalDuration);
+      long remainingSleep = dataScanInterval - elapsedMillis;
+      if (remainingSleep > 0) {
+        try {
+          Thread.sleep(remainingSleep);
+        } catch (InterruptedException ignored) {
+        }
+      }

INS23 INS83 INS83 INS39 INS59 INS42 UPD43 INS21 INS25 UPD42 INS7 UPD74 MOV38 INS8 INS42 INS32 INS42 INS42 INS42 INS74 MOV25 INS60 INS60 INS25 INS42 INS42 INS32 MOV43 INS76 INS27 INS39 INS59 INS39 INS59 INS27 INS8 INS42 INS42 INS32 INS34 INS42 INS32 INS42 INS27 INS42 INS34 INS54 INS42 INS42 INS40 INS42 INS42 INS42 INS42 INS8 INS12 INS21 INS44 INS8 UPD45 INS32 INS43 INS42 INS42 INS42 INS42 INS42 DEL40 DEL26 DEL39 DEL42 DEL44 DEL52 DEL42 DEL22 DEL42 DEL52 DEL42 DEL22 DEL52 DEL42 DEL22 DEL42