HDFS-7339. Allocating and persisting block groups in NameNode. Contributed by Zhe Zhang

-      newBlock = (shouldCopyOnTruncate) ? createNewBlock() :
+      newBlock = (shouldCopyOnTruncate) ? createNewBlock(file.isStriped()) :
+   * @param isStriped is the file under striping or contiguous layout?
-    Block b = new Block(nextBlockId(), 0, 0);
+    Block b = new Block(nextBlockId(isStriped), 0, 0);
+   * @param isStriped is the file under striping or contiguous layout?
-  private long nextBlockId() throws IOException {
+  private long nextBlockId(boolean isStriped) throws IOException {
-    final long blockId = blockIdManager.nextBlockId();
+    final long blockId = isStriped ?
+        blockIdManager.nextBlockGroupId() : blockIdManager.nextBlockId();

INS44 INS65 INS65 INS39 INS42 INS42 INS66 MOV43 INS42 INS66 INS16 MOV43 INS42 INS32 MOV32 INS42 INS42 INS42 INS32 INS42 INS42