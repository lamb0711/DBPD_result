HDFS-11108. Ozone: use containers with the state machine. Contributed by Anu Engineer

+import org.apache.hadoop.ozone.container.ozoneimpl.OzoneContainer;
-  private final long taskWaitTime;
+  private final OzoneContainer container;
-   * Constructs a container state machine.
+   * Constructs a a datanode state machine.
-  public DatanodeStateMachine(Configuration conf) {
+  public DatanodeStateMachine(Configuration conf) throws IOException {
-            .setNameFormat("Container State Machine Thread - %d").build());
+            .setNameFormat("Datanode State Machine Thread - %d").build());
-    taskWaitTime = this.conf.getLong(OzoneConfigKeys.OZONE_CONTAINER_TASK_WAIT,
-        OzoneConfigKeys.OZONE_CONTAINER_TASK_WAIT_DEFAULT);
+    container = new OzoneContainer(conf);
+    container.start();
-        context.execute(executorService, taskWaitTime, TimeUnit.SECONDS);
+        context.execute(executorService, heartbeatFrequency,
+            TimeUnit.MILLISECONDS);
+
+    if(container != null) {
+      container.stop();
+    }
-     * @param value
+     * @param value  Enum Value
+
+  public static DatanodeStateMachine initStateMachine(Configuration conf)
+      throws IOException {
+    DatanodeStateMachine stateMachine = new DatanodeStateMachine(conf);
+    Runnable startStateMachineTask = () -> {
+      try {
+        stateMachine.start();
+      } catch (Exception ex) {
+        LOG.error("Unable to start the DatanodeState Machine", ex);
+      }
+    };
+    Thread thread =  new ThreadFactoryBuilder()
+        .setDaemon(true)
+        .setNameFormat("Datanode State Machine Thread - %d")
+        .build().newThread(startStateMachineTask);
+    thread.start();
+    return stateMachine;
+  }

INS26 MOV23 INS40 INS31 INS43 INS43 MOV21 INS83 INS83 INS43 INS42 INS44 INS43 INS8 INS42 UPD42 INS42 INS21 INS25 INS42 INS43 INS42 INS42 INS60 INS60 INS60 INS21 INS41 UPD66 INS32 INS27 INS8 INS42 INS43 INS59 INS43 INS59 INS43 INS59 INS32 INS42 UPD42 INS14 INS42 INS42 INS42 INS33 INS21 INS66 INS42 INS42 INS14 INS42 INS42 INS86 INS42 INS42 INS32 INS42 INS42 INS43 INS42 INS32 INS43 INS42 INS8 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS54 INS32 INS42 UPD45 INS8 INS12 INS32 INS42 INS45 UPD42 UPD40 INS21 INS44 INS8 INS14 INS42 INS9 INS32 INS43 INS42 INS21 INS43 INS42 INS42 INS42 INS32 INS42 INS42 INS42 INS45 INS42 DEL39 DEL52 DEL42 DEL22 DEL42 DEL40 DEL40 DEL32