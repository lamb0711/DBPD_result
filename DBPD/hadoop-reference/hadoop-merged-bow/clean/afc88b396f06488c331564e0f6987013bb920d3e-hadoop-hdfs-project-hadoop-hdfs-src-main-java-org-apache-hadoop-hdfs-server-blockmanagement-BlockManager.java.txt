HDFS-328. Improve fs -setrep error message for invalid replication factors. Contributed by Daniel Templeton.

-   * determined by system configuration.
+   * determined by system configuration and throw an exception if it's not.
+   *
+   * @param src the path to the target file
+   * @param replication the requested replication factor
+   * @param clientName the name of the client node making the request
+   * @throws java.io.IOException thrown if the requested replication factor
+   * is out of bounds
-    if (replication >= minReplication && replication <= maxReplication) {
-      //common case. avoid building 'text'
-      return;
+    if (replication < minReplication || replication > maxReplication) {
+      StringBuilder msg = new StringBuilder("Requested replication factor of ");
+
+      msg.append(replication);
+
+      if (replication > maxReplication) {
+        msg.append(" exceeds maximum of ");
+        msg.append(maxReplication);
+      } else {
+        msg.append(" is less than the required minimum of ");
+        msg.append(minReplication);
+      }
+
+      msg.append(" for ").append(src);
+
+      if (clientName != null) {
+        msg.append(" from ").append(clientName);
+      }
+
+      throw new IOException(msg.toString());
-    
-    String text = "file " + src 
-      + ((clientName != null) ? " on client " + clientName : "")
-      + ".\n"
-      + "Requested replication " + replication;
-
-    if (replication > maxReplication)
-      throw new IOException(text + " exceeds maximum " + maxReplication);
-
-    if (replication < minReplication)
-      throw new IOException(text + " is less than the required minimum " +
-                            minReplication);

INS65 INS65 INS65 INS65 INS25 UPD66 INS42 INS66 INS42 INS66 INS42 INS66 INS40 INS66 INS66 INS27 INS8 MOV27 UPD27 MOV27 INS60 INS21 INS25 INS21 MOV25 INS53 UPD42 INS43 INS59 INS32 MOV27 INS8 INS8 INS32 MOV27 INS8 MOV14 INS42 INS42 INS14 INS42 INS42 INS42 INS21 INS21 INS21 INS21 INS32 INS42 INS42 INS21 INS32 INS43 INS45 INS32 INS32 INS32 INS32 INS42 INS42 INS45 INS32 INS42 INS42 UPD42 MOV42 INS42 INS42 INS45 INS42 INS42 INS42 INS42 INS42 INS45 INS42 INS42 INS42 INS32 INS42 INS42 INS42 INS42 INS45 DEL42 DEL43 DEL42 DEL45 DEL42 DEL27 DEL14 DEL53 DEL42 DEL45 DEL42 DEL27 DEL42 DEL42 DEL27 DEL27 DEL41 DEL8 DEL25 DEL43 DEL42 DEL45 DEL42 DEL36 DEL45 DEL42 DEL27 DEL45 DEL16 DEL36 DEL45 DEL45 DEL42 DEL27 DEL59 DEL60 DEL53 DEL25