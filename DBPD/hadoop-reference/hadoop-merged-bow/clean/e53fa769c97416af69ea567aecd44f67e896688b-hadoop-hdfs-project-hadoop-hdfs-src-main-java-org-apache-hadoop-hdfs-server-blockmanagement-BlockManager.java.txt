HDFS-8186. Erasure coding: Make block placement policy for EC file configurable. Contributed by Walter Su.

-  private BlockPlacementPolicy blockplacement;
+  private BlockPlacementPolicies placementPolicies;
-    blockplacement = BlockPlacementPolicy.getInstance(
+    placementPolicies = new BlockPlacementPolicies(
-    return blockplacement;
-  }
-
-  /** Set BlockPlacementPolicy */
-  public void setBlockPlacementPolicy(BlockPlacementPolicy newpolicy) {
-    if (newpolicy == null) {
-      throw new HadoopIllegalArgumentException("newpolicy == null");
-    }
-    this.blockplacement = newpolicy;
+    return placementPolicies.getPolicy(false);
-      rw.chooseTargets(blockplacement, storagePolicySuite, excludedNodes);
+      final BlockPlacementPolicy placementPolicy =
+          placementPolicies.getPolicy(rw.block.isStriped());
+      rw.chooseTargets(placementPolicy, storagePolicySuite, excludedNodes);
-    return blockplacement.chooseTarget(src, 1, clientnode,
+    return placementPolicies.getPolicy(false).chooseTarget(src, 1, clientnode,
-      byte storagePolicyID) {
-    
+      byte storagePolicyID,
+      boolean isStriped) {
+    final BlockPlacementPolicy blockplacement = placementPolicies.getPolicy(isStriped);
-      final byte storagePolicyID) throws IOException {
+      final byte storagePolicyID,
+      final boolean isStriped) throws IOException {
+    final BlockPlacementPolicy blockplacement = placementPolicies.getPolicy(isStriped);
-        addedNode, delNodeHint, blockplacement);
+        addedNode, delNodeHint, placementPolicies.getPolicy(false));
+

INS43 MOV78 MOV43 UPD42 INS44 INS44 INS42 UPD42 INS41 INS39 INS42 INS60 INS83 INS39 INS42 INS60 INS32 INS83 MOV43 INS59 INS83 INS43 INS59 UPD42 INS14 INS42 INS42 INS9 INS60 INS32 INS42 INS32 INS42 INS42 INS32 INS32 INS43 INS42 MOV32 MOV32 MOV32 INS83 MOV43 INS59 UPD42 MOV42 INS42 INS9 INS42 INS42 INS42 INS42 INS42 INS42 UPD42 MOV42 INS42 INS9 INS42 INS42 INS32 UPD42 INS42 INS42 INS32 INS40 INS42 DEL42 DEL42 DEL42 DEL32 DEL83 DEL42 DEL42 DEL41 DEL8 DEL31 DEL66 DEL65 DEL29 DEL39 DEL42 DEL44 DEL42 DEL33 DEL27 DEL42 DEL43 DEL45 DEL14 DEL53 DEL8 DEL25 DEL52 DEL42 DEL22 DEL42 DEL7 DEL21