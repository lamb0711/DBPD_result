HDFS-2693. Fix synchronization issues around state transition. Contributed by Todd Lipcon.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1221582 13f79535-47bb-0310-9956-ffa450edef68

+   * A unique instance identifier for the cluster. This
+   * is used to disambiguate HA filesystems in the case where
+   * multiple MiniDFSClusters are used in the same test suite. 
+   */
+  private int instanceId;
+  private static int instanceCount = 0;
+  
+  /**
+    synchronized (MiniDFSCluster.class) {
+      instanceId = instanceCount++;
+    }
+    synchronized (MiniDFSCluster.class) {
+      instanceId = instanceCount++;
+    }
+
+  
+  public int getInstanceId() {
+    return instanceId;
+  }

INS23 INS23 INS31 INS29 INS83 INS39 INS59 INS83 INS83 INS39 INS59 INS83 INS39 INS42 INS8 INS65 INS42 INS42 INS34 INS51 INS51 INS41 INS66 INS66 INS66 INS57 INS8 INS57 INS8 INS42 INS43 INS21 INS43 INS21 INS42 INS7 INS42 INS7 INS42 INS37 INS42 INS37 INS42 INS42