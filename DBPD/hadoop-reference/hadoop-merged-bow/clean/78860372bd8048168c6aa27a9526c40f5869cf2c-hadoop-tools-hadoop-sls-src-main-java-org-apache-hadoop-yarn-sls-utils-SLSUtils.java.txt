YARN-8134. Support specifying node resources in SLS. Contributed by Abhishek Modi.

+
+import java.util.HashMap;
+import org.apache.hadoop.yarn.api.records.Resource;
+import org.apache.hadoop.yarn.api.records.ResourceInformation;
+import org.apache.hadoop.yarn.util.resource.ResourceUtils;
+import org.apache.hadoop.yarn.util.resource.Resources;
-  public static Set<String> parseNodesFromNodeFile(String nodeFile)
-          throws IOException {
-    Set<String> nodeSet = new HashSet<String>();
+  public static Map<String, Resource> parseNodesFromNodeFile(String nodeFile,
+      Resource nmDefaultResource) throws IOException {
+    Map<String, Resource> nodeResourceMap = new HashMap<>();
-          nodeSet.add(rack + "/" + jsonNode.get("node"));
+          Resource nodeResource = Resources.clone(nmDefaultResource);
+          ResourceInformation[] infors = ResourceUtils.getResourceTypesArray();
+          for (ResourceInformation info : infors) {
+            if (jsonNode.get(info.getName()) != null) {
+              nodeResource.setResourceValue(info.getName(),
+                  Integer.parseInt(jsonNode.get(info.getName()).toString()));
+            }
+          }
+          nodeResourceMap.put(rack + "/" + jsonNode.get("node"), nodeResource);
-    return nodeSet;
+    return nodeResourceMap;

INS26 INS26 INS26 INS26 INS26 INS40 INS40 INS40 INS40 INS40 UPD74 INS44 UPD43 MOV43 UPD43 INS43 INS42 UPD42 UPD42 INS42 UPD74 UPD42 UPD43 MOV43 INS43 UPD42 UPD42 INS42 UPD74 UPD43 UPD42 INS8 MOV60 INS60 INS60 INS70 MOV21 INS43 INS59 INS5 INS59 INS44 INS42 INS8 INS42 INS42 INS32 INS43 INS85 INS42 INS32 INS43 INS42 INS25 UPD42 UPD42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS27 INS8 INS32 INS33 INS21 INS42 INS42 INS32 INS32 INS42 INS42 INS42 INS42 INS32 INS32 INS42 INS42 INS42 INS42 INS32 INS32 INS42 INS42 INS42 INS32 INS42 INS42 DEL8