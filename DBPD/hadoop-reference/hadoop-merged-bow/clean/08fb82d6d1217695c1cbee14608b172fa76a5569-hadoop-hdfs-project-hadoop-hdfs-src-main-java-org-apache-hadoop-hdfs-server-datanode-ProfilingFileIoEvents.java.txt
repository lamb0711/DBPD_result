HDFS-11488. JN log segment syncing should support HA upgrade. Contributed by Hanisha Koneru.

-      double fileIOSamplingFraction = conf.getDouble(
-          DFSConfigKeys.DFS_DATANODE_FILEIO_PROFILING_SAMPLING_FRACTION_KEY,
+      int fileIOSamplingPercentage = conf.getInt(
+          DFSConfigKeys.DFS_DATANODE_FILEIO_PROFILING_SAMPLING_PERCENTAGE_KEY,
-              .DFS_DATANODE_FILEIO_PROFILING_SAMPLING_FRACTION_DEFAULT);
-      isEnabled = Util.isDiskStatsEnabled(fileIOSamplingFraction);
-      if (fileIOSamplingFraction > 1) {
+              .DFS_DATANODE_FILEIO_PROFILING_SAMPLING_PERCENTAGE_DEFAULT);
+      isEnabled = Util.isDiskStatsEnabled(fileIOSamplingPercentage);
+      if (fileIOSamplingPercentage > 100) {
-            .DFS_DATANODE_FILEIO_PROFILING_SAMPLING_FRACTION_KEY +
-            " value cannot be more than 1. Setting value to 1");
-        fileIOSamplingFraction = 1;
+            .DFS_DATANODE_FILEIO_PROFILING_SAMPLING_PERCENTAGE_KEY +
+            " value cannot be more than 100. Setting value to 100");
+        fileIOSamplingPercentage = 100;
-      sampleRangeMax = (int) (fileIOSamplingFraction * Integer.MAX_VALUE);
+      sampleRangeMax = (int) ((double) fileIOSamplingPercentage / 100 *
+          Integer.MAX_VALUE);

UPD39 UPD42 UPD42 UPD34 UPD42 UPD40 UPD40 UPD42 UPD42 UPD34 UPD40 UPD45 INS27 INS11 INS34 INS39 INS42 DEL42