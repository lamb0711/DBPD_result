YARN-10107. Fix GpuResourcePlugin#getNMResourceInfo to honor Auto Discovery Enabled

Contributed by Szilard Nemeth.

-    GpuDeviceInformation gpuDeviceInformation;
+    final GpuDeviceInformation gpuDeviceInformation;
-    //At this point the gpu plugin is already enabled
-    checkGpuResourceHandler();
+    if (gpuDiscoverer.isAutoDiscoveryEnabled()) {
+      //At this point the gpu plugin is already enabled
+      checkGpuResourceHandler();
-    checkErrorCount();
-    try{
-      gpuDeviceInformation = gpuDiscoverer.getGpuDeviceInformation();
-      numOfErrorExecutionSinceLastSucceed = 0;
-    } catch (YarnException e) {
-      LOG.error(e.getMessage(), e);
-      numOfErrorExecutionSinceLastSucceed++;
-      throw e;
+      checkErrorCount();
+      try{
+        gpuDeviceInformation = gpuDiscoverer.getGpuDeviceInformation();
+        numOfErrorExecutionSinceLastSucceed = 0;
+      } catch (YarnException e) {
+        LOG.error(e.getMessage(), e);
+        numOfErrorExecutionSinceLastSucceed++;
+        throw e;
+      }
+    } else {
+      gpuDeviceInformation = null;
-
-

INS25 INS83 INS32 INS8 INS8 INS42 INS42 MOV21 MOV21 MOV54 INS21 INS7 INS42 INS33