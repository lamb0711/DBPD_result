HDFS-2894. HA: automatically determine the nameservice Id if only one nameservice is configured. Contributed by Eli Collins


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1240917 13f79535-47bb-0310-9956-ffa450edef68

-   * configured, this method determines the nameservice Id by matching the local
-   * node's address with the configured addresses. When a match is found, it
-   * returns the nameservice Id from the corresponding configuration key.
+   * configured, and more than one nameservice Id is configured, this method 
+   * determines the nameservice Id by matching the local node's address with the
+   * configured addresses. When a match is found, it returns the nameservice Id
+   * from the corresponding configuration key.
+    Collection<String> nsIds = getNameServiceIds(conf);
+    if (1 == nsIds.size()) {
+      return nsIds.toArray(new String[1])[0];
+    }
-      if (nsIds.size() != 1) {
+      if (1 == nsIds.size()) {
+        nsId = nsIds.toArray(new String[1])[0];
+      } else {
-      } else {
-        nsId = nsIds.toArray(new String[1])[0];

INS60 INS25 INS66 UPD66 UPD66 UPD66 INS74 INS59 INS27 INS8 INS43 INS43 INS42 INS32 INS34 INS32 INS41 MOV8 INS42 INS42 INS42 INS42 INS42 INS42 INS2 UPD27 MOV32 INS32 INS34 INS42 INS42 INS3 INS5 INS34 INS43 INS85 INS42