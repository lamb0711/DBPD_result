HDFS-14226. RBF: Setting attributes should set on all subclusters' directories. Contributed by Ayush Saxena.

-}
+
+  /**
+   * Check if a path should be in all subclusters.
+   *
+   * @param path Path to check.
+   * @return If a path should be in all subclusters.
+   */
+  boolean isPathAll(final String path) {
+    if (subclusterResolver instanceof MountTableResolver) {
+      try {
+        MountTableResolver mountTable = (MountTableResolver) subclusterResolver;
+        MountTable entry = mountTable.getMountPoint(path);
+        if (entry != null) {
+          return entry.isAll();
+        }
+      } catch (IOException e) {
+        LOG.error("Cannot get mount point", e);
+      }
+    }
+    return false;
+  }
+
+  /**
+   * Check if call needs to be invoked to all the locations. The call is
+   * supposed to be invoked in all the locations in case the order of the mount
+   * entry is amongst HASH_ALL, RANDOM or SPACE or if the source is itself a
+   * mount entry.
+   * @param path The path on which the operation need to be invoked.
+   * @return true if the call is supposed to invoked on all locations.
+   * @throws IOException
+   */
+  boolean isInvokeConcurrent(final String path) throws IOException {
+    if (subclusterResolver instanceof MountTableResolver) {
+      MountTableResolver mountTableResolver =
+          (MountTableResolver) subclusterResolver;
+      List<String> mountPoints = mountTableResolver.getMountPoints(path);
+      // If this is a mount point, we need to invoke everywhere.
+      if (mountPoints != null) {
+        return true;
+      }
+      return isPathAll(path);
+    }
+    return false;
+  }
+}

INS31 INS31 INS29 INS39 INS42 INS44 INS8 INS29 INS39 INS42 INS44 INS43 INS8 INS65 INS65 INS65 INS83 INS43 INS42 INS25 INS41 INS65 INS65 INS65 INS65 INS83 INS43 INS42 INS42 INS25 INS41 INS66 INS42 INS66 INS66 INS42 INS62 INS8 INS9 INS66 INS66 INS66 INS66 INS42 INS66 INS66 INS42 INS42 INS62 INS8 INS9 INS42 INS43 INS54 INS42 INS43 INS60 INS60 INS25 INS41 INS42 INS8 INS12 INS42 INS43 INS59 INS74 INS59 INS27 INS8 INS32 INS60 INS60 INS25 INS44 INS8 INS42 INS42 INS11 INS43 INS43 INS42 INS32 INS42 INS33 INS41 INS42 INS42 INS43 INS59 INS43 INS59 INS27 INS8 INS43 INS42 INS21 INS43 INS42 INS42 INS42 INS42 INS42 INS42 INS9 INS42 INS42 INS11 INS42 INS42 INS32 INS42 INS33 INS41 INS42 INS32 INS42 INS43 INS42 INS42 INS42 INS42 INS32 INS42 INS42 INS45 INS42 INS42 INS42 INS42