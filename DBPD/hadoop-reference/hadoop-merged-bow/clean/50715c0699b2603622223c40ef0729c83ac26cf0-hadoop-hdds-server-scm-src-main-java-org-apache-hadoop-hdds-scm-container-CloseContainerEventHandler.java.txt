HDDS-662. Introduce ContainerReplicaState in StorageContainerManager. Contributed by Nanda kumar.

-import org.apache.hadoop.hdds.scm.container.common.helpers.ContainerInfo;
-          containerManager.getContainerWithPipeline(containerID.getId());
+          containerManager.getContainerWithPipeline(containerID);
-        LOG.debug("Closing container {} in {} state", containerID, state);
-        containerManager.updateContainerState(containerID.getId(),
+        LOG.debug("Closing container #{} in {} state", containerID, state);
+        containerManager.updateContainerState(containerID,
-        containerManager.updateContainerState(containerID.getId(),
+        containerManager.updateContainerState(containerID,
-        LOG.info(
-            "container with id : {} is in {} state and need not be closed.",
-            containerID.getId(), info.getState());
+        LOG.info("Cannot close container #{}, it is already in {} state.",
+            containerID.getId(), state);
-        throw new IOException(
-            "Invalid container state for container " + containerID);
+        throw new IOException("Invalid container state for container #"
+            + containerID);
-      LOG.error("Failed to update the container state for" + "container : {}"
+      LOG.error("Failed to update the container state for container #{}"
-    pipeline.getMachines().stream().map(
-        datanode -> new CommandForDatanode<>(datanode.getUuid(),
-            closeContainerCommand)).forEach((command) -> {
-              publisher.fireEvent(DATANODE_COMMAND, command);
-            });
+    pipeline.getMachines().stream()
+        .map(node ->
+            new CommandForDatanode<>(node.getUuid(), closeContainerCommand))
+        .forEach(command -> publisher.fireEvent(DATANODE_COMMAND, command));
+
+

MOV32 MOV42 UPD45 MOV42 MOV42 UPD45 UPD42 MOV42 UPD42 UPD45 UPD45 UPD42 DEL40 DEL26 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32 DEL45 DEL21 DEL8