HDFS-6932. Balancer and Mover tools should ignore replicas on RAM_DISK. (Contributed by Xiaoyu Yao)

-      for(StorageType t : StorageType.asList()) {
+      for(StorageType t : StorageType.getMovableTypes()) {
-      for(StorageType t : StorageType.asList()) {
+      for(StorageType t : StorageType.getMovableTypes()) {
-        if (!diff.removeOverlap()) {
+        if (!diff.removeOverlap(true)) {
-    
+
-     * @return if the existing types or the expected types is empty after
+     * @param  ignoreNonMovable ignore non-movable storage types
+     *         by removing them from both expected and existing storage type list
+     *         to prevent non-movable storage from being moved.
+     * @returns if the existing types or the expected types is empty after
-    boolean removeOverlap() { 
+    boolean removeOverlap(boolean ignoreNonMovable) {
+      if (ignoreNonMovable) {
+        removeNonMovable(existing);
+        removeNonMovable(expected);
+      }
-    
+
+    void removeNonMovable(List<StorageType> types) {
+      for (Iterator<StorageType> i = types.iterator(); i.hasNext(); ) {
+        final StorageType t = i.next();
+        if (!t.isMovable()) {
+          i.remove();
+        }
+      }
+    }
+

INS31 INS44 INS39 INS42 INS44 INS8 INS65 UPD65 INS39 INS42 INS25 INS74 INS42 INS24 INS42 INS66 INS66 INS66 INS42 INS8 INS43 INS43 INS58 INS32 INS8 UPD42 INS21 INS21 INS42 INS42 INS74 INS59 INS42 INS42 INS60 INS25 UPD42 INS32 INS32 INS43 INS43 INS42 INS32 INS83 INS43 INS59 INS38 INS8 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS32 INS32 INS21 INS9 INS42 INS42 INS42 INS42 INS32 INS42 INS42