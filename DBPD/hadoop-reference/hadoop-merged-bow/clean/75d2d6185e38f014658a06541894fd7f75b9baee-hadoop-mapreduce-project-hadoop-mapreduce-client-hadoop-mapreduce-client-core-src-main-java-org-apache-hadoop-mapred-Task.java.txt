MAPREDUCE-3809. Ensure that there is no needless sleep in Task at the end of the task. Contributed by Siddharth Seth.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1241282 13f79535-47bb-0310-9956-ffa450edef68

-          try {
-            Thread.sleep(PROGRESS_INTERVAL);
-          } 
-          catch (InterruptedException e) {
-            if (LOG.isDebugEnabled()) {
-              LOG.debug(getTaskID() + " Progress/ping thread exiting " +
-                        "since it got interrupted");
+          synchronized(lock) {
+            if (taskDone.get()) {
+              break;
+            lock.wait(PROGRESS_INTERVAL);
+          }
+          if (taskDone.get()) {
-        synchronized (lock) {
+        // Intent of the lock is to not send an interupt in the middle of an
+        // umbilical.ping or umbilical.statusUpdate
+        synchronized(lock) {
+        //Interrupt if sleeping. Otherwise wait for the RPC call to return.
+          lock.notify(); 
+        }
+
+        synchronized (lock) { 

INS51 INS42 INS8 INS51 MOV25 INS21 INS42 INS8 INS32 INS25 MOV21 UPD42 UPD42 INS10 INS42 INS42 INS32 INS8 INS42 INS42 INS10 UPD42 UPD42 DEL42 DEL42 DEL42 DEL32 DEL45 DEL45 DEL27 DEL32 DEL21 DEL8 DEL42 DEL43 DEL42 DEL44 DEL10 DEL8 DEL12 DEL54