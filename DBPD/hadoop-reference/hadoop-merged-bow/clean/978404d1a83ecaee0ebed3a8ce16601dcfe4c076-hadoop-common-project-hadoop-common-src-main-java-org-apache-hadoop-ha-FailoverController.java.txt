HADOOP-8208. Disallow self failover. Contributed by Eli Collins


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1306935 13f79535-47bb-0310-9956-ffa450edef68

+   * @param from currently active service
-  private static void preFailoverChecks(HAServiceTarget target,
+  private static void preFailoverChecks(HAServiceTarget from,
+                                        HAServiceTarget target,
+    if (from.getAddress().equals(target.getAddress())) {
+      throw new FailoverFailedException(
+          "Can't failover a service to itself");
+    }
+
-    preFailoverChecks(toSvc, forceActive);
+    preFailoverChecks(fromSvc, toSvc, forceActive);

INS44 INS65 INS43 INS42 INS25 INS42 INS66 INS42 INS32 INS8 INS32 INS42 INS32 INS53 INS42 INS42 INS42 INS42 INS42 INS14 INS43 INS45 INS42