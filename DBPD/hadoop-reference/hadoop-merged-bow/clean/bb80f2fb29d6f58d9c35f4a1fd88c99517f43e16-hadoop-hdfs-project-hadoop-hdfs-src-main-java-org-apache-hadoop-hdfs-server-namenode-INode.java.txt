HDFS-4436. Change INode.recordModification(..) to return only the current inode and remove the updateCircularList parameter from some methods in INodeDirectoryWithSnapshot.Diff.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1438203 13f79535-47bb-0310-9956-ffa450edef68

-    Pair<? extends INode, ? extends INode> pair = recordModification(latest);
-    INode nodeToUpdate = pair != null ? pair.left : this;
+    final INode nodeToUpdate = recordModification(latest);
-   * @return see {@link #createSnapshotCopy()}. 
+   * @return The current inode, which usually is the same object of this inode.
+   *         However, in some cases, this inode may be replaced with a new inode
+   *         for maintaining snapshots. The current inode is then the new inode.
-  Pair<? extends INode, ? extends INode> recordModification(Snapshot latest) {
+  INode recordModification(final Snapshot latest) {
-    return latest == null? null: parent.saveChild2Snapshot(this, latest);
+    return parent.saveChild2Snapshot(this, latest);
-    Pair<? extends INode, ? extends INode> pair = recordModification(latest);
-    INode nodeToUpdate = pair != null ? pair.left : this;
+    final INode nodeToUpdate = recordModification(latest);
-    Pair<? extends INode, ? extends INode> pair = recordModification(latest);
-    INode nodeToUpdate = pair != null ? pair.left : this;    
+    final INode nodeToUpdate = recordModification(latest);

MOV43 INS83 INS83 MOV43 UPD66 UPD66 INS66 MOV32 INS83 MOV43 INS83 MOV43 MOV59 UPD42 MOV32 UPD42 DEL42 DEL43 DEL76 DEL42 DEL43 DEL76 DEL74 DEL42 DEL43 DEL42 DEL42 DEL33 DEL27 DEL40 DEL52 DEL16 DEL59 DEL60 DEL42 DEL68 DEL65 DEL42 DEL43 DEL76 DEL42 DEL43 DEL76 DEL74 DEL42 DEL33 DEL27 DEL33 DEL16 DEL42 DEL43 DEL76 DEL42 DEL43 DEL76 DEL74 DEL60 DEL42 DEL33 DEL27 DEL40 DEL52 DEL16 DEL42 DEL43 DEL42 DEL43 DEL76 DEL42 DEL43 DEL76 DEL74 DEL42 DEL59 DEL42 DEL43 DEL42 DEL42 DEL33 DEL27 DEL40 DEL52 DEL16 DEL59 DEL60