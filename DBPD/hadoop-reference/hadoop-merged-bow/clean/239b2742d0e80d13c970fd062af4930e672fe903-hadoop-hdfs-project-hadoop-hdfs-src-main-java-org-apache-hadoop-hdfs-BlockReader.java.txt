HDFS-4353. Encapsulate connections to peers in Peer and PeerServer classes. Contributed by Colin Patrick McCabe.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1430507 13f79535-47bb-0310-9956-ffa450edef68

-import java.net.Socket;
-import org.apache.hadoop.hdfs.protocol.datatransfer.IOStreamPair;
-  void close() throws IOException;
+  /**
+   * Close the block reader.
+   *
+   * @param peerCache      The PeerCache to put the Peer we're using back
+   *                       into, or null if we should simply close the Peer
+   *                       we're using (along with its Socket).
+   *                       Some block readers, like BlockReaderLocal, may
+   *                       not make use of this parameter.
+   *
+   * @throws IOException
+   */
+  void close(PeerCache peerCache) throws IOException;
-
-  /**
-   * Take the socket used to talk to the DN.
-   */
-  Socket takeSocket();
-
-  /**
-   * Whether the BlockReader has reached the end of its input stream
-   * and successfully sent a status code back to the datanode.
-   */
-  boolean hasSentStatusCode();
-
-  /**
-   * @return a reference to the streams this block reader is using.
-   */
-  IOStreamPair getStreams();

INS31 INS29 UPD39 MOV39 UPD42 MOV42 INS44 MOV43 MOV65 INS65 INS65 INS43 INS42 UPD66 INS42 INS66 INS66 INS66 UPD66 MOV66 UPD66 MOV66 INS42 UPD42 MOV42 DEL40 DEL26 DEL40 DEL26 DEL39 DEL42 DEL31 DEL29 DEL42 DEL43 DEL42 DEL31 DEL65 DEL29 DEL31 DEL66 DEL65 DEL29 DEL43 DEL42 DEL31