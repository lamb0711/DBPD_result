YARN-1752. Fixed ApplicationMasterService to reject unregister request if AM did not register before. Contributed by Rohith Sharma.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1574623 13f79535-47bb-0310-9956-ffa450edef68

+      if (!hasApplicationMasterRegistered(applicationAttemptId)) {
+        String message =
+            "Application Master is trying to unregister before registering for: "
+                + applicationAttemptId.getApplicationId();
+        LOG.error(message);
+        RMAuditLogger.logFailure(
+            this.rmContext.getRMApps()
+                .get(applicationAttemptId.getApplicationId()).getUser(),
+            AuditConstants.UNREGISTER_AM, "", "ApplicationMasterService",
+            message, applicationAttemptId.getApplicationId(),
+            applicationAttemptId);
+        throw new InvalidApplicationMasterRequestException(message);
+      }

INS25 INS38 INS8 INS32 INS60 INS21 INS21 INS53 INS42 INS42 INS43 INS59 INS32 INS32 INS14 INS42 INS42 INS27 INS42 INS42 INS42 INS42 INS42 INS32 INS40 INS45 INS45 INS42 INS32 INS42 INS43 INS42 INS45 INS32 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS32 INS42 INS32 INS22 INS42 INS42 INS42 INS52 INS42