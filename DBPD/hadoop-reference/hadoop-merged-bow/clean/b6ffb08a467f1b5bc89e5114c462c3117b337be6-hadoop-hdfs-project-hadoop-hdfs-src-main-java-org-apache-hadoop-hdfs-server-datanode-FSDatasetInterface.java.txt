HDFS-2887. FSVolume, is a part of FSDatasetInterface implementation, should not be referred outside FSDataset.  A new FSVolumeInterface is defined.  The BlockVolumeChoosingPolicy.chooseVolume(..) method signature is also updated.  (szetszwo)


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1242087 13f79535-47bb-0310-9956-ffa450edef68

+import java.io.File;
+import java.util.List;
+import java.util.Map;
-  
-  
+  /**
+   * This is an interface for the underlying volume.
+   * @see org.apache.hadoop.hdfs.server.datanode.FSDataset.FSVolume
+   */
+  interface FSVolumeInterface {
+    /** @return a list of block pools. */
+    public String[] getBlockPoolList();
+
+    /** @return the available storage space in bytes. */
+    public long getAvailable() throws IOException;
+
+    /** @return the directory for the block pool. */
+    public File getDirectory(String bpid) throws IOException;
+
+    /** @return the directory for the finalized blocks in the block pool. */
+    public File getFinalizedDir(String bpid) throws IOException;
+  }
+
+  /** @return a list of volumes. */
+  public List<FSVolumeInterface> getVolumes();
+
+  /** @return a volume information map (name => info). */
+  public Map<String, Object> getVolumeInfoMap();
+
+  /** @return a list of block pools. */
+  public String[] getBlockPoolList();
+
+  /** @return a list of finalized blocks for the given block pool. */
+  public List<Block> getFinalizedBlocks(String bpid);
+
+  /**
+   * Check whether the in-memory block record matches the block on the disk,
+   * and, in case that they are not matched, update the record or mark it
+   * as corrupted.
+   */
+  public void checkAndUpdate(String bpid, long blockId, File diskFile,
+      File diskMetaFile, FSVolumeInterface vol);
+

INS26 INS26 INS26 INS40 INS40 INS40 INS55 INS31 INS31 INS31 INS31 INS31 INS29 INS42 INS31 INS31 INS31 INS31 INS29 INS83 INS74 INS42 INS29 INS83 INS74 INS42 INS29 INS83 INS5 INS42 INS29 INS83 INS74 INS42 INS44 INS29 INS83 INS39 INS42 INS44 INS44 INS44 INS44 INS44 INS65 INS65 INS29 INS83 INS5 INS42 INS29 INS83 INS39 INS42 INS43 INS29 INS83 INS43 INS42 INS44 INS43 INS29 INS83 INS43 INS42 INS44 INS43 INS65 INS43 INS43 INS65 INS43 INS43 INS43 INS65 INS43 INS85 INS65 INS43 INS43 INS43 INS42 INS65 INS43 INS42 INS39 INS42 INS43 INS42 INS43 INS42 INS43 INS42 INS66 INS40 INS65 INS43 INS85 INS65 INS42 INS65 INS42 INS43 INS42 INS42 INS65 INS42 INS43 INS42 INS42 INS66 INS42 INS42 INS66 INS42 INS42 INS42 INS66 INS42 INS66 INS42 INS42 INS42 INS66 INS66 INS66 INS42 INS42 INS42 INS42 INS66 INS42 INS66 INS66 INS42 INS66 INS42