YARN-4210. HBase reader throws NPE if Get returns no rows (Varun Saxena via vrushali)

+import org.apache.hadoop.hbase.client.ResultScanner;
-    Iterable<Result> results = getResults(hbaseConf, conn);
-    for (Result result : results) {
-      TimelineEntity entity = parseEntity(result);
-      if (entity == null) {
-        continue;
+    ResultScanner results = getResults(hbaseConf, conn);
+    try {
+      for (Result result : results) {
+        TimelineEntity entity = parseEntity(result);
+        if (entity == null) {
+          continue;
+        }
+        entities.add(entity);
+        if (entities.size() == limit) {
+          break;
+        }
-      entities.add(entity);
-      if (entities.size() == limit) {
-        break;
-      }
+      return entities;
+    } finally {
+      results.close();
-    return entities;
-  protected Iterable<Result> getResults(Configuration hbaseConf,
+  protected ResultScanner getResults(Configuration hbaseConf,

INS26 INS40 INS43 INS54 UPD42 MOV42 INS43 INS8 INS8 UPD42 MOV42 MOV70 MOV41 INS21 INS32 INS42 INS42 DEL42 DEL43 DEL43 DEL74 DEL42 DEL43 DEL43 DEL74