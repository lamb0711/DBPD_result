HDFS-2824. Fix failover when prior NN died just after creating an edit log segment. Contributed by Aaron T. Myers.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1238069 13f79535-47bb-0310-9956-ffa450edef68

-    return new EditLogValidation(lastPos, firstTxId, lastTxId);
+    return new EditLogValidation(lastPos, firstTxId, lastTxId, false);
-    private long validLength;
-    private long startTxId;
-    private long endTxId;
+    private final long validLength;
+    private final long startTxId;
+    private final long endTxId;
+    private final boolean corruptionDetected;
-    EditLogValidation(long validLength, 
-                      long startTxId, long endTxId) {
+    EditLogValidation(long validLength, long startTxId, long endTxId,
+        boolean corruptionDetected) {
+      this.corruptionDetected = corruptionDetected;
+    
+    boolean hasCorruptHeader() { return corruptionDetected; }

INS23 INS31 INS83 INS83 INS83 INS83 INS83 INS39 INS59 INS44 INS39 INS42 INS8 INS42 INS39 INS42 INS21 INS41 INS9 INS7 INS42 INS22 INS42 INS52 INS42