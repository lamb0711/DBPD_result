HADOOP-16068. ABFS Authentication and Delegation Token plugins to optionally be bound to specific URI of the store.

Contributed by Steve Loughran.

+import org.apache.hadoop.io.IOUtils;
+        delegationTokenManager.bind(getUri(), configuration);
+        LOG.debug("Created DelegationTokenManager {}", delegationTokenManager);
-
+    // does all the delete-on-exit calls, and may be slow.
+    IOUtils.cleanupWithLogger(LOG, abfsStore, delegationTokenManager);
+  /**
+   * If Delegation tokens are enabled, the canonical service name of
+   * this filesystem is the filesystem URI.
+   * @return either the filesystem URI as a string, or null.
+   */
+  @Override
+  public String getCanonicalServiceName() {
+    String name = null;
+    if (delegationTokenManager != null) {
+      name = delegationTokenManager.getCanonicalServiceName();
+    }
+    return name != null ? name : super.getCanonicalServiceName();
+  }
+
+  /**
+   * Get any Delegation Token manager created by the filesystem.
+   * @return the DT manager or null.
+   */
+  @VisibleForTesting
+  AbfsDelegationTokenManager getDelegationTokenManager() {
+    return delegationTokenManager;
+  }
+

INS26 INS40 INS31 INS31 INS29 INS78 INS83 INS43 INS42 INS8 INS29 INS78 INS43 INS42 INS8 INS21 INS65 INS65 INS42 INS42 INS60 INS25 INS41 INS65 INS65 INS42 INS42 INS41 INS32 INS66 INS66 INS66 INS43 INS59 INS27 INS8 INS16 INS66 INS66 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS33 INS42 INS33 INS21 INS27 INS42 INS48 INS7 INS42 INS33 INS42 INS21 INS21 INS42 INS32 INS32 INS32 INS42 INS42 INS42 INS42 INS32 INS42 INS42 INS42 INS45 INS42 INS42