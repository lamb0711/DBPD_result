HDFS-3144. Refactor DatanodeID#getName by use. Contributed by Eli Collins


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1308205 13f79535-47bb-0310-9956-ffa450edef68

-    DatanodeRegistration bpRegistration = new DatanodeRegistration(getXferAddr());
+    final String xferIp = streamingAddr.getAddress().getHostAddress();
+    DatanodeRegistration bpRegistration = new DatanodeRegistration(xferIp);
+    bpRegistration.setXferPort(getXferPort());
-          + " is assigned to data-node " + bpRegistration.getName());
+          + " is assigned to data-node " + bpRegistration);
-   * @return the IP:port to report to the NN for data transfer
-   */
-  private String getXferAddr() {
-    return streamingAddr.getAddress().getHostAddress() + ":" + getXferPort();
-  }
-
-  /**
-    final InetSocketAddress addr = NetUtils.createSocketAddr(
-        datanodeid.getHost() + ":" + datanodeid.getIpcPort());
+    final InetSocketAddress addr =
+      NetUtils.createSocketAddr(datanodeid.getIpcAddr());
-    dnId.setStorageID(createNewStorageId(dnId.getPort()));
+    dnId.setStorageID(createNewStorageId(dnId.getXferPort()));
-          xfersBuilder.append(xferTargets[i].getName());
+          xfersBuilder.append(xferTargets[i]);
-          NetUtils.createSocketAddr(targets[0].getName());
+          NetUtils.createSocketAddr(targets[0].getXferAddr());
-        LOG.warn(
-            bpReg + ":Failed to transfer " + b + " to " + targets[0].getName()
-                + " got ", ie);
+        LOG.warn(bpReg + ":Failed to transfer " + b + " to " +
+            targets[0] + " got ", ie);
-    StringBuilder msg = new StringBuilder(targets[0].getName());
+    StringBuilder msg = new StringBuilder(targets[0].toString());
-      msg.append(", " + targets[i].getName());
+      msg.append(", " + targets[i]);

INS60 INS21 INS83 MOV43 INS59 MOV43 INS32 MOV43 INS42 MOV32 INS42 INS42 MOV32 MOV43 INS42 INS32 MOV43 MOV32 MOV42 UPD42 MOV42 UPD42 UPD42 UPD42 INS42 INS27 INS42 INS45 MOV2 MOV32 MOV2 UPD42 MOV2 UPD42 INS42 DEL42 DEL32 DEL42 DEL42 DEL32 DEL66 DEL65 DEL29 DEL83 DEL42 DEL45 DEL27 DEL41 DEL8 DEL31 DEL42 DEL42 DEL32 DEL45 DEL32 DEL27 DEL42 DEL42 DEL32 DEL42 DEL32 DEL42 DEL42 DEL45 DEL27 DEL32