HDFS-9067. o.a.h.hdfs.server.datanode.fsdataset.impl.TestLazyWriter is failing in trunk (Contributed by Surendra Singh Lilhore)

-  private int period; // seconds
+  private long period; // milliseconds
-        source, injectedTags, period * 1000L, conf != null ? conf
+        source, injectedTags, period, conf != null ? conf
-    long millis = period * 1000L;
+    long millis = period;
-    LOG.info("Scheduled snapshot period at "+ period +" second(s).");
+    LOG.info("Scheduled snapshot period at "+ (period/1000) +" second(s).");
-    int confPeriod = 0;
+    long confPeriodMillis = 0;
-      confPeriod = confPeriod == 0 ? sinkPeriod
-                                   : ArithmeticUtils.gcd(confPeriod, sinkPeriod);
+      // Support configuring periodMillis for testing.
+      long sinkPeriodMillis =
+          conf.getLong(PERIOD_MILLIS_KEY, sinkPeriod * 1000);
+      confPeriodMillis = confPeriodMillis == 0 ? sinkPeriodMillis
+          : ArithmeticUtils.gcd(confPeriodMillis, sinkPeriodMillis);
-    period = confPeriod > 0 ? confPeriod
-                            : config.getInt(PERIOD_KEY, PERIOD_DEFAULT);
+    long periodSec = config.getInt(PERIOD_KEY, PERIOD_DEFAULT);
+    period = confPeriodMillis > 0 ? confPeriodMillis
+        : config.getLong(PERIOD_MILLIS_KEY, periodSec * 1000);
-        MetricsAnnotations.makeSource(this), injectedTags, period * 1000L,
+        MetricsAnnotations.makeSource(this), injectedTags, period,

UPD39 INS60 UPD39 INS39 INS59 INS42 UPD42 INS60 INS42 MOV32 INS42 INS36 INS39 INS59 UPD42 INS32 INS42 INS27 INS42 INS32 UPD42 UPD42 INS42 INS42 INS42 INS27 MOV42 INS34 INS42 INS42 INS42 INS27 UPD42 INS42 INS34 INS42 INS34 UPD42 UPD42 UPD42 DEL42 DEL34 DEL27 DEL42 DEL34 DEL27 DEL42 DEL34 DEL27