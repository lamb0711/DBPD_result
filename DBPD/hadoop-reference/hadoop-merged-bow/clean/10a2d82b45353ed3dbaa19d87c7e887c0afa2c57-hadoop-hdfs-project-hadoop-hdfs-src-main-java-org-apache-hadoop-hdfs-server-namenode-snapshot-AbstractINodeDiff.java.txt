HDFS-4719. Remove AbstractINodeDiff.Factory and move its methods to AbstractINodeDiffList.  Contributed by Arpit Agarwal


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1470759 13f79535-47bb-0310-9956-ffa450edef68

- * {@link AbstractINodeDiff2} maintains a list of snapshot diffs,
+ * {@link AbstractINodeDiffList} maintains a list of snapshot diffs,
-  /** A factory for creating diff and snapshot copy of an inode. */
-  static abstract class Factory<N extends INode,
-                                D extends AbstractINodeDiff<N, D>> {
-    /** @return an {@link AbstractINodeDiff}. */
-    abstract D createDiff(Snapshot snapshot, N currentINode);
-
-    /** @return a snapshot copy of the current inode. */
-    abstract N createSnapshotCopy(N currentINode);
-  }
-  void saveSnapshotCopy(N snapshotCopy, Factory<N, D> factory, N currentINode) {
-    if (snapshotINode == null) {
-      if (snapshotCopy == null) {
-        snapshotCopy = factory.createSnapshotCopy(currentINode);
-      }
-      snapshotINode = snapshotCopy;
-    }
+  void saveSnapshotCopy(N snapshotCopy, N currentINode) {
+    Preconditions.checkState(snapshotINode == null, "Expected snapshotINode to be null");
+    snapshotINode = snapshotCopy;

INS8 MOV21 MOV21 UPD42 INS32 UPD42 MOV42 UPD42 MOV42 MOV27 INS45 DEL66 DEL65 DEL29 DEL83 DEL83 DEL42 DEL42 DEL42 DEL43 DEL73 DEL42 DEL42 DEL43 DEL42 DEL43 DEL42 DEL43 DEL74 DEL73 DEL66 DEL42 DEL65 DEL66 DEL65 DEL29 DEL83 DEL42 DEL43 DEL42 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL44 DEL31 DEL66 DEL65 DEL29 DEL83 DEL42 DEL43 DEL42 DEL42 DEL43 DEL42 DEL44 DEL31 DEL55 DEL42 DEL43 DEL42 DEL43 DEL42 DEL43 DEL74 DEL42 DEL44 DEL42 DEL42 DEL32 DEL7 DEL42 DEL33 DEL27 DEL8 DEL25 DEL8 DEL25 DEL8