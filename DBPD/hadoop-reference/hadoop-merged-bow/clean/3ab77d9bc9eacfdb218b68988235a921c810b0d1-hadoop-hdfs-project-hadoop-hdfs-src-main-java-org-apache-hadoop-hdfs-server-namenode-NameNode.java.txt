HDFS-14201. Ability to disallow safemode NN to become active. Contributed by Xiao Liang and He Xiaoqiao.

+import static org.apache.hadoop.hdfs.DFSConfigKeys.DFS_HA_NN_NOT_BECOME_ACTIVE_IN_SAFEMODE;
+import static org.apache.hadoop.hdfs.DFSConfigKeys.DFS_HA_NN_NOT_BECOME_ACTIVE_IN_SAFEMODE_DEFAULT;
+  private final boolean notBecomeActiveInSafemode;
+    notBecomeActiveInSafemode = conf.getBoolean(
+        DFS_HA_NN_NOT_BECOME_ACTIVE_IN_SAFEMODE,
+        DFS_HA_NN_NOT_BECOME_ACTIVE_IN_SAFEMODE_DEFAULT);
+    if (notBecomeActiveInSafemode && isInSafeMode()) {
+      throw new HealthCheckFailedException("The NameNode is configured to " +
+          "report UNHEALTHY to ZKFC in Safemode.");
+    }
+    if (notBecomeActiveInSafemode && isInSafeMode()) {
+      throw new ServiceFailedException(getRole() + " still not leave safemode");
+    }

INS26 INS26 INS40 INS40 INS23 INS83 INS83 INS39 INS59 INS42 INS21 INS25 INS25 INS7 INS27 INS8 INS27 INS8 INS42 INS32 INS42 INS32 INS53 INS42 INS32 INS53 INS42 INS42 INS42 INS42 INS42 INS14 INS42 INS14 INS43 INS27 INS43 INS27 INS42 INS45 INS45 INS42 INS32 INS45 INS42