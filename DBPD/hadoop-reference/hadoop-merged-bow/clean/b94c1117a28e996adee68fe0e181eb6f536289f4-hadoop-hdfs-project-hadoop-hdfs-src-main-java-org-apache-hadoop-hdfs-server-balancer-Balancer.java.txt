HDFS-316. Balancer should run for a configurable # of iterations (Xiaoyu Yao via aw)

+ *               bin/ start-balancer.sh -idleiterations 20
+ *                     start the balancer with maximum 20 consecutive idle iterations
+ *               bin/ start-balancer.sh -idleiterations -1
+ *                     run the balancer with default threshold infinitely
- * <li>No block has been moved for five consecutive iterations;
+ * <li>No block has been moved for specified consecutive iterations (5 by default);
- * <li>No block has been moved for 5 iterations. Exiting...
+ * <li>No block has been moved for specified iterations (5 by default). Exiting...
-      + "\tIncludes only the specified datanodes.";
+      + "\tIncludes only the specified datanodes."
+      + "\n\t[-idleiterations <idleiterations>]"
+      + "\tNumber of consecutive idle iterations (-1 for Infinite) before exit.";
-            Balancer.class.getSimpleName(), BALANCER_ID_PATH, conf);
+            Balancer.class.getSimpleName(), BALANCER_ID_PATH, conf, p.maxIdleIteration);
+        NameNodeConnector.DEFAULT_MAX_IDLE_ITERATIONS,
+    final int maxIdleIteration;
-    Parameters(BalancingPolicy policy, double threshold,
+    Parameters(BalancingPolicy policy, double threshold, int maxIdleIteration,
+      this.maxIdleIteration = maxIdleIteration;
+          ", max idle iteration = " + maxIdleIteration +
+      int maxIdleIteration = Parameters.DEFAULT.maxIdleIteration;
+            } else if ("-idleiterations".equalsIgnoreCase(args[i])) {
+              checkArgument(++i < args.length,
+                  "idleiterations value is missing: args = " + Arrays.toString(args));
+              maxIdleIteration = Integer.parseInt(args[i]);
+              LOG.info("Using a idleiterations of " + maxIdleIteration);
-      return new Parameters(policy, threshold, nodesTobeExcluded, nodesTobeIncluded);
+      return new Parameters(policy, threshold, maxIdleIteration, nodesTobeExcluded, nodesTobeIncluded);

INS23 INS66 INS66 INS66 INS66 UPD66 UPD66 INS83 INS39 INS59 INS44 INS45 INS45 MOV32 INS42 INS39 INS42 INS21 INS60 INS40 INS7 INS39 INS59 INS22 INS42 INS45 INS42 INS42 INS40 INS42 INS52 INS42 INS40 INS25 INS32 INS8 MOV8 INS45 INS42 INS2 INS21 INS21 INS21 INS42 INS42 INS32 INS7 INS32 INS42 INS27 INS27 INS42 INS32 INS42 INS42 INS27 INS38 INS40 INS45 INS32 INS42 INS42 INS2 INS45 INS42 INS42 INS42 INS42 INS42 INS42 INS42