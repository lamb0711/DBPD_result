HDFS-3412. Fix findbugs warnings in auto-HA branch. Contributed by Todd Lipcon.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-3042@1338817 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.hadoop.util.Tool;
-public abstract class ZKFailoverController implements Tool {
+public abstract class ZKFailoverController {
-  private Configuration conf;
+  protected Configuration conf;
+  protected final HAServiceTarget localTarget;
-  private HAServiceTarget localTarget;
-
-  @Override
-  public void setConf(Configuration conf) {
+  protected ZKFailoverController(Configuration conf, HAServiceTarget localTarget) {
+    this.localTarget = localTarget;
-    localTarget = getLocalTarget();
-  protected abstract HAServiceTarget getLocalTarget();
-  @Override
-  public Configuration getConf() {
-    return conf;
+  public HAServiceTarget getLocalTarget() {
+    return localTarget;
-
-  @Override
+  
-  State getLastHealthState() {
+  synchronized State getLastHealthState() {
+
+  private synchronized void setLastHealthState(HealthMonitor.State newState) {
+    LOG.info("Local service " + localTarget +
+        " entered state: " + newState);
+    lastHealthState = newState;
+  }
-      return "Elector callbacks for " + localTarget;
+      synchronized (ZKFailoverController.this) {
+        return "Elector callbacks for " + localTarget;
+      }
-      LOG.info("Local service " + localTarget +
-          " entered state: " + newState);
-      lastHealthState = newState;
+      setLastHealthState(newState);

MOV23 MOV31 MOV31 INS55 UPD83 UPD83 INS83 UPD83 UPD42 INS44 MOV21 UPD83 INS8 INS83 UPD83 INS83 UPD42 MOV29 INS42 MOV43 INS31 INS43 INS42 INS41 INS8 MOV78 MOV83 INS39 INS42 INS44 MOV8 INS42 INS42 INS51 INS43 INS42 INS21 MOV21 INS22 INS42 INS52 MOV8 INS40 INS32 INS52 INS42 INS42 INS42 INS42 DEL40 DEL26 DEL42 DEL43 DEL42 DEL78 DEL39 DEL42 DEL42 DEL32 DEL83 DEL42 DEL78 DEL42 DEL43 DEL42 DEL31 DEL42 DEL78 DEL42 DEL41 DEL42 DEL55