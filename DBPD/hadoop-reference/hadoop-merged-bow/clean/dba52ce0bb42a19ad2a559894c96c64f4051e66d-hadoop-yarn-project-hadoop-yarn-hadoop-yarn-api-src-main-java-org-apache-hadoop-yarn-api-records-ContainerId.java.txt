Merge branch 'trunk' into HDFS-6584

-      int containerId) {
+      long containerId) {
-    id.setId(containerId);
+    id.setContainerId(containerId);
-   * Get the identifier of the <code>ContainerId</code>.
-   * @return identifier of the <code>ContainerId</code>
+   * Get the lower 32 bits of identifier of the <code>ContainerId</code>,
+   * which doesn't include epoch. Note that this method will be marked as
+   * deprecated, so please use <code>getContainerId</code> instead.
+   * @return lower 32 bits of identifier of the <code>ContainerId</code>
+  /**
+   * Get the identifier of the <code>ContainerId</code>. Upper 24 bits are
+   * reserved as epoch of cluster, and lower 40 bits are reserved as
+   * sequential number of containers.
+   * @return identifier of the <code>ContainerId</code>
+   */
+  @Public
+  @Unstable
+  public abstract long getContainerId();
+
-  protected abstract void setId(int id);
+  protected abstract void setContainerId(long id);
-  
+
-    // Generated by eclipse.
-    final int prime = 435569;
-    int result = 7507;
-    result = prime * result + getId();
-    result = prime * result + getApplicationAttemptId().hashCode();
+    // Generated by IntelliJ IDEA 13.1.
+    int result = (int) (getContainerId() ^ (getContainerId() >>> 32));
+    result = 31 * result + getApplicationAttemptId().hashCode();
-    if (this.getId() != other.getId())
+    if (this.getContainerId() != other.getContainerId())
-      return this.getId() - other.getId();
+      return Long.valueOf(getContainerId())
+          .compareTo(Long.valueOf(other.getContainerId()));
-    
-    sb.append(containerIdFormat.get().format(0x3fffff & getId()));
-    int epoch = getId() >> 22;
+    sb.append(containerIdFormat.get().format(0xffffffffffL & getContainerId()));
+    long epoch = getContainerId() >> 40;
-      int id = Integer.parseInt(it.next());
-      int epoch = 0;
+      long id = Long.parseLong(it.next());
+      long epoch = 0;
-      int cid = (epoch << 22) | id;
+      long cid = (epoch << 40) | id;

INS31 INS78 INS29 MOV78 INS78 INS83 INS83 INS39 INS42 UPD42 UPD39 INS65 INS42 INS65 MOV65 INS42 UPD39 INS60 UPD66 INS66 INS66 INS66 INS66 INS66 INS66 MOV39 INS59 UPD39 UPD42 UPD42 MOV42 INS11 INS39 INS36 UPD42 UPD42 INS32 UPD34 UPD39 UPD39 UPD39 INS27 INS34 INS32 INS42 INS32 UPD34 UPD42 INS32 INS36 INS42 INS42 INS32 INS42 INS42 INS32 UPD42 UPD42 UPD42 INS42 INS27 UPD42 MOV42 MOV42 UPD42 MOV42 MOV32 INS34 UPD34 UPD42 DEL83 DEL34 DEL59 DEL60 DEL39 DEL42 DEL34 DEL59 DEL60 DEL42 DEL42 DEL42 DEL27 DEL27 DEL7 DEL21 DEL42 DEL52 DEL32 DEL32 DEL27