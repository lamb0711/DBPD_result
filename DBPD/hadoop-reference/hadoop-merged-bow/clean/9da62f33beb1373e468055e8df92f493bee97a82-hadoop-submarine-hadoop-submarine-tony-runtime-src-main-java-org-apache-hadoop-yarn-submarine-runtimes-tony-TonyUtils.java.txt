Merge branch 'trunk' into HDDS-1535
-import org.apache.hadoop.yarn.api.records.ResourceInformation;
-import org.apache.hadoop.yarn.exceptions.ResourceNotFoundException;
+import org.apache.hadoop.yarn.submarine.common.resource.ResourceUtils;
-          parameters.getPsResource().getMemorySize());
+          ResourceUtils.getMemorySize(parameters.getPsResource()));
-          parameters.getWorkerResource().getMemorySize());
-      try {
-        tonyConf.setLong(
-            TonyConfigurationKeys.getResourceKey(Constants.WORKER_JOB_NAME,
-                Constants.GPUS),
-            parameters.getWorkerResource()
-                .getResourceValue(ResourceInformation.GPU_URI));
-      } catch (ResourceNotFoundException rnfe) {
-        LOG.error("GPU resources not enabled.");
-      }
+          ResourceUtils.getMemorySize(parameters.getWorkerResource()));
+      tonyConf.setLong(
+          TonyConfigurationKeys.getResourceKey(Constants.WORKER_JOB_NAME,
+              Constants.GPUS),
+          ResourceUtils.getResourceValue(parameters.getWorkerResource(),
+              ResourceUtils.GPU_URI));

MOV26 UPD40 MOV8 MOV21 MOV21 MOV32 MOV32 MOV32 INS42 INS42 INS42 UPD40 DEL40 DEL26 DEL42 DEL43 DEL42 DEL44 DEL42 DEL42 DEL45 DEL32 DEL21 DEL8 DEL12 DEL54 DEL8