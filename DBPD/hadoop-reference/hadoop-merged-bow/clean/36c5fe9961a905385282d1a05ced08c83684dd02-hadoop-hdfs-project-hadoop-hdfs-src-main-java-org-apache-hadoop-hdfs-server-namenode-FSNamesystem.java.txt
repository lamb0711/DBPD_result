HDFS-4346. Add SequentialNumber as a base class for INodeId and GenerationStamp.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1428167 13f79535-47bb-0310-9956-ffa450edef68

-   * Set the last allocated inode id when fsimage is loaded or editlog is
-   * applied. 
-   * @throws IOException
+   * Set the last allocated inode id when fsimage or editlog is loaded. 
-    inodeId.resetLastInodeId(newValue);
+    try {
+      inodeId.skipTo(newValue);
+    } catch(IllegalStateException ise) {
+      throw new IOException(ise);
+    }
-    inodeId.resetLastInodeIdWithoutChecking(newValue);
+    inodeId.setCurrentValue(newValue);
+  /** @return the last inode ID. */
-    return inodeId.getLastInodeId();
+    return inodeId.getCurrentValue();
+  /** Allocate a new inode ID. */
-    return inodeId.allocateNewInodeId();
+    return inodeId.nextValue();
-    generationStamp.setStamp(GenerationStamp.FIRST_VALID_STAMP);
+    generationStamp.setCurrentValue(GenerationStamp.LAST_RESERVED_STAMP);
-    inodeId.resetLastInodeIdWithoutChecking(INodeId.LAST_RESERVED_ID);
+    inodeId.setCurrentValue(INodeId.LAST_RESERVED_ID);
-    nextGenerationStamp();
-    b.setGenerationStamp(getGenerationStamp());
+    b.setGenerationStamp(nextGenerationStamp());
-    generationStamp.setStamp(stamp);
+    generationStamp.setCurrentValue(stamp);
-    return generationStamp.getStamp();
+    return generationStamp.getCurrentValue();
-    long gs = generationStamp.nextStamp();
+    final long gs = generationStamp.nextValue();

INS8 INS29 INS29 INS54 INS65 INS65 UPD66 INS8 INS12 INS66 INS66 INS32 INS83 MOV21 INS44 INS8 UPD42 UPD42 UPD42 UPD42 UPD40 UPD42 INS42 INS42 MOV32 UPD42 UPD42 INS43 INS42 INS53 UPD42 UPD42 INS42 INS14 INS43 INS42 INS42 DEL66 DEL42 DEL65 DEL8 DEL42 DEL42 DEL42 DEL32 DEL32 DEL21