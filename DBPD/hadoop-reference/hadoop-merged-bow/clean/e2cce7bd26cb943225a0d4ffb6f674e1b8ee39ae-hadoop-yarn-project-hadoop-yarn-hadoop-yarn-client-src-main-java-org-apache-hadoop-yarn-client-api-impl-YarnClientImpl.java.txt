YARN-727, MAPREDUCE-5325. ClientRMProtocol.getAllApplications should accept ApplicationType as a parameter. Contributed by Xuan Gong.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1501599 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.Set;
-import org.apache.hadoop.yarn.api.protocolrecords.GetAllApplicationsRequest;
-import org.apache.hadoop.yarn.api.protocolrecords.GetAllApplicationsResponse;
+import org.apache.hadoop.yarn.api.protocolrecords.GetApplicationsRequest;
+import org.apache.hadoop.yarn.api.protocolrecords.GetApplicationsResponse;
-  public List<ApplicationReport> getApplicationList()
-      throws YarnException, IOException {
-    GetAllApplicationsRequest request =
-        Records.newRecord(GetAllApplicationsRequest.class);
-    GetAllApplicationsResponse response = rmClient.getAllApplications(request);
+  public List<ApplicationReport> getApplications() throws YarnException,
+      IOException {
+    return getApplications(null);
+  }
+
+  @Override
+  public List<ApplicationReport> getApplications(
+      Set<String> applicationTypes) throws YarnException, IOException {
+    GetApplicationsRequest request =
+        applicationTypes == null ? GetApplicationsRequest.newInstance()
+            : GetApplicationsRequest.newInstance(applicationTypes);
+    GetApplicationsResponse response = rmClient.getApplications(request);

INS26 INS40 UPD40 UPD40 INS31 INS78 INS83 INS74 INS42 INS43 INS43 INS8 UPD42 INS44 INS42 INS43 INS43 INS42 INS42 INS41 INS74 INS42 INS42 INS42 INS32 INS43 INS43 UPD43 UPD43 INS42 INS33 INS42 INS42 UPD42 INS16 UPD42 INS27 INS32 INS32 UPD42 INS42 INS33 INS42 INS42 UPD42 MOV42 UPD42 MOV42 INS42 DEL42 DEL43 DEL57 DEL32