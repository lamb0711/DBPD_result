YARN-5623. Apply SLIDER-1166 to yarn-native-services branch. Contributed by Gour Saha

+import java.util.HashMap;
+import java.util.Map;
+  private static final Map<String, ZooKeeper> ZK_SESSIONS = new HashMap<>();
+
-  public void init() throws IOException {
-    assert zookeeper == null;
-    log.debug("Binding ZK client to {}", zkConnection);
-    zookeeper = new ZooKeeper(zkConnection, sessionTimeout, this, canBeReadOnly);
+  /**
+   * Returns true only if an active ZK session is available and retrieved from
+   * cache, false when it has to create a new one.
+   *
+   * @return true if from cache, false when new session created
+   * @throws IOException
+   */
+  public synchronized boolean init() throws IOException {
+    if (zookeeper != null && getAlive()) {
+      return true;
+    }
+
+    synchronized (ZK_SESSIONS) {
+      if (ZK_SESSIONS.containsKey(zkConnection)) {
+        zookeeper = ZK_SESSIONS.get(zkConnection);
+      }
+      if (zookeeper == null || !getAlive()) {
+        log.info("Binding ZK client to {}", zkConnection);
+        zookeeper = new ZooKeeper(zkConnection, sessionTimeout, this,
+            canBeReadOnly);
+        ZK_SESSIONS.put(zkConnection, zookeeper);
+        return false;
+      } else {
+        return true;
+      }
+    }

INS26 INS26 INS40 INS40 INS23 INS83 INS83 INS83 INS74 INS59 INS29 INS83 UPD39 INS8 INS43 INS43 INS43 INS42 INS14 INS65 INS65 INS65 INS25 INS51 INS42 INS42 INS42 INS74 INS66 INS66 INS66 INS42 INS27 INS8 INS42 INS8 INS43 INS27 INS32 INS41 INS25 INS25 INS42 INS42 INS33 INS42 INS9 INS32 INS8 INS27 INS8 INS8 INS42 INS42 INS42 INS21 MOV27 INS38 MOV21 MOV21 INS21 INS41 INS41 INS7 INS32 INS32 INS9 INS9 INS42 INS32 INS42 UPD42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 DEL6 DEL8