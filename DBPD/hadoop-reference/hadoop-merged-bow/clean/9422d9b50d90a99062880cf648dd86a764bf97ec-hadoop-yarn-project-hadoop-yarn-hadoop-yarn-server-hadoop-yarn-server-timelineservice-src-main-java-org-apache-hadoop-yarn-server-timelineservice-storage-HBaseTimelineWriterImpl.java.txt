YARN-3984. Adjusted the event column key schema and avoided missing empty event. Contributed by Vrushali C.

(cherry picked from commit 895ccfa1ab9e701f2908586e323249f670fe5544)

+import org.apache.hadoop.yarn.server.timelineservice.storage.common.TimelineWriterUtils;
+            byte[] columnQualifierFirst =
+                Bytes.toBytes(Separator.VALUES.encode(eventId));
+            byte[] columnQualifierWithTsBytes =
+                Separator.VALUES.join(columnQualifierFirst,
+                    Bytes.toBytes(TimelineWriterUtils.invert(eventTimestamp)));
-            if (eventInfo != null) {
+            if ((eventInfo == null) || (eventInfo.size() == 0)) {
+              // add separator since event key is empty
+              byte[] compoundColumnQualifierBytes =
+                  Separator.VALUES.join(columnQualifierWithTsBytes,
+                      null);
+              String compoundColumnQualifier =
+                  Bytes.toString(compoundColumnQualifierBytes);
+              EntityColumnPrefix.EVENT.store(rowKey, entityTable,
+                  compoundColumnQualifier, null, TimelineWriterUtils.EMPTY_BYTES);
+            } else {
-                byte[] columnQualifierFirst =
-                    Bytes.toBytes(Separator.VALUES.encode(eventId));
-                    Separator.VALUES.join(columnQualifierFirst,
+                    Separator.VALUES.join(columnQualifierWithTsBytes,
-                    compoundColumnQualifier, eventTimestamp, info.getValue());
+                    compoundColumnQualifier, null, info.getValue());

INS26 INS40 MOV60 INS60 INS5 INS59 INS27 INS8 INS39 INS85 INS42 INS32 INS36 INS36 INS60 INS60 INS21 INS40 INS42 INS42 INS32 INS27 INS27 INS5 INS59 INS43 INS59 INS32 INS42 INS42 INS32 MOV42 MOV33 INS32 INS34 INS39 INS85 INS42 INS32 INS42 INS42 INS32 INS40 INS42 INS42 INS42 INS42 INS33 INS40 INS42 INS42 INS42 INS42 INS42 INS40 INS42 INS42 INS33 INS42 INS42 INS42 INS33 UPD42 DEL27 DEL42