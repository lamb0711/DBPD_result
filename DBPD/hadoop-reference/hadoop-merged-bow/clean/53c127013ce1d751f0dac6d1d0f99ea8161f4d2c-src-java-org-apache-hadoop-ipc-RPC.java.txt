HADOOP-6132. RPC client create an extra connection because of incorrect
key for connection cache. (Kan Zhang via rangadi)

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@797248 13f79535-47bb-0310-9956-ffa450edef68

+    private Class<? extends VersionedProtocol> protocol;
-    public Invoker(InetSocketAddress address, UserGroupInformation ticket, 
-                   Configuration conf, SocketFactory factory) {
+    public Invoker(Class<? extends VersionedProtocol> protocol,
+        InetSocketAddress address, UserGroupInformation ticket,
+        Configuration conf, SocketFactory factory) {
+      this.protocol = protocol;
-                    method.getDeclaringClass(), ticket);
+                    protocol, ticket);
-  public static VersionedProtocol waitForProxy(Class protocol,
+  public static VersionedProtocol waitForProxy(
+      Class<? extends VersionedProtocol> protocol,
-  static VersionedProtocol waitForProxy(Class protocol,
+  static VersionedProtocol waitForProxy(
+                      Class<? extends VersionedProtocol> protocol,
-  public static VersionedProtocol getProxy(Class<?> protocol,
+  public static VersionedProtocol getProxy(
+      Class<? extends VersionedProtocol> protocol,
-  public static VersionedProtocol getProxy(Class<?> protocol,
+  public static VersionedProtocol getProxy(
+      Class<? extends VersionedProtocol> protocol,
-            new Invoker(addr, ticket, conf, factory));
+            new Invoker(protocol, addr, ticket, conf, factory));
-  public static VersionedProtocol getProxy(Class<?> protocol,
+  public static VersionedProtocol getProxy(
+      Class<? extends VersionedProtocol> protocol,

INS23 INS83 INS74 INS59 INS44 INS74 INS74 UPD74 UPD74 UPD74 INS43 INS76 INS42 INS74 INS42 INS21 MOV43 INS76 MOV43 INS76 UPD76 UPD76 UPD76 INS42 INS43 INS43 INS76 INS7 INS43 INS43 INS43 INS43 INS43 INS42 INS42 INS43 INS22 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS52 INS42 UPD42 MOV42 INS42 DEL42 DEL32