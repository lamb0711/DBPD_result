YARN-5952. Create REST API for changing YARN scheduler configurations. (Jonathan Hung via wangda)

-    this.schedConf = initialSchedConf;
-    confStore.initialize(config, initialSchedConf);
+    this.schedConf = new Configuration(false);
+    // We need to explicitly set the key-values in schedConf, otherwise
+    // these configuration keys cannot be deleted when
+    // configuration is reloaded.
+    for (Map.Entry<String, String> kv : initialSchedConf) {
+      schedConf.set(kv.getKey(), kv.getValue());
+    }
+    confStore.initialize(config, schedConf);
-    Configuration loadedConf = new Configuration(configuration);
-    loadedConf.addResource(schedConf);
+    Configuration loadedConf = new Configuration(schedConf);
+    loadedConf.addResource(configuration);
-      Map<String, String> confUpdate) {
+      Map<String, String> confUpdate) throws IOException {
-      schedConf.set(kv.getKey(), kv.getValue());
+      if (kv.getValue() == null) {
+        schedConf.unset(kv.getKey());
+      } else {
+        schedConf.set(kv.getKey(), kv.getValue());
+      }
-      return;
+      throw e;

INS43 INS70 INS42 INS44 INS42 INS8 MOV43 INS8 INS14 INS74 INS42 INS21 UPD42 UPD42 INS25 INS43 INS9 INS43 INS43 INS43 INS32 MOV43 UPD42 INS27 INS8 MOV8 INS53 INS42 INS40 INS42 INS42 INS42 INS42 INS32 INS32 INS32 INS33 INS21 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS32 INS42 INS42 INS32 INS42 INS42 DEL42 DEL41