merge trunk to branch HDFS-4949

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-4949@1532952 13f79535-47bb-0310-9956-ffa450edef68

+  /**
+   * Return the underlying protocol that is used to talk to the namenode.
+   */
+  @Override
+  protected String getUnderlyingProtocol() {
+    return "https";
+  }
+
-    return getDefaultSecurePort();
+    return getConf().getInt(DFSConfigKeys.DFS_NAMENODE_HTTPS_PORT_KEY,
+                            DFSConfigKeys.DFS_NAMENODE_HTTPS_PORT_DEFAULT);
-  protected InetSocketAddress getNamenodeSecureAddr(URI uri) {
-    return getNamenodeAddr(uri);
-  }
-
-  @Override
-  protected URI getNamenodeUri(URI uri) {
-    return getNamenodeSecureUri(uri);
-  }
-  
-  @Override
-    final URL url = new URL("https", nnUri.getHost(), 
+    final URL url = new URL(getUnderlyingProtocol(), nnUri.getHost(),

MOV31 INS29 MOV78 UPD43 UPD42 MOV78 INS39 UPD42 INS65 UPD42 INS66 INS45 INS32 UPD42 INS40 INS40 UPD42 MOV42 INS32 INS42 DEL42 DEL43 DEL42 DEL44 DEL42 DEL42 DEL32 DEL83 DEL39 DEL42 DEL42 DEL32 DEL41 DEL8 DEL31 DEL42 DEL78 DEL42 DEL43 DEL42 DEL43 DEL42 DEL44 DEL45