Merge trunk into HA branch


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1196458 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.hadoop.hdfs.server.namenode.FSNamesystem;
+import org.apache.hadoop.hdfs.server.namenode.Namesystem;
-  private final FSNamesystem fsnamesystem;
+  private final Namesystem namesystem;
+  private final BlockManager blockmanager;
-  DecommissionManager(final FSNamesystem namesystem) {
-    this.fsnamesystem = namesystem;
+  DecommissionManager(final Namesystem namesystem,
+      final BlockManager blockmanager) {
+    this.namesystem = namesystem;
+    this.blockmanager = blockmanager;
-      for(; fsnamesystem.isRunning(); ) {
-        fsnamesystem.writeLock();
+      for(; namesystem.isRunning(); ) {
+        namesystem.writeLock();
-          fsnamesystem.writeUnlock();
+          namesystem.writeUnlock();
-      final DatanodeManager dm = fsnamesystem.getBlockManager().getDatanodeManager();
+      final DatanodeManager dm = blockmanager.getDatanodeManager();

UPD40 INS23 UPD43 INS83 INS83 INS43 INS59 INS44 UPD42 UPD42 INS42 INS42 UPD43 INS83 INS43 INS42 INS21 UPD42 INS42 INS7 INS22 INS42 UPD42 INS52 INS42 UPD42 UPD42 MOV42 UPD42 UPD42 DEL42 DEL32