YARN-3215. Respect labels in CapacityScheduler when computing headroom. (Naganarasimha G R via wangda)

-          Resources.multiplyAndNormalizeDown(resourceCalculator,
-              labelManager.getResourceByLabel(nodePartition, clusterResource),
-              queueCapacities.getAbsoluteMaximumCapacity(nodePartition), minimumAllocation);
+          getQueueMaxResource(nodePartition, clusterResource);
+
-  
+
+  Resource getQueueMaxResource(String nodePartition, Resource clusterResource) {
+    return Resources.multiplyAndNormalizeDown(resourceCalculator,
+        labelManager.getResourceByLabel(nodePartition, clusterResource),
+        queueCapacities.getAbsoluteMaximumCapacity(nodePartition),
+        minimumAllocation);
+  }
+

INS31 MOV43 INS42 INS44 INS44 MOV8 INS43 INS42 INS43 INS42 INS41 INS8 INS42 INS42 MOV32 INS60 MOV41 INS43 INS59 INS42 INS42 INS32 INS42 INS42 INS42 DEL42 DEL59 DEL60