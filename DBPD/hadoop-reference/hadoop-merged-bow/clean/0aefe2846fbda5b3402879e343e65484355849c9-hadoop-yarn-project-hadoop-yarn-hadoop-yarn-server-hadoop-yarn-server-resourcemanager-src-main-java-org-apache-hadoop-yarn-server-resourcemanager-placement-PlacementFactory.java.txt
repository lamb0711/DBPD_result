YARN-9298. Implement FS placement rules using PlacementRule interface. Contributed by Wilfred Spiegelenburg.

+import org.apache.hadoop.classification.InterfaceAudience;
+import org.apache.hadoop.classification.InterfaceStability;
+@InterfaceAudience.Private
+@InterfaceStability.Unstable
+  /**
+   * Create a new {@link PlacementRule} based on the rule class from the
+   * configuration. This is used to instantiate rules by the scheduler which
+   * does not resolve the class before this call.
+   * @param ruleStr The name of the class to instantiate
+   * @param conf The configuration object to set for the rule
+   * @return Created class instance
+   */
+
+  /**
+   * Create a new {@link PlacementRule} based on the rule class from the
+   * configuration. This is used to instantiate rules by the scheduler which
+   * resolve the class before this call.
+   * @param ruleClass The specific class reference to instantiate
+   * @param initArg The config to set
+   * @return Created class instance
+   */
+  public static PlacementRule getPlacementRule(
+      Class<? extends PlacementRule> ruleClass, Object initArg) {
+    LOG.info("Creating PlacementRule implementation: " + ruleClass);
+    PlacementRule rule = ReflectionUtils.newInstance(ruleClass, null);
+    rule.setConfig(initArg);
+    return rule;
+  }

INS26 INS26 INS40 INS40 INS78 INS78 INS31 INS40 INS40 INS29 INS29 INS83 INS83 INS43 INS42 INS44 INS44 INS8 INS65 INS65 INS65 INS65 INS65 INS65 INS65 INS65 INS42 INS74 INS42 INS43 INS42 INS21 INS60 INS21 INS41 INS66 INS65 INS66 INS66 INS66 INS42 INS66 INS42 INS66 INS66 INS66 INS65 INS66 INS66 INS66 INS42 INS66 INS42 INS66 INS66 INS43 INS76 INS42 INS32 INS43 INS59 INS32 INS42 INS42 INS42 INS42 INS43 INS42 INS42 INS27 INS42 INS42 INS32 INS42 INS42 INS42 INS42 INS45 INS42 INS42 INS42 INS42 INS33