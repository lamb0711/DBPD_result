MAPREDUCE-3780. Fixed a bug where applications killed before getting activated were not getting cleaned up properly. Contributed by Hitesh Shah. 


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1239443 13f79535-47bb-0310-9956-ffa450edef68

-        LOG.info("Application " + application.getApplicationId().getId() + 
+        LOG.info("Application " + application.getApplicationId() +
-    activeApplications.remove(application);
+    boolean wasActive = activeApplications.remove(application);
+    if (!wasActive) {
+      pendingApplications.remove(application);
+    }
-    user.finishApplication();
+    user.finishApplication(wasActive);
-    public synchronized void finishApplication() {
-      --activeApplications;
+    public synchronized void finishApplication(boolean wasActive) {
+      if (wasActive) {
+        --activeApplications;
+      }
+      else {
+        --pendingApplications;
+      }

INS60 INS25 INS44 INS8 INS39 INS59 INS38 INS8 INS39 INS42 INS25 INS42 MOV32 INS42 MOV21 INS42 INS42 MOV8 INS8 INS32 INS21 INS42 INS42 INS42 INS38 INS42 MOV32 DEL42 DEL32