HDFS-9289. Make DataStreamer#block thread safe and verify genStamp in commitBlock. Contributed by Chang Li.

Change-Id: If5ce1b2d212bb0726bce52ad12a3de401bcec02d

+    if(block.getGenerationStamp() != commitBlock.getGenerationStamp()) {
+      throw new IOException("Commit block with mismatching GS. NN has " +
+          block + ", client submits " + commitBlock);
+    }

INS25 INS27 INS8 INS32 INS32 INS53 INS42 INS42 INS42 INS42 INS14 INS43 INS27 INS42 INS45 INS42 INS45 INS42