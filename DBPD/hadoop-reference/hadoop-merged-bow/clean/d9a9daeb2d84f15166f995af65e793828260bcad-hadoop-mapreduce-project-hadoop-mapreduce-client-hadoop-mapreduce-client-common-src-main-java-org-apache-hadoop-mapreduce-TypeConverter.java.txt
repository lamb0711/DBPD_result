Merge r1399946 through r1400349 from trunk.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1400351 13f79535-47bb-0310-9956-ffa450edef68

-  public static TaskAttemptState toYarn(org.apache.hadoop.mapred.TaskStatus.State state) {
-    if (state == org.apache.hadoop.mapred.TaskStatus.State.KILLED_UNCLEAN) {
-      return TaskAttemptState.KILLED;
-    }
-    if (state == org.apache.hadoop.mapred.TaskStatus.State.FAILED_UNCLEAN) {
+  public static TaskAttemptState toYarn(
+      org.apache.hadoop.mapred.TaskStatus.State state) {
+    switch (state) {
+    case COMMIT_PENDING:
+      return TaskAttemptState.COMMIT_PENDING;
+    case FAILED:
+    case FAILED_UNCLEAN:
+    case KILLED:
+    case KILLED_UNCLEAN:
+      return TaskAttemptState.KILLED;
+    case RUNNING:
+      return TaskAttemptState.RUNNING;
+    case SUCCEEDED:
+      return TaskAttemptState.SUCCEEDED;
+    case UNASSIGNED:
+      return TaskAttemptState.STARTING;
+    default:
+      throw new YarnException("Unrecognized State: " + state);
-    return TaskAttemptState.valueOf(state.toString());
-    case KILL_WAIT:
-    case KILL_WAIT:

INS50 INS42 INS49 INS41 INS49 INS49 MOV41 INS49 INS49 MOV41 INS49 INS41 INS49 INS41 INS49 INS41 INS49 INS53 INS42 INS40 INS42 INS42 INS42 INS42 INS42 INS40 INS42 INS40 INS42 INS40 INS14 INS43 INS27 INS42 INS45 INS42 DEL42 DEL40 DEL27 DEL8 DEL25 DEL42 DEL40 DEL27 DEL8 DEL25 DEL42 DEL42 DEL42 DEL42 DEL32 DEL32 DEL41 DEL42 DEL49 DEL42 DEL49