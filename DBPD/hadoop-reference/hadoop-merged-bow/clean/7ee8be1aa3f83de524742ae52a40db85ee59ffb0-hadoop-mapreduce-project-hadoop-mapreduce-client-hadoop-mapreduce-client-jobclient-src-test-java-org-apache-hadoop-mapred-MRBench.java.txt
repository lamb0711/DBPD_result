MAPREDUCE-6819. Replace UTF8 with Text in MRBench. Contributed by Peter Bacsko.

-import org.apache.hadoop.io.UTF8;
-    implements Mapper<WritableComparable, Text, UTF8, UTF8> {
+      implements Mapper<WritableComparable<?>, Text, Text, Text> {
-    public void map(WritableComparable key, Text value,
-                    OutputCollector<UTF8, UTF8> output,
+    public void map(WritableComparable<?> key, Text value,
+                    OutputCollector<Text, Text> output,
-      output.collect(new UTF8(process(line)), new UTF8(""));		
+      output.collect(new Text(process(line)), new Text(""));
-    implements Reducer<UTF8, UTF8, UTF8, UTF8> {
+      implements Reducer<Text, Text, Text, Text> {
-    public void reduce(UTF8 key, Iterator<UTF8> values,
-                       OutputCollector<UTF8, UTF8> output, Reporter reporter) throws IOException 
+    public void reduce(Text key, Iterator<Text> values,
+                       OutputCollector<Text, Text> output,
+                       Reporter reporter) throws IOException
-        output.collect(key, new UTF8(values.next().toString()));
+        output.collect(key, new Text(values.next().toString()));
-    jobConf.setOutputValueClass(UTF8.class);
+    jobConf.setOutputValueClass(Text.class);
-    jobConf.setMapOutputKeyClass(UTF8.class);
-    jobConf.setMapOutputValueClass(UTF8.class);
+    jobConf.setMapOutputKeyClass(Text.class);
+    jobConf.setMapOutputValueClass(Text.class);

UPD74 UPD74 INS74 UPD43 UPD43 UPD43 UPD43 UPD43 UPD43 MOV43 INS76 UPD42 UPD42 INS74 UPD74 UPD42 UPD42 UPD42 UPD42 UPD43 UPD74 UPD74 MOV43 INS76 UPD43 UPD43 UPD42 UPD43 UPD43 UPD43 UPD42 UPD42 UPD42 UPD42 UPD42 UPD43 UPD43 UPD43 UPD43 UPD43 UPD42 UPD42 UPD42 UPD42 UPD42 UPD43 UPD42 DEL40 DEL26