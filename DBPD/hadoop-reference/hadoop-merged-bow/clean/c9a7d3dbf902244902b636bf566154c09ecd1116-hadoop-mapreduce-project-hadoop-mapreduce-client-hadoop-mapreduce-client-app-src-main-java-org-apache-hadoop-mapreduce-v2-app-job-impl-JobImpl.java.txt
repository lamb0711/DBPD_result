MAPREDUCE-3090. Fix MR AM to use ApplicationAttemptId rather than (ApplicationId, startCount) consistently. 


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1175718 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.hadoop.mapred.MapReduceChildJVM;
+import org.apache.hadoop.yarn.api.records.ApplicationAttemptId;
+  private final ApplicationAttemptId applicationAttemptId;
-  private final int startCount;
-  public JobImpl(ApplicationId appID, Configuration conf,
+  public JobImpl(ApplicationAttemptId applicationAttemptId, Configuration conf,
-      Credentials fsTokenCredentials, Clock clock, int startCount, 
+      Credentials fsTokenCredentials, Clock clock, 
-
+    this.applicationAttemptId = applicationAttemptId;
-    this.startCount = startCount;
-    jobId.setAppId(appID);
-    jobId.setId(appID.getId());
+    ApplicationId applicationId = applicationAttemptId.getApplicationId();
+    jobId.setAppId(applicationId);
+    jobId.setId(applicationId.getId());
-    		" appId=" + appID + 
+    		" appId=" + applicationId + 
-                job.clock, job.completedTasksFromPreviousRun, job.startCount,
+                job.clock, job.completedTasksFromPreviousRun, 
+                job.applicationAttemptId.getAttemptId(),
-                job.completedTasksFromPreviousRun, job.startCount, job.metrics);
+                job.completedTasksFromPreviousRun, 
+                job.applicationAttemptId.getAttemptId(),
+                job.metrics);

MOV26 MOV23 UPD40 INS43 MOV21 INS42 UPD42 INS43 UPD42 INS60 INS42 MOV43 INS59 UPD42 INS42 INS32 UPD42 UPD42 INS42 INS42 UPD42 UPD42 INS32 INS32 INS40 INS42 INS40 INS42 DEL39 DEL39 DEL42 DEL44 DEL40 DEL40