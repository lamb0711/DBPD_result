HDFS-7824. GetContentSummary API and its namenode implementation for Storage Type Quota/Usage. (Contributed by Xiaoyu Yao)

-  public final ContentSummary computeContentSummary() {
+  public final ContentSummary computeContentSummary(BlockStoragePolicySuite bsps) {
-        new ContentSummaryComputationContext());
+        new ContentSummaryComputationContext(bsps));
-    Content.Counts counts = computeContentSummary(summary).getCounts();
+    ContentCounts counts = computeContentSummary(summary).getCounts();
-    return new ContentSummary(counts.get(Content.LENGTH),
-        counts.get(Content.FILE) + counts.get(Content.SYMLINK),
-        counts.get(Content.DIRECTORY), q.getNameSpace(),
-        counts.get(Content.DISKSPACE), q.getStorageSpace());
-    // TODO: storage type quota reporting HDFS-7701.
+    return new ContentSummary.Builder().
+        length(counts.getLength()).
+        fileCount(counts.getFileCount() + counts.getSymlinkCount()).
+        directoryCount(counts.getDirectoryCount()).
+        quota(q.getNameSpace()).
+        spaceConsumed(counts.getStoragespace()).
+        spaceQuota(q.getStorageSpace()).
+        typeConsumed(counts.getTypeSpaces()).
+        typeQuota(q.getTypeSpaces().asArray()).
+        build();
-   * Count subtree content summary with a {@link Content.Counts}.
+   * Count subtree content summary with a {@link ContentCounts}.

INS44 INS43 INS42 INS42 UPD43 INS32 INS42 INS32 INS42 INS42 INS42 INS32 INS42 INS32 INS32 INS42 INS32 INS32 INS42 INS32 INS42 MOV32 MOV42 UPD42 MOV42 INS42 INS42 INS32 INS42 INS32 INS32 INS42 MOV32 INS42 INS42 INS32 INS42 INS32 INS32 INS42 INS27 MOV42 UPD42 MOV42 INS14 INS42 INS32 MOV32 MOV32 UPD43 MOV43 MOV42 UPD42 MOV42 UPD42 UPD42 INS40 DEL40 DEL42 DEL40 DEL40 DEL40 DEL32 DEL27 DEL40 DEL32 DEL40 DEL32 DEL14 DEL40