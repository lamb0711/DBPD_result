HDFS-10186. DirectoryScanner: Improve logs by adding full path of both actual and expected block directories.  Contributed by Rakesh R

-        verifyFileLocation(blockFile.getParentFile(), bpFinalizedDir,
-            blockId);
+        verifyFileLocation(blockFile, bpFinalizedDir, blockId);
-    private void verifyFileLocation(File actualBlockDir,
+    private void verifyFileLocation(File actualBlockFile,
-      if (actualBlockDir.compareTo(blockDir) != 0) {
+      if (actualBlockFile.getParentFile().compareTo(blockDir) != 0) {
+        File expBlockFile = new File(blockDir, actualBlockFile.getName());
-            + " has to be upgraded to block ID-based layout");
+            + " has to be upgraded to block ID-based layout. "
+            + "Actual block file path: " + actualBlockFile
+            + ", expected block file path: " + expBlockFile);

UPD42 INS60 INS32 INS43 INS59 MOV42 UPD42 MOV42 INS42 INS42 INS42 INS14 INS43 INS42 INS32 UPD45 INS45 INS42 INS45 INS42 INS42 INS42 INS42 DEL42 DEL32