YARN-8468. Enable the use of queue based maximum container allocation limit and implement it in FairScheduler. Contributed by Antal BÃ¡lint Steinbach.

+import org.apache.hadoop.yarn.api.records.Resource;
+        Resource maxAllocation = scheduler.getMaximumResourceCapability(queue);
-          SchedulerUtils.normalizeAndValidateRequest(amReq,
-              scheduler.getMaximumResourceCapability(queue),
-              queue, scheduler, isRecovery, rmContext);
+          SchedulerUtils.normalizeAndValidateRequest(amReq, maxAllocation,
+              queue, scheduler, isRecovery, rmContext, null);
-          amReq.setCapability(
-              scheduler.getNormalizedResource(amReq.getCapability()));
+          amReq.setCapability(scheduler.getNormalizedResource(
+              amReq.getCapability(), maxAllocation));

INS26 INS40 INS60 INS43 INS59 INS42 INS42 MOV32 INS42 INS33 INS42