MAPREDUCE-5300. Fix backward incompatibility for o.a.h.mapreduce.filecache.DistributedCache. Contributed by Zhijie Shen.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1489227 13f79535-47bb-0310-9956-ffa450edef68

+   * Parse a list of strings into longs.
+   * @param strs the list of strings to parse
+   * @return a list of longs that were parsed. same length as strs.
+   */
+  private static long[] parseTimestamps(String[] strs) {
+    if (strs == null) {
+      return null;
+    }
+    long[] result = new long[strs.length];
+    for(int i=0; i < strs.length; ++i) {
+      result[i] = Long.parseLong(strs[i]);
+    }
+    return result;
+  }
+
+  /**
-   * @return a string array of timestamps 
+   * @return a long array of timestamps
-  public static String[] getArchiveTimestamps(Configuration conf) {
-    return conf.getStrings(MRJobConfig.CACHE_ARCHIVES_TIMESTAMPS);
+  public static long[] getArchiveTimestamps(Configuration conf) {
+    return parseTimestamps(
+        conf.getStrings(MRJobConfig.CACHE_ARCHIVES_TIMESTAMPS));
-   * @return a string array of timestamps 
+   * @return a long array of timestamps
-  public static String[] getFileTimestamps(Configuration conf) {
-    return conf.getStrings(MRJobConfig.CACHE_FILE_TIMESTAMPS);
+  public static long[] getFileTimestamps(Configuration conf) {
+    return parseTimestamps(
+        conf.getStrings(MRJobConfig.CACHE_FILE_TIMESTAMPS));

INS31 INS29 INS83 INS83 INS5 INS42 INS44 INS8 INS5 UPD5 INS65 INS65 INS65 INS39 INS85 MOV5 INS42 INS25 INS60 INS24 INS41 INS39 INS85 INS39 INS66 INS42 INS66 INS66 INS27 INS8 INS5 INS59 INS58 INS27 INS38 INS8 INS42 UPD66 INS32 UPD66 INS32 INS42 INS33 INS41 INS39 INS85 INS42 INS3 INS39 INS59 INS42 INS40 INS42 INS21 INS42 MOV32 INS42 MOV32 INS33 INS5 INS40 INS42 INS34 INS7 INS39 INS85 INS2 INS32 INS42 INS42 INS42 INS42 INS2 INS42 INS42 DEL42 DEL43