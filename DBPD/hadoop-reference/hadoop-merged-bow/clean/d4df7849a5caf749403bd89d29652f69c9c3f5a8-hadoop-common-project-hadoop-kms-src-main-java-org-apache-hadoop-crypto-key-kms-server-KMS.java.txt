HADOOP-12962. KMS key names are incorrectly encoded when creating key. Contributed by Xiao Chen.

+import javax.ws.rs.core.UriBuilder;
-import java.net.URISyntaxException;
-  private static URI getKeyURI(String name) throws URISyntaxException {
-    return new URI(KMSRESTConstants.SERVICE_VERSION + "/" +
-        KMSRESTConstants.KEY_RESOURCE + "/" + name);
+  private static URI getKeyURI(String domain, String keyName) {
+    return UriBuilder.fromPath("{a}/{b}/{c}")
+        .build(domain, KMSRESTConstants.KEY_RESOURCE, keyName);
-    String keyURL = requestURL + KMSRESTConstants.KEY_RESOURCE + "/" + name;
-    return Response.created(getKeyURI(name)).type(MediaType.APPLICATION_JSON).
-        header("Location", keyURL).entity(json).build();
+    return Response.created(getKeyURI(KMSRESTConstants.SERVICE_VERSION, name))
+        .type(MediaType.APPLICATION_JSON)
+        .header("Location", getKeyURI(requestURL, name)).entity(json).build();

MOV26 UPD40 INS44 UPD42 MOV43 INS42 INS32 INS32 INS42 INS42 INS40 INS42 INS42 INS42 INS45 INS32 INS42 UPD42 MOV42 INS42 INS40 DEL42 DEL43 DEL42 DEL43 DEL40 DEL45 DEL40 DEL45 DEL42 DEL27 DEL14 DEL42 DEL42 DEL40 DEL45 DEL42 DEL27 DEL59 DEL60