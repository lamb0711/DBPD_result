HDFS-9543. DiskBalancer: Add Data mover. Contributed by Anu Engineer.

-  private float idealUsed;
+  private double idealUsed;
-      this.idealUsed = totalUsed / (float) totalCapacity;
+      this.idealUsed = truncateDecimals(totalUsed /
+          (double) totalCapacity);
-        float dfsUsedRatio =
-            volume.getUsed() / (float) volume.computeEffectiveCapacity();
+        double dfsUsedRatio =
+            truncateDecimals(volume.getUsed() /
+                (double) volume.computeEffectiveCapacity());
+
+  /**
+   * Truncate to 4 digits since uncontrolled precision is some times
+   * counter intitive to what users expect.
+   * @param value - double.
+   * @return double.
+   */
+  private double truncateDecimals(double value) {
+    final int multiplier = 10000;
+    return (double) ((long) (value * multiplier)) / multiplier;
+  }
-    float threshold = thresholdPercentage / 100.0f;
+    double threshold = thresholdPercentage / 100.0d;
-      if ((Math.abs(vol.getVolumeDataDensity()) > threshold) && notSkip) {
+      Double absDensity =
+          truncateDecimals(Math.abs(vol.getVolumeDataDensity()));
+
+      if ((absDensity > threshold) && notSkip) {
-  public float getIdealUsed() {
+  public double getIdealUsed() {
-      return Float
-          .compare(second.getVolumeDataDensity(), first.getVolumeDataDensity());
+      return Double.compare(second.getVolumeDataDensity(),
+          first.getVolumeDataDensity());

INS31 UPD39 INS29 INS83 INS39 INS42 INS44 INS8 UPD39 INS65 INS65 INS65 INS39 INS42 INS60 INS41 INS66 INS66 INS42 INS66 INS66 INS83 INS39 INS59 INS27 UPD39 INS42 INS34 INS11 INS42 INS60 INS39 INS36 UPD34 INS43 INS59 UPD42 INS32 INS11 INS42 INS42 INS32 INS42 INS27 UPD39 INS39 INS36 INS42 MOV32 MOV42 MOV11 INS32 INS27 INS42 UPD39 INS42 MOV27 INS42 INS42 UPD39 DEL27