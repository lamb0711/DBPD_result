MAPREDUCE-3685. Fix bugs in MergeManager to ensure compression codec is appropriately used and that on-disk segments are correctly sorted on file-size. Contributed by Anty Rao and Ravi Prakash.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1453365 13f79535-47bb-0310-9956-ffa450edef68

+  private long compressedSize;
+    this.compressedSize = compressedLength;
-        getSize());
+        getSize(), this.compressedSize);

INS23 INS83 INS39 INS59 INS42 INS21 INS7 INS22 INS42 INS52 INS42 INS22 INS52 INS42