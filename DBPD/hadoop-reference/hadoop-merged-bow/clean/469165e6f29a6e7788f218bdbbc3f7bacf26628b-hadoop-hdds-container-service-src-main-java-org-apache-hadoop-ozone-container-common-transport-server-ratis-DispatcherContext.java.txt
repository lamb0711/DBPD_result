HDDS-1843. Undetectable corruption after restart of a datanode. Contributed by Shashikant Banerjee(#1364).

-import java.util.Set;
+import java.util.Map;
-  private final Set<Long> createContainerSet;
+  private final Map<Long, Long> container2BCSIDMap;
-      boolean readFromTmpFile, Set<Long> containerSet) {
+      boolean readFromTmpFile, Map<Long, Long> container2BCSIDMap) {
-    this.createContainerSet = containerSet;
+    this.container2BCSIDMap = container2BCSIDMap;
-  public Set<Long> getCreateContainerSet() {
-    return createContainerSet;
+  public Map<Long, Long> getContainer2BCSIDMap() {
+    return container2BCSIDMap;
-    private Set<Long> createContainerSet;
+    private Map<Long, Long> container2BCSIDMap;
-     * Sets the createContainerSet to contain all the containerIds per
+     * Sets the container2BCSIDMap to contain all the containerIds per
-     * @param set createContainerSet
+     * @param map container2BCSIDMap
-    public Builder setCreateContainerSet(Set<Long> set) {
-      this.createContainerSet = set;
+    public Builder setContainer2BCSIDMap(Map<Long, Long> map) {
+      this.container2BCSIDMap = map;
-          createContainerSet);
+          container2BCSIDMap);

UPD40 UPD74 UPD74 UPD42 UPD43 INS43 UPD42 UPD74 UPD42 UPD43 INS43 UPD74 UPD42 UPD42 INS42 UPD43 INS43 UPD42 INS42 UPD42 UPD43 INS43 UPD42 UPD74 UPD42 UPD42 INS42 UPD42 UPD42 INS42 UPD66 UPD42 UPD66 UPD43 INS43 UPD42 UPD42 INS42 UPD42 UPD42 UPD42