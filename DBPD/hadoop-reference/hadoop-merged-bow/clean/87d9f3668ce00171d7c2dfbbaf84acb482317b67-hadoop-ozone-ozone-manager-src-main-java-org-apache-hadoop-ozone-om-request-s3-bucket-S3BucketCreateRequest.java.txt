HDDS-2244. Use new ReadWrite lock in OzoneManager. (#1589)


-      acquiredS3Lock = omMetadataManager.getLock().acquireLock(S3_BUCKET_LOCK,
-          s3BucketName);
+      acquiredS3Lock = omMetadataManager.getLock().acquireWriteLock(
+          S3_BUCKET_LOCK, s3BucketName);
-            omMetadataManager.getLock().acquireLock(VOLUME_LOCK, volumeName);
-        acquiredUserLock = omMetadataManager.getLock().acquireLock(USER_LOCK,
-            userName);
+            omMetadataManager.getLock().acquireWriteLock(VOLUME_LOCK,
+                volumeName);
+        acquiredUserLock = omMetadataManager.getLock().acquireWriteLock(
+            USER_LOCK, userName);
-          omMetadataManager.getLock().releaseLock(USER_LOCK, userName);
+          omMetadataManager.getLock().releaseWriteLock(USER_LOCK, userName);
-          omMetadataManager.getLock().releaseLock(VOLUME_LOCK, volumeName);
+          omMetadataManager.getLock().releaseWriteLock(VOLUME_LOCK, volumeName);
-        omMetadataManager.getLock().releaseLock(S3_BUCKET_LOCK, s3BucketName);
+        omMetadataManager.getLock().releaseWriteLock(
+            S3_BUCKET_LOCK, s3BucketName);
-          omMetadataManager.getLock().acquireLock(BUCKET_LOCK, volumeName,
+          omMetadataManager.getLock().acquireWriteLock(BUCKET_LOCK, volumeName,
-        omMetadataManager.getLock().releaseLock(BUCKET_LOCK, volumeName,
+        omMetadataManager.getLock().releaseWriteLock(BUCKET_LOCK, volumeName,

UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42