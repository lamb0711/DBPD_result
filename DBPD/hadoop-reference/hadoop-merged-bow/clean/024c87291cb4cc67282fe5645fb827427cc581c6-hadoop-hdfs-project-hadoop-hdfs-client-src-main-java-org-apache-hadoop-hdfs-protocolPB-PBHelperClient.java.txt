HDFS-13617. Allow wrapping NN QOP into token in encrypted message. Contributed by Chen Liang

-    return TokenProto.newBuilder().
+    TokenProto.Builder builder = TokenProto.newBuilder().
-        setServiceBytes(getFixedByteString(tok.getService())).build();
+        setServiceBytes(getFixedByteString(tok.getService()));
+    if (tok.getDnHandshakeSecret() != null) {
+      builder.setHandshakeSecret(
+          ByteString.copyFrom(tok.getDnHandshakeSecret()));
+    }
+    return builder.build();
-    return new Token<>(blockToken.getIdentifier()
+    Token<BlockTokenIdentifier> token =
+        new Token<>(blockToken.getIdentifier()
+    if (blockToken.hasHandshakeSecret()) {
+      token.setDNHandshakeSecret(blockToken.getHandshakeSecret().toByteArray());
+    }
+    return token;

INS74 INS60 INS25 INS43 INS43 INS60 INS25 INS43 INS59 INS27 INS8 INS42 INS42 MOV74 INS59 INS32 INS8 INS42 INS40 INS42 MOV32 INS32 INS33 INS21 INS42 INS42 MOV14 INS42 INS42 INS21 INS42 INS42 INS32 INS32 INS42 INS42 INS32 INS42 INS42 INS32 INS42 INS42 INS32 INS32 INS42 INS42 INS42 INS42 INS42