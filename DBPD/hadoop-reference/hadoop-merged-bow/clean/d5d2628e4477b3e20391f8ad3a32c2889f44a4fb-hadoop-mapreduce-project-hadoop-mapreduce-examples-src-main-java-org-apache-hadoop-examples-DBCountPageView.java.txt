Merge r1360400 through r1399945 from trunk.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1399950 13f79535-47bb-0310-9956-ffa450edef68

-import java.util.Iterator;
+ * <br>
+ * This program requires some additional configuration relating to HSQLDB.  
+ * The the hsqldb jar should be added to the classpath:
+ * <br>
+ * <code>export HADOOP_CLASSPATH=share/hadoop/mapreduce/lib-examples/hsqldb-2.0.0.jar</code>
+ * <br>
+ * And the hsqldb jar should be included with the <code>-libjars</code> 
+ * argument when executing it with hadoop:
+ * <br>
+ * <code>-libjars share/hadoop/mapreduce/lib-examples/hsqldb-2.0.0.jar</code>
+  private boolean isOracle = false;
-    
+    if(driverClassName.toLowerCase().contains("oracle")) {
+      isOracle = true;
+    }
-    String dropAccess = "DROP TABLE Access";
+    String dropAccess = "DROP TABLE HAccess";
-
+	String dataType = "BIGINT NOT NULL";
+	if(isOracle) {
+	  dataType = "NUMBER(19) NOT NULL";
+	}
-      "Access(url      VARCHAR(100) NOT NULL," +
+      "HAccess(url      VARCHAR(100) NOT NULL," +
-            " time     BIGINT NOT NULL, " +
+            " time     " + dataType + ", " +
-              " pageview     BIGINT NOT NULL, " +
+              " pageview     " + dataType + ", " +
-          "INSERT INTO Access(url, referrer, time)" +
+          "INSERT INTO HAccess(url, referrer, time)" +
-    String countAccessQuery = "SELECT COUNT(*) FROM Access";
+    String countAccessQuery = "SELECT COUNT(*) FROM HAccess";
-    Job job = new Job(conf);
+    Job job = Job.getInstance(conf);
-    DBInputFormat.setInput(job, AccessRecord.class, "Access"
+    DBInputFormat.setInput(job, AccessRecord.class, "HAccess"

INS23 INS83 INS39 INS59 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS42 INS9 INS25 INS60 INS25 INS32 INS8 MOV43 INS59 INS42 INS8 INS43 MOV43 INS59 INS32 INS42 INS45 INS21 UPD45 INS42 INS45 INS21 INS42 UPD45 INS42 INS32 UPD45 INS42 INS42 INS7 INS7 INS27 INS42 INS45 INS27 INS42 INS45 INS42 INS42 INS42 INS42 INS9 INS42 INS45 MOV45 UPD45 MOV45 MOV45 UPD45 MOV45 MOV45 MOV45 UPD45 MOV45 UPD45 DEL40 DEL26 DEL42 DEL43 DEL42 DEL42 DEL14 DEL59