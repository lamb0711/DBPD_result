HDFS-7308. Change the packet chunk size computation in DFSOutputStream in order to enforce packet size <= 64kB.  Contributed by Takuya Fukudome

+    final int bodySize = psize - PacketHeader.PKT_MAX_HEADER_LEN;
-    chunksPerPacket = Math.max(psize/chunkSize, 1);
+    chunksPerPacket = Math.max(bodySize/chunkSize, 1);

INS60 INS83 INS39 INS59 INS42 INS27 INS42 INS40 UPD42