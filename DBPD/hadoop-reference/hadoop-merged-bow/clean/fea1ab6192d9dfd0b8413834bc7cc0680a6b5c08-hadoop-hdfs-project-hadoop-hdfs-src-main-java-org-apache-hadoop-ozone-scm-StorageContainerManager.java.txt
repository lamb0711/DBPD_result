HDFS-12007. Ozone: Enable HttpServer2 for SCM and KSM. Contributed by Elek, Marton.

+  private final StorageContainerManagerHttpServer httpServer;
+
-    datanodeRpcAddress = OzoneClientUtils.updateListenAddress(conf,
+    datanodeRpcAddress = OzoneClientUtils.updateRPCListenAddress(conf,
-    clientRpcAddress = OzoneClientUtils.updateListenAddress(conf,
+    clientRpcAddress = OzoneClientUtils.updateRPCListenAddress(conf,
-
-    blockRpcAddress = OzoneClientUtils.updateListenAddress(conf,
+    blockRpcAddress = OzoneClientUtils.updateRPCListenAddress(conf,
+    httpServer = new StorageContainerManagerHttpServer(conf);
+
-  public void start() {
+  public void start() throws IOException {
+
+    httpServer.start();
+
+
-    LOG.info("Stopping block service RPC server");
-    blockRpcServer.stop();
-    LOG.info("Stopping the StorageContainerLocationProtocol RPC server");
-    clientRpcServer.stop();
-    LOG.info("Stopping the RPC server for DataNodes");
-    datanodeRpcServer.stop();
+    try {
+      LOG.info("Stopping block service RPC server");
+      blockRpcServer.stop();
+    } catch (Exception ex) {
+      LOG.error("Storage Container Manager blockRpcServer stop failed.", ex);
+    }
+
+    try {
+      LOG.info("Stopping the StorageContainerLocationProtocol RPC server");
+      clientRpcServer.stop();
+    } catch (Exception ex) {
+      LOG.error("Storage Container Manager clientRpcServer stop failed.", ex);
+    }
+
+    try {
+      LOG.info("Stopping the RPC server for DataNodes");
+      datanodeRpcServer.stop();
+    } catch (Exception ex) {
+      LOG.error("Storage Container Manager httpServer stop failed.", ex);
+    }
+

INS23 INS83 INS83 INS43 INS59 INS43 INS42 INS42 INS21 INS42 INS21 INS54 INS54 INS54 INS7 INS32 INS8 INS12 INS8 INS12 INS8 INS12 INS42 INS14 INS42 INS42 MOV21 MOV21 INS44 INS8 MOV21 MOV21 INS44 INS8 MOV21 MOV21 INS44 INS8 UPD42 UPD42 UPD42 INS43 INS42 INS43 INS42 INS21 INS43 INS42 INS21 INS43 INS42 INS21 INS42 INS42 INS32 INS42 INS32 INS42 INS32 INS42 INS42 INS45 INS42 INS42 INS42 INS45 INS42 INS42 INS42 INS45 INS42