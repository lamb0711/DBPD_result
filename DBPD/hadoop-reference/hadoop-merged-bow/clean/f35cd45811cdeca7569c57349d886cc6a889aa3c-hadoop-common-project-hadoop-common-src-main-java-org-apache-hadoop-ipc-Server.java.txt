Merge r1454237 through r1455388 from trunk.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1455390 13f79535-47bb-0310-9956-ffa450edef68

+    response.setServerIpcVersionNum(Server.CURRENT_VERSION);
-    } else {
-      if (status == RpcStatusProto.FATAL) {
-        response.setServerIpcVersionNum(Server.CURRENT_VERSION);
-      }
+    } else { // Rpc Failure
+      response.setExceptionClassName(errorClass);
+      response.setErrorMsg(error);
-      WritableUtils.writeString(out, errorClass);
-      WritableUtils.writeString(out, error);

MOV21 MOV21 UPD42 UPD42 UPD42 UPD42 DEL42 DEL40 DEL27 DEL8 DEL25 DEL42 DEL42