HADOOP-14839. DistCp log output should contain copied and deleted files and directories. Contributed by Yiqun Lin.

+    DIR_COPY,     // Number of directories received by the mapper for copy.
+  private boolean verboseLog = false;
+    verboseLog = conf.getBoolean(
+        DistCpOptionSwitch.VERBOSE_LOG.getConfigLabel(), false);
+        if (verboseLog) {
+          context.write(null,
+              new Text("FILE_SKIPPED: source=" + sourceFileStatus.getPath()
+              + ", size=" + sourceFileStatus.getLen() + " --> "
+              + "target=" + target + ", size=" + (targetStatus == null ?
+                  0 : targetStatus.getLen())));
+        }
-        copyFileWithRetry(description, sourceCurrStatus, tmpTarget, context,
-            action, fileAttributes);
+        copyFileWithRetry(description, sourceCurrStatus, tmpTarget,
+            targetStatus, context, action, fileAttributes);
-      CopyListingFileStatus sourceFileStatus, Path target, Context context,
-      FileAction action, EnumSet<DistCpOptions.FileAttribute> fileAttributes)
-      throws IOException {
+      CopyListingFileStatus sourceFileStatus, Path target,
+      FileStatus targrtFileStatus, Context context, FileAction action,
+      EnumSet<DistCpOptions.FileAttribute> fileAttributes)
+      throws IOException, InterruptedException {
+
+    if (verboseLog) {
+      context.write(null,
+          new Text("FILE_COPIED: source=" + sourceFileStatus.getPath() + ","
+          + " size=" + sourceFileStatus.getLen() + " --> "
+          + "target=" + target + ", size=" + (targrtFileStatus == null ?
+              0 : targrtFileStatus.getLen())));
+    }
-    incrementCounter(context, Counter.COPY, 1);
+    incrementCounter(context, Counter.DIR_COPY, 1);

INS23 INS72 INS83 INS39 INS59 INS44 INS43 INS42 INS42 INS9 INS21 INS43 INS42 INS42 INS25 INS7 INS42 INS42 INS8 INS42 INS32 INS21 UPD40 INS42 INS42 INS32 INS9 INS32 INS40 INS42 INS25 INS42 INS42 INS33 INS14 INS42 INS8 INS43 INS27 INS21 INS42 INS42 INS45 INS32 INS45 INS45 INS32 INS45 INS45 INS42 INS45 INS36 INS32 INS42 INS42 INS42 INS42 INS16 INS42 INS42 INS33 INS14 INS27 INS34 INS32 INS43 INS27 INS42 INS33 INS42 INS42 INS42 INS45 INS32 INS45 INS32 INS45 INS45 INS42 INS45 INS36 INS42 INS42 INS42 INS42 INS16 INS27 INS34 INS32 INS42 INS33 INS42 INS42