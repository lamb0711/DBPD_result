HDDS-357. Use DBStore and TableStore for OzoneManager non-background service.
Contributed by Nandakumar.

+import org.apache.hadoop.ozone.OzoneAcl;
+import org.apache.hadoop.ozone.om.exceptions.OMException;
-import org.apache.hadoop.ozone.om.exceptions.OMException;
-import org.apache.hadoop.ozone.protocol.proto
-    .OzoneManagerProtocolProtos.BucketInfo;
-import org.apache.hadoop.ozone.OzoneAcl;
+import org.apache.hadoop.ozone.protocol.proto.OzoneManagerProtocolProtos.BucketInfo;
+   *
-  public BucketManagerImpl(OMMetadataManager metadataManager){
+  public BucketManagerImpl(OMMetadataManager metadataManager) {
+   *
-      if (metadataManager.get(volumeKey) == null) {
+      if (metadataManager.getVolumeTable().get(volumeKey) == null) {
-      if (metadataManager.get(bucketKey) != null) {
+      if (metadataManager.getBucketTable().get(bucketKey) != null) {
-      metadataManager.put(bucketKey, omBucketInfo.getProtobuf().toByteArray());
+      metadataManager.getBucketTable().put(bucketKey,
+          omBucketInfo.getProtobuf().toByteArray());
-      byte[] value = metadataManager.get(bucketKey);
+      byte[] value = metadataManager.getBucketTable().get(bucketKey);
+   *
-   * @throws IOException
+   * @throws IOException - On Failure.
-      if(metadataManager.get(metadataManager.getVolumeKey(volumeName)) ==
-          null) {
+      if (metadataManager.getVolumeTable()
+          .get(metadataManager.getVolumeKey(volumeName)) == null) {
-      byte[] value = metadataManager.get(bucketKey);
+      byte[] value = metadataManager.getBucketTable().get(bucketKey);
-      if(value == null) {
+      if (value == null) {
-      if(args.getAddAcls() != null || args.getRemoveAcls() != null) {
+      if (args.getAddAcls() != null || args.getRemoveAcls() != null) {
-      metadataManager.put(bucketKey,
+      metadataManager.getBucketTable().put(bucketKey,
-    if(removeAcls != null && !removeAcls.isEmpty()) {
+    if (removeAcls != null && !removeAcls.isEmpty()) {
-    if(addAcls != null && !addAcls.isEmpty()) {
+    if (addAcls != null && !addAcls.isEmpty()) {
+   *
-   * @throws IOException
+   * @throws IOException - on Failure.
-      byte[] bucketKey = metadataManager.getBucketKey(volumeName, bucketName);
-      if (metadataManager.get(metadataManager.getVolumeKey(volumeName))
-          == null) {
+      if (metadataManager.getVolumeTable()
+          .get(metadataManager.getVolumeKey(volumeName)) == null) {
-      //Check if bucket exist
-      if (metadataManager.get(bucketKey) == null) {
+
+      //Check if bucket exists
+      byte[] bucketKey = metadataManager.getBucketKey(volumeName, bucketName);
+      if (metadataManager.getBucketTable().get(bucketKey) == null) {
-      metadataManager.delete(bucketKey);
+      metadataManager.getBucketTable().delete(bucketKey);
-                                        String startBucket, String bucketPrefix, int maxNumOfBuckets)
+      String startBucket, String bucketPrefix, int maxNumOfBuckets)

MOV26 MOV26 INS66 INS66 MOV60 INS32 INS32 INS32 INS32 INS32 MOV42 INS42 INS32 INS32 INS32 MOV42 INS42 INS32 INS32 MOV42 INS42 MOV42 INS42 MOV42 INS42 MOV42 INS42 MOV42 INS42 MOV42 INS42 MOV42 INS42 MOV42 INS42