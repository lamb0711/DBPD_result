HDFS-11493. Ozone: SCM: Add the ability to handle container reports. Contributed by Anu Engineer.

+    case UNKNOWN:
+      // This is unknown due to the fact that some nodes can be in
+      // transit between the other states. Returning a count for that is not
+      // possible. The fact that we have such state is to deal with the fact
+      // that this information might not be consistent always.
+      return 0;
+   * Returns the node state of a specific node.
+   *
+   * @param id - DatanodeID
+   * @return Healthy/Stale/Dead/Unknown.
+   */
+  @Override
+  public NODESTATE getNodeState(DatanodeID id) {
+    // There is a subtle race condition here, hence we also support
+    // the NODEState.UNKNOWN. It is possible that just before we check the
+    // healthyNodes, we have removed the node from the healthy list but stil
+    // not added it to Stale Nodes list.
+    // We can fix that by adding the node to stale list before we remove, but
+    // then the node is in 2 states to avoid this race condition. Instead we
+    // just deal with the possibilty of getting a state called unknown.
+
+    if(healthyNodes.containsKey(id.getDatanodeUuid())) {
+      return NODESTATE.HEALTHY;
+    }
+
+    if(staleNodes.containsKey(id.getDatanodeUuid())) {
+      return NODESTATE.STALE;
+    }
+
+    if(deadNodes.containsKey(id.getDatanodeUuid())) {
+      return NODESTATE.DEAD;
+    }
+
+    return NODESTATE.UNKNOWN;
+  }
+
+  /**

INS31 INS29 INS78 INS83 INS43 INS42 INS44 INS8 INS65 INS65 INS65 INS42 INS42 INS43 INS42 INS25 INS25 INS25 INS41 INS41 INS49 INS66 INS42 INS66 INS66 INS42 INS32 INS8 INS32 INS8 INS32 INS8 INS40 INS42 INS34 INS42 INS42 INS32 INS41 INS42 INS42 INS32 INS41 INS42 INS42 INS32 INS41 INS42 INS42 INS40 INS42 INS42 INS40 INS42 INS42 INS40