HDDS-300. Create a config for volume choosing policy. Contributed by Bharat Viswanadham.

-    .CreateContainerRequestProto;
-import org.apache.hadoop.hdds.protocol.datanode.proto.ContainerProtos
+import org.apache.hadoop.util.ReflectionUtils;
+import static org.apache.hadoop.hdds.HddsConfigKeys
+    .HDDS_DATANODE_VOLUME_CHOOSING_POLICY;
-    // TODO: Add supoort for different volumeChoosingPolicies.
-    volumeChoosingPolicy = new RoundRobinVolumeChoosingPolicy();
+    volumeChoosingPolicy = ReflectionUtils.newInstance(conf.getClass(
+        HDDS_DATANODE_VOLUME_CHOOSING_POLICY, RoundRobinVolumeChoosingPolicy
+            .class, VolumeChoosingPolicy.class), conf);
+  @VisibleForTesting
+  public VolumeChoosingPolicy getVolumeChoosingPolicyForTesting() {
+    return volumeChoosingPolicy;
+  }

MOV26 INS26 INS40 UPD40 INS31 INS78 INS83 INS43 INS42 INS8 INS42 INS42 INS41 INS42 INS32 INS42 INS42 INS32 INS42 INS42 INS42 INS42 INS57 INS57 MOV43 INS43 INS42 DEL14