HDFS-4257. The ReplaceDatanodeOnFailure policies could have a forgiving option.  Contributed by szetszwo.

-          addDatanode2ExistingPipeline();
+          try {
+            addDatanode2ExistingPipeline();
+          } catch(IOException ioe) {
+            if (!dfsClient.dtpReplaceDatanodeOnFailure.isBestEffort()) {
+              throw ioe;
+            }
+            DFSClient.LOG.warn("Failed to replace datanode."
+                + " Continue with the remaining datanodes since "
+                + DFSConfigKeys.DFS_CLIENT_WRITE_REPLACE_DATANODE_ON_FAILURE_BEST_EFFORT_KEY
+                + " is set to true.", ioe);
+          }

INS25 MOV32 INS8 INS54 MOV8 INS12 INS44 INS8 INS43 INS42 MOV25 INS21 INS42 INS38 INS8 INS32 INS32 INS53 INS40 INS42 INS27 INS42 INS40 INS42 INS42 INS27 INS40 INS45 INS45 INS45