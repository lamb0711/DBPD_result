HDFS-2878. Fix TestBlockRecovery and move it back into main test directory. Contributed by Todd Lipcon.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1242995 13f79535-47bb-0310-9956-ffa450edef68

+  /**
+   * Connect to the NN. This is separated out for easier testing.
+   */
+  DatanodeProtocolClientSideTranslatorPB connectToNN(
+      InetSocketAddress nnAddr) throws IOException {
+    return new DatanodeProtocolClientSideTranslatorPB(nnAddr, conf);
+  }
+
-    if(bpos == null || bpos.bpNamenode == null) {
-      throw new IOException("cannot find a namnode proxy for bpid=" + bpid);
+    if (bpos == null) {
+      throw new IOException("No block pool offer service for bpid=" + bpid);
+    } else if (bpos.bpNamenode == null) {
+      throw new IOException("cannot find a namenode proxy for bpid=" + bpid);
-

INS31 INS29 INS43 INS42 INS44 INS43 INS8 INS65 INS42 INS43 INS42 INS42 INS41 INS66 INS42 INS14 MOV27 INS8 INS25 INS43 INS42 INS42 INS53 MOV27 MOV8 INS42 INS14 MOV43 INS27 INS45 INS42 INS43 INS42 UPD45 DEL27