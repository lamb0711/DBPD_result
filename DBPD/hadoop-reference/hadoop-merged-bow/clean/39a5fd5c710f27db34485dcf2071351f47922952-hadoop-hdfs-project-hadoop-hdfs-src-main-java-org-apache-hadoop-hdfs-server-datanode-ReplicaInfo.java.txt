Merge trunk into auto-failover branch


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-3042@1309164 13f79535-47bb-0310-9956-ffa450edef68

-
-  /**
-   * Get this replica's meta file name
-   * @return this replica's meta file name
-   */
-  private String getMetaFileName() {
-    return getBlockName() + "_" + getGenerationStamp() + METADATA_EXTENSION; 
-  }
-  File getBlockFile() {
+  public File getBlockFile() {
-  File getMetaFile() {
-    return new File(getDir(), getMetaFileName());
+  public File getMetaFile() {
+    return new File(getDir(),
+        DatanodeUtil.getMetaName(getBlockName(), getGenerationStamp()));
-  FsVolumeSpi getVolume() {
+  public FsVolumeSpi getVolume() {
-  void setDir(File dir) {
+  public void setDir(File dir) {
-  boolean isUnlinked() {
+  public boolean isUnlinked() {
-  void setUnlinked() {
+  public void setUnlinked() {
-  boolean unlinkBlock(int numLinks) throws IOException {
+  public boolean unlinkBlock(int numLinks) throws IOException {

INS83 INS83 INS83 INS83 INS83 INS83 INS83 INS42 UPD42 MOV32 MOV32 DEL66 DEL65 DEL66 DEL65 DEL29 DEL83 DEL42 DEL43 DEL42 DEL45 DEL42 DEL27 DEL41 DEL8 DEL31