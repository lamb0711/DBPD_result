HDFS-13350. Negative legacy block ID will confuse Erasure Coding to be considered as striped block. (Contributed by Lei (Eddy) Xu).

+  /**
+   * Return true if the block is a striped block.
+   *
+   * Before HDFS-4645, block ID was randomly generated (legacy), so it is
+   * possible that legacy block ID to be negative, which should not be
+   * considered as striped block ID.
+   *
+   * @see #isLegacyBlock(Block) detecting legacy block IDs.
+   */
+  public boolean isStripedBlock(Block block) {
+    return isStripedBlockID(block.getBlockId()) && !isLegacyBlock(block);
+  }
+
+  /**
+   * See {@link #isStripedBlock(Block)}, we should not use this function alone
+   * to determine a block is striped block.
+   */

INS31 INS29 INS83 INS39 INS42 INS44 INS8 INS29 INS65 INS65 INS43 INS42 INS41 INS65 INS66 INS66 INS66 INS66 INS68 INS66 INS42 INS27 INS66 INS65 INS66 INS66 INS42 INS69 INS32 INS38 INS68 INS43 INS42 INS32 INS32 INS42 INS69 INS42 INS42 INS42 INS42 INS42 INS43 INS42