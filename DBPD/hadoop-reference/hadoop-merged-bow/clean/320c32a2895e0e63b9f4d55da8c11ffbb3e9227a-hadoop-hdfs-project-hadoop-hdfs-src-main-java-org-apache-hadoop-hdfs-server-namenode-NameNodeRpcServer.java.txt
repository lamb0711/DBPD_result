HDFS-3507. DFS#isInSafeMode needs to execute only on Active NameNode. Contributed by Vinay.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1410587 13f79535-47bb-0310-9956-ffa450edef68

-  public boolean setSafeMode(SafeModeAction action) throws IOException {
-    namesystem.checkOperation(OperationCategory.UNCHECKED);
+  public boolean setSafeMode(SafeModeAction action, boolean isChecked)
+      throws IOException {
+    OperationCategory opCategory = OperationCategory.UNCHECKED;
+    if (isChecked) {
+      if (action == SafeModeAction.SAFEMODE_GET) {
+        opCategory = OperationCategory.READ;
+      } else {
+        opCategory = OperationCategory.WRITE;
+      }
+    }
+    namesystem.checkOperation(opCategory);

INS44 INS39 INS42 INS60 INS25 INS43 INS59 INS42 INS8 INS42 INS42 INS40 INS25 INS42 INS27 INS8 INS8 INS42 INS40 INS21 INS21 INS7 INS7 INS42 INS40 INS42 INS40 DEL40