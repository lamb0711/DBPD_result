HDFS-5480. Update Balancer for HDFS-2832. (Contributed by szetszwo)

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2832@1540547 13f79535-47bb-0310-9956-ffa450edef68

-    LOG.info("starting cluster with " + 
-        builder.nnTopology.countNameNodes() + " namenodes.");
-    nameNodes = new NameNodeInfo[builder.nnTopology.countNameNodes()];
+    final int numNameNodes = builder.nnTopology.countNameNodes();
+    LOG.info("starting cluster: numNameNodes=" + numNameNodes
+        + ", numDataNodes=" + builder.numDataNodes);
+    nameNodes = new NameNodeInfo[numNameNodes];
+      LOG.info("dnInfo.length != numDataNodes");
+        LOG.info("!dn.datanode.isDatanodeFullyStarted()");
+        LOG.info("dn.getCapacity() == 0");
+        LOG.info("DataNodeTestUtils.getFSDataset(dn.datanode) == null");

INS60 INS83 INS39 INS59 INS42 MOV32 INS21 MOV41 UPD45 INS42 UPD45 INS40 INS42 INS32 INS42 INS42 INS45 INS21 INS41 INS21 MOV41 INS21 MOV41 INS32 INS9 INS32 INS32 INS42 INS42 INS45 INS42 INS42 INS45 INS42 INS42 INS45 DEL40 DEL42 DEL32