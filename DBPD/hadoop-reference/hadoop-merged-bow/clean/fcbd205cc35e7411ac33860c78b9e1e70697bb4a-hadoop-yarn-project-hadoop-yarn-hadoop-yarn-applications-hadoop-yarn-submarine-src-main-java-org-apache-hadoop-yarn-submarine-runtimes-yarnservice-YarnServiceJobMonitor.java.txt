YARN-9001. [Submarine] Use AppAdminClient instead of ServiceClient to sumbit jobs. (Zac Zhou via wangda)

Change-Id: Ic3d6c1e439df9cdf74448b345b925343224efe51

+import org.apache.hadoop.yarn.client.api.AppAdminClient;
-import org.apache.hadoop.yarn.service.client.ServiceClient;
+import org.apache.hadoop.yarn.service.utils.ServiceApiUtil;
-  private ServiceClient serviceClient = null;
+  private volatile AppAdminClient serviceClient = null;
-  public synchronized JobStatus getTrainingJobStatus(String jobName)
+  public JobStatus getTrainingJobStatus(String jobName)
-      this.serviceClient = YarnServiceUtils.createServiceClient(
-          clientContext.getYarnConfig());
+      synchronized(this) {
+        if (this.serviceClient == null) {
+          this.serviceClient = YarnServiceUtils.createServiceClient(
+              clientContext.getYarnConfig());
+        }
+      }
+    String appStatus=serviceClient.getStatusString(jobName);
+    Service serviceSpec= ServiceApiUtil.jsonSerDeser.fromJson(appStatus);
+    JobStatus jobStatus = JobStatusBuilder.fromServiceSpec(serviceSpec);
+    return jobStatus;
+  }
-    Service serviceSpec = this.serviceClient.getStatus(jobName);
-    return JobStatusBuilder.fromServiceSpec(serviceSpec);
+  @Override
+  public void cleanup() throws IOException{
+    if (this.serviceClient != null) {
+      this.serviceClient.close();
+    }

INS26 INS40 UPD40 INS31 INS83 UPD43 INS8 INS78 INS83 INS39 INS42 INS43 INS8 UPD42 INS25 INS60 INS60 INS60 INS41 INS42 INS42 INS25 INS27 INS8 INS43 INS59 MOV43 INS59 INS43 INS59 INS42 INS27 INS8 MOV22 INS33 INS51 INS42 INS42 INS32 INS42 INS32 INS42 INS42 MOV32 INS22 INS33 INS21 INS52 MOV8 INS42 INS42 INS42 INS40 INS42 INS42 INS52 INS42 INS32 INS22 INS42 INS52 INS42 DEL83 DEL42 DEL42 DEL42 DEL32 DEL59 DEL60 DEL41