HDDS-737. Introduce Incremental Container Report.
Contributed by Nanda kumar.

+import org.apache.hadoop.hdds.scm.node.states.NodeNotFoundException;
-        nodeManager.getContainers(datanodeDetails.getUuid());
+        null;
+    try {
+      ids = nodeManager.getContainers(datanodeDetails);
+    } catch (NodeNotFoundException e) {
+      // This should not happen, we cannot get a dead node event for an
+      // unregistered node!
+      LOG.error("DeadNode event for a unregistered node: {}!", datanodeDetails);
+    }
+        // TODO: For open containers, trigger close on other nodes
+        // TODO: Check replica count and call replication manager
+        // on these containers.
-          final ContainerReplica replica = ContainerReplica.newBuilder()
-              .setContainerID(id)
-              .setDatanodeDetails(datanodeDetails)
-              .build();
-          try {
-            containerManager.removeContainerReplica(id, replica);
-            replicateIfNeeded(container, publisher);
-          } catch (ContainerException ex) {
-            LOG.warn("Exception while removing container replica #{} for " +
-                "container #{}.", replica, container, ex);
-          }
+          Set<ContainerReplica> replicas = containerManager
+              .getContainerReplicas(id);
+          replicas.stream()
+              .filter(r -> r.getDatanodeDetails().equals(datanodeDetails))
+              .findFirst()
+              .ifPresent(replica -> {
+                try {
+                  containerManager.removeContainerReplica(id, replica);
+                } catch (ContainerException ex) {
+                  LOG.warn("Exception while removing container replica #{} " +
+                      "for container #{}.", replica, container, ex);
+                }
+              });

INS26 INS40 INS54 INS8 INS12 INS33 INS21 INS44 INS8 INS7 INS43 INS42 INS21 INS42 INS32 INS42 INS32 INS42 INS42 INS42 INS42 INS42 INS45 INS42 INS60 INS21 INS74 INS59 INS32 INS43 MOV43 UPD42 MOV42 INS32 INS32 INS42 INS86 INS42 INS42 INS42 INS42 MOV32 UPD42 MOV42 INS59 INS8 MOV32 UPD42 MOV42 INS86 INS42 MOV54 UPD42 UPD42 INS59 INS32 INS42 INS32 INS42 MOV42 INS42 UPD42 MOV42 UPD45 UPD45 DEL42 DEL42 DEL42 DEL42 DEL32 DEL32 DEL42 DEL32 DEL42 DEL42 DEL42 DEL32 DEL21 DEL83 DEL32 DEL59 DEL60