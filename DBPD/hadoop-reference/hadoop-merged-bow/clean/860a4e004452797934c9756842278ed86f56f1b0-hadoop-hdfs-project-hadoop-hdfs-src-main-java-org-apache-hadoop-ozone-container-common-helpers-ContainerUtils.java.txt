HDFS-11550. Ozone: Add a check to prevent removing a container that has keys in it. Contributed by Weiwei Yang.

+import org.apache.hadoop.conf.Configuration;
-  public static void removeContainer(ContainerData containerData) throws
-      IOException {
+  public static void removeContainer(ContainerData containerData,
+      Configuration conf) throws IOException {
-
-    // TODO : Check if there are any keys. This needs to be done
-    // by calling into key layer code, hence this is a TODO for now.
-
+    LevelDBStore db = KeyUtils.getDB(containerData, conf);
+    if(!db.isEmpty()) {
+      throw new StorageContainerException(
+          "Container cannot be deleted because it is not empty.",
+          ContainerProtos.Result.ERROR_CONTAINER_NOT_EMPTY);
+    }
+    // Close the DB connection and remove the DB handler from cache
+    KeyUtils.removeDB(containerData, conf);
+

INS26 INS40 INS44 INS43 INS42 INS60 INS25 INS21 INS42 INS43 INS59 INS38 INS8 INS32 INS42 INS42 INS32 INS32 INS53 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS14 INS43 INS45 INS40 INS42