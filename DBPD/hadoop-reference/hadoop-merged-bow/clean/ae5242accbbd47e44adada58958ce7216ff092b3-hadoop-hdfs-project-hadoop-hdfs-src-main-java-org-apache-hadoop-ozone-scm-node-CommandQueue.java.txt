HDFS-11830. Ozone: Datanode needs to re-register to SCM if SCM is restarted. Contributed by Weiwei Yang.

-
-      if (commandMap.containsKey(datanodeID)) {
-        List temp = commandMap.get(datanodeID);
-        if (temp.size() > 0) {
-          commandMap.put(datanodeID, DEFAULT_LIST);
-          return temp;
-        }
-      }
+      List<SCMCommand> cmds = commandMap.remove(datanodeID);
+      return cmds == null ? DEFAULT_LIST : cmds;
-    return DEFAULT_LIST;

INS8 MOV60 INS41 INS74 INS16 INS43 INS43 UPD42 INS27 INS42 INS42 MOV42 INS42 UPD42 INS42 INS33 DEL43 DEL42 DEL42 DEL42 DEL32 DEL42 DEL42 DEL32 DEL34 DEL27 DEL42 DEL42 DEL42 DEL42 DEL32 DEL21 DEL42 DEL41 DEL8 DEL25 DEL8 DEL25 DEL8 DEL42 DEL41