HDDS-248. Refactor DatanodeContainerProtocol.proto Contributed by Hanisha Koneru.

-      long containerID = getContainerID(msg);
+      long containerID = msg.getContainerID();
+        if (!msg.hasCreateContainer()) {
+          return ContainerUtils.malformedRequest(msg);
+        }
-  private long getContainerID(ContainerCommandRequestProto request)
-      throws StorageContainerException {
-    ContainerProtos.Type cmdType = request.getCmdType();
-
-    switch(cmdType) {
-    case CreateContainer:
-      return request.getCreateContainer().getContainerID();
-    case ReadContainer:
-      return request.getReadContainer().getContainerID();
-    case UpdateContainer:
-      return request.getUpdateContainer().getContainerID();
-    case DeleteContainer:
-      return request.getDeleteContainer().getContainerID();
-    case ListContainer:
-      return request.getListContainer().getStartContainerID();
-    case CloseContainer:
-      return request.getCloseContainer().getContainerID();
-    case PutKey:
-      return request.getPutKey().getKeyData().getBlockID().getContainerID();
-    case GetKey:
-      return request.getGetKey().getBlockID().getContainerID();
-    case DeleteKey:
-      return request.getDeleteKey().getBlockID().getContainerID();
-    case ListKey:
-      return request.getListKey().getContainerID();
-    case ReadChunk:
-      return request.getReadChunk().getBlockID().getContainerID();
-    case DeleteChunk:
-      return request.getDeleteChunk().getBlockID().getContainerID();
-    case WriteChunk:
-      return request.getWriteChunk().getBlockID().getContainerID();
-    case ListChunk:
-      return request.getListChunk().getBlockID().getContainerID();
-    case PutSmallFile:
-      return request.getPutSmallFile().getKey().getKeyData().getBlockID()
-          .getContainerID();
-    case GetSmallFile:
-      return request.getGetSmallFile().getKey().getBlockID().getContainerID();
-    case GetCommittedBlockLength:
-      return request.getGetCommittedBlockLength().getBlockID().getContainerID();
-    }
-
-    throw new StorageContainerException(
-        ContainerProtos.Result.UNSUPPORTED_REQUEST);
-  }
-

INS25 INS42 INS38 INS8 INS32 INS41 INS42 INS42 INS32 INS42 INS42 INS42 DEL42 DEL83 DEL39 DEL42 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL40 DEL43 DEL42 DEL42 DEL42 DEL32 DEL59 DEL60 DEL42 DEL42 DEL49 DEL42 DEL42 DEL32 DEL42 DEL32 DEL41 DEL42 DEL49 DEL42 DEL42 DEL32 DEL42 DEL32 DEL41 DEL42 DEL49 DEL42 DEL42 DEL32 DEL42 DEL32 DEL41 DEL42 DEL49 DEL42 DEL42 DEL32 DEL42 DEL32 DEL41 DEL42 DEL49 DEL42 DEL42 DEL32 DEL42 DEL32 DEL41 DEL42 DEL49 DEL42 DEL42 DEL32 DEL42 DEL32 DEL41 DEL42 DEL49 DEL42 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32 DEL41 DEL42 DEL49 DEL42 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32 DEL41 DEL42 DEL49 DEL42 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32 DEL41 DEL42 DEL49 DEL42 DEL42 DEL32 DEL42 DEL32 DEL41 DEL42 DEL49 DEL42 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32 DEL41 DEL42 DEL49 DEL42 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32 DEL41 DEL42 DEL49 DEL42 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32 DEL41 DEL42 DEL49 DEL42 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32 DEL41 DEL42 DEL49 DEL42 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32 DEL41 DEL42 DEL49 DEL42 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32 DEL41 DEL42 DEL49 DEL42 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32 DEL41 DEL50 DEL42 DEL43 DEL40 DEL14 DEL53 DEL8 DEL31