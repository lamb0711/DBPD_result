HDFS-14593. RBF: Implement deletion feature for expired records in State Store. Contributed by  Takanobu Asanuma.

-import java.util.Collections;
-   * expired state.
+   * expired state. If an expired record exists beyond deletion time, it is
+   * removed.
+    List<R> deleteRecords = new ArrayList<>();
-      if (record.checkExpired(currentDriverTime)) {
+      if (record.shouldBeDeleted(currentDriverTime)) {
+        String recordName = StateStoreUtils.getRecordName(record.getClass());
+        if (getDriver().remove(record)) {
+          deleteRecords.add(record);
+          LOG.info("Deleted State Store record {}: {}", recordName, record);
+        } else {
+          LOG.warn("Couldn't delete State Store record {}: {}", recordName,
+              record);
+        }
+      } else if (record.checkExpired(currentDriverTime)) {
+    if (deleteRecords.size() > 0) {
+      newRecords.removeAll(deleteRecords);
+    }
-    List<R> newRecords = Collections.singletonList(record);
+    List<R> newRecords = new ArrayList<>();
+    newRecords.add(record);

INS60 INS25 INS60 INS21 UPD66 INS66 INS74 INS59 INS27 INS8 MOV74 INS59 INS32 INS43 INS43 INS42 INS14 INS25 INS32 INS34 INS21 MOV42 INS14 UPD42 MOV42 UPD42 MOV42 MOV42 INS42 INS42 INS74 INS32 INS8 MOV25 INS42 INS42 INS32 INS74 INS43 INS42 INS42 INS42 INS60 INS25 INS42 INS42 INS42 INS43 INS42 INS43 INS59 INS32 INS8 INS8 INS42 INS42 INS42 INS32 INS32 INS42 INS42 INS21 INS21 INS21 INS42 INS42 INS32 INS42 INS32 INS32 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS45 INS42 INS42 INS42 INS42 INS45 INS42 INS42 DEL40 DEL26 DEL32 DEL59 DEL60