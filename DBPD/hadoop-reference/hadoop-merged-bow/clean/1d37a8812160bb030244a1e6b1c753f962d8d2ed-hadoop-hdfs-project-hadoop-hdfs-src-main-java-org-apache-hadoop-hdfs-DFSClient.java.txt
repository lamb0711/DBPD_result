HDFS-8854. Erasure coding: add ECPolicy to replace schema+cellSize in hadoop-hdfs. Contributed by Walter Su.

-import org.apache.hadoop.io.erasurecode.ECSchema;
+import org.apache.hadoop.hdfs.protocol.ErasureCodingPolicy;
-        ECSchema schema = locatedBlocks.getECSchema();
-        if (schema != null) {
-          return new DFSStripedInputStream(this, src, verifyChecksum, schema,
-              locatedBlocks.getStripeCellSize(), locatedBlocks);
+        ErasureCodingPolicy ecPolicy = locatedBlocks.getErasureCodingPolicy();
+        if (ecPolicy != null) {
+          return new DFSStripedInputStream(this, src, verifyChecksum, ecPolicy,
+              locatedBlocks);
-  public void createErasureCodingZone(String src, ECSchema schema, int cellSize)
+  public void createErasureCodingZone(String src, ErasureCodingPolicy ecPolicy)
-      namenode.createErasureCodingZone(src, schema, cellSize);
+      namenode.createErasureCodingZone(src, ecPolicy);
-  public ECSchema[] getECSchemas() throws IOException {
+  public ErasureCodingPolicy[] getErasureCodingPolicies() throws IOException {
-    TraceScope scope = Trace.startSpan("getECSchemas", traceSampler);
+    TraceScope scope = Trace.startSpan("getErasureCodingPolicies", traceSampler);
-      return namenode.getECSchemas();
+      return namenode.getErasureCodingPolicies();

UPD40 UPD5 UPD42 UPD43 UPD42 UPD43 UPD42 UPD42 UPD45 UPD42 UPD42 UPD43 UPD42 UPD42 UPD42 UPD42 UPD42 INS42 DEL42 DEL42 DEL32 DEL42 DEL39 DEL42 DEL44 DEL42