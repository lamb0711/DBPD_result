HDDS-461. Container remains in CLOSING state in SCM forever. Contributed by Shashikant Banerjee.

-import java.util.concurrent.CompletableFuture;
-  private void processReply(RaftClientReply reply) {
-
+  private void processReply(RaftClientReply reply) throws IOException {
-    // and will eventually be executed once the request comnes via the leader
+    // and will eventually be executed once the request comes via the leader
-      LOG.info(reply.getNotLeaderException().getLocalizedMessage());
+      throw notLeaderException;
-      // In case the request could not be completed, StateMachine Exception
-      // will be thrown. For now, Just log the message.
-      // If the container could not be closed, SCM will come to know
-      // via containerReports. CloseContainer should be re tried via SCM.
-      LOG.error(stateMachineException.getLocalizedMessage());
+      throw stateMachineException;
-  public void submitRequest(
-      ContainerCommandRequestProto request, HddsProtos.PipelineID pipelineID)
-      throws IOException {
-    // ReplicationLevel.MAJORITY ensures the transactions corresponding to
-    // the request here are applied on all the raft servers.
+  public void submitRequest(ContainerCommandRequestProto request,
+      HddsProtos.PipelineID pipelineID) throws IOException {
+    RaftClientReply reply;
-    CompletableFuture<RaftClientReply> reply =
-        server.submitClientRequestAsync(raftClientRequest);
-    reply.thenAccept(this::processReply);
+    try {
+      reply = server.submitClientRequestAsync(raftClientRequest).get();
+    } catch (Exception e) {
+      throw new IOException(e.getMessage(), e);
+    }
+    processReply(reply);

INS43 MOV60 INS42 INS54 INS21 MOV43 INS8 INS12 INS32 INS53 INS53 INS21 INS44 INS8 INS42 INS42 INS42 INS42 INS7 INS43 INS42 INS53 INS42 INS32 INS42 INS14 MOV32 INS42 INS43 INS32 INS42 INS42 INS42 INS42 DEL40 DEL26 DEL42 DEL42 DEL42 DEL42 DEL32 DEL42 DEL32 DEL32 DEL21 DEL42 DEL42 DEL42 DEL42 DEL32 DEL32 DEL21 DEL42 DEL43 DEL74 DEL42 DEL42 DEL52 DEL42 DEL90 DEL32 DEL21