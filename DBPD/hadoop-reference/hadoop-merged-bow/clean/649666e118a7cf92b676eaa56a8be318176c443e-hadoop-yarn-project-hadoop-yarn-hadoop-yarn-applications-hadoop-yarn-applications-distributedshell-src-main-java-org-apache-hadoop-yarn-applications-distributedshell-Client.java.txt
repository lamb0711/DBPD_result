YARN-9573. DistributedShell cannot specify LogAggregationContext. Contributed by Adam Antal.

+import org.apache.hadoop.yarn.api.records.LogAggregationContext;
-  private String log4jPropFile = "";	
+  private String log4jPropFile = "";
+  // rolling
+  private String rollingFilesPattern = "";
-      System.exit(0);			
+      System.exit(0);
+    opts.addOption("rolling_log_pattern", true,
+        "pattern for files that should be aggregated in a rolling fashion");
+    if (cliParser.hasOption("rolling_log_pattern")) {
+      rollingFilesPattern = cliParser.getOptionValue("rolling_log_pattern");
+    }
+
-    }		
+    }
-        + ", queueChildQueueCount=" + queueInfo.getChildQueues().size());		
+        + ", queueChildQueueCount=" + queueInfo.getChildQueues().size());
-            + ", queueName=" + aclInfo.getQueueName()			
+            + ", queueName=" + aclInfo.getQueueName()
-    }		
+    }
-    // In this scenario, the jar file for the application master is part of the local resources			
+    // In this scenario, the jar file for the application master is part of the local resources
-    // master as the application master does not need it. 		
+    // master as the application master does not need it.
-    // Add AppMaster.jar location to classpath 		
+    // Add AppMaster.jar location to classpath
-    commands.add(command.toString());		
+    commands.add(command.toString());
+    specifyLogAggregationContext(appContext);
+
+  @VisibleForTesting
+  void specifyLogAggregationContext(ApplicationSubmissionContext appContext) {
+    if (!rollingFilesPattern.isEmpty()) {
+      LogAggregationContext logAggregationContext = LogAggregationContext
+          .newInstance(null, null, rollingFilesPattern, "");
+      appContext.setLogAggregationContext(logAggregationContext);
+    }
+  }
+
-        }			  
+        }
-      else if (YarnApplicationState.KILLED == state	
+      else if (YarnApplicationState.KILLED == state
-    yarnClient.killApplication(appId);	
+    yarnClient.killApplication(appId);

INS26 INS40 INS23 INS31 INS83 INS43 INS59 INS78 INS39 INS42 INS44 INS8 INS42 INS42 INS45 INS21 INS25 INS21 INS42 INS43 INS42 INS25 INS32 INS32 INS8 INS32 INS42 INS38 INS8 INS42 INS42 INS45 INS9 INS45 INS42 INS42 INS45 INS21 INS42 INS42 INS32 INS60 INS21 INS7 INS42 INS42 INS43 INS59 INS32 INS42 INS32 INS42 INS42 INS32 INS42 INS42 INS42 INS42 INS42 INS45 INS42 INS42 INS33 INS33 INS42 INS45