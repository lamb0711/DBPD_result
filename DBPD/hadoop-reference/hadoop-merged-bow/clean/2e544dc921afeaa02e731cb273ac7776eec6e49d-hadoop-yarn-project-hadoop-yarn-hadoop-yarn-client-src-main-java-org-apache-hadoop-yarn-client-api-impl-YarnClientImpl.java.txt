YARN-9129. Ensure flush after printing to log plus additional cleanup. Contributed by Eric Yang

-        // Wait for Connect
-        // Send a message
-        session.getRemote().sendString("stty -echo");
-        session.getRemote().sendString("\r");
-        session.getRemote().flush();
-        socket.run();
+        if (session.isOpen()) {
+          socket.run();
+        }

INS25 INS32 INS8 MOV42 UPD42 MOV42 MOV21 DEL32 DEL42 DEL45 DEL32 DEL21 DEL42 DEL42 DEL32 DEL42 DEL45 DEL32 DEL21 DEL42 DEL42 DEL32 DEL42 DEL32 DEL21