YARN-7. Support CPU resource for DistributedShell. (Junping Du via llu)

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1531222 13f79535-47bb-0310-9956-ffa450edef68

+  // VirtualCores to request for the container on which the shell command will run
+  private int containerVirtualCores = 1;
+    opts.addOption("container_vcores", true,
+        "Amount of virtual cores to be requested to run the shell command");
+    containerVirtualCores = Integer.parseInt(cliParser.getOptionValue(
+        "container_vcores", "1"));
+    
+    int maxVCores = response.getMaximumResourceCapability().getVirtualCores();
+    LOG.info("Max vcores capabililty of resources in this cluster " + maxVCores);
+    if (containerVirtualCores > maxVCores) {
+      LOG.info("Container virtual cores specified above max threshold of cluster."
+          + " Using max value." + ", specified=" + containerVirtualCores + ", max="
+          + maxVCores);
+      containerVirtualCores = maxVCores;
+    }
+
-            + allocatedContainer.getResource().getMemory());
+            + allocatedContainer.getResource().getMemory()
+            + ", containerResourceVirtualCores"
+            + allocatedContainer.getResource().getVirtualCores());
-    // For now, only memory is supported so we set memory requirements
+    // For now, memory and CPU are supported so we set memory and cpu requirements
+    capability.setVirtualCores(containerVirtualCores);

INS23 INS83 INS39 INS59 INS42 INS34 INS21 INS21 INS60 INS21 INS25 INS21 INS32 INS7 INS39 INS59 INS32 INS27 INS8 INS32 INS42 INS42 INS45 INS9 INS45 INS42 INS32 INS42 INS32 INS42 INS42 INS27 INS42 INS42 INS21 INS21 INS42 INS42 INS42 INS42 INS42 INS32 INS32 INS42 INS45 INS42 INS32 INS7 INS42 INS42 INS45 INS45 INS42 INS42 INS42 INS42 INS27 INS42 INS42 INS27 INS42 INS45 INS42 INS45 INS45 INS45 INS45 INS32 INS32 INS42 INS42 INS42