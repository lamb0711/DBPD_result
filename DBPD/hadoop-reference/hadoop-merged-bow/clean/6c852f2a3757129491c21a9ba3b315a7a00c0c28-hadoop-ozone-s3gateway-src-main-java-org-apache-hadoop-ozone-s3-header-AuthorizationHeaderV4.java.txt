HDDS-892. Parse aws v2 headers without spaces in Ozone s3 gateway. Contributed by Elek Marton.

-    String[] split = authHeader.split(" ");
-
-    if (split.length != 4) {
+    int firstSep = authHeader.indexOf(' ');
+    if (firstSep < 0) {
-    algorithm = split[0];
-    credential = split[1];
-    signedHeaders = split[2];
-    signature = split[3];
+    //split the value parts of the authorization header
+    String[] split = authHeader.substring(firstSep + 1).trim().split(", *");
+    if (split.length != 3) {
+      throw S3ErrorTable.newError(S3ErrorTable.MALFORMED_HEADER, authHeader);
+    }
+
+    algorithm = authHeader.substring(0, firstSep);
+    credential = split[0];
+    signedHeaders = split[1];
+    signature = split[2];
-      credential = credential.substring(CREDENTIAL.length(), credential
-          .length() - 1);
+      credential = credential.substring(CREDENTIAL.length());
-      signedHeaders = signedHeaders.substring(SIGNEDHEADERS.length(),
-          signedHeaders.length() - 1);
+      signedHeaders = signedHeaders.substring(SIGNEDHEADERS.length());
-      signature = signature.substring(SIGNATURE.length(), signature
-          .length());
+      signature = signature.substring(SIGNATURE.length());

MOV60 MOV21 INS60 INS25 INS39 INS59 UPD27 INS27 INS8 INS42 INS32 INS42 UPD34 INS40 INS34 INS53 UPD42 INS32 UPD42 UPD42 UPD42 INS42 INS42 INS13 INS32 UPD45 INS32 INS42 INS42 INS34 INS42 INS32 INS42 INS42 INS42 INS40 INS42 MOV42 INS42 INS27 INS42 INS34 DEL40 DEL42 DEL34 DEL2 DEL42 DEL42 DEL32 DEL34 DEL27 DEL42 DEL42 DEL32 DEL34 DEL27 DEL42 DEL42 DEL32