Merge remote-tracking branch 'apache/trunk' into HDFS-7285

+    FSNamesystem fsn = fsd.getFSNamesystem();
-        fsd.getFSNamesystem().removeSnapshottableDirs(snapshottableDirs);
+        fsd.updateReplicationFactor(context.collectedBlocks()
+                                        .toUpdateReplicationInfo());
+        fsn.removeSnapshottableDirs(snapshottableDirs);

INS60 INS43 INS59 INS42 INS42 MOV32 INS21 INS32 INS42 INS42 INS32 INS42 INS32 INS42 INS42 INS42