HDFS-12387. Ozone: Support Ratis as a first class replication mechanism. Contributed by Anu Engineer.

+
+    //TODO : FIX ME : Pass the owner argument to this function.
+    // This causes a lot of test change and cblock change to filing
+    // another JIRA to fix it.
+    final OzoneProtos.Owner owner = OzoneProtos.Owner.OZONE;
-        replicationFactor, containerName).getPipeline();
+        replicationFactor, containerName, owner).getPipeline();
-   * Asks SCM where a block should be allocated. SCM responds with the set
-   * of datanodes and leader that should be used creating this block.
+   * Asks SCM where a block should be allocated. SCM responds with the set of
+   * datanodes that should be used creating this block.
-   * @return - allocated block accessing info (key, pipeline and leader).
+   * @param type - Replication type.
+   * @param factor
+   * @return allocated block accessing info (key, pipeline).
-  public AllocatedBlock allocateBlock(final long size) throws IOException {
-    return scmBlockManager.allocateBlock(size);
+  public AllocatedBlock allocateBlock(long size, OzoneProtos.ReplicationType
+      type, OzoneProtos.ReplicationFactor factor) throws IOException {
+    return scmBlockManager.allocateBlock(size, type, factor);
+

INS44 INS44 INS60 INS65 INS65 INS43 INS42 INS43 INS42 INS83 INS43 INS59 UPD66 UPD66 INS42 INS66 INS42 UPD66 INS40 INS40 INS40 INS42 INS40 INS42 INS42 INS42 DEL83