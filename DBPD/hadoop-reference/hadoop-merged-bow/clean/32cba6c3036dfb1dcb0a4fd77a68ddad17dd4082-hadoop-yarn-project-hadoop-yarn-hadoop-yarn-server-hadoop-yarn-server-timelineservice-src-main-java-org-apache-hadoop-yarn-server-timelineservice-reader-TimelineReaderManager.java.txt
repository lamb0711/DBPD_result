YARN-5355: YARN Timeline Service v.2: alpha 2 (varunsaxena)

-import com.google.common.annotations.VisibleForTesting;
-
-  @VisibleForTesting
-  public static final String UID_KEY = "UID";
-        entity.setUID(UID_KEY,
+        entity.setUID(TimelineReaderUtils.UID_KEY,
-        entity.setUID(UID_KEY,
+        entity.setUID(TimelineReaderUtils.UID_KEY,
-        entity.setUID(UID_KEY,
+        entity.setUID(TimelineReaderUtils.UID_KEY,
+    context.setEntityIdPrefix(entity.getIdPrefix());
-    entity.setUID(UID_KEY,
-        TimelineUIDConverter.GENERIC_ENTITY_UID.encodeUID(context));
+    if (context.getDoAsUser() != null) {
+      entity.setUID(TimelineReaderUtils.UID_KEY,
+          TimelineUIDConverter.SUB_APPLICATION_ENTITY_UID.encodeUID(context));
+    } else {
+      entity.setUID(TimelineReaderUtils.UID_KEY,
+          TimelineUIDConverter.GENERIC_ENTITY_UID.encodeUID(context));
+    }
+
+  /**
+   * Gets a list of available timeline entity types for an application. This can
+   * be done by making a call to the backend storage implementation. The meaning
+   * of each argument in detail is the same as {@link TimelineReader#getEntity}.
+   * If cluster ID has not been supplied by the client, fills the cluster id
+   * from config before making a call to backend storage.
+   *
+   * @param context Timeline context within the scope of which entity types
+   *                have to be fetched. Entity type field of this context should
+   *                be null.
+   * @return A set which contains available timeline entity types, represented
+   * as strings if found, empty otherwise.
+   * @throws IOException  if any problem occurs while getting entity types.
+   */
+  public Set<String> getEntityTypes(TimelineReaderContext context)
+      throws IOException{
+    context.setClusterId(getClusterID(context.getClusterId(), getConfig()));
+    return reader.getEntityTypes(new TimelineReaderContext(context));
+  }

INS31 INS29 INS83 INS74 INS42 INS44 INS43 INS8 INS21 INS25 INS65 INS65 INS65 INS65 INS43 MOV43 INS43 INS42 INS42 INS21 INS41 INS32 INS27 INS8 INS8 INS66 INS66 INS66 INS65 INS66 INS66 INS66 INS42 INS66 INS66 INS66 INS66 INS66 INS42 INS66 INS42 INS42 INS32 INS32 INS42 INS42 INS32 INS32 INS33 INS21 MOV21 INS67 INS42 INS42 INS32 INS42 INS42 INS14 INS42 INS42 INS42 INS42 INS32 INS42 INS42 INS42 INS32 INS32 INS43 INS42 INS42 INS42 INS40 INS32 INS40 INS42 INS42 INS42 INS42 INS40 INS40 INS40 INS40 INS42 INS42 DEL40 DEL26 DEL42 DEL78 DEL83 DEL83 DEL83 DEL42 DEL45 DEL59 DEL23 DEL42 DEL42 DEL42 DEL42