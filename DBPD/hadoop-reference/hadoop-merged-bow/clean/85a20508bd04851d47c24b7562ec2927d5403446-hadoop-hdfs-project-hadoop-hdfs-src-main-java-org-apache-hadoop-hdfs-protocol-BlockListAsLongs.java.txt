HDFS-10301. Interleaving processing of storages from repeated block reports causes false zombie storage detection, removes valid blocks. Contributed by Vinitha Gankidi.
+    @Override
+    public boolean isStorageReport() {
+      return false;
+    }
+  };
+
+  // STORAGE_REPORT is used to report all storages in the DN
+  public static final BlockListAsLongs STORAGE_REPORT = new BlockListAsLongs() {
+    @Override
+    public int getNumberOfBlocks() {
+      return -1;
+    }
+    @Override
+    public ByteString getBlocksBuffer() {
+      return ByteString.EMPTY;
+    }
+    @Override
+    public long[] getBlockListAsLongs() {
+      return EMPTY_LONGS;
+    }
+    @Override
+    public Iterator<BlockReportReplica> iterator() {
+      return Collections.emptyIterator();
+    }
+    @Override
+    public boolean isStorageReport() {
+      return true;
+    }
+   * Return true for STORAGE_REPORT BlocksListsAsLongs.
+   * Otherwise return false.
+   * @return boolean
+   */
+  abstract public boolean isStorageReport();
+
+  /**
+    public boolean isStorageReport() {
+      return false;
+    }
+
+    @Override
+    public boolean isStorageReport() {
+      return false;
+    }
+
+    @Override

INS23 INS31 INS83 INS83 INS83 INS43 INS59 INS29 INS83 INS83 INS39 INS42 INS31 INS31 INS42 INS42 INS14 INS65 INS65 INS78 INS83 INS39 INS42 INS8 INS78 INS83 INS39 INS42 INS8 INS43 INS1 INS66 INS66 INS66 INS42 INS41 INS42 INS41 INS31 INS42 INS31 INS31 INS31 INS31 INS31 INS9 INS9 INS78 INS83 INS39 INS42 INS8 INS78 INS83 INS39 INS42 INS8 INS78 INS83 INS43 INS42 INS8 INS78 INS83 INS5 INS42 INS8 INS78 INS83 INS74 INS42 INS8 INS78 INS83 INS39 INS42 INS8 INS42 INS41 INS42 INS41 INS42 INS42 INS41 INS42 INS39 INS85 INS41 INS42 INS43 INS43 INS41 INS42 INS41 INS9 INS38 INS40 INS42 INS42 INS42 INS32 INS9 INS34 INS42 INS42