HDFS-13307. RBF: Improve the use of setQuota command. Contributed by liuhongtong.

-          System.err.println("Cannot parse nsQuota: " + parameters[i]);
+          throw new IllegalArgumentException(
+              "Cannot parse nsQuota: " + parameters[i]);
-          System.err.println("Cannot parse ssQuota: " + parameters[i]);
+          throw new IllegalArgumentException(
+              "Cannot parse ssQuota: " + parameters[i]);
-      System.err.println("Input quota value should be a positive number.");
-      return false;
+      throw new IllegalArgumentException(
+          "Input quota value should be a positive number.");
+    }
+
+    if (nsQuota == HdfsConstants.QUOTA_DONT_SET &&
+        ssQuota == HdfsConstants.QUOTA_DONT_SET) {
+      throw new IllegalArgumentException(
+          "Must specify at least one of -nsQuota and -ssQuota.");
-      return false;
+      throw new IOException(mount + " doesn't exist in mount table.");
-      // If nsQuota or ssQuota was unset, reset corresponding usage
-      // value to zero.
-      if (nsQuota == HdfsConstants.QUOTA_DONT_SET) {
+      // If nsQuota and ssQuota were unset, clear nsQuota and ssQuota.
+      if (nsQuota == HdfsConstants.QUOTA_DONT_SET &&
+          ssQuota == HdfsConstants.QUOTA_DONT_SET) {
-      }
-
-      if (nsQuota == HdfsConstants.QUOTA_DONT_SET) {
+      } else {
+        // If nsQuota or ssQuota was unset, use the value in mount table.
+        if (nsQuota == HdfsConstants.QUOTA_DONT_SET) {
+          nsQuota = existingEntry.getQuota().getQuota();
+        }
+        if (ssQuota == HdfsConstants.QUOTA_DONT_SET) {
+          ssQuota = existingEntry.getQuota().getSpaceQuota();
+        }

INS25 INS27 INS8 INS53 INS27 INS27 INS53 INS53 INS25 INS14 INS42 INS40 INS42 INS40 INS14 INS14 INS27 MOV8 INS8 INS43 INS45 INS43 INS45 INS43 INS27 MOV27 INS27 INS21 MOV25 MOV25 INS42 INS42 INS42 INS42 INS45 INS42 INS40 INS7 INS8 INS27 INS42 MOV40 INS21 INS42 INS40 INS53 INS7 INS14 INS53 INS42 INS32 UPD42 INS32 INS43 MOV27 INS14 INS32 INS42 INS32 INS42 INS42 INS43 MOV27 INS42 INS42 INS42 INS42 INS42 DEL40 DEL42 DEL32 DEL21 DEL40 DEL42 DEL32 DEL21 DEL40 DEL42 DEL45 DEL32 DEL21 DEL9 DEL41 DEL9 DEL41