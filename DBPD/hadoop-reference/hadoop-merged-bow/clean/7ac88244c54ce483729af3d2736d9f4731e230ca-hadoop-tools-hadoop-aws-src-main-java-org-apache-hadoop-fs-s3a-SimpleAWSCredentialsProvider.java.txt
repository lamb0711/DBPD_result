HADOOP-14507. Extend per-bucket secret key config with explicit getPassword() on fs.s3a.$bucket.secret.key.
Contributed by Steve Loughran.

+import java.net.URI;
-  public SimpleAWSCredentialsProvider(Configuration conf) {
+  public SimpleAWSCredentialsProvider(URI uri, Configuration conf) {
+      String bucket = uri != null ? uri.getHost() : "";
-      this.accessKey = S3AUtils.lookupPassword(c, ACCESS_KEY, null);
-      this.secretKey = S3AUtils.lookupPassword(c, SECRET_KEY, null);
+      this.accessKey = S3AUtils.lookupPassword(bucket, c, ACCESS_KEY, null);
+      this.secretKey = S3AUtils.lookupPassword(bucket, c, SECRET_KEY, null);
-        "Access key, secret key or session token is unset");
+        "Access key or secret key is unset");

INS26 INS40 INS44 INS43 INS42 INS42 INS60 UPD45 INS43 INS59 INS42 INS42 INS16 INS27 INS32 INS45 INS42 INS42 INS42 INS33 INS42 INS42