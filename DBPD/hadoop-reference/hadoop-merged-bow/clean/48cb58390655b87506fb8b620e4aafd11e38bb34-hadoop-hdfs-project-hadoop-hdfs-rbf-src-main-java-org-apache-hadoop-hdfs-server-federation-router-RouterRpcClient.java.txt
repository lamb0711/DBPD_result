HDFS-14710. RBF: Improve some RPC performance by using previous block. Contributed by xuzq.

+   * Invokes a remote method against the specified extendedBlock.
+   *
+   * Re-throws exceptions generated by the remote RPC call as either
+   * RemoteException or IOException.
+   *
+   * @param <T> The type of the remote method return.
+   * @param extendedBlock Target extendedBlock for the method.
+   * @param method The remote method and parameters to invoke.
+   * @param clazz Class for the return type.
+   * @return The result of invoking the method.
+   * @throws IOException If the invoke generated an error.
+   */
+  public <T> T invokeSingle(final ExtendedBlock extendedBlock,
+      RemoteMethod method, Class<T> clazz) throws IOException {
+    String nsId = getNameserviceForBlockPoolId(extendedBlock.getBlockPoolId());
+    @SuppressWarnings("unchecked")
+    T ret = (T)invokeSingle(nsId, method);
+    return ret;
+  }
+
+  /**
-  public Object invokeSingle(final RemoteLocationContext location,
-      RemoteMethod remoteMethod) throws IOException {
+  public <T> T invokeSingle(final RemoteLocationContext location,
+      RemoteMethod remoteMethod, Class<T> clazz) throws IOException {
-    return invokeSequential(locations, remoteMethod);
+    @SuppressWarnings("unchecked")
+    T ret = (T)invokeSequential(locations, remoteMethod);
+    return ret;

INS31 INS29 INS83 INS73 INS43 INS42 INS44 INS44 INS44 INS43 INS8 INS73 UPD43 INS44 INS65 INS65 INS65 INS65 INS65 INS65 INS65 INS42 INS42 INS83 INS43 INS42 INS43 INS42 INS74 INS42 INS42 INS60 INS60 INS41 INS42 UPD42 INS74 INS42 INS60 INS66 INS66 INS66 INS66 INS42 INS66 INS66 INS42 INS66 INS42 INS66 INS42 INS66 INS66 INS42 INS66 INS42 INS42 INS43 INS43 INS43 INS59 INS79 INS43 INS59 INS42 INS43 INS43 INS79 INS43 INS59 INS42 INS42 INS42 INS42 INS42 INS32 INS42 INS45 INS42 INS42 INS11 INS42 INS42 INS42 INS45 INS42 INS42 INS11 INS42 INS32 INS43 INS32 INS43 MOV32 INS42 INS42 INS42 INS42 INS42 INS42 INS42