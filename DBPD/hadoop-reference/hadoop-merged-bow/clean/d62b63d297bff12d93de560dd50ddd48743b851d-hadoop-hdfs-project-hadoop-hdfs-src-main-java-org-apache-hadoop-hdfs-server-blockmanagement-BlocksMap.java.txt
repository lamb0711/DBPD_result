HDFS-8652. Track BlockInfo instead of Block in CorruptReplicasMap. Contributed by Jing Zhao.

-  void removeBlock(Block block) {
+  void removeBlock(BlockInfo block) {
-    if (info.getDatanode(0) == null     // no datanodes left
+    if (info.hasEmptyStorage()     // no datanodes left

UPD43 UPD42 MOV32 UPD42 DEL34 DEL33 DEL27