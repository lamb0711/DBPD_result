YARN-759. Create Command enum in AllocateResponse (bikas)

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1490470 13f79535-47bb-0310-9956-ffa450edef68

-        if (response.getResync()) {
-          handler.onRebootRequest();
-          LOG.info("Reboot requested. Stopping callback.");
-          break;
+        if (response.getAMCommand() != null) {
+          boolean stop = false;
+          switch(response.getAMCommand()) {
+          case AM_RESYNC:
+          case AM_SHUTDOWN:
+            handler.onShutdownRequest();
+            LOG.info("Shutdown requested. Stopping callback.");
+            stop = true;
+            break;
+          default:
+            String msg =
+                  "Unhandled value of AMCommand: " + response.getAMCommand();
+            LOG.error(msg);
+            throw new YarnRuntimeException(msg);
+          }
+          if(stop) {
+            // should probably stop heartbeating also YARN-763
+            break;
+          }
-     * Called when the ResourceManager wants the ApplicationMaster to reboot
-     * for being out of sync. The ApplicationMaster should not unregister with 
-     * the RM unless the ApplicationMaster wants to be the last attempt.
+     * Called when the ResourceManager wants the ApplicationMaster to shutdown
+     * for being out of sync etc. The ApplicationMaster should not unregister
+     * with the RM unless the ApplicationMaster wants to be the last attempt.
-    public void onRebootRequest();
+    public void onShutdownRequest();

UPD42 UPD66 UPD66 UPD66 INS27 INS32 INS33 INS60 INS50 INS25 MOV42 UPD42 MOV42 INS39 INS59 INS32 INS49 INS49 INS21 INS21 INS21 INS10 INS49 INS60 INS21 INS53 INS42 INS8 INS42 INS9 INS42 INS42 INS42 INS42 MOV32 MOV32 INS7 INS43 INS59 INS32 INS14 INS10 UPD42 UPD45 INS42 INS9 INS42 INS42 INS27 INS42 INS42 INS42 INS43 INS42 INS45 INS32 INS42 INS42 INS42 DEL32 DEL21 DEL21 DEL10