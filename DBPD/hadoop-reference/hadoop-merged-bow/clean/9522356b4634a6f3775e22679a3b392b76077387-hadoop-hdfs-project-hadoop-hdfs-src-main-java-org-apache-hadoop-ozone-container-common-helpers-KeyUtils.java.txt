HDFS-12069. Ozone: Create a general abstraction for metadata store. Contributed by Weiwei Yang.

-import org.apache.hadoop.utils.LevelDBStore;
+import org.apache.hadoop.utils.MetadataStore;
+import org.apache.hadoop.utils.MetadataStoreBuilder;
-   * @return LevelDB handle.
+   * @return MetadataStore handle.
-  public static LevelDBStore getDB(ContainerData container,
+  public static MetadataStore getDB(ContainerData container,
-      LevelDBStore db = cache.getDB(container.getContainerName());
+      MetadataStore db = cache.getDB(container.getContainerName());
-        db = new LevelDBStore(
-            new File(container.getDBPath()),
-            false);
+        db = MetadataStoreBuilder.newBuilder()
+            .setDbFile(new File(container.getDBPath()))
+            .setCreateIfMissing(false)
+            .build();
-    LevelDBStore[] handles = new LevelDBStore[cache.values().size()];
+    MetadataStore[] handles = new MetadataStore[cache.values().size()];
-    for (LevelDBStore db : handles) {
+    for (MetadataStore db : handles) {

INS26 UPD40 INS40 UPD43 UPD42 UPD66 UPD5 UPD43 UPD43 UPD43 UPD42 UPD5 UPD42 UPD42 UPD43 UPD42 INS32 INS32 INS42 INS32 INS42 INS9 INS32 INS42 MOV14 INS42 INS42 DEL42 DEL43 DEL9 DEL14