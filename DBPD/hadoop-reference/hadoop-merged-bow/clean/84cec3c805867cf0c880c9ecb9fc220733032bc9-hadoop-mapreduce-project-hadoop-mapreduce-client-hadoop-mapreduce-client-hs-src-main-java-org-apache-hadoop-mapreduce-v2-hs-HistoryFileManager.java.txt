MAPREDUCE-4680. Job history cleaner should only check timestamps of files in old enough directories (Robert Kanter via Sandy Ryza)

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1536558 13f79535-47bb-0310-9956-ffa450edef68

+  List<FileStatus> getHistoryDirsForCleaning(long cutoff) throws IOException {
+      return JobHistoryUtils.
+        getHistoryDirsForCleaning(doneDirFc, doneDirPrefixPath, cutoff);
+  }
+
-    // TODO this should be replaced by something that knows about the directory
-    // structure and will put less of a load on HDFS.
-    // TODO Delete YYYY/MM/DD directories.
-    List<FileStatus> serialDirList = findTimestampedDirectories();
+    List<FileStatus> serialDirList = getHistoryDirsForCleaning(cutoff);

INS31 INS74 INS42 INS44 INS43 INS8 INS43 INS43 INS39 INS42 INS42 INS41 INS42 INS42 INS32 INS42 INS42 INS42 INS42 INS42 UPD42 INS42