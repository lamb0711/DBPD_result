HDFS-7435. PB encoding of block reports is very inefficient. Contributed by Daryn Sharp.

-    register();
+    register(nsInfo);
-      reports[i++] = new StorageBlockReport(
-          kvPair.getKey(), blockList.getBlockListAsLongs());
+      reports[i++] = new StorageBlockReport(kvPair.getKey(), blockList);
+   * @param nsInfo current NamespaceInfo
-  void register() throws IOException {
+  void register(NamespaceInfo nsInfo) throws IOException {
+        bpRegistration.setNamespaceInfo(nsInfo);
-      retrieveNamespaceInfo();
+      NamespaceInfo nsInfo = retrieveNamespaceInfo();
-      register();
+      register(nsInfo);

INS44 INS65 INS43 INS42 INS42 INS66 INS42 INS42 INS60 INS43 INS59 INS21 INS42 INS42 INS32 INS42 INS42 INS32 MOV42 INS42 INS42 INS42 DEL42 DEL42 DEL32 DEL32 DEL21