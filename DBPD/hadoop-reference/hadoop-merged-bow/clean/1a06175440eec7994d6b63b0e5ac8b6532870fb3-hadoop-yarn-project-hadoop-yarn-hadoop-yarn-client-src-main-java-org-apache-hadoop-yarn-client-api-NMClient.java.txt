YARN-851. Share NMTokens using NMTokenCache (api-based) between AMRMClient and NMClient instead of memory based approach which is used currently. Contributed by Omkar Vinit Joshi.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1495247 13f79535-47bb-0310-9956-ffa450edef68

-import java.util.concurrent.ConcurrentMap;
-import org.apache.hadoop.yarn.api.protocolrecords.AllocateResponse;
-import org.apache.hadoop.yarn.api.records.NMToken;
-import org.apache.hadoop.yarn.api.records.Token;
-   * @param nmTokens need to pass map of NMTokens which are received on
-   * {@link AMRMClient#allocate(float)} call as a part of
-   * {@link AllocateResponse}. 
-   * key :- NodeAddr (host:port)
-   * Value :- Token {@link NMToken#getToken()}
-  public static NMClient createNMClient(ConcurrentMap<String, Token> nmTokens) {
-    NMClient client = new NMClientImpl(nmTokens);
+  public static NMClient createNMClient() {
+    NMClient client = new NMClientImpl();
-   * @param nmTokens need to pass map of NMTokens which are received on
-   * {@link AMRMClient#allocate(float)} call as a part of
-   * {@link AllocateResponse}. 
-   * key :- NodeAddr (host:port)
-   * Value :- Token {@link NMToken#getToken()}
-  public static NMClient createNMClient(String name,
-      ConcurrentMap<String, Token> nmTokens) {
-    NMClient client = new NMClientImpl(name, nmTokens);
+  public static NMClient createNMClient(String name) {
+    NMClient client = new NMClientImpl(name);

MOV8 MOV8 UPD42 DEL40 DEL26 DEL40 DEL26 DEL40 DEL26 DEL40 DEL26 DEL42 DEL66 DEL42 DEL42 DEL39 DEL69 DEL68 DEL65 DEL66 DEL42 DEL65 DEL66 DEL66 DEL66 DEL42 DEL42 DEL68 DEL65 DEL65 DEL42 DEL42 DEL42 DEL43 DEL42 DEL43 DEL42 DEL43 DEL74 DEL42 DEL44 DEL42 DEL66 DEL42 DEL42 DEL39 DEL69 DEL68 DEL65 DEL66 DEL42 DEL65 DEL66 DEL66 DEL66 DEL42 DEL42 DEL68 DEL65 DEL65 DEL42 DEL43 DEL42 DEL43 DEL42 DEL43 DEL74 DEL42 DEL44