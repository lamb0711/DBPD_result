HDFS-7979. Initialize block report IDs with a random number.

+  private long prevBlockReportId;
+    prevBlockReportId = DFSUtil.getRandom().nextLong();
-  private long prevBlockReportId = 0;
-
-    long id = System.nanoTime();
-    if (id <= prevBlockReportId) {
-      id = prevBlockReportId + 1;
+    // Initialize the block report ID the first time through.
+    // Note that 0 is used on the NN to indicate "uninitialized", so we should
+    // not send a 0 value ourselves.
+    prevBlockReportId++;
+    while (prevBlockReportId == 0) {
+      prevBlockReportId = DFSUtil.getRandom().nextLong();
-    prevBlockReportId = id;
-    return id;
+    return prevBlockReportId;

MOV23 INS21 INS21 INS61 INS7 INS37 INS27 INS8 UPD42 INS42 INS32 INS42 MOV42 UPD34 MOV34 MOV21 INS32 INS42 INS42 INS42 INS32 INS32 INS42 INS42 INS42 DEL34 DEL42 DEL39 DEL42 DEL42 DEL42 DEL32 DEL59 DEL60 DEL42 DEL42 DEL27 DEL42 DEL27 DEL7 DEL21 DEL8 DEL25