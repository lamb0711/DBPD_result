YARN-3100. Made YARN authorization pluggable. Contributed by Jian He.

+import org.apache.hadoop.yarn.security.ConfiguredYarnAuthorizer;
+import org.apache.hadoop.yarn.security.YarnAuthorizationProvider;
-  private AccessControlList adminAcl;
+
+  private YarnAuthorizationProvider authorizer;
-
-    adminAcl = new AccessControlList(conf.get(
-        YarnConfiguration.YARN_ADMIN_ACL,
-        YarnConfiguration.DEFAULT_YARN_ADMIN_ACL));
+    authorizer = YarnAuthorizationProvider.getInstance(conf);
+    authorizer.setAdmins(new AccessControlList(conf.get(
+      YarnConfiguration.YARN_ADMIN_ACL,
+        YarnConfiguration.DEFAULT_YARN_ADMIN_ACL)), UserGroupInformation
+        .getCurrentUser());
-    return RMServerUtils.verifyAccess(adminAcl, method, LOG);
+    return RMServerUtils.verifyAdminAccess(authorizer, method, LOG);
-          adminAcl.toString(), "RMHAProtocolService",
+          "", "RMHAProtocolService",
-          adminAcl.toString(), "RMHAProtocolService",
+          "", "RMHAProtocolService",
-    adminAcl = new AccessControlList(conf.get(
-        YarnConfiguration.YARN_ADMIN_ACL,
-        YarnConfiguration.DEFAULT_YARN_ADMIN_ACL));
+    authorizer.setAdmins(new AccessControlList(conf.get(
+      YarnConfiguration.YARN_ADMIN_ACL,
+        YarnConfiguration.DEFAULT_YARN_ADMIN_ACL)), UserGroupInformation
+        .getCurrentUser());
+  // only for testing
-    return this.adminAcl;
+    return ((ConfiguredYarnAuthorizer)authorizer).getAdminAcls();
-      RMAuditLogger.logFailure(user, argName, adminAcl.toString(), 
+      RMAuditLogger.logFailure(user, argName, "", 
-    RMAuditLogger.logFailure(user, argName, adminAcl.toString(), 
+    RMAuditLogger.logFailure(user, argName, "", 

INS26 INS26 INS40 INS40 UPD43 UPD42 UPD42 INS21 INS7 INS32 INS32 INS32 INS42 INS32 INS42 INS42 MOV14 INS32 UPD42 UPD42 INS42 INS42 MOV14 INS32 INS36 INS42 INS45 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS11 INS43 INS42 INS45 INS45 INS45 INS42 DEL42 DEL7 DEL42 DEL42 DEL32 DEL42 DEL42 DEL32 DEL42 DEL7 DEL52 DEL42 DEL22 DEL42 DEL42 DEL32 DEL42 DEL42 DEL32