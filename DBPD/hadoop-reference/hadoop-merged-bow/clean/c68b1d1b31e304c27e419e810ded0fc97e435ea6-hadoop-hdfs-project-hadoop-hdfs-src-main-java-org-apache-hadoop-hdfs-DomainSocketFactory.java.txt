HDFS-4914. Use DFSClient.Conf instead of Configuration.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1494854 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.commons.logging.LogFactory;
+import org.apache.hadoop.HadoopIllegalArgumentException;
-
-  public static final Log LOG = LogFactory.getLog(DomainSocketFactory.class);
+  private static final Log LOG = BlockReaderLocal.LOG;
-    String feature = null;
+    final String feature;
+    } else {
+      feature = null;
-    if (feature != null) {
+
+    if (feature == null) {
+      LOG.debug("Both short-circuit local reads and UNIX domain socket are disabled.");
+    } else {
-        LOG.warn(feature + " is disabled because you have not set " +
-            DFSConfigKeys.DFS_DOMAIN_SOCKET_PATH_KEY);
+        throw new HadoopIllegalArgumentException(feature + " is enabled but "
+            + DFSConfigKeys.DFS_DOMAIN_SOCKET_PATH_KEY + " is not set.");
-        LOG.warn(feature + " is disabled because " +
-              DomainSocket.getLoadingFailureReason());
+        LOG.warn(feature + " cannot be used because "
+            + DomainSocket.getLoadingFailureReason());
-        LOG.debug(feature + "is enabled.");
+        LOG.debug(feature + " is enabled.");
-    if ((conf.domainSocketDataTraffic == false) &&
-        ((!conf.shortCircuitLocalReads) || conf.useLegacyBlockReaderLocal)) {
+    if (!conf.domainSocketDataTraffic &&
+        (!conf.shortCircuitLocalReads || conf.useLegacyBlockReaderLocal)) {

UPD40 UPD83 INS40 INS83 UPD27 INS8 UPD27 MOV27 INS8 INS21 INS38 INS21 INS32 INS40 INS27 INS7 INS42 INS42 INS45 INS53 MOV38 INS40 INS42 INS33 INS14 INS43 INS27 INS42 MOV42 UPD45 MOV45 MOV40 INS45 UPD45 UPD45 DEL42 DEL42 DEL42 DEL43 DEL57 DEL32 DEL33 DEL42 DEL42 DEL27 DEL32 DEL21 DEL40 DEL40 DEL9 DEL27 DEL36 DEL36 DEL27