HDDS-1104. Use picocli with Ozone genesis tool. Contributed by Lokesh Jain.

-import org.openjdk.jmh.runner.options.Options;
+import picocli.CommandLine;
+import picocli.CommandLine.Option;
+import picocli.CommandLine.Command;
+@Command(name = "ozone genesis",
+    description = "Tool for running ozone benchmarks",
+    mixinStandardHelpOptions = true)
+  // For adding benchmark to Genesis add the benchmark name in the default value
+  // and description for this option.
+  @Option(names = "-benchmark", required = true, split = ",",
+      defaultValue = "BenchMarkContainerStateMap,BenchMarkOMKeyAllocation,"
+          + "BenchMarkBlockManager,BenchMarkMetadataStoreReads,"
+          + "BenchMarkMetadataStoreWrites,BenchMarkDatanodeDispatcher"
+          + "BenchMarkRocksDbStore",
+      description =
+      "Option used for specifying benchmarks to run.\n"
+          + "Ex. ozone genesis -benchmark BenchMarkContainerStateMap,"
+          + "BenchMarkOMKeyAllocation.\n"
+          + "Possible benchmarks which can be used are "
+          + "{BenchMarkContainerStateMap, BenchMarkOMKeyAllocation, "
+          + "BenchMarkBlockManager, BenchMarkMetadataStoreReads, "
+          + "BenchMarkMetadataStoreWrites, BenchMarkDatanodeDispatcher, "
+          + "BenchMarkRocksDbStore}")
+  private static String[] benchmarks;
+
+  @Option(names = "-t", defaultValue = "4",
+      description = "Number of threads to use for the benchmark.\n"
+          + "This option can be overridden by threads mentioned in benchmark.")
+  private static int numThreads;
+
-    Options opt = new OptionsBuilder()
-        .include(BenchMarkContainerStateMap.class.getSimpleName())
-        .include(BenchMarkOMKeyAllocation.class.getSimpleName())
-        .include(BenchMarkBlockManager.class.getSimpleName())
-//        .include(BenchMarkMetadataStoreReads.class.getSimpleName())
-//        .include(BenchMarkMetadataStoreWrites.class.getSimpleName())
-//        .include(BenchMarkDatanodeDispatcher.class.getSimpleName())
-// Commenting this test out, till we support either a command line or a config
-        // file based ability to run tests.
-//        .include(BenchMarkRocksDbStore.class.getSimpleName())
-        .warmupIterations(5)
+    CommandLine commandLine = new CommandLine(new Genesis());
+    commandLine.parse(args);
+    if (commandLine.isUsageHelpRequested()) {
+      commandLine.usage(System.out);
+      return;
+    }
+
+    OptionsBuilder optionsBuilder = new OptionsBuilder();
+    for (String benchmark : benchmarks) {
+      optionsBuilder.include(benchmark);
+    }
+    optionsBuilder.warmupIterations(2)
-        .build();
+        .threads(numThreads);
-    new Runner(opt).run();
+    new Runner(optionsBuilder.build()).run();

MOV26 INS26 INS26 INS40 UPD40 INS40 INS77 INS23 INS23 INS42 INS80 INS80 INS80 INS77 INS83 INS83 INS5 INS59 INS77 INS83 INS83 INS39 INS59 INS42 INS45 INS42 INS45 INS42 INS9 INS42 INS80 INS80 INS80 INS80 INS80 INS43 INS85 INS42 INS42 INS80 INS80 INS80 INS42 INS60 INS21 INS25 INS60 INS70 INS21 INS42 INS45 INS42 INS9 INS42 INS45 INS42 INS27 INS42 INS27 INS42 INS42 INS45 INS42 INS45 INS42 INS27 INS43 INS59 INS32 INS32 INS8 INS43 INS59 INS44 INS42 INS8 INS32 INS45 INS45 INS45 INS45 INS45 INS45 INS45 INS45 INS45 INS45 INS45 INS45 INS45 INS45 INS42 INS42 INS14 INS42 UPD42 MOV42 INS42 INS42 UPD42 MOV42 INS21 INS41 UPD42 MOV42 INS42 MOV14 INS43 INS42 INS21 INS32 UPD42 MOV42 INS42 INS43 INS14 INS32 INS42 INS32 INS32 MOV42 MOV34 INS32 INS42 INS43 INS42 UPD42 MOV42 INS40 INS42 UPD42 MOV42 INS42 INS32 MOV42 MOV9 INS42 INS42 UPD42 MOV42 INS32 MOV42 MOV57 INS32 MOV42 MOV34 INS42 MOV42 UPD34 MOV34 DEL43 DEL42 DEL42 DEL43 DEL57 DEL32 DEL32 DEL43 DEL57 DEL42 DEL32 DEL32 DEL42 DEL42 DEL43 DEL57 DEL32 DEL32 DEL32 DEL32 DEL32 DEL32 DEL32 DEL32 DEL59 DEL60 DEL42