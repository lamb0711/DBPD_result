MAPREDUCE-6284. Add Task Attempt State API to MapReduce Application Master REST API. Contributed by Ryu Kobayashi.

-import java.util.Set;
-import java.util.HashSet;
-import java.util.Arrays;
+import java.util.HashMap;
+import java.util.Map;
+import org.apache.hadoop.mapreduce.v2.app.webapp.dao.JobTaskAttemptState;
-  private JAXBContext context;
-  private final Set<Class> types;
+  private final Map<Class, JAXBContext> typesContextMap;
+  // these dao classes need root unwrapping
+  private final Class[] rootUnwrappedTypes = {JobTaskAttemptState.class};
+
-    this.types = new HashSet<Class>(Arrays.asList(cTypes));
-    this.context = new JSONJAXBContext(JSONConfiguration.natural().
-        rootUnwrapping(false).build(), cTypes);
+    JAXBContext context;
+    JAXBContext unWrappedRootContext;
+
+    this.typesContextMap = new HashMap<Class, JAXBContext>();
+    context =
+        new JSONJAXBContext(JSONConfiguration.natural().rootUnwrapping(false)
+            .build(), cTypes);
+    unWrappedRootContext =
+        new JSONJAXBContext(JSONConfiguration.natural().rootUnwrapping(true)
+            .build(), rootUnwrappedTypes);
+    for (Class type : cTypes) {
+      typesContextMap.put(type, context);
+    }
+    for (Class type : rootUnwrappedTypes) {
+      typesContextMap.put(type, unWrappedRootContext);
+    }
-    return (types.contains(objectType)) ? context : null;
+    return typesContextMap.get(objectType);

MOV26 MOV23 UPD40 UPD40 UPD40 INS83 INS74 INS59 INS5 INS43 MOV43 INS43 INS42 INS43 INS85 UPD42 INS4 INS60 INS60 INS21 INS21 INS70 INS70 INS42 INS42 UPD42 MOV42 INS57 MOV43 MOV59 INS43 INS59 INS7 INS7 INS44 INS42 INS8 INS44 INS42 INS8 INS32 INS43 INS42 INS42 MOV22 INS14 INS42 INS42 INS14 INS43 INS42 INS21 INS43 INS42 INS21 UPD42 MOV42 UPD42 MOV42 MOV42 INS42 UPD42 UPD74 MOV74 INS43 INS32 INS42 INS42 INS32 INS42 INS32 UPD43 INS43 INS42 INS32 INS42 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 INS42 INS42 INS42 INS42 INS42 UPD42 INS42 INS32 INS42 INS9 INS42 INS42 DEL43 DEL74 DEL32 DEL14 DEL7 DEL21 DEL52 DEL42 DEL22 DEL32 DEL36 DEL42 DEL33 DEL16