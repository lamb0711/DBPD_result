YARN-4700. ATS storage has one extra record each time the RM got restarted. (Naganarasimha G R via Varun Saxena)

+import java.util.Map.Entry;
-import java.util.Map.Entry;
-   * get the time at which an app finished.
-   *
-   * @param te TimelineEntity object.
-   * @return true if application has finished else false
-   */
-  public static long getApplicationFinishedTime(TimelineEntity te) {
-    SortedSet<TimelineEvent> allEvents = te.getEvents();
-    if ((allEvents != null) && (allEvents.size() > 0)) {
-      TimelineEvent event = allEvents.last();
-      if (event.getId().equals(
-          ApplicationMetricsConstants.FINISHED_EVENT_TYPE)) {
-        return event.getTimestamp();
-      }
-    }
-    return 0L;
-  }
-
-  /**
-   * Checks for the APPLICATION_CREATED event.
-   *
-   * @return true is application event exists, false otherwise
+   * @param eventId event with this id needs to be fetched
+   * @return TimelineEvent if TimelineEntity contains the desired event.
-  public static boolean isApplicationCreated(TimelineEntity te) {
+  public static TimelineEvent getApplicationEvent(TimelineEntity te,
+      String eventId) {
-        if (event.getId()
-            .equals(ApplicationMetricsConstants.CREATED_EVENT_TYPE)) {
-          return true;
+        if (event.getId().equals(eventId)) {
+          return event;
-    return false;
+    return null;

MOV26 INS31 MOV29 MOV65 MOV83 MOV83 MOV43 UPD42 MOV42 MOV44 MOV44 MOV8 UPD65 UPD43 UPD42 INS42 UPD66 UPD66 UPD42 INS33 MOV8 INS42 INS42 DEL39 DEL42 DEL43 DEL74 DEL42 DEL42 DEL42 DEL32 DEL59 DEL60 DEL42 DEL33 DEL27 DEL36 DEL42 DEL42 DEL32 DEL34 DEL27 DEL36 DEL27 DEL25 DEL34 DEL41 DEL8 DEL31 DEL42 DEL43 DEL42 DEL42 DEL42 DEL32 DEL59 DEL60 DEL40 DEL42 DEL42 DEL32 DEL42 DEL42 DEL32 DEL42 DEL40 DEL32 DEL9 DEL41 DEL8 DEL25 DEL8 DEL9 DEL66 DEL65 DEL42 DEL66 DEL65 DEL66 DEL65 DEL29 DEL83 DEL83 DEL39 DEL42 DEL31