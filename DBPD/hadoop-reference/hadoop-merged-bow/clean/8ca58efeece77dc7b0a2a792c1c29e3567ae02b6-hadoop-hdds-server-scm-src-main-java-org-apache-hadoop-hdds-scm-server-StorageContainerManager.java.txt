HDDS-1490. Support configurable container placement policy through 'oâ€¦ (#903)


+import org.apache.hadoop.hdds.scm.container.placement.algorithms.ContainerPlacementPolicyFactory;
+import org.apache.hadoop.hdds.scm.net.NetworkTopology;
+import org.apache.hadoop.hdds.scm.net.NetworkTopologyImpl;
-import org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementCapacity;
+   *  Network topology Map.
+   */
+  private NetworkTopology clusterMap;
+
+  /**
-
-    initalizeSystemManagers(conf, configurator);
+    initializeSystemManagers(conf, configurator);
-  private void initalizeSystemManagers(OzoneConfiguration conf,
+  private void initializeSystemManagers(OzoneConfiguration conf,
-    //TODO: support configurable containerPlacement policy
+    clusterMap = new NetworkTopologyImpl(conf);
-        new SCMContainerPlacementCapacity(scmNodeManager, conf);
+        ContainerPlacementPolicyFactory.getPolicy(conf, scmNodeManager,
+            clusterMap, true);
-

MOV26 INS26 INS26 UPD40 INS40 INS40 INS23 INS29 INS83 INS43 INS59 UPD42 INS65 INS42 INS42 INS21 INS66 INS7 UPD42 INS42 INS14 INS32 INS43 INS42 INS42 INS42 INS42 INS42 INS42 INS9 INS42 DEL42 DEL43 DEL42 DEL42 DEL14