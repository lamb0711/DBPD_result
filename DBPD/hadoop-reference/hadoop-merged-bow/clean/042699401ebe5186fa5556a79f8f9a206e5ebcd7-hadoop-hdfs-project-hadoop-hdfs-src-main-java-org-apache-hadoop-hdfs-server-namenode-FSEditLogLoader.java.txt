HDFS-7438. Consolidate the implementation of rename() into a single class. Contributed by Haohui Mai.

-      fsDir.unprotectedRenameTo(src, dst,
-                                renameOp.timestamp);
+      FSDirRenameOp.unprotectedRenameTo(fsDir, src, dst, renameOp.timestamp);
-      fsDir.unprotectedRenameTo(
+      FSDirRenameOp.unprotectedRenameTo(fsDir,

UPD42 INS42 UPD42 INS42