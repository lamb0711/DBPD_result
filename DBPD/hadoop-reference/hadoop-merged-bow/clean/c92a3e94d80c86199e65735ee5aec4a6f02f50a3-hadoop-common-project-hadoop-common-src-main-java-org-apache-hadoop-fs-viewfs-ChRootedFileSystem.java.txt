HADOOP-15565. Add an inner FS cache to ViewFileSystem, separate from the global cache, to avoid file system leaks. Contributed by Jinglun.

-   * @param uri base file system
-   * @param conf configuration
+   * @param fs base file system
+   * @param uri base uri
-  public ChRootedFileSystem(final URI uri, Configuration conf)
-      throws IOException {
-    super(FileSystem.get(uri, conf));
+  ChRootedFileSystem(final FileSystem fs, URI uri) throws IOException {
+    super(fs);
-  
+
+  /**
+   * Constructor.
+   * @param uri base file system
+   * @param conf configuration
+   * @throws IOException
+   */
+  public ChRootedFileSystem(final URI uri, Configuration conf)
+      throws IOException {
+    this(FileSystem.get(uri, conf), uri);
+  }
+

INS31 INS29 INS42 INS44 INS44 MOV29 INS83 INS42 MOV44 MOV44 INS43 INS8 MOV65 INS65 INS65 MOV65 INS83 INS43 INS42 INS43 INS42 INS65 INS65 INS42 INS17 INS42 INS66 INS42 INS66 INS42 INS42 INS42 INS66 INS42 MOV32 INS42 DEL83 DEL42