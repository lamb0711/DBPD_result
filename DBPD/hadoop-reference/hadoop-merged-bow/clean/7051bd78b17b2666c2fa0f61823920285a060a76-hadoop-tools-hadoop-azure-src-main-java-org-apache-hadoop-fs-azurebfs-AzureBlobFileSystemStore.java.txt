HADOOP-15795. Make HTTPS the default protocol for ABFS.
Contributed by Da Zhou.

-  public AzureBlobFileSystemStore(URI uri, boolean isSecure, Configuration configuration, UserGroupInformation userGroupInformation)
+  public AzureBlobFileSystemStore(URI uri, boolean isSecureScheme, Configuration configuration, UserGroupInformation userGroupInformation)
-    if (AuthType.OAuth == abfsConfiguration.getEnum(FS_AZURE_ACCOUNT_AUTH_TYPE_PROPERTY_NAME, AuthType.SharedKey)
-            && !FileSystemUriSchemes.ABFS_SECURE_SCHEME.equals(uri.getScheme())) {
-      throw new IllegalArgumentException(
-              String.format("Incorrect URI %s, URI scheme must be abfss when authenticating using Oauth.", uri));
-    }
+    boolean usingOauth = (AuthType.OAuth == abfsConfiguration.getEnum(
+            FS_AZURE_ACCOUNT_AUTH_TYPE_PROPERTY_NAME, AuthType.SharedKey));
-    initializeClient(uri, fileSystemName, accountName, isSecure);
+    boolean useHttps = (usingOauth || abfsConfiguration.isHttpsAlwaysUsed()) ? true : isSecureScheme;
+    initializeClient(uri, fileSystemName, accountName, useHttps);

UPD42 INS60 INS60 INS39 INS59 INS39 INS59 INS42 INS36 INS42 INS16 UPD42 MOV27 INS36 INS9 INS42 INS27 INS42 INS32 INS42 UPD42 MOV42 DEL40 DEL42 DEL42 DEL42 DEL32 DEL32 DEL38 DEL27 DEL42 DEL43 DEL42 DEL45 DEL42 DEL32 DEL14 DEL53 DEL8 DEL25