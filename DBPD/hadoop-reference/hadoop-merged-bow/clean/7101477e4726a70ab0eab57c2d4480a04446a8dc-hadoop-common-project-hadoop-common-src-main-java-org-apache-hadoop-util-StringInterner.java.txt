HDFS-11383. Intern strings in BlockLocation and ExtendedBlock. Contributed by Misha Dmitriev.

- * Provides equivalent behavior to String.intern() to optimize performance, 
- * whereby does not consume memory in the permanent generation.
+ * Provides string interning utility methods. For weak interning,
+ * we use the standard String.intern() call, that performs very well
+ * (no problems with PermGen overflowing, etc.) starting from JDK 7.
-  private final static Interner<String> strongInterner;
-  
-  /**
-   * Retains a weak reference to each string instance it has interned. 
-   */
-  private final static Interner<String> weakInterner;
-  
-  
-  
-  static {
-    strongInterner = Interners.newStrongInterner();
-    weakInterner = Interners.newWeakInterner();
-  }
-  
+  private final static Interner<String> STRONG_INTERNER =
+      Interners.newStrongInterner();
+
-    return strongInterner.intern(sample);
+    return STRONG_INTERNER.intern(sample);
-    return weakInterner.intern(sample);
+    return sample.intern();
+  }
+
+  /**
+   * Interns all the strings in the given array in place,
+   * returning the same array.
+   */
+  public static String[] internStringsInArray(String[] strings) {
+    for (int i = 0; i < strings.length; i++) {
+      strings[i] = weakIntern(strings[i]);
+    }
+    return strings;

INS31 INS8 MOV8 INS29 INS83 INS83 INS5 INS42 INS44 INS8 UPD66 UPD66 INS66 INS42 MOV32 MOV25 INS41 MOV65 INS43 INS85 INS5 INS42 INS24 INS41 INS32 UPD66 INS66 UPD42 MOV42 INS43 INS85 INS58 INS27 INS37 INS8 INS42 INS42 INS42 INS42 UPD42 MOV42 INS39 INS59 INS42 INS40 INS42 MOV21 INS42 INS34 INS2 INS42 INS42 UPD42 INS2 INS42 INS42 DEL42 DEL29 DEL83 DEL83 DEL83 DEL43 DEL43 DEL74 DEL42 DEL59 DEL23 DEL83 DEL42 DEL7 DEL21 DEL8 DEL28 DEL42 DEL42 DEL42 DEL42 DEL32 DEL41 DEL8 DEL42 DEL42