HDFS-5349. DNA_CACHE and DNA_UNCACHE should be by blockId only (cmccabe)

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-4949@1532116 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.hdfs.server.protocol.BlockIdCommand;
-          cmds.add(new BlockCommand(DatanodeProtocol.DNA_CACHE, blockPoolId,
-              pendingCacheList.toArray(new Block[] {})));
+          long blockIds[] = new long[pendingCacheList.size()];
+          for (int i = 0; i < pendingCacheList.size(); i++) {
+            blockIds[i] = pendingCacheList.get(i).getBlockId();
+          }
+          cmds.add(new BlockIdCommand(DatanodeProtocol.DNA_CACHE, blockPoolId,
+              blockIds));
-          cmds.add(new BlockCommand(DatanodeProtocol.DNA_UNCACHE,
-              blockPoolId, blks));
+          long blockIds[] = new long[blks.length];
+          for (int i = 0; i < blks.length; i++) {
+            blockIds[i] = blks[i].getBlockId();
+          }
+          cmds.add(new BlockIdCommand(DatanodeProtocol.DNA_UNCACHE,
+              blockPoolId, blockIds));

INS26 INS40 INS60 INS24 INS60 INS24 INS39 INS59 INS58 INS27 INS37 INS8 INS39 INS59 INS58 INS27 INS37 INS8 INS42 INS85 INS3 INS39 INS59 INS42 INS32 INS42 INS21 INS42 INS85 INS3 INS39 INS59 INS42 INS40 INS42 INS21 INS5 INS32 INS42 INS34 INS42 INS42 INS7 UPD43 INS42 INS5 INS40 INS42 INS34 INS7 UPD43 UPD42 INS39 INS85 INS42 INS42 INS2 INS32 UPD42 INS39 INS85 INS2 INS32 UPD42 INS42 INS42 INS32 INS42 INS42 INS42 INS2 INS42 INS42 INS42 INS42 INS42 INS42 DEL42 DEL42 DEL42 DEL43 DEL85 DEL5 DEL4 DEL3 DEL32