HDFS-8357. Consolidate parameters of INode.CleanSubtree() into a parameter objects. Contributed by Li Lu.

-      BlockStoragePolicySuite bsps, int snapshot, int prior, BlocksMapUpdateInfo collectedBlocks,
-      final List<INode> removedINodes, List<Long> removedUCFiles) {
-    return referred.cleanSubtree(bsps, snapshot, prior, collectedBlocks,
-        removedINodes, removedUCFiles);
+      ReclaimContext reclaimContext, int snapshot, int prior) {
+    return referred.cleanSubtree(reclaimContext,
+                                 snapshot, prior);
-  public void destroyAndCollectBlocks(
-      BlockStoragePolicySuite bsps, BlocksMapUpdateInfo collectedBlocks,
-      final List<INode> removedINodes, List<Long> removedUCFiles) {
+  public void destroyAndCollectBlocks(ReclaimContext reclaimContext) {
-      referred.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes,
-                                       removedUCFiles);
+      referred.destroyAndCollectBlocks(reclaimContext);
-        BlockStoragePolicySuite bsps, final int snapshot, int prior, final BlocksMapUpdateInfo collectedBlocks,
-        final List<INode> removedINodes, List<Long> removedUCFiles) {
+        ReclaimContext reclaimContext, final int snapshot, int prior) {
-      QuotaCounts counts = getReferredINode().cleanSubtree(bsps, snapshot, prior,
-          collectedBlocks, removedINodes, removedUCFiles);
+      QuotaCounts counts = getReferredINode().cleanSubtree(reclaimContext,
+          snapshot, prior);
-    public void destroyAndCollectBlocks(
-        BlockStoragePolicySuite bsps, BlocksMapUpdateInfo collectedBlocks,
-        final List<INode> removedINodes, List<Long> removedUCFiles) {
+    public void destroyAndCollectBlocks(ReclaimContext reclaimContext) {
-        getReferredINode().destroyAndCollectBlocks(bsps, collectedBlocks,
-            removedINodes, removedUCFiles);
+        getReferredINode().destroyAndCollectBlocks(reclaimContext);
-            QuotaCounts counts = referred.cleanSubtree(bsps, snapshot, prior,
-                collectedBlocks, removedINodes, removedUCFiles);
+            QuotaCounts counts = referred.cleanSubtree(reclaimContext,
+                snapshot, prior);
-        BlockStoragePolicySuite bsps, int snapshot, int prior,
-        BlocksMapUpdateInfo collectedBlocks, List<INode> removedINodes,
-        List<Long> removedUCFiles) {
+        ReclaimContext reclaimContext, int snapshot, int prior) {
-        this.computeQuotaUsage(bsps, counts, true);
-        destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes,
-                                removedUCFiles);
+        this.computeQuotaUsage(reclaimContext.bsps, counts, true);
+        destroyAndCollectBlocks(reclaimContext);
-        return getReferredINode().cleanSubtree(bsps, snapshot, prior,
-            collectedBlocks, removedINodes, removedUCFiles);
+        return getReferredINode().cleanSubtree(reclaimContext, snapshot, prior);
+     * @param reclaimContext
-    public void destroyAndCollectBlocks(
-        BlockStoragePolicySuite bsps, BlocksMapUpdateInfo collectedBlocks,
-        final List<INode> removedINodes, List<Long> removedUCFiles) {
+    public void destroyAndCollectBlocks(ReclaimContext reclaimContext) {
-        getReferredINode().destroyAndCollectBlocks(bsps, collectedBlocks,
-            removedINodes, removedUCFiles);
+        getReferredINode().destroyAndCollectBlocks(reclaimContext);
-          referred.cleanSubtree(bsps, snapshot, prior, collectedBlocks,
-              removedINodes, removedUCFiles);
+          referred.cleanSubtree(reclaimContext, snapshot, prior);
-            DirectoryWithSnapshotFeature.destroyDstSubtree(bsps, dir, snapshot,
-                prior, collectedBlocks, removedINodes, removedUCFiles);
+            DirectoryWithSnapshotFeature.destroyDstSubtree(
+                reclaimContext, dir, snapshot, prior);

MOV44 MOV44 MOV44 INS43 UPD42 INS43 UPD42 UPD42 MOV42 UPD42 MOV42 INS43 UPD42 INS43 UPD42 INS43 UPD42 INS65 INS43 UPD42 UPD42 UPD42 MOV42 MOV43 UPD42 MOV42 UPD42 MOV42 INS42 UPD42 MOV42 UPD42 MOV32 UPD42 MOV32 UPD42 INS40 UPD42 MOV32 UPD42 MOV32 UPD42 UPD42 MOV43 UPD42 UPD42 DEL83 DEL43 DEL42 DEL43 DEL74 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL43 DEL74 DEL42 DEL44 DEL42 DEL42 DEL42 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL44 DEL83 DEL43 DEL42 DEL43 DEL74 DEL42 DEL43 DEL42 DEL43 DEL74 DEL42 DEL44 DEL42 DEL42 DEL42 DEL83 DEL43 DEL42 DEL43 DEL74 DEL42 DEL43 DEL42 DEL44 DEL83 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL43 DEL74 DEL42 DEL44 DEL42 DEL42 DEL42 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL44 DEL83 DEL43 DEL42 DEL43 DEL74 DEL42 DEL43 DEL42 DEL43 DEL74 DEL42 DEL44 DEL42 DEL42 DEL42 DEL42 DEL42 DEL42 DEL43 DEL42 DEL43 DEL74 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL43 DEL74 DEL42 DEL44 DEL42 DEL42 DEL42 DEL42 DEL42 DEL42 DEL42 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL44 DEL83 DEL43 DEL42 DEL43 DEL74 DEL42 DEL43 DEL42 DEL43 DEL74 DEL42 DEL44 DEL42 DEL42 DEL42 DEL42 DEL42 DEL42 DEL42 DEL42 DEL42