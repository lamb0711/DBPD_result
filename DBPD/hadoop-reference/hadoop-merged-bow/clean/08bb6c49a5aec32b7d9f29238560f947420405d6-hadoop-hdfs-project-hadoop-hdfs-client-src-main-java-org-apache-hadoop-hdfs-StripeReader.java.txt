HDFS-13926. ThreadLocal aggregations for FileSystem.Statistics are incorrect with striped reads.
Contributed by Xiao Chen, Hrishikesh Gadre.

Signed-off-by: Xiao Chen <xiao@apache.org>

+import org.apache.hadoop.hdfs.util.StripedBlockUtil.BlockReadStats;
-  protected final Map<Future<Void>, Integer> futures = new HashMap<>();
+  private final Map<Future<BlockReadStats>, Integer> futures =
+      new HashMap<>();
-  protected final CompletionService<Void> service;
+  private final CompletionService<BlockReadStats> service;
-  private Callable<Void> readCells(final BlockReader reader,
+  private Callable<BlockReadStats> readCells(final BlockReader reader,
+      int ret = 0;
-        readToBuffer(reader, datanode, strategy, currentBlock);
+        int bytesReead = readToBuffer(reader, datanode, strategy, currentBlock);
+        ret += bytesReead;
-      return null;
+      return new BlockReadStats(ret, reader.isShortCircuit(),
+          reader.getNetworkDistance());
-    Callable<Void> readCallable = readCells(readerInfos[chunkIndex].reader,
+    Callable<BlockReadStats> readCallable =
+        readCells(readerInfos[chunkIndex].reader,
-    Future<Void> request = service.submit(readCallable);
+    Future<BlockReadStats> request = service.submit(readCallable);
+        dfsStripedInputStream.updateReadStats(r.getReadStats());
-    for (Future<Void> future : futures.keySet()) {
+    for (Future future : futures.keySet()) {

INS26 INS40 UPD83 UPD74 UPD83 UPD74 UPD74 UPD74 UPD43 UPD43 UPD43 UPD42 UPD42 UPD74 UPD74 UPD42 UPD43 UPD43 MOV43 INS60 UPD42 UPD42 INS39 INS59 INS14 INS21 INS42 INS34 INS60 INS43 INS42 INS32 INS32 INS32 INS39 INS59 INS7 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS32 INS42 MOV32 INS42 INS42 INS42 INS42 DEL33 DEL42 DEL43 DEL74