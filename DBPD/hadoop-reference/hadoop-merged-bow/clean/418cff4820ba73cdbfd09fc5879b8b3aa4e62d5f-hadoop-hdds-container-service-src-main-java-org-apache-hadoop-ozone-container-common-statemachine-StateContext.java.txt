Merge remote-tracking branch 'apache-commit/trunk' into HDDS-48

+import com.google.protobuf.GeneratedMessage;
-import org.apache.hadoop.hdds.protocol.proto
-    .StorageContainerDatanodeProtocolProtos.NodeReportProto;
+import java.util.ArrayList;
+import java.util.List;
+  private final Queue<GeneratedMessage> reports;
-  private NodeReportProto dnReport;
+    reports = new LinkedList<>();
-    dnReport = NodeReportProto.getDefaultInstance();
-   * Returns the node report of the datanode state context.
-   * @return the node report.
+   * Adds the report to report queue.
+   *
+   * @param report report to be added
-  public NodeReportProto getNodeReport() {
-    return dnReport;
+  public void addReport(GeneratedMessage report) {
+    synchronized (reports) {
+      reports.add(report);
+    }
-   * Sets the storage location report of the datanode state context.
-   * @param nodeReport node report
+   * Returns the next report, or null if the report queue is empty.
+   *
+   * @return report
-  public void setNodeReport(NodeReportProto nodeReport) {
-    this.dnReport = nodeReport;
+  public GeneratedMessage getNextReport() {
+    synchronized (reports) {
+      return reports.poll();
+    }
+  }
+
+  /**
+   * Returns all the available reports from the report queue, or empty list if
+   * the queue is empty.
+   *
+   * @return List<reports>
+   */
+  public List<GeneratedMessage> getAllAvailableReports() {
+    return getReports(Integer.MAX_VALUE);
+  }
+
+  /**
+   * Returns available reports from the report queue with a max limit on
+   * list size, or empty list if the queue is empty.
+   *
+   * @return List<reports>
+   */
+  public List<GeneratedMessage> getReports(int maxLimit) {
+    List<GeneratedMessage> results = new ArrayList<>();
+    synchronized (reports) {
+      GeneratedMessage report = reports.poll();
+      while(results.size() < maxLimit && report != null) {
+        results.add(report);
+        report = reports.poll();
+      }
+    }
+    return results;

MOV26 INS26 INS26 MOV23 UPD40 INS40 INS40 INS31 INS31 INS83 INS74 MOV21 INS29 INS83 INS39 INS42 INS44 INS8 UPD43 UPD42 INS8 INS29 INS83 INS74 INS42 INS8 INS74 INS42 INS44 INS8 INS43 INS43 UPD42 INS65 INS65 INS43 INS42 INS51 UPD42 INS51 INS65 INS65 INS43 INS43 INS41 UPD65 INS43 INS43 INS39 INS42 INS60 INS51 INS41 UPD42 MOV42 INS42 INS66 INS42 INS66 INS42 INS42 INS8 UPD66 UPD66 INS42 INS8 INS66 INS66 INS66 INS42 INS42 INS32 UPD66 INS66 UPD66 INS42 INS42 INS74 INS59 INS42 INS8 INS42 UPD42 INS14 INS21 MOV41 INS42 INS40 INS43 INS43 INS42 INS14 INS60 INS61 INS74 INS32 INS32 INS42 INS42 INS74 INS43 INS59 INS27 INS8 INS43 INS42 INS42 INS42 INS42 INS42 INS43 UPD42 MOV42 INS42 INS32 INS27 INS27 INS21 MOV21 INS42 INS42 INS42 INS42 INS32 INS42 INS42 INS33 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS32 INS42 INS42 DEL43 DEL42 DEL42 DEL32 DEL42 DEL8 DEL42 DEL52 DEL42 DEL22 DEL42 DEL39 DEL42 DEL43 DEL42 DEL44 DEL8