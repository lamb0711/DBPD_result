HADOOP-15292. Distcp's use of pread is slowing it down.
Contributed by Virajith Jalaparti.

-      int bytesRead = readBytes(inStream, buf, sourceOffset);
+      seekIfRequired(inStream, sourceOffset);
+      int bytesRead = readBytes(inStream, buf);
-        bytesRead = readBytes(inStream, buf, sourceOffset);
+        bytesRead = readBytes(inStream, buf);
-  private static int readBytes(ThrottledInputStream inStream, byte buf[],
-      long position) throws IOException {
+  private static int readBytes(ThrottledInputStream inStream, byte buf[])
+      throws IOException {
-      if (position == 0) {
-        return inStream.read(buf);
-      } else {
-        return inStream.read(position, buf, 0, buf.length);
+      return inStream.read(buf);
+    } catch (IOException e) {
+      throw new CopyReadException(e);
+    }
+  }
+
+  private static void seekIfRequired(ThrottledInputStream inStream,
+      long sourceOffset) throws IOException {
+    try {
+      if (sourceOffset != inStream.getPos()) {
+        inStream.seek(sourceOffset);

INS31 INS83 INS83 INS39 INS42 INS44 INS44 INS43 INS8 INS43 INS42 INS39 INS42 INS42 INS54 MOV8 INS42 INS8 INS12 INS21 INS25 INS44 INS8 INS32 INS27 INS8 INS43 INS42 INS53 INS42 INS42 INS42 INS42 INS32 INS21 INS42 INS14 INS42 INS42 INS32 INS43 INS42 INS42 INS42 INS42 INS42 DEL42 DEL42 DEL39 DEL42 DEL44 DEL42 DEL34 DEL27 DEL42 DEL42 DEL42 DEL42 DEL34 DEL40 DEL32 DEL41 DEL8 DEL25 DEL8