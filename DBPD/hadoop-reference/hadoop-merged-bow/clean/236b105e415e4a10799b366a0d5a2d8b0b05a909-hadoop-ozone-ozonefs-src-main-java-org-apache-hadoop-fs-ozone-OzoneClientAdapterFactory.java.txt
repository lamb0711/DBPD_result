HDDS-1089. Disable OzoneFSStorageStatistics for hadoop versions older than 2.8.
Contributed by Elek, Marton.

+import java.lang.reflect.InvocationTargetException;
-      String bucketStr, OzoneFSStorageStatistics storageStatistics)
+      String bucketStr) throws IOException {
+    return createAdapter(volumeStr, bucketStr,
+        (aClass) -> (OzoneClientAdapter) aClass
+            .getConstructor(String.class, String.class)
+            .newInstance(
+                volumeStr,
+                bucketStr));
+  }
+
+
+  public static OzoneClientAdapter createAdapter(
+      String volumeStr,
+      String bucketStr,
+      OzoneFSStorageStatistics storageStatistics)
+    return createAdapter(volumeStr, bucketStr,
+        (aClass) -> (OzoneClientAdapter) aClass
+            .getConstructor(String.class, String.class,
+                OzoneFSStorageStatistics.class)
+            .newInstance(
+                volumeStr,
+                bucketStr,
+                storageStatistics));
+  }
+
+  public static OzoneClientAdapter createAdapter(
+      String volumeStr,
+      String bucketStr,
+      OzoneClientAdapterCreator creator) throws IOException {
-      OzoneClientAdapter ozoneClientAdapter = (OzoneClientAdapter) classLoader
-          .loadClass("org.apache.hadoop.fs.ozone.OzoneClientAdapterImpl")
-          .getConstructor(String.class, String.class,
-              OzoneFSStorageStatistics.class)
-          .newInstance(
-              volumeStr,
-              bucketStr, storageStatistics);
+      Class<?> aClass = classLoader
+          .loadClass("org.apache.hadoop.fs.ozone.OzoneClientAdapterImpl");
+      OzoneClientAdapter ozoneClientAdapter =
+          creator.createOzoneClientAdapter(aClass);
+  /**
+   * Interface to create OzoneClientAdapter implementation with reflection.
+   */
+  @FunctionalInterface
+  interface OzoneClientAdapterCreator {
+    OzoneClientAdapter createOzoneClientAdapter(Class<?> clientAdapter)
+        throws NoSuchMethodException, IllegalAccessException,
+        InvocationTargetException, InstantiationException;
+  }
+

INS26 INS40 INS31 INS31 INS55 MOV79 INS83 INS83 INS43 INS42 INS44 INS44 INS43 INS8 INS83 INS83 MOV43 INS42 INS44 INS44 MOV44 INS43 INS8 INS44 INS29 INS78 INS42 INS31 INS42 INS43 INS42 INS43 INS42 INS42 INS41 INS43 INS42 INS43 INS42 INS42 INS41 INS43 INS42 INS65 INS42 INS43 INS42 INS44 INS43 INS43 INS43 INS43 INS42 INS42 INS32 INS42 INS42 INS32 INS42 INS66 INS42 INS74 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS86 INS42 INS42 INS42 INS86 INS60 INS43 INS76 INS59 INS11 INS59 MOV11 INS74 INS59 INS43 INS42 INS42 INS43 INS32 INS42 INS43 INS76 INS42 MOV32 INS42 INS32 INS42 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS57 INS57 INS42 INS43 INS43 INS42 INS42