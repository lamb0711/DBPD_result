HDFS-10800: [SPS]: Daemon thread in Namenode to find blocks placed in other storage than what the policy specifies. Contributed by Uma Maheswara Rao G

+import org.apache.hadoop.hdfs.protocol.Block;
-  public void processBlockMovingTasks(long trackID,
+  public void processBlockMovingTasks(long trackID, String blockPoolID,
-        BlockMovingTask blockMovingTask =
-            new BlockMovingTask(blkMovingInfo.getBlock(),
-            blkMovingInfo.getSources()[i],
-            blkMovingInfo.getTargets()[i],
+        BlockMovingTask blockMovingTask = new BlockMovingTask(
+            blkMovingInfo.getBlock(), blockPoolID,
+            blkMovingInfo.getSources()[i], blkMovingInfo.getTargets()[i],
-        moveCallable = moverExecutorCompletionService
-            .submit(blockMovingTask);
+        moveCallable = moverExecutorCompletionService.submit(blockMovingTask);
-    private final ExtendedBlock block;
+    private final Block block;
+    private String blockPoolID;
-    BlockMovingTask(ExtendedBlock block, DatanodeInfo source,
+    BlockMovingTask(Block block, String blockPoolID, DatanodeInfo source,
+      this.blockPoolID = blockPoolID;
-
+        ExtendedBlock extendedBlock = new ExtendedBlock(blockPoolID, block);
-            block, EnumSet.of(BlockTokenIdentifier.AccessMode.WRITE));
+            extendedBlock, EnumSet.of(BlockTokenIdentifier.AccessMode.WRITE));
-            .getDataEncryptionKeyFactoryForBlock(block);
+            .getDataEncryptionKeyFactoryForBlock(extendedBlock);
-        sendRequest(out, block, accessToken, source, targetStorageType);
+        sendRequest(out, extendedBlock, accessToken, source, targetStorageType);
-        LOG.debug(
+        LOG.info(

INS26 INS40 INS44 INS23 INS43 INS42 INS43 INS83 INS43 INS59 INS44 INS42 INS42 INS42 INS42 INS43 INS43 INS42 INS21 INS42 INS42 INS7 INS22 INS42 INS60 INS52 INS42 MOV43 INS59 INS42 INS14 UPD42 UPD42 MOV43 INS42 INS42 UPD42 UPD42 INS42