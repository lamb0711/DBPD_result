YARN-5831. FairScheduler: Propagate allowPreemptionFrom flag all the way down to the app. (Yufei Gu via kasha)

+    reinit(false);
+   *
+   * @param recursive whether child queues should be reinitialized recursively
-  public void init() {
+  public void reinit(boolean recursive) {
+    updatePreemptionVariables();
+
+    if (recursive) {
+      for (FSQueue child : getChildQueues()) {
+        child.reinit(recursive);
+      }
+    }
+  @Override
-  public void updatePreemptionVariables() {
+  private void updatePreemptionVariables() {
-    // For option whether allow preemption from this queue
-    preemptable = scheduler.getAllocationConfiguration()
-        .isPreemptable(getName());
+    // For option whether allow preemption from this queue.
+    // If the parent is non-preemptable, this queue is non-preemptable as well,
+    // otherwise get the value from the allocation file.
+    if (parent != null && !parent.isPreemptable()) {
+      preemptable = false;
+    } else {
+      preemptable = scheduler.getAllocationConfiguration()
+          .isPreemptable(getName());
+    }

UPD42 INS44 INS78 UPD83 INS21 INS65 INS39 INS42 INS21 INS25 INS42 INS25 INS32 INS42 INS66 INS32 INS42 INS8 INS27 INS8 INS8 INS42 INS9 INS42 INS70 INS27 INS38 INS21 MOV21 INS44 INS32 INS8 INS42 INS33 INS32 INS7 INS43 INS42 INS42 INS21 INS42 INS42 INS42 INS9 INS42 INS32 INS42 INS42 INS42