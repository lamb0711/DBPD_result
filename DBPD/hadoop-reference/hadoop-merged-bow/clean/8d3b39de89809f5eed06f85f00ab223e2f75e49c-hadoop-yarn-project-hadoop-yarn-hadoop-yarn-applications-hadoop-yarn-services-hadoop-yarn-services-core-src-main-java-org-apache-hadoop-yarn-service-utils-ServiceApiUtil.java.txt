YARN-8081.  Add support to upgrade a component.
            Contributed by Chandni Singh

+import com.google.common.base.Preconditions;
+import com.google.common.collect.Sets;
+import org.apache.hadoop.yarn.service.api.records.ComponentState;
+import org.apache.hadoop.yarn.service.api.records.Container;
+import org.apache.hadoop.yarn.service.api.records.ContainerState;
+import org.apache.hadoop.yarn.service.api.records.Service;
-import org.apache.hadoop.yarn.service.api.records.Container;
-import org.apache.hadoop.yarn.service.api.records.Service;
+import static org.apache.hadoop.yarn.service.exceptions.RestApiErrorMessages.ERROR_COMP_DOES_NOT_NEED_UPGRADE;
+import static org.apache.hadoop.yarn.service.exceptions.RestApiErrorMessages.ERROR_COMP_INSTANCE_DOES_NOT_NEED_UPGRADE;
+
+  /**
+   * Validates that the component instances that are requested to upgrade
+   * require an upgrade.
+   */
+  public static void validateInstancesUpgrade(List<Container>
+      liveContainers) throws YarnException {
+    for (Container liveContainer : liveContainers) {
+      if (!liveContainer.getState().equals(ContainerState.NEEDS_UPGRADE)) {
+        // Nothing to upgrade
+        throw new YarnException(String.format(
+            ERROR_COMP_INSTANCE_DOES_NOT_NEED_UPGRADE,
+            liveContainer.getComponentInstanceName()));
+      }
+    }
+  }
+
+  /**
+   * Validates the components that are requested to upgrade require an upgrade.
+   * It returns the instances of the components which need upgrade.
+   */
+  public static List<Container> validateAndResolveCompsUpgrade(
+      Service liveService, Collection<String> compNames) throws YarnException {
+    Preconditions.checkNotNull(compNames);
+    HashSet<String> requestedComps = Sets.newHashSet(compNames);
+    List<Container> containerNeedUpgrade = new ArrayList<>();
+    for (Component liveComp : liveService.getComponents()) {
+      if (requestedComps.contains(liveComp.getName())) {
+        if (!liveComp.getState().equals(ComponentState.NEEDS_UPGRADE)) {
+          // Nothing to upgrade
+          throw new YarnException(String.format(
+              ERROR_COMP_DOES_NOT_NEED_UPGRADE, liveComp.getName()));
+        }
+        liveComp.getContainers().forEach(liveContainer -> {
+          if (liveContainer.getState().equals(ContainerState.NEEDS_UPGRADE)) {
+            containerNeedUpgrade.add(liveContainer);
+          }
+        });
+      }
+    }
+    return containerNeedUpgrade;
+  }
+

MOV26 MOV26 INS26 INS26 INS26 INS26 INS26 INS26 INS40 INS40 INS40 INS40 INS40 INS40 INS31 INS31 INS29 INS83 INS83 INS39 INS42 INS44 INS43 INS8 INS29 INS83 INS83 INS74 INS42 INS44 INS44 INS43 INS8 INS65 INS74 INS42 INS42 INS70 INS65 INS43 INS43 INS43 INS42 INS74 INS42 INS42 INS21 INS60 INS60 INS70 INS41 INS66 INS66 INS43 INS43 INS44 INS42 INS8 INS66 INS66 INS42 INS42 INS42 INS43 INS43 INS32 INS74 INS59 INS74 INS59 INS44 INS32 INS8 INS42 INS42 INS42 INS43 INS42 INS25 INS42 INS42 INS42 INS42 INS42 INS43 INS43 INS42 INS32 INS43 INS43 INS42 INS14 INS43 INS42 INS42 INS42 INS25 INS42 INS38 INS8 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS74 INS42 INS32 INS8 INS32 INS53 INS43 INS42 INS42 INS32 INS25 INS21 INS32 INS42 INS40 INS14 INS42 INS42 INS42 INS38 INS8 INS32 INS42 INS42 INS43 INS32 INS32 INS53 INS32 INS42 INS86 INS42 INS42 INS42 INS42 INS32 INS32 INS42 INS40 INS14 INS42 INS42 INS59 INS8 INS42 INS42 INS42 INS42 INS43 INS32 INS42 INS25 INS42 INS42 INS42 INS42 INS32 INS32 INS8 INS42 INS42 INS32 INS42 INS40 INS21 INS42 INS42 INS32 INS42 INS42 INS42