Merge from trunk to branch

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/fs-encryption@1615844 13f79535-47bb-0310-9956-ffa450edef68

+
+import org.apache.hadoop.security.authorize.AuthorizationException;
+
+    } else if (throwable instanceof AuthorizationException) {
+      status = Response.Status.UNAUTHORIZED;
+      // we don't audit here because we did it already when checking access
+      doAudit = false;
-      KMSAudit.error(KMSMDCFilter.getPrincipal(), KMSMDCFilter.getMethod(),
+      KMSWebApp.getKMSAudit().error(KMSMDCFilter.getPrincipal(),
+          KMSMDCFilter.getMethod(),

INS26 INS40 INS25 INS62 INS8 MOV25 INS42 INS43 INS21 INS21 INS32 INS42 INS7 INS7 INS42 UPD42 MOV42 INS42 INS40 INS42 INS9