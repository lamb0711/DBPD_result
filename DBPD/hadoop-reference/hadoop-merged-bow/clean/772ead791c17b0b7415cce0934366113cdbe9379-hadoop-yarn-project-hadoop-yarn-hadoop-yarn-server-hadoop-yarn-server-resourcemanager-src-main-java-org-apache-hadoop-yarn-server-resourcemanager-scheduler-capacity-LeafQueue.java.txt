YARN-1398. Fixed a deadlock in ResourceManager between users requesting queue-acls and completing containers. Contributed by Vinod Kumar Vavilapalli.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1570415 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.hadoop.yarn.api.records.Token;
+
+      boolean removed = false;
+
-        boolean removed = false;
-          // Inform the parent queue
-          getParent().completedContainer(clusterResource, application,
-              node, rmContainer, null, event, this);
-
+      if (removed) {
+        // Inform the parent queue _outside_ of the leaf-queue lock
+        getParent().completedContainer(clusterResource, application, node,
+          rmContainer, null, event, this);
+      }

MOV8 INS25 MOV27 MOV8 INS51 INS25 INS52 INS8 INS42 INS8 MOV60 MOV25 MOV25 MOV21 DEL40 DEL26 DEL52 DEL51 DEL25 DEL8