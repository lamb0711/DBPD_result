HDFS-9653.  Added blocks pending deletion report to dfsadmin.
(Weiwei Yang via eyang)

-  private long[] callGetStats() throws IOException {
+  private long getStateByIndex(int stateIndex) throws IOException {
-      return namenode.getStats();
+      long[] states =  namenode.getStats();
+      return states.length > stateIndex ? states[stateIndex] : -1;
-    long rawNums[] = callGetStats();
-    return new FsStatus(rawNums[0], rawNums[1], rawNums[2]);
+    return new FsStatus(getStateByIndex(0),
+        getStateByIndex(1), getStateByIndex(2));
-    return callGetStats()[ClientProtocol.GET_STATS_MISSING_BLOCKS_IDX];
+    return getStateByIndex(ClientProtocol.
+        GET_STATS_MISSING_BLOCKS_IDX);
-    return callGetStats()[ClientProtocol.
-        GET_STATS_MISSING_REPL_ONE_BLOCKS_IDX];
+    return getStateByIndex(ClientProtocol.
+        GET_STATS_MISSING_REPL_ONE_BLOCKS_IDX);
+  }
+
+  /**
+   * Returns count of blocks pending on deletion.
+   * @throws IOException
+   */
+  public long getPendingDeletionBlocksCount() throws IOException {
+    return getStateByIndex(ClientProtocol.
+        GET_STATS_PENDING_DELETION_BLOCKS_IDX);
-    return callGetStats()[ClientProtocol.GET_STATS_UNDER_REPLICATED_IDX];
+    return getStateByIndex(ClientProtocol.
+        GET_STATS_UNDER_REPLICATED_IDX);
-    return callGetStats()[ClientProtocol.GET_STATS_CORRUPT_BLOCKS_IDX];
+    return getStateByIndex(ClientProtocol.
+        GET_STATS_CORRUPT_BLOCKS_IDX);
-    return callGetStats()[ClientProtocol.GET_STATS_BYTES_IN_FUTURE_BLOCKS_IDX];
+    return getStateByIndex(ClientProtocol.
+        GET_STATS_BYTES_IN_FUTURE_BLOCKS_IDX);

INS31 INS39 UPD42 INS44 INS29 INS83 INS39 INS42 INS43 INS8 INS39 INS42 INS65 INS65 INS42 INS41 INS32 INS32 INS66 INS42 INS32 INS32 INS32 INS32 INS60 INS32 INS32 INS32 UPD42 MOV42 INS40 UPD42 MOV42 INS40 INS42 INS40 UPD42 MOV42 INS40 UPD42 MOV42 INS40 UPD42 MOV42 INS40 MOV5 INS59 INS16 INS42 INS34 INS42 INS34 INS42 INS34 INS42 MOV32 INS27 INS2 INS38 INS40 INS42 INS42 INS42 INS34 DEL39 DEL42 DEL85 DEL42 DEL32 DEL59 DEL60 DEL42 DEL34 DEL2 DEL42 DEL34 DEL2 DEL42 DEL34 DEL2 DEL32 DEL40 DEL2 DEL32 DEL40 DEL2 DEL32 DEL40 DEL2 DEL32 DEL40 DEL2 DEL32 DEL40 DEL2