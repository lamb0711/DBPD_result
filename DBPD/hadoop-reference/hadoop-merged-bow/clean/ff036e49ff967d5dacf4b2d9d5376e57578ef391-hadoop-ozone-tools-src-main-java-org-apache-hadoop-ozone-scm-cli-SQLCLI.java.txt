HDDS-357. Use DBStore and TableStore for OzoneManager non-background service.
Contributed by Nandakumar.

+import static org.apache.hadoop.ozone.OzoneConsts.OM_KEY_PREFIX;
-import static org.apache.hadoop.ozone.OzoneConsts.OM_BUCKET_PREFIX;
-import static org.apache.hadoop.ozone.OzoneConsts.OM_VOLUME_PREFIX;
+  // TODO: This has to be fixed.
+  // we don't have prefix anymore. now each key is written into different
+  // table. The logic has to be changed.
-    } else if (key.startsWith(OM_VOLUME_PREFIX)) {
-      return key.replaceFirst(OM_VOLUME_PREFIX, "")
-          .contains(OM_BUCKET_PREFIX) ? KeyType.BUCKET : KeyType.VOLUME;
+    } else if (key.startsWith(OM_KEY_PREFIX)) {
+      return key.replaceFirst(OM_KEY_PREFIX, "")
+          .contains(OM_KEY_PREFIX) ? KeyType.BUCKET : KeyType.VOLUME;

MOV26 UPD40 UPD42 UPD42 UPD42 DEL40 DEL26