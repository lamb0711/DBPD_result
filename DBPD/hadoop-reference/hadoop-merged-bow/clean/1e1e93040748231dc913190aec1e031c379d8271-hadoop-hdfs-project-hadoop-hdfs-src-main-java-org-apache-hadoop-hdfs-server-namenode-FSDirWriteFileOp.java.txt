HDFS-7837. Erasure Coding: allocate and persist striped blocks in NameNode. Contributed by Jing Zhao.

-                                              modificationTime, replication,
-                                              preferredBlockSize,
-                                              storagePolicyId);
+          modificationTime, replication, preferredBlockSize, storagePolicyId);
-      newNode = newINodeFile(id, permissions, modificationTime,
-                                              atime, replication,
-                                              preferredBlockSize,
-                                              storagePolicyId);
+      newNode = newINodeFile(id, permissions, modificationTime, atime,
+          replication, preferredBlockSize, storagePolicyId);
+        if (newNode.isStriped()) {
+          newNode.addStripedBlocksFeature();
+        }
-                                     modTime, modTime, replication, preferredBlockSize);
+        modTime, modTime, replication, preferredBlockSize);
+      if (newiip != null && newNode.isStriped()) {
+        newNode.addStripedBlocksFeature();
+      }
-                                       existing.getPath() + "/" + localName);
+          existing.getPath() + "/" + localName);

INS25 INS27 INS8 INS25 INS27 INS32 INS21 INS32 INS8 INS42 INS33 INS42 INS42 INS32 INS42 INS42 INS21 INS42 INS42 INS32 INS42 INS42