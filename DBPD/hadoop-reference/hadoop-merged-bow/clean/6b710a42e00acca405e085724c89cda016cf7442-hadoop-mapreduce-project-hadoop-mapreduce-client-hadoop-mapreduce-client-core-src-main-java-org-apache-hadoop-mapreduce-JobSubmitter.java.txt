Fixing MR intermediate spills. Contributed by Arun Suresh.

-import java.io.FileNotFoundException;
-import java.net.UnknownHostException;
-import org.apache.hadoop.fs.FileUtil;
-import org.apache.hadoop.mapreduce.filecache.ClientDistributedCacheManager;
-         
-          int keyLen = CryptoUtils.isShuffleEncrypted(conf) 
-              ? conf.getInt(MRJobConfig.MR_ENCRYPTED_INTERMEDIATE_DATA_KEY_SIZE_BITS, 
-                  MRJobConfig.DEFAULT_MR_ENCRYPTED_INTERMEDIATE_DATA_KEY_SIZE_BITS)
-              : SHUFFLE_KEY_LENGTH;
-          keyGen.init(keyLen);
+          keyGen.init(SHUFFLE_KEY_LENGTH);
+      if (CryptoUtils.isEncryptedSpillEnabled(conf)) {
+        conf.setInt(MRJobConfig.MR_AM_MAX_ATTEMPTS, 1);
+        LOG.warn("Max job attempts set to 1 since encrypted intermediate" +
+                "data spill is enabled");
+      }

INS25 INS32 INS8 INS42 INS42 INS42 INS21 INS21 INS32 INS32 INS42 INS42 INS40 INS34 INS42 INS42 INS27 INS45 INS45 UPD42 DEL40 DEL26 DEL40 DEL26 DEL40 DEL26 DEL40 DEL26 DEL39 DEL42 DEL42 DEL42 DEL42 DEL32 DEL42 DEL42 DEL40 DEL40 DEL32 DEL42 DEL16 DEL59 DEL60