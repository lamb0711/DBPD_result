Merge all changes from trunk to branch HDFS-2832.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2832@1517887 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.yarn.api.records.YarnApplicationState;
+import org.apache.hadoop.yarn.exceptions.YarnRuntimeException;
+import org.apache.hadoop.yarn.server.resourcemanager.rmapp.RMAppState;
-
-    boolean bypassFilter = applicationTypes.isEmpty();
+    EnumSet<YarnApplicationState> applicationStates =
+        request.getApplicationStates();
+
-      if (!(bypassFilter || applicationTypes.contains(application
-          .getApplicationType()))) {
-        continue;
+      if (applicationTypes != null && !applicationTypes.isEmpty()) {
+        if (!applicationTypes.contains(application.getApplicationType())) {
+          continue;
+        }
+      }
+
+      if (applicationStates != null && !applicationStates.isEmpty()) {
+        if (!applicationStates.contains(RMServerUtils
+            .createApplicationState(application.getState()))) {
+          continue;
+        }

INS26 INS26 INS26 INS40 INS40 INS40 INS74 INS43 INS43 UPD42 INS32 INS25 INS25 INS42 INS42 INS42 INS42 INS27 INS8 INS27 INS8 INS27 INS38 MOV25 INS27 INS38 INS25 INS42 INS33 MOV32 INS42 INS33 INS32 INS38 INS8 MOV32 INS42 INS42 INS32 INS18 INS42 INS42 INS32 INS42 INS42 INS32 INS42 INS42 DEL39 DEL42 DEL27 DEL36