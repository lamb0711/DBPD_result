HDDS-1685. Recon: Add support for "start" query param to containers and containers/{id} endpoints.



+import org.apache.commons.lang3.StringUtils;
+import static org.apache.hadoop.ozone.recon.ReconConstants.FETCH_ALL;
+import static org.apache.hadoop.ozone.recon.ReconConstants.RECON_QUERY_LIMIT;
+import static org.apache.hadoop.ozone.recon.ReconConstants.RECON_QUERY_PREVKEY;
+
-   * for all the containers.
+   * for the containers starting from the given "prev-key" query param for the
+   * given "limit". The given "prev-key" is skipped from the results returned.
+   * @param limit max no. of containers to get.
+   * @param prevKey the containerID after which results are returned.
-      @DefaultValue("-1") @QueryParam("limit") int limit) {
+      @DefaultValue(FETCH_ALL) @QueryParam(RECON_QUERY_LIMIT) int limit,
+      @DefaultValue("0") @QueryParam(RECON_QUERY_PREVKEY) long prevKey) {
-      containersMap = containerDBServiceProvider.getContainers(limit);
+      containersMap = containerDBServiceProvider.getContainers(limit, prevKey);
-   * all keys that belong to the container identified by the id param.
+   * all keys that belong to the container identified by the id param
+   * starting from the given "prev-key" query param for the given "limit".
+   * The given prevKeyPrefix is skipped from the results returned.
-   * @param containerId Container Id
+   * @param containerID the given containerID.
+   * @param limit max no. of keys to get.
+   * @param prevKeyPrefix the key prefix after which results are returned.
-      @PathParam("id") Long containerId,
-      @DefaultValue("-1") @QueryParam("limit") int limit) {
+      @PathParam("id") Long containerID,
+      @DefaultValue(FETCH_ALL) @QueryParam(RECON_QUERY_LIMIT) int limit,
+      @DefaultValue(StringUtils.EMPTY) @QueryParam(RECON_QUERY_PREVKEY)
+          String prevKeyPrefix) {
-          containerDBServiceProvider.getKeyPrefixesForContainer(containerId);
+          containerDBServiceProvider.getKeyPrefixesForContainer(containerID,
+              prevKeyPrefix);
-              .filter(c -> c.getContainerID() == containerId)
+              .filter(c -> c.getContainerID() == containerID)

INS26 INS26 INS26 INS26 INS40 INS40 INS40 INS40 INS44 INS44 INS65 INS65 INS79 INS79 INS39 INS42 INS65 INS65 UPD42 INS79 INS79 INS43 INS42 UPD66 INS66 INS42 INS66 INS42 INS66 INS42 INS42 INS42 INS45 INS42 INS42 UPD66 INS66 INS66 UPD42 UPD66 INS42 INS66 INS42 INS66 INS42 INS42 INS42 INS40 INS42 INS42 INS42 INS42 UPD42 INS42 UPD42 DEL45 DEL45 DEL45 DEL45