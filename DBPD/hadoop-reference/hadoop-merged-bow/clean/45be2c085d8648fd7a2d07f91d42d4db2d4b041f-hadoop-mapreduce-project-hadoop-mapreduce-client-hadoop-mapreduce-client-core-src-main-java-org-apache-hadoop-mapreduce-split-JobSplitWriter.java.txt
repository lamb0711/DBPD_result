MAPREDUCE-4146. Support limits on task status string length and number of block locations in branch-2. Contributed by Ahmed Radwan.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1343755 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.mapreduce.MRConfig;
+
-    SplitMetaInfo[] info = writeOldSplits(splits, out);
+    SplitMetaInfo[] info = writeOldSplits(splits, out, conf);
+      int maxBlockLocations = conf.getInt(MRConfig.MAX_BLOCK_LOCATIONS_KEY,
+          MRConfig.MAX_BLOCK_LOCATIONS_DEFAULT);
+        String[] locations = split.getLocations();
+        if (locations.length > maxBlockLocations) {
+          throw new IOException("Max block location exceeded for split: "
+              + split + " splitsize: " + locations.length +
+              " maxsize: " + maxBlockLocations);
+        }
-              split.getLocations(), offset,
+              locations, offset,
-      FSDataOutputStream out) throws IOException {
+      FSDataOutputStream out, Configuration conf) throws IOException {
+      int maxBlockLocations = conf.getInt(MRConfig.MAX_BLOCK_LOCATIONS_KEY,
+          MRConfig.MAX_BLOCK_LOCATIONS_DEFAULT);
+        String[] locations = split.getLocations();
+        if (locations.length > maxBlockLocations) {
+          throw new IOException("Max block location exceeded for split: "
+              + split + " splitsize: " + locations.length +
+              " maxsize: " + maxBlockLocations);
+        }
-            split.getLocations(), offset,
+            locations, offset,

INS26 INS40 INS44 INS43 INS42 INS42 INS60 INS60 INS42 INS39 INS59 INS39 INS59 INS42 INS32 INS60 INS25 INS42 INS32 INS60 INS25 INS42 INS42 INS40 INS40 INS5 INS59 INS27 INS8 INS42 INS42 INS40 INS40 INS5 INS59 INS27 INS8 INS43 INS85 INS42 MOV32 INS40 INS42 INS53 INS43 INS85 INS42 MOV32 INS40 INS42 INS53 INS42 INS14 INS42 INS42 INS14 INS42 INS43 INS27 INS43 INS27 INS42 INS45 INS42 INS45 INS40 INS45 INS42 INS42 INS45 INS42 INS45 INS40 INS45 INS42