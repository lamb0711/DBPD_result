HDFS-4992. Make balancer's mover thread count and dispatcher thread count configurable.  Contributed by Max Lapan


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1503720 13f79535-47bb-0310-9956-ffa450edef68

-  final static private int MOVER_THREAD_POOL_SIZE = 1000;
-  final private ExecutorService moverExecutor = 
-    Executors.newFixedThreadPool(MOVER_THREAD_POOL_SIZE);
-  final static private int DISPATCHER_THREAD_POOL_SIZE = 200;
-  final private ExecutorService dispatcherExecutor =
-    Executors.newFixedThreadPool(DISPATCHER_THREAD_POOL_SIZE);
-  
+
+  private final ExecutorService moverExecutor;
+  private final ExecutorService dispatcherExecutor;
+
+    this.moverExecutor = Executors.newFixedThreadPool(
+            conf.getInt(DFSConfigKeys.DFS_BALANCER_MOVERTHREADS_KEY,
+                        DFSConfigKeys.DFS_BALANCER_MOVERTHREADS_DEFAULT));
+    this.dispatcherExecutor = Executors.newFixedThreadPool(
+            conf.getInt(DFSConfigKeys.DFS_BALANCER_DISPATCHERTHREADS_KEY,
+                        DFSConfigKeys.DFS_BALANCER_DISPATCHERTHREADS_DEFAULT));

INS23 INS23 MOV83 MOV83 MOV43 MOV59 MOV83 MOV83 MOV43 MOV59 INS21 INS21 INS7 INS7 INS22 INS32 INS22 INS32 INS52 INS42 INS42 INS42 INS32 INS52 INS42 INS42 INS42 INS32 INS42 INS42 INS40 INS40 INS42 INS42 INS40 INS40 DEL42 DEL42 DEL42 DEL32 DEL42 DEL42 DEL42 DEL32 DEL83 DEL83 DEL39 DEL42 DEL34 DEL59 DEL23 DEL83 DEL23 DEL83 DEL83 DEL39 DEL42 DEL34 DEL59 DEL23 DEL83 DEL23