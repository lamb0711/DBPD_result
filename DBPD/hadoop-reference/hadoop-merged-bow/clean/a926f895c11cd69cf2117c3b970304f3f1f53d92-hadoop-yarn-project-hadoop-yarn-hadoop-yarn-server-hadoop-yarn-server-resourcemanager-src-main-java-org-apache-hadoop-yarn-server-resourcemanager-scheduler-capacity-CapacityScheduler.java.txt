YARN-5865. Retrospect updateApplicationPriority api to handle state store exception in align with YARN-5611. Contributed by Sunil G.

+import com.google.common.util.concurrent.SettableFuture;
-  public void updateApplicationPriority(Priority newPriority,
-      ApplicationId applicationId) throws YarnException {
+  public Priority updateApplicationPriority(Priority newPriority,
+      ApplicationId applicationId, SettableFuture<Object> future)
+      throws YarnException {
+
-      return;
+      future.set(null);
+      return appPriority;
-    // Update new priority in Submission Context to keep track in HA
+    // Update new priority in Submission Context to update to StateStore.
-    ApplicationStateData appState =
-        ApplicationStateData.newInstance(rmApp.getSubmitTime(),
-            rmApp.getStartTime(), rmApp.getApplicationSubmissionContext(),
-            rmApp.getUser(), rmApp.getCallerContext());
+    ApplicationStateData appState = ApplicationStateData.newInstance(
+        rmApp.getSubmitTime(), rmApp.getStartTime(),
+        rmApp.getApplicationSubmissionContext(), rmApp.getUser(),
+        rmApp.getCallerContext());
-        false, null);
+        false, future);
-
-    // Update the changed application state to timeline server
-    rmContext.getSystemMetricsPublisher().appUpdated(rmApp,
-        System.currentTimeMillis());
-
+    return appPriority;

INS26 INS40 INS43 INS44 INS42 INS74 INS42 INS41 INS43 INS43 INS42 INS42 INS42 INS21 INS42 INS32 INS42 INS42 INS42 INS33 DEL39 DEL33 DEL42 DEL42 DEL32 DEL42 DEL42 DEL42 DEL42 DEL32 DEL32 DEL21