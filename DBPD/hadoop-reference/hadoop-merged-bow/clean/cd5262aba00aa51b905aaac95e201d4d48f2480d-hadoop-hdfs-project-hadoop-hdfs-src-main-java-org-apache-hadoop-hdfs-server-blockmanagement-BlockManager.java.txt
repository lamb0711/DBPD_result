HDFS-10885. [SPS]: Mover tool should not be allowed to run when Storage Policy Satisfier is on. Contributed by Wei Zhou

-    sps = new StoragePolicySatisfier(namesystem, storageMovementNeeded, this);
+    final boolean storagePolicyEnabled =
+        conf.getBoolean(DFSConfigKeys.DFS_STORAGE_POLICY_ENABLED_KEY,
+            DFSConfigKeys.DFS_STORAGE_POLICY_ENABLED_DEFAULT);
+    final boolean spsEnabled =
+        conf.getBoolean(
+            DFSConfigKeys.DFS_STORAGE_POLICY_SATISFIER_ACTIVATE_KEY,
+            DFSConfigKeys.DFS_STORAGE_POLICY_SATISFIER_ACTIVATE_DEFAULT);
+    if (storagePolicyEnabled && spsEnabled) {
+      sps = new StoragePolicySatisfier(namesystem,
+          storageMovementNeeded, this);
+    } else {
+      sps = null;
+      LOG.warn(
+          "Failed to start StoragePolicySatisfier"
+              + " since {} set to {} and {} set to {}.",
+          DFSConfigKeys.DFS_STORAGE_POLICY_ENABLED_KEY, storagePolicyEnabled,
+          DFSConfigKeys.DFS_STORAGE_POLICY_SATISFIER_ACTIVATE_KEY, spsEnabled);
+    }
-    sps.start();
+    if (sps != null) {
+      sps.start();
+    }
-    sps.stop();
+    if (sps != null) {
+      sps.stop();
+    }

INS60 INS60 INS25 INS25 INS25 INS83 INS39 INS59 INS83 INS39 INS59 INS27 INS8 INS8 INS27 INS8 INS27 INS8 INS42 INS32 INS42 INS32 INS42 INS42 MOV21 INS21 INS21 INS42 INS33 MOV21 INS42 INS33 MOV21 INS42 INS42 INS40 INS40 INS42 INS42 INS40 INS40 INS7 INS32 INS42 INS33 INS42 INS42 INS27 INS40 INS42 INS40 INS42 INS45 INS45