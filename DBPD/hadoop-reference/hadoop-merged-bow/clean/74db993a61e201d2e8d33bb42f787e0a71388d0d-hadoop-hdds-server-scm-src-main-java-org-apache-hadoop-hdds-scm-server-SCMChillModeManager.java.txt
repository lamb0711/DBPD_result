HDDS-609. On restart, SCM does not exit chill mode as it expects DNs to report containers in ALLOCATED state. Contributed by Hanisha Koneru.

+import org.apache.hadoop.hdds.protocol.proto.HddsProtos;
-    // Containers read from scm db.
+    // Containers read from scm db (excluding containers in ALLOCATED state).
-          if (c != null) {
+          // Containers in ALLOCATED state should not be included while
+          // calculating the total number of containers here. They are not
+          // reported by DNs and hence should not affect the chill mode exit
+          // rule.
+          if (c != null && c.getState() != null &&
+              !c.getState().equals(HddsProtos.LifeCycleState.ALLOCATED)) {
-        maxContainer = containers.size();
+        maxContainer = containerMap.size();

INS26 INS40 UPD42 INS27 INS27 INS38 MOV27 INS27 INS32 INS32 INS33 INS32 INS42 INS40 INS42 INS42 INS42 INS42