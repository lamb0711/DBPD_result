HDFS-14564: Add libhdfs APIs for readFully; add readFully to ByteBufferPositionedReadable (#963) Contributed by Sahil Takiar.

Reviewed-by: Siyao Meng <smeng@cloudera.com>
-      throw new IllegalArgumentException(
-          "In is not an instance of Seekable or PositionedReadable");
+      throw new IllegalArgumentException(in.getClass().getCanonicalName() +
+          " is not an instance of Seekable or PositionedReadable");
-            "by input stream");
+            "by " + in.getClass().getCanonicalName());
-      throw new UnsupportedOperationException(
-          "this stream does not support setting the readahead " +
-          "caching strategy.");
+      throw new UnsupportedOperationException(in.getClass().getCanonicalName() +
+          " does not support setting the readahead caching strategy.");
-        "by input stream");
+        "by " + in.getClass().getCanonicalName());
+  }
+
+  @Override
+  public void readFully(long position, ByteBuffer buf) throws IOException {
+    if (in instanceof ByteBufferPositionedReadable) {
+      ((ByteBufferPositionedReadable) in).readFully(position, buf);
+    } else {
+      throw new UnsupportedOperationException("Byte-buffer pread " +
+              "unsupported by " + in.getClass().getCanonicalName());
+    }

INS31 INS78 INS83 INS39 INS42 INS44 INS44 INS43 INS8 INS42 INS39 INS42 INS43 INS42 INS42 INS25 INS42 INS62 INS8 INS8 INS42 INS43 INS21 INS53 UPD45 INS32 UPD45 INS32 INS42 INS32 INS14 INS27 INS32 INS42 INS32 INS42 INS36 INS42 INS42 INS42 INS43 INS27 INS32 INS45 INS42 INS42 INS42 INS42 INS11 INS42 INS45 INS45 INS32 INS32 INS42 INS32 UPD45 INS43 INS42 INS32 INS42 INS42 INS42 INS32 INS42 INS42 INS42 INS42 INS42 INS42 DEL45 DEL45