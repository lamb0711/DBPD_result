HADOOP-16959. Resolve hadoop-cos dependency conflict. Contributed by Yang Yu.

-import com.qcloud.cos.exception.CosClientException;
-public class COSCredentialProviderList implements
+public class COSCredentialsProviderList implements
-      LoggerFactory.getLogger(COSCredentialProviderList.class);
+      LoggerFactory.getLogger(COSCredentialsProviderList.class);
-      new ArrayList<>(1);
+      new ArrayList<COSCredentialsProvider>(1);
-  public COSCredentialProviderList() {
+  public COSCredentialsProviderList() {
-  public COSCredentialProviderList(
+  public COSCredentialsProviderList(
-  public COSCredentialProviderList share() {
+  public COSCredentialsProviderList share() {
-      try {
-        COSCredentials credentials = provider.getCredentials();
-        if (!StringUtils.isNullOrEmpty(credentials.getCOSAccessKeyId())
-            && !StringUtils.isNullOrEmpty(credentials.getCOSSecretKey())
-            || credentials instanceof AnonymousCOSCredentials) {
-          this.lastProvider = provider;
-          return credentials;
-        }
-      } catch (CosClientException e) {
-        LOG.warn("No credentials provided by {}: {}", provider, e.toString());
+      COSCredentials credentials = provider.getCredentials();
+      if (null != credentials
+           && !StringUtils.isNullOrEmpty(credentials.getCOSAccessKeyId())
+           && !StringUtils.isNullOrEmpty(credentials.getCOSSecretKey())
+           || credentials instanceof AnonymousCOSCredentials) {
+        this.lastProvider = provider;
+        return credentials;
+  public void refresh() {
+    if (this.closed()) {
+      return;
+    }
+
+    for (COSCredentialsProvider cosCredentialsProvider : this.providers) {
+      cosCredentialsProvider.refresh();
+    }
+  }
+
+  @Override
-

UPD42 INS31 UPD42 UPD42 UPD43 MOV8 INS78 INS83 INS39 INS42 INS8 UPD42 MOV25 MOV21 MOV25 INS70 MOV53 INS42 INS25 INS70 UPD74 MOV44 MOV22 MOV8 INS32 INS8 INS44 INS22 INS8 UPD43 INS43 INS52 INS42 INS41 INS43 INS42 INS52 INS42 INS21 UPD42 INS42 INS42 INS32 MOV42 INS42 INS42 INS27 INS27 MOV38 INS33 INS42 DEL40 DEL26 DEL43 DEL42 DEL44 DEL42 DEL42 DEL45 DEL42 DEL42 DEL32 DEL32 DEL21 DEL8 DEL12 DEL54 DEL70 DEL8