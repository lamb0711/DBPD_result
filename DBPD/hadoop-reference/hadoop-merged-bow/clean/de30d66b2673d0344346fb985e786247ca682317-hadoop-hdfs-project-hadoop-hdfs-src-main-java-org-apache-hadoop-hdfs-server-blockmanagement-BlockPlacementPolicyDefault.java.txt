HDFS-8131. Implement a space balanced block placement policy. Contributed by Liu Shaohui.

-      DatanodeDescriptor chosenNode = 
-          (DatanodeDescriptor)clusterMap.chooseRandom(scope);
+      DatanodeDescriptor chosenNode = chooseDataNode(scope);
+   * Choose a datanode from the given <i>scope</i>.
+   * @return the chosen node, if there is any.
+   */
+  protected DatanodeDescriptor chooseDataNode(final String scope) {
+    return (DatanodeDescriptor) clusterMap.chooseRandom(scope);
+  }
+
+  /**

INS31 INS29 INS83 MOV43 INS42 INS44 INS8 INS65 INS65 INS83 INS43 INS42 INS41 INS66 INS66 INS42 MOV11 INS43 INS42 INS32 INS42 INS42