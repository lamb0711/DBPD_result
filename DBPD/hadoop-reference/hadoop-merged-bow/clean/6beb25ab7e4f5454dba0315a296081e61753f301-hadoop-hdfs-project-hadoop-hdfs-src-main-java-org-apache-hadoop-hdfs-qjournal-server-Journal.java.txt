HDFS-13544. Improve logging for JournalNode in federated cluster.

-      LOG.info("Latest log is " + latestLog);
+      LOG.info("Latest log is " + latestLog + " ; journal id: " + journalId);
-            "moving it aside and looking for previous log");
+            "moving it aside and looking for previous log"
+            + " ; journal id: " + journalId);
-    LOG.info("Formatting " + this + " with namespace info: " +
+    LOG.info("Formatting journal id : " + journalId + " with namespace info: " +
-          getLastPromisedEpoch());
+          getLastPromisedEpoch() + " ; journal id: " + journalId);
-        " to " + newEpoch + " for client " + Server.getRemoteIp());
+        " to " + newEpoch + " for client " + Server.getRemoteIp() +
+        " ; journal id: " + journalId);
-        "Can't write, no segment open");
+        "Can't write, no segment open" + " ; journal id: " + journalId);
-          + " but current segment is " + curSegmentTxId);
+              + " but current segment is " + curSegmentTxId
+              + " ; journal id: " + journalId);
-        "Can't write txid " + firstTxnId + " expecting nextTxId=" + nextTxId);
+        "Can't write txid " + firstTxnId + " expecting nextTxId=" + nextTxId
+            + " ; journal id: " + journalId);
-      LOG.trace("Writing txid " + firstTxnId + "-" + lastTxnId);
+      LOG.trace("Writing txid " + firstTxnId + "-" + lastTxnId +
+          " ; journal id: " + journalId);
-               " took " + milliSeconds + "ms");
+               " took " + milliSeconds + "ms" + " ; journal id: " + journalId);
-          lastPromisedEpoch.get());
+          lastPromisedEpoch.get() + " ; journal id: " + journalId);
-        "IPC serial %s", reqInfo.getIpcSerialNumber(),
-        Server.getRemoteIp(),
-        currentEpochIpcSerial);
+        "IPC serial %s ; journal id: %s", reqInfo.getIpcSerialNumber(),
+        Server.getRemoteIp(), currentEpochIpcSerial, journalId);
-          committedTxnId.get() + " to " + reqInfo.getCommittedTxId());
+          committedTxnId.get() + " to " + reqInfo.getCommittedTxId() +
+              " ; journal id: " + journalId);
-          lastWriterEpoch.get());
+          lastWriterEpoch.get() + " ; journal id: " + journalId);
-          storage.getSingularStorageDir() + " not formatted");
+          storage.getSingularStorageDir() + " not formatted" +
+          " ; journal id: " + journalId);
-          "Aborting the current segment in order to begin the new one.");
+          "Aborting the current segment in order to begin the new one." +
+          " ; journal id: " + journalId);
-            existing + " beginning at " + txid);
+            existing + " beginning at " + txid + " ; journal id: " + journalId);
-            existing + " seems to contain valid transactions");
+            existing + " seems to contain valid transactions" +
+            " ; journal id: " + journalId);
-          Server.getRemoteIp());
+          Server.getRemoteIp() + " ; journal id: " + journalId);
-          "txid %s but only written up to txid %s",
-          startTxId, endTxId, nextTxId - 1);
+          "txid %s but only written up to txid %s ; journal id: %s",
+          startTxId, endTxId, nextTxId - 1, journalId);
-          "transaction ID " + startTxId);
+          "transaction ID " + startTxId + " ; journal id: " + journalId);
-            "finalized");
+            "finalized ; journal id: " + journalId);
-            "txid %s but log %s on disk only contains up to txid %s",
-            startTxId, endTxId, elf.getFile(), elf.getLastTxId());
+            "txid %s but log %s on disk only contains up to txid %s " +
+            "; journal id: %s",
+            startTxId, endTxId, elf.getFile(), elf.getLastTxId(), journalId);
-              elf + " with different endTxId " + endTxId);
+              elf + " with different endTxId " + endTxId +
+              " ; journal id: " + journalId);
-        throw new IOException("Unable to delete paxos file " + paxosFile);
+        throw new IOException("Unable to delete paxos file " + paxosFile +
+            " ; journal id: " + journalId);
-          "Moving it aside...");
+          "Moving it aside..." + " ; journal id: " + journalId);
-        TextFormat.shortDebugString(ret));
+        TextFormat.shortDebugString(ret) + " ; journal id: " + journalId);
-        TextFormat.shortDebugString(resp));
+        TextFormat.shortDebugString(resp) + " ; journal id: " + journalId);
-        "bad recovery state for segment %s: %s",
-        segmentTxId, TextFormat.shortDebugString(segment));
+        "bad recovery state for segment %s: %s ; journal id: %s",
+        segmentTxId, TextFormat.shortDebugString(segment), journalId);
-          "Bad paxos transition, out-of-order epochs.\nOld: %s\nNew: %s\n",
-          oldData, newData);
+          "Bad paxos transition, out-of-order epochs.\nOld: %s\nNew: " +
+              "%s\nJournalId: %s\n",
+          oldData, newData, journalId);
-            ": no current segment in place");
+            ": no current segment in place ; journal id: " + journalId);
-            " is not the right length");
+            " is not the right length ; journal id: " + journalId);
-              committedTxnId.get());
+              committedTxnId.get() +
+              " ; journal id: " + journalId);
-            "Should never be asked to synchronize a different log on top of an " +
-            "already-finalized segment");
+            "Should never be asked to synchronize a different log on top of " +
+            "an already-finalized segment ; journal id: " + journalId);
-          ": already have up-to-date logs");
+          ": already have up-to-date logs ; journal id: " + journalId);
-        TextFormat.shortDebugString(newData));
+        TextFormat.shortDebugString(newData) + " ; journal id: " + journalId);
-        "invalid segment: %s", seg);
+        "invalid segment: %s ; journal id: %s", seg, journalId);
-          tmp + " -> " + dst);
+          tmp + " -> " + dst + " ; journal id: " + journalId);
-          "Bad persisted data for segment %s: %s",
-          segmentTxId, ret);
+          "Bad persisted data for segment %s: %s ; journal id: %s",
+          segmentTxId, ret, journalId);
-    LOG.info("Starting upgrade of edits directory: "
+    LOG.info("Starting upgrade of edits directory: " + storage.getRoot()
-            "segment move to current directory");
+            "segment move to current directory ; journal id: " + journalId);
-            finalFile);
+            finalFile + " ; journal id: " + journalId);
-          finalFile);
+          finalFile + " ; journal id: " + journalId);

MOV8 INS27 INS42 UPD45 INS42 UPD45 INS42 MOV21 UPD45 INS42 INS45 INS42 INS45 INS45 INS42 MOV43 INS45 INS42 UPD45 INS45 INS42 INS45 INS42 INS8 INS45 INS42 MOV45 INS32 MOV45 INS42 INS27 INS42 INS21 MOV21 UPD45 INS42 INS42 INS42 MOV21 INS45 INS42 INS45 INS42 MOV43 INS45 INS42 INS45 INS42 INS45 INS42 INS45 INS42 INS45 INS42 INS45 INS42 INS45 INS42 INS45 INS42 UPD45 INS27 INS45 INS42 INS45 INS42 INS45 INS42 INS45 INS45 INS32 UPD45 UPD45 INS42 INS45 INS42 INS27 INS45 INS42 INS45 INS42 MOV43 MOV43 MOV45 MOV45 INS42 INS42 INS42 INS27 MOV45 MOV45 INS45 INS42 INS45 INS42 INS45 INS42 UPD45 INS42 UPD45 INS45 INS45 INS42 INS45 MOV32 INS45 INS42 MOV32 UPD45 INS42 UPD45 UPD45 INS42 UPD45 INS42 INS45 INS42 INS45 INS42 DEL52 DEL45 DEL45 DEL42 DEL42 DEL45 DEL45 DEL27 DEL32 DEL21 DEL8 DEL27