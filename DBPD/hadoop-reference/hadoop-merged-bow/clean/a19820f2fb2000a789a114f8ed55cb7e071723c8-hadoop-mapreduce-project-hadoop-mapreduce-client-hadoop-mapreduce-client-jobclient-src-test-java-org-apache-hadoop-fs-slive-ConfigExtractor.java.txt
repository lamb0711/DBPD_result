MAPREDUCE-6228. Add truncate operation to SLive. Constributed by Plamen Jeliazkov.
+   * @return whether the mapper or reducer should wait for truncate recovery
+   */
+  boolean shouldWaitOnTruncate() {
+    return shouldWaitOnTruncate(null);
+  }
+
+  /**
+   * @param primary
+   *          primary the initial string to be used for the value of this
+   *          configuration option (if not provided then config and then the
+   *          default are used)
+   *
+   * @return whether the mapper or reducer should wait for truncate recovery
+   */
+  boolean shouldWaitOnTruncate(String primary) {
+    String val = primary;
+    if (val == null) {
+      val = config.get(ConfigOption.EXIT_ON_ERROR.getCfgOption());
+    }
+    if (val == null) {
+      return ConfigOption.EXIT_ON_ERROR.getDefault();
+    }
+    return Boolean.parseBoolean(val);
+  }
+
+  /**
+   * @return the truncate byte size range (or null if none)
+   */
+  Range<Long> getTruncateSize(String primary) {
+    return getMinMaxBytes(ConfigOption.TRUNCATE_SIZE, primary);
+  }
+
+  /**
+   * @return the truncate byte size range (or null if none) using config and
+   *         default for lookup
+   */
+  Range<Long> getTruncateSize() {
+    return getTruncateSize(null);
+  }
+
+  /**
+   * @param primary
+   *          the initial string to be used for the value of this configuration
+   *          option (if not provided then config and then the default are used)
+   * Returns whether the truncate range should use the block size range
+   *
+   * @return true|false
+   */
+  boolean shouldTruncateUseBlockSize() {
+    Range<Long> truncateRange = getTruncateSize();
+    if (truncateRange == null
+        || (truncateRange.getLower() == truncateRange.getUpper()
+            && (truncateRange.getUpper() == Long.MAX_VALUE))) {
+      return true;
+    }
+    return false;
+  }
+
+  /**

INS31 INS31 INS31 INS31 INS31 INS29 INS39 INS42 INS8 INS29 INS39 INS42 INS44 INS8 INS29 INS74 INS42 INS44 INS8 INS29 INS74 INS42 INS8 INS29 INS39 INS42 INS8 INS65 INS41 INS65 INS65 INS43 INS42 INS60 INS25 INS25 INS41 INS65 INS65 INS43 INS43 INS43 INS42 INS41 INS65 INS43 INS43 INS41 INS65 INS65 INS60 INS25 INS41 INS66 INS32 INS42 INS66 INS66 INS66 INS66 INS42 INS43 INS59 INS27 INS8 INS27 INS8 INS32 INS42 INS66 INS66 INS66 INS42 INS42 INS42 INS32 INS66 INS66 INS42 INS42 INS32 INS66 INS66 INS74 INS59 INS27 INS8 INS9 INS42 INS33 INS42 INS42 INS42 INS42 INS33 INS21 INS42 INS33 INS41 INS42 INS42 INS42 INS42 INS40 INS42 INS42 INS33 INS43 INS43 INS42 INS32 INS27 INS36 INS41 INS7 INS32 INS42 INS42 INS42 INS42 INS33 INS27 INS9 INS42 INS32 INS40 INS42 INS27 INS36 INS42 INS42 INS32 INS32 INS32 INS27 INS40 INS42 INS42 INS42 INS42 INS42 INS32 INS40 INS42 INS42