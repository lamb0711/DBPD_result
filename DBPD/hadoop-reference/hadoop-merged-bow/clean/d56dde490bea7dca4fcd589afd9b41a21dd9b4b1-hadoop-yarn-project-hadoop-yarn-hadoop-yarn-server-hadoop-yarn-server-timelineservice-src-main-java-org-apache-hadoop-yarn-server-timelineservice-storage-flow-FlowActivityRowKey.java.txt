YARN-4700. ATS storage has one extra record each time the RM got restarted. (Naganarasimha G R via Varun Saxena)

-   * Will insert into current day's record in the table. Uses current time to
-   * store top of the day timestamp.
-   * @param userId User Id.
-   * @param flowName Flow Name.
-   * @return byte array with the row key prefix
-   */
-  public static byte[] getRowKey(String clusterId, String userId,
-      String flowName) {
-    long dayTs = TimelineStorageUtils.getTopOfTheDayTimestamp(System
-        .currentTimeMillis());
-    return getRowKey(clusterId, dayTs, userId, flowName);
-  }
-
-  /**
-   * Constructs a row key for the flow activity table as follows:
-   * {@code clusterId!dayTimestamp!user!flowName}.
-   *
-   * @param clusterId Cluster Id.
-   * @param dayTs Top of the day timestamp.
+   * @param eventTs event's TimeStamp.
-  public static byte[] getRowKey(String clusterId, long dayTs, String userId,
+  public static byte[] getRowKey(String clusterId, long eventTs, String userId,
+    // convert it to Day's time stamp
+    eventTs = TimelineStorageUtils.getTopOfTheDayTimestamp(eventTs);
+
-        Bytes.toBytes(TimelineStorageUtils.invertLong(dayTs)),
+        Bytes.toBytes(TimelineStorageUtils.invertLong(eventTs)),

UPD42 INS21 UPD42 UPD66 INS7 INS42 INS32 INS42 INS42 INS42 UPD42 DEL66 DEL66 DEL65 DEL66 DEL66 DEL66 DEL65 DEL42 DEL66 DEL65 DEL42 DEL66 DEL65 DEL42 DEL66 DEL65 DEL66 DEL65 DEL29 DEL83 DEL83 DEL39 DEL85 DEL5 DEL42 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL44 DEL39 DEL42 DEL42 DEL42 DEL42 DEL42 DEL32 DEL32 DEL59 DEL60 DEL42 DEL42 DEL42 DEL42 DEL42 DEL32 DEL41 DEL8 DEL31