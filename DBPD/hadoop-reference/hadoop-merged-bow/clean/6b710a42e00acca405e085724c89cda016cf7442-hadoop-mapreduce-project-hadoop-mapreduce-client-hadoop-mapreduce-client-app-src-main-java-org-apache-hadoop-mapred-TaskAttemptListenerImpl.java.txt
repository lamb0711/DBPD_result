Fixing MR intermediate spills. Contributed by Arun Suresh.

-      .newSetFromMap(new ConcurrentHashMap<WrappedJvmID, Boolean>()); 
-  
+      .newSetFromMap(new ConcurrentHashMap<WrappedJvmID, Boolean>());
+
-  
+  private byte[] encryptedSpillKey;
+
+    this(context, jobTokenSecretManager, rmHeartbeatHandler,
+            preemptionPolicy, null);
+  }
+
+  public TaskAttemptListenerImpl(AppContext context,
+      JobTokenSecretManager jobTokenSecretManager,
+      RMHeartbeatHandler rmHeartbeatHandler,
+      AMPreemptionPolicy preemptionPolicy, byte[] secretShuffleKey) {
+    this.encryptedSpillKey = secretShuffleKey;
+        task.setEncryptedSpillKey(encryptedSpillKey);

INS23 INS31 INS83 INS5 INS59 INS83 INS42 INS44 INS44 INS44 INS44 INS8 INS44 INS39 INS85 INS42 INS43 INS42 INS43 INS42 INS43 INS42 INS43 INS42 INS17 INS5 INS42 INS21 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS33 INS39 INS85 INS7 INS22 INS42 INS52 INS42 INS21 INS32 INS42 INS42 INS42