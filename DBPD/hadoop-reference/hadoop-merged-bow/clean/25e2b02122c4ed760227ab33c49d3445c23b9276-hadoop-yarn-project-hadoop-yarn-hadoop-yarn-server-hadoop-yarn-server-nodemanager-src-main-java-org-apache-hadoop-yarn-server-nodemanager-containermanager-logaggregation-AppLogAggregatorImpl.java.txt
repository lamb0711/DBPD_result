YARN-3476. Nodemanager can fail to delete local logs if log aggregation fails. Contributed by Rohith

+    } catch (Exception e) {
+      // do post clean up of log directories on any exception
+      LOG.error("Error occured while aggregating the log for the application "
+          + appId, e);
+      doAppLogAggregationPostCleanUp();
+    doAppLogAggregationPostCleanUp();
+
+    this.dispatcher.getEventHandler().handle(
+        new ApplicationEvent(this.appId,
+            ApplicationEventType.APPLICATION_LOG_HANDLING_FINISHED));
+    this.appAggregationFinished.set(true);
+  }
+
+  private void doAppLogAggregationPostCleanUp() {
-    
-    this.dispatcher.getEventHandler().handle(
-        new ApplicationEvent(this.appId,
-            ApplicationEventType.APPLICATION_LOG_HANDLING_FINISHED));
-    this.appAggregationFinished.set(true);    

INS31 INS83 INS39 INS42 INS8 INS21 MOV60 MOV70 MOV25 INS12 INS32 INS44 INS8 INS42 INS43 INS42 INS21 INS21 INS42 INS32 INS32 INS42 INS42 INS27 INS42 INS42 INS45 INS42