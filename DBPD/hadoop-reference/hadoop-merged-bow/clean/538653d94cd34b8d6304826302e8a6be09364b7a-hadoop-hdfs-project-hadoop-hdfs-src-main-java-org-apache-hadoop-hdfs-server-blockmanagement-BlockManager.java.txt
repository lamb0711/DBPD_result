HDFS-5020. Make DatanodeProtocol#blockReceivedAndDeleted idempotent. Contributed by Jing Zhao.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1506421 13f79535-47bb-0310-9956-ffa450edef68

-          pendingReplications.increment(block, targets.length);
+          pendingReplications.increment(block, targets);
+    // for a retry request (of DatanodeProtocol#blockReceivedAndDeleted with 
+    // RECEIVED_BLOCK), we currently also decrease the approximate number. 
-    pendingReplications.decrement(block);
+    pendingReplications.decrement(block, node);

INS42 INS42 DEL40