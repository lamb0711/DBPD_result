HADOOP-14407. DistCp - Introduce a configurable copy buffer size. (Omkar Aradhya K S via Yongjun Zhang)

+import org.apache.hadoop.tools.DistCpOptionSwitch;
-  private static int BUFFER_SIZE = 8 * 1024;
+    int copyBufferSize = context.getConfiguration().getInt(
+        DistCpOptionSwitch.COPY_BUFFER_SIZE.getConfigLabel(),
+        DistCpConstants.COPY_BUFFER_SIZE_DEFAULT);
-          BUFFER_SIZE, repl, blockSize, context,
+          copyBufferSize, repl, blockSize, context,
-          BUFFER_SIZE));
+          copyBufferSize));
-    return copyBytes(source, sourceOffset, outStream, BUFFER_SIZE,
+    return copyBytes(source, sourceOffset, outStream, copyBufferSize,

INS26 INS40 INS60 INS39 INS59 INS42 INS32 UPD42 INS32 INS42 INS32 INS40 INS42 INS42 INS40 INS42 UPD42 UPD42 DEL83 DEL83 DEL39 DEL42 DEL34 DEL34 DEL27 DEL59 DEL23