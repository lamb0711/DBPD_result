Merge branch 'trunk' into HDFS-6581

-    return new ApplicationHistoryManagerImpl();
+    // Backward compatibility:
+    // APPLICATION_HISTORY_STORE is neither null nor empty, it means that the
+    // user has enabled it explicitly.
+    if (conf.get(YarnConfiguration.APPLICATION_HISTORY_STORE) == null ||
+        conf.get(YarnConfiguration.APPLICATION_HISTORY_STORE).length() == 0) {
+      return new ApplicationHistoryManagerOnTimelineStore(timelineDataManager);
+    } else {
+      LOG.warn("The filesystem based application history store is deprecated.");
+      return new ApplicationHistoryManagerImpl();
+    }

INS8 INS25 INS27 INS8 MOV8 INS27 INS27 INS41 INS21 INS32 INS33 INS32 INS34 INS14 INS32 INS42 INS42 INS40 INS32 INS42 INS43 INS42 INS42 INS42 INS45 INS42 INS42 INS40 INS42