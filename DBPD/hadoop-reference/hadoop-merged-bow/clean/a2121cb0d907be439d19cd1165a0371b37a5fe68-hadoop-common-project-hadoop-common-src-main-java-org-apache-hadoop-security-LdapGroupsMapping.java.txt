HADOOP-14465. LdapGroupsMapping - support user and group search base. Contributed by Shwetha G S and Mingliang Liu

+   * Base DN used in user search.
+   */
+  public static final String USER_BASE_DN_KEY =
+          LDAP_CONFIG_PREFIX + ".userbase";
+
+  /*
+   * Base DN used in group search.
+   */
+  public static final String GROUP_BASE_DN_KEY =
+          LDAP_CONFIG_PREFIX + ".groupbase";
+
+
+  /*
-  private static final SearchControls SEARCH_CONTROLS = new SearchControls();
+  static final SearchControls SEARCH_CONTROLS = new SearchControls();
-  private String baseDN;
+  private String userbaseDN;
+  private String groupbaseDN;
-      return c.search(baseDN,
+      return c.search(groupbaseDN,
-          c.search(baseDN,
+          c.search(groupbaseDN,
-    NamingEnumeration<SearchResult> results = c.search(baseDN,
+    NamingEnumeration<SearchResult> results = c.search(userbaseDN,
-        context.search(baseDN,
+        context.search(groupbaseDN,
-    baseDN = conf.get(BASE_DN_KEY, BASE_DN_DEFAULT);
+    String baseDN = conf.getTrimmed(BASE_DN_KEY, BASE_DN_DEFAULT);
+
+    //User search base which defaults to base dn.
+    userbaseDN = conf.getTrimmed(USER_BASE_DN_KEY, baseDN);
+    if (LOG.isDebugEnabled()) {
+      LOG.debug("Usersearch baseDN: " + userbaseDN);
+    }
+
+    //Group search base which defaults to base dn.
+    groupbaseDN = conf.getTrimmed(GROUP_BASE_DN_KEY, baseDN);
+    if (LOG.isDebugEnabled()) {
+      LOG.debug("Groupsearch baseDN: " + userbaseDN);
+    }
+

INS23 INS23 INS23 INS83 INS83 INS83 INS43 INS59 INS83 INS83 INS83 INS43 INS59 INS83 INS43 INS59 INS42 INS42 INS27 INS42 INS42 INS27 UPD42 INS42 INS42 INS60 INS25 INS21 INS25 INS42 INS45 INS42 INS45 INS43 INS59 INS32 INS8 INS7 INS32 INS8 INS42 INS42 INS32 UPD42 INS42 INS42 INS21 INS42 INS32 INS42 INS42 INS21 UPD42 UPD42 INS42 INS42 INS42 INS42 UPD42 UPD42 UPD42 INS32 INS42 INS42 INS42 INS42 INS32 UPD42 INS42 INS42 INS27 INS42 INS42 INS27 UPD42 INS45 INS42 INS45 INS42 DEL83