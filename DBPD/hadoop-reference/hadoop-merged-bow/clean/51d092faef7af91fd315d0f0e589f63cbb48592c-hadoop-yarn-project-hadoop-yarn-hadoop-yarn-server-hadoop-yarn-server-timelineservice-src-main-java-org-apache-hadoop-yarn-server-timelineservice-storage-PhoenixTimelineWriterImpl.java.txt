YARN-3529. Added mini HBase cluster and Phoenix support to timeline service v2 unit tests. Contributed by Li Lu.

+import org.apache.hadoop.yarn.conf.YarnConfiguration;
+import java.util.Properties;
+  public static final String TIMELINE_SERVICE_PHOENIX_STORAGE_CONN_STR
+      = YarnConfiguration.TIMELINE_SERVICE_PREFIX
+          + "writer.phoenix.connectionString";
+
+  public static final String TIMELINE_SERVICE_PHEONIX_STORAGE_CONN_STR_DEFAULT
+      = "jdbc:phoenix:localhost:2181:/hbase";
+
-  static final String CONN_STRING = "jdbc:phoenix:localhost:2181:/hbase";
+  @VisibleForTesting
+  String connString = null;
+  @VisibleForTesting
+  Properties connProperties = new Properties();
+    // so check it here and only read in the config if it's not overridden.
+    connString =
+        conf.get(TIMELINE_SERVICE_PHOENIX_STORAGE_CONN_STR,
+        TIMELINE_SERVICE_PHEONIX_STORAGE_CONN_STR_DEFAULT);
-  static Connection getConnection() throws IOException {
+  Connection getConnection() throws IOException {
-      conn = DriverManager.getConnection(CONN_STRING);
+      conn = DriverManager.getConnection(connString, connProperties);

INS26 INS26 INS40 INS40 INS23 INS23 INS23 INS83 INS83 INS83 INS43 INS59 INS83 INS83 INS83 INS43 INS59 INS78 INS78 INS43 INS59 INS42 INS42 INS27 INS42 INS42 INS45 INS42 UPD42 INS33 INS42 INS42 INS42 INS14 INS21 INS40 INS45 INS43 INS7 INS42 INS42 INS32 INS42 INS42 INS42 INS42 UPD42 INS42 DEL83 DEL83 DEL45 DEL83