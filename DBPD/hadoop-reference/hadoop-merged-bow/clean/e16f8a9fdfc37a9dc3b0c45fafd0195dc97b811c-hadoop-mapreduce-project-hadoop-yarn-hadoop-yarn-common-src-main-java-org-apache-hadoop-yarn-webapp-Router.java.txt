MAPREDUCE-3038. job history server not starting because conf() missing HsController (Jeffrey Naisbitt via mahadev)

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1172875 13f79535-47bb-0310-9956-ffa450edef68

+import java.lang.NoSuchMethodException;
+import java.lang.SecurityException;
-    for (Method method : cls.getDeclaredMethods()) {
-      if (method.getName().equals(action) &&
-          method.getParameterTypes().length == 0 &&
-          Modifier.isPublic(method.getModifiers())) {
-        // TODO: deal with parameters using the names
-        Dest dest = routes.get(path);
-        if (dest == null) {
-          method.setAccessible(true); // avoid any runtime checks
-          dest = new Dest(path, method, cls, names, httpMethod);
-          routes.put(path, dest);
-          return dest;
-        }
-        dest.methods.add(httpMethod);
+    try {
+      // Look for the method in all public methods declared in the class
+      // or inherited by the class.
+      // Note: this does not distinguish methods with the same signature
+      // but different return types.
+      // TODO: We may want to deal with methods that take parameters in the future
+      Method method = cls.getMethod(action, null);
+      Dest dest = routes.get(path);
+      if (dest == null) {
+        method.setAccessible(true); // avoid any runtime checks
+        dest = new Dest(path, method, cls, names, httpMethod);
+        routes.put(path, dest);
+      dest.methods.add(httpMethod);
+      return dest;
+    } catch (NoSuchMethodException nsme) {
+      throw new WebAppException(action + "() not found in " + cls);
+    } catch (SecurityException se) {
+      throw new WebAppException("Security exception thrown for " + action +
+        "() in " + cls);
-    throw new WebAppException(action + "() not found in " + cls);

INS26 INS26 INS40 INS40 MOV8 INS54 MOV8 INS12 INS12 INS60 INS44 INS8 INS44 INS8 MOV43 INS59 INS43 INS42 MOV53 INS43 INS42 INS53 INS42 INS32 INS42 INS42 INS14 INS42 INS42 INS42 INS33 INS43 INS27 INS42 INS45 INS42 INS45 INS42 DEL42 DEL42 DEL32 DEL42 DEL42 DEL32 DEL42 DEL42 DEL32 DEL42 DEL22 DEL34 DEL27 DEL27 DEL42 DEL42 DEL42 DEL42 DEL32 DEL32 DEL27 DEL25 DEL42 DEL44 DEL42 DEL42 DEL32 DEL70 DEL8