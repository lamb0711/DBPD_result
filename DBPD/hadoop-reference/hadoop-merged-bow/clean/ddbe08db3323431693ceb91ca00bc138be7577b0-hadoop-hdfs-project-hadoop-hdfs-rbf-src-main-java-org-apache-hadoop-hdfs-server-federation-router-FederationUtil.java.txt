HDFS-13955. RBF: Support secure Namenode in NamenodeHeartbeatService. Contributed by CR Hota.

+import org.apache.hadoop.hdfs.web.URLConnectionFactory;
+import org.apache.hadoop.security.UserGroupInformation;
+   * @param connectionFactory to open http/https connection.
+   * @param scheme to use for URL connection.
-  public static JSONArray getJmx(String beanQuery, String webAddress) {
+  public static JSONArray getJmx(String beanQuery, String webAddress,
+      URLConnectionFactory connectionFactory, String scheme) {
-      URL jmxURL = new URL("http", host, port, "/jmx?qry=" + beanQuery);
-      URLConnection conn = jmxURL.openConnection();
+      URL jmxURL = new URL(scheme, host, port, "/jmx?qry=" + beanQuery);
+      LOG.debug("JMX URL: {}", jmxURL);
+      // Create a URL connection
+      URLConnection conn = connectionFactory.openConnection(
+          jmxURL, UserGroupInformation.isSecurityEnabled());

INS26 INS26 INS40 INS40 INS44 INS44 INS65 INS65 INS43 INS42 INS43 INS42 INS42 INS66 INS42 INS66 INS42 INS42 INS21 INS32 INS42 INS42 INS45 INS42 INS42 INS42 INS42 INS32 UPD42 MOV42 INS42 DEL45