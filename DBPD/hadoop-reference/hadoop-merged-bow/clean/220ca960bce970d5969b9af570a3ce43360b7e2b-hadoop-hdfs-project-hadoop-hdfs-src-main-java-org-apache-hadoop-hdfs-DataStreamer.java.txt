HDFS-7672. Handle write failure for stripping blocks and refactor the existing code in DFSStripedOutputStream and StripedDataStreamer.

-            LOG.debug("Allocating new block");
+            LOG.debug("Allocating new block " + this);
-              " is smaller than data size. " +
-              " Offset of packet in block " +
-              lastByteOffsetInBlock +
-              " Aborting file " + src);
+              " < lastByteOffsetInBlock, " + this + ", " + one);
-        LOG.debug("Queued packet " + packet.getSeqno());
+        LOG.debug("Queued " + packet + ", " + this);
+
+  @Override
+  public String toString() {
+    return  (block == null? null: block.getLocalBlock())
+        + "@" + Arrays.toString(getNodes());
+  }

INS31 INS78 INS83 INS43 INS42 INS8 INS42 INS42 INS41 INS27 INS36 INS45 INS32 INS16 INS42 INS42 INS32 INS27 INS33 INS32 INS42 INS42 INS33 INS42 INS42 UPD45 INS42 INS45 INS52 UPD45 INS52 UPD45 UPD42 INS27 INS45 INS52 DEL45 DEL45 DEL42 DEL42 DEL42 DEL32