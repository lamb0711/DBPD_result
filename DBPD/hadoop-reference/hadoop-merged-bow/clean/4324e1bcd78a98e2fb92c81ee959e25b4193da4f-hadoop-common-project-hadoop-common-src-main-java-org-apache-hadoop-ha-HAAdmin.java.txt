HADOOP-7991. HA: the FailoverController should check the standby is ready before failing over. Contributed by Eli Collins


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1239774 13f79535-47bb-0310-9956-ffa450edef68

-  private static final String FORCEFENCE = "forcefence";
+  private static final String FORCEFENCE  = "forcefence";
+  private static final String FORCEACTIVE = "forceactive";
-        new UsageInfo("[--"+FORCEFENCE+"] <host:port> <host:port>",
+        new UsageInfo("[--"+FORCEFENCE+"] [--"+FORCEACTIVE+"] <host:port> <host:port>",
-            "Unconditionally fence services if the "+FORCEFENCE+" option is used."))
+            "Unconditionally fence services if the "+FORCEFENCE+" option is used.\n" +
+            "Try to failover to the target service even if it is not ready if the " + 
+            FORCEACTIVE + " option is used."))
+    boolean forceActive = false;
+    failoverOpts.addOption(FORCEACTIVE, false, "force failover");
+      forceActive = cmd.hasOption(FORCEACTIVE);
-          fencer, forceFence); 
+          fencer, forceFence, forceActive); 

INS23 INS83 INS83 INS83 INS43 INS59 INS42 INS42 INS45 INS60 INS21 INS39 INS59 INS32 INS42 INS9 INS42 INS42 INS42 INS9 INS45 INS21 INS7 INS42 INS32 INS42 INS42 INS42 INS42 INS45 INS42 INS45 INS45 INS42