HDFS-8450. Erasure Coding: Consolidate erasure coding zone related implementation into a single class (Contributed by Rakesh R)

-      updateBlocks(fsDir, addCloseOp, iip, newFile,
-          fsDir.getECSchema(iip), fsDir.isInECZone(iip));
+      ECSchema ecSchema = FSDirErasureCodingOp.getErasureCodingSchema(
+          fsDir.getFSNamesystem(), iip);
+      updateBlocks(fsDir, addCloseOp, iip, newFile, ecSchema);
-      updateBlocks(fsDir, addCloseOp, iip, file,
-          fsDir.getECSchema(iip), fsDir.isInECZone(iip));
+      ECSchema ecSchema = FSDirErasureCodingOp.getErasureCodingSchema(
+          fsDir.getFSNamesystem(), iip);
+      updateBlocks(fsDir, addCloseOp, iip, file, ecSchema);
-      updateBlocks(fsDir, updateOp, iip, oldFile,
-          fsDir.getECSchema(iip), fsDir.isInECZone(iip));
+      ECSchema ecSchema = FSDirErasureCodingOp.getErasureCodingSchema(
+          fsDir.getFSNamesystem(), iip);
+      updateBlocks(fsDir, updateOp, iip, oldFile, ecSchema);
-      addNewBlock(addBlockOp, oldFile,
-          fsDir.getECSchema(iip), fsDir.isInECZone(iip));
+      ECSchema ecSchema = FSDirErasureCodingOp.getErasureCodingSchema(
+          fsDir.getFSNamesystem(), iip);
+      addNewBlock(addBlockOp, oldFile, ecSchema);
-  private void addNewBlock(AddBlockOp op, INodeFile file,
-                           ECSchema schema, boolean isStriped)
+  private void addNewBlock(AddBlockOp op, INodeFile file, ECSchema ecSchema)
+    boolean isStriped = ecSchema != null;
-      newBlockInfo = new BlockInfoStripedUnderConstruction(newBlock, schema);
+      newBlockInfo = new BlockInfoStripedUnderConstruction(newBlock, ecSchema);
-      INodesInPath iip, INodeFile file, ECSchema schema,
-      boolean isStriped) throws IOException {
+      INodesInPath iip, INodeFile file, ECSchema ecSchema) throws IOException {
+      final boolean isStriped = ecSchema != null;
-            newBI = new BlockInfoStripedUnderConstruction(newBlock, schema);
+            newBI = new BlockInfoStripedUnderConstruction(newBlock, ecSchema);

UPD42 INS60 UPD42 INS39 INS59 INS60 INS21 INS60 INS21 INS60 INS21 INS60 INS21 INS42 INS27 INS43 INS59 INS32 INS43 INS59 INS32 INS43 INS59 INS32 INS43 INS59 INS32 INS42 INS33 INS60 INS42 INS42 INS32 INS42 MOV42 UPD42 MOV42 MOV42 INS42 INS42 INS42 INS42 INS32 INS42 MOV42 UPD42 MOV42 MOV42 INS42 INS42 INS42 INS42 INS32 INS42 MOV42 UPD42 MOV42 MOV42 INS42 INS42 INS42 INS42 INS32 UPD42 MOV42 INS42 UPD42 MOV42 UPD42 MOV42 INS83 INS39 INS59 UPD42 MOV42 UPD42 MOV42 INS32 MOV42 UPD42 MOV42 UPD42 MOV42 INS32 MOV42 UPD42 MOV42 UPD42 MOV42 INS32 MOV42 UPD42 MOV42 UPD42 MOV42 INS32 MOV42 UPD42 INS42 INS27 MOV42 UPD42 MOV42 MOV42 UPD42 MOV42 MOV42 UPD42 MOV42 MOV42 UPD42 MOV42 INS42 INS33 UPD42 DEL42 DEL42 DEL42 DEL32 DEL32 DEL32 DEL21 DEL42 DEL42 DEL42 DEL32 DEL32 DEL32 DEL21 DEL42 DEL42 DEL42 DEL32 DEL32 DEL32 DEL21 DEL42 DEL32 DEL32 DEL32 DEL21 DEL39 DEL42 DEL44 DEL39 DEL42 DEL44