HDFS-13057: [SPS]: Revisit configurations to make SPS service modes internal/external/none. Contributed by Rakesh R.

+import org.apache.hadoop.hdfs.protocol.HdfsConstants.StoragePolicySatisfierMode;
-import static org.apache.hadoop.hdfs.DFSConfigKeys.DFS_STORAGE_POLICY_SATISFIER_ENABLED_KEY;
+import static org.apache.hadoop.hdfs.DFSConfigKeys.DFS_STORAGE_POLICY_SATISFIER_MODE_KEY;
-          DFS_STORAGE_POLICY_SATISFIER_ENABLED_KEY));
+          DFS_STORAGE_POLICY_SATISFIER_MODE_KEY));
-    } else if (property.equals(DFS_STORAGE_POLICY_SATISFIER_ENABLED_KEY)) {
+    } else if (property.equals(DFS_STORAGE_POLICY_SATISFIER_MODE_KEY)) {
-    if (newVal == null || !(newVal.equalsIgnoreCase(Boolean.TRUE.toString())
-        || newVal.equalsIgnoreCase(Boolean.FALSE.toString()))) {
+    if (newVal == null
+        || StoragePolicySatisfierMode.fromString(newVal) == null) {
-              "For enabling or disabling storage policy satisfier, "
-                  + "we must pass true/false only"));
+              "For enabling or disabling storage policy satisfier, we must "
+                  + "pass either none/internal/external string value only"));
-
-    boolean enableSPS = Boolean.parseBoolean(newVal);
-    if (enableSPS) {
-      namesystem.getBlockManager().enableSPS();
-    } else {
+    StoragePolicySatisfierMode mode = StoragePolicySatisfierMode
+        .fromString(newVal);
+    switch(mode){
+    case NONE:
+      break;
+    case INTERNAL:
+      namesystem.getBlockManager().enableInternalSPS();
+      break;
+    case EXTERNAL:
+      namesystem.getBlockManager().enableExternalSPS();
+      break;
+    default:
+      // nothing
+      break;

INS26 INS40 UPD40 INS50 INS43 INS42 INS49 MOV21 INS10 INS49 MOV21 INS10 INS49 INS21 INS10 INS49 INS10 UPD42 INS27 INS42 UPD42 INS42 INS42 INS42 INS32 INS32 INS33 UPD42 UPD42 UPD42 INS32 INS42 UPD42 MOV42 UPD42 MOV42 MOV42 INS42 INS42 UPD45 UPD45 UPD42 DEL42 DEL40 DEL32 DEL32 DEL42 DEL40 DEL42 DEL32 DEL32 DEL27 DEL36 DEL38 DEL39 DEL42 DEL8 DEL8 DEL25