HDDS-939. Add S3 access check to Ozone manager. Contributed by Ajay Kumar. (#634)



-    String awsAccessKeyStr = DigestUtils.md5Hex(kerberosID);
-    byte[] awsAccessKey = awsAccessKeyStr.getBytes(UTF_8);
+    byte[] awsAccessKey = kerberosID.getBytes(UTF_8);
-      result.setAwsAccessKey(awsAccessKeyStr);
-    LOG.trace("Secret for kerberosID:{},accessKey:{}, proto:{}", kerberosID,
-        awsAccessKeyStr, result);
+    LOG.trace("Secret for accessKey:{}, proto:{}", kerberosID, result);
-  public String getS3UserSecretString(String awsAccessKeyId)
+  public String getS3UserSecretString(String kerberosID)
-    Preconditions.checkArgument(Strings.isNotBlank(awsAccessKeyId),
+    Preconditions.checkArgument(Strings.isNotBlank(kerberosID),
-    LOG.trace("Get secret for awsAccessKey:{}", awsAccessKeyId);
+    LOG.trace("Get secret for awsAccessKey:{}", kerberosID);
-    omMetadataManager.getLock().acquireS3SecretLock(awsAccessKeyId);
+    omMetadataManager.getLock().acquireS3SecretLock(kerberosID);
-          .get(awsAccessKeyId.getBytes(UTF_8));
+          .get(kerberosID.getBytes(UTF_8));
-            "awsAccessKeyId " + awsAccessKeyId, S3_SECRET_NOT_FOUND);
+            "awsAccessKeyId " + kerberosID, S3_SECRET_NOT_FOUND);
-      omMetadataManager.getLock().releaseS3SecretLock(awsAccessKeyId);
+      omMetadataManager.getLock().releaseS3SecretLock(kerberosID);

UPD42 UPD45 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 DEL42 DEL43 DEL42 DEL42 DEL42 DEL42 DEL32 DEL59 DEL60 DEL42 DEL42 DEL42 DEL32 DEL21 DEL42