YARN-4132. Separate configs for nodemanager to resourcemanager connection timeout and retries. Contributed by Chang Li

-    RetryPolicy retryPolicy = createRetryPolicy(conf);
+    RetryPolicy retryPolicy =
+        createRetryPolicy(conf);
+    return createRMProxy(conf, protocol, instance, retryPolicy);
+  }
+
+  /**
+   * Create a proxy for the specified protocol. For non-HA,
+   * this is a direct connection to the ResourceManager address. When HA is
+   * enabled, the proxy handles the failover between the ResourceManagers as
+   * well.
+   */
+  @Private
+  protected static <T> T createRMProxy(final Configuration configuration,
+      final Class<T> protocol, RMProxy instance, final long retryTime,
+      final long retryInterval) throws IOException {
+    YarnConfiguration conf = (configuration instanceof YarnConfiguration)
+        ? (YarnConfiguration) configuration
+        : new YarnConfiguration(configuration);
+    RetryPolicy retryPolicy =
+        createRetryPolicy(conf, retryTime, retryInterval);
+    return createRMProxy(conf, protocol, instance, retryPolicy);
+  }
+
+  private static <T> T createRMProxy(final YarnConfiguration conf,
+      final Class<T> protocol, RMProxy instance, RetryPolicy retryPolicy)
+          throws IOException{
+    return createRetryPolicy(
+        conf, rmConnectWaitMS, rmConnectionRetryIntervalMS);
+  }
+
+  /**
+   * Fetch retry policy from Configuration and create the
+   * retry policy with specified retryTime and retry interval.
+   */
+  private static RetryPolicy createRetryPolicy(Configuration conf,
+      long retryTime, long retryInterval) {
+    long rmConnectWaitMS = retryTime;
+    long rmConnectionRetryIntervalMS = retryInterval;

INS31 INS31 INS31 MOV29 MOV78 INS83 INS83 INS73 INS43 INS42 MOV44 INS44 INS44 INS43 INS8 INS29 INS78 INS83 INS83 INS73 INS43 INS42 INS44 INS44 INS44 INS44 INS44 INS43 INS8 UPD83 INS44 INS44 MOV29 MOV78 MOV78 INS83 INS83 INS43 INS42 INS44 INS8 INS29 UPD83 INS44 INS44 INS42 INS42 INS83 INS74 INS42 INS43 INS42 INS42 MOV60 MOV60 INS41 INS65 INS42 INS42 INS42 INS83 INS43 INS42 INS83 INS74 INS42 INS43 INS42 INS83 INS39 INS42 INS83 INS39 INS42 INS42 INS60 INS60 INS41 INS83 INS43 INS42 INS43 INS42 INS42 INS43 INS42 MOV60 MOV60 INS41 INS65 INS39 INS42 INS39 INS42 INS60 INS60 INS43 INS43 INS42 INS32 INS66 INS66 INS66 INS66 INS42 INS43 INS43 INS42 INS43 INS59 INS43 INS59 INS32 INS42 INS42 INS42 INS32 INS66 INS66 INS39 INS59 INS39 INS59 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS16 INS42 INS42 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS36 INS11 INS14 INS42 INS42 INS42 INS42 INS62 INS43 INS42 INS43 INS42 INS42 INS43 INS42 INS42 INS42