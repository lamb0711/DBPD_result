Merge r1470760 through r1471228 from trunk.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1471229 13f79535-47bb-0310-9956-ffa450edef68

+import com.google.common.annotations.VisibleForTesting;
+
-  private static class DelegationTokenToRenew {
+  @VisibleForTesting
+  protected static class DelegationTokenToRenew {
-  
+
+  @VisibleForTesting
+  public Set<Token<?>> getDelegationTokens() {
+    Set<Token<?>> tokens = new HashSet<Token<?>>();
+    for(DelegationTokenToRenew delegationToken : delegationTokens) {
+      tokens.add(delegationToken.token);
+    }
+    return tokens;
+  }
+
-  private void setTimerForTokenRenewal(DelegationTokenToRenew token)
+  @VisibleForTesting
+  protected void setTimerForTokenRenewal(DelegationTokenToRenew token)
-  private void renewToken(final DelegationTokenToRenew dttr)
+  @VisibleForTesting
+  protected void renewToken(final DelegationTokenToRenew dttr)

INS26 INS40 INS31 INS78 UPD83 INS78 INS83 INS74 INS42 INS8 INS78 UPD83 INS78 UPD83 INS42 INS42 INS43 INS74 INS60 INS70 INS41 INS42 INS42 INS42 INS43 INS76 INS74 INS59 INS44 INS42 INS8 INS42 INS42 INS43 INS74 INS42 INS14 INS43 INS42 INS21 INS42 INS43 INS76 INS74 INS42 INS32 INS42 INS43 INS74 INS42 INS42 INS40 INS42 INS43 INS76 INS42