HDFS-7088. Archival Storage: fix TestBalancer and TestBalancerWithMultipleNameNodes. Contributed by Tsz Wo Nicholas Sze.

-import java.io.DataOutputStream;
-import java.util.*;
+import java.util.ArrayList;
+import java.util.Arrays;
+import java.util.Collection;
+import java.util.List;
+import java.util.Map;
-import com.google.common.annotations.VisibleForTesting;
-import org.apache.hadoop.hdfs.DFSConfigKeys;
+import com.google.common.annotations.VisibleForTesting;
+
-  private static boolean createIdFile = true;
+  private static boolean write2IdFile = true;
-  public static void setCreateIdFile(boolean create) {
-    createIdFile = create;
+  public static void setWrite2IdFile(boolean write2IdFile) {
+    NameNodeConnector.write2IdFile = write2IdFile;
-    out = createIdFile ? checkAndMarkRunning() : null;
-    if (createIdFile && out == null) {
+    out = checkAndMarkRunning();
+    if (out == null) {
-      out.writeBytes(InetAddress.getLocalHost().getHostName());
-      out.hflush();
+      if (write2IdFile) {
+        out.writeBytes(InetAddress.getLocalHost().getHostName());
+        out.hflush();
+      }

MOV26 MOV26 MOV26 INS26 INS26 INS40 UPD40 INS40 UPD40 UPD40 UPD42 UPD42 UPD42 MOV27 INS40 UPD42 MOV32 INS25 INS42 INS8 MOV21 MOV21 DEL42 DEL42 DEL33 DEL16 DEL42 DEL27