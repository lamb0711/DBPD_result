HDDS-694. Plugin new Pipeline management code in SCM.
Contributed by Lokesh Jain.

-import org.apache.hadoop.hdds.scm.container.common.helpers.Pipeline;
+import org.apache.hadoop.hdds.scm.pipeline.Pipeline;
-import org.apache.hadoop.hdds.scm.pipelines.PipelineSelector;
+import org.apache.hadoop.hdds.scm.pipeline.PipelineManager;
+import java.util.List;
-   * @param selector -- Pipeline selector class.
+   * @param pipelineManager -- Pipeline Manager class.
-  ContainerInfo allocateContainer(final PipelineSelector selector,
+  ContainerInfo allocateContainer(final PipelineManager pipelineManager,
-    final Pipeline pipeline = selector.getReplicationPipeline(type,
-        replicationFactor);
+    Pipeline pipeline;
+    try {
+      pipeline = pipelineManager.createPipeline(type, replicationFactor);
+    } catch (IOException e) {
+      final List<Pipeline> pipelines =
+          pipelineManager.getPipelines(type, replicationFactor);
+      if (pipelines.isEmpty()) {
+        throw new IOException("Could not allocate container");
+      }
+      pipeline = pipelines.get((int) containerCount.get() % pipelines.size());
+    }
-    selector.addContainerToPipeline(pipeline.getId(), containerID);
+    pipelineManager.addContainerToPipeline(pipeline.getId(),
+        ContainerID.valueof(containerID));

INS26 UPD40 UPD40 INS40 UPD43 UPD42 INS60 INS54 UPD42 UPD66 UPD42 INS43 INS59 INS8 INS12 INS42 INS42 INS21 INS44 INS8 UPD42 INS32 INS7 INS43 INS42 MOV60 INS25 INS21 INS42 INS42 MOV42 INS42 INS32 INS42 INS74 INS32 INS8 INS7 INS42 INS42 INS42 INS42 INS43 MOV43 UPD42 INS42 INS42 INS53 INS42 INS32 INS42 UPD42 UPD42 INS14 INS42 INS42 INS27 INS43 INS45 INS11 INS32 INS42 INS39 INS32 INS42 INS42 INS42 INS42