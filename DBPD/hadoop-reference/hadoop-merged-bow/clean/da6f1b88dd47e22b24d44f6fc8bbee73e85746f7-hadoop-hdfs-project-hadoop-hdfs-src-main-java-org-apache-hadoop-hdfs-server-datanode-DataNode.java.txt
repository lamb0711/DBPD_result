HDFS-10512. VolumeScanner may terminate due to NPE in DataNode.reportBadBlocks. Contributed by Wei-Chiu Chuang and Yiqun Lin.

-    BPOfferService bpos = getBPOSForBlock(block);
+    if (volume == null) {
+      LOG.warn("Cannot find FsVolumeSpi to report bad block: " + block);
+      return;
+    }
+    reportBadBlocks(block, volume);
+  }
+
+  /**
+   * Report a bad block which is hosted on the local DN.
+   *
+   * @param block the bad block which is hosted on the local DN
+   * @param volume the volume that block is stored in and the volume
+   *        must not be null
+   * @throws IOException
+   */
+  public void reportBadBlocks(ExtendedBlock block, FsVolumeSpi volume)
+      throws IOException {
+    BPOfferService bpos = getBPOSForBlock(block);
+    if (volume == null) {
+      LOG.warn("Cannot find FsVolumeSpi to report bad block: " + block);
+      return;
+    }

INS31 MOV29 INS83 INS39 INS42 INS44 INS43 INS8 INS29 INS44 INS43 INS42 INS42 MOV60 INS25 INS21 INS65 INS65 INS65 INS65 INS43 INS42 INS25 INS42 INS27 INS8 INS32 INS66 INS42 INS66 INS42 INS66 INS66 INS42 INS42 INS27 INS8 INS42 INS33 INS21 INS41 INS42 INS42 INS42 INS42 INS33 INS21 INS41 INS32 INS32 INS42 INS42 INS27 INS42 INS42 INS27 INS45 INS42 INS45 INS42