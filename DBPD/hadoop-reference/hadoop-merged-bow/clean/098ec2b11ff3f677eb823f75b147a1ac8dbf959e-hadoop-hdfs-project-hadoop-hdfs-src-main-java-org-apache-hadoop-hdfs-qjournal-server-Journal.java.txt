HDFS-10519. Add a configuration option to enable in-progress edit log tailing. Contributed by Jiayi Zhou.

-  
-  synchronized long getCommittedTxnIdForTests() throws IOException {
+
+  synchronized long getCommittedTxnId() throws IOException {
+    // If numTxns is 0, it's actually a fake send which aims at updating
+    // committedTxId only. So we can return early.
+    if (numTxns == 0) {
+      return;
+    }
+
-    
+
-        logs.add(new RemoteEditLog(log.getStartTxId(), getHighestWrittenTxId(),
-            true));
+        logs.add(new RemoteEditLog(log.getStartTxId(),
+            getHighestWrittenTxId(), true));
-    
-    return new RemoteEditLogManifest(logs);
+
+    return new RemoteEditLogManifest(logs, getCommittedTxnId());

UPD42 INS25 INS27 INS8 INS42 INS34 INS41 INS32 INS42