HADOOP-10211. Enable RPC protocol to negotiate SASL-QOP values between clients and servers. (Contributed by Benoy Antony)

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1574697 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.util.StringUtils;
-    QualityOfProtection saslQOP = QualityOfProtection.AUTHENTICATION;
-    String rpcProtection = conf.get("hadoop.rpc.protection",
-        QualityOfProtection.AUTHENTICATION.name().toLowerCase());
-    if (QualityOfProtection.INTEGRITY.name().toLowerCase()
-        .equals(rpcProtection)) {
-      saslQOP = QualityOfProtection.INTEGRITY;
-    } else if (QualityOfProtection.PRIVACY.name().toLowerCase().equals(
-        rpcProtection)) {
-      saslQOP = QualityOfProtection.PRIVACY;
+    String[] qop = conf.getStrings("hadoop.rpc.protection",
+        QualityOfProtection.AUTHENTICATION.toString());
+    
+    for (int i=0; i < qop.length; i++) {
+        qop[i] = QualityOfProtection.valueOf(qop[i].toUpperCase()).getSaslQop();
-    SASL_PROPS.put(Sasl.QOP, saslQOP.getSaslQop());
+    SASL_PROPS.put(Sasl.QOP, StringUtils.join(",", qop));

INS26 INS40 INS24 INS5 INS58 INS27 INS37 INS8 MOV43 INS85 UPD42 INS39 INS59 INS42 INS40 INS42 INS21 UPD42 INS42 INS34 INS7 UPD42 INS42 INS45 UPD42 MOV40 UPD42 INS2 INS32 INS42 INS42 INS32 INS42 UPD42 MOV42 INS42 INS32 INS2 UPD42 MOV42 INS42 INS42 DEL42 DEL43 DEL42 DEL40 DEL59 DEL60 DEL42 DEL32 DEL40 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32 DEL42 DEL40 DEL7 DEL21 DEL8 DEL40 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32 DEL42 DEL40 DEL7 DEL21 DEL8 DEL25 DEL25