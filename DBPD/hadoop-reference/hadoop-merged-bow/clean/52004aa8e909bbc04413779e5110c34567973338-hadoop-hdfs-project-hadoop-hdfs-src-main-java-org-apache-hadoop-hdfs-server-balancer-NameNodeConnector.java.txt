HDFS-776.  Fix exception handling in Balancer.  Contributed by Uma Maheswara Rao G


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1243654 13f79535-47bb-0310-9956-ffa450edef68

+      if (!shouldRun) {
+        throw new IOException(
+            "Can not get access token. BlockKeyUpdater is not running");
+      }
-      while (shouldRun) {
-        try {
-          blockTokenSecretManager.setKeys(namenode.getBlockKeys());
-        } catch (Exception e) {
-          LOG.error("Failed to set keys", e);
-        }
-        try {
+      try {
+        while (shouldRun) {
+          try {
+            blockTokenSecretManager.setKeys(namenode.getBlockKeys());
+          } catch (IOException e) {
+            LOG.error("Failed to set keys", e);
+          }
-        } catch (InterruptedException ie) {
+      } catch (InterruptedException e) {
+        LOG.info("InterruptedException in block key updater thread", e);
+      } catch (Throwable e) {
+        LOG.error("Exception in block key updater thread", e);
+        shouldRun = false;

INS8 INS54 INS25 MOV8 MOV12 INS12 INS38 INS8 INS44 INS8 INS42 INS53 UPD42 INS21 INS43 INS42 INS21 INS21 INS14 MOV21 INS32 INS42 INS32 INS7 INS43 INS45 INS42 INS42 INS45 INS42 INS42 INS42 INS45 INS42 INS42 INS9 INS42 UPD43 UPD42 DEL8 DEL54