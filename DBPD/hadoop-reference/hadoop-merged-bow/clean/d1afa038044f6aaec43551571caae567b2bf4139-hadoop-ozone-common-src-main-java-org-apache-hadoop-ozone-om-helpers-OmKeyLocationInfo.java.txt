HDDS-1138. Ozone Client should avoid talking to SCM directly. Contributed by Xiaoyu Yao and Mukul Kumar Singh.

Closes #585 
+import org.apache.hadoop.hdds.scm.pipeline.Pipeline;
+import org.apache.hadoop.hdds.scm.pipeline.UnknownPipelineStateException;
-  private OmKeyLocationInfo(BlockID blockID, long length, long offset) {
+  private Pipeline pipeline;
+
+  private OmKeyLocationInfo(BlockID blockID, Pipeline pipeline, long length,
+                            long offset) {
+    this.pipeline = pipeline;
-  private OmKeyLocationInfo(BlockID blockID, long length, long offset,
-      Token<OzoneBlockTokenIdentifier> token) {
+  private OmKeyLocationInfo(BlockID blockID, Pipeline pipeline, long length,
+      long offset, Token<OzoneBlockTokenIdentifier> token) {
+    this.pipeline = pipeline;
+  public Pipeline getPipeline() {
+    return pipeline;
+  }
+
+
+  public void setPipeline(Pipeline pipeline) {
+    this.pipeline = pipeline;
+  }
+
+    private Pipeline pipeline;
+    public Builder setPipeline(Pipeline pipeline) {
+      this.pipeline = pipeline;
+      return this;
+    }
+
-        return new OmKeyLocationInfo(blockID, length, offset);
+        return new OmKeyLocationInfo(blockID, pipeline, length, offset);
-        return new OmKeyLocationInfo(blockID, length, offset, token);
+        return new OmKeyLocationInfo(blockID, pipeline, length, offset, token);
+    try {
+      builder.setPipeline(pipeline.getProtobufMessage());
+    } catch (UnknownPipelineStateException e) {
+      //TODO: fix me: we should not return KeyLocation without pipeline.
+    }
+  private static Pipeline getPipeline(KeyLocation keyLocation) {
+    try {
+      return keyLocation.hasPipeline() ?
+          Pipeline.getFromProtobuf(keyLocation.getPipeline()) : null;
+    } catch (UnknownPipelineStateException e) {
+      return null;
+    }
+  }
+
+        getPipeline(keyLocation),
+        ", pipeline=" + pipeline +

INS26 INS26 INS40 INS40 INS23 INS31 INS31 INS31 INS83 INS43 INS59 INS44 INS44 INS83 INS43 INS42 INS8 INS83 INS39 INS42 INS44 INS8 INS23 INS31 INS83 INS83 INS43 INS42 INS44 INS8 INS42 INS42 INS43 INS42 INS21 INS43 INS42 INS21 INS42 INS41 INS43 INS42 INS21 INS83 INS43 INS59 INS83 INS43 INS42 INS44 INS8 INS54 INS42 INS43 INS42 INS54 INS42 INS7 INS42 INS7 INS42 INS42 INS7 INS42 INS42 INS42 INS43 INS42 INS21 INS41 INS8 INS12 INS42 INS8 INS12 INS22 INS42 INS22 INS42 INS22 INS42 INS42 INS7 INS52 INS21 INS44 INS8 INS41 INS44 INS8 INS45 INS42 INS52 INS42 INS52 INS42 INS52 INS42 INS22 INS42 INS32 INS43 INS42 INS16 INS43 INS42 INS41 INS32 INS52 INS42 INS42 INS42 INS32 INS42 INS32 INS32 INS33 INS42 INS33 INS42 INS42 MOV43 INS42 MOV43 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS32 INS42 INS42