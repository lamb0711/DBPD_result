Merge r1550130 through r1555020 from trunk.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-5535@1555021 13f79535-47bb-0310-9956-ffa450edef68

-
-package org.apache.hadoop.yarn.exceptions;
-
-import org.apache.hadoop.classification.InterfaceAudience;
-import org.apache.hadoop.classification.InterfaceStability;
+package org.apache.hadoop.mapreduce.checkpoint;
- * Exception to be thrown when an Active-Only operation is attempted on a
- * ResourceManager that is not Active.
+ * A naming service that simply returns the name it has been initialized with.
-@InterfaceAudience.Private
-@InterfaceStability.Evolving
-public class RMNotYetActiveException extends YarnException {
-  private static final long serialVersionUID = 1L;
+public class SimpleNamingService implements CheckpointNamingService{
-  public RMNotYetActiveException() {
-    super("ResourceManager is not yet Active!");
+  final String name;
+
+  public SimpleNamingService(String name){
+    this.name = name;
+
+  /**
+   * Generate a new checkpoint Name
+   * @return the checkpoint name
+   */
+  public String getNewName(){
+    return "checkpoint_" + name;
+  }
+

UPD40 UPD42 UPD43 INS31 UPD42 INS43 INS83 INS42 INS44 INS8 INS29 INS43 INS42 UPD66 INS42 UPD42 INS43 INS42 INS21 INS65 INS65 INS42 INS41 INS42 INS7 INS66 INS66 INS27 INS22 INS42 INS45 INS42 INS52 INS42 DEL40 DEL26 DEL40 DEL26 DEL66 DEL40 DEL78 DEL40 DEL78 DEL83 DEL83 DEL39 DEL34 DEL42 DEL45 DEL46