HADOOP-15694. ABFS: Allow OAuth credentials to not be tied to accounts.
Contributed by Sean Mackrory.

+import org.apache.hadoop.fs.azurebfs.AbfsConfiguration;
-  public String getStorageAccountKey(String accountName, Configuration conf)
+  public String getStorageAccountKey(String accountName, Configuration rawConfig)
-    String envelope = super.getStorageAccountKey(accountName, conf);
+    String envelope = super.getStorageAccountKey(accountName, rawConfig);
-    final String command = conf.get(ConfigurationKeys.AZURE_KEY_ACCOUNT_SHELLKEYPROVIDER_SCRIPT);
+    AbfsConfiguration abfsConfig;
+    try {
+      abfsConfig = new AbfsConfiguration(rawConfig, accountName);
+    } catch(IllegalAccessException | IOException e) {
+      throw new KeyProviderException("Unable to get key from credential providers.", e);
+    }
+
+    final String command = abfsConfig.get(ConfigurationKeys.AZURE_KEY_ACCOUNT_SHELLKEYPROVIDER_SCRIPT);

INS26 INS40 UPD42 INS60 INS54 INS43 INS59 INS8 INS12 INS42 INS42 INS21 INS44 INS8 UPD42 INS7 INS84 INS42 INS53 UPD42 INS42 INS14 INS43 INS43 INS14 INS43 INS42 INS42 INS42 INS42 INS43 INS45 INS42 INS42 INS42