HDFS-10996. Ability to specify per-file EC policy at create time. Contributed by SammiChen.

+import org.apache.commons.lang.StringUtils;
-      boolean logRetryEntry)
+      String ecPolicyName, boolean logRetryEntry)
-                    replication, blockSize, holder, clientMachine);
+          replication, blockSize, holder, clientMachine, ecPolicyName);
-      String clientName, String clientMachine)
+      String clientName, String clientMachine, String ecPolicyName)
-      ErasureCodingPolicy ecPolicy = FSDirErasureCodingOp.
-          unprotectedGetErasureCodingPolicy(fsd.getFSNamesystem(), existing);
+      ErasureCodingPolicy ecPolicy;
+      if (!StringUtils.isEmpty(ecPolicyName)) {
+        ecPolicy = FSDirErasureCodingOp.getErasureCodingPolicyByName(
+            fsd.getFSNamesystem(), ecPolicyName);
+      } else {
+        ecPolicy = FSDirErasureCodingOp.unprotectedGetErasureCodingPolicy(
+            fsd.getFSNamesystem(), existing);
+      }

INS26 INS40 INS44 INS44 INS43 INS42 INS43 INS42 INS42 INS42 INS25 INS38 INS8 INS8 INS32 INS21 INS21 INS42 INS42 INS42 INS42 INS7 INS7 INS42 INS32 INS42 MOV32 INS42 INS42 INS32 INS42 INS42 INS42