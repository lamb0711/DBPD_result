MAPREDUCE-4299. Terasort hangs with MR2 FifoScheduler (Tom White via bobby)


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1361397 13f79535-47bb-0310-9956-ffa450edef68

-      application.setHeadroom(clusterResource);
-      
-        return;
+        break;
+
+    // Update the applications' headroom to correctly take into
+    // account the containers assigned in this update.
+    for (SchedulerApp application : applications.values()) {
+      application.setHeadroom(Resources.subtract(clusterResource, usedResource));
+    }

INS70 INS44 INS32 INS8 INS43 INS42 INS42 INS42 INS21 INS42 INS32 INS10 INS42 INS42 INS32 INS42 INS42 INS42 INS42 DEL42 DEL42 DEL42 DEL32 DEL21 DEL41