Merge branch 'trunk' into HDFS-6581

Conflicts:
	hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSDirectory.java
	hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/INodeFile.java

+import org.apache.hadoop.yarn.api.records.LogAggregationContext;
+import org.apache.hadoop.yarn.api.records.impl.pb.LogAggregationContextPBImpl;
+    LogAggregationContext logAggregationContext = null;
+    if (p.getLogAggregationContext() != null) {
+      logAggregationContext =
+          new LogAggregationContextPBImpl(p.getLogAggregationContext());
+    }
+
-    app.handle(new ApplicationInitEvent(appId, acls));
+    app.handle(new ApplicationInitEvent(appId, acls, logAggregationContext));
-      Map<ApplicationAccessType, String> appAcls) {
+      Map<ApplicationAccessType, String> appAcls,
+      LogAggregationContext logAggregationContext) {
+    if (logAggregationContext != null) {
+      builder.setLogAggregationContext((
+          (LogAggregationContextPBImpl)logAggregationContext).getProto());
+    }
+
+          LogAggregationContext logAggregationContext =
+              containerTokenIdentifier.getLogAggregationContext();
-              buildAppProto(applicationID, user, credentials, appAcls));
+              buildAppProto(applicationID, user, credentials, appAcls,
+                logAggregationContext));
-            new ApplicationInitEvent(applicationID, appAcls));
+            new ApplicationInitEvent(applicationID, appAcls,
+              logAggregationContext));

INS26 INS26 INS40 INS40 INS44 INS60 INS25 INS43 INS42 INS25 INS43 INS59 INS27 INS8 INS42 INS27 INS8 INS42 INS42 INS33 INS32 INS33 INS21 INS42 INS33 INS21 INS42 INS42 INS7 INS42 INS32 INS42 INS14 INS42 INS42 INS32 INS43 INS32 INS36 INS42 INS42 INS42 INS42 INS11 INS60 INS43 INS42 INS43 INS59 INS42 INS42 INS42 INS32 INS42 INS42 INS42 INS42