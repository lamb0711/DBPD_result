HDFS-11757. Query StreamCapabilities when creating balancer's lock file. Contributed by SammiChen.

+import org.apache.hadoop.fs.StreamCapabilities.StreamCapability;
-      Preconditions.checkState(!fs.getFileStatus(idPath).isErasureCoded(),
-          "Id File should be a replicate file");
+      Preconditions.checkState(
+          fsout.hasCapability(StreamCapability.HFLUSH.getValue())
+          && fsout.hasCapability(StreamCapability.HSYNC.getValue()),
+          "Id lock file should support hflush and hsync");

INS26 INS40 INS27 UPD45 INS32 INS32 UPD42 MOV42 UPD42 MOV42 INS32 UPD42 MOV42 INS42 INS32 INS40 UPD42 MOV42 INS40 INS42 DEL32 DEL32 DEL38