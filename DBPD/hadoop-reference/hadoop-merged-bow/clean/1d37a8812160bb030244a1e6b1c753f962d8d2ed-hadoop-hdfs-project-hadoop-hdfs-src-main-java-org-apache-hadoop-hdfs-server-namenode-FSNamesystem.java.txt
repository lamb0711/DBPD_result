HDFS-8854. Erasure coding: add ECPolicy to replace schema+cellSize in hadoop-hdfs. Contributed by Walter Su.

+import org.apache.hadoop.hdfs.protocol.ErasureCodingPolicy;
-import org.apache.hadoop.io.erasurecode.ECSchema;
-  private final ErasureCodingSchemaManager ecSchemaManager;
+  private final ErasureCodingPolicyManager ecPolicyManager;
-    ecSchemaManager.clear();
+    ecPolicyManager.clear();
-      this.ecSchemaManager = new ErasureCodingSchemaManager();
+      this.ecPolicyManager = new ErasureCodingPolicyManager();
-      final ECSchema ecSchema = ecZone.getSchema();
-      final short numDataUnits = (short) ecSchema.getNumDataUnits();
-      final short numParityUnits = (short) ecSchema.getNumParityUnits();
+      final ErasureCodingPolicy ecPolicy = ecZone.getErasureCodingPolicy();
+      final short numDataUnits = (short) ecPolicy.getNumDataUnits();
+      final short numParityUnits = (short) ecPolicy.getNumParityUnits();
-          ecSchema, ecZone.getCellSize());
+          ecPolicy);
-  /** @return the ErasureCodingSchemaManager. */
-  public ErasureCodingSchemaManager getErasureCodingSchemaManager() {
-    return ecSchemaManager;
+  /** @return the ErasureCodingPolicyManager. */
+  public ErasureCodingPolicyManager getErasureCodingPolicyManager() {
+    return ecPolicyManager;
-   * @param schema  ECSchema for the erasure coding zone
-   * @param cellSize Cell size of stripe 
+   * @param ecPolicy  erasure coding policy for the erasure coding zone
-  void createErasureCodingZone(final String srcArg, final ECSchema schema,
-      int cellSize, final boolean logRetryCache) throws IOException,
+  void createErasureCodingZone(final String srcArg, final ErasureCodingPolicy
+      ecPolicy, final boolean logRetryCache) throws IOException,
-          srcArg, schema, cellSize, logRetryCache);
+          srcArg, ecPolicy, logRetryCache);
-   * Get available erasure coding schemas
+   * Get available erasure coding polices
-  ECSchema[] getErasureCodingSchemas() throws IOException {
+  ErasureCodingPolicy[] getErasureCodingPolicies() throws IOException {
-      return FSDirErasureCodingOp.getErasureCodingSchemas(this);
-    } finally {
-      readUnlock();
-    }
-  }
-
-  /**
-   * Get the ECSchema specified by the name
-   */
-  ECSchema getErasureCodingSchema(String schemaName) throws IOException {
-    checkOperation(OperationCategory.READ);
-    waitForLoadingFSImage();
-    readLock();
-    try {
-      checkOperation(OperationCategory.READ);
-      return FSDirErasureCodingOp.getErasureCodingSchema(this, schemaName);
+      return FSDirErasureCodingOp.getErasureCodingPolicies(this);

MOV26 UPD40 UPD43 UPD43 UPD42 UPD5 UPD42 UPD42 UPD42 UPD42 UPD43 UPD42 UPD43 MOV21 UPD66 UPD42 UPD42 UPD66 UPD42 UPD66 UPD42 UPD42 MOV21 UPD43 UPD42 UPD42 UPD42 UPD42 UPD43 UPD42 INS42 UPD42 UPD42 UPD42 UPD42 DEL42 DEL42 DEL42 DEL32 DEL42 DEL66 DEL65 DEL39 DEL42 DEL44 DEL42 DEL66 DEL65 DEL29 DEL42 DEL43 DEL42 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL40 DEL32 DEL21 DEL42 DEL32 DEL21 DEL42 DEL32 DEL21 DEL42 DEL40 DEL32 DEL21 DEL42 DEL42 DEL52 DEL42 DEL32 DEL41 DEL8 DEL42 DEL32 DEL21 DEL8 DEL54 DEL8 DEL31