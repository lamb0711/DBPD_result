YARN-7224. Support GPU isolation for docker container. Contributed by Wangda Tan.

-    List<Integer> usableGpus =
-        GpuDiscoverer.getInstance().getMinorNumbersOfGpusUsableByYarn();
+    List<GpuDevice> usableGpus =
+        GpuDiscoverer.getInstance().getGpusUsableByYarn();
-      LOG.info("Didn't find any usable GPUs on the NodeManager.");
+      String message = "GPU is enabled, but couldn't find any usable GPUs on the "
+          + "NodeManager.";
+      LOG.error(message);
-      return;
+      throw new YarnException(message);

UPD74 UPD43 INS60 INS53 UPD42 UPD42 INS43 INS59 INS14 INS42 INS42 INS27 UPD42 INS42 INS43 INS42 INS45 INS45 INS42 DEL45 DEL41