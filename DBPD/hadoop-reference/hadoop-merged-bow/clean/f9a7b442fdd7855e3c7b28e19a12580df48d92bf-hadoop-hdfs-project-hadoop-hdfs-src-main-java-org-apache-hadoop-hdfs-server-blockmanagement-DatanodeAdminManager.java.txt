HDFS-14465. When the Block expected replications is larger than the number of DataNodes, entering maintenance will never exit. Contributed by Yicong Cai.

-      NumberReplicas numberReplicas, boolean isDecommission) {
+                               NumberReplicas numberReplicas,
+                               boolean isDecommission,
+                               boolean isMaintenance) {
+    if (isMaintenance
+      && numLive >= blockManager.getMinReplicationToBeInMaintenance()) {
+      return true;
+    }
+        boolean isMaintenance = datanode.isEnteringMaintenance();
-        if (isSufficient(block, bc, num, isDecommission)) {
+        if (isSufficient(block, bc, num, isDecommission, isMaintenance)) {

INS44 INS39 INS42 INS25 INS27 INS8 INS42 INS27 INS41 INS42 INS32 INS9 INS60 INS42 INS42 INS39 INS59 INS42 INS32 INS42 INS42 INS42