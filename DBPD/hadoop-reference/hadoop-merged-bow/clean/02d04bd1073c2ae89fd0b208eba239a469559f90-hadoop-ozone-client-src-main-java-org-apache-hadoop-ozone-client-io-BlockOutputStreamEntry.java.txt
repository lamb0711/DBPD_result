HDDS-1121. Key read failure when data is written parallel in to Ozone.
Contributed by Bharat Viswanadham.

+import org.apache.hadoop.hdds.protocol.datanode.proto.ContainerProtos
+    .ChecksumType;
-import org.apache.hadoop.ozone.common.Checksum;
-  private final Checksum checksum;
+  private final ChecksumType checksumType;
+  private final int bytesPerChecksum;
-      long watchTimeout, List<ByteBuffer> bufferList, Checksum checksum,
+      long watchTimeout, List<ByteBuffer> bufferList,
+      ChecksumType checksumType, int bytesPerChecksum,
-    this.checksum = checksum;
+    this.checksumType = checksumType;
+    this.bytesPerChecksum = bytesPerChecksum;
-              streamBufferMaxSize, watchTimeout, bufferList, checksum);
+              streamBufferMaxSize, watchTimeout, bufferList, checksumType,
+              bytesPerChecksum);
-    private Checksum checksum;
+    private ChecksumType checksumType;
+    private int bytesPerChecksum;
-    public Builder setChecksum(Checksum cs) {
-      this.checksum = cs;
+    public Builder setChecksumType(ChecksumType type) {
+      this.checksumType = type;
+      return this;
+    }
+
+    public Builder setBytesPerChecksum(int bytes) {
+      this.bytesPerChecksum = bytes;
-          bufferList, checksum, token);
+          bufferList, checksumType, bytesPerChecksum, token);
-  public Checksum getChecksum() {
-    return checksum;
-  }
-

MOV26 UPD40 INS23 UPD43 INS83 INS83 INS39 INS59 INS44 INS23 INS31 UPD42 UPD42 INS42 UPD43 UPD42 INS39 INS42 INS21 UPD43 INS83 INS39 INS59 UPD42 INS83 INS43 INS42 INS44 INS8 UPD42 INS7 UPD42 UPD42 INS42 UPD43 UPD42 INS42 INS39 INS42 INS21 INS41 UPD42 INS22 INS42 UPD42 INS7 INS52 UPD42 INS52 INS42 UPD42 INS22 INS42 UPD42 INS42 UPD42 INS52 INS42 UPD42 INS42 DEL83 DEL42 DEL43 DEL42 DEL42 DEL41 DEL8 DEL31