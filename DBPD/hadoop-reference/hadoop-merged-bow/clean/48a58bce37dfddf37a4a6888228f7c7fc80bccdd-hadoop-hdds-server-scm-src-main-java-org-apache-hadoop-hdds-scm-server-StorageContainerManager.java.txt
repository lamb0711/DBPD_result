HDDS-1207. Refactor Container Report Processing logic and plugin new Replication Manager. (#662)



-import org.apache.hadoop.hdds.scm.container.replication.ReplicationActivityStatus;
-import org.apache.hadoop.hdds.scm.container.replication.ReplicationManager;
+import org.apache.hadoop.hdds.scm.container.ReplicationManager;
-import org.apache.hadoop.utils.Scheduler;
-  private final Scheduler commonScheduler;
-  private final ReplicationActivityStatus replicationStatus;
-    commonScheduler = new Scheduler("SCMCommonScheduler", false, 1);
-    replicationStatus = new ReplicationActivityStatus(commonScheduler);
-        new ContainerReportHandler(scmNodeManager, pipelineManager,
-            containerManager, replicationStatus);
+        new ContainerReportHandler(scmNodeManager, containerManager);
-        new IncrementalContainerReportHandler(
-            pipelineManager, containerManager);
+        new IncrementalContainerReportHandler(containerManager);
-        clientProtocolServer, scmBlockManager, replicationStatus);
+        clientProtocolServer, scmBlockManager, replicationManager);
-      replicationManager = new ReplicationManager(containerPlacementPolicy,
-          containerManager, eventQueue, commandWatcherLeaseManager);
+      replicationManager = new ReplicationManager(conf,
+          containerManager, containerPlacementPolicy, eventQueue);
-    replicationStatus.start();
-    replicationManager.start();
-      LOG.info("Stopping Replication Activity Status tracker.");
-      replicationStatus.close();
-    } catch (Exception ex) {
-      LOG.error("Replication Activity Status tracker stop failed.", ex);
-    }
-
-
-    try {
-    try {
-      LOG.info("Stopping SCM Common Scheduler.");
-      commonScheduler.close();
-    } catch (Exception ex) {
-      LOG.error("SCM Common Scheduler close failed {}", ex);
-    }
-

UPD40 MOV43 MOV43 MOV43 MOV43 UPD42 UPD42 UPD42 UPD42 DEL40 DEL26 DEL40 DEL26 DEL83 DEL83 DEL42 DEL43 DEL42 DEL59 DEL23 DEL83 DEL83 DEL42 DEL43 DEL42 DEL59 DEL23 DEL42 DEL42 DEL43 DEL45 DEL9 DEL34 DEL14 DEL7 DEL21 DEL42 DEL42 DEL43 DEL42 DEL14 DEL7 DEL21 DEL42 DEL42 DEL42 DEL42 DEL42 DEL32 DEL21 DEL42 DEL42 DEL32 DEL21 DEL42 DEL42 DEL45 DEL32 DEL21 DEL42 DEL42 DEL32 DEL21 DEL8 DEL42 DEL43 DEL42 DEL44 DEL42 DEL42 DEL45 DEL42 DEL32 DEL21 DEL8 DEL12 DEL54 DEL42 DEL42 DEL45 DEL32 DEL21 DEL42 DEL42 DEL32 DEL21 DEL8 DEL42 DEL43 DEL42 DEL44 DEL42 DEL42 DEL45 DEL42 DEL32 DEL21 DEL8 DEL12 DEL54