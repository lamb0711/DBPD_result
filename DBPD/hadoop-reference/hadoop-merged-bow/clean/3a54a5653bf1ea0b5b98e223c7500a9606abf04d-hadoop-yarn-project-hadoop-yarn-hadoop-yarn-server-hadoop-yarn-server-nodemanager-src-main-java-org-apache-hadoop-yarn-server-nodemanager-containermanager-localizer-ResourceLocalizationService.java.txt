YARN-112. Fixed a race condition during localization that fails containers. Contributed by Omkar Vinit Joshi.
MAPREDUCE-5138. Fix LocalDistributedCacheManager after YARN-112. Contributed by Omkar Vinit Joshi.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1466196 13f79535-47bb-0310-9956-ffa450edef68

-import java.util.Random;
+            publicDirDestPath =
+                new Path(publicDirDestPath, Long.toString(publicRsrc
+                  .nextUniqueNumber()));
-                lfs, null, conf, publicDirDestPath, resource, new Random())),
+                lfs, null, conf, publicDirDestPath, resource)),
-      return tracker.getPathForLocalization(new LocalResourceRequest(rsrc),
+      dirPath = tracker.getPathForLocalization(new LocalResourceRequest(rsrc),
-
+      return new Path (dirPath, Long.toString(tracker.nextUniqueNumber()));

INS21 INS7 INS14 INS42 MOV32 INS43 INS42 INS32 INS42 INS42 INS42 INS32 INS42 INS42 INS21 INS7 INS42 INS14 INS43 INS42 INS32 INS42 INS42 INS42 INS32 INS42 INS42 DEL40 DEL26 DEL42 DEL43 DEL14