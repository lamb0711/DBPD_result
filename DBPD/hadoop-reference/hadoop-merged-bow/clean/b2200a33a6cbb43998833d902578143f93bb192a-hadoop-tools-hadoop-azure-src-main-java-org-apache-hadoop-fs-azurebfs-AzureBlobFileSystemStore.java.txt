HDFS-15168: ABFS enhancement to translate AAD to Linux identities. (#1978)


+import java.lang.reflect.InvocationTargetException;
+import org.apache.hadoop.fs.azurebfs.oauth2.IdentityTransformerInterface;
+import static org.apache.hadoop.fs.azurebfs.constants.ConfigurationKeys.FS_AZURE_IDENTITY_TRANSFORM_CLASS;
-  private final IdentityTransformer identityTransformer;
+  private final IdentityTransformerInterface identityTransformer;
-    this.identityTransformer = new IdentityTransformer(abfsConfiguration.getRawConfiguration());
+    final Class<? extends IdentityTransformerInterface> identityTransformerClass =
+        configuration.getClass(FS_AZURE_IDENTITY_TRANSFORM_CLASS, IdentityTransformer.class,
+            IdentityTransformerInterface.class);
+    try {
+      this.identityTransformer =
+          identityTransformerClass.getConstructor(Configuration.class).newInstance(configuration);
+    } catch (IllegalAccessException | InstantiationException | IllegalArgumentException | InvocationTargetException | NoSuchMethodException e) {
+      throw new IOException(e);
+    }

INS26 INS26 INS26 INS40 INS40 INS40 UPD43 UPD42 INS60 INS54 INS83 INS74 INS59 INS8 INS12 INS43 INS76 INS42 INS32 MOV21 INS44 INS8 INS42 INS43 INS42 INS42 INS42 INS57 INS57 INS84 INS42 INS53 INS42 MOV43 INS43 INS32 INS43 INS43 INS43 INS43 INS43 INS14 INS42 INS32 INS42 UPD42 MOV42 INS42 INS42 INS42 INS42 INS42 INS43 INS42 INS42 INS42 INS57 INS42 INS43 INS42 DEL42 DEL32 DEL14