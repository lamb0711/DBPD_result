HDFS-316. Balancer should run for a configurable # of iterations (Xiaoyu Yao via aw)

-  private static final int MAX_NOT_CHANGED_ITERATIONS = 5;
+  public static final int DEFAULT_MAX_IDLE_ITERATIONS = 5;
-      Collection<URI> namenodes, String name, Path idPath, Configuration conf)
-      throws IOException {
+      Collection<URI> namenodes, String name, Path idPath, Configuration conf,
+      int maxIdleIterations) throws IOException {
-          null, conf);
+          null, conf, maxIdleIterations);
-      Configuration conf) throws IOException {
+      Configuration conf, int maxIdleIterations) throws IOException {
-          idPath, entry.getValue(), conf);
+          idPath, entry.getValue(), conf, maxIdleIterations);
+  private final int maxNotChangedIterations;
-                           List<Path> targetPaths, Configuration conf)
+                           List<Path> targetPaths, Configuration conf,
+                           int maxNotChangedIterations)
+    this.maxNotChangedIterations = maxNotChangedIterations;
-      if (notChangedIterations >= MAX_NOT_CHANGED_ITERATIONS) {
+      if (LOG.isDebugEnabled()) {
+        LOG.debug("No block has been moved for " +
+            notChangedIterations + " iterations, " +
+            "maximum notChangedIterations before exit is: " +
+            ((maxNotChangedIterations >= 0) ? maxNotChangedIterations : "Infinite"));
+      }
+      if ((maxNotChangedIterations >= 0) &&
+          (notChangedIterations >= maxNotChangedIterations)) {

INS23 UPD83 INS44 INS44 INS83 INS83 INS39 INS59 INS44 UPD42 INS39 INS42 INS39 INS42 INS42 INS39 INS42 INS21 INS7 INS22 INS42 INS25 MOV43 INS52 INS42 INS32 INS8 INS27 INS42 INS42 INS21 INS36 INS36 MOV43 INS42 INS42 INS32 INS27 INS27 INS42 INS42 INS27 INS42 INS34 MOV42 UPD42 MOV42 INS45 INS42 INS45 INS45 INS36 INS16 INS36 INS42 INS45 INS27 INS42 INS34 DEL27