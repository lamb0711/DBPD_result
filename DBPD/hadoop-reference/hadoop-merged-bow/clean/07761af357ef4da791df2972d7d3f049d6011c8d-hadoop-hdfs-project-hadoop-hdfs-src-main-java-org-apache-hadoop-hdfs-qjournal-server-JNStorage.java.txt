HDFS-11448. JN log segment syncing should support HA upgrade. Contributed by Hanisha Koneru.

+  private static final String STORAGE_EDITS_SYNC = "edits.sync";
+
-  File getTemporaryEditsFile(long startTxId, long endTxId, long timestamp) {
-    return NNStorage.getTemporaryEditsFile(sd, startTxId, endTxId, timestamp);
+  File getCurrentDir() {
+    return sd.getCurrentDir();
+  }
+
+  /**
+   * Directory {@code edits.sync} temporarily holds the log segments
+   * downloaded through {@link JournalNodeSyncer} before they are moved to
+   * {@code current} directory.
+   *
+   * @return the directory path
+   */
+  File getEditsSyncDir() {
+    return new File(sd.getRoot(), STORAGE_EDITS_SYNC);
+  }
+
+  File getTemporaryEditsFile(long startTxId, long endTxId) {
+    return new File(getEditsSyncDir(), String.format("%s_%019d-%019d",
+            NNStorage.NameNodeFile.EDITS.getName(), startTxId, endTxId));
-    return NNStorage.getFinalizedEditsFile(sd, startTxId, endTxId);
+    return new File(sd.getCurrentDir(), String.format("%s_%019d-%019d",
+            NNStorage.NameNodeFile.EDITS.getName(), startTxId, endTxId));

INS23 INS31 INS31 INS83 INS83 INS83 INS43 INS59 MOV43 INS42 INS8 INS29 INS43 INS42 INS8 INS43 INS42 MOV44 MOV44 INS43 MOV44 MOV44 INS42 INS42 INS45 INS41 INS65 INS65 INS42 INS41 INS42 INS42 INS32 INS66 INS65 INS66 INS66 INS65 INS66 INS65 INS66 INS66 INS14 INS14 INS14 INS42 INS42 INS66 INS42 INS66 MOV43 INS32 INS42 INS43 INS32 INS32 INS43 INS32 INS32 INS42 INS42 INS42 INS42 UPD42 MOV42 UPD42 MOV42 INS45 INS32 MOV42 MOV42 INS42 INS42 INS42 UPD42 MOV42 UPD42 MOV42 INS45 INS32 MOV42 MOV42 INS40 UPD42 MOV42 INS40 UPD42 MOV42 DEL42 DEL39 DEL42 DEL44 DEL42 DEL32 DEL32