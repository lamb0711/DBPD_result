HDFS-11469. Ozone: SCM: Container allocation based on node report. Contributed by Xiaoyu Yao.

-  public boolean waitForHeartbeatThead() {
+  @Override
+  public boolean waitForHeartbeatProcessed() {
-    executorService.shutdown();
+    executorService.shutdown();
-   * Return a list of node stats.
-   * @return a list of individual node stats (live/stale but not dead).
+   * Return a map of node stats.
+   * @return a map of individual node stats (live/stale but not dead).
-  public List<SCMNodeStat> getNodeStats(){
-    return nodeStats.entrySet().stream().map(
-        entry -> nodeStats.get(entry.getKey())).collect(Collectors.toList());
+  public Map<String, SCMNodeStat> getNodeStats() {
+    return Collections.unmodifiableMap(nodeStats);
+  }
+
+  /**
+   * Return the node stat of the specified datanode.
+   * @param datanodeID - datanode ID.
+   * @return node stat if it is live/stale, null if it is dead or does't exist.
+   */
+  @Override
+  public SCMNodeStat getNodeStat(DatanodeID datanodeID) {
+    return nodeStats.get(datanodeID.getDatanodeUuid());

INS31 INS31 INS78 UPD42 MOV21 MOV29 MOV78 MOV83 UPD74 MOV74 MOV42 INS8 INS29 INS78 INS83 MOV43 INS42 INS44 INS8 INS42 INS43 INS43 UPD43 INS41 INS65 INS65 INS65 INS42 INS43 INS42 INS41 UPD66 UPD66 INS42 INS42 UPD42 INS32 INS66 INS42 INS66 INS66 INS42 INS32 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 MOV32 UPD42 UPD42 DEL32 DEL32 DEL42 DEL42 DEL59 DEL42 DEL42 DEL42 DEL32 DEL32 DEL86 DEL32 DEL32 DEL41 DEL8 DEL31