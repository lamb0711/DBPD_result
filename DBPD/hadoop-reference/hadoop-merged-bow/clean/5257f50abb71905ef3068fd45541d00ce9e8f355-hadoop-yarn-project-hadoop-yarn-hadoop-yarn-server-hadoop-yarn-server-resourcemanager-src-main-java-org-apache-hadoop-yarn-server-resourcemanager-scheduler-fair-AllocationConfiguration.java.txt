YARN-8967. Change FairScheduler to use PlacementRule interface. Contributed by Wilfred Spiegelenburg.

-import org.apache.hadoop.conf.Configuration;
-  // Policy for mapping apps to queues
-  @VisibleForTesting
-  QueuePlacementPolicy placementPolicy;
-
+  /**
+   * Create a fully initialised configuration for the scheduler.
+   * @param queueProperties The list of queues and their properties from the
+   *                        configuration.
+   * @param allocationFileParser The allocation file parser
+   * @param globalReservationQueueConfig The reservation queue config
+   * @throws AllocationConfigurationException
+   */
-      QueuePlacementPolicy newPlacementPolicy,
-    this.placementPolicy = newPlacementPolicy;
-  public AllocationConfiguration(Configuration conf) {
+  /**
+   * Create a base scheduler configuration with just the defaults set.
+   * Should only be called to init a basic setup on scheduler init.
+   * @param scheduler The {@link FairScheduler} to create and initialise the
+   *                  placement policy.
+   */
+  public AllocationConfiguration(FairScheduler scheduler) {
-    placementPolicy =
-        QueuePlacementPolicy.fromConfiguration(conf, configuredQueues);
+    QueuePlacementPolicy.fromConfiguration(scheduler);
-  public QueuePlacementPolicy getPlacementPolicy() {
-    return placementPolicy;
-  }
-

INS29 INS29 INS65 INS65 INS65 INS65 INS65 INS65 INS65 UPD43 UPD42 INS66 INS42 INS66 INS66 INS42 INS66 INS42 INS66 INS42 INS66 INS66 INS42 INS66 INS65 INS66 INS66 UPD42 INS32 INS42 MOV42 MOV42 UPD42 MOV42 DEL40 DEL26 DEL42 DEL78 DEL42 DEL43 DEL42 DEL59 DEL23 DEL42 DEL43 DEL42 DEL44 DEL52 DEL42 DEL22 DEL42 DEL7 DEL21 DEL42 DEL42 DEL32 DEL7 DEL83 DEL42 DEL43 DEL42 DEL42 DEL41 DEL8 DEL31