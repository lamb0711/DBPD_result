HDFS-9601. NNThroughputBenchmark.BlockReportStats should handle NotReplicatedYetException on adding block (iwasakims)

+import org.apache.hadoop.ipc.RemoteException;
-        LocatedBlock loc = clientProto.addBlock(fileName, clientName,
+        LocatedBlock loc = addBlock(fileName, clientName,
+        // IBRs are asynchronously processed by NameNode. The next
+        // ClientProtocol#addBlock() may throw NotReplicatedYetException.
+     * Retry ClientProtocol.addBlock() if it throws NotReplicatedYetException.
+     * Because addBlock() also commits the previous block,
+     * it fails if enough IBRs are not processed by NameNode.
+     */
+    private LocatedBlock addBlock(String src, String clientName,
+        ExtendedBlock previous, DatanodeInfo[] excludeNodes, long fileId,
+        String[] favoredNodes) throws IOException {
+      for (int i = 0; i < 30; i++) {
+        try {
+          return clientProto.addBlock(src, clientName,
+              previous, excludeNodes, fileId, favoredNodes);
+        } catch (NotReplicatedYetException|RemoteException e) {
+          if (e instanceof RemoteException) {
+            String className = ((RemoteException) e).getClassName();
+            if (!className.equals(NotReplicatedYetException.class.getName())) {
+              throw e;
+            }
+          }
+          try {
+            Thread.sleep(100);
+          } catch (InterruptedException ie) {
+            LOG.warn("interrupted while retrying addBlock.", ie);
+          }
+        }
+      }
+      throw new IOException("failed to add block.");
+    }
+
+    /**

INS26 INS40 INS31 INS29 INS83 INS43 INS42 INS44 INS44 INS44 INS44 INS44 INS44 INS43 INS8 INS65 INS42 INS43 INS42 INS43 INS42 INS43 INS42 INS5 INS42 INS39 INS42 INS5 INS42 INS42 INS24 INS53 INS66 INS66 INS66 INS42 INS42 INS42 INS43 INS85 INS43 INS85 INS58 INS27 INS37 INS8 INS14 INS42 INS42 INS39 INS59 INS42 INS34 INS42 INS54 INS43 INS45 INS42 INS34 INS8 INS12 INS42 INS41 INS44 INS8 INS32 INS84 INS42 INS25 INS54 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS43 INS43 INS62 INS8 INS8 INS12 INS42 INS42 INS42 INS43 INS60 INS25 INS21 INS44 INS8 INS42 INS43 INS59 INS38 INS8 INS32 INS43 INS42 INS21 INS42 INS42 INS32 INS32 INS53 INS42 INS42 INS34 INS42 INS32 INS36 INS42 INS42 INS42 INS32 INS42 INS42 INS42 INS45 INS42 INS11 INS57 INS42 INS43 INS42 INS43 INS42 INS42 DEL42