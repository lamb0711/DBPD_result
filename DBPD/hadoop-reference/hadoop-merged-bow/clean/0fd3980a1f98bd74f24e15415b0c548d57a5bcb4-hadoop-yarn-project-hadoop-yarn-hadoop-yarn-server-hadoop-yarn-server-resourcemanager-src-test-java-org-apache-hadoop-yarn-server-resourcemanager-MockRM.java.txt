YARN-5037. Fix random failure of TestRMRestart#testQueueMetricsOnRMRestart (sandflee via Varun Saxena).

+import org.apache.hadoop.yarn.server.resourcemanager.scheduler.SchedulerApplication;
+  private static final int TIMEOUT_MS_FOR_APP_REMOVED = 40 * SECOND;
+
+
+  /**
+   * Wait until an app removed from scheduler.
+   * The timeout is 40 seconds.
+   * @param appId the id of an app
+   * @throws InterruptedException
+   *         if interrupted while waiting for app removed
+   */
+  public void waitForAppRemovedFromScheduler(ApplicationId appId)
+      throws InterruptedException {
+    waitForAppRemovedFromScheduler(appId, TIMEOUT_MS_FOR_APP_REMOVED);
+  }
+
+  /**
+   * Wait until an app is removed from scheduler.
+   * @param appId the id of an app
+   * @param timeoutMsecs the length of timeout in milliseconds
+   * @throws InterruptedException
+   *         if interrupted while waiting for app removed
+   */
+  public void waitForAppRemovedFromScheduler(ApplicationId appId,
+      long timeoutMsecs) throws InterruptedException {
+    int timeWaiting = 0;
+
+    Map<ApplicationId, SchedulerApplication> apps  =
+        ((AbstractYarnScheduler) getResourceScheduler())
+            .getSchedulerApplications();
+    while (apps.containsKey(appId)) {
+      if (timeWaiting >= timeoutMsecs) {
+        break;
+      }
+      LOG.info("wait for app removed, " + appId);
+      Thread.sleep(WAIT_MS_PER_LOOP);
+      timeWaiting += WAIT_MS_PER_LOOP;
+    }
+    Assert.assertTrue("app is not removed from scheduler (timeout).",
+        !apps.containsKey(appId));
+    LOG.info("app is removed from scheduler, " + appId);
+  }

INS26 INS40 INS23 INS31 INS31 INS83 INS83 INS83 INS39 INS59 INS29 INS83 INS39 INS42 INS44 INS43 INS8 INS29 INS83 INS39 INS42 INS44 INS44 INS43 INS8 INS42 INS27 INS65 INS65 INS65 INS43 INS42 INS42 INS21 INS65 INS65 INS65 INS65 INS43 INS42 INS39 INS42 INS42 INS60 INS60 INS61 INS21 INS21 INS34 INS42 INS66 INS66 INS42 INS66 INS42 INS66 INS42 INS32 INS66 INS42 INS66 INS42 INS66 INS42 INS66 INS42 INS39 INS59 INS74 INS59 INS32 INS8 INS32 INS32 INS42 INS42 INS42 INS42 INS34 INS43 INS43 INS43 INS42 INS32 INS42 INS42 INS42 INS25 INS21 INS21 INS21 INS42 INS42 INS45 INS38 INS42 INS42 INS27 INS42 INS42 INS42 INS36 INS42 INS27 INS8 INS32 INS32 INS7 INS32 INS45 INS42 INS11 INS42 INS42 INS10 INS42 INS42 INS27 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS43 INS32 INS45 INS42 INS42 INS42