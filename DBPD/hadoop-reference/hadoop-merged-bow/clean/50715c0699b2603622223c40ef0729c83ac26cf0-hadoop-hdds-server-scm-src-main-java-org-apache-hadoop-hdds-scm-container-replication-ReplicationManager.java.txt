HDDS-662. Introduce ContainerReplicaState in StorageContainerManager. Contributed by Nanda kumar.

+import java.util.stream.Collectors;
-import org.apache.hadoop.hdds.scm.container.ContainerStateManager;
-import org.apache.hadoop.hdds.scm.container.common.helpers.ContainerInfo;
+import org.apache.hadoop.hdds.scm.container.ContainerInfo;
+import org.apache.hadoop.hdds.scm.container.ContainerManager;
+import org.apache.hadoop.hdds.scm.container.ContainerReplica;
-  private ContainerStateManager containerStateManager;
+  private ContainerManager containerManager;
-      ContainerStateManager containerStateManager, EventQueue eventQueue,
+      ContainerManager containerManager, EventQueue eventQueue,
-    this.containerStateManager = containerStateManager;
+    this.containerManager = containerManager;
-            containerStateManager.getContainer(containerID);
+            containerManager.getContainer(containerID);
-        List<DatanodeDetails> datanodesWithReplicas =
+        List<ContainerReplica> containerReplicas =
-        if (datanodesWithReplicas.size() == 0) {
+        if (containerReplicas.size() == 0) {
-            request.getExpecReplicationCount() - datanodesWithReplicas.size()
+            request.getExpecReplicationCount() - containerReplicas.size()
+          List<DatanodeDetails> datanodes = containerReplicas.stream()
+              .map(ContainerReplica::getDatanodeDetails)
+              .collect(Collectors.toList());
-              .chooseDatanodes(datanodesWithReplicas, deficit,
+              .chooseDatanodes(datanodes, deficit,
-                new ReplicateContainerCommand(containerID.getId(),
-                    datanodesWithReplicas);
+                new ReplicateContainerCommand(containerID.getId(), datanodes);
-  protected Set<DatanodeDetails> getCurrentReplicas(ReplicationRequest request)
+  protected Set<ContainerReplica> getCurrentReplicas(ReplicationRequest request)
-    return containerStateManager
+    return containerManager
-  public static class ReplicationCompleted implements IdentifiableEventPayload {
+  /**
+   * Add javadoc.
+   */
+  public static class ReplicationCompleted
+      implements IdentifiableEventPayload {

INS26 INS26 INS40 INS40 UPD40 UPD40 UPD43 UPD74 INS29 UPD42 UPD42 UPD43 UPD42 UPD43 INS65 UPD42 UPD42 INS66 UPD42 UPD42 UPD42 INS74 INS43 INS43 UPD42 INS60 UPD42 INS42 INS42 UPD42 MOV74 INS59 UPD42 INS42 INS32 INS32 INS42 INS32 UPD42 INS32 INS42 INS90 INS42 INS42 INS42 INS42 INS42 INS42 UPD42