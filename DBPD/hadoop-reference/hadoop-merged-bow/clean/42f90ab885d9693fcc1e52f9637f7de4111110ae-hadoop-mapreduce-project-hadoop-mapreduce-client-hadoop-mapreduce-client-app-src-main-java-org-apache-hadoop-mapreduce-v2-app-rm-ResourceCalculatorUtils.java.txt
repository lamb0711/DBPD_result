YARN-4844. Add getMemorySize/getVirtualCoresSize to o.a.h.y.api.records.Resource. Contributed by Wangda Tan.

-import org.apache.hadoop.yarn.util.Records;
-  public static int divideAndCeil(int a, int b) {
+  public static int divideAndCeil(long a, long b) {
-    return (a + (b - 1)) / b;
+    return (int) ((a + (b - 1)) / b);
-        calculateRatioOrMaxValue(available.getMemory(), required.getMemory()),
+        calculateRatioOrMaxValue(available.getMemorySize(), required.getMemorySize()),
-      available.getMemory(), required.getMemory());
+      available.getMemorySize(), required.getMemorySize());
-      return Math.max(divideAndCeil(required.getMemory(), factor.getMemory()),
+      return Math.max(divideAndCeil(required.getMemorySize(), factor.getMemorySize()),
-    return divideAndCeil(required.getMemory(), factor.getMemory());
+    return divideAndCeil(required.getMemorySize(), factor.getMemorySize());
-  private static int calculateRatioOrMaxValue(int numerator, int denominator) {
+  private static int calculateRatioOrMaxValue(long numerator, long denominator) {
-    return numerator / denominator;
+    return (int) (numerator / denominator);

UPD39 UPD39 UPD39 UPD39 INS11 INS11 INS39 INS36 INS39 INS36 MOV27 UPD42 UPD42 UPD42 UPD42 MOV27 UPD42 UPD42 UPD42 UPD42 DEL40 DEL26