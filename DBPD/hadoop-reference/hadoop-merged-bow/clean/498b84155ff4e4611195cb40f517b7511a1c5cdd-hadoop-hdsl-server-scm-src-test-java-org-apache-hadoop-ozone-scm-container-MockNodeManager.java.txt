HDFS-13300. Ozone: Remove DatanodeID dependency from HDSL and Ozone.
Contributed by Nanda kumar.

-import org.apache.hadoop.hdfs.protocol.DatanodeID;
+import org.apache.hadoop.hdsl.protocol.DatanodeDetails;
-import static org.apache.hadoop.ozone.scm.TestUtils.getDatanodeID;
+import static org.apache.hadoop.ozone.scm.TestUtils.getDatanodeDetails;
+import java.util.UUID;
-  private final List<DatanodeID> healthyNodes;
-  private final List<DatanodeID> staleNodes;
-  private final List<DatanodeID> deadNodes;
-  private final Map<String, SCMNodeStat> nodeMetricMap;
+  private final List<DatanodeDetails> healthyNodes;
+  private final List<DatanodeDetails> staleNodes;
+  private final List<DatanodeDetails> deadNodes;
+  private final Map<UUID, SCMNodeStat> nodeMetricMap;
-  private final Map<DatanodeID, List<SCMCommand>> commandMap;
+  private final Map<UUID, List<SCMCommand>> commandMap;
-        DatanodeID id = getDatanodeID();
-        populateNodeMetric(id, x);
+        DatanodeDetails dd = getDatanodeDetails();
+        populateNodeMetric(dd, x);
-   * @param datanodeID - Datanode ID
+   * @param datanodeDetails - Datanode details
-  private void populateNodeMetric(DatanodeID datanodeID, int x) {
+  private void populateNodeMetric(DatanodeDetails datanodeDetails, int x) {
-    this.nodeMetricMap.put(datanodeID.toString(), newStat);
+    this.nodeMetricMap.put(datanodeDetails.getUuid(), newStat);
-      healthyNodes.add(datanodeID);
+      healthyNodes.add(datanodeDetails);
-      staleNodes.add(datanodeID);
+      staleNodes.add(datanodeDetails);
-      deadNodes.add(datanodeID);
+      deadNodes.add(datanodeDetails);
-  public void removeNode(DatanodeID node) throws UnregisteredNodeException {
+  public void removeNode(DatanodeDetails node)
+      throws UnregisteredNodeException {
-  public List<DatanodeID> getNodes(HdslProtos.NodeState nodestate) {
+  public List<DatanodeDetails> getNodes(HdslProtos.NodeState nodestate) {
-    List<DatanodeID> nodes = getNodes(nodestate);
+    List<DatanodeDetails> nodes = getNodes(nodestate);
-   * @return List of DatanodeIDs known to SCM.
+   * @return List of DatanodeDetails known to SCM.
-  public List<DatanodeID> getAllNodes() {
+  public List<DatanodeDetails> getAllNodes() {
-  public Map<String, SCMNodeStat> getNodeStats() {
+  public Map<UUID, SCMNodeStat> getNodeStats() {
-   * @param datanodeID - datanode ID.
+   * @param datanodeDetails - datanode details.
-  public SCMNodeMetric getNodeStat(DatanodeID datanodeID) {
-    return new SCMNodeMetric(nodeMetricMap.get(datanodeID.toString()));
+  public SCMNodeMetric getNodeStat(DatanodeDetails datanodeDetails) {
+    return new SCMNodeMetric(nodeMetricMap.get(datanodeDetails.getUuid()));
-   * @param id - DatanodeID
+   * @param dd - DatanodeDetails
-  public HdslProtos.NodeState getNodeState(DatanodeID id) {
+  public HdslProtos.NodeState getNodeState(DatanodeDetails dd) {
-  public void addDatanodeCommand(DatanodeID id, SCMCommand command) {
-    if(commandMap.containsKey(id)) {
-      List<SCMCommand> commandList = commandMap.get(id);
+  public void addDatanodeCommand(UUID dnId, SCMCommand command) {
+    if(commandMap.containsKey(dnId)) {
+      List<SCMCommand> commandList = commandMap.get(dnId);
-      commandMap.put(id, commandList);
+      commandMap.put(dnId, commandList);
-  public int getCommandCount(DatanodeID id) {
-    List<SCMCommand> list = commandMap.get(id);
+  public int getCommandCount(DatanodeDetails dd) {
+    List<SCMCommand> list = commandMap.get(dd);
-  public void clearCommandQueue(DatanodeID id) {
-    if(commandMap.containsKey(id)) {
-      commandMap.put(id, new LinkedList<>());
+  public void clearCommandQueue(UUID dnId) {
+    if(commandMap.containsKey(dnId)) {
+      commandMap.put(dnId, new LinkedList<>());
-   * @param datanodeID - Send datanodeID with Node info, but datanode UUID is
-   * empty. Server returns a datanodeID for the given node.
+   * @param datanodeDetails DatanodeDetailsProto
-  public SCMCommand register(DatanodeID datanodeID) {
+  public SCMCommand register(HdslProtos.DatanodeDetailsProto datanodeDetails) {
-   * @param datanodeID - Datanode ID.
+   * @param datanodeDetails - Datanode ID.
-  public List<SCMCommand> sendHeartbeat(DatanodeID datanodeID,
+  public List<SCMCommand> sendHeartbeat(
+      HdslProtos.DatanodeDetailsProto datanodeDetails,
-    if ((datanodeID != null) && (nodeReport != null) && (nodeReport
+    if ((datanodeDetails != null) && (nodeReport != null) && (nodeReport
-      SCMNodeStat stat = this.nodeMetricMap.get(datanodeID.toString());
+      SCMNodeStat stat = this.nodeMetricMap.get(datanodeDetails.getUuid());
-      nodeMetricMap.put(datanodeID.toString(), stat);
+      nodeMetricMap.put(DatanodeDetails
+          .getFromProtoBuf(datanodeDetails).getUuid(), stat);
-   * @param datanodeID datanode ID
+   * @param datanodeDetails datanode details
-  public void addContainer(DatanodeID datanodeID, long size) {
-    SCMNodeStat stat = this.nodeMetricMap.get(datanodeID.toString());
+  public void addContainer(DatanodeDetails datanodeDetails, long size) {
+    SCMNodeStat stat = this.nodeMetricMap.get(datanodeDetails.getUuid());
-      nodeMetricMap.put(datanodeID.toString(), stat);
+      nodeMetricMap.put(datanodeDetails.getUuid(), stat);
-   * @param datanodeID datanode ID
+   * @param datanodeDetails datanode Details
-  public void delContainer(DatanodeID datanodeID, long size) {
-    SCMNodeStat stat = this.nodeMetricMap.get(datanodeID.toString());
+  public void delContainer(DatanodeDetails datanodeDetails, long size) {
+    SCMNodeStat stat = this.nodeMetricMap.get(datanodeDetails.getUuid());
-      nodeMetricMap.put(datanodeID.toString(), stat);
+      nodeMetricMap.put(datanodeDetails.getUuid(), stat);

MOV26 INS26 UPD40 UPD40 INS40 UPD74 UPD74 UPD74 UPD74 UPD74 UPD74 UPD74 UPD74 UPD43 UPD43 UPD43 UPD43 UPD43 UPD43 UPD42 UPD43 UPD43 UPD43 UPD43 UPD43 UPD42 UPD43 UPD42 UPD43 UPD42 UPD43 UPD42 UPD43 UPD42 UPD43 UPD42 UPD43 UPD42 UPD43 UPD42 UPD43 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD66 UPD42 UPD42 UPD42 UPD74 UPD66 UPD42 UPD42 UPD42 UPD66 UPD42 UPD42 UPD66 UPD42 UPD42 UPD42 UPD42 UPD42 UPD66 INS40 UPD42 INS40 UPD42 UPD66 UPD42 UPD42 UPD66 UPD42 UPD43 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD43 UPD42 INS32 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 INS42 INS42 UPD42 MOV42 UPD42 DEL66 DEL42 DEL42