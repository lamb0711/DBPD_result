HDFS-14333. Datanode fails to start if any disk has errors during Namenode registration. Contributed by Stephen O'Donnell.

Signed-off-by: Wei-Chiu Chuang <weichiu@apache.org>

-  private void waitDataNodeFullyStarted(final DataNode dn)
+  public void waitDatanodeFullyStarted(DataNode dn, int timeout)
-    }, 100, 60000);
+    }, 100, timeout);
+  }
+
+  private void waitDataNodeFullyStarted(final DataNode dn)
+      throws TimeoutException, InterruptedException {
+    waitDatanodeFullyStarted(dn, 60000);

INS31 UPD83 UPD42 INS44 INS44 INS83 INS39 INS42 MOV44 INS43 INS43 INS8 INS43 INS42 INS39 INS42 INS42 INS42 INS21 INS42 INS32 INS42 INS42 INS42 INS34 DEL34