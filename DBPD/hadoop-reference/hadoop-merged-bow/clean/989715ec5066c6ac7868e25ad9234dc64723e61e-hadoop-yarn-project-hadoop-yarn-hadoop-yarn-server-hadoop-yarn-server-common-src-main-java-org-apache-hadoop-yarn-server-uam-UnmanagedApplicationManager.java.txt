YARN-8893. [AMRMProxy] Fix thread leak in AMRMClientRelayer and UAM client. Contributed by Botong Huang.

-
-    this.heartbeatHandler.shutdown();
-
-    return this.rmProxyRelayer.finishApplicationMaster(request);
+    FinishApplicationMasterResponse response =
+        this.rmProxyRelayer.finishApplicationMaster(request);
+    if (response.getIsUnregistered()) {
+      shutDownConnections();
+    }
+    return response;
+    shutDownConnections();
+
-
-    this.heartbeatHandler.shutdown();
-
+   * Shutdown this UAM client, without killing the UAM in the YarnRM side.
+   */
+  public void shutDownConnections() {
+    this.heartbeatHandler.shutdown();
+    this.rmProxyRelayer.shutdown();
+  }
+
+  /**
+
+  @VisibleForTesting
+  protected boolean isHeartbeatThreadAlive() {
+    return this.heartbeatHandler.isAlive();
+  }

INS31 INS31 MOV60 INS29 INS83 INS39 INS42 INS8 INS78 INS83 INS39 INS42 INS8 INS60 INS25 INS65 MOV21 INS21 INS42 INS41 INS43 INS59 INS32 INS8 INS42 INS66 INS32 INS32 INS42 INS42 MOV32 INS42 INS42 INS21 UPD42 INS22 INS42 INS22 INS42 INS32 INS52 INS42 INS52 INS42 INS42 DEL52 DEL42 DEL22