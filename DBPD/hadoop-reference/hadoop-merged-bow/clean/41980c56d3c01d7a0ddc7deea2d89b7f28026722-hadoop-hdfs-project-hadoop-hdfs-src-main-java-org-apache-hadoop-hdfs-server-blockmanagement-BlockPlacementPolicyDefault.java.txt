HDFS-7208. NN doesn't schedule replication when a DN storage fails.  Contributed by Ming Ma

+
+    if (storage.getState() == State.FAILED) {
+      logNodeIsNotChosen(storage, "storage has failed");
+      return false;
+    }
+

INS25 INS27 INS8 INS32 INS40 INS21 INS41 INS42 INS42 INS32 INS9 INS42 INS42 INS45