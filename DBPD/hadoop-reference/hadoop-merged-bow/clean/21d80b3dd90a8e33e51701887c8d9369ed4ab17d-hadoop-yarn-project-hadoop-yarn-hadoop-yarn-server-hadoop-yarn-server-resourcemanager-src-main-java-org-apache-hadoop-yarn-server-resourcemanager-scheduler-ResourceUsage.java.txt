YARN-3098. Created common QueueCapacities class in Capacity Scheduler to track capacities-by-labels of queues. Contributed by Wangda Tan

-    private int value;
+    private int idx;
-      this.value = value;
-    }
-
-    public int getValue() {
-      return this.value;
+      this.idx = value;
-
-    public Resource get(ResourceType type) {
-      return resArr[type.getValue()];
-    }
-
-    public void set(ResourceType type, Resource res) {
-      resArr[type.getValue()] = res;
-    }
-
-    public void inc(ResourceType type, Resource res) {
-      Resources.addTo(resArr[type.getValue()], res);
-    }
-
-    public void dec(ResourceType type, Resource res) {
-      Resources.subtractFrom(resArr[type.getValue()], res);
-    }
-    return internalGet(label, ResourceType.USED);
+    return _get(label, ResourceType.USED);
-    internalInc(label, ResourceType.USED, res);
+    _inc(label, ResourceType.USED, res);
-    internalDec(label, ResourceType.USED, res);
+    _dec(label, ResourceType.USED, res);
-    internalSet(label, ResourceType.USED, res);
+    _set(label, ResourceType.USED, res);
-    return internalGet(label, ResourceType.PENDING);
+    return _get(label, ResourceType.PENDING);
-    internalInc(label, ResourceType.PENDING, res);
+    _inc(label, ResourceType.PENDING, res);
-    internalDec(label, ResourceType.PENDING, res);
+    _dec(label, ResourceType.PENDING, res);
-    internalSet(label, ResourceType.PENDING, res);
+    _set(label, ResourceType.PENDING, res);
-    return internalGet(label, ResourceType.RESERVED);
+    return _get(label, ResourceType.RESERVED);
-    internalInc(label, ResourceType.RESERVED, res);
+    _inc(label, ResourceType.RESERVED, res);
-    internalDec(label, ResourceType.RESERVED, res);
+    _dec(label, ResourceType.RESERVED, res);
-    internalSet(label, ResourceType.RESERVED, res);
+    _set(label, ResourceType.RESERVED, res);
-    return internalGet(label, ResourceType.HEADROOM);
+    return _get(label, ResourceType.HEADROOM);
-    internalInc(label, ResourceType.HEADROOM, res);
+    _inc(label, ResourceType.HEADROOM, res);
-    internalDec(label, ResourceType.HEADROOM, res);
+    _dec(label, ResourceType.HEADROOM, res);
-    internalSet(label, ResourceType.HEADROOM, res);
+    _set(label, ResourceType.HEADROOM, res);
-    return internalGet(label, ResourceType.AMUSED);
+    return _get(label, ResourceType.AMUSED);
-    internalInc(label, ResourceType.AMUSED, res);
+    _inc(label, ResourceType.AMUSED, res);
-    internalDec(label, ResourceType.AMUSED, res);
+    _dec(label, ResourceType.AMUSED, res);
-    internalSet(label, ResourceType.AMUSED, res);
+    _set(label, ResourceType.AMUSED, res);
-  private Resource internalGet(String label, ResourceType type) {
+  private Resource _get(String label, ResourceType type) {
-      return normalize(usage.get(type));
+      return normalize(usage.resArr[type.idx]);
-  private void internalSet(String label, ResourceType type, Resource res) {
+  private void _set(String label, ResourceType type, Resource res) {
-      usage.set(type, res);
+      usage.resArr[type.idx] = res;
-  private void internalInc(String label, ResourceType type, Resource res) {
+  private void _inc(String label, ResourceType type, Resource res) {
-      usage.inc(type, res);
+      Resources.addTo(usage.resArr[type.idx], res);
-  private void internalDec(String label, ResourceType type, Resource res) {
+  private void _dec(String label, ResourceType type, Resource res) {
-      usage.dec(type, res);
+      Resources.subtractFrom(usage.resArr[type.idx], res);

MOV31 MOV31 MOV43 MOV44 MOV44 MOV44 MOV44 MOV44 MOV44 MOV44 MOV43 MOV44 MOV44 MOV44 MOV44 MOV44 MOV44 MOV44 MOV43 MOV44 MOV44 MOV44 MOV44 MOV44 MOV44 MOV44 MOV43 MOV44 MOV44 MOV44 MOV44 MOV44 MOV44 MOV44 MOV43 MOV44 MOV44 MOV44 MOV44 MOV44 MOV44 MOV44 UPD42 UPD42 MOV44 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 INS7 UPD42 INS2 INS2 INS42 UPD42 UPD42 INS2 UPD42 UPD42 INS2 INS40 INS40 INS40 INS40 INS40 INS40 INS40 INS40 DEL83 DEL39 DEL42 DEL52 DEL42 DEL22 DEL41 DEL8 DEL31 DEL83 DEL42 DEL42 DEL43 DEL42 DEL44 DEL42 DEL42 DEL42 DEL32 DEL2 DEL41 DEL8 DEL31 DEL83 DEL39 DEL42 DEL42 DEL43 DEL42 DEL44 DEL42 DEL42 DEL42 DEL32 DEL2 DEL42 DEL7 DEL21 DEL8 DEL31 DEL83 DEL39 DEL42 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL44 DEL42 DEL42 DEL42 DEL42 DEL42 DEL32 DEL2 DEL42 DEL32 DEL21 DEL8 DEL31 DEL83 DEL39 DEL42 DEL42 DEL43 DEL42 DEL44 DEL42 DEL42 DEL42 DEL42 DEL42 DEL32 DEL2 DEL42 DEL32 DEL21 DEL8 DEL31 DEL42 DEL43 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL44 DEL42 DEL42 DEL42 DEL32 DEL42 DEL42 DEL42 DEL42 DEL32 DEL42 DEL42