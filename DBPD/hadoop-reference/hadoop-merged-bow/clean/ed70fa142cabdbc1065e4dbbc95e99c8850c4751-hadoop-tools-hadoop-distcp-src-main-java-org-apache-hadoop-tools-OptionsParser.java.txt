HDFS-7535. Utilize Snapshot diff report for distcp. Contributed by Jing Zhao.

-import org.apache.commons.cli.*;
+import java.util.ArrayList;
+import java.util.Arrays;
+import java.util.List;
+
+import org.apache.commons.cli.CommandLine;
+import org.apache.commons.cli.CommandLineParser;
+import org.apache.commons.cli.GnuParser;
+import org.apache.commons.cli.HelpFormatter;
+import org.apache.commons.cli.Options;
+import org.apache.commons.cli.ParseException;
-import java.util.*;
+import com.google.common.base.Preconditions;
+    if (command.hasOption(DistCpOptionSwitch.DIFF.getSwitch())) {
+      String[] snapshots = getVals(command, DistCpOptionSwitch.DIFF.getSwitch());
+      Preconditions.checkArgument(snapshots != null && snapshots.length == 2,
+          "Must provide both the starting and ending snapshot names");
+      option.setUseDiff(true, snapshots[0], snapshots[1]);
+    }
+
+  private static String[] getVals(CommandLine command, String option) {
+    return command.getOptionValues(option);
+  }
+

MOV26 INS26 INS26 INS26 INS26 INS26 INS26 INS26 INS26 INS40 INS40 INS40 INS40 INS40 INS40 INS40 UPD40 UPD40 INS40 INS31 INS83 INS83 INS5 INS42 INS44 INS44 INS8 INS25 INS43 INS85 INS43 INS42 INS43 INS42 INS41 INS32 INS8 INS42 INS42 INS42 INS32 INS42 INS42 INS32 INS60 INS21 INS21 INS42 INS42 INS42 INS40 INS42 INS5 INS59 INS32 INS32 INS43 INS85 INS42 INS32 INS42 INS42 INS27 INS45 INS42 INS42 INS9 INS2 INS2 INS42 INS42 INS42 INS32 INS27 INS27 INS42 INS34 INS42 INS34 INS40 INS42 INS42 INS33 INS40 INS34