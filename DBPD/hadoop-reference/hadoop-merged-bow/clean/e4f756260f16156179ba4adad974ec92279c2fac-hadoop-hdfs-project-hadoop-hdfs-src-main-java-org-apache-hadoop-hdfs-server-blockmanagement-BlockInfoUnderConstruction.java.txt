HDFS-8344. NameNode doesn't recover lease for files with missing blocks (raviprak)

-import java.util.ArrayList;
+  /** The number of times all replicas will be used to attempt recovery before
+   * giving up and marking the block under construction missing.
+   */
+  private int recoveryAttemptsBeforeMarkingBlockMissing;
+
+    this.recoveryAttemptsBeforeMarkingBlockMissing =
+      BlockManager.getMaxBlockUCRecoveries();
-          "No blocks found, lease removed.");
+          "No replicas found.");
+      recoveryAttemptsBeforeMarkingBlockMissing--;
+      NameNode.blockStateChangeLog.info("Tried to recover " + this +" using all"
+          + " replicas. Will try " + recoveryAttemptsBeforeMarkingBlockMissing
+          + " more times");
+
+  public int getNumRecoveryAttemptsLeft() {
+    return recoveryAttemptsBeforeMarkingBlockMissing;
+  }
+

INS23 INS31 INS29 INS83 INS39 INS59 INS83 INS39 INS42 INS8 INS65 INS42 INS21 INS41 INS66 INS66 INS7 INS42 INS22 INS32 INS21 INS21 INS52 INS42 INS42 INS42 INS37 INS32 INS42 INS40 INS42 INS27 UPD45 INS45 INS52 INS45 INS45 INS42 INS45 DEL40 DEL26