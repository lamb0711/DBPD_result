HADOOP-14274. Azure: Simplify Ranger-WASB policy model. Contributed by Sivaguru Sankaridurg

+import java.util.regex.Pattern;
-    AuthorizationComponent component =
-        new AuthorizationComponent(wasbAbsolutePath, accessType);
+
+    AuthorizationComponent component = wasbAbsolutePath.endsWith("*")
+        ? new AuthorizationComponent("^" + wasbAbsolutePath.replace("*", ".*"), accessType)
+        : new AuthorizationComponent(wasbAbsolutePath, accessType);
+
+    if (wasbAbsolutePath.endsWith(NativeAzureFileSystem.FolderRenamePending.SUFFIX)) {
+      return true;
+    }
+
+      // Regex-pattern match if we don't have a straight match
+      for (Map.Entry<AuthorizationComponent, Boolean> entry : authRules.entrySet()) {
+        AuthorizationComponent key = entry.getKey();
+        String keyPath = key.getWasbAbsolutePath();
+        String keyAccess = key.getAccessType();
+
+        if (keyPath.endsWith("*") && Pattern.matches(keyPath, wasbAbsolutePath) && keyAccess.equals(accessType)) {
+          return entry.getValue();
+        }
+      }

INS26 INS40 INS8 INS25 MOV60 INS25 INS32 INS8 MOV32 MOV8 INS8 INS16 INS42 INS42 INS40 INS41 INS70 MOV41 INS32 INS14 INS14 INS9 INS44 INS32 INS8 INS42 INS42 INS45 MOV43 INS27 MOV42 INS43 INS42 INS42 INS74 INS42 INS42 INS42 INS60 INS60 INS60 MOV25 INS45 INS32 INS42 INS43 INS43 INS43 INS43 INS59 INS43 INS59 INS43 INS59 INS27 INS42 INS42 INS45 INS45 INS40 INS42 INS42 INS42 INS42 INS32 INS42 INS42 INS32 INS42 INS42 INS32 INS32 INS32 INS32 INS41 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS45 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS32 INS42 INS42 DEL42 DEL14 DEL8