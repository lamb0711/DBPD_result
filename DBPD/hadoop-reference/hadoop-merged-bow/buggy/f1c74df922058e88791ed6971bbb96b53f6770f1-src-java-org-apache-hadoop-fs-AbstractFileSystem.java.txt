HADOOP-7257 Client side mount tables (sanjay)


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1100026 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.ArrayList;
-    if (!authorityNeeded) {
-      if (authority != null) {
-        throw new HadoopIllegalArgumentException("Scheme with non-null authority: "
-            + uri);
-      }
-      return new URI(supportedScheme + ":///");
-    }
-      throw new HadoopIllegalArgumentException("Uri without authority: " + uri);
+       if (authorityNeeded) {
+         throw new HadoopIllegalArgumentException("Uri without authority: " + uri);
+       } else {
+         return new URI(supportedScheme + ":///");
+       }   
+    // authority is non null  - AuthorityNeeded may be true or false.
-    port = port == -1 ? defaultPort : port;
+    port = (port == -1 ? defaultPort : port);
+    if (port == -1) { // no port supplied and default port is not specified
+      return new URI(supportedScheme, authority, "/", null);
+    }
+   * Return the fully-qualified path of path f resolving the path
+   * through any internal symlinks or mount point
+   * @param p path to be resolved
+   * @return fully qualified path 
+   * @throws FileNotFoundException, AccessControlException, IOException
+   *         UnresolvedLinkException if symbolic link on path cannot be resolved
+   *          internally
+   */
+   public Path resolvePath(final Path p) throws FileNotFoundException,
+           UnresolvedLinkException, AccessControlException, IOException {
+     checkPath(p);
+     return getFileStatus(p).getPath(); // default impl is to return the path
+   }
+  
+  /**
+   *   If delegation tokens not supported then return a list of size zero.
-    return null;
+    return new ArrayList<Token<?>>(0);

INS26 INS40 INS31 MOV25 INS29 INS83 INS43 INS42 INS44 INS43 INS43 INS43 INS43 INS8 INS65 INS65 INS65 INS65 INS42 INS83 INS43 INS42 INS42 INS42 INS42 INS42 INS21 INS41 INS8 INS27 INS8 INS66 INS66 INS42 INS66 INS66 INS42 INS66 INS66 INS66 INS42 INS32 INS32 INS66 INS14 INS25 INS36 INS42 INS38 INS41 INS42 INS42 INS32 INS42 INS74 INS34 INS42 MOV8 MOV8 MOV16 INS34 INS14 INS42 INS42 INS43 INS74 INS43 INS42 INS42 INS45 INS33 INS42 INS43 INS76 INS42 INS42 DEL42 DEL33 DEL27 DEL42 DEL43 DEL45 DEL42 DEL27 DEL14 DEL53 DEL8 DEL25 DEL42 DEL38 DEL33