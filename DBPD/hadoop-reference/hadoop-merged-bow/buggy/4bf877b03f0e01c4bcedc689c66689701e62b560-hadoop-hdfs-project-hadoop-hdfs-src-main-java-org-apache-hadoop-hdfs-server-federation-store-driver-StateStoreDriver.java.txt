HDFS-10630. Federation State Store FS Implementation. Contributed by Jason Kace and Inigo Goiri.

(cherry picked from commit c6e0bd640cdaf83a660fa050809cad6f1d4c6f4d)

-import java.util.List;
+import java.util.Collection;
-import org.apache.commons.logging.Log;
-import org.apache.commons.logging.LogFactory;
+import org.apache.hadoop.hdfs.server.federation.store.StateStoreUtils;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
-  private static final Log LOG = LogFactory.getLog(StateStoreDriver.class);
+  private static final Logger LOG =
+      LoggerFactory.getLogger(StateStoreDriver.class);
+   *
-      final List<Class<? extends BaseRecord>> records) {
+      final Collection<Class<? extends BaseRecord>> records) {
-    // TODO stub
-    return false;
+    boolean success = initDriver();
+    if (!success) {
+      LOG.error("Cannot intialize driver for {}", getDriverName());
+      return false;
+    }
+
+    for (Class<? extends BaseRecord> cls : records) {
+      String recordString = StateStoreUtils.getRecordName(cls);
+      if (!initRecordStorage(recordString, cls)) {
+        LOG.error("Cannot initialize record store for {}", cls.getSimpleName());
+        return false;
+      }
+    }
+    return true;
-}
+}

MOV26 MOV26 INS26 UPD40 INS40 UPD40 UPD40 UPD43 UPD42 UPD74 INS60 INS25 INS70 INS41 UPD42 UPD42 UPD43 INS39 INS59 INS38 INS8 INS44 INS42 INS8 INS9 UPD42 INS42 INS32 INS42 INS21 MOV41 INS74 INS42 INS60 INS25 INS42 INS32 INS43 INS76 INS43 INS59 INS38 INS8 INS42 INS42 INS45 INS32 INS42 INS43 INS42 INS42 INS32 INS32 INS21 INS41 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS32 INS9 INS42 INS42 INS45 INS32 INS42 INS42