HADOOP-14773. Extend ZKCuratorManager API for more reusability. (Íñigo Goiri via Subru).

+import org.apache.zookeeper.data.Stat;
+import com.google.common.base.Preconditions;
+
-   * @param stat Output statistics of the ZNode.
+   * @param stat
+   * @return The data in the ZNode.
+   * @throws Exception If it cannot contact Zookeeper.
+   */
+  public byte[] getData(final String path, Stat stat) throws Exception {
+    return curator.getData().storingStatIn(stat).forPath(path);
+  }
+
+  /**
+   * Get the data in a ZNode.
+   * @param path Path of the ZNode.
+   * @return The data in the ZNode.
+   * @throws Exception If it cannot contact Zookeeper.
+   */
+  public String getStringData(final String path) throws Exception {
+    byte[] bytes = getData(path);
+    return new String(bytes, Charset.forName("UTF-8"));
+  }
+
+  /**
+   * Get the data in a ZNode.
+   * @param path Path of the ZNode.
-  public String getSringData(final String path) throws Exception {
-    byte[] bytes = getData(path);
+  public String getStringData(final String path, Stat stat) throws Exception {
+    byte[] bytes = getData(path, stat);
+   * Utility function to ensure that the configured base znode exists.
+   * This recursively creates the znode as well as all of its parents.
+   * @param path Path of the znode to create.
+   * @throws Exception If it cannot create the file.
+   */
+  public void createRootDirRecursively(String path) throws Exception {
+    String[] pathParts = path.split("/");
+    Preconditions.checkArgument(
+        pathParts.length >= 1 && pathParts[0].isEmpty(),
+        "Invalid path: %s", path);
+    StringBuilder sb = new StringBuilder();
+
+    for (int i = 1; i < pathParts.length; i++) {
+      sb.append("/").append(pathParts[i]);
+      create(sb.toString());
+    }
+  }
+
+  /**
+   * @return If the znode was deleted.
-  public void delete(final String path) throws Exception {
+  public boolean delete(final String path) throws Exception {
+      return true;
+    return false;

INS26 INS26 INS40 INS40 INS31 INS31 INS31 INS29 INS83 INS5 INS42 INS44 INS44 INS43 INS8 INS29 UPD42 MOV29 INS83 INS43 INS42 INS44 INS44 INS43 INS8 INS29 INS83 INS39 INS42 INS44 INS43 INS8 UPD39 INS65 INS65 INS65 INS65 INS65 INS39 INS85 INS83 INS43 INS42 INS43 INS42 INS42 INS41 INS65 INS65 INS65 INS65 INS42 INS83 INS43 INS42 INS43 INS42 INS42 INS60 INS41 INS65 INS65 INS65 INS43 INS42 INS42 INS60 INS21 INS60 INS24 INS65 INS41 INS66 INS42 INS66 INS42 INS66 INS42 INS66 INS42 INS42 INS32 INS66 INS42 INS66 INS66 INS42 INS66 INS42 INS42 INS5 INS59 INS14 INS66 INS66 INS42 INS66 INS42 INS66 INS42 INS5 INS59 INS32 INS43 INS59 INS58 INS27 INS37 INS8 INS66 INS9 INS32 INS42 INS42 INS39 INS85 INS42 INS32 INS43 INS42 INS32 INS43 INS85 INS42 INS32 INS42 INS42 INS27 INS45 INS42 INS42 INS42 INS14 INS39 INS59 INS42 INS40 INS42 INS21 INS21 INS41 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS45 INS42 INS42 INS42 INS45 INS27 INS32 INS43 INS42 INS34 INS32 INS32 INS9 INS42 INS42 INS40 INS34 INS2 INS42 INS42 INS32 INS42 INS2 INS42 INS32 INS42 INS34 INS42 INS42 INS45 INS42 INS42 INS42 INS42 DEL42 DEL66 DEL65