HDFS-5394: Fix race conditions in DN caching and uncaching (cmccabe)

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1539909 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.io.nativeio.NativeIO;
-   *
-   * There isn't any portable way to unmap a memory region in Java.
-   * So we use the sun.nio method here.
-   * Note that unmapping a memory region could cause crashes if code
-   * continues to reference the unmapped code.  However, if we don't
-   * manually unmap the memory, we are dependent on the finalizer to
-   * do it, and we have no idea when the finalizer will run.
-    if (map instanceof sun.nio.ch.DirectBuffer) {
-      final sun.misc.Cleaner cleaner =
-          ((sun.nio.ch.DirectBuffer) map).cleaner();
-      cleaner.clean();
-    }
+    NativeIO.POSIX.munmap(map);

INS26 INS40 INS8 MOV6 INS21 INS32 INS40 INS42 UPD42 MOV42 DEL66 DEL66 DEL66 DEL66 DEL66 DEL66 DEL42 DEL40 DEL43 DEL62 DEL83 DEL40 DEL43 DEL42 DEL40 DEL43 DEL42 DEL11 DEL36 DEL32 DEL59 DEL60 DEL42 DEL42 DEL32 DEL21 DEL8 DEL25 DEL8