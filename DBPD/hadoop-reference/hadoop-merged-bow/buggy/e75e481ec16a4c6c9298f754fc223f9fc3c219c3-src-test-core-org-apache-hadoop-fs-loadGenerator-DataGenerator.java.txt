HADOOP-7054 Change NN LoadGenerator to use FileContext APIs (Sanjay Radia)


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1043117 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.EnumSet;
+import org.apache.hadoop.fs.CreateFlag;
-import org.apache.hadoop.fs.FileSystem;
+import org.apache.hadoop.fs.FileContext;
+import org.apache.hadoop.fs.Options.CreateOpts;
-  private FileSystem fs;
+  private FileContext fc;
-      fs = FileSystem.get(getConf());
+      fc = FileContext.getFileContext(getConf());
-      fs.mkdirs(new Path(root+line));
+      fc.mkdir(new Path(root+line), FileContext.DEFAULT_PERM, true);
-    FSDataOutputStream out = fs.create(file, true, 
-        getConf().getInt("io.file.buffer.size", 4096),
-        (short)getConf().getInt("dfs.replication", 3),
-        fs.getDefaultBlockSize());
+    FSDataOutputStream out = fc.create(file, EnumSet.of(CreateFlag.OVERWRITE),
+        CreateOpts.createParent(), CreateOpts.bufferSize(4096),
+        CreateOpts.repFac((short) 3));

INS26 INS26 INS26 INS40 INS40 UPD40 INS40 UPD43 UPD42 UPD42 UPD42 MOV32 INS32 INS32 UPD42 UPD42 UPD42 INS40 INS9 INS42 UPD42 INS40 INS42 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 UPD34 MOV34 UPD42 UPD42 INS11 UPD42 UPD42 INS39 INS34 DEL9 DEL45 DEL34 DEL32 DEL39 DEL32 DEL45 DEL32 DEL11