HADOOP-14445. Use DelegationTokenIssuer to create KMS delegation tokens that can authenticate to all KMS instances.
Contributed by Daryn Sharp, Xiao Chen, Rushabh S Shah.

-import org.apache.hadoop.security.Credentials;
+import org.apache.hadoop.security.token.org.apache.hadoop.security.token.DelegationTokenIssuer;
+  public DelegationTokenIssuer[] getAdditionalTokenIssuers()
+      throws IOException {
+    KeyProvider keyProvider = getKeyProvider();
+    if (keyProvider instanceof DelegationTokenIssuer) {
+      return new DelegationTokenIssuer[] {(DelegationTokenIssuer) keyProvider};
+    }
+    return null;
+  }
+
+  @Override
-  @Override
-  public Token<?>[] addDelegationTokens(String renewer,
-      Credentials credentials) throws IOException {
-    Token<?>[] tokens = super.addDelegationTokens(renewer, credentials);
-    return HdfsKMSUtil.addDelegationTokensForKeyProvider(this, renewer,
-        credentials, getUri(), tokens);
-  }
-

MOV26 MOV31 UPD40 UPD5 UPD42 INS8 INS43 INS60 INS25 INS41 UPD42 MOV42 INS43 INS59 INS62 INS8 INS33 UPD42 MOV42 INS42 INS32 INS42 INS43 INS41 INS42 UPD42 MOV42 INS3 INS5 INS4 INS43 MOV85 INS11 UPD42 MOV42 INS43 INS42 INS42 DEL43 DEL76 DEL74 DEL43 DEL42 DEL44 DEL43 DEL42 DEL44 DEL43 DEL76 DEL74 DEL5 DEL42 DEL42 DEL42 DEL42 DEL48 DEL59 DEL60 DEL42 DEL42 DEL52 DEL42 DEL42 DEL42 DEL32 DEL42 DEL32 DEL41 DEL8