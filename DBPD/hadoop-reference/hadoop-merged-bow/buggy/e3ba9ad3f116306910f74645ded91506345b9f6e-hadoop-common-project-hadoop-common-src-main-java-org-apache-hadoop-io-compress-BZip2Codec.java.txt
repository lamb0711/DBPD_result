HADOOP-13270. BZip2CompressionInputStream finds the same compression marker twice in corner case, causing duplicate data blocks. Contributed by Kai Sasaki.

-    long adjStart = Math.max(0L, start - FIRST_BZIP2_BLOCK_MARKER_POSITION);
+    long adjStart = 0L;
+    if (start != 0) {
+      // Other than the first of file, the marker size is 6 bytes.
+      adjStart = Math.max(0L, start - (FIRST_BZIP2_BLOCK_MARKER_POSITION
+          - (HEADER_LEN + SUB_HEADER_LEN)));
+    }

INS60 INS25 MOV39 INS59 INS27 INS8 MOV42 INS34 INS42 INS34 INS21 INS7 INS42 INS32 MOV42 MOV42 MOV34 MOV27 INS36 INS27 MOV42 INS36 INS27 INS42 INS42 DEL32 DEL59 DEL60