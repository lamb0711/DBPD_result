HADOOP-10758. KMS: add ACLs on per key basis. (tucu)

-  private static KMSACLs acls;
+  private static KMSACLs kmsAcls;
-      acls = new KMSACLs();
-      acls.startReloader();
+      kmsAcls = new KMSACLs();
+      kmsAcls.startReloader();
+      if (kmsConf.getBoolean(KMSConfiguration.KEY_AUTHORIZATION_ENABLE,
+          KMSConfiguration.KEY_AUTHORIZATION_ENABLE_DEFAULT)) {
+        keyProviderCryptoExtension =
+            new KeyAuthorizationKeyProvider(
+                keyProviderCryptoExtension, kmsAcls);
+      }
+        
-    acls.stopReloader();
+    kmsAcls.stopReloader();
-    return acls;
+    return kmsAcls;

UPD42 UPD42 INS25 UPD42 INS32 INS8 UPD42 UPD42 INS42 INS42 INS40 INS40 INS21 INS7 INS42 INS14 INS43 INS42 INS42 INS42