   HADOOP-4656. Add a user to groups mapping service (boryas and acmurthy_)


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@892066 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.security.UserGroupInformation;
-      // Create the user subject
-      user = SecurityUtil.getSubject(header.getUgi());
+      // Create the user subject; however use the groups as defined on the
+      // server-side, don't trust the user groups provided by the client
+      UserGroupInformation ugi = header.getUgi();
+      user = null;
+      if(ugi != null) {
+        user = SecurityUtil.getSubject(conf, header.getUgi().getUserName());
+      }
-      Writable param = ReflectionUtils.newInstance(paramClass, conf);           // read param
+      Writable param = ReflectionUtils.newInstance(paramClass, conf);//read param

INS26 INS40 INS60 INS21 INS25 INS43 INS59 INS7 INS27 INS8 INS42 INS42 MOV32 INS42 INS33 INS42 INS33 MOV21 INS42 INS32 INS32 INS42 INS42 INS42