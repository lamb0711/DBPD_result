YARN-1461. Added tags for YARN applications and changed RM to handle them. Contributed by Karthik Kambatla.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1564633 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.yarn.api.protocolrecords.ApplicationsRequestScope;
+    Set<String> tags = request.getApplicationTags();
+    ApplicationsRequestScope scope = request.getScope();
+
+      // Check if current application falls under the specified scope
+      boolean allowAccess = checkAccess(callerUGI, application.getUser(),
+          ApplicationAccessType.VIEW_APP, application);
+      if (scope == ApplicationsRequestScope.OWN &&
+          !callerUGI.getUserName().equals(application.getUser())) {
+        continue;
+      } else if (scope == ApplicationsRequestScope.VIEWABLE && !allowAccess) {
+        continue;
+      }
+
-      boolean allowAccess = checkAccess(callerUGI, application.getUser(),
-          ApplicationAccessType.VIEW_APP, application);
+      if (tags != null && !tags.isEmpty()) {
+        Set<String> appTags = application.getApplicationTags();
+        if (appTags == null || appTags.isEmpty()) {
+          continue;
+        }
+        boolean match = false;
+        for (String tag : tags) {
+          if (appTags.contains(tag)) {
+            match = true;
+            break;
+          }
+        }
+        if (!match) {
+          continue;
+        }
+      }
+

INS26 INS40 INS60 INS60 INS74 INS59 INS43 INS59 MOV60 INS43 INS43 INS42 INS32 INS42 INS42 INS32 INS25 INS25 INS42 INS42 INS42 INS42 INS42 INS42 INS27 INS8 INS25 INS27 INS8 INS27 INS38 INS18 INS27 INS8 INS27 INS38 INS60 INS25 INS60 INS70 INS25 INS42 INS40 INS32 INS27 INS38 INS18 INS42 INS33 INS32 INS74 INS59 INS27 INS8 INS39 INS59 INS44 INS42 INS8 INS38 INS8 INS32 INS42 INS32 INS42 INS40 INS42 INS42 INS42 INS43 INS43 INS42 INS32 INS27 INS32 INS18 INS42 INS9 INS43 INS42 INS25 INS42 INS18 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS33 INS42 INS42 INS42 INS32 INS8 INS42 INS42 INS42 INS21 INS10 INS7 INS42 INS9