YARN-6840. Implement zookeeper based store for scheduler configuration updates. (Jonathan Hung via wangda)

Change-Id: I9debea674fe8c7e4109d4ca136965a1ea4c48bcc

-import org.apache.hadoop.yarn.exceptions.YarnException;
-import java.io.IOException;
-
-   * Apply transactions which were not committed.
-   * @throws IOException if recovery fails
+   * Get the acl mutation policy for this configuration provider.
+   * @return The acl mutation policy.
-  void recoverConf() throws IOException;
+  ConfigurationMutationACLPolicy getAclMutationPolicy();
-   * Update the scheduler configuration with the provided key value pairs.
-   * @param user User issuing the request
-   * @param confUpdate Key-value pairs for configurations to be updated.
-   * @throws IOException if scheduler could not be reinitialized
-   * @throws YarnException if reservation system could not be reinitialized
+   * Called when a new ResourceManager is starting/becomes active. Ensures
+   * configuration is up-to-date.
+   * @throws Exception if configuration could not be refreshed from store
-  void mutateConfiguration(UserGroupInformation user, SchedConfUpdateInfo
-      confUpdate) throws IOException, YarnException;
+  void reloadConfigurationFromStore() throws Exception;
+  /**
+   * Log user's requested configuration mutation, and applies it in-memory.
+   * @param user User who requested the change
+   * @param confUpdate User's requested configuration change
+   * @throws Exception if logging the mutation fails
+   */
+  void logAndApplyMutation(UserGroupInformation user, SchedConfUpdateInfo
+      confUpdate) throws Exception;
+
+  /**
+   * Confirm last logged mutation.
+   * @param isValid if the last logged mutation is applied to scheduler
+   *                properly.
+   * @throws Exception if confirming mutation fails
+   */
+  void confirmPendingMutation(boolean isValid) throws Exception;

INS31 INS31 INS31 INS29 INS43 INS42 UPD42 UPD43 INS29 INS39 INS42 MOV44 MOV44 INS43 INS29 MOV39 UPD42 MOV42 INS44 UPD43 MOV43 INS65 INS65 INS42 UPD42 MOV65 MOV65 MOV65 MOV65 INS42 INS65 INS65 MOV65 INS39 INS42 UPD42 INS66 INS66 INS66 UPD66 UPD42 UPD66 UPD66 UPD66 UPD66 UPD42 UPD66 INS66 INS42 INS66 INS66 UPD42 UPD66 DEL40 DEL26 DEL40 DEL26 DEL29 DEL42 DEL43 DEL31