HADOOP-13227. AsyncCallHandler should use an event driven architecture to handle async calls.

+  private static final ThreadLocal<Object> EXTERNAL_CALL_HANDLER
+      = new ThreadLocal<>();
-  public static void setCallIdAndRetryCount(int cid, int rc) {
+  public static void setCallIdAndRetryCount(int cid, int rc,
+                                            Object externalHandler) {
+    EXTERNAL_CALL_HANDLER.set(externalHandler);
+    private final Object externalHandler;
+
+      this.externalHandler = EXTERNAL_CALL_HANDLER.get();
+
+      if (externalHandler != null) {
+        synchronized (externalHandler) {
+          externalHandler.notify();
+        }
+      }

INS23 INS83 INS83 INS83 INS74 INS59 INS44 INS23 INS43 INS43 INS42 INS14 INS43 INS42 INS21 INS83 INS83 INS43 INS59 INS42 INS42 INS74 INS42 INS32 INS42 INS42 INS21 INS25 INS43 INS42 INS42 INS42 INS7 INS27 INS8 INS42 INS22 INS32 INS42 INS33 INS51 INS52 INS42 INS42 INS42 INS42 INS8 INS21 INS32 INS42 INS42