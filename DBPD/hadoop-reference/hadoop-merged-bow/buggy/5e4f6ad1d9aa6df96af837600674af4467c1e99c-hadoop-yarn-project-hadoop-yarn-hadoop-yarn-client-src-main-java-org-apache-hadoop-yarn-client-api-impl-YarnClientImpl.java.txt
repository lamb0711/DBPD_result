YARN-791. Changed RM APIs and web-services related to nodes to ensure that both are consistent with each other. Contributed by Sandy Ryza.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1500994 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.EnumSet;
+import org.apache.hadoop.yarn.api.records.NodeState;
-  public List<NodeReport> getNodeReports() throws YarnException,
+  public List<NodeReport> getNodeReports(NodeState... states) throws YarnException,
-    GetClusterNodesRequest request =
-        Records.newRecord(GetClusterNodesRequest.class);
+    EnumSet<NodeState> statesSet = (states.length == 0) ?
+        EnumSet.allOf(NodeState.class) : EnumSet.noneOf(NodeState.class);
+    for (NodeState state : states) {
+      statesSet.add(state);
+    }
+    GetClusterNodesRequest request = GetClusterNodesRequest
+        .newInstance(statesSet);

INS26 INS26 INS40 INS40 INS44 INS43 INS42 INS70 INS60 INS42 INS74 INS44 INS42 INS8 MOV43 INS59 INS43 INS43 INS42 INS16 INS43 INS42 INS21 INS42 INS32 INS42 UPD42 MOV42 INS36 INS32 INS32 INS42 INS32 INS42 INS42 INS42 INS27 INS42 INS42 INS57 UPD42 MOV42 UPD42 MOV42 MOV57 INS42 INS42 INS42 INS40 INS34 INS43 INS43 INS42 INS42 DEL43 DEL42 DEL32