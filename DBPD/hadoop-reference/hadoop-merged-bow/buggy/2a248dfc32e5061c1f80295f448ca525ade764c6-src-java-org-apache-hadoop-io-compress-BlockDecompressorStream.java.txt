HADOOP-6835. Add support for concatenated gzip input. Contributed by Greg Roelofs


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@961532 13f79535-47bb-0310-9956-ffa450edef68

- * @throws IOException
+   * @throws IOException
-  
+
- * @throws IOException
+   * @throws IOException
-    
+
-        getCompressedData();
+        int m = getCompressedData();
+        // Send the read data to the decompressor
+        decompressor.setInput(buffer, 0, m);
-    
+
-  protected void getCompressedData() throws IOException {
+  protected int getCompressedData() throws IOException {
-    // Get the size of the compressed chunk
+    // Get the size of the compressed chunk (always non-negative)
-        throw new EOFException();
+        throw new EOFException("Unexpected end of block in input stream");
-    
-    // Send the read data to the decompressor
-    decompressor.setInput(buffer, 0, len);
+
+    return len;

UPD39 INS41 INS42 INS60 INS39 INS59 INS32 INS42 MOV32 INS42 INS42 INS42 INS34 INS42 INS45 DEL42 DEL42 DEL42 DEL34 DEL42 DEL32 DEL21