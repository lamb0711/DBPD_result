HADOOP-11017. Addendum to fix RM HA. KMS delegation token secret manager should be able to use zookeeper as store. (Arun Suresh via kasha)

-   * should be called before activate().
+   * should be called before activate(). 
-    storeDelegationKey(key);
+    allKeys.put(key.getKeyId(), key);
+   * This method must be called before this secret manager is activated (before
+   * startThreads() is called)
-    DelegationKey dKey = getDelegationKey(keyId);
+    DelegationKey dKey = allKeys.get(keyId);
-    int delegationTokenSeqNum = getDelegationTokenSeqNum();
-    if (identifier.getSequenceNumber() > delegationTokenSeqNum) {
-      setDelegationTokenSeqNum(identifier.getSequenceNumber());
+    if (identifier.getSequenceNumber() > delegationTokenSequenceNumber) {
+      delegationTokenSequenceNumber = identifier.getSequenceNumber();
-      storeToken(identifier, new DelegationTokenInformation(renewDate,
+      currentTokens.put(identifier, new DelegationTokenInformation(renewDate,
-    storeNewMasterKey(newKey);

UPD66 INS66 INS66 INS42 INS42 INS32 UPD42 UPD42 MOV42 INS42 INS42 UPD42 INS7 INS42 MOV32 UPD42 INS42 DEL39 DEL42 DEL42 DEL32 DEL59 DEL60 DEL42 DEL32 DEL42 DEL42 DEL32 DEL21