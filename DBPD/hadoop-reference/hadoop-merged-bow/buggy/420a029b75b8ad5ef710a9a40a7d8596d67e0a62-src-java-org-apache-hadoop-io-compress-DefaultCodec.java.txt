HADOOP-6754. DefaultCodec.createOutputStream() leaks memory. Contributed by Aaron Kimball.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1076314 13f79535-47bb-0310-9956-ffa450edef68

-import java.io.OutputStream;
+import java.io.OutputStream;
+import org.apache.commons.logging.Log;
+import org.apache.commons.logging.LogFactory;
-import org.apache.hadoop.io.compress.zlib.*;
+import org.apache.hadoop.io.compress.zlib.ZlibFactory;
+  private static final Log LOG = LogFactory.getLog(DefaultCodec.class);
+    // This may leak memory if called in a loop. The createCompressor() call
+    // may cause allocation of an untracked direct-backed buffer if native
+    // libs are being used (even if you close the stream).  A Compressor
+    // object should be reused between successive calls.
+    LOG.warn("DefaultCodec.createOutputStream() may leak memory. "
+        + "Create a compressor first.");

MOV26 INS26 INS26 INS40 INS40 UPD40 INS23 INS83 INS83 INS83 INS43 INS59 INS42 INS42 INS32 INS21 INS42 INS42 INS57 INS32 INS43 INS42 INS42 INS27 INS42 INS45 INS45