HADOOP-12045. Enable LocalFileSystem#setTimes to change atime. Contributed by Kazuho Fujii.

+import java.nio.file.Files;
+import java.nio.file.attribute.BasicFileAttributes;
+import java.nio.file.attribute.BasicFileAttributeView;
+import java.nio.file.attribute.FileTime;
-    DeprecatedRawLocalFileStatus(File f, long defaultBlockSize, FileSystem fs) {
+    DeprecatedRawLocalFileStatus(File f, long defaultBlockSize, FileSystem fs)
+      throws IOException {
-          f.lastModified(), new Path(f.getPath()).makeQualified(fs.getUri(),
+          f.lastModified(),
+          Files.readAttributes(f.toPath(),
+            BasicFileAttributes.class).lastAccessTime().toMillis(),
+          null, null, null,
+          new Path(f.getPath()).makeQualified(fs.getUri(),
-   * Sets the {@link Path}'s last modified time <em>only</em> to the given
-   * valid time.
+   * Sets the {@link Path}'s last modified time and last access time to
+   * the given valid times.
-   * @param atime currently ignored.
-   * @throws IOException if setting the last modified time fails.
+   * @param atime the access time to set (only if greater than zero).
+   * @throws IOException if setting the times fails.
-    File f = pathToFile(p);
-    if(mtime >= 0) {
-      if(!f.setLastModified(mtime)) {
-        throw new IOException(
-          "couldn't set last-modified time to " +
-          mtime +
-          " for " +
-          f.getAbsolutePath());
-      }
-    }
+    BasicFileAttributeView view = Files.getFileAttributeView(
+        pathToFile(p).toPath(), BasicFileAttributeView.class);
+    FileTime fmtime = (mtime >= 0) ? FileTime.fromMillis(mtime) : null;
+    FileTime fatime = (atime >= 0) ? FileTime.fromMillis(atime) : null;
+    view.setTimes(fmtime, fatime, null);

INS26 INS26 INS26 INS26 INS40 INS40 INS40 INS40 MOV43 INS60 INS60 INS21 INS42 UPD66 UPD66 UPD66 UPD66 UPD43 INS43 INS59 INS43 INS59 INS32 INS32 INS33 INS33 INS33 UPD42 UPD42 INS32 INS42 INS42 INS16 UPD42 MOV42 INS42 INS16 INS42 INS42 UPD42 MOV42 UPD42 MOV42 INS33 INS32 INS42 INS42 INS42 INS32 INS57 INS36 INS32 INS33 INS36 INS32 INS33 INS32 INS42 MOV32 INS42 INS43 MOV27 UPD42 MOV42 UPD42 MOV42 MOV42 INS27 INS42 INS42 INS42 INS42 INS42 INS32 INS57 INS42 UPD42 MOV42 INS34 INS42 INS42 INS43 INS42 DEL32 DEL38 DEL45 DEL45 DEL32 DEL27 DEL14 DEL53 DEL8 DEL25 DEL8 DEL25