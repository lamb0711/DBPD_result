HADOOP-15583. Stabilize S3A Assumed Role support.
Contributed by Steve Loughran.

-import org.apache.hadoop.fs.s3a.DefaultS3ClientFactory;
+import org.apache.hadoop.fs.s3a.S3AUtils;
-import static org.apache.hadoop.fs.s3a.S3AUtils.createAWSCredentialProviderSet;
+   * @param bucket Optional bucket to use to look up per-bucket proxy secrets
+   * @param credentials credentials to use for authentication.
-  AmazonDynamoDB createDynamoDBClient(String defaultRegion) throws IOException;
+  AmazonDynamoDB createDynamoDBClient(final String defaultRegion,
+      final String bucket,
+      final AWSCredentialsProvider credentials) throws IOException;
-    public AmazonDynamoDB createDynamoDBClient(String defaultRegion)
+    public AmazonDynamoDB createDynamoDBClient(String defaultRegion,
+        final String bucket,
+        final AWSCredentialsProvider credentials)
-      final AWSCredentialsProvider credentials =
-          createAWSCredentialProviderSet(null, conf);
-      final ClientConfiguration awsConf =
-          DefaultS3ClientFactory.createAwsConf(conf);
+      final ClientConfiguration awsConf = S3AUtils.createAwsConf(conf, bucket);

MOV26 UPD40 INS44 INS44 INS65 INS65 INS83 INS83 INS43 INS42 INS83 INS43 INS42 INS44 INS44 INS42 INS66 INS42 INS66 INS42 INS42 INS83 INS43 INS42 INS83 MOV43 INS42 INS42 UPD42 INS42 DEL40 DEL26 DEL83 DEL42 DEL42 DEL33 DEL42 DEL32 DEL59 DEL60