HADOOP-7328. When a serializer class is missing, return null, not throw an NPE. Contributed by Harsh J Chouraria.

git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1167363 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.fs.CommonConfigurationKeys;
-import org.apache.hadoop.util.StringUtils;
-   * classnames. 
+   * classnames.
-    for (String serializerName : conf.getStrings("io.serializations", 
-      new String[]{WritableSerialization.class.getName(), 
-        AvroSpecificSerialization.class.getName(), 
+    for (String serializerName : conf.getStrings(
+      CommonConfigurationKeys.IO_SERIALIZATIONS_KEY,
+      new String[]{WritableSerialization.class.getName(),
+        AvroSpecificSerialization.class.getName(),
-	(Class<? extends Serialization>) conf.getClassByName(serializationName);
+        (Class<? extends Serialization>) conf.getClassByName(serializationName);
-	  ReflectionUtils.newInstance(serializionClass, getConf()));
+      ReflectionUtils.newInstance(serializionClass, getConf()));
-    return getSerialization(c).getSerializer(c);
+    Serialization<T> serializer = getSerialization(c);
+    if (serializer != null) {
+      return serializer.getSerializer(c);
+    }
+    return null;
-    return getSerialization(c).getDeserializer(c);
+    Serialization<T> serializer = getSerialization(c);
+    if (serializer != null) {
+      return serializer.getDeserializer(c);
+    }
+    return null;
-	return (Serialization<T>) serialization;
+        return (Serialization<T>) serialization;

MOV26 UPD40 INS8 INS8 INS60 INS25 INS41 INS60 INS25 INS41 UPD66 INS74 INS59 INS27 INS8 INS33 INS74 INS59 INS27 INS8 INS33 INS40 INS43 INS43 INS42 MOV32 INS42 INS33 MOV41 INS43 INS43 INS42 MOV32 INS42 INS33 MOV41 INS42 INS42 INS42 INS42 INS42 INS42 DEL45 DEL8 DEL8