 MAPREDUCE-901. Efficient framework counters. Contributed by Luke Lu.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1157290 13f79535-47bb-0310-9956-ffa450edef68

-  private boolean includeCounters;
+  private boolean includeAllCounters;
-    this.includeCounters = true;
+    this.includeAllCounters = true;
-  public boolean getIncludeCounters() {
-    return includeCounters; 
+  public boolean getIncludeAllCounters() {
+    return includeAllCounters;
-  public void setIncludeCounters(boolean send) {
-    includeCounters = send;
+  public void setIncludeAllCounters(boolean send) {
+    includeAllCounters = send;
+    counters.setWriteAllCounters(send);
-    out.writeBoolean(includeCounters);
+    out.writeBoolean(includeAllCounters);
-    if (includeCounters) {
-      counters.write(out);
-    }
+    counters.write(out);
-    this.includeCounters = in.readBoolean();
+    this.includeAllCounters = in.readBoolean();
-    if (includeCounters) {
-      counters.readFields(in);
-    }
+    counters.readFields(in);

UPD42 UPD42 UPD42 INS21 MOV21 MOV21 UPD42 INS32 UPD42 INS42 INS42 INS42 UPD42 UPD42 UPD42 DEL42 DEL8 DEL25 DEL42 DEL8 DEL25