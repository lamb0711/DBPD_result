HADOOP-9374. Add tokens from -tokenCacheFile into UGI (daryn)


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1454019 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.hadoop.security.Credentials;
+import org.apache.hadoop.security.UserGroupInformation;
-      Path p = new Path(fileName);
+      Path p = localFs.makeQualified(new Path(fileName));
-      conf.set("mapreduce.job.credentials.json", localFs.makeQualified(p)
-          .toString(), "from -tokenCacheFile command line option");
+      UserGroupInformation.getCurrentUser().addCredentials(
+          Credentials.readTokenStorageFile(p, conf));
+      conf.set("mapreduce.job.credentials.json", p.toString(),
+               "from -tokenCacheFile command line option");

INS26 INS26 INS40 INS40 INS21 INS32 INS32 INS32 INS42 INS32 INS42 INS42 MOV14 INS42 INS42 INS42 INS42 INS42 INS42 MOV42 DEL42 DEL42 DEL32