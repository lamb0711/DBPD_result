MAPREDUCE-3614. Fixed MR AM to close history file quickly and send a correct final state to the RM when it is killed. Contributed by Ravi Prakash.


git-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1296747 13f79535-47bb-0310-9956-ffa450edef68

+  // Has a signal (SIGTERM etc) been issued?
+  protected volatile boolean isSignalled = false;
-      } else if (job.getState() == JobState.KILLED) {
+      } else if (job.getState() == JobState.KILLED
+          || (job.getState() == JobState.RUNNING && isSignalled)) {
+
+  public void setSignalled(boolean isSignalled) {
+    this.isSignalled = isSignalled;
+    LOG.info("RMCommunicator notified that iSignalled was : " + isSignalled);
+  }

INS23 INS31 INS83 INS83 INS39 INS59 INS83 INS39 INS42 INS44 INS8 INS42 INS9 INS39 INS42 INS21 INS21 INS7 INS32 INS22 INS42 INS42 INS42 INS27 INS52 INS42 INS45 INS42 INS27 MOV27 INS36 INS27 INS27 INS42 INS32 INS40 INS42 INS42