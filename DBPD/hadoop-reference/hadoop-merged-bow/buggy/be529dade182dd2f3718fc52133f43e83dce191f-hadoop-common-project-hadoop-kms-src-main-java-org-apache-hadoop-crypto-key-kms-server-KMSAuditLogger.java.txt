HADOOP-13903. Improvements to KMS logging to help debug authorization errors. (Tristan Stevens via asuresh)

+import org.apache.hadoop.crypto.key.kms.server.KMSACLs.Type;
-    private final KMS.KMSOp op;
+    private final Object op;
-    AuditEvent(KMS.KMSOp op, UserGroupInformation ugi, String keyName,
+    /**
+     * @param op
+     *          The operation being audited (either {@link KMS.KMSOp} or
+     *          {@link Type} N.B this is passed as an {@link Object} to allow
+     *          either enum to be passed in.
+     * @param ugi
+     *          The user's security context
+     * @param keyName
+     *          The String name of the key if applicable
+     * @param remoteHost
+     *          The hostname of the requesting service
+     * @param msg
+     *          Any extra details for auditing
+     */
+    AuditEvent(Object op, UserGroupInformation ugi, String keyName,
-    public KMS.KMSOp getOp() {
+    public Object getOp() {

INS26 INS40 UPD43 INS29 UPD43 INS42 INS65 INS65 INS65 INS65 INS65 UPD43 INS42 INS42 INS66 INS65 INS66 INS65 INS66 INS65 INS66 INS66 INS42 INS66 INS42 INS66 INS42 INS66 INS42 INS66 INS42 INS40 INS42 INS42 DEL40 DEL40 DEL40