HADOOP-3733. "s3x:" URLs break when Secret Key contains a slash, even if encoded. Contributed by Steve Loughran.

+import org.apache.hadoop.fs.s3native.S3xLoginHelper;
-    
-    String userInfo = uri.getUserInfo();
-    if (userInfo != null) {
-      int index = userInfo.indexOf(':');
-      if (index != -1) {
-        accessKey = userInfo.substring(0, index);
-        secretAccessKey = userInfo.substring(index + 1);
-      } else {
-        accessKey = userInfo;
-      }
+    S3xLoginHelper.Login login =
+        S3xLoginHelper.extractLoginDetailsWithWarnings(uri);
+    if (login.hasLogin()) {
+      accessKey = login.getUser();
+      secretAccessKey = login.getPassword();
-    
-                                         "Key must be specified as the " +
-                                         "username or password " +
-                                         "(respectively) of a " + scheme +
-                                         " URL, or by setting the " +
-                                         accessKeyProperty + " or " +
+                                         "Key must be specified " +
+                                         "by setting the " +
+                                         accessKeyProperty + " and " +
-                                         "as the username of a " + scheme +
-                                         " URL, or by setting the " +
+                                         "by setting the " +
-                                         "specified as the password of a " +
-                                         scheme + " URL, or by setting the " +
+                                         "specified by setting the " +

INS26 INS40 UPD43 INS32 MOV8 INS40 UPD42 UPD42 MOV42 UPD42 MOV42 INS42 INS42 MOV43 UPD42 UPD42 UPD42 UPD42 UPD45 MOV43 UPD45 UPD45 MOV43 UPD45 UPD45 DEL42 DEL42 DEL34 DEL42 DEL42 DEL34 DEL27 DEL42 DEL33 DEL27 DEL39 DEL42 DEL13 DEL32 DEL59 DEL60 DEL42 DEL34 DEL38 DEL27 DEL42 DEL42 DEL7 DEL21 DEL8 DEL25 DEL8 DEL45 DEL42 DEL45 DEL42 DEL45 DEL42 DEL45