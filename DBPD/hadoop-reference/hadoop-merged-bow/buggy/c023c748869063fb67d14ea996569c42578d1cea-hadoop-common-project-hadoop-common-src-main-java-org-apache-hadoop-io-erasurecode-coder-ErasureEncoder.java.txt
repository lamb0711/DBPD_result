HADOOP-13061. Refactor erasure coders. Contributed by Kai Sasaki

+import org.apache.hadoop.conf.Configured;
-import org.apache.hadoop.io.erasurecode.ECSchema;
+import org.apache.hadoop.io.erasurecode.ErasureCoderOptions;
-public abstract class AbstractErasureEncoder extends AbstractErasureCoder {
+public abstract class ErasureEncoder extends Configured
+    implements ErasureCoder {
-  public AbstractErasureEncoder(int numDataUnits, int numParityUnits) {
-    super(numDataUnits, numParityUnits);
-  }
+  private final int numDataUnits;
+  private final int numParityUnits;
+  private final ErasureCoderOptions options;
-  public AbstractErasureEncoder(ECSchema schema) {
-    super(schema);
+  public ErasureEncoder(ErasureCoderOptions options) {
+    this.options = options;
+    this.numDataUnits = options.getNumDataUnits();
+    this.numParityUnits = options.getNumParityUnits();
+  @Override
+  public int getNumDataUnits() {
+    return numDataUnits;
+  }
+
+  @Override
+  public int getNumParityUnits() {
+    return numParityUnits;
+  }
+
+  @Override
+  public ErasureCoderOptions getOptions() {
+    return options;
+  }
+
+  protected ECBlock[] getInputBlocks(ECBlockGroup blockGroup) {
+    return blockGroup.getDataBlocks();
+  }
+
+  protected ECBlock[] getOutputBlocks(ECBlockGroup blockGroup) {
+    return blockGroup.getParityBlocks();
+  }
+
+  @Override
+  public boolean preferDirectBuffer() {
+    return false;
+  }
+
+  @Override
+  public void release() {
+    // Nothing to do by default
+  }
+
-
-  protected ECBlock[] getInputBlocks(ECBlockGroup blockGroup) {
-    return blockGroup.getDataBlocks();
-  }
-
-  protected ECBlock[] getOutputBlocks(ECBlockGroup blockGroup) {
-    return blockGroup.getParityBlocks();
-  }

INS26 MOV31 MOV31 INS40 UPD40 UPD42 INS43 UPD43 INS23 INS23 INS23 INS31 INS31 INS31 INS31 INS31 INS42 UPD42 INS83 INS83 INS39 INS59 INS83 INS83 INS39 INS59 INS83 INS83 INS43 INS59 MOV83 UPD42 MOV42 INS44 INS8 INS78 INS83 INS39 INS42 INS8 INS78 INS83 INS39 INS42 MOV8 INS78 INS43 INS42 INS78 INS83 INS39 INS42 INS8 INS78 INS83 INS39 INS42 INS8 INS42 INS42 INS42 INS42 INS43 INS42 INS21 INS21 INS21 INS42 INS41 INS42 INS41 INS42 UPD42 MOV42 INS41 INS42 INS41 INS42 INS42 INS7 INS7 INS7 INS42 INS42 INS42 INS9 INS22 INS42 INS22 INS32 INS22 INS32 INS52 INS42 INS52 INS42 INS42 INS42 INS52 INS42 INS42 INS42 DEL39 DEL42 DEL44 DEL39 DEL42 DEL44 DEL31 DEL42 DEL42 DEL46 DEL42 DEL43 DEL42 DEL44 DEL42 DEL46