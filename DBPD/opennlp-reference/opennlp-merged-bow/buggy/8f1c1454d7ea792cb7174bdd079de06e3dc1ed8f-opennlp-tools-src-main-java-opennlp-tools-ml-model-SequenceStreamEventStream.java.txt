OPENNLp-118 Replaced the EventStream with ObjectStream<Event>

git-svn-id: https://svn.apache.org/repos/asf/opennlp/trunk@1567990 13f79535-47bb-0310-9956-ffa450edef68

+import java.io.IOException;
+import java.util.Arrays;
+import java.util.Collections;
+import opennlp.tools.util.ObjectStream;
+
-public class SequenceStreamEventStream implements EventStream {
+public class SequenceStreamEventStream implements ObjectStream<Event> {
-  private Iterator<Sequence> sequenceIterator;
-  int eventIndex = -1;
-  Event[] events;
+  private final SequenceStream sequenceStream;
+  
+  private Iterator<Event> eventIt = Collections.emptyListIterator();
-    this.sequenceIterator = sequenceStream.iterator();
+    this.sequenceStream = sequenceStream;
-  public boolean hasNext() {
-    if (events != null && eventIndex < events.length) {
-      return true;
+  @Override
+  public Event read() throws IOException {
+    
+    if (eventIt.hasNext()) {
+      eventIt.next();
-      if (sequenceIterator.hasNext()) {
-        Sequence s = sequenceIterator.next();
-        eventIndex = 0;
-        events = s.getEvents();
-        return true;
+      Sequence<?> sequence = sequenceStream.read();
+      
+      if (sequence != null) {
+        eventIt = Arrays.asList(sequence.getEvents()).iterator();
-      else {
-        return false;
+      
+      if (eventIt.hasNext()) {
+        return read();
+    
+    return null;
-  public Event next() {
-    return events[eventIndex++];
+  @Override
+  public void reset() throws IOException, UnsupportedOperationException {
+    sequenceStream.reset();
-  public void remove() {
-    throw new UnsupportedOperationException();
+  @Override
+  public void close() throws IOException {
+    sequenceStream.close();
-

INS26 INS26 INS26 INS26 MOV23 INS40 INS40 INS40 INS40 INS74 INS43 INS43 INS83 INS83 INS43 UPD74 INS78 MOV43 UPD42 INS43 INS78 INS39 INS42 INS43 MOV43 INS78 UPD42 INS43 UPD42 MOV42 INS42 INS42 UPD42 UPD43 INS42 INS32 INS42 INS42 INS25 MOV41 INS42 INS42 INS21 INS42 INS42 INS21 UPD42 INS42 INS42 INS32 INS8 MOV8 INS33 INS32 INS32 INS42 INS42 INS42 INS21 INS25 INS25 INS42 INS42 INS42 INS42 UPD42 INS32 INS74 INS27 INS8 INS32 INS8 UPD42 MOV42 UPD42 MOV42 MOV43 INS76 UPD42 INS42 INS33 MOV21 INS42 INS42 MOV41 UPD42 UPD42 INS32 UPD42 INS32 INS42 INS32 INS42 UPD42 MOV42 INS42 INS32 INS42 MOV42 DEL43 DEL39 DEL42 DEL34 DEL38 DEL59 DEL23 DEL85 DEL5 DEL42 DEL42 DEL42 DEL32 DEL39 DEL32 DEL9 DEL42 DEL34 DEL7 DEL21 DEL9 DEL42 DEL33 DEL27 DEL42 DEL40 DEL27 DEL27 DEL9 DEL41 DEL8 DEL32 DEL8 DEL25 DEL8 DEL25 DEL42 DEL42 DEL42 DEL37 DEL2 DEL41 DEL14 DEL53