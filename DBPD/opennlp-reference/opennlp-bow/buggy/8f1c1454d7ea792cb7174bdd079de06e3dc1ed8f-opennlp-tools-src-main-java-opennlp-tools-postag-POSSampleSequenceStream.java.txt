OPENNLp-118 Replaced the EventStream with ObjectStream<Event>

git-svn-id: https://svn.apache.org/repos/asf/opennlp/trunk@1567990 13f79535-47bb-0310-9956-ffa450edef68

-import java.util.ArrayList;
-import java.util.Iterator;
-import java.util.List;
-  private List<POSSample> samples;
+  private ObjectStream<POSSample> psi;
-    samples = new ArrayList<POSSample>();
-    
-    POSSample sample;
-    while((sample = psi.read()) != null) {
-      samples.add(sample);
-    }
-    System.err.println("Got "+samples.size()+" sequences");
+    this.psi = psi;
-  
-  @SuppressWarnings("unchecked")
-  public Iterator<Sequence> iterator() {
-    return new POSSampleSequenceIterator(samples.iterator());
-  }
-
-}
-
-class POSSampleSequenceIterator implements Iterator<Sequence> {
-
-  private Iterator<POSSample> psi;
-  private POSContextGenerator cg;
-  
-  public POSSampleSequenceIterator(Iterator<POSSample> psi) {
-    this.psi = psi;
-    cg = new DefaultPOSContextGenerator(null);
-  }
-  
-  public boolean hasNext() {
-    return psi.hasNext();
-  }
-
-  public Sequence<POSSample> next() {
-    POSSample sample = psi.next();
+  @Override
+  public Sequence read() throws IOException {
-    String sentence[] = sample.getSentence();
-    String tags[] = sample.getTags();
-    Event[] events = new Event[sentence.length];
+    POSSample sample = psi.read();
-    for (int i=0; i < sentence.length; i++) {
-
-      // it is safe to pass the tags as previous tags because
-      // the context generator does not look for non predicted tags
-      String[] context = cg.getContext(i, sentence, tags, null);
-
-      events[i] = new Event(tags[i], context);
+    if (sample != null) {
+      String sentence[] = sample.getSentence();
+      String tags[] = sample.getTags();
+      Event[] events = new Event[sentence.length];
+      
+      for (int i=0; i < sentence.length; i++) {
+  
+        // it is safe to pass the tags as previous tags because
+        // the context generator does not look for non predicted tags
+        String[] context = pcg.getContext(i, sentence, tags, null);
+  
+        events[i] = new Event(tags[i], context);
+      }
+      Sequence<POSSample> sequence = new Sequence<POSSample>(events,sample);
+      return sequence;
-    Sequence<POSSample> sequence = new Sequence<POSSample>(events,sample);
-    return sequence;
-  }
-
-  public void remove() {
-    throw new UnsupportedOperationException();
+    
+    return null;
+  @Override
+  public void reset() throws IOException, UnsupportedOperationException {
+    psi.reset();
+  }
+  
+  @Override
+  public void close() throws IOException {
+    psi.close();
+  }
