OPENNLP-56 Improved mention inserting.

git-svn-id: https://svn.apache.org/repos/asf/opennlp/trunk@1324748 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.Stack;
-import opennlp.tools.lang.english.TreebankLinker;
+  private static boolean containsToken(String token, Parse p) {
+    for (Parse node : p.getTagNodes()) {
+      if (node.toString().equals(token))
+        return true;
+    }
+    return false;
+  }
+  
-          //not sure how to get head index, but its not used at this point.
-          Parse snp = new Parse(p.getText(),extents[ei].getSpan(),"NML",1.0,0);
-          p.insert(snp);
-          extents[ei].setParse(new DefaultParse(snp, corefParse.getSentenceNumber()));
+
+          Stack<Parse> nodes = new Stack<Parse>();
+          nodes.add(p);
+          
+          while (!nodes.isEmpty()) {
+            
+            Parse node = nodes.pop();
+            
+            if (node.getSpan().equals(extents[ei].getSpan()) && node.getType().startsWith("NML")) {
+              DefaultParse corefParseNode = new DefaultParse(node, corefParse.getSentenceNumber());
+              extents[ei].setParse(corefParseNode);
+              extents[ei].setId(corefParseNode.getEntityId());
+              break;
+            }
+            
+            nodes.addAll(Arrays.asList(node.getChildren()));
+          }
-  // TODO: Move this method away ...
+    useTreebank = true; 
+    
