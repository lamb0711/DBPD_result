JCR-92 - Change defaultValues format in NodeTypes XML to jcr value

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@159678 13f79535-47bb-0310-9956-ffa450edef68

+import javax.jcr.RepositoryException;
-    protected void write() {
+    protected void write() throws RepositoryException {
-            def.setValueConstraints(
-                    (ValueConstraint[]) vector.toArray(new ValueConstraint[0]));
+            def.setValueConstraints((ValueConstraint[])
+                    vector.toArray(new ValueConstraint[vector.size()]));
-                values.add(constraints[i].getDefinition());
+                values.add(constraints[i].getDefinition(getNamespaceResolver()));
-    private void readDefaultValues() {
+    private void readDefaultValues() throws InvalidNodeTypeDefException {
-                vector.add(InternalValue.valueOf(defaults[i], type));
+                try {
+                    vector.add(InternalValue.create(defaults[i], type, getNamespaceResolver()));
+                } catch (RepositoryException e) {
+                    throw new InvalidNodeTypeDefException(e);
+                }
-            def.setDefaultValues(
-                    (InternalValue[]) vector.toArray(new InternalValue[0]));
+            def.setDefaultValues((InternalValue[])
+                    vector.toArray(new InternalValue[vector.size()]));
-    private void writeDefaultValues() {
+    private void writeDefaultValues() throws RepositoryException {
-                values.add(defaults[i].toString());
+                values.add(defaults[i].toJCRValue(getNamespaceResolver()).getString());

INS26 INS40 INS43 INS43 INS43 INS42 INS42 INS42 INS8 INS54 MOV5 INS8 INS12 MOV5 INS32 MOV21 INS44 INS8 INS42 INS42 MOV32 MOV42 MOV5 INS32 INS32 INS43 INS42 INS53 MOV5 INS32 UPD42 INS42 INS42 INS42 INS42 INS14 INS42 INS42 UPD42 INS32 UPD42 INS32 INS43 INS42 INS42 INS42 INS42 DEL34 DEL8 DEL34 DEL42