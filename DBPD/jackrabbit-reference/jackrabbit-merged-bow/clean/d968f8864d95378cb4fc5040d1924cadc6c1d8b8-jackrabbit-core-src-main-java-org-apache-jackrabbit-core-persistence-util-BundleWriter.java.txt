JCR-3652 Bundle serialization broken

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1518170 13f79535-47bb-0310-9956-ffa450edef68

-        assert 0 <= type && type <= 0x0f;
+        if (type < 0 || type > 0xf) {
+            throw new IOException("Illegal property type " + type);
+        }
-            assert values.length == 1;
+            if (values.length != 1) {
+                throw new IOException(
+                        "Single values property with " + values.length + " values: " + 
+                        state.getName());
+            }
-            switch (state.getType()) {
+            switch (type) {
-                default:
+                case PropertyType.STRING:
+                case PropertyType.PATH:
+                case PropertyType.URI:
+                default:
+                    throw new IOException("Inknown property type: " + type);
+            if (local.length() == 0) {
+                throw new IOException("Attempt to write an empty local name: " + name);
+            }

INS25 INS27 INS8 UPD27 MOV27 UPD27 MOV27 INS53 INS25 INS25 INS42 UPD34 INS14 INS27 INS8 INS42 INS49 INS49 INS49 INS53 INS27 INS8 INS43 INS27 MOV40 MOV34 INS53 INS40 INS40 INS40 INS14 INS32 INS34 INS53 INS42 INS45 INS42 INS14 INS43 INS27 INS42 INS42 INS14 INS43 INS27 INS42 INS45 INS42 INS43 INS27 INS42 INS45 INS40 INS45 INS32 INS42 INS45 INS42 INS42 INS42 DEL42 DEL27 DEL6 DEL27 DEL6 DEL42 DEL42 DEL32