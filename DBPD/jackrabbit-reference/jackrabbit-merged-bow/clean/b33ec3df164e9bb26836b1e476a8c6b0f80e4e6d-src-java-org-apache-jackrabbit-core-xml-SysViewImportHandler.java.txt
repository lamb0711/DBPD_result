Session.importXML did not throw ItemExistsException if existing node is in the way

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@125428 13f79535-47bb-0310-9956-ffa450edef68

-                        // now that we're collected all required system properties
+                        // now that we've collected all required system properties
-                        // now that we're collected all required system properties
+                        // now that we've collected all required system properties
-            if (def.isProtected()) {
+            if (def.isProtected() || def.isAutoCreate()) {
-
-            } else if (def.isAutoCreate()) {
-                // @todo how to handle protected/auto-created child node?
-
+                state.node = (NodeImpl) state.parent.getNode(state.nodeName);
+            } else if (!def.allowSameNameSibs()) {
+                throw new ItemExistsException(state.parent.safeGetJCRPath() + "/" + state.nodeName);
-        } else {
+        }
+        if (state.node == null) {

INS25 MOV32 MOV8 INS27 INS40 INS33 INS27 MOV32 MOV32 INS21 INS38 INS7 INS32 INS53 INS40 INS11 INS42 INS42 INS14 INS43 INS32 INS43 INS27 INS42 INS40 INS42 INS40 INS42 INS32 INS45 INS40 INS40 INS42