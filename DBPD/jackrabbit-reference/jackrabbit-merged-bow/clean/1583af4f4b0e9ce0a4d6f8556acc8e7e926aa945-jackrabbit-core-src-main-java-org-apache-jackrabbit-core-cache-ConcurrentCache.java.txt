JCR-2699: Improve read/write concurrency

Use a constant for the default number of cache segments to use, as computing the number of available processors can be quite expensive.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1005057 13f79535-47bb-0310-9956-ffa450edef68

+    /**
+     * Default number of cache segments to use. Use the number of available
+     * processors (even if that might change during runtime!) as a reasonable
+     * approximation of the amount of parallelism we should expect in the
+     * worst case.
+     * <p>
+     * One reason for this value being a constant is that the
+     * {@link Runtime#availableProcessors()} call is somewhat expensive at
+     * least in some environments.
+     */
+    private static int DEFAULT_NUMBER_OF_SEGMENTS =
+        Runtime.getRuntime().availableProcessors();
+
-        this(Runtime.getRuntime().availableProcessors());
+        this(DEFAULT_NUMBER_OF_SEGMENTS);

INS23 INS29 INS83 INS83 INS39 INS59 INS65 INS42 MOV32 INS66 INS66 INS66 INS66 INS66 INS66 INS65 INS66 INS66 INS42 INS68 INS42 INS42