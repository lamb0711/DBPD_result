JCR-2744: Avoid element arrays in PathImpl

Replace the inner PathImpl class in PathFactoryImpl with the new path classes.

Minor fixes and tweaks to the way in which especially identifier-based paths are handled.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@995735 13f79535-47bb-0310-9956-ffa450edef68

-    private final IdentifierElement element;
+    private final Element element;
-    public IdentifierPath(IdentifierElement element) {
+    public IdentifierPath(Element element) {
+        assert element != null;
+        assert element.denotesIdentifier();
+        } else if (degree > 0) {
+            throw new RepositoryException(
+                    "Cannot construct ancestor path from an identifier");
-            Path ancestor = this;
-            while (degree-- > 0) {
-                ancestor = new ParentPath(ancestor);
-            }
-            return ancestor;
+            return this;
+    //--------------------------------------------------------------< Object >
+
+    public final boolean equals(Object that) {
+        if (this == that) {
+            return true;
+        } else if (that instanceof IdentifierPath) {
+            IdentifierPath path = (IdentifierPath) that;
+            return element.equals(path.element);
+        } else {
+            return false;
+        }
+    }
+
+    public final int hashCode() {
+        return element.hashCode();
+    }
+

INS31 INS31 UPD43 INS83 INS83 INS39 INS42 INS44 INS8 INS83 INS83 INS39 INS42 INS8 UPD42 UPD43 INS6 INS6 INS25 INS43 INS42 INS25 INS41 UPD42 INS27 INS32 MOV27 MOV8 INS25 INS42 INS27 INS8 INS25 INS32 INS42 INS33 INS42 INS42 INS27 INS8 INS8 INS52 INS42 INS41 INS62 INS8 INS8 INS42 INS42 INS42 MOV34 INS53 MOV41 INS9 INS42 INS43 INS60 INS41 INS41 INS14 INS52 INS42 INS43 INS59 INS32 INS9 UPD43 MOV43 INS45 INS42 INS42 INS11 INS42 INS42 INS40 UPD42 INS43 INS42 INS42 DEL42 DEL42 DEL43 DEL42 DEL52 DEL59 DEL60 DEL42 DEL37 DEL27 DEL42 DEL42 DEL14 DEL7 DEL21 DEL8 DEL61 DEL8 DEL25