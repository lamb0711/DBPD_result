Refactoring step 3 (JCR-53)
 - Moved workspace.xml parsing to ConfigurationParser
 - Replaced createFileSystem with BeanConfig code
 - Added a TestAll suite for the config package

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@156058 13f79535-47bb-0310-9956-ffa450edef68

-abstract class AbstractConfig implements EntityResolver {
+abstract class AbstractConfig {
+    /**
+     * public id
+     */
+    public static final String PUBLIC_ID = "-//The Apache Software Foundation//DTD Workspace//EN";
+
-    protected final String configId;
-        configId = is.getSystemId() == null ? "[???]" : is.getSystemId();
-            parser.setEntityResolver(this);
+            parser.setEntityResolver(new EntityResolver() {
+                public InputSource resolveEntity(String publicId, String systemId)
+                        throws SAXException, IOException {
+                    if (publicId.equals(PUBLIC_ID)) {
+                        // load dtd resource
+                        return new InputSource(getClass().getClassLoader().getResourceAsStream(CONFIG_DTD_RESOURCE_PATH));
+                    } else {
+                        // use the default behaviour
+                        return null;
+                    }
+                }
+            });
-    //-------------------------------------------------------< EntityResolver >
-    /**
-     * @see EntityResolver#resolveEntity(String, String)
-     */
-    public abstract InputSource resolveEntity(String publicId, String systemId)
-            throws SAXException, IOException;

MOV23 INS29 UPD83 INS83 INS65 UPD42 INS45 INS66 INS14 MOV43 INS1 INS31 INS83 MOV43 INS42 MOV44 MOV44 MOV43 MOV43 INS8 INS25 INS32 INS8 INS8 INS42 INS42 INS42 INS41 INS41 INS14 INS33 INS43 INS32 INS42 INS32 INS42 INS42 INS32 INS42 INS42 DEL42 DEL42 DEL42 DEL32 DEL33 DEL27 DEL45 DEL42 DEL42 DEL32 DEL16 DEL7 DEL21 DEL52 DEL42 DEL42 DEL42 DEL43 DEL69 DEL42 DEL43 DEL69 DEL68 DEL65 DEL29 DEL83 DEL83 DEL42 DEL31