JCR-3545: fix error handling for unknown WebDAV REPORTs

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1461064 13f79535-47bb-0310-9956-ffa450edef68

+import javax.xml.parsers.ParserConfigurationException;
+import org.apache.jackrabbit.webdav.xml.DomUtil;
+import org.w3c.dom.Element;
-        if (supportedReports.isSupportedReport(reportInfo)) {
-            Report report = ReportType.getType(reportInfo).createReport(this, reportInfo);
-            return report;
-        } else {
-            throw new DavException(DavServletResponse.SC_UNPROCESSABLE_ENTITY, "Unknown report "+ reportInfo.getReportName() +"requested.");
+        if (!supportedReports.isSupportedReport(reportInfo)) {
+            Element condition = null;
+            try {
+                condition = DomUtil.createDocument().createElementNS("DAV:", "supported-report");
+            } catch (ParserConfigurationException ex) {
+                // we don't care THAT much
+            }
+            throw new DavException(DavServletResponse.SC_CONFLICT,
+                    "Unknown report '" + reportInfo.getReportName() + "' requested.", null, condition);
+        return ReportType.getType(reportInfo).createReport(this, reportInfo);

INS26 INS26 INS26 INS40 INS40 INS40 INS41 INS38 MOV32 MOV32 INS54 MOV53 UPD43 INS8 INS12 UPD42 UPD42 INS33 INS21 INS44 INS8 UPD40 INS33 INS42 INS7 INS43 INS42 UPD45 UPD45 INS42 INS32 INS42 INS32 INS42 INS45 INS45 INS42 INS42 DEL42 DEL41 DEL8