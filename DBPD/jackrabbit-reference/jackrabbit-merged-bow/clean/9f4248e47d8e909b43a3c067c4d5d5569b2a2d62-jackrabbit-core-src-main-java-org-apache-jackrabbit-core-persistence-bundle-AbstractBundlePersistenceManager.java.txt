JCR-2699: Improve read/write concurrency

Use more fine-grained synchronization in the bundle persistence managers to allow readers to concurrently access the bundle cache.
Document these concurrency assumptions (guaranteed by the SISM and ISMLocking classes) in the PersistenceManager interface.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1003423 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.core.persistence.util.BundleBinding;
-    public synchronized NodeState load(NodeId id)
+    public NodeState load(NodeId id)
-    public synchronized PropertyState load(PropertyId id)
+    public PropertyState load(PropertyId id)
-    public synchronized boolean exists(PropertyId id) throws ItemStateException {
+    public boolean exists(PropertyId id) throws ItemStateException {
-    public synchronized boolean exists(NodeId id) throws ItemStateException {
+    public boolean exists(NodeId id) throws ItemStateException {
-            bundle = loadBundle(id);
-            if (bundle != null) {
-                bundle.markOld();
-                bundles.put(bundle);
-            } else {
-                missing.put(id);
+            synchronized (this) {
+                bundle = loadBundle(id);
+                if (bundle != null) {
+                    bundle.markOld();
+                    bundles.put(bundle);
+                } else {
+                    missing.put(id);
+                }

INS8 INS51 INS52 MOV8 DEL40 DEL26 DEL83 DEL83 DEL83 DEL83