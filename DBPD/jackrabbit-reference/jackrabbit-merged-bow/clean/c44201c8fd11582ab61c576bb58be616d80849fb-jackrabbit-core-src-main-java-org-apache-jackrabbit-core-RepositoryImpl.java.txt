JCR-623 - Clustering
+ Journal file was considered bogus
+ RepositoryImpl derived classes did not setup version manager channel; moved up


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@485714 13f79535-47bb-0310-9956-ffa450edef68

-    private final VersionManager vMgr;
+    private final VersionManagerImpl vMgr;
+        if (clusterNode != null) {
+            vMgr.setEventChannel(clusterNode);
+        }
-    protected VersionManager createVersionManager(VersioningConfig vConfig,
-                                                  DelegatingObservationDispatcher delegatingDispatcher)
+    protected VersionManagerImpl createVersionManager(VersioningConfig vConfig,
+                                                      DelegatingObservationDispatcher delegatingDispatcher)
-        VersionManagerImpl vMgr = new VersionManagerImpl(pm, fs, ntReg, delegatingDispatcher,
+        return new VersionManagerImpl(pm, fs, ntReg, delegatingDispatcher,
-        if (clusterNode != null) {
-            vMgr.setEventChannel(clusterNode);
-        }
-        return vMgr;

UPD43 MOV43 UPD42 MOV25 MOV14 DEL42 DEL43 DEL42 DEL59 DEL60 DEL42