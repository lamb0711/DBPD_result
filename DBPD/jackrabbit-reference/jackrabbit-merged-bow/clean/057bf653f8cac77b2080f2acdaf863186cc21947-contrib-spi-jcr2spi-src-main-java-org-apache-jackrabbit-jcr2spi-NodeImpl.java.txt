work in progress

- remove NodeState.getPropertyId and replace by getPropertyState
- use ChildNodeEntry.getNodeState
- consequently remove utility methods getNodeState, getPropertyState on
  ItemStateValidator, that converted ItemStateExceptions to RepositoryExc.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@429269 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.jcr2spi.state.PropertyState;
+import org.apache.jackrabbit.jcr2spi.state.NoSuchItemStateException;
-        // retrieve id of state that has been created during execution of AddNode        
+        // retrieve id of state that has been created during execution of AddNode
-        PropertyId propId = getNodeState().getPropertyId(qName);
-            return (Property) itemMgr.getItem(propId);
+            PropertyState pState = getNodeState().getPropertyState(qName);
+            return (Property) itemMgr.getItem(pState.getId());
+        } catch (NoSuchItemStateException e) {
+            throw new PathNotFoundException(qName.toString());
+        } catch (ItemStateException e) {
+            String msg = "Error while accessing property " + qName.toString();
+            throw new RepositoryException(msg, e);
-                    return getNodeState().getPropertyId(propName);
+                    try {
+                        return getNodeState().getPropertyState(propName).getPropertyId();
+                    } catch (ItemStateException e) {
+                        // should not occur due, since existance has been checked
+                        throw new RepositoryException(e);
+                    }

INS26 INS26 INS40 INS40 INS12 INS12 MOV60 INS44 INS8 INS44 INS8 UPD43 INS43 INS42 INS53 INS43 INS42 INS60 INS53 UPD42 UPD42 INS42 INS14 INS42 INS43 INS59 INS14 UPD42 INS32 INS43 INS32 INS42 INS42 INS27 INS43 INS42 INS42 INS8 INS42 UPD42 MOV42 INS42 INS42 INS42 INS45 INS32 INS42 INS54 INS42 INS42 MOV8 INS12 INS44 INS8 INS32 INS43 INS42 INS53 MOV32 INS42 INS42 INS14 UPD42 INS43 INS42 INS42