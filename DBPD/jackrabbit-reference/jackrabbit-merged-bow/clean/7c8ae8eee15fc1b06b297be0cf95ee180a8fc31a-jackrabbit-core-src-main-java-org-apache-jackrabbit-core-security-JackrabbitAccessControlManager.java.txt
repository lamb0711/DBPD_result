JCR-1588: 283 Access Control

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@689499 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.core.security.authorization.PolicyTemplate;
+import org.apache.jackrabbit.api.jsr283.security.AccessControlPolicy;
-import javax.jcr.PathNotFoundException;
-     * Returns a policy template for the existing node at <code>absPath</code>.
-     * 
-     * @return policy template for the node at <code>absPath</code>.
-     * @throws PathNotFoundException if no node exists for the given
-     * <code>nodePath</code>.
-     * @throws AccessDeniedException if the session lacks
-     * <code>MODIFY_ACCESS_CONTROL</code> privilege for the <code>absPath</code>
-     * node.
-     * @throws AccessControlException if this implementation does not allow to
-     * edit the policy at <code>absPath</code> of if same other access
-     * control related exception occurs.
-     * @throws UnsupportedRepositoryOperationException if editing the policy
-     * is not supported.
-     * @throws RepositoryException if another error occurs.
-     */
-    PolicyTemplate editPolicy(String absPath) throws PathNotFoundException, AccessDeniedException, AccessControlException, UnsupportedRepositoryOperationException, RepositoryException;
-
-    /**
-     * Returns a policy template for the specified <code>principal.</code>
+     * Returns the editable policies for the specified <code>principal</code>.
-     * @return policy template for the specified <code>principal</code>.
+     * @return array of policies for the specified <code>principal</code>. Note
+     * that the policy object returned must reveal the path of the node where
+     * they can be applied later on.
-     * @throws AccessControlException if the specified principal does not exist,
-     * if this implementation does provide policy tempates for principals or
-     * if same other access control related exception occurs.
+     * @throws AccessControlException if the specified principal does not exist
+     * or if same other access control related exception occurs.
-    PolicyTemplate editPolicy(Principal principal) throws AccessDeniedException, AccessControlException, UnsupportedRepositoryOperationException, RepositoryException;
+    AccessControlPolicy[] getApplicablePolicies(Principal principal) throws AccessDeniedException, AccessControlException, UnsupportedRepositoryOperationException, RepositoryException;

UPD40 INS5 UPD42 INS43 INS85 UPD66 UPD66 INS66 INS66 UPD66 UPD66 UPD42 MOV42 DEL40 DEL26 DEL66 DEL65 DEL66 DEL65 DEL42 DEL66 DEL66 DEL65 DEL42 DEL66 DEL66 DEL66 DEL65 DEL42 DEL66 DEL66 DEL66 DEL65 DEL42 DEL66 DEL66 DEL65 DEL42 DEL66 DEL65 DEL29 DEL42 DEL43 DEL42 DEL42 DEL43 DEL42 DEL44 DEL42 DEL43 DEL42 DEL43 DEL42 DEL43 DEL42 DEL43 DEL42 DEL43 DEL31 DEL66 DEL43