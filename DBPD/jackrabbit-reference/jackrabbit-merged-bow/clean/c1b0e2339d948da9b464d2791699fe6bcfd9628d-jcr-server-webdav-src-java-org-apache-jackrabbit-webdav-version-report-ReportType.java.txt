JCR-341 - Jcr-Server: registration of ReportTypes fails

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@385485 13f79535-47bb-0310-9956-ffa450edef68

-            Report report = (Report) reportClass.getConstructor(new Class[0]).newInstance(new Object[0]);
+            Report report = (Report) reportClass.newInstance();
-            }
+    }
-        }
+    }
-
-            // test if this report class has an empty constructor and implements Report interface
-            boolean isValidClass = false;
-            Class[] interfaces = reportClass.getInterfaces();
-            for (int i = 0; i < interfaces.length && !isValidClass; i++) {
-                isValidClass = (interfaces[i] == Report.class);
-            }
-            if (!isValidClass) {
-                throw new IllegalArgumentException("The specified report class must implement the Report interface.");
-            }
-
-                reportClass.getConstructor(new Class[0]);
-            } catch (NoSuchMethodException e) {
-                throw new IllegalArgumentException("The specified report class must provide a default constructor.");
+                Object report =  reportClass.newInstance();
+                if (!(report instanceof Report)) {
+                    throw new IllegalArgumentException("Unable to register Report class: " + reportClass + " does not implement the Report interface.");
+                }
+            } catch (IllegalAccessException e) {
+                throw new IllegalArgumentException("Error while validating Report class: " + e.getMessage());
+            } catch (InstantiationException e) {
+                throw new IllegalArgumentException("Error while validating Report class.: " + e.getMessage());

INS54 INS8 INS12 MOV12 MOV60 MOV25 INS44 INS8 MOV43 INS43 INS42 INS53 UPD43 MOV42 UPD42 INS36 INS42 INS14 UPD42 UPD42 INS62 MOV43 INS27 MOV43 INS27 INS42 MOV43 INS43 INS27 INS45 INS32 INS45 INS32 INS42 INS45 INS42 INS45 UPD42 MOV42 UPD42 MOV42 INS42 INS42 DEL42 DEL42 DEL43 DEL85 DEL5 DEL34 DEL3 DEL32 DEL85 DEL5 DEL34 DEL3 DEL42 DEL43 DEL85 DEL5 DEL42 DEL45 DEL45 DEL39 DEL42 DEL9 DEL59 DEL60 DEL39 DEL42 DEL34 DEL59 DEL58 DEL42 DEL40 DEL27 DEL42 DEL38 DEL27 DEL42 DEL37 DEL42 DEL42 DEL42 DEL2 DEL57 DEL27 DEL36 DEL7 DEL21 DEL8 DEL24 DEL42 DEL43 DEL85 DEL5 DEL34 DEL3 DEL32 DEL21 DEL8 DEL54