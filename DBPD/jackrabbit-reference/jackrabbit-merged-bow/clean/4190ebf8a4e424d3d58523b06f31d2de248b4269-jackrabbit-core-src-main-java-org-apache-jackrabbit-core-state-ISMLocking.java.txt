JCR-2753: Deadlock in DefaultISMLocking

Move the thread identifier computations to TransactionContext from where they can be better reused.

Note that it's not necessarily possible to "upgrade" an ISMLocking read lock.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1036336 13f79535-47bb-0310-9956-ffa450edef68

- * must continue also when the write lock has been downgraded.</li>
+ * must continue also when the write lock has been downgraded. Note that it
+ * is not necessary for a holder of a read lock to be able to upgrade to a
+ * write lock.</li>

UPD66 INS66 INS66