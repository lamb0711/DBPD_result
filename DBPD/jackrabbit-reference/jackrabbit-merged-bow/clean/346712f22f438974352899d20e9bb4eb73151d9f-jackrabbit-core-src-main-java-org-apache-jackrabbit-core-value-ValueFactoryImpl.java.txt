JCR-3534: Efficient copying of binaries across repositories with the same data store

Change getIdentifierFromReference() to getRecordFromReference() to avoid problems with a previously valid reference pointing to a record that has already been removed.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1484444 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.data.DataRecord;
-                DataIdentifier identifier = store.getIdentifierFromReference(reference);
-                if (identifier != null) {
-                    InternalValue value = InternalValue.getInternalValue(
-                            identifier, store, false);
-                    return new BinaryValueImpl(value.getBLOBFileValue());
+                DataRecord record = store.getRecordFromReference(reference);
+                if (record != null) {
+                    return new BinaryValueImpl(BLOBInDataStore.getInstance(
+                            store, record.getIdentifier()));

INS26 INS40 UPD43 UPD42 UPD42 UPD42 INS41 UPD42 INS14 MOV43 INS32 INS42 UPD42 MOV42 MOV42 INS32 UPD42 MOV42 UPD42 MOV42 DEL42 DEL43 DEL42 DEL42 DEL42 DEL9 DEL32 DEL59 DEL60 DEL32 DEL14 DEL41