JCR-1488: Node deleted while query is executed should not affect result size

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@639218 13f79535-47bb-0310-9956-ffa450edef68

-                try {
-                    if (isAccessGranted(sn)) {
-                        resultNodes.add(sn);
-                    } else {
-                        invalid++;
-                    }
-                } catch (ItemNotFoundException e) {
-                    // has been deleted meanwhile
+                if (isAccessGranted(sn)) {
+                    resultNodes.add(sn);
+                } else {
-     * @throws ItemNotFoundException if one of the <code>nodes</code> is not
-     *                               found.
-     * @throws RepositoryException   if an error occurs while checking access
-     *                               rights.
+     * @throws RepositoryException if an error occurs while checking access
+     *                             rights.
-            throws ItemNotFoundException, RepositoryException {
+            throws RepositoryException {
-            if (nodes[i] != null && !accessMgr.isGranted(
-                    nodes[i].getNodeId(), AccessManager.READ)) {
-                return false;
+            try {
+                if (nodes[i] != null && !accessMgr.isGranted(
+                        nodes[i].getNodeId(), AccessManager.READ)) {
+                    return false;
+                }
+            } catch (ItemNotFoundException e) {
+                // node deleted while query was executed

UPD66 INS8 INS54 MOV8 MOV8 MOV12 DEL54 DEL8 DEL42 DEL66 DEL66 DEL65 DEL42 DEL43 DEL42 DEL37 DEL21