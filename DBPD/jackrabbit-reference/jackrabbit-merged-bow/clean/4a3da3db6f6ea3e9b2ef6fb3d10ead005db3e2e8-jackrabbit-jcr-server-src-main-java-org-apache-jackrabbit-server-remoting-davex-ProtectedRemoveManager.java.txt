JCR-2113 : JSR 283 Access Control Management (contribution by Alfusainey Jallow)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1656464 13f79535-47bb-0310-9956-ffa450edef68

-        Properties props = new Properties();
-        if (config == null) {
-            log.warn("protectedhandlers-config is missing -> DIFF processing can fail for the Remove operation if the content to" +
-                    "remove is protected!");
-        } else {
-            File file = new File(config);
-            if (file.exists()) {
-                InputStream inStream = new FileInputStream(file);
-                props.load(inStream);
-                for (Enumeration<?> en = props.propertyNames(); en.hasMoreElements();) {
-                    String key = en.nextElement().toString();
-                    String className = props.getProperty(key);
-                    if (!className.isEmpty()) {
-                        ProtectedItemRemoveHandler irHandler = createHandler(className);
-                        if (irHandler != null) {
-                            handlers.add(irHandler);
-                        }
-                    }
-                }
-            } else {
-                log.debug("Fail to locate the protected-item-remove-handler properties file.");
-            }
-        }
+
+    	 if (config == null) {
+             log.warn("protectedhandlers-config is missing -> DIFF processing can fail for the Remove operation if the content to" +
+                     "remove is protected!");
+         } else {
+        	 File file = new File(config);
+        	 if (file.exists()) {         
+        		 InputStream inStream = new FileInputStream(file);
+                 Properties props = new Properties();
+        		 props.load(inStream);             
+        		 for (Enumeration<?> en = props.propertyNames(); en.hasMoreElements();) {             
+        			 String key = en.nextElement().toString();                 
+        			 String className = props.getProperty(key);                 
+        			 if (!className.isEmpty()) {                 
+        				 ProtectedItemRemoveHandler irHandler = createHandler(className);                     
+        				 if (irHandler != null) {                     
+        					 handlers.add(irHandler);                        
+        				 }                    
+        			 }                
+        		 }            
+        	 } else { // config is an Impl class
+        		 if (!config.isEmpty()) {        	    	
+        			 ProtectedItemRemoveHandler irHandler = createHandler(config);        	         
+        			 if (irHandler != null) {        	         
+        				 handlers.add(irHandler);        	            
+        			 }        	    	
+        		 } else {        	    
+        			 log.debug("Fail to locate the protected-item-remove-handler properties file.");        	    	
+        		 }
+        	 }        
+         }    	 

INS8 MOV60 INS25 INS38 INS8 MOV8 INS32 INS60 INS25 INS42 INS42 INS43 INS59 INS27 INS8 INS42 INS42 INS32 INS42 INS33 INS21 INS42 INS42 INS32 INS42 INS42 INS42