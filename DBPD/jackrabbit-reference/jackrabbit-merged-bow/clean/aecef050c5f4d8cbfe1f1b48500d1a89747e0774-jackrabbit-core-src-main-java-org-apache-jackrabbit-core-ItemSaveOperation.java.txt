JCR-2650: don't silently merge session-local transient changes with external changes before save().

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@966697 13f79535-47bb-0310-9956-ffa450edef68

-     * within the scope of <code>this.{@link #save()}</code>. The collection
+     * within the scope of <code>this.{@link #perform(SessionContext)}</code>. The collection
-                    case ItemState.STATUS_STALE_MODIFIED:
-                        throw new InvalidItemStateException(
-                                "Item cannot be saved because it has been "
-                                + "modified externally: " + this);
-
-                case ItemState.STATUS_STALE_MODIFIED:
-                    throw new InvalidItemStateException(
-                            "Item cannot be saved because it has been"
-                            + " modified externally: " + this);
-
-     * <code>this.{@link #save()}</code>.
+     * <code>this.{@link #perform(SessionContext)}</code>.
-                switch (transientState.getStatus()) {
-                case ItemState.STATUS_STALE_MODIFIED:
-                    throw new InvalidItemStateException(
-                            "Item can't be removed because it has been"
-                            + " modified externally: "
-                            + transientState.getId());
-                case ItemState.STATUS_STALE_DESTROYED:
+                if (transientState.getStatus() == ItemState.STATUS_STALE_DESTROYED) {

MOV49 UPD42 INS69 UPD42 INS69 INS43 MOV49 INS43 INS25 INS42 INS42 INS27 INS8 MOV32 INS40 MOV53 DEL42 DEL43 DEL45 DEL45 DEL52 DEL27 DEL14 DEL53 DEL40 DEL49 DEL42 DEL43 DEL45 DEL45 DEL52 DEL27 DEL14 DEL53 DEL40 DEL49 DEL40 DEL49 DEL42 DEL43 DEL45 DEL45 DEL42 DEL42 DEL32 DEL27 DEL14 DEL53 DEL40 DEL49 DEL50