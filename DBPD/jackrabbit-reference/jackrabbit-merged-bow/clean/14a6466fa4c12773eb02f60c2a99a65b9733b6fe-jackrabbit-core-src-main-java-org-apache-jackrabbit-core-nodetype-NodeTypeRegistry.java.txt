JCR-808: Applied patch from Christoph Kiehl to get better error messages for non-trivial nodetype changes

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@526703 13f79535-47bb-0310-9956-ffa450edef68

+        
+       	String message = "The following nodetype change contains non-trivial changes."
+                + "Up until now only trivial changes are supported."
+                + " (see javadoc for "
+                + NodeTypeDefDiff.class.getName()
+                + "):\n" + diff.toString();
+        throw new RepositoryException(message);
+        // TODO Implement checkForConflictingContent()
-        checkForConflictingContent(ntd);
-
+        //checkForConflictingContent(ntd);
+        //
-        internalUnregister(name);
+        //internalUnregister(name);
-        EffectiveNodeType entNew = internalRegister(ntd);
-
+        //EffectiveNodeType entNew = internalRegister(ntd);
+        //
-        customNTDefs.remove(name);
-        customNTDefs.add(ntd);
-        persistCustomNodeTypeDefs(customNTDefs);
-
+        //customNTDefs.remove(name);
+        //customNTDefs.add(ntd);
+        //persistCustomNodeTypeDefs(customNTDefs);
+        //
-        notifyReRegistered(name);
-        return entNew;
+        //notifyReRegistered(name);
+        //return entNew;

INS60 INS53 UPD43 MOV43 INS59 INS14 UPD42 UPD42 MOV42 INS27 INS43 INS42 INS27 INS32 INS45 INS32 INS42 INS45 INS45 INS45 INS57 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 INS43 INS42 DEL42 DEL42 DEL32 DEL21 DEL42 DEL42 DEL32 DEL21 DEL42 DEL42 DEL32 DEL59 DEL60 DEL42 DEL42 DEL32 DEL21 DEL42 DEL32 DEL21 DEL42 DEL42 DEL32 DEL21 DEL42 DEL42 DEL32 DEL21 DEL42 DEL41