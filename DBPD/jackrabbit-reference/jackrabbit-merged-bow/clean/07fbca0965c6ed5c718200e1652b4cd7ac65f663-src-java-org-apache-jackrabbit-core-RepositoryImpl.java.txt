- AccessManager: added method canAccess(String wspName) to check authorization for specific workspace

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@157086 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.lock.LockManager;
+import org.apache.jackrabbit.core.lock.LockManagerImpl;
-import org.apache.jackrabbit.core.lock.LockManager;
-import org.apache.jackrabbit.core.lock.LockManagerImpl;
+import javax.jcr.AccessDeniedException;
-import javax.security.auth.login.LoginContext;
+import javax.security.auth.login.LoginContext;
+import java.security.AccessControlContext;
+import java.security.AccessController;
-import java.security.AccessControlContext;
-import java.security.AccessController;
+     *
-     * @throws RepositoryException if some other error occurs
+     * @throws RepositoryException      if some other error occurs
-            AccessControlContext acc  = AccessController.getContext();
+            AccessControlContext acc = AccessController.getContext();
-            Session ses = new XASessionImpl(this, subject, wspInfo.getConfig());
+            Session ses;
+            try {
+                ses = new XASessionImpl(this, subject, wspInfo.getConfig());
+            } catch (AccessDeniedException ade) {
+                // authenticated subject is not authorized for the specified workspace
+                throw new LoginException(ade.getMessage());
+            }
-        // @todo check access rights for given workspace
-
-        Session ses = new XASessionImpl(this, lc, wspInfo.getConfig());
+        Session ses;
+        try {
+            ses = new XASessionImpl(this, lc, wspInfo.getConfig());
+        } catch (AccessDeniedException ade) {
+            // authenticated subject is not authorized for the specified workspace
+            throw new LoginException(ade.getMessage());
+        }

MOV26 MOV26 MOV26 MOV26 MOV26 INS26 INS40 INS54 UPD66 INS8 INS12 INS21 INS44 INS8 INS7 INS43 INS42 INS53 INS42 MOV14 INS42 INS14 INS43 INS32 INS42 INS42 INS42