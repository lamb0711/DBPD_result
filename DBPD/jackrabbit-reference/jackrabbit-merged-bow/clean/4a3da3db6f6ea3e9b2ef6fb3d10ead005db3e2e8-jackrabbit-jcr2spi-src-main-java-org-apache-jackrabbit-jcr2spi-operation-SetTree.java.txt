JCR-2113 : JSR 283 Access Control Management (contribution by Alfusainey Jallow)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1656464 13f79535-47bb-0310-9956-ffa450edef68

-import java.util.Iterator;
-import org.apache.jackrabbit.jcr2spi.hierarchy.NodeEntry;
+import org.apache.jackrabbit.jcr2spi.state.UpdatableItemStateManager;
-     * List of operations added by this SetPolicy operation.
+     * List of operations added to this SetTree operation.
-    private SetTree(NodeState parentState, Name nodeName, Name nodeTypeName, String uuid) throws RepositoryException {
+    private SetTree(UpdatableItemStateManager itemStateMgr, NodeState parentState, Name nodeName, Name nodeTypeName, String uuid) throws RepositoryException {
+        
+        itemStateMgr.execute(addNode);
-    public static SetTree create(NodeState parent, Name nodeName, Name nodeTypeName, String uuid) throws RepositoryException {
-        return new SetTree(parent, nodeName, nodeTypeName, uuid);
+    public static SetTree create(UpdatableItemStateManager itemStateMgr, NodeState parent, Name nodeName, Name nodeTypeName, String uuid) throws RepositoryException {
+        return new SetTree(itemStateMgr, parent, nodeName, nodeTypeName, uuid);
-        private final static int SET_POLICY_ADD_NODE_OPTIONS =  ItemStateValidator.CHECK_ACCESS |
+        private final static int ADD_NODE_OPTIONS =  ItemStateValidator.CHECK_ACCESS |
-            super(parentState, nodeName, nodeTypeName, uuid, SET_POLICY_ADD_NODE_OPTIONS);
+            super(parentState, nodeName, nodeTypeName, uuid, ADD_NODE_OPTIONS);
-        private final static int SET_POLICY_ADD_PROPERTY_OPTIONS =  ItemStateValidator.CHECK_ACCESS |
+        private final static int ADD_PROPERTY_OPTIONS =  ItemStateValidator.CHECK_ACCESS |
-            super(parentState, propName, propertyType, values, definition, SET_POLICY_ADD_PROPERTY_OPTIONS);
+            super(parentState, propName, propertyType, values, definition, ADD_PROPERTY_OPTIONS);

MOV26 UPD40 INS44 INS44 INS43 INS42 INS21 INS43 INS42 UPD66 INS42 INS32 INS42 UPD42 UPD42 INS42 INS42 INS42 INS42 UPD42 UPD42 DEL40 DEL26