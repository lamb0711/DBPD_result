Make locking part of XAResource's transaction support

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@354456 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.lock.LockManager;
-     * Dispatch events belonging to a save operation.
-     *
-     * @param events events to dispatch as result of a successful save
-     *               operation
-     */
-    protected void dispatch(EventStateCollection events) {
-        events.dispatch();
-    }
-
-    /**
-                    wsp.getLockManager().lockTokenAdded(this, lt);
+                    getLockManager().lockTokenAdded(this, lt);
-                    wsp.getLockManager().lockTokenRemoved(this, lt);
+                    getLockManager().lockTokenRemoved(this, lt);
+    /**
+     * Return the lock manager for this session. In a non-transactional
+     * environment, this is simply the lock manager shared by all sessions
+     * on this workspace.
+     * @return lock manager for this session
+     * @throws RepositoryException if an error occurs
+     */
+    public LockManager getLockManager() throws RepositoryException {
+        return wsp.getLockManager();
+    }
+

INS26 MOV31 INS40 UPD83 INS43 INS42 INS43 MOV8 INS65 UPD65 UPD42 MOV42 INS42 INS41 UPD66 INS66 INS66 INS66 UPD42 UPD66 MOV32 INS8 INS21 INS32 INS32 INS42 INS52 INS42 INS42 DEL42 DEL66 DEL42 DEL52 DEL42 DEL32 DEL21 DEL39 DEL42 DEL43 DEL42 DEL44 DEL42 DEL42 DEL32 DEL21 DEL8