JCR-1813: Invalid journal records during XATransactions

Use a dummy sentinel to ignore empty journal records that may have been erroneously created.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@708609 13f79535-47bb-0310-9956-ffa450edef68

+        case ClusterRecord.END_MARKER:
+            // JCR-1813: Invalid journal records during XATransactions
+            // Some journal records may be empty due to JCR-1813 and other
+            // issues. We handle such cases with this dummy sentinel record.
+            clusterRecord = new ClusterRecord(record) {
+                protected void doRead() {
+                }
+                protected void doWrite() {
+                }
+                public void process(ClusterRecordProcessor processor) {
+                }
+            };
+            break;
-            String msg = "Unknown record identifier: " + c;
-            throw new JournalException(msg);
+            throw new JournalException("Unknown record identifier: " + c);

INS21 INS10 INS49 INS40 INS7 INS42 INS14 MOV27 INS43 INS42 INS1 UPD42 MOV42 INS31 INS31 INS31 INS83 INS39 INS42 INS8 INS83 INS39 INS42 INS8 INS83 INS39 INS42 INS44 INS8 INS43 INS42 INS42 DEL43 DEL42 DEL59 DEL60 DEL42