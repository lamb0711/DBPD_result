JCR-1984 : UserManagement: Limit set of properties exposed by AuthorizableImpl
JCR-1993 : UserManagement: Missing assertion that Principal name isn't ""

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@746301 13f79535-47bb-0310-9956-ffa450edef68

-        if (userID == null || password == null || principal == null) {
-            throw new IllegalArgumentException("Not possible to create user with null parameters");
+        if (userID == null || userID.length() == 0) {
+            throw new IllegalArgumentException("Cannot create user: UserID can neither be null nor empty String.");
+        }
+        if (password == null) {
+            throw new IllegalArgumentException("Cannot create user: null password.");
+        }
+        if (!isValidPrincipal(principal)) {
+            throw new IllegalArgumentException("Cannot create user: Principal may not be null and must have a valid name.");            
-        if (principal == null) {
-            throw new IllegalArgumentException("Principal might not be null.");
+        if (!isValidPrincipal(principal)) {
+            throw new IllegalArgumentException("Cannot create Group: Principal may not be null and must have a valid name.");
-        String currentUserPath = USERS_PATH;;
+        String currentUserPath = USERS_PATH;
+    private static boolean isValidPrincipal(Principal principal) {
+        return principal != null && principal.getName() != null && principal.getName().length() > 0;
+    }
+    

INS31 INS83 INS83 INS39 INS42 INS44 INS8 INS25 INS25 INS43 INS42 INS41 MOV27 INS8 INS38 INS8 INS38 INS42 INS27 MOV27 INS53 INS32 INS53 INS32 INS27 INS27 INS32 INS34 INS14 INS42 INS42 INS14 INS42 INS42 INS27 INS27 INS32 INS34 INS42 INS42 UPD45 INS43 INS45 INS43 INS45 UPD45 INS42 INS33 INS32 INS33 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS42 DEL27 DEL42 DEL33 DEL42 DEL33 DEL27 DEL20