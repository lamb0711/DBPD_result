JCR-1813: Invalid journal records during XATransactions

Only update the repository in an XA transaction if there actually are repository changes within that transaction.

Fix proposed by Stephane Landelle.


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@705938 13f79535-47bb-0310-9956-ffa450edef68

+     * Checks whether this change log contains any changes. This method is
+     * used to avoid extra work on updates that contain no changes.
+     *
+     * @since Apache Jackrabbit 1.5
+     * @see <a href="https://issues.apache.org/jira/browse/JCR-1813">JCR-1813</a>
+     * @return <code>true</code> if this log contains at least one change,
+     *         <code>false</code> otherwise
+     */
+    public boolean hasUpdates() { 
+        return !(addedStates.isEmpty() && modifiedStates.isEmpty()
+                && deletedStates.isEmpty() && modifiedRefs.isEmpty()); 
+    }
+
+    /**

INS31 INS29 INS83 INS39 INS42 INS8 INS65 INS65 INS65 INS65 INS41 INS66 INS66 INS66 INS66 INS66 INS66 INS38 INS36 INS27 INS32 INS32 INS32 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42