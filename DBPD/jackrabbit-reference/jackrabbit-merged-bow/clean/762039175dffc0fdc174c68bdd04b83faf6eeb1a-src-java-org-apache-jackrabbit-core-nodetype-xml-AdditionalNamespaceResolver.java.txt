JCR-54: Refactoring^2, taking full advantage of the DOMBuilder and DOMWalker utility classes.

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@160450 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.Enumeration;
-import org.apache.jackrabbit.core.Constants;
-import org.w3c.dom.Attr;
-import org.w3c.dom.Element;
-import org.w3c.dom.NamedNodeMap;
-     * Creates a namespace resolver using the namespaces declared
-     * in the given XML element.
+     * Creates a namespace resolver using the namespaces defined in
+     * the given prefix-to-URI property set.
-     * @param element XML element
+     * @param namespaces namespace properties
-    public AdditionalNamespaceResolver(Element element) {
-        NamedNodeMap attributes = element.getAttributes();
-        for (int i = 0; i < attributes.getLength(); i++) {
-            Attr attribute = (Attr) attributes.item(i);
-            if (Constants.NS_XMLNS_PREFIX.equals(attribute.getPrefix())) {
-                addNamespace(attribute.getLocalName(), attribute.getValue());
-            }
+    public AdditionalNamespaceResolver(Properties namespaces) {
+        Enumeration prefixes = namespaces.propertyNames();
+        while (prefixes.hasMoreElements()) {
+            String prefix = (String) prefixes.nextElement();
+            addNamespace(prefix, namespaces.getProperty(prefix));
-        addNamespace(Constants.NS_EMPTY_PREFIX, Constants.NS_DEFAULT_URI);
+        addNamespace("", "");

MOV26 UPD40 UPD43 UPD42 INS61 UPD66 UPD66 UPD42 UPD66 UPD42 UPD43 INS32 INS8 UPD42 UPD42 UPD42 MOV42 UPD42 MOV42 MOV60 MOV21 INS45 INS45 UPD42 UPD42 UPD43 UPD42 UPD42 UPD42 MOV42 UPD43 UPD42 UPD42 INS42 UPD42 UPD42 UPD42 DEL40 DEL26 DEL40 DEL26 DEL40 DEL26 DEL42 DEL42 DEL32 DEL39 DEL42 DEL34 DEL59 DEL58 DEL42 DEL32 DEL27 DEL42 DEL37 DEL40 DEL42 DEL42 DEL42 DEL32 DEL32 DEL8 DEL25 DEL8 DEL24 DEL40 DEL40