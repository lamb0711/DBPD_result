JCR-1765: Config: make all elements in the security configuration optional

Added a simple workaround that just uses SimpleSecurityManager as the default if an explicit security manager configuration is not present. This makes my backwards compatibility test cases in sandbox work.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@704165 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.security.simple.SimpleSecurityManager;
-     * Parses the security manager configuration.
+     * Parses the security manager configuration. Returns default
+     * configuration based on the {@link SimpleSecurityManager} class if
+     * a security manager is not explicitly configured.
+     * @see <a href="https://issues.apache.org/jira/browse/JCR-1765">JCR-1765</a>
-
-        BeanConfig bc = parseBeanConfig(security, SECURITY_MANAGER_ELEMENT);
-
-        Element smElement = getElement(security, SECURITY_MANAGER_ELEMENT);
-        String wspAttr = getAttribute(smElement, WSP_NAME_ATTRIBUTE, null);
-
+        BeanConfig bc = new BeanConfig(
+                SimpleSecurityManager.class.getName(), new Properties());
+        String wspAttr = "security";
-        Element element = getElement(smElement, WORKSPACE_ACCESS_ELEMENT, false);
+
+        Element element = getElement(security, SECURITY_MANAGER_ELEMENT, false);
-            wac = parseBeanConfig(smElement, WORKSPACE_ACCESS_ELEMENT);
+            bc = parseBeanConfig(security, SECURITY_MANAGER_ELEMENT);
+
+            wspAttr = getAttribute(element, WSP_NAME_ATTRIBUTE, null);
+
+            if (getElement(element, WORKSPACE_ACCESS_ELEMENT, false) != null) {
+                wac = parseBeanConfig(element, WORKSPACE_ACCESS_ELEMENT);
+            }
+

INS26 INS40 INS65 INS60 INS60 INS25 UPD66 INS66 INS65 INS66 INS66 INS66 MOV43 INS59 MOV43 MOV59 MOV27 INS8 INS42 INS14 INS42 INS45 UPD42 INS21 INS21 INS25 INS43 INS32 INS14 INS9 INS7 INS7 INS27 MOV8 INS42 INS57 INS42 INS43 INS42 MOV32 INS42 INS32 INS32 INS33 INS43 INS42 MOV42 UPD42 MOV42 MOV42 MOV33 MOV42 UPD42 MOV42 MOV42 MOV9 INS42 UPD42 DEL42 DEL43 DEL60 DEL42 DEL32 DEL59 DEL60 DEL42 DEL32 DEL59 DEL60 DEL25