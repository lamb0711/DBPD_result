JCR-3534: Efficient copying of binaries across repositories with the same data store

Change getIdentifierFromReference() to getRecordFromReference() to avoid problems with a previously valid reference pointing to a record that has already been removed.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1484444 13f79535-47bb-0310-9956-ffa450edef68

-    @Override
-    public DataIdentifier getIdentifierFromReference(String reference) {
-        DataIdentifier identifier = primaryDataStore.getIdentifierFromReference(reference);
-        if (identifier == null) {
-            identifier = archiveDataStore.getIdentifierFromReference(reference);
+    public DataRecord getRecordFromReference(String reference)
+            throws DataStoreException {
+        DataRecord record = primaryDataStore.getRecordFromReference(reference);
+        if (record == null) {
+            record = archiveDataStore.getRecordFromReference(reference);
-        return identifier;
+        return record;

UPD43 UPD42 INS43 UPD42 INS42 UPD43 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 DEL42 DEL78