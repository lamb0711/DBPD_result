JCR-3040: JMX Stats for the Session

Make repository statistics available to a webapp

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1181745 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.api.JackrabbitRepository;
+import org.apache.jackrabbit.core.RepositoryContext;
+ *   <dt>org.apache.jackrabbit.core.RepositoryContext</dt>
+ *   <dd>
+ *     Name of the servlet context attribute to put the internal
+ *     component context of the repository in. The default value is
+ *     "<code>org.apache.jackrabbit.core.RepositoryContext</code>".
+ *   </dd>
-    private JackrabbitRepository repository;
+    private RepositoryContext context;
-            repository = RepositoryImpl.create(RepositoryConfig.create(
+            context = RepositoryContext.create(RepositoryConfig.create(
+
+            String name = RepositoryContext.class.getName();
+            getServletContext().setAttribute(
+                    getInitParameter(name, name), context);
-        repository.shutdown();
+        context.getRepository().shutdown();
-        return repository;
+        return context.getRepository();

UPD40 UPD43 INS66 INS66 INS66 INS66 INS66 INS66 UPD42 UPD42 INS32 INS60 INS21 INS32 INS42 INS42 INS43 INS59 INS32 INS42 UPD42 MOV42 UPD42 INS42 INS42 INS32 INS32 INS42 INS32 INS42 UPD42 INS57 INS42 INS42 INS42 INS42 INS42 INS43 INS42 DEL42