JCR-1839: Introduce Event.getDate()

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@713076 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.core.cluster.LockEventListener;
-    public void externalUpdate(ChangeLog changes, List events)
+    public void externalUpdate(ChangeLog changes, List events, long timestamp)
-        clusterEvents.add(new UpdateEvent(changes, events));
+        clusterEvents.add(new UpdateEvent(changes, events, timestamp));
+         * Timestamp when the changes in this update event occured.
+         */
+        private final long timestamp;
+
+        /**
+         * @param timestamp time when the changes in this event occured.
-        public UpdateEvent(ChangeLog changes, List events) {
+        public UpdateEvent(ChangeLog changes, List events, long timestamp) {
+            this.timestamp = timestamp;
+        public long getTimestamp() {
+            return timestamp;
+        }
+
+        /**
+         * {@inheritDoc}
+         */
-            return changes.hashCode() ^ events.hashCode();
+            return changes.hashCode() ^ events.hashCode() ^ (int) (timestamp ^ (timestamp >>> 32));
-                    SimpleEventListener.equals(events, other.events);
+                    SimpleEventListener.equals(events, other.events) &&
+                    timestamp == other.timestamp;

INS44 INS23 INS31 INS39 INS42 INS29 INS83 INS83 INS39 INS59 INS44 INS29 INS83 INS39 INS42 INS8 INS65 INS42 INS65 INS39 INS42 INS21 INS65 INS41 INS66 INS42 INS66 INS7 INS65 INS42 INS42 INS22 INS42 INS11 INS52 INS42 INS39 INS36 INS27 INS27 INS42 INS36 INS42 INS40 INS27 INS42 INS34 DEL40 DEL26