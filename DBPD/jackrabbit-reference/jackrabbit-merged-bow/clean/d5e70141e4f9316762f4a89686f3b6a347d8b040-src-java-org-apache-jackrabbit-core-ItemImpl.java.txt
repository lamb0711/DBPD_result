- reset updateable item state mgr in case an update operation fails
- import on workspace (work in progress!)

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@156972 13f79535-47bb-0310-9956-ffa450edef68

+                boolean succeeded = false;
-                        // and aswell the references
-                        dirtyRefs= checkReferences(dirty.iterator(), removed.iterator());
+                        // and the references as well
+                        dirtyRefs = checkReferences(dirty.iterator(), removed.iterator());
-
+                    // update operation succeeded
+                    succeeded = true;
-
-
+                } finally {
+                    // update operation failed, cancel all modifications
+                    if (!succeeded) {
+                        stateMgr.cancel();
+                    }
-

INS60 INS39 INS59 INS8 INS42 INS9 INS21 INS25 INS7 INS38 INS8 INS42 INS9 INS42 INS21 INS32 INS42 INS42