* Remove fieldType. this attribute is not used in the object mapping. 
* Review one constructor in ObjectContentManagerImpl.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@563252 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.ocm.lock.Lock;
-import org.apache.jackrabbit.ocm.lock.Lock;
-     * <code>Mapper</code>, <code>QueryManager</code> and a default 
-     * <code>ObjectConverter</code>
+     * <code>Mapper</code>, and a <code>Session</code>
-     * @param queryManager the query manager to used
-    public ObjectContentManagerImpl(Mapper mapper,
-                                  QueryManager queryManager,
-                                  Session session) {
-        this.mapper = mapper;
-        this.session = session;
-        this.requestObjectCache = new RequestObjectCacheImpl();        
-        this.objectConverter = new ObjectConverterImpl(mapper, new DefaultAtomicTypeConverterProvider(), new ProxyManagerImpl(), requestObjectCache);
-        this.queryManager = queryManager;
-        
-        RepositoryUtil.setupSession(session);
+    public ObjectContentManagerImpl(Session session, Mapper mapper) {
+        try 
+        {
+			this.session = session;
+			this.mapper = mapper;
+			// Use default setting for the following dependencies
+			DefaultAtomicTypeConverterProvider converterProvider = new DefaultAtomicTypeConverterProvider();
+			Map atomicTypeConverters = converterProvider.getAtomicTypeConverters();
+			this.queryManager = new QueryManagerImpl(mapper, atomicTypeConverters, session.getValueFactory());
+			this.requestObjectCache = new RequestObjectCacheImpl();        
+			this.objectConverter = new ObjectConverterImpl(mapper, converterProvider, new ProxyManagerImpl(), requestObjectCache);
+			
+			RepositoryUtil.setupSession(session);
+		} 
+        catch (RepositoryException e) 
+        {
+            throw new org.apache.jackrabbit.ocm.exception.RepositoryException(
+                    "Impossible to instantiate the object content manager", e);
+
+		}

MOV26 MOV44 INS8 INS54 UPD66 MOV8 MOV21 MOV21 INS12 INS60 INS60 INS44 INS8 INS43 INS59 INS43 INS59 UPD43 MOV43 UPD42 MOV42 INS53 INS42 INS42 MOV14 INS42 INS42 INS32 INS14 UPD42 INS14 INS42 INS42 INS43 INS42 INS42 INS32 INS42 INS43 INS45 INS42 INS42 INS42 INS42 INS40 DEL66 DEL42 DEL66 DEL65 DEL44 DEL42