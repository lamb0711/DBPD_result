JCR-2070: jcr-server should respect child node definition of jcr:content

Merged revision 770255 from the 1.5 branch.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@776737 13f79535-47bb-0310-9956-ffa450edef68

-                contentNode = parentNode.addNode(JcrConstants.JCR_CONTENT, getContentNodeType());
+                // JCR-2070: Use the predefined content node type only
+                // when the underlying repository allows it to be used
+                if (parentNode.getPrimaryNodeType().canAddChildNode(
+                        JcrConstants.JCR_CONTENT, getContentNodeType())) {
+                    contentNode = parentNode.addNode(
+                            JcrConstants.JCR_CONTENT, getContentNodeType());
+                } else {
+                    contentNode = parentNode.addNode(JcrConstants.JCR_CONTENT);
+                }

INS8 INS25 INS32 MOV8 INS8 INS32 INS42 INS40 INS32 INS21 INS42 INS42 INS42 INS7 INS42 INS32 INS42 INS42 INS40