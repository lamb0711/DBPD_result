JCR-420: Avoid NullPointerExceptions when removing property values using calls like Property.setValue(null).

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@399638 13f79535-47bb-0310-9956-ffa450edef68

-            RemoteProperty property =
-                remote.setProperty(name, SerialValueFactory.makeSerialValue(value));
-            return getFactory().getProperty(getSession(), property);
+            if (value == null) {
+                remote.setProperty(name, (Value) null);
+                return null;
+            } else {
+                RemoteProperty property = remote.setProperty(
+                        name, SerialValueFactory.makeSerialValue(value));
+                return getFactory().getProperty(getSession(), property);
+            }
-            Value[] serials = SerialValueFactory.makeSerialValueArray(values);
-            RemoteProperty property = remote.setProperty(name, serials);
-            return getFactory().getProperty(getSession(), property);
+            if (values == null) {
+                remote.setProperty(name, (Value[]) null);
+                return null;
+            } else {
+                Value[] serials = SerialValueFactory.makeSerialValueArray(values);
+                RemoteProperty property = remote.setProperty(name, serials);
+                return getFactory().getProperty(getSession(), property);
+            }
-        Value[] values = new Value[strings.length];
-        for (int i = 0; i < strings.length; i++) {
-            values[i] = getSession().getValueFactory().createValue(strings[i]);
+        if (strings == null) {
+            return setProperty(name, (Value[]) null);
+        } else {
+            Value[] values = new Value[strings.length];
+            for (int i = 0; i < strings.length; i++) {
+                values[i] = getSession().getValueFactory().createValue(strings[i]);
+            }
+            return setProperty(name, values);
-        return setProperty(name, values);
-        return setProperty(name, getSession().getValueFactory().createValue(value));
+        if (value == null) {
+            return setProperty(name, (Value) null);
+        } else {
+            return setProperty(name, getSession().getValueFactory().createValue(value));
+        }
-        return setProperty(name, getSession().getValueFactory().createValue(value));
+        if (value == null) {
+            return setProperty(name, (Value) null);
+        } else {
+            return setProperty(name, getSession().getValueFactory().createValue(value));
+        }
-        return setProperty(name, getSession().getValueFactory().createValue(value));
+        if (value == null) {
+            return setProperty(name, (Value) null);
+        } else {
+            return setProperty(name, getSession().getValueFactory().createValue(value));
+        }
-        return setProperty(name, getSession().getValueFactory().createValue(value));
+        if (value == null) {
+            return setProperty(name, (Value) null);
+        } else {
+            return setProperty(name, getSession().getValueFactory().createValue(value));
+        }

INS8 INS8 INS8 INS8 INS8 INS25 INS25 INS25 INS25 INS25 INS8 INS8 INS27 INS8 MOV8 INS27 INS8 MOV8 INS27 INS8 MOV8 INS27 INS8 MOV8 INS27 INS8 MOV8 INS25 INS25 INS42 INS33 INS41 INS42 INS33 INS41 INS42 INS33 INS41 INS42 INS33 INS41 INS42 INS33 INS41 INS27 INS8 MOV8 INS27 INS8 MOV8 INS32 INS32 INS32 INS32 INS32 INS42 INS33 INS21 INS41 INS42 INS33 INS21 INS41 INS42 INS42 INS11 INS42 INS42 INS11 INS42 INS42 INS11 INS42 INS42 INS11 INS42 INS42 INS11 INS32 INS33 INS32 INS33 INS5 INS33 INS43 INS33 INS43 INS33 INS43 INS33 INS43 INS33 INS42 INS42 INS42 INS11 INS42 INS42 INS42 INS11 INS43 INS85 INS42 INS42 INS42 INS42 INS43 INS33 INS5 INS33 INS42 INS42 INS43 INS85 INS42