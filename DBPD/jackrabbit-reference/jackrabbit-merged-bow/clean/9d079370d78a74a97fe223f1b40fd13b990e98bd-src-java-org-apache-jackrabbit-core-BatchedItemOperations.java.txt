True caching in CachingHierarchyManager

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@190372 13f79535-47bb-0310-9956-ffa450edef68

+
-        // remove from old parent
-        if (!renameOnly) {
-            target.removeParentUUID(srcParent.getUUID());
-        }
-        srcParent.removeChildNodeEntry(srcName.getName(), srcNameIndex);
-        // add to new parent
-        if (!renameOnly) {
+        // remove from old parent
+        if (renameOnly) {
+            destParent.renameChildNodeEntry(srcName.getName(), srcNameIndex,
+                    destName.getName());
+        } else {
+            target.removeParentUUID(srcParent.getUUID());
+
+            destParent.addChildNodeEntry(destName.getName(), target.getUUID());
+            srcParent.removeChildNodeEntry(srcName.getName(), srcNameIndex);
-        destParent.addChildNodeEntry(destName.getName(), target.getUUID());

INS25 INS42 INS8 MOV8 INS21 MOV21 MOV21 MOV21 INS32 INS42 INS42 INS32 INS42 INS32 INS42 INS42 INS42 INS42 DEL42 DEL38 DEL8 DEL25 DEL42 DEL38 DEL25