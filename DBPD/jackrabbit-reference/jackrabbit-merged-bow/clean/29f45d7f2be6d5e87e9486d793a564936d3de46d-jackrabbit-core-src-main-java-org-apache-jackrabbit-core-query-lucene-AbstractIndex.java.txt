JCR-1884: CachingIndexReader.initializeParents() does not scale well with large indexes

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@721495 13f79535-47bb-0310-9956-ffa450edef68

+     * @param initCache if the caches in the index reader should be initialized
+     *          before the index reader is returned.
-    synchronized ReadOnlyIndexReader getReadOnlyIndexReader()
+    synchronized ReadOnlyIndexReader getReadOnlyIndexReader(boolean initCache)
-            CachingIndexReader cr = new CachingIndexReader(reader, cache);
+            CachingIndexReader cr = new CachingIndexReader(
+                    reader, cache, initCache);
+     * Returns a read-only index reader, that can be used concurrently with
+     * other threads writing to this index. The returned index reader is
+     * read-only, that is, any attempt to delete a document from the index
+     * will throw an <code>UnsupportedOperationException</code>.
+     *
+     * @return a read-only index reader.
+     * @throws IOException if an error occurs while obtaining the index reader.
+     */
+    protected ReadOnlyIndexReader getReadOnlyIndexReader()
+            throws IOException {
+        return getReadOnlyIndexReader(false);
+    }
+
+    /**

INS31 INS29 INS44 MOV29 INS83 INS43 INS42 INS43 INS8 INS65 INS65 INS65 INS65 INS39 INS42 INS42 INS42 INS41 INS66 INS66 INS66 INS66 INS42 INS66 INS66 INS66 INS42 INS66 INS32 INS42 INS9 MOV43 MOV43 INS42