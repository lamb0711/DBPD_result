JCR-1106 Add simple query method to ObjectContentManager and adapt to new ObjectIterator constructor

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@572348 13f79535-47bb-0310-9956-ffa450edef68

-                                      query.getFilter().getFilterClass(),
+    *
+    * @see org.apache.jackrabbit.ocm.manager.ObjectContentManager#getObjectIterator(String, String)
+    */
+    public Iterator getObjectIterator(String query, String language) {
+        try {
+            log.debug("Get Object with expression : " + query);
+
+            javax.jcr.query.Query jcrQuery = session.getWorkspace().getQueryManager().createQuery(query, language);
+            QueryResult queryResult = jcrQuery.execute();
+            NodeIterator nodeIterator = queryResult.getNodes();
+
+            return new ObjectIterator(nodeIterator,
+                                      this.objectConverter,
+                                      this.session);
+
+        } catch (InvalidQueryException iqe) {
+            throw new org.apache.jackrabbit.ocm.exception.InvalidQueryException(iqe);
+        } catch (RepositoryException re) {
+            throw new ObjectContentManagerException(re.getMessage(), re);
+        }
+    }
+    
+    /**

INS31 INS29 INS83 INS43 INS42 INS44 INS44 INS8 INS65 INS42 INS43 INS42 INS43 INS42 INS54 INS68 INS42 INS42 INS8 INS12 INS12 INS40 INS42 INS69 INS69 INS21 INS60 INS60 INS60 INS41 INS44 INS8 INS44 INS8 INS43 INS43 INS32 INS43 INS59 INS43 INS59 INS43 INS59 INS14 INS43 INS42 INS53 INS43 INS42 INS53 INS42 INS42 INS42 INS42 INS27 INS40 INS42 INS32 INS42 INS42 INS32 INS42 INS42 INS32 INS43 INS42 INS22 INS22 INS42 INS14 INS42 INS14 INS45 INS42 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS52 INS42 INS52 INS42 INS43 INS42 INS43 INS32 INS42 INS32 INS42 INS40 INS42 INS42 INS42 INS42 INS42 DEL42 DEL42 DEL32 DEL42 DEL32