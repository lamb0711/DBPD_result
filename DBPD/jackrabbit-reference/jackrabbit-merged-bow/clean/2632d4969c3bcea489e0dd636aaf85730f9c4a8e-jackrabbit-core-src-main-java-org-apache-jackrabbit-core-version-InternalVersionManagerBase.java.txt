JCR-3115: Versioning fixup leaves persistence in a state where the node can't be made versionable again

Extend checker so that it gets the same VersionHistoryInfo object that other code gets when versioning gets enabled again.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1186802 13f79535-47bb-0310-9956-ffa450edef68

-     * {@inheritDoc}
+     * Returns information about the version history of the specified node
+     * or <code>null</code> when unavailable.
+     *
+     * @param vNode node whose version history should be returned
+     * @return identifiers of the version history and root version nodes
+     * @throws RepositoryException if an error occurs
-    public VersionHistoryInfo getVersionHistory(Session session, NodeState node,
-                                                NodeId copiedFrom)
-            throws RepositoryException {
+    public VersionHistoryInfo getVersionHistoryInfoForNode(NodeState node) throws RepositoryException {
+        return info;
+    }
+
+    /**
+     * {@inheritDoc}
+     */
+    public VersionHistoryInfo getVersionHistory(Session session, NodeState node,
+                                                NodeId copiedFrom)
+            throws RepositoryException {
+        VersionHistoryInfo info = getVersionHistoryInfoForNode(node);
+

INS31 INS29 UPD42 MOV29 INS83 INS43 INS42 MOV44 INS44 MOV44 INS43 INS8 INS65 INS65 INS65 INS65 INS42 INS43 INS42 INS42 INS60 MOV25 INS41 INS66 INS66 INS42 INS66 INS66 INS42 INS66 INS42 INS43 INS59 INS42 INS42 INS42 INS32 INS42 INS42