simple-server needs workspace name (see changes rev. 331281) -> adjusting index.jsp

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@350222 13f79535-47bb-0310-9956-ffa450edef68

+import javax.servlet.ServletContext;
-    public static final String INIT_PARAM_PREFIX = "resource-path-prefix";
+    public static final String INIT_PARAM_RESOURCE_PATH_PREFIX = "resource-path-prefix";
+    /**
+     * Servlet context attribute used to store the path prefix instead of
+     * having a static field with this servlet. The latter causes problems
+     * when running multiple
+     */
+    public static final String CTX_ATTR_RESOURCE_PATH_PREFIX = "jackrabbit.webdav.jcr.resourcepath";
+
-	pathPrefix = getInitParameter(INIT_PARAM_PREFIX);
-	log.debug(INIT_PARAM_PREFIX + " = " + pathPrefix);
+        pathPrefix = getInitParameter(INIT_PARAM_RESOURCE_PATH_PREFIX);
+        getServletContext().setAttribute(CTX_ATTR_RESOURCE_PATH_PREFIX, pathPrefix);
+        log.debug(INIT_PARAM_RESOURCE_PATH_PREFIX + " = " + pathPrefix);
+
+    /**
+     * Returns the configured path prefix
+     *
+     * @return resourcePathPrefix
+     * @see #INIT_PARAM_RESOURCE_PATH_PREFIX
+     */
+    public static String getPathPrefix(ServletContext ctx) {
+        return (String) ctx.getAttribute(CTX_ATTR_RESOURCE_PATH_PREFIX);
+    }

INS26 INS40 INS23 INS31 INS29 INS83 INS83 INS83 INS43 INS59 INS29 INS83 INS83 INS43 INS42 INS44 INS8 UPD42 INS65 INS42 INS42 INS45 INS21 INS65 INS65 INS65 INS42 INS43 INS42 INS41 INS66 INS66 INS66 INS32 INS66 INS66 INS67 INS42 INS11 INS32 INS42 INS42 INS42 INS42 INS43 INS32 UPD42 INS42 UPD42 INS42 INS42 INS42 INS42