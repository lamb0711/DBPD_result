Minor query format fixes
- XPath: element test not used for node type query node
- SQL: format may produce invalid statement
- JCRSQL parser: create node type query node as direct child of location step node

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@504476 13f79535-47bb-0310-9956-ffa450edef68

-            String and = "";
+            // are there any relevant predicates?
-                if (i == 0) {
+                if (predicates[i].getType() != QueryNode.TYPE_NODETYPE) {
-                tmp.append(and);
+            }
+            String and = "";
+            for (int i = 0; i < predicates.length; i++) {
+                if (predicates[i].getType() != QueryNode.TYPE_NODETYPE) {
+                    tmp.append(and);
+                    and = " AND ";
+                }
-                and = " AND ";
+            } else if (steps.length == 1
+                    && steps[0].getIncludeDescendants()
+                    && steps[0].getNameTest() == null) {
+                // then this query selects all paths

INS24 INS58 INS27 INS37 INS8 INS8 INS25 INS39 INS59 INS42 INS40 INS42 MOV25 INS25 INS27 MOV8 MOV8 INS42 INS34 UPD27 INS27 INS8 INS27 INS27 INS32 INS40 INS32 INS40 MOV21 MOV21 INS27 INS32 INS32 INS33 INS2 INS42 INS2 INS42 INS40 INS34 INS2 INS42 INS2 INS42 INS42 INS42 INS42 INS42 INS42 INS34 INS42 INS34 DEL42 DEL34