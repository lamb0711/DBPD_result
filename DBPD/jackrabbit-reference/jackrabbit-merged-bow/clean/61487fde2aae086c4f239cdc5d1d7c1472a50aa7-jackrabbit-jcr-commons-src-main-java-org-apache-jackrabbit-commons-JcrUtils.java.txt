JCR-2120: java.lang.Iterable support for RangeIterators

Added methods for getting Iterables out of query results.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@776654 13f79535-47bb-0310-9956-ffa450edef68

+import javax.jcr.query.QueryResult;
+import javax.jcr.query.Row;
+    /**
+     * Returns the nodes in the given query result as an {@link Iterable}
+     * for use in a Java 5 for-each loop. The return value encapsulates
+     * the {@link QueryResult#getNodes()} method call. Potential
+     * {@link RepositoryException}s are converted to {@link RuntimeException}s.
+     *
+     * @param result query result
+     * @return nodes in the query result
+     */
+    public static Iterable<Node> getNodes(final QueryResult result) {
+        return new Iterable<Node>() {
+            @SuppressWarnings("unchecked")
+            public Iterator<Node> iterator() {
+                try {
+                    return result.getNodes();
+                } catch (RepositoryException e) {
+                    throw new RuntimeException(
+                            "Unable to access nodes in " + result, e);
+                }
+            }
+        };
+    }
+
+    /**
+     * Returns the rows in the given query result as an {@link Iterable}
+     * for use in a Java 5 for-each loop. The return value encapsulates
+     * the {@link QueryResult#getRows()} method call. Potential
+     * {@link RepositoryException}s are converted to {@link RuntimeException}s.
+     *
+     * @param result query result
+     * @return rows in the query result
+     */
+    public static Iterable<Row> getRows(final QueryResult result) {
+        return new Iterable<Row>() {
+            @SuppressWarnings("unchecked")
+            public Iterator<Row> iterator() {
+                try {
+                    return result.getRows();
+                } catch (RepositoryException e) {
+                    throw new RuntimeException(
+                            "Unable to access rows in " + result, e);
+                }
+            }
+        };
+    }
+

INS26 INS26 INS40 INS40 INS31 INS31 INS29 INS83 INS83 INS74 INS42 INS44 INS8 INS29 INS83 INS83 INS74 INS42 INS44 INS8 INS65 INS65 INS65 INS43 INS43 INS83 INS43 INS42 INS41 INS65 INS65 INS65 INS43 INS43 INS83 INS43 INS42 INS41 INS66 INS65 INS66 INS66 INS65 INS66 INS65 INS66 INS65 INS66 INS42 INS66 INS66 INS42 INS42 INS42 INS14 INS66 INS65 INS66 INS66 INS65 INS66 INS65 INS66 INS65 INS66 INS42 INS66 INS66 INS42 INS42 INS42 INS14 INS42 INS68 INS42 INS42 INS74 INS1 INS42 INS68 INS42 INS42 INS74 INS1 INS42 INS42 INS43 INS43 INS31 INS42 INS42 INS43 INS43 INS31 INS42 INS42 INS79 INS83 INS74 INS42 INS8 INS42 INS42 INS79 INS83 INS74 INS42 INS8 INS42 INS45 INS43 INS43 INS54 INS42 INS45 INS43 INS43 INS54 INS42 INS42 INS8 INS12 INS42 INS42 INS8 INS12 INS41 INS44 INS8 INS41 INS44 INS8 INS32 INS43 INS42 INS53 INS32 INS43 INS42 INS53 INS42 INS42 INS42 INS14 INS42 INS42 INS42 INS14 INS43 INS27 INS42 INS43 INS27 INS42 INS42 INS45 INS42 INS42 INS45 INS42