JCR-725: Enabled runtime configuration of cache size with a patch from Jaka Jaksic. Thanks!

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@529894 13f79535-47bb-0310-9956-ffa450edef68

-    /** The amount of memory to distribute accross the caches. */
-    private static final long MAX_MEMORY = 16 * 1024 * 1024;
+    /** The default maximum amount of memory to distribute accross the caches. */
+    private static final long DEFAULT_MAX_MEMORY = 16 * 1024 * 1024;
-    /** The minimum size of a cache. */
-    private static final long MIN_MEMORY_PER_CACHE = 128 * 1024;
+    /** The default minimum size of a cache. */
+    private static final long DEFAULT_MIN_MEMORY_PER_CACHE = 128 * 1024;
-    /** The maximum memory per cache (unless, there is some unused memory). */
-    private static final long MAX_MEMORY_PER_CACHE = 4 * 1024 * 1024;
+    /** The default maximum memory per cache. */
+    private static final long DEFAULT_MAX_MEMORY_PER_CACHE = 4 * 1024 * 1024;
+    /** The amount of memory to distribute accross the caches. */
+    private long maxMemory = DEFAULT_MAX_MEMORY;
+
+    /** The minimum size of a cache. */
+    private long minMemoryPerCache = DEFAULT_MIN_MEMORY_PER_CACHE;
+
+    /** The maximum memory per cache (unless, there is some unused memory). */
+    private long maxMemoryPerCache = DEFAULT_MAX_MEMORY_PER_CACHE;
+
+    
+    public long getMaxMemory() {
+        return maxMemory;
+    }
+
+    public void setMaxMemory(final long maxMemory) {
+        this.maxMemory = maxMemory;
+    }
+
+    public long getMaxMemoryPerCache() {
+        return maxMemoryPerCache;
+    }
+
+    public void setMaxMemoryPerCache(final long maxMemoryPerCache) {
+        this.maxMemoryPerCache = maxMemoryPerCache;
+    }
+
+    public long getMinMemoryPerCache() {
+        return minMemoryPerCache;
+    }
+
+    public void setMinMemoryPerCache(final long minMemoryPerCache) {
+        this.minMemoryPerCache = minMemoryPerCache;
+    }
+    
+
-        double memoryPerAccess = (double) MAX_MEMORY / 2.
+        double memoryPerAccess = (double) maxMemory / 2.
-        double memoryPerUsed = (double) MAX_MEMORY / 2.
+        double memoryPerUsed = (double) maxMemory / 2.
-            mem = Math.min(mem, MAX_MEMORY_PER_CACHE);
+            mem = Math.min(mem, maxMemoryPerCache);
-            mem = Math.min(mem, MAX_MEMORY_PER_CACHE);
-            mem = Math.max(mem, MIN_MEMORY_PER_CACHE);
+            mem = Math.min(mem, maxMemoryPerCache);
+            mem = Math.max(mem, minMemoryPerCache);
-        long unusedMemory = MAX_MEMORY;
+        long unusedMemory = maxMemory;

INS23 INS23 INS23 INS31 INS31 INS31 INS31 INS31 INS31 INS29 INS29 INS29 MOV29 INS83 INS39 INS59 MOV29 INS83 INS39 INS59 MOV29 INS83 INS39 INS59 INS83 INS39 INS42 INS8 INS83 INS39 INS42 INS44 INS8 INS83 INS39 INS42 INS8 INS83 INS39 INS42 INS44 INS8 INS83 INS39 INS42 INS8 INS83 INS39 INS42 INS44 INS8 INS65 UPD42 INS65 UPD42 INS65 UPD42 INS42 INS42 INS42 INS42 INS42 INS42 INS41 INS83 INS39 INS42 INS21 INS41 INS83 INS39 INS42 INS21 INS41 INS83 INS39 INS42 INS21 INS66 INS66 INS66 INS42 INS7 INS42 INS7 INS42 INS7 INS22 INS42 INS22 INS42 INS22 INS42 UPD42 INS52 INS42 INS52 INS42 INS52 INS42 UPD42 UPD42 UPD42 UPD42 UPD42