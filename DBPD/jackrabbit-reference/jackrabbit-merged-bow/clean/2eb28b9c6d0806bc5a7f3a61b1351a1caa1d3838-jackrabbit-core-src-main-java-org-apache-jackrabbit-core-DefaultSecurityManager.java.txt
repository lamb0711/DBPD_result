JCR-2199: Improvements to user management

- change content structure to allow for fast lookup by ID
- groupID: unescaped before being exposed in the API.
- adjust defautl ac-provider on the security workspace according to the new structure
- same for impl tests
- extend security config. user mgr impl defines a couple of config options

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@794702 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.config.BeanConfig;
-    // TODO: should rather be placed in the core.security package. However protected access to SystemSession required to move here.
-    protected UserManagerImpl createUserManager(SessionImpl session)
-            throws RepositoryException {
-
-        return new UserManagerImpl(session, adminId);
+    protected UserManagerImpl createUserManager(SessionImpl session) throws RepositoryException {
+        BeanConfig umc = repository.getConfig().getSecurityConfig().getSecurityManagerConfig().getUserManagerConfig();
+        Properties config = null;
+        if (umc != null) {
+            // TODO: deal with other umgr implementations.
+            String clName = umc.getClassName();
+            if (clName != null && !(UserManagerImpl.class.getName().equals(clName) || clName.length() == 0)) {
+                log.warn("Unsupported custom UserManager implementation: '" + clName + "' -> Ignored.");
+            }
+            config = umc.getParameters();
+        }
+        return new UserManagerImpl(session, adminId, config);

INS26 INS40 INS60 INS60 INS25 INS43 INS59 INS43 INS59 INS27 INS8 INS42 INS42 INS32 INS42 INS42 INS33 INS42 INS33 INS60 INS25 INS21 INS43 INS42 INS32 INS42 INS43 INS59 INS27 INS8 INS7 INS42 INS32 INS42 INS42 INS42 INS32 INS27 INS38 INS21 INS42 INS32 INS32 INS42 INS42 INS42 INS42 INS33 INS36 INS32 INS42 INS42 INS42 INS42 INS27 INS42 INS42 INS27 INS32 INS27 INS45 INS42 INS45 INS32 INS42 INS42 INS32 INS34 INS57 INS42 INS42 INS42 MOV43