JCR-789: treat index 0 and 1 as equal in equals() and hashCode()


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@529332 13f79535-47bb-0310-9956-ffa450edef68

-            // @todo treat index==0 as index==1?
-            h = 37 * h + index;
+            h = 37 * h + normalizeIndex(index);
-                        // @todo treat index==0 as index==1?
-                        && index == other.index;
+                        && normalizeIndex(index) == normalizeIndex(other.index);
+         * Normalizes index value {@link Path#INDEX_UNDEFINED} to
+         * {@link Path#INDEX_DEFAULT} for {@link #equals(Object)} and
+         * {@link #hashCode()}.
+         * @param index
+         * @return normalized index
+         */
+        private int normalizeIndex(int index) {
+            return index == Path.INDEX_UNDEFINED ? Path.INDEX_DEFAULT : index;
+        }
+      
+        /**

INS31 INS29 INS83 INS39 INS42 INS44 INS8 INS65 INS65 INS65 INS39 INS42 INS41 INS66 INS65 INS66 INS65 INS66 INS65 INS66 INS65 INS66 INS42 INS66 INS16 INS67 INS67 INS68 INS68 INS27 INS40 INS42 INS32 INS42 INS42 INS42 INS42 INS42 INS69 INS42 INS42 INS40 INS42 INS42 INS43 INS32 INS32 INS42 INS42 INS42 INS42 INS40 DEL42 DEL42 DEL40