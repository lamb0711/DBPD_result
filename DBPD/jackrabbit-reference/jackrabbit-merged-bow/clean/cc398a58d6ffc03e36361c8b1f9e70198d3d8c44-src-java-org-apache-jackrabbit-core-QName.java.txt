Path & QName: avoid unneccessary object creation 
SharedItemStateManager: added debug output in store() method

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@178643 13f79535-47bb-0310-9956-ffa450edef68

-     * @throws NoPrefixDeclaredException if the namespace fails to resolve
+     * @throws NoPrefixDeclaredException if the namespace can not be resolved
-    public String toJCRName(NamespaceResolver resolver) throws NoPrefixDeclaredException {
+    public String toJCRName(NamespaceResolver resolver)
+            throws NoPrefixDeclaredException {
+        toJCRName(resolver, sb);
+        return sb.toString();
+    }
+
+    /**
+     * Appends the qualified name in the prefixed JCR name format to the given
+     * string buffer. The namespace URI is mapped to a prefix using the given
+     * namespace resolver.
+     *
+     * @param resolver namespace resolver
+     * @param buf      string buffer where the prefixed JCR name should be
+     *                 appended to
+     * @throws NoPrefixDeclaredException if the namespace can not be resolved
+     * @see #toJCRName(NamespaceResolver)
+     */
+    public void toJCRName(NamespaceResolver resolver, StringBuffer buf)
+            throws NoPrefixDeclaredException {
-            throw new NoPrefixDeclaredException("no prefix declared for URI: " + namespaceURI);
+            throw new NoPrefixDeclaredException("no prefix declared for URI: "
+                    + namespaceURI);
-            sb.append(prefix);
-            sb.append(':');
+            buf.append(prefix);
+            buf.append(':');
-        sb.append(localName);
-        return sb.toString();
+        buf.append(localName);

INS31 MOV29 INS83 MOV43 INS42 INS44 INS43 INS8 INS29 INS39 INS44 INS43 INS42 INS42 MOV60 INS21 MOV41 INS65 INS65 INS65 INS65 INS65 INS43 INS42 UPD66 INS42 INS32 INS66 INS66 INS66 INS42 INS66 INS42 INS66 INS66 INS42 INS66 INS68 INS42 INS42 INS42 INS42 INS42 INS69 UPD42 INS43 INS42 UPD42 UPD42