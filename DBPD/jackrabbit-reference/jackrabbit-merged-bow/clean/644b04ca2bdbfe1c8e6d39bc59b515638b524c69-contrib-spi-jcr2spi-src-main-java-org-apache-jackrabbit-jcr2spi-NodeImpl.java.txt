work in progress

- RepositoryService.lock -> add return value
- Merge-Operation, VersionManager: merge returns failed-Ids
- LockManager: lock returns lockInfo
- javadoc, todos

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@478581 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.spi.NodeId;
+import org.apache.jackrabbit.spi.IdIterator;
+import org.apache.jackrabbit.spi.ItemId;
-import java.util.Iterator;
-        Collection failedIds = session.getVersionManager().merge(getNodeState(), srcWorkspace, bestEffort);
-        if (failedIds.isEmpty()) {
+        IdIterator failedIds = session.getVersionManager().merge(getNodeState(), srcWorkspace, bestEffort);
+        if (failedIds.getSize() == 0) {
-            Iterator it = failedIds.iterator();
-            while (it.hasNext()) {
+            while (failedIds.hasNext()) {
-                    ItemState state = session.getItemStateManager().getItemState((NodeId) it.next());
+                    ItemId id = failedIds.nextId();
+                    ItemState state = session.getItemStateManager().getItemState(id);
-            return new LazyItemIterator(itemMgr, failedStates);
+            if (failedStates.isEmpty()) {
+                return IteratorHelper.EMPTY;
+            } else {
+                return new LazyItemIterator(itemMgr, failedStates);
+            }

MOV26 UPD40 UPD40 UPD43 INS27 UPD42 INS32 INS34 INS25 MOV42 UPD42 MOV42 INS32 INS8 INS8 UPD42 UPD42 MOV42 UPD42 MOV42 INS41 MOV41 INS40 INS60 INS43 INS59 INS42 INS42 INS32 INS42 INS42 UPD42 MOV42 DEL32 DEL42 DEL43 DEL42 DEL32 DEL59 DEL60 DEL42 DEL43 DEL42 DEL32 DEL11