JCR-3641 : provide ability to create JackrabbitAccessControlEntry with multi-valued restrictions

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1537546 13f79535-47bb-0310-9956-ffa450edef68

+import java.security.Principal;
+import java.util.Map;
-import javax.jcr.Value;
+import javax.jcr.Value;
+import javax.jcr.security.AccessControlEntry;
-import javax.jcr.security.AccessControlEntry;
-import java.security.Principal;
-import java.util.Map;
+     * Adds an access control entry to this policy consisting of the specified
+     * <code>principal</code>, the specified <code>privileges</code>, the
+     * <code>isAllow</code> flag and an optional map containing additional
+     * restrictions.
+     * <p/>
+     * This method returns <code>true</code> if this policy was modified,
+     * <code>false</code> otherwise.
+     * <p/>
+     * An <code>AccessControlException</code> is thrown if any of the specified
+     * parameters is invalid or if some other access control related exception occurs.
+     *
+     * @param principal the principal to add the entry for
+     * @param privileges the privileges to add
+     * @param isAllow if <code>true</code> if this is a positive (allow) entry
+     * @param restrictions A map of additional restrictions used to narrow the
+     * effect of the entry to be created. The map must map JCR names to a single
+     * {@link javax.jcr.Value} object.
+     * @param restrictions A map of additional multivalued restrictions used to narrow the
+     * effect of the entry to be created. The map must map JCR names to a
+     * {@link javax.jcr.Value} array.
+     * @return true if this policy has changed by incorporating the given entry;
+     * false otherwise.
+     * @throws AccessControlException If any of the given parameter is invalid
+     * or cannot be handled by the implementation.
+     * @throws RepositoryException If another error occurs.
+     * @see AccessControlList#addAccessControlEntry(Principal, Privilege[])
+     */
+    boolean addEntry(Principal principal, Privilege[] privileges,
+                     boolean isAllow, Map<String, Value> restrictions,
+                     Map<String, Value[]> mvRestrictions)
+            throws AccessControlException, RepositoryException;
+
+    /**

MOV26 MOV26 MOV26 MOV26 INS31 INS29 INS39 INS42 INS44 INS44 INS44 INS44 INS44 INS43 INS43 INS65 INS65 INS65 INS65 INS65 INS65 INS65 INS65 INS65 INS65 INS43 INS42 INS5 INS42 INS39 INS42 INS74 INS42 INS74 INS42 INS42 INS42 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS42 INS66 INS42 INS66 INS42 INS66 INS42 INS66 INS66 INS65 INS66 INS42 INS66 INS66 INS65 INS66 INS66 INS66 INS42 INS66 INS66 INS42 INS66 INS68 INS42 INS43 INS85 INS43 INS43 INS43 INS43 INS43 INS5 INS40 INS40 INS42 INS42 INS69 INS69 INS42 INS42 INS42 INS42 INS42 INS42 INS43 INS85 INS43 INS5 INS42 INS42 INS43 INS85 INS42