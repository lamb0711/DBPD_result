JCR-327: Mixins as supertypes do not appear to be queryable
- also search for mixins that extend the mixin of the element test

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@381292 13f79535-47bb-0310-9956-ffa450edef68

-                // only interested in types that can be used to create nodes
-                if (nt.isMixin()) {
-                    continue;
-                }
-                    Term t = new Term(FieldNames.PROPERTIES,
-                            FieldNames.createNamedValue(primaryTypeField, ntName));
+                    Term t;
+                    if (nt.isMixin()) {
+                        // search on jcr:mixinTypes
+                        t = new Term(FieldNames.PROPERTIES,
+                                FieldNames.createNamedValue(mixinTypesField, ntName));
+                    } else {
+                        // search on jcr:primaryType
+                        t = new Term(FieldNames.PROPERTIES,
+                                FieldNames.createNamedValue(primaryTypeField, ntName));
+                    }

INS25 INS43 MOV32 INS8 INS8 INS42 INS21 INS21 INS7 INS7 INS42 INS14 INS42 MOV14 MOV43 INS40 INS32 INS42 INS42 INS42 INS42 DEL18 DEL8 DEL25