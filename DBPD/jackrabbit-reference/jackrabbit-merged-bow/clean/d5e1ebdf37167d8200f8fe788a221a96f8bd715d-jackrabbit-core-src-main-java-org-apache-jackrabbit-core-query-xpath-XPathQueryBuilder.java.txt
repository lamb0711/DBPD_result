JCR-906: Introduce similarity function
- initial version which uses a copy of the class MoreLikeThis from the lucene similar contrib.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@536515 13f79535-47bb-0310-9956-ffa450edef68

+     * QName for rep:similar
+     */
+    static final QName REP_SIMILAR = new QName(QName.NS_REP_URI, "similar");
+
+    /**
+            } else if (NameFormat.format(REP_SIMILAR, resolver).equals(fName)) {
+                if (node.jjtGetNumChildren() == 2) {
+                    if (queryNode instanceof NAryQueryNode) {
+                        NAryQueryNode parent = (NAryQueryNode) queryNode;
+                        RelationQueryNode rel = new RelationQueryNode(
+                                parent, RelationQueryNode.OPERATION_SIMILAR);
+                        parent.addOperand(rel);
+                        // get path string
+                        node.jjtGetChild(1).jjtAccept(this, rel);
+                        // check if string is set
+                        if (rel.getStringValue() == null) {
+                            exceptions.add(new InvalidQueryException(
+                                    "Argument for rep:similar() must be of type string"));
+                        }
+                    } else {
+                        exceptions.add(new InvalidQueryException(
+                                "Unsupported location for rep:similar()"));
+                    }
+                } else {
+                    exceptions.add(new InvalidQueryException(
+                            "Wrong number of arguments for rep:similar()"));
+                }

INS23 INS29 INS83 INS83 INS43 INS59 INS65 INS42 INS42 INS14 INS66 INS43 INS40 INS45 INS42 INS25 INS32 INS8 MOV25 INS32 INS42 INS42 INS25 INS42 INS42 INS42 INS42 INS27 INS8 INS8 INS32 INS34 INS25 INS21 INS42 INS42 INS62 INS8 INS8 INS32 INS42 INS43 INS60 INS60 INS21 INS21 INS25 INS21 INS42 INS42 INS14 INS42 INS43 INS59 INS43 INS59 INS32 INS32 INS27 INS8 INS32 INS43 INS45 INS42 INS42 INS11 INS42 INS42 INS14 INS42 INS42 INS42 INS32 INS42 INS52 INS42 INS32 INS33 INS21 INS42 INS42 INS14 INS42 INS43 INS42 INS43 INS42 INS40 INS42 INS42 INS34 INS42 INS42 INS32 INS43 INS45 INS42 INS42 INS42 INS42 INS14 INS42 INS43 INS45 INS42