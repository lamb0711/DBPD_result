JCR-1474 consistency check fails with derbypm


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@649733 13f79535-47bb-0310-9956-ffa450edef68

-     * @param id the nodeid for the new budle
+     * @param id the node id for the new bundle
-            log.info("Serialzation Version: " + version);
-            log.info("NodeTypeName: " + nodeTypeName);
+            log.debug("Serialzation Version: " + version);
+            log.debug("NodeTypeName: " + nodeTypeName);
-            log.info("ParentUUID: " + parentUuid);
+            log.debug("ParentUUID: " + parentUuid);
-            log.info("DefinitionId: " + definitionId);
+            log.debug("DefinitionId: " + definitionId);
-                log.info("MixinTypeName: " + mixinName);
+                log.debug("MixinTypeName: " + mixinName);
-                log.info("PropertyName: " + propName);
+                log.debug("PropertyName: " + propName);
-            log.info("hasUUID: " + hasUUID);
+            log.debug("hasUUID: " + hasUUID);
-                log.info("ChildNodentry: " + cneUUID + ":" + cneName);
+                log.debug("ChildNodentry: " + cneUUID + ":" + cneName);
-                log.info("modCount: " + modCount);
+                log.debug("modCount: " + modCount);
-     * @param id the property id for the new propert entry
+     * @param id the property id for the new property entry
-            log.info("  PropertyType: " + PropertyType.nameFromValue(type));
-            log.info("  ModCount: " + modCount);
+            log.debug("  PropertyType: " + PropertyType.nameFromValue(type));
+            log.debug("  ModCount: " + modCount);
-            log.info("  MultiValued: " + isMV);
+            log.debug("  MultiValued: " + isMV);
-            log.info("  DefinitionId: " + defintionId);
+            log.debug("  DefinitionId: " + defintionId);
-            log.info("  num values: " + count);
+            log.debug("  num values: " + count);
-                        log.info("  binary size: " + size);
+                        log.debug("  binary size: " + size);
-                            log.info("  global data store id: " + s);
+                            // truncate log output
+                            if (s.length() > 80) {
+                                s = s.substring(80) + "...";
+                            }
+                            log.debug("  global data store id: " + s);
-                            log.info("  blobid: " + s);
+                            log.debug("  blobid: " + s);
-                            log.info("  binary: " + data.length + " bytes");
+                            log.debug("  binary: " + data.length + " bytes");
-                        log.info("  double: " + d);
+                        log.debug("  double: " + d);
-                        log.info("  long: " + l);
+                        log.debug("  long: " + l);
-                        log.info("  boolean: " + b);
+                        log.debug("  boolean: " + b);
-                        log.info("  name: " + name);
+                        log.debug("  name: " + name);
-                        log.info("  reference: " + uuid);
+                        log.debug("  reference: " + uuid);
-                        log.info("  size of string value: " + len);
+                        log.debug("  size of string value: " + len);
-                        log.info("  string: " + new String(bytes, "UTF-8"));
+                        String s = new String(bytes, "UTF-8");
+                        // truncate log output
+                        if (s.length() > 80) {
+                            s = s.substring(80) + "...";
+                        }
+                        log.debug("  string: " + s);
-                    out.writeInt(bytes.length); // lenght of byte[]
+                    out.writeInt(bytes.length); // length of byte[]

UPD66 UPD66 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 INS60 INS25 UPD42 UPD42 UPD42 UPD42 INS43 INS59 INS27 INS8 UPD42 INS25 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 INS42 INS42 MOV14 INS32 INS34 INS21 UPD42 INS27 INS8 INS42 INS42 INS7 INS42 INS32 INS34 INS21 UPD42 INS42 INS27 INS42 INS42 INS7 UPD42 UPD42 INS32 INS45 INS42 INS27 INS42 INS42 INS34 INS32 INS45 INS42 INS42 INS34