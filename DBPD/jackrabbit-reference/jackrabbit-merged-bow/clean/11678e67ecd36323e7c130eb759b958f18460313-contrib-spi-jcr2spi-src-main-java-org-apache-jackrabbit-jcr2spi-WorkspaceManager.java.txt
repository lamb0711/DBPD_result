- remove cachebehaviour flag from ChangeLog.persisted
- minor improvement

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@521356 13f79535-47bb-0310-9956-ffa450edef68

-    // TODO: review
-            // TODO: remove parameter CacheBehaviour
-            changes.persisted(CacheBehaviour.INVALIDATE);
+            changes.persisted();
-    public void dispose() {
-        if (changeFeed != null) {
-            changeFeed.interrupt();
-        }
-        hierarchyManager.dispose();
+    public synchronized void dispose() {
+            updateSync.acquire();
+            if (changeFeed != null) {
+                changeFeed.interrupt();
+            }
+            hierarchyManager.dispose();
-        } catch (RepositoryException e) {
-            log.warn("Exception while disposing session info: " + e);
+        } catch (Exception e) {
+            log.warn("Exception while disposing WorkspaceManager: " + e);
+        } finally {
+            updateSync.release();
-    public boolean isGranted(NodeState parentState, Path relPath, String[] actions) throws ItemNotFoundException, RepositoryException {
-        // TODO: correct?
+    public boolean isGranted(NodeState parentState, Path relPath, String[] actions)
+            throws ItemNotFoundException, RepositoryException {
-
-                log.debug("IsLocal:  {}", new Boolean(eventBundles[i].isLocal()));
+                log.debug("IsLocal:  {}", Boolean.valueOf(eventBundles[i].isLocal()));

INS83 INS8 INS54 MOV8 INS12 INS8 MOV21 MOV21 INS44 INS8 INS21 INS43 INS42 INS21 INS32 UPD42 INS42 INS42 INS32 INS42 INS42 INS42 INS42 INS27 INS32 INS45 INS42 INS42 INS42 INS45 MOV32 UPD42 UPD42 MOV32 DEL40 DEL42 DEL45 DEL42 DEL27 DEL8 DEL42 DEL43 DEL42 DEL44 DEL8 DEL12 DEL54 DEL45 DEL42 DEL43 DEL14