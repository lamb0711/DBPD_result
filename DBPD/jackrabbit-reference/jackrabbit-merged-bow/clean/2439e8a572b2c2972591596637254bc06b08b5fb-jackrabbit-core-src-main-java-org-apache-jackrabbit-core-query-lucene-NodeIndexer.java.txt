JCR-677: Do not fulltext index jcr:uuid property

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@487585 13f79535-47bb-0310-9956-ffa450edef68

-                addStringValue(doc, fieldName, internalValue);
+                // do not fulltext index jcr:uuid String
+                boolean tokenize = !name.equals(QName.JCR_UUID);
+                addStringValue(doc, fieldName, internalValue, tokenize);
+     * @deprecated Use {@link #addStringValue(Document, String, Object, boolean)
+     *             addStringValue(Document, String, Object, boolean)} instead.
+        addStringValue(doc, fieldName, internalValue, true);
+    }
+
+    /**
+     * Adds the string value to the document both as the named field and
+     * optionally for full text indexing if <code>tokenized</code> is
+     * <code>true</code>.
+     *
+     * @param doc           The document to which to add the field
+     * @param fieldName     The name of the field to add
+     * @param internalValue The value for the field to add to the document.
+     * @param tokenized     If <code>true</code> the string is also tokenized
+     *                      and fulltext indexed.
+     */
+    protected void addStringValue(Document doc, String fieldName, Object internalValue, boolean tokenized) {
-        // also create fulltext index of this value
-        doc.add(new Field(FieldNames.FULLTEXT,
-                stringValue,
-                Field.Store.NO,
-                Field.Index.TOKENIZED,
-                Field.TermVector.NO));
-        // create fulltext index on property
-        int idx = fieldName.indexOf(':');
-        fieldName = fieldName.substring(0, idx + 1)
-                + FieldNames.FULLTEXT_PREFIX + fieldName.substring(idx + 1);
-        doc.add(new Field(fieldName, stringValue,
-                Field.Store.NO,
-                Field.Index.TOKENIZED,
-                Field.TermVector.NO));
+        if (tokenized) {
+            // also create fulltext index of this value
+            doc.add(new Field(FieldNames.FULLTEXT,
+                    stringValue,
+                    Field.Store.NO,
+                    Field.Index.TOKENIZED,
+                    Field.TermVector.NO));
+            // create fulltext index on property
+            int idx = fieldName.indexOf(':');
+            fieldName = fieldName.substring(0, idx + 1)
+                    + FieldNames.FULLTEXT_PREFIX + fieldName.substring(idx + 1);
+            doc.add(new Field(fieldName, stringValue,
+                    Field.Store.NO,
+                    Field.Index.TOKENIZED,
+                    Field.TermVector.NO));
+        }

INS31 MOV29 INS83 INS39 INS42 INS44 INS44 INS44 INS8 INS29 INS44 INS65 INS43 INS42 INS43 INS42 INS43 INS42 INS21 INS65 INS65 INS65 INS65 INS65 INS39 INS42 INS25 INS60 INS66 INS65 INS66 INS42 INS42 INS42 INS32 INS66 INS66 INS66 INS42 INS66 INS42 INS66 INS42 INS66 INS42 INS66 INS66 INS42 INS8 INS39 INS59 INS68 INS66 INS42 INS42 INS42 INS42 INS9 MOV21 MOV60 MOV21 MOV21 INS42 INS38 INS42 INS42 INS69 INS69 INS69 INS69 INS32 INS43 INS43 INS43 INS39 INS42 INS42 INS40 INS42 INS42 INS42