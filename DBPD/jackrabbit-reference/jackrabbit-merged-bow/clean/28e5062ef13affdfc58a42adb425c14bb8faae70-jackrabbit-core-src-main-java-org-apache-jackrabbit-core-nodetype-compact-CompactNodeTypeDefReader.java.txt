JCR-1104: JSR 283 support

- use valuefactory that supports 283 features

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@782921 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.value.InternalValueFactory;
+import org.apache.jackrabbit.spi.QValueFactory;
+import org.apache.jackrabbit.spi.commons.value.ValueFactoryQImpl;
+import org.apache.jackrabbit.spi.commons.value.ValueFormat;
-import org.apache.jackrabbit.value.ValueFactoryImpl;
-    private NamespaceMapping nsMapping;
+    private final NamespaceMapping nsMapping;
-    private NamePathResolver resolver;
+    private final NamePathResolver resolver;
+
+    /**
+     * Value factory
+     */
+    private final ValueFactory valueFactory;
+
+    /**
+     * Factory for InternalValue(s)
+     */
+    private final QValueFactory qValueFactory = InternalValueFactory.getInstance();
-    private Lexer lexer;
+    private final Lexer lexer;
+        valueFactory = new ValueFactoryQImpl(qValueFactory, resolver);
+
-        List defaultValues = new ArrayList();
+        List<InternalValue> defaultValues = new ArrayList();
-                        ValueFactoryImpl.getInstance());
-                value = InternalValue.create(v, resolver);
+                        valueFactory);
+                value = (InternalValue) ValueFormat.getQValue(v, resolver, qValueFactory);

MOV26 INS26 INS26 INS26 INS40 INS40 UPD40 INS40 INS23 INS23 INS83 INS83 INS29 INS83 INS83 INS43 INS59 INS29 INS83 INS83 INS43 INS59 INS83 INS65 INS42 INS42 INS65 INS42 INS42 INS32 INS21 INS66 INS66 INS42 INS42 INS7 INS74 INS42 INS14 MOV43 INS43 INS43 INS42 INS42 INS42 INS42 INS11 UPD42 MOV42 INS43 INS32 INS42 UPD42 MOV42 UPD42 MOV42 MOV42 MOV42 INS42 DEL42 DEL32 DEL32