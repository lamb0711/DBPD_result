JCR-2887 : Split PrivilegeRegistry in a per-session manager instance and a repository level registry [work in progress]

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1082239 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.Collections;
+import java.util.HashSet;
-    private int getPrivilegeBits(String privName) throws RepositoryException {
-        PrivilegeManagerImpl impl = (PrivilegeManagerImpl) ((JackrabbitWorkspace) session.getWorkspace()).getPrivilegeManager();
-        return impl.getBits(new String[] {privName});
-    }
-
+        private int getPrivilegeBits(String privName) throws RepositoryException {
+            PrivilegeManagerImpl impl = getPrivilegeManagerImpl();
+            return impl.getBits(new Privilege[] {impl.getPrivilege(privName)});
+        }
+
+        @Override
+        protected PrivilegeManagerImpl getPrivilegeManagerImpl() throws RepositoryException {
+            return (PrivilegeManagerImpl) ((JackrabbitWorkspace) session.getWorkspace()).getPrivilegeManager();
+        }
+

INS26 INS26 INS40 INS40 INS31 MOV31 INS83 INS39 INS42 MOV44 INS43 INS8 INS78 UPD83 MOV43 UPD42 INS42 INS60 INS41 INS42 INS43 INS59 INS32 MOV11 INS42 INS42 INS32 INS42 INS42 INS3 INS42 INS5 INS4 INS43 INS85 INS32 INS42 INS42 INS42 INS42 DEL39 DEL42 DEL59 DEL60 DEL42 DEL42 DEL42 DEL43 DEL85 DEL5 DEL42 DEL4 DEL3 DEL32