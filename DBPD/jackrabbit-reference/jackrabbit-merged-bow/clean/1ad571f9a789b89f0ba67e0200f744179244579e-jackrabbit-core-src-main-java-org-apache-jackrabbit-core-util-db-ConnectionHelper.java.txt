JCR-3503 ConnectionHelper should not call isBatchMode() more times inside a Method

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1439768 13f79535-47bb-0310-9956-ffa450edef68

-            batchConnection = getConnection();
+            batchConnection = getConnection(false);
+        boolean inBatchMode = inBatchMode();
-            con = getConnection();
+            con = getConnection(inBatchMode);
-            closeResources(con, stmt, null);
+            closeResources(con, stmt, null, inBatchMode);
+        boolean inBatchMode = inBatchMode();
-            con = getConnection();
+            con = getConnection(inBatchMode);
-            closeResources(con, stmt, null);
+            closeResources(con, stmt, null, inBatchMode);
+        boolean inBatchMode = inBatchMode();
-            con = getConnection();
+            con = getConnection(inBatchMode);
-            	closeResources(con, stmt, rs);
+            	closeResources(con, stmt, rs, inBatchMode);
-            if (inBatchMode()) {
+            if (inBatchMode) {
-            closeResources(con, stmt, rs);
+            closeResources(con, stmt, rs, inBatchMode);
+     * @param inBatchMode indicates if we are in a batchMode
-    protected final Connection getConnection() throws SQLException {
-        if (inBatchMode()) {
+    protected final Connection getConnection(boolean inBatchMode) throws SQLException {
+        if (inBatchMode) {
+     * @param inBatchMode indicates if we are in a batchMode
-    protected final void closeResources(Connection con, Statement stmt, ResultSet rs) {
-        if (inBatchMode()) {
+    protected final void closeResources(Connection con, Statement stmt, ResultSet rs, boolean inBatchMode) {
+        if (inBatchMode) {

INS44 INS44 INS60 INS60 INS60 INS65 INS39 INS42 INS65 INS39 INS42 INS39 INS59 INS39 INS59 INS39 INS59 INS42 INS66 INS42 INS42 INS66 INS42 INS42 MOV32 INS42 MOV32 INS42 MOV32 INS42 INS42 INS42 INS9 INS42 INS42 INS42 INS42 INS42