JCR-2152: ValueFormat should provide method getJCRString



git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@785535 13f79535-47bb-0310-9956-ffa450edef68

+
+    /**
+     * Returns the JCR string representation of the given <code>QValue</code>.
+     * This method is a shortcut for
+     * {@link #getJCRValue(QValue, NamePathResolver, ValueFactory)} followed by
+     * {@link Value#getString()}.
+     *
+     * @param qualifiedValue
+     * @param resolver
+     * @return the JCR String representation for the given <code>qualifiedValue</code>.
+     * @throws RepositoryException
+     */
+    public static String getJCRString(QValue qualifiedValue,
+                                      NamePathResolver resolver) throws RepositoryException {
+        String jcrString;
+        int propertyType = qualifiedValue.getType();
+        switch (propertyType) {
+            case PropertyType.STRING:
+            case PropertyType.REFERENCE:
+            case PropertyType.WEAKREFERENCE:
+            case PropertyType.URI:
+            case PropertyType.BOOLEAN:
+            case PropertyType.DATE:
+            case PropertyType.DOUBLE:
+            case PropertyType.LONG:
+            case PropertyType.DECIMAL:
+            case PropertyType.BINARY:
+                jcrString = qualifiedValue.getString();
+                break;
+            case PropertyType.PATH:
+                Path qPath = qualifiedValue.getPath();
+                jcrString = resolver.getJCRPath(qPath);
+                break;
+            case PropertyType.NAME:
+                Name qName = qualifiedValue.getName();
+                jcrString = resolver.getJCRName(qName);
+                break;
+            default:
+                throw new RepositoryException("illegal internal value type");
+        }
+        return jcrString;
+    }

INS31 INS29 INS83 INS83 INS43 INS42 INS44 INS44 INS43 INS8 INS65 INS65 INS65 INS65 INS65 INS42 INS43 INS42 INS43 INS42 INS42 INS60 INS60 INS50 INS41 INS66 INS66 INS65 INS66 INS65 INS66 INS42 INS42 INS66 INS42 INS42 INS42 INS43 INS59 INS39 INS59 INS42 INS49 INS49 INS49 INS49 INS49 INS49 INS49 INS49 INS49 INS49 INS21 INS10 INS49 INS60 INS21 INS10 INS49 INS60 INS21 INS10 INS49 INS53 INS42 INS68 INS68 INS42 INS42 INS42 INS32 INS40 INS40 INS40 INS40 INS40 INS40 INS40 INS40 INS40 INS40 INS7 INS40 INS43 INS59 INS7 INS40 INS43 INS59 INS7 INS14 INS42 INS69 INS69 INS69 INS42 INS42 INS42 INS42 INS42 INS32 INS42 INS42 INS32 INS42 INS32 INS42 INS42 INS32 INS42 INS32 INS43 INS45 INS43 INS43 INS43 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42