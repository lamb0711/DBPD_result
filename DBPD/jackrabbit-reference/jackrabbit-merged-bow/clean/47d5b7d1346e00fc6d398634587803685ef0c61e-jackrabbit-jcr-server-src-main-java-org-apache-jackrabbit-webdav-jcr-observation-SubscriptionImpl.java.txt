JCR-3222: Allow servlet filters to specify custom session providers

Move the Link header handling from SessionProviderImpl to JCRWebdavServer to avoid breaking functionality when using an external SessionProvider implementation

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1236820 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.server.SessionProviderImpl;
+import org.apache.jackrabbit.commons.webdav.JcrRemotingConstants;
-                    String forSessionId = (String) session
-                            .getAttribute(SessionProviderImpl.ATTRIBUTE_SESSION_ID);
+                    String name = JcrRemotingConstants.RELATION_REMOTE_SESSION_ID;
+                    Object forSessionId = session.getAttribute(name);
+                        AdditionalEventInfo aei = (AdditionalEventInfo) event;
-                            String eventforSessionId = (String) ((AdditionalEventInfo) event)
-                                    .getSessionAttribute(SessionProviderImpl.ATTRIBUTE_SESSION_ID);
-                            boolean isLocal = forSessionId
-                                    .equals(eventforSessionId);
-                            DomUtil.setAttribute(bundle, XML_EVENT_LOCAL, null, Boolean.toString(isLocal));
+                            boolean isLocal = forSessionId.equals(
+                                    aei.getSessionAttribute(name));
+                            DomUtil.setAttribute(
+                                    bundle, XML_EVENT_LOCAL, null,
+                                    Boolean.toString(isLocal));

UPD40 MOV25 MOV38 MOV21 INS60 INS60 INS25 MOV43 INS59 INS43 INS59 MOV27 MOV8 INS42 INS40 UPD42 MOV42 INS42 INS32 INS54 INS42 INS42 INS42 UPD43 INS8 MOV12 UPD42 UPD42 MOV11 MOV60 MOV21 INS42 INS32 INS42 UPD42 MOV42 INS42 DEL42 DEL43 DEL36 DEL42 DEL40 DEL32 DEL11 DEL54 DEL42 DEL42 DEL43 DEL42 DEL42 DEL40 DEL32 DEL11 DEL59 DEL60 DEL8 DEL25