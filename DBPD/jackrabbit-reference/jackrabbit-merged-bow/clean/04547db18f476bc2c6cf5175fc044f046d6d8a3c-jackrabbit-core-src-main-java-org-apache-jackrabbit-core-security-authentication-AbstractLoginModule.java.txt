JCR-2603: DefaultLoginModule performs anonymous login in case of unsupported Credentials implementation

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@934355 13f79535-47bb-0310-9956-ffa450edef68

-        } else {
-            if (supportsCredentials(creds)) {
-                sharedState.put(KEY_CREDENTIALS, credentials);
-            } else {
-                log.debug("Unsupported credentials implementation : " + creds.getClass().getName());
-                return false;
-            }
+        } else if (!supportsCredentials(creds)) {
+            log.debug("Unsupported credentials implementation : " + creds.getClass().getName());
+            return false;
+                if (credentials != null && supportsCredentials(credentials)) {
+                    sharedState.put(KEY_CREDENTIALS, credentials);                    
+                }

MOV25 INS38 MOV32 INS25 INS27 MOV8 INS27 INS32 INS42 INS33 INS42 INS42 DEL8