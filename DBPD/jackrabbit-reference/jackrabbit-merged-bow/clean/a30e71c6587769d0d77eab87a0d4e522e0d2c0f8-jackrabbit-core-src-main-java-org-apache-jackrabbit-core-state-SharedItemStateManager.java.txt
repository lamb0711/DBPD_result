JCR-2272: Errors during concurrent session import of nodes with same

Move the cluster update to the finally block to avoid locking the entire cluster if an unexpected exception gets thrown.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/branches/JCR-2272@1173579 13f79535-47bb-0310-9956-ffa450edef68

-
-                // let listener know about finished operation
-                String path = events.getSession().getUserID() + "@" + events.getCommonPath();
-                eventChannel.updateCommitted(this, path);
+                // Let listener know about finished operation. This needs
+                // to happen in the finally block so that the cluster lock
+                // always gets released, even if a post-store() exception
+                // is thrown from the code above. See also JCR-2272.
+                String path = events.getSession().getUserID()
+                        + "@" + events.getCommonPath();
+                eventChannel.updateCommitted(this, path);
+

MOV60 MOV21