work in progress

- minor improvement and some sync



git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@497068 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.name.CachingNameResolver;
+import org.apache.jackrabbit.name.ParsingNameResolver;
+import org.apache.jackrabbit.name.NameResolver;
+import org.apache.jackrabbit.name.NameException;
-    private final CachingNamespaceResolver resolver;
+    private final NameResolver resolver;
-        resolver = new CachingNamespaceResolver(this, 1000);
+        resolver = new CachingNameResolver(new ParsingNameResolver(this));
-        // just delegate to internal cache
-        return resolver.retrieveName(jcrName);
+        try {
+            return resolver.getQName(jcrName);
+        } catch (NameException e) {
+            return null;
+        } catch (NamespaceException e) {
+            return null;
+        }
-        // just delegate to internal cache
-        return resolver.retrieveName(name);
+        try {
+            return resolver.getJCRName(name);
+        } catch (NamespaceException e) {
+            return null;
+        }
-        // just delegate to internal cache
-        resolver.cacheName(jcrName, name);
-        // just delegate to internal cache
-        resolver.evictAllNames();

INS26 INS26 INS26 INS26 INS40 INS40 INS40 INS40 UPD43 INS8 INS8 MOV29 MOV29 UPD42 INS54 INS54 INS8 INS12 INS12 INS8 INS12 MOV41 INS44 INS8 INS44 INS8 MOV41 INS44 INS8 UPD43 INS14 INS43 INS42 INS41 INS43 INS42 INS41 INS43 INS42 INS41 UPD42 INS43 MOV52 UPD42 INS42 INS33 INS42 INS33 UPD42 INS42 INS33 INS42 DEL34 DEL8 DEL8 DEL42 DEL42 DEL42 DEL42 DEL32 DEL21 DEL42 DEL42 DEL32 DEL21