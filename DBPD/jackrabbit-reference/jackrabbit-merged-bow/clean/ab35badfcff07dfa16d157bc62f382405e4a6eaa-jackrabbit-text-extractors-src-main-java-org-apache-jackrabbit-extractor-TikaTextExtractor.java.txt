JCR-1878: Use Apache Tika for text extraction

Use a static Tika Parser instance to avoid separate instances being created for each search index and TikaTextExtractor subclass.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@762804 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.tika.parser.Parser;
-    private final AutoDetectParser parser = new AutoDetectParser();
+    /**
+     * Auto-detecting parser.
+     */
+    private static final Parser PARSER;
+
+    /**
+     * Supported content types.
+     */
+    private static final String[] TYPES;
+
+    static {
+        AutoDetectParser parser = new AutoDetectParser();
+        PARSER = parser;
+        Set types = parser.getParsers().keySet();
+        TYPES = (String[]) types.toArray(new String[types.size()]);
+    }
-        Set types = parser.getParsers().keySet();
-        return (String[]) types.toArray(new String[types.size()]);
+        return TYPES;
-        return new ParsingReader(parser, stream, metadata);
+        // TODO: This creates a background thread. Is that a problem?
+        return new ParsingReader(PARSER, stream, metadata);

INS26 INS40 INS23 INS28 INS29 INS83 INS43 INS59 INS29 INS83 INS83 INS83 INS5 INS59 INS83 MOV8 INS8 INS65 INS42 INS42 INS65 INS43 INS85 INS42 INS60 INS21 INS21 INS41 INS66 INS66 INS42 MOV43 MOV59 INS7 INS7 INS42 INS42 INS42 INS42 MOV11 UPD42 DEL41