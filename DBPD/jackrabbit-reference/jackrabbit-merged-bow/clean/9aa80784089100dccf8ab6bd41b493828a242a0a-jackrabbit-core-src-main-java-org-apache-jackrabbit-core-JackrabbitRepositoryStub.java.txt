JCR-2085: RetentionPolicy now obtained from a pre-populated node, see new property "retentionpolicyholder"; change cleanup so that it cleans up retention policies as well.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@771344 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.core.retention.RetentionRegistryImpl;
-import org.apache.jackrabbit.test.NotExecutableException;
-    public RetentionPolicy getRetentionPolicy(Session session) throws NotExecutableException, RepositoryException {
-        return RetentionPolicyImpl.createRetentionPolicy(RepositoryStub.RETENTION_POLICY_NAME, session);
-    }
-
-        
-        // add a policy
-        // TODO check we're doing the right thing here
-        RetentionPolicyImpl.createRetentionPolicy("retentionPolicyName", session);
+        addRetentionTestData(getOrAddNode(data, "retentionTest"));
+     * Creates a node with a RetentionPolicy
+     */
+    private void addRetentionTestData(Node node) throws RepositoryException {
+        RetentionPolicy rp = RetentionPolicyImpl.createRetentionPolicy("testRetentionPolicy", node.getSession());
+        node.getSession().getRetentionManager().setRetentionPolicy(node.getPath(), rp);
+    }
+
+    /**

MOV31 INS29 UPD83 INS39 UPD42 INS8 INS65 UPD43 UPD42 INS60 INS21 INS66 UPD42 MOV43 INS59 INS32 UPD42 INS32 INS42 INS32 INS32 INS42 INS32 INS42 UPD42 MOV42 INS42 UPD45 MOV45 MOV42 MOV42 INS45 INS32 INS32 INS42 INS42 INS42 INS42 UPD42 MOV42 INS42 INS42 DEL40 DEL26 DEL40 DEL26 DEL42 DEL42 DEL43 DEL40 DEL32 DEL41 DEL8