JCR-1007: Move common implementations of SPI interfaces to spi-commons module

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@553507 13f79535-47bb-0310-9956-ffa450edef68

-package org.apache.jackrabbit.spi.rmi.common;
+package org.apache.jackrabbit.spi.commons;
+import org.apache.jackrabbit.name.QName;
- * definition based on a JCR {@link javax.jcr.nodetype.PropertyDefinition}.
- * TODO: mostly copied from spi2dav, move common parts to spi-commons.
+ * definition.
-public class QPropertyDefinitionImpl extends QItemDefinitionImpl implements QPropertyDefinition {
+public class QPropertyDefinitionImpl
+        extends QItemDefinitionImpl
+        implements QPropertyDefinition {
-     * Creates a new serializable qualified property definition based on
-     * <code>propDef</code>.
+     * Copy constructor.
-     * @param propDef the qualified property definition.
+     * @param propDef some other property definition.
-        super(propDef);
-        this.defaultValues = propDef.getDefaultValues();
-        this.multiple = propDef.isMultiple();
-        this.requiredType = propDef.getRequiredType();
-        this.valueConstraints = propDef.getValueConstraints();
+        this(propDef.getQName(), propDef.getDeclaringNodeType(),
+                propDef.isAutoCreated(), propDef.isMandatory(),
+                propDef.getOnParentVersion(), propDef.isProtected(),
+                propDef.getDefaultValues(), propDef.isMultiple(),
+                propDef.getRequiredType(), propDef.getValueConstraints());
+    }
+
+    /**
+     * Creates a new serializable qualified property definition.
+     *
+     * @param name              the name of the child item.
+     * @param declaringNodeType the delaring node type
+     * @param isAutoCreated     if this item is auto created.
+     * @param isMandatory       if this is a mandatory item.
+     * @param onParentVersion   the on parent version behaviour.
+     * @param isProtected       if this item is protected.
+     * @param defaultValues     the default values or <code>null</code> if there
+     *                          are none.
+     * @param isMultiple        if this property is multi-valued.
+     * @param requiredType      the required type for this property.
+     * @param valueConstraints  the value constraints for this property. If none
+     *                          exist an empty array must be passed.
+     * @throws NullPointerException if <code>valueConstraints</code> is
+     *                              <code>null</code>.
+     */
+    public QPropertyDefinitionImpl(QName name, QName declaringNodeType,
+                                   boolean isAutoCreated, boolean isMandatory,
+                                   int onParentVersion, boolean isProtected,
+                                   QValue[] defaultValues, boolean isMultiple,
+                                   int requiredType, String[] valueConstraints) {
+        super(name, declaringNodeType, isAutoCreated, isMandatory,
+                onParentVersion, isProtected);
+        if (valueConstraints == null) {
+            throw new NullPointerException("valueConstraints");
+        }
+        this.defaultValues = defaultValues;
+        this.multiple = isMultiple;
+        this.requiredType = requiredType;
+        this.valueConstraints = valueConstraints;

INS26 UPD40 INS40 INS31 INS8 INS29 INS83 INS42 INS44 INS44 INS44 INS44 INS44 INS44 INS44 INS44 INS44 INS44 MOV8 UPD66 INS17 INS65 INS65 INS65 INS65 INS65 INS65 INS65 INS65 INS65 INS65 INS65 INS65 INS43 INS42 INS43 INS42 INS39 INS42 INS39 INS42 INS39 INS42 INS39 INS42 INS5 INS42 INS39 INS42 INS39 INS42 INS5 INS42 INS25 UPD66 UPD66 INS32 INS32 INS32 INS32 INS32 INS32 MOV32 MOV32 MOV32 MOV32 INS66 INS42 INS66 INS42 INS66 INS42 INS66 INS42 INS66 INS42 INS66 INS42 INS66 INS42 INS66 INS66 INS42 INS66 INS42 INS66 INS42 INS66 INS66 INS42 INS66 INS66 INS42 INS42 INS43 INS85 INS43 INS85 UPD42 INS42 INS42 INS42 INS42 INS42 INS27 INS8 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS33 INS53 INS42 INS42 INS42 INS42 INS14 INS43 INS45 INS42 DEL40 DEL65 DEL66 DEL66 DEL66