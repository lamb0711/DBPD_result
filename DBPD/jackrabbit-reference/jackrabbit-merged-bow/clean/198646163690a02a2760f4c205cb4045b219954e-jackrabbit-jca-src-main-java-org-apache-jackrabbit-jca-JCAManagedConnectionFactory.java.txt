JCR-3491 Start the Repository immediatly in JCA Environment

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1432823 13f79535-47bb-0310-9956-ffa450edef68

+        // JCR-3491 Start the Repository immediatly in JCA Environment. 
+        // If this Instance is in a Cluster it would not get any changes till someone performs a first login 
+        createRepository();
-
+     * Create/startup the repository.
+     */
+    @SuppressWarnings("deprecation")
+    private void createRepository() throws ResourceException {
+        if (repository == null) {
+            try {
+                JCARepositoryManager mgr = JCARepositoryManager.getInstance();
+                repository = mgr.createRepository(parameters);
+                log("Created repository (" + repository + ")");
+            } catch (RepositoryException e) {
+                log("Failed to create repository", e);
+                ResourceException exception = new ResourceException(
+                        "Failed to create repository: " + e.getMessage());
+                exception.setLinkedException(e);
+                throw exception;
+            }
+        }
+    }
+
+    /**
-    public synchronized Repository getRepository() throws RepositoryException {
-        if (repository == null) {
-            JCARepositoryManager mgr = JCARepositoryManager.getInstance();
-            repository = mgr.createRepository(parameters);
-            log("Created repository (" + repository + ")");
-        }
+    public Repository getRepository() throws RepositoryException {
-
+    

INS31 INS29 INS79 UPD83 INS39 UPD42 INS43 MOV29 INS83 MOV43 INS42 MOV43 INS8 INS21 INS65 INS42 INS45 INS42 MOV41 INS32 INS66 INS8 INS42 INS54 MOV8 INS12 INS44 INS8 INS43 INS42 INS21 INS60 INS21 INS53 INS42 INS32 INS43 INS59 INS32 INS42 INS42 INS45 INS42 INS42 INS42 INS14 INS42 INS42 INS42 INS43 INS27 INS42 INS45 INS32 INS42 INS42 DEL83