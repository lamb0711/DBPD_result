JCR-1818: Too many open files when merging large index segments

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@792109 13f79535-47bb-0310-9956-ffa450edef68

+     * The default value for {@link #indexMergerPoolSize}.
+     */
+    public static final int DEFAULT_INDEX_MERGER_POOL_SIZE = 2;
+
+    /**
+     * The number of worker threads for merging index segments.
+     */
+    private int indexMergerPoolSize = DEFAULT_INDEX_MERGER_POOL_SIZE;
+
+    /**
+     *
+     * @return the query node factory.
+    /**
+     * @return the current size of the index merger pool.
+     */
+    public int getIndexMergerPoolSize() {
+        return indexMergerPoolSize;
+    }
+
+    /**
+     * Sets a new value for the index merger pool size.
+     *
+     * @param indexMergerPoolSize the number of worker threads.
+     * @throws IllegalArgumentException if the size is less than or equal 0.
+     */
+    public void setIndexMergerPoolSize(int indexMergerPoolSize) {
+        if (indexMergerPoolSize <= 0) {
+            throw new IllegalArgumentException("must be greater than 0");
+        }
+        this.indexMergerPoolSize = indexMergerPoolSize;
+    }
+

INS23 INS23 INS31 INS31 INS29 INS83 INS83 INS83 INS39 INS59 INS29 INS83 INS39 INS59 INS29 INS83 INS39 INS42 INS8 INS29 INS83 INS39 INS42 INS44 INS8 INS65 INS42 INS34 INS65 INS42 INS42 INS65 INS65 INS41 INS65 INS65 INS65 INS39 INS42 INS25 INS21 INS66 INS65 INS66 INS66 INS66 INS66 INS42 INS66 INS42 INS66 INS42 INS66 INS27 INS8 INS7 INS67 INS42 INS34 INS53 INS22 INS42 INS42 INS14 INS52 INS42 INS43 INS45 INS42