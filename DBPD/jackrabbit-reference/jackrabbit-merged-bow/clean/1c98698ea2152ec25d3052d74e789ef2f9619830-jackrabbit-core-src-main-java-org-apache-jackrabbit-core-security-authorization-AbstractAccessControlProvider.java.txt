JCR-2887 : Split PrivilegeRegistry in a per-session manager instance and a repository level registry [work in progress]

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1072154 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.WorkspaceImpl;
-    protected int privAll;
-    protected int privRead;
-
-            public int getPrivileges(Path absPath) {
-                return privAll;
+            public int getPrivileges(Path absPath) throws RepositoryException {
+                return ((WorkspaceImpl) session.getWorkspace()).getPrivilegeManager().getBits(new String[] {Privilege.JCR_ALL});
-                    return privRead;
+                    return ((WorkspaceImpl) session.getWorkspace()).getPrivilegeManager().getBits(new String[] {Privilege.JCR_READ});
-        privAll = PrivilegeRegistry.getBits(new Privilege[] {session.getAccessControlManager().privilegeFromName(Privilege.JCR_ALL)});
-        privRead = PrivilegeRegistry.getBits(new Privilege[] {session.getAccessControlManager().privilegeFromName(Privilege.JCR_READ)});
-

INS26 INS40 INS43 INS42 INS32 INS32 INS42 INS3 INS36 INS42 INS5 INS4 INS32 INS11 INS43 INS85 INS40 INS32 INS42 INS3 INS43 INS32 INS42 INS36 INS42 INS5 INS4 INS42 INS42 INS42 INS11 INS43 INS85 INS40 INS43 INS32 INS42 INS42 INS42 INS42 DEL83 DEL39 DEL42 DEL59 DEL23 DEL83 DEL39 DEL42 DEL59 DEL23 DEL42 DEL42 DEL42 DEL42 DEL42 DEL42 DEL43 DEL85 DEL5 DEL42 DEL42 DEL32 DEL42 DEL40 DEL32 DEL4 DEL3 DEL32 DEL7 DEL21 DEL42 DEL42 DEL42 DEL42 DEL43 DEL85 DEL5 DEL42 DEL42 DEL32 DEL42 DEL40 DEL32 DEL4 DEL3 DEL32 DEL7 DEL21