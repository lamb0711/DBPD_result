port to jcr api v0.16.4.1

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@165156 13f79535-47bb-0310-9956-ffa450edef68

-                    String msg = itemMgr.safeGetJCRPath(id) + ": not allowed to modify item";
+                    String msg = itemMgr.safeGetJCRPath(id)
+                            + ": not allowed to modify item";
-                            String msg = node.safeGetJCRPath() + " must be of node type " + ntReq.getName();
+                            String msg = node.safeGetJCRPath()
+                                    + " must be of node type " + ntReq.getName();
+                    if (pd.getDeclaringNodeType().equals(MIX_VERSIONABLE)) {
+                        /**
+                         * todo FIXME workaround for mix:versionable:
+                         * the mandatory properties are initialized at a
+                         * later stage and might not exist yet
+                         */
+                        continue;
+                    }
-                        String msg = node.safeGetJCRPath() + ": mandatory property " + pd.getName() + " does not exist";
+                        String msg = node.safeGetJCRPath()
+                                + ": mandatory property " + pd.getName()
+                                + " does not exist";
-                        String msg = node.safeGetJCRPath() + ": mandatory child node " + cnd.getName() + " does not exist";
+                        String msg = node.safeGetJCRPath()
+                                + ": mandatory child node " + cnd.getName()
+                                + " does not exist";
-                PropertyDefinitionImpl def = (PropertyDefinitionImpl) prop.getDefinition();
+                PropertyDefinitionImpl def =
+                        (PropertyDefinitionImpl) prop.getDefinition();
-                String msg = itemMgr.safeGetJCRPath(id) + ": not allowed to remove item";
+                String msg = itemMgr.safeGetJCRPath(id)
+                        + ": not allowed to remove item";

INS25 INS32 INS8 INS32 INS42 INS42 INS18 INS42 INS42