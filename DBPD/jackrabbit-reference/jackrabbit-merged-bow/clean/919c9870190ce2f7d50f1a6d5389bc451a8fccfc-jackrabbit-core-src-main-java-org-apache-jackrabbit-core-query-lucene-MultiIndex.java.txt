JCR-3162 Index update overhead on cluster slave due to JCR-905
 - rollback

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1214749 13f79535-47bb-0310-9956-ffa450edef68

+        IndexingQueueStore store = new IndexingQueueStore(indexDir);
+
-        this.indexingQueue = new IndexingQueue(new IndexingQueueStore(indexDir));
+        this.indexingQueue = new IndexingQueue(store);
-        Iterator<IndexInfo> iterator = indexNames.iterator();
-        while (iterator.hasNext()) {
-            IndexInfo info = iterator.next();
+        for (Iterator<?> it = indexNames.iterator(); it.hasNext(); ) {
+            IndexInfo info = (IndexInfo) it.next();
-                checkIndexingQueue(true);
-                safeFlush();
+                scheduleFlushTask();
-                scheduleFlushTask();
-        int volatileIndexDocuments = volatileIndex.getNumDocuments();
-        if (volatileIndexDocuments > 0) {
+        if (volatileIndex.getNumDocuments() > 0) {
-            log.debug("Committed in-memory index containing {} documents in {}ms.", volatileIndexDocuments, time);
+            log.debug("Committed in-memory index in " + time + "ms.");
-
+    

MOV21 INS24 INS43 INS59 INS58 INS32 MOV8 INS42 INS42 MOV14 UPD74 MOV74 MOV59 UPD42 MOV42 MOV42 MOV32 INS42 INS76 UPD42 INS11 INS27 MOV43 INS32 INS45 INS42 INS45 UPD42 MOV42 MOV42 MOV42 DEL32 DEL32 DEL61 DEL42 DEL9 DEL32 DEL21 DEL39 DEL42 DEL59 DEL60 DEL42 DEL45 DEL42 DEL42