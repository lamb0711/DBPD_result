JCR-2700 : Allow for wildcard restriction in resource-based ACEs

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@983906 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.api.security.JackrabbitAccessControlEntry;
+import org.apache.jackrabbit.core.security.authorization.AccessControlEntryImpl;
+import java.util.Set;
-                        privilegeRegistry, session.getValueFactory());
+                        privilegeRegistry, session.getValueFactory(), session);
-            JackrabbitAccessControlEntry ace = (JackrabbitAccessControlEntry) entry;
+            AccessControlEntryImpl ace = (AccessControlEntryImpl) entry;
+
+            // store the restrictions:
+            Set<Name> restrNames = ace.getRestrictions().keySet();
+            for (Name restrName : restrNames) {
+                Value value = ace.getRestriction(restrName);
+                setProperty(aceNode, restrName, value);
+            }

MOV26 INS26 UPD40 INS40 INS60 INS70 UPD43 INS74 INS59 INS44 INS42 INS8 UPD42 INS43 INS43 INS42 INS32 INS43 INS42 INS60 INS21 UPD43 INS42 INS42 INS32 INS42 INS42 INS43 INS59 INS32 UPD42 INS42 INS42 INS42 INS42 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42