JCR-2718: Incorrect results from joins on multivalued properties

Use full term lookups in EquiJoin instead of relying on comparators for the equality tests.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@986686 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.query.lucene.NamespaceMappings;
-import org.apache.lucene.search.SortComparatorSource;
-     * @param scs       the sort comparator source of the index.
+     * @param nsMappings namespace mappings of this index
-                              final SortComparatorSource scs,
+                              final NamespaceMappings nsMappings,
-                    Condition c = new EquiJoin(inner, getIndex(inner, innerName),
-                            scs, reader, innerPropName, outerPropName);
+                    Condition c = new EquiJoin(
+                            inner, getIndex(inner, innerName), nsMappings,
+                            reader, innerPropName, outerPropName);

MOV26 UPD40 UPD43 UPD42 UPD42 UPD66 UPD42 UPD42