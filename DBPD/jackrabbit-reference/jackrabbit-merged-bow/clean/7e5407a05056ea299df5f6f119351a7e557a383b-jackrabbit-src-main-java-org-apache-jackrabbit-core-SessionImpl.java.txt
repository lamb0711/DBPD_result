[JCR-317] replace UUID strings by UUID classes in NodeId, etc..

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@378221 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.uuid.UUID;
-        return new SessionItemStateManager(rep.getRootNodeUUID(),
+        return new SessionItemStateManager(rep.getRootNodeId(),
-                ntMgr.getRootNodeDefinition(), rep.getRootNodeUUID());
+                ntMgr.getRootNodeDefinition(), rep.getRootNodeId());
-        
+
+        return getNodeByUUID(UUID.fromString(uuid));
+    }
+
+    /**
+     * {@inheritDoc}
+     */
+    public Node getNodeByUUID(UUID uuid) throws ItemNotFoundException, RepositoryException {
+        NodeImpl node = getNodeById(new NodeId(uuid));
+        if (node.isNodeType(QName.MIX_REFERENCEABLE)) {
+            return node;
+        } else {
+            // there is a node with that uuid but the node does not expose it
+            throw new ItemNotFoundException(uuid.toString());
+        }
+    }
+
+    /**
+     * {@inheritDoc}
+     */
+    public NodeImpl getNodeById(NodeId id) throws ItemNotFoundException, RepositoryException {
-            NodeImpl node = (NodeImpl) getItemManager().getItem(new NodeId(uuid));
-            if (node.isNodeType(QName.MIX_REFERENCEABLE)) {
-                return node;
-            } else {
-                // there is a node with that uuid but the node does not expose it
-                throw new ItemNotFoundException(uuid);
-            }
+            return (NodeImpl) getItemManager().getItem(id);
-            throw new ItemNotFoundException(uuid);
+            throw new ItemNotFoundException(id.toString());
-        String targetUUID = ((NodeState) targetNode.getItemState()).getUUID();
+        NodeId targetId = targetNode.getNodeId();
-            destParentNode.renameChildNode(srcName.getName(), index, targetUUID, destName.getName());
+            destParentNode.renameChildNode(srcName.getName(), index, targetId, destName.getName());
-            targetState.setParentUUID(destParentNode.internalGetUUID());
+            targetState.setParentId(destParentNode.getNodeId());
-            destParentState.addChildNodeEntry(destName.getName(), targetUUID);
+            destParentState.addChildNodeEntry(destName.getName(), targetId);

INS26 INS40 INS31 INS31 INS29 INS83 INS43 INS42 MOV44 INS43 INS43 INS8 INS44 MOV8 INS29 INS83 INS43 INS42 INS44 INS43 INS43 INS8 INS65 INS42 INS42 INS42 INS41 INS43 INS42 INS65 INS42 INS43 INS42 INS42 INS42 MOV21 INS54 INS65 INS32 UPD42 MOV42 MOV43 INS8 INS65 INS42 INS8 INS12 UPD43 INS42 INS32 MOV32 INS53 INS41 MOV44 MOV8 UPD42 UPD42 UPD42 UPD42 INS42 INS42 INS42 UPD42 INS14 INS11 MOV42 UPD42 MOV43 INS32 MOV43 INS32 UPD42 UPD42 UPD42 INS42 INS42 INS42 MOV32 INS42 INS42 INS32 UPD42 INS42 INS42 DEL11 DEL42 DEL14 DEL53 DEL8 DEL12 DEL54 DEL8 DEL42 DEL42 DEL43 DEL42 DEL32 DEL11 DEL36