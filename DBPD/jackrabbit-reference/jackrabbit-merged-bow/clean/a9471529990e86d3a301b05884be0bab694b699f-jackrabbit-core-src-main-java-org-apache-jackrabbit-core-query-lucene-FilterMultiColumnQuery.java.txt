JCR-2076: JSR 283: QOM and SQL2
- orderings (work in progress)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@784061 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.lucene.search.Sort;
-                                        Sort sort,
+                                        Ordering[] orderings,
-        return new FilterMultiColumnQueryHits(query.execute(
-                searcher, sort, resultFetchHint)) {
+        MultiColumnQueryHits hits = new FilterMultiColumnQueryHits(query.execute(
+                searcher, orderings, resultFetchHint)) {
+        if (orderings.length > 0 && hits.getSelectorNames().length > 1) {
+            // subsequent ordering is only needed
+            // when there is more than one column
+            hits = new SortedMultiColumnQueryHits(hits, orderings, searcher.getIndexReader());
+        }
+        return hits;

INS43 INS42 INS5 UPD42 INS60 INS25 INS43 INS85 MOV43 INS59 INS27 INS8 INS42 UPD42 MOV42 INS42 MOV14 INS27 INS27 INS21 INS40 INS34 INS22 INS34 INS7 UPD42 INS32 INS42 INS42 INS14 INS42 INS42 INS43 INS42 INS42 INS32 INS42 INS42 INS42 DEL40 DEL26 DEL43