AccessManager implementation configurable in repository.xml

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@155930 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.security.AMContext;
-import org.apache.jackrabbit.core.security.SimpleAccessManager;
+     * @throws RepositoryException
-                                                HierarchyManager hierMgr) {
-        //return new SystemAccessManager(subject, hierMgr);
-        return super.createAccessManager(subject, hierMgr);
+                                                HierarchyManager hierMgr)
+            throws RepositoryException {
+        /**
+         * use own AccessManager implementation rather than relying on
+         * configurable AccessManager to handle SystemPrincipal privileges
+         * correctly
+         */
+        return new SystemAccessManager();
+        //return super.createAccessManager(subject, hierMgr);
-    private class SystemAccessManager extends SimpleAccessManager {
+    private class SystemAccessManager implements AccessManager {
-        SystemAccessManager(Subject subject, HierarchyManager hierMgr) {
-            super(subject, hierMgr);
+        SystemAccessManager() {
+
+        /**
+         * @see AccessManager#init(AMContext)
+         */
+        public void init(AMContext context) throws Exception {
+            // nop
+        }
+
+        /**
+         * @see AccessManager#close()
+         */
+        public void close() throws Exception {
+            // nop
+        }

MOV26 UPD40 INS43 UPD43 INS31 INS31 INS31 INS65 INS42 UPD42 MOV42 INS8 INS29 INS83 INS39 INS42 MOV44 INS43 INS8 INS29 INS83 INS39 INS42 INS43 INS8 INS42 INS14 INS65 UPD43 UPD42 INS42 INS65 INS42 INS43 INS68 UPD42 INS68 INS42 INS42 INS42 INS69 INS42 INS42 INS43 UPD42 MOV42 DEL42 DEL42 DEL42 DEL48 DEL43 DEL42 DEL44 DEL42 DEL42 DEL46 DEL8 DEL31