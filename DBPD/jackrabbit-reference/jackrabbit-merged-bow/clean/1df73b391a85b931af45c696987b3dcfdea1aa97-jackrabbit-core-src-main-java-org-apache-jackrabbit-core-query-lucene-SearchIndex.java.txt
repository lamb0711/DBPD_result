JCR-901: Support synonym searches

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@536246 13f79535-47bb-0310-9956-ffa450edef68

+     * The class that implements {@link SynonymProvider}.
+     */
+    private Class synonymProviderClass;
+
+    /**
+     * The currently set synonym provider.
+     */
+    private SynonymProvider synProvider;
+
+    /**
+        synProvider = createSynonymProvider();
+     * @return the synonym provider of this search index. If none is set for
+     *         this search index the synonym provider of the parent handler is
+     *         returned if there is any.
+     */
+    public SynonymProvider getSynonymProvider() {
+        if (synProvider != null) {
+            return synProvider;
+        } else {
+            QueryHandler handler = getContext().getParentHandler();
+            if (handler instanceof SearchIndex) {
+                return ((SearchIndex) handler).getSynonymProvider();
+            } else {
+                return null;
+            }
+        }
+    }
+
+    /**
+     * @return the configured synonym provider or <code>null</code> if none is
+     *         configured or an error occurs.
+     */
+    protected SynonymProvider createSynonymProvider() {
+        SynonymProvider sp = null;
+        if (synonymProviderClass != null) {
+            try {
+                sp = (SynonymProvider) synonymProviderClass.newInstance();
+            } catch (Exception e) {
+                log.warn("Exception initializing synonym provider: " +
+                        synonymProviderClass, e);
+            }
+        }
+        return sp;
+    }
+
+    /**
+    /**
+     * Sets the name of the class that implements {@link SynonymProvider}. The
+     * default value is <code>null</code> (none set).
+     *
+     * @param className name of the class that implements {@link
+     *                  SynonymProvider}.
+     */
+    public void setSynonymProviderClass(String className) {
+        try {
+            Class clazz = Class.forName(className);
+            if (SynonymProvider.class.isAssignableFrom(clazz)) {
+                synonymProviderClass = clazz;
+            } else {
+                log.warn("Invalid value for synonymProviderClass, {} " +
+                        "does not implement SynonymProvider interface.",
+                        className);
+            }
+        } catch (ClassNotFoundException e) {
+            log.warn("Invalid value for synonymProviderClass, class {} " +
+                    "not found.", className);
+        }
+    }
+
+    /**
+     * @return the class name of the synonym provider implementation or
+     *         <code>null</code> if none is set.
+     */
+    public String getSynonymProviderClass() {
+        return synonymProviderClass != null ?
+                synonymProviderClass.getName() : null;
+    }
+

INS23 INS23 INS31 INS31 INS31 INS31 INS29 INS83 INS43 INS59 INS29 INS83 INS43 INS59 INS29 INS83 INS43 INS42 INS8 INS29 INS83 INS43 INS42 INS8 INS29 INS83 INS39 INS42 INS44 INS8 INS29 INS83 INS43 INS42 INS8 INS65 INS42 INS42 INS65 INS42 INS42 INS21 INS65 INS42 INS25 INS65 INS42 INS60 INS25 INS41 INS65 INS65 INS43 INS42 INS54 INS65 INS42 INS41 INS66 INS65 INS66 INS66 INS7 INS66 INS66 INS66 INS27 INS8 INS8 INS66 INS66 INS43 INS59 INS27 INS8 INS42 INS66 INS65 INS66 INS66 INS42 INS66 INS65 INS66 INS42 INS8 INS12 INS66 INS66 INS16 INS42 INS42 INS32 INS42 INS33 INS41 INS60 INS25 INS42 INS42 INS33 INS42 INS33 INS54 INS42 INS42 INS60 INS25 INS44 INS8 INS27 INS32 INS33 INS42 INS42 INS43 INS59 INS62 INS8 INS8 INS8 INS12 INS43 INS59 INS32 INS8 INS8 INS43 INS42 INS21 INS42 INS33 INS42 INS42 INS42 INS42 INS32 INS42 INS43 INS41 INS41 INS21 INS44 INS8 INS42 INS42 INS32 INS57 INS42 INS42 INS21 INS21 INS42 INS32 INS32 INS42 INS42 INS32 INS33 INS7 INS43 INS42 INS21 INS42 INS42 INS42 INS43 INS7 INS32 INS42 INS42 INS27 INS42 INS42 INS36 INS42 INS42 INS11 INS42 INS32 INS42 INS42 INS42 INS42 INS42 INS27 INS42 INS45 INS45 INS11 INS43 INS32 INS42 INS42 INS27 INS42 INS45 INS45 INS43 INS42 INS42 INS42 INS42 INS45 INS42 INS42