JCR-2640: Internal repository context

Streamline WorkspaceImpl creation with the new WorkspaceManager class.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@948857 13f79535-47bb-0310-9956-ffa450edef68

+import javax.jcr.RepositoryException;
+
-import org.apache.jackrabbit.core.state.SharedItemStateManager;
-import org.apache.jackrabbit.core.state.XAItemStateManager;
+import org.apache.jackrabbit.core.state.XAItemStateManager;
-     * @param stateMgr  The shared item state manager
-            WorkspaceConfig wspConfig, SharedItemStateManager stateMgr,
-            RepositoryContext repositoryContext, SessionImpl session) {
-        super(wspConfig, stateMgr, repositoryContext, session);
+            WorkspaceConfig wspConfig, RepositoryContext repositoryContext,
+            SessionImpl session) throws RepositoryException {
+        super(wspConfig, repositoryContext, session);
-    /**
-     * {@inheritDoc}
-     */
-    protected LocalItemStateManager createItemStateManager(SharedItemStateManager shared) {
-        return XAItemStateManager.createInstance(shared, this, null, rep.getItemStateCacheFactory());
+    @Override
+    protected LocalItemStateManager createItemStateManager()
+            throws RepositoryException {
+        return XAItemStateManager.createInstance(
+                getSharedItemStateManager(), this, null,
+                rep.getItemStateCacheFactory());

MOV26 MOV26 UPD40 INS43 INS78 INS43 UPD42 MOV42 INS42 UPD42 MOV42 INS32 UPD42 MOV42 DEL42 DEL66 DEL65 DEL43 DEL42 DEL44 DEL42 DEL65 DEL65 DEL29 DEL43 DEL42 DEL44