JCR-2630 : UserAccessControlProvider handles users who dont have Jackrabbit managed Principals or User node incosistently.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@945528 13f79535-47bb-0310-9956-ffa450edef68

-                // no 'user' within set of principals -> READ-only
-                return getReadOnlyPermissions();
+                // no 'user' within set of principals -> no permissions in the
+                // security workspace.
+                return CompiledPermissions.NO_PERMISSION;
-                return new Result(Permission.NONE, Permission.NONE, PrivilegeRegistry.NO_PRIVILEGE, PrivilegeRegistry.NO_PRIVILEGE);
+                return Result.EMPTY;
-                // read is always granted
-                return true;
+                return canReadAll();
-            return true;
+            // for consistency with 'grants(Path, int) this method only returns
+            // true if there exists a node for 'userNodePath'
+            return session.nodeExists(userNodePath);

INS32 INS42 INS42 INS42 INS40 INS32 INS40 INS42 DEL42 DEL32 DEL42 DEL43 DEL40 DEL40 DEL40 DEL40 DEL14 DEL9 DEL9