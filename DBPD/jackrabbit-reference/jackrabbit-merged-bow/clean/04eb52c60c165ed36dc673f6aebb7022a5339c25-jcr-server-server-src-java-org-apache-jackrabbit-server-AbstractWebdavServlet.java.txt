JCR-405: PROPPATCH doesn't respect document order
minor improvements within 'jcr' package:
- reorder nodes
- fixing creation/replacement of multivalued JCR properties
- contentlength for single value JCR properties
- improve spooling of resource content

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@397835 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.webdav.property.DavPropertySet;
-        DavPropertySet setProperties = request.getPropPatchSetProperties();
-        DavPropertyNameSet removeProperties = request.getPropPatchRemoveProperties();
-        if (setProperties.isEmpty() && removeProperties.isEmpty()) {
+        List changeList = request.getPropPatchChangeList();
+        if (changeList.isEmpty()) {
-        try {
-            MultiStatusResponse msr = resource.alterProperties(setProperties, removeProperties);
-            ms.addResponse(msr);
-        } catch (DavException e) {
-            /* NOTE: known bug with litmus, which expects the exception (e.g. 423)
-               to the set instead of the MultiStatus Code. RFC 2518 explicitely
-               expects the errors to be included in the multistatus.
-               Remove the catch if this turns out to be an problem with clients
-               in general. */
-            ms.addResourceStatus(resource, e.getErrorCode(), DEPTH_0);
-        }
-        response.sendMultiStatus(ms);
+        MultiStatusResponse msr = resource.alterProperties(changeList);
+        ms.addResponse(msr);

MOV60 MOV21 UPD43 INS32 UPD42 UPD42 UPD42 MOV42 MOV42 UPD42 UPD42 DEL40 DEL26 DEL42 DEL43 DEL42 DEL42 DEL42 DEL32 DEL59 DEL60 DEL32 DEL42 DEL42 DEL32 DEL27 DEL42 DEL8 DEL42 DEL43 DEL42 DEL44 DEL42 DEL42 DEL42 DEL42 DEL42 DEL32 DEL42 DEL32 DEL21 DEL8 DEL12 DEL54 DEL42 DEL42 DEL42 DEL32 DEL21