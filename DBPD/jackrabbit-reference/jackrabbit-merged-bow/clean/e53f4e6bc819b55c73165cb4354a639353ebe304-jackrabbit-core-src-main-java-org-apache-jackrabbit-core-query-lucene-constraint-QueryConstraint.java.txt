JCR-2085: test case (TCK) maintenance for JCR 2.0
- move ValueFactory field to AbstractJCRTest
- more QOM tests
- use RepositoryException instead of IOException in constraints

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@784760 13f79535-47bb-0310-9956-ffa450edef68

-import java.util.BitSet;
+import java.util.Map;
+import java.util.HashMap;
-     * The bitset with the matching document numbers.
+     * Map of document numbers with their respective score value that match the
+     * query constraint.
-    private BitSet matches;
+    private Map<Integer, Float> matches;
-        return matches.get(sn.getDoc(context.getIndexReader()));
+        Float score = matches.get(sn.getDoc(context.getIndexReader()));
+        if (score != null) {
+            sn.setScore(score);
+        }
+        return score != null;
-                matches = new BitSet();
+                matches = new HashMap<Integer, Float>();
-                    matches.set(sn.getDoc(reader));
+                    matches.put(sn.getDoc(reader), sn.getScore());

INS26 UPD40 INS40 INS74 INS43 INS43 INS43 INS60 INS25 UPD66 INS66 INS42 INS42 UPD42 MOV42 INS43 INS59 INS27 INS8 INS27 INS42 INS42 MOV32 INS42 INS33 INS21 INS42 INS33 INS32 INS42 INS42 INS42 INS74 INS43 INS43 INS43 INS42 INS32 INS42 INS42 UPD42 MOV42 UPD42 MOV42 INS42 DEL43 DEL43