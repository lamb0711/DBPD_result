JCR-1342 Use bundle packaging with the Maven Bundle Plugin and export all packages
JCR-1343 Replace use of Xerces by JAXP to implement SAX DocumentHandler

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@614859 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.xml.serialize.OutputFormat;
-import org.apache.xml.serialize.XMLSerializer;
+import javax.jcr.RepositoryException;
+import javax.xml.transform.TransformerConfigurationException;
+import javax.xml.transform.sax.SAXTransformerFactory;
+import javax.xml.transform.sax.TransformerHandler;
+import javax.xml.transform.stream.StreamResult;
+
-    private ContentHandler handler;
+    private TransformerHandler handler;
+     * 
+     * @throws RepositoryException if the this instance cannot be setup. This
+     *      exception contains the reason why it cannot be setup as its cause.
-    public ImportContentHandler() {
+    public ImportContentHandler() throws RepositoryException {
-        this.handler = new XMLSerializer(buffer, new OutputFormat());
+        
+        try {
+            SAXTransformerFactory stf = (SAXTransformerFactory) SAXTransformerFactory.newInstance();
+            this.handler = stf.newTransformerHandler();
+            this.handler.setResult(new StreamResult(buffer));
+        } catch (TransformerConfigurationException tce) {
+            throw new RepositoryException("Cannot create XML handler", tce);
+        }

INS26 INS26 INS26 INS40 INS40 UPD40 UPD40 INS40 UPD43 INS43 UPD42 INS65 INS42 INS54 INS42 INS66 INS66 INS8 INS12 INS60 INS21 INS21 INS44 INS8 INS43 INS59 INS7 INS32 INS43 INS42 INS53 UPD42 MOV42 INS42 INS11 MOV22 INS32 INS22 INS42 INS14 INS42 INS14 INS43 INS32 INS42 INS42 INS52 INS42 INS43 MOV42 UPD43 MOV43 INS45 INS42 INS42 INS42 INS42 INS42 UPD42 DEL43 DEL14 DEL14 DEL7 DEL21