JCR-1775: Transaction-safe versioning

All calls to VersionManager's getVersionHistory and createVersionHistory followed this pattern:

    VersionHistory vh = manager.getVersionHistory(...);
    if (vh == null) {
        vh = manager.createVersionHistory(...);
    }

Simplified things by making getVersionHistory() automatically create the version history if it doesn't already exist. This simplifies the client code to:

    VersionHistory vh = manager.getVersionHistory(...);


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@702425 13f79535-47bb-0310-9956-ffa450edef68

-    public VersionHistory createVersionHistory(Session session, final NodeState node)
+    protected NodeId createVersionHistory(Session session, final NodeState node)
-        return (VersionHistory) ((SessionImpl) session).getNodeById(history.getId());
+        return history.getId();

UPD83 UPD43 UPD42 MOV32 DEL42 DEL43 DEL42 DEL43 DEL42 DEL11 DEL36 DEL42 DEL32 DEL11