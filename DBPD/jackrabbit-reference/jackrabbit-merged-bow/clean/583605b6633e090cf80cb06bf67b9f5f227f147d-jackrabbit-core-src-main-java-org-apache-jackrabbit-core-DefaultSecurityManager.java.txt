JCR-2087 Upgrade to Java 5 as the base platform
minor improvement



git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@788012 13f79535-47bb-0310-9956-ffa450edef68

-    private final Map acProviders = new HashMap();
+    private final Map<String, AccessControlProvider> acProviders = new HashMap();
-        for (int i = 0; i < moduleConfig.length; i++) {
-            if (moduleConfig[i].containsKey(LoginModuleConfig.PARAM_ADMIN_ID)) {
-                adminId = moduleConfig[i].getProperty(LoginModuleConfig.PARAM_ADMIN_ID);
+        for (Properties props : moduleConfig) {
+            if (props.containsKey(LoginModuleConfig.PARAM_ADMIN_ID)) {
+                adminId = props.getProperty(LoginModuleConfig.PARAM_ADMIN_ID);
-            if (moduleConfig[i].containsKey(LoginModuleConfig.PARAM_ANONYMOUS_ID)) {
-                anonymousId = moduleConfig[i].getProperty(LoginModuleConfig.PARAM_ANONYMOUS_ID);
+            if (props.containsKey(LoginModuleConfig.PARAM_ANONYMOUS_ID)) {
+                anonymousId = props.getProperty(LoginModuleConfig.PARAM_ANONYMOUS_ID);
-        for (int i = 0; i < moduleConfig.length; i++) {
-            principalProviderRegistry.registerProvider(moduleConfig[i]);
+        for (Properties props : moduleConfig) {
+            principalProviderRegistry.registerProvider(props);
-            AccessControlProvider prov = (AccessControlProvider) acProviders.remove(workspaceName);
+            AccessControlProvider prov = acProviders.remove(workspaceName);
-            Iterator itr = acProviders.values().iterator();
+            Iterator<AccessControlProvider> itr = acProviders.values().iterator();
-                ((AccessControlProvider) itr.next()).close();
+                itr.next().close();
-            String msg = "Failed to instantiate AccessManager (" + amConfig.getClassName() + ")";
+            String clsName = (amConfig == null) ? "-- missing access manager configuration --" : amConfig.getClassName();
+            String msg = "Failed to instantiate AccessManager (" + clsName + ")";
-            AccessControlProvider provider = (AccessControlProvider) acProviders.get(workspaceName);
+            AccessControlProvider provider = acProviders.get(workspaceName);

INS74 MOV43 INS43 MOV43 INS70 INS70 INS42 INS44 INS42 INS8 INS44 INS42 INS8 INS43 INS42 MOV25 MOV25 INS43 INS42 MOV21 INS42 INS42 MOV43 INS74 INS60 MOV43 INS42 INS42 INS42 MOV32 MOV43 MOV43 MOV43 INS59 INS43 MOV32 INS42 INS16 INS42 MOV32 INS36 INS45 MOV32 INS42 INS42 INS42 INS27 INS42 INS33 DEL42 DEL42 DEL2 DEL42 DEL42 DEL2 DEL42 DEL42 DEL2 DEL42 DEL42 DEL2 DEL39 DEL42 DEL34 DEL59 DEL58 DEL42 DEL40 DEL27 DEL42 DEL37 DEL8 DEL24 DEL42 DEL42 DEL2 DEL39 DEL42 DEL34 DEL59 DEL58 DEL42 DEL40 DEL27 DEL42 DEL37 DEL8 DEL24 DEL11 DEL11 DEL36 DEL42 DEL43 DEL11