Patch provided by Philipp Koch to synchronize with recent jackrabbit changes.

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@156148 13f79535-47bb-0310-9956-ffa450edef68

+    /** the logger */
+    /** repository configuration path */
+    /** repository home */
+    /** repository name */
-    // todo: implement correctly
+    /** jaas configuration file path */
+    public static final String JAAS_CONFIG_FILE = "jaas-config-file";
+
+    /** user id name */
+    public static final String USER_ID = "jcr-userid";
+
+    /** user password name */
+    public static final String  USER_PASSWORD = "jcr-password";
+
+    /** log4j config */
-    public static RepositoryImpl repository;
+    /** the repository to read/write test results and config */
+    private static RepositoryImpl repository;
+    /** the user id */
+    private static String uid;
+
+    /** the password */
+    private static String pw;
+
+    /**
+     * The init method starts the repository to read/write test results and configuration,
+     * sets the jaas config and the user id and the user password
+     *
+     * @throws ServletException
+     */
+            // set jaas config file
+            String jaasConfigFile = getServletConfig().getInitParameter(JAAS_CONFIG_FILE);
+            if (jaasConfigFile == null) {
+                jaasConfigFile = "etc/jaas.config";
+            }
+            System.setProperty("java.security.auth.login.config", jaasConfigFile);
+            log_info("JAAS config set");
+
+            // set user id and password to read/write test results and configuration
+            uid = getServletConfig().getInitParameter(USER_ID);
+            pw = getServletConfig().getInitParameter(USER_PASSWORD);
+
-     * @param req
-    public static Session getSession(HttpServletRequest req) {
+    public static Session getSession() {
-     * logs in to the repository. currently only as anonymous user
+     * Logs in to the repository. The user to login is specified in the servlet config.
-        Session repSession = repository.login(null, null);
+        Session repSession = repository.login(new SimpleCredentials(uid, pw.toCharArray()), null);

INS23 INS23 INS23 INS23 INS23 INS29 INS29 INS29 INS29 INS29 INS83 INS83 INS83 INS43 INS59 INS29 INS83 INS83 INS83 INS43 INS59 INS29 INS83 INS83 INS83 INS43 INS59 INS29 INS29 UPD83 INS29 INS83 INS83 INS43 INS59 INS29 INS83 INS83 INS43 INS59 INS29 INS65 INS65 INS65 INS65 INS65 INS42 INS42 INS45 INS65 INS42 INS42 INS45 INS65 INS42 INS42 INS45 INS65 INS65 INS65 INS42 INS42 INS65 INS42 INS42 INS65 INS65 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS42 UPD66 INS60 INS25 INS21 INS21 INS21 INS21 INS43 INS59 INS27 INS8 INS32 INS32 INS7 INS7 INS14 INS42 INS42 INS32 INS42 INS33 INS21 INS42 INS42 INS45 INS42 INS42 INS45 INS42 INS32 INS42 INS32 INS43 INS42 INS32 INS32 INS42 INS42 INS7 INS32 INS42 INS42 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS45 INS42 INS42 DEL42 DEL65 DEL42 DEL43 DEL42 DEL44 DEL33