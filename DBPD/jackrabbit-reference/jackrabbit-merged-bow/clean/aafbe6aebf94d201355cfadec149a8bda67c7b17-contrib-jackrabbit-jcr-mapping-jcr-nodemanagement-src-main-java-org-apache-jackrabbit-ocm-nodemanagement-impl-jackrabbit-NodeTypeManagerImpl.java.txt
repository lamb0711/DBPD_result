Fix for issue 1054 - 2 different attributes are used in BeanDescriptor and CollectionDescriptor to store the jcr type (jcrType and jcrNodeType).

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@563632 13f79535-47bb-0310-9956-ffa450edef68

-            if (classDescriptor.getJcrNodeType() != null &&
-                    (classDescriptor.getJcrNodeType().startsWith("nt:")
-                    || classDescriptor.getJcrNodeType().startsWith("mix:")))
+            if (classDescriptor.getJcrType() != null &&
+                    (classDescriptor.getJcrType().startsWith("nt:")
+                    || classDescriptor.getJcrType().startsWith("mix:")))
-                NodeTypeDef nodeTypeDef = getNodeTypeDef(classDescriptor.getJcrNodeType(),
+                NodeTypeDef nodeTypeDef = getNodeTypeDef(classDescriptor.getJcrType(),
-                        if (field.getJcrType() != null) {
+                        if (this.isPropertyType(field.getJcrType())) {
-                        if (field.getJcrType() != null) {
+                        if (this.isPropertyType(field.getJcrType())) {
-        if (field.getJcrNodeType() != null) {
-            node.setRequiredPrimaryTypes(getJcrSuperTypes(field.getJcrNodeType()));
+        if (field.getJcrType() != null) {
+            node.setRequiredPrimaryTypes(getJcrSuperTypes(field.getJcrType()));
+    
+
+    private boolean isPropertyType(String type)
+    {
+    	return (type.equals(PropertyType.TYPENAME_BINARY) ||
+    	        type.equals(PropertyType.TYPENAME_BOOLEAN) ||
+    	        type.equals(PropertyType.TYPENAME_DATE) ||
+    	        type.equals(PropertyType.TYPENAME_DOUBLE) ||
+    	        type.equals(PropertyType.TYPENAME_LONG) ||
+    	        type.equals(PropertyType.TYPENAME_NAME) ||
+    	        type.equals(PropertyType.TYPENAME_PATH) ||
+    	        type.equals(PropertyType.TYPENAME_REFERENCE) ||
+    	        type.equals(PropertyType.TYPENAME_STRING));    	       
+    }

INS31 INS83 INS39 INS42 INS44 INS8 INS43 INS42 INS41 MOV27 INS42 INS36 INS27 INS32 INS32 INS32 INS32 INS32 INS32 INS32 INS32 INS32 INS42 INS42 INS40 INS42 INS42 INS40 INS42 INS42 INS40 INS42 INS42 INS40 INS42 INS42 INS40 INS42 INS42 INS40 INS42 INS42 INS40 INS42 INS42 INS40 INS42 INS42 INS40 UPD42 UPD42 UPD42 UPD42 UPD42 INS32 INS32 INS52 INS42 INS32 INS52 INS42 INS32 MOV42 MOV42 INS42 INS42 DEL32 DEL33 DEL27 DEL42 DEL42 DEL32 DEL33 DEL27