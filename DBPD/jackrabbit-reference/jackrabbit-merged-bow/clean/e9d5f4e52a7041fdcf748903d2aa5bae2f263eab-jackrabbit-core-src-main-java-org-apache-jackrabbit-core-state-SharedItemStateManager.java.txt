JCR-3290: Mix data inconsistency by correctly merging transient state with persistent overlayed state

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1324713 13f79535-47bb-0310-9956-ffa450edef68

-                                        protected NodeState getNodeState(NodeId id)
+                                        public NodeState getNodeState(NodeId id)
-                        && !parentId.equals(oldParentId)) {
+                        && (parentId != null && !parentId.equals(oldParentId))) {
-            String message = "Child node has another parent id " + parentId + ", expected " + expectedParent;
+            String message = "Child node " + childState.getId() + " has another parent id " + parentId + ", expected " + expectedParent;

INS45 INS32 UPD45 INS36 INS42 INS42 INS27 INS27 MOV38 INS42 INS33 UPD83