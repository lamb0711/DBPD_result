- new interface EffectiveNodeTypeProvider
- new interface ItemDefinitionProvider
- limit access to NodeTypeRegistry and simplify the NodeTypeRegistry
  interface.
- avoid duplicate code dealing with logic of EffectiveNodeType
  and retrieval of QItemDefinitions.


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@520408 13f79535-47bb-0310-9956-ffa450edef68

-    private final NodeTypeRegistry ntRegistry;
+    private final EffectiveNodeTypeProvider entProvider;
-    DefinitionValidator(NodeTypeRegistry ntRegistry, NamespaceRegistry nsRegistry) {
-        this.ntRegistry = ntRegistry;
+    DefinitionValidator(EffectiveNodeTypeProvider entProvider, NamespaceRegistry nsRegistry) {
+        this.entProvider = entProvider;
-                EffectiveNodeType est = ntRegistry.getEffectiveNodeType(supertypes, validatedDefs);
+                EffectiveNodeType est = entProvider.getEffectiveNodeType(supertypes, validatedDefs);
-                        defaultENT = ntRegistry.getEffectiveNodeType(new QName[] {dpt}, validatedDefs);
+                        defaultENT = entProvider.getEffectiveNodeType(new QName[] {dpt}, validatedDefs);
-                        ent = EffectiveNodeTypeImpl.create(ntRegistry, ntDef, validatedDefs);
+                        ent = EffectiveNodeTypeImpl.create(entProvider, ntDef, validatedDefs);
-                            ntRegistry.getEffectiveNodeType(new QName[] {rpt}, validatedDefs);
+                            entProvider.getEffectiveNodeType(new QName[] {rpt}, validatedDefs);
-                                ent = EffectiveNodeTypeImpl.create(ntRegistry, ntDef, validatedDefs);
+                                ent = EffectiveNodeTypeImpl.create(entProvider, ntDef, validatedDefs);
-                ent = EffectiveNodeTypeImpl.create(ntRegistry, ntDef, validatedDefs);
+                ent = EffectiveNodeTypeImpl.create(entProvider, ntDef, validatedDefs);
-        QNodeDefinition[] nodeDefs = childNodeENT.getAutoCreateNodeDefs();
+        QNodeDefinition[] nodeDefs = childNodeENT.getAutoCreateQNodeDefinitions();
-                    EffectiveNodeType ent = ntRegistry.getEffectiveNodeType(new QName[] {dnt}, ntdMap);
+                    EffectiveNodeType ent = entProvider.getEffectiveNodeType(new QName[] {dnt}, ntdMap);

UPD43 UPD42 UPD42 UPD43 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42