JCR-1465: Configurable Similarity

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@635552 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.lucene.search.Similarity;
+     * The similarity in use for indexing and searching.
+     */
+    private Similarity similarity = Similarity.getDefault();
+
+    /**
-        return new FilterMultiColumnQueryHits(new JackrabbitIndexSearcher(
-                session, reader).execute(query, sort)) {
+        JackrabbitIndexSearcher searcher = new JackrabbitIndexSearcher(session, reader);
+        searcher.setSimilarity(getSimilarity());
+        return new FilterMultiColumnQueryHits(searcher.execute(query, sort)) {
+     * @return the similarity, which should be used for indexing and searching.
+     */
+    public Similarity getSimilarity() {
+        return similarity;
+    }
+
+    /**
+    /**
+     * Sets the similarity implementation, which will be used for indexing and
+     * searching. The implementation must extend {@link Similarity}.
+     *
+     * @param className a {@link Similarity} implementation.
+     */
+    public void setSimilarityClass(String className) {
+        try {
+            Class similarityClass = Class.forName(className);
+            similarity = (Similarity) similarityClass.newInstance();
+        } catch (Exception e) {
+            log.warn("Invalid Similarity class: " + className, e);
+        }
+    }
+
+    /**
+     * @return the name of the similarity class.
+     */
+    public String getSimilarityClass() {
+        return similarity.getClass().getName();
+    }
+

INS26 INS40 INS23 INS31 INS31 INS31 INS29 INS83 INS43 INS59 INS29 INS83 INS43 INS42 INS8 INS29 INS83 INS39 INS42 INS44 INS8 INS29 INS83 INS43 INS42 INS8 INS65 INS42 INS42 INS32 INS60 INS21 INS65 INS42 INS41 INS65 INS65 INS43 INS42 INS54 INS65 INS42 INS41 INS66 INS42 INS42 INS43 INS59 INS32 INS66 INS42 INS66 INS66 INS65 INS66 INS42 INS66 INS65 INS66 INS42 INS8 INS12 INS66 INS32 INS42 INS42 MOV14 INS42 INS42 INS32 INS42 INS42 INS60 INS21 INS44 INS8 INS32 INS42 INS42 INS42 INS43 INS59 INS7 INS43 INS42 INS21 INS42 INS42 INS42 INS42 INS32 INS42 INS11 INS42 INS32 INS42 INS42 INS42 INS43 INS32 INS42 INS42 INS27 INS42 INS42 INS42 INS42 INS45 INS42