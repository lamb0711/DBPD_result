JCR-1588 - JSR 283: Access Control (work in progress)
JCR-1590 - JSR 283: Locking
JCR-1915 - Node.setPrimaryNodeType should only redefine child-definitions that are not covered by the new effective nt
JCR-1875 - Failing Node.unlock() might leave inconsistent transient state
JCR-538 - Failing Node.checkin() or Node.checkout() might leave inconsistent transient state

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@732693 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.security.authorization.Permission;
+import javax.jcr.AccessDeniedException;
-     *                         {@link ImportUUIDBehavior}
+     *                         {@link javax.jcr.ImportUUIDBehavior}
+
+        // make sure the editing session is allowed create nodes with a
+        // specified node type (and ev. mixins)
+        if (!session.getAccessManager().isGranted(session.getQPath(parent.getPath()), nodeName, Permission.NODE_TYPE_MNGMT)) {
+            throw new AccessDeniedException("Insufficient permission.");
+        }
+

INS26 INS26 INS40 INS40 INS25 INS38 INS8 INS40 INS32 INS53 INS32 INS42 INS32 INS42 INS40 INS14 INS42 INS42 INS42 INS42 INS32 INS43 INS45 INS42 INS42 INS42 DEL42