- invalidating a NodeEntry must also invalidate the ChildNodeEntries collection in order to get informed about reordering of the entries.

- comparing ItemInfo.getPath to HierarchyEntry.getPath must use the 'workspace' path of the latter and not the current path present in the transient space, which differs in case of a moved item.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@518930 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.name.Path;
+import org.apache.jackrabbit.name.MalformedPathException;
+import javax.jcr.RepositoryException;
+
+    /**
+     * @see HierarchyEntryImpl#buildPath(boolean)
+     */
+    Path buildPath(boolean workspacePath) throws RepositoryException {
+        try {
+            Path.PathBuilder builder = new Path.PathBuilder();
+            builder.addAll(parent.buildPath(workspacePath).getElements());
+            // add property name to parent path
+            builder.addLast(getQName());
+
+            return builder.getPath();
+        } catch (MalformedPathException e) {
+            String msg = "Failed to build path of " + this;
+            throw new RepositoryException(msg, e);
+        }
+    }
+

INS26 INS26 INS26 INS40 INS40 INS40 INS31 INS29 INS43 INS42 INS44 INS43 INS8 INS65 INS42 INS39 INS42 INS42 INS54 INS68 INS8 INS12 INS42 INS42 INS69 INS60 INS21 INS21 INS41 INS44 INS8 INS39 INS43 INS59 INS32 INS32 INS32 INS43 INS42 INS60 INS53 INS40 INS42 INS14 INS42 INS42 INS32 INS42 INS42 INS32 INS42 INS42 INS42 INS43 INS59 INS14 INS43 INS32 INS42 INS42 INS42 INS42 INS27 INS43 INS42 INS42 INS40 INS42 INS42 INS42 INS45 INS52 INS42