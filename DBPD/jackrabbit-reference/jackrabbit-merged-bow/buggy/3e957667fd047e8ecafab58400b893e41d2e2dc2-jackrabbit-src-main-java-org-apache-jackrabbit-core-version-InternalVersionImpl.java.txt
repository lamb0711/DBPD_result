Make versioning transactional
- Added specialized XAVersion and XAVersionHistory objects that refresh their internal state when needed
- Defined new observation interface in order to have VersionManagerImpl use standard event dispatching
  instead of writing its own
- Added test cases verifying isolation of versioning operations in transactions


git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@368026 13f79535-47bb-0310-9956-ffa450edef68

-public class InternalVersionImpl extends InternalVersionItemImpl
+class InternalVersionImpl extends InternalVersionItemImpl
-            return (InternalFrozenNode) getVersionManager().getItem(entry.getUUID());
+            return (InternalFrozenNode) vMgr.getItem(entry.getUUID());
+     * Clear the list of predecessors/successors and the label cache.
+     */
+    void clear() {
+        successors.clear();
+        predecessors.clear();
+        labelCache = null;
+    }
+
+    /**
-        successors.clear();
-        predecessors.clear();
-        labelCache = null;
+        clear();
+
+    /**
+     * Invalidate this item.
+     */
+    void invalidate() {
+        node.getState().discard();
+    }

INS31 INS31 INS29 INS39 INS42 INS8 INS29 INS39 INS42 INS8 INS65 MOV21 MOV21 MOV21 INS21 INS65 INS21 INS66 INS32 INS66 INS32 INS42 INS32 INS42 INS42 INS42 UPD42 MOV42 DEL83 DEL32