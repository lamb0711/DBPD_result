JCR-2640: Internal repository context

Use the RepositoryContext to track the ItemStateCacheFactory instance.
Remove the RepositoryImpl member variables from SessionImpl and WorkspaceImpl.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@948874 13f79535-47bb-0310-9956-ffa450edef68

-     * There is only one item state cache factory
-     */
-    private final ItemStateCacheFactory cacheFactory = new ManagedMLRUItemStateCacheFactory(cacheMgr);
-
-    /**
+            // Create item state cache manager
+            context.setItemStateCacheFactory(
+                    new ManagedMLRUItemStateCacheFactory(cacheMgr));
+
-     * Get the item state cache factory of this repository.
-     *
-     * @return the cache factory
-     */
-    public ItemStateCacheFactory getItemStateCacheFactory() {
-        return cacheFactory;
-    }
-
-    /**
-                cacheFactory,
+                context.getItemStateCacheFactory(),
-     * @param cacheFactory   cache factory
-            ItemStateCacheFactory cacheFactory, ISMLocking locking)
-            throws ItemStateException {
+            ISMLocking locking) throws ItemStateException {
-                true, cacheFactory, locking);
+                true,
+                context.getItemStateCacheFactory(),
+                locking);
-                itemStateMgr = createItemStateManager(
-                        persistMgr, true, cacheFactory, ismLocking);
+                itemStateMgr =
+                    createItemStateManager(persistMgr, true, ismLocking);

INS21 INS32 INS32 INS32 INS42 INS42 INS42 INS42 INS42 INS42 MOV14 DEL66 DEL65 DEL29 DEL83 DEL83 DEL42 DEL43 DEL42 DEL59 DEL23 DEL66 DEL65 DEL66 DEL65 DEL29 DEL83 DEL42 DEL43 DEL42 DEL42 DEL41 DEL8 DEL31 DEL42 DEL42 DEL66 DEL65 DEL42 DEL43 DEL42 DEL44 DEL42 DEL42