bug fix for issues JCR-882 & JCR-921

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@547884 13f79535-47bb-0310-9956-ffa450edef68

-        Class elementClass = ReflectionUtils.forName(collectionDescriptor.getElementClassName());
-        Iterator children = this.getCollectionNodes(session, parentNode,
-                elementClassDescriptor.getJcrNodeType()).iterator();
-
+        //Class elementClass = ReflectionUtils.forName(collectionDescriptor.getElementClassName());
+        Collection nodes = this.getCollectionNodes(session, parentNode, elementClassDescriptor.getJcrNodeType());
+        
+        if (nodes == null)
+        {
+        	return null;
+        }
+        
+        Iterator children = nodes.iterator();
-        return collectionNodes;
+        if (collectionNodes.size() == 0)
+        {
+        	return null; 
+        }
+        else
+        {
+            return collectionNodes;
+        }
-        Iterator nodeIterator = this.getCollectionNodes(session, parentNode, itemNodeType).iterator();
+        Collection nodes = this.getCollectionNodes(session, parentNode, itemNodeType);
+        if (nodes == null) return;
+        	
+        Iterator nodeIterator = nodes.iterator();

INS25 INS60 INS25 INS25 INS60 INS43 INS27 INS8 MOV43 MOV59 INS27 INS8 INS8 INS43 INS27 INS41 MOV43 INS59 INS42 UPD42 MOV32 INS42 INS33 INS41 UPD42 INS32 INS34 INS41 MOV41 INS42 UPD42 MOV32 INS42 INS33 INS42 INS32 INS33 UPD42 UPD42 MOV42 INS42 INS42 INS33 INS42 INS42 DEL42 DEL43 DEL60 DEL42 DEL32 DEL42 DEL42 DEL32 DEL42 DEL32