JCR-2886 : Add SessionImpl#isAdminOrSystem

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1072095 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.core.security.principal.AdminPrincipal;
-import javax.security.auth.Subject;
-     * @param itemMgr {@link org.apache.jackrabbit.core.ItemManager} of the passed
-     *                <code>Session</code>.
+     * @param clusterNode
-     *                              or <code>itemMgr</code> is <code>null</code>.
+     *                              or <code>clusterNode</code> is <code>null</code>.
-        Subject subject = session.getSubject();
-        if (subject.getPrincipals(AdminPrincipal.class).isEmpty()) {
-            throw new RepositoryException("Only administrator session may " +
-                    "access EventJournal");
+        if (!session.isAdmin()) {
+            throw new RepositoryException("Only administrator session may access EventJournal");

UPD42 UPD66 INS38 INS32 UPD42 MOV42 INS42 INS45 DEL40 DEL26 DEL40 DEL26 DEL66 DEL40 DEL65 DEL66 DEL66 DEL42 DEL43 DEL42 DEL42 DEL42 DEL32 DEL59 DEL60 DEL42 DEL42 DEL43 DEL57 DEL32 DEL42 DEL32 DEL45 DEL45 DEL27