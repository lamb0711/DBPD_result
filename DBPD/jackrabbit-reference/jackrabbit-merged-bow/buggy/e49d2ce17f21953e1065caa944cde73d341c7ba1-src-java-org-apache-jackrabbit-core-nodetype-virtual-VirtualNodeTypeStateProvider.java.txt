porting to v0.16.4 of the jsr170 specification

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@161260 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.core.virtual.VirtualNodeState;
-import org.apache.jackrabbit.core.virtual.AbstractVISProvider;
+import org.apache.jackrabbit.core.InternalValue;
-import org.apache.jackrabbit.core.InternalValue;
-import org.apache.jackrabbit.core.util.uuid.UUID;
-import org.apache.jackrabbit.core.nodetype.NodeTypeRegistry;
+import org.apache.jackrabbit.core.nodetype.ItemDef;
+import org.apache.jackrabbit.core.nodetype.NodeDef;
+import org.apache.jackrabbit.core.nodetype.NodeTypeRegistry;
-import org.apache.jackrabbit.core.nodetype.ChildNodeDef;
-import org.apache.jackrabbit.core.nodetype.ChildItemDef;
+import org.apache.jackrabbit.core.util.uuid.UUID;
+import org.apache.jackrabbit.core.virtual.AbstractVISProvider;
+import org.apache.jackrabbit.core.virtual.VirtualNodeState;
-import javax.jcr.RepositoryException;
-import javax.jcr.nodetype.ItemDef;
+import javax.jcr.RepositoryException;
+import java.io.UnsupportedEncodingException;
-import java.io.UnsupportedEncodingException;
-     *
-     *
+     * <p/>
-        for (int i=0; i<ntNames.length; i++) {
+        for (int i = 0; i < ntNames.length; i++) {
+     *
-        for (int i=0; i<propDefs.length; i++) {
+        for (int i = 0; i < propDefs.length; i++) {
-            ntState.addChildNodeEntry(JCR_PROPERTYDEF, pdState.getUUID());
+            ntState.addChildNodeEntry(JCR_PROPERTYDEFINITION, pdState.getUUID());
-        ChildNodeDef[] cnDefs = ntDef.getChildNodeDefs();
-        for (int i=0; i<cnDefs.length; i++) {
+        NodeDef[] cnDefs = ntDef.getChildNodeDefs();
+        for (int i = 0; i < cnDefs.length; i++) {
-            ntState.addChildNodeEntry(JCR_CHILDNODEDEF, cnState.getUUID());
+            ntState.addChildNodeEntry(JCR_CHILDNODEDEFINITION, cnState.getUUID());
+     *
-        String uuid = calculateStableUUID(ntDef.getName().toString() + "/" + JCR_PROPERTYDEF.toString() + "/" + n);
-        VirtualNodeState pState = createNodeState(parent, JCR_PROPERTYDEF, uuid, NT_PROPERTYDEF);
+        String uuid = calculateStableUUID(ntDef.getName().toString() + "/" + JCR_PROPERTYDEFINITION.toString() + "/" + n);
+        VirtualNodeState pState = createNodeState(parent, JCR_PROPERTYDEFINITION, uuid, NT_PROPERTYDEFINITION);
-        if (!propDef.getName().equals(ChildItemDef.ANY_NAME)) {
+        if (!propDef.getName().equals(ItemDef.ANY_NAME)) {
-        pState.setPropertyValue(JCR_AUTOCREATE, InternalValue.create(propDef.isAutoCreate()));
+        pState.setPropertyValue(JCR_AUTOCREATED, InternalValue.create(propDef.isAutoCreated()));
-        for (int i=0; i<vc.length; i++) {
+        for (int i = 0; i < vc.length; i++) {
+     *
-                                                     ChildNodeDef cnDef,
+                                                     NodeDef cnDef,
-        String uuid = calculateStableUUID(ntDef.getName().toString() + "/" + JCR_CHILDNODEDEF.toString() + "/" + n);
-        VirtualNodeState pState = createNodeState(parent, JCR_CHILDNODEDEF, uuid, NT_CHILDNODEDEF);
+        String uuid = calculateStableUUID(ntDef.getName().toString() + "/" + JCR_CHILDNODEDEFINITION.toString() + "/" + n);
+        VirtualNodeState pState = createNodeState(parent, JCR_CHILDNODEDEFINITION, uuid, NT_CHILDNODEDEFINITION);
-        if (!cnDef.getName().equals(ChildItemDef.ANY_NAME)) {
+        if (!cnDef.getName().equals(ItemDef.ANY_NAME)) {
-        pState.setPropertyValue(JCR_AUTOCREATE, InternalValue.create(cnDef.isAutoCreate()));
+        pState.setPropertyValue(JCR_AUTOCREATED, InternalValue.create(cnDef.isAutoCreated()));
-        pState.setPropertyValue(JCR_SAMENAMESIBS, InternalValue.create(cnDef.allowSameNameSibs()));
+        pState.setPropertyValue(JCR_SAMENAMESIBLINGS, InternalValue.create(cnDef.allowsSameNameSiblings()));
-    
+
-     * 
+     *
-     */ 
+     */

MOV26 MOV26 MOV26 MOV26 MOV26 MOV26 MOV26 MOV26 MOV26 UPD40 UPD40 UPD43 INS66 UPD5 UPD42 UPD43 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD40 UPD42 UPD42 UPD40 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42 DEL40 DEL26