JCR-129: applied patch supplied by serge as-is
(http://issues.apache.org/jira/browse/JCR-129)misc. NodeState optimizations:
- removed PropertyEntry class; the relevant
  NodeState methods (e.g. getPropertyEntries())
  now return QName's instead of PropertyEntry
  to avoid unneccessary object creation
- reimplemented internal ChildNodeEntries class
  for improved speed and efficiency


git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@201999 13f79535-47bb-0310-9956-ffa450edef68

-        List list = nodeState.getPropertyEntries();
+        List list = nodeState.getPropertyNames();
-            NodeState.PropertyEntry entry = (NodeState.PropertyEntry) list.get(i);
-            PropertyId propId = new PropertyId(nodeState.getUUID(), entry.getName());
+            QName propName = (QName) list.get(i);
+            PropertyId propId = new PropertyId(nodeState.getUUID(), propName);
-            nodeState.addPropertyEntry(name);
+            nodeState.addPropertyName(name);
-     * removes the property with the given name and 1-based index
+     * removes the property with the given name
-            NodeState.PropertyEntry entry = nodeState.getPropertyEntry(name);
-            if (entry == null) {
+            if (!nodeState.hasPropertyName(name)) {
-                nodeState.removePropertyEntry(name);
+                nodeState.removePropertyName(name);
-            List props = state.getPropertyEntries();
+            List props = state.getPropertyNames();
-                NodeState.PropertyEntry entry = (NodeState.PropertyEntry) props.get(i);
-                PropertyState pstate = (PropertyState) stateMgr.getItemState(new PropertyId(state.getUUID(), entry.getName()));
+                QName propName = (QName) props.get(i);
+                PropertyState pstate = (PropertyState) stateMgr.getItemState(new PropertyId(state.getUUID(), propName));
-            List props = state.getPropertyEntries();
+            List props = state.getPropertyNames();
-                NodeState.PropertyEntry entry = (NodeState.PropertyEntry) props.get(i);
-                PropertyState pstate = (PropertyState) stateMgr.getItemState(new PropertyId(state.getUUID(), entry.getName()));
+                QName propName = (QName) props.get(i);
+                PropertyState pstate = (PropertyState) stateMgr.getItemState(new PropertyId(state.getUUID(), propName));

UPD66 UPD42 UPD43 INS38 INS42 UPD42 UPD42 INS32 UPD43 INS42 INS42 INS42 INS42 UPD42 UPD43 MOV43 UPD42 UPD43 MOV43 INS42 UPD42 INS42 UPD42 INS42 UPD42 UPD43 MOV43 UPD43 MOV43 INS42 INS42 INS42 INS42 DEL40 DEL40 DEL42 DEL42 DEL32 DEL40 DEL43 DEL42 DEL42 DEL42 DEL42 DEL32 DEL59 DEL60 DEL42 DEL33 DEL27 DEL40 DEL40 DEL42 DEL42 DEL32 DEL40 DEL40 DEL42 DEL42 DEL32