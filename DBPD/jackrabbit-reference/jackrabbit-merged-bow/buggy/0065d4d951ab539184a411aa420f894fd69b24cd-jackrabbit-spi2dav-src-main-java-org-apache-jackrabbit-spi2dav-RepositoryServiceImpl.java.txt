JCR-2003: Add support for JCR 2.0

- Workspace.createWorkspace
- Workspace.deleteWorkspace

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@773907 13f79535-47bb-0310-9956-ffa450edef68

+
-        try {
-            String wspHref = uriResolver.getWorkspaceUri(srcWorkspaceName);
-            Element mElem = MergeInfo.createMergeElement(new String[] {wspHref}, bestEffort, false, domFactory);
-            MergeInfo mInfo = new MergeInfo(mElem);
-
-            MergeMethod method = new MergeMethod(getItemUri(nodeId, sessionInfo), mInfo);
-            execute(method, sessionInfo);
-
-            MultiStatusResponse[] resps = method.getResponseBodyAsMultiStatus().getResponses();
-            List failedIds = new ArrayList(resps.length);
-            for (int i = 0; i < resps.length; i++) {
-                String href = resps[i].getHref();
-                failedIds.add(uriResolver.getNodeId(href, sessionInfo));
-            }
-            return failedIds.iterator();
-        } catch (IOException e) {
-            throw new RepositoryException(e);
-        } catch (DavException e) {
-            throw ExceptionConverter.generate(e);
-        }
+        return merge(sessionInfo, nodeId, srcWorkspaceName, bestEffort, false);
+    /**
+     * @see RepositoryService#merge(SessionInfo, NodeId, String, boolean, boolean)
+     */
-        // TODO
-        throw new UnsupportedOperationException("JCR-2104: JSR 283 Versioning. Implementation missing");
+        if (!isShallow) {
+            try {
+                String wspHref = uriResolver.getWorkspaceUri(srcWorkspaceName);
+                Element mElem = MergeInfo.createMergeElement(new String[] {wspHref}, bestEffort, false, domFactory);
+                MergeInfo mInfo = new MergeInfo(mElem);
+
+                MergeMethod method = new MergeMethod(getItemUri(nodeId, sessionInfo), mInfo);
+                execute(method, sessionInfo);
+
+                MultiStatusResponse[] resps = method.getResponseBodyAsMultiStatus().getResponses();
+                List failedIds = new ArrayList(resps.length);
+                for (int i = 0; i < resps.length; i++) {
+                    String href = resps[i].getHref();
+                    failedIds.add(uriResolver.getNodeId(href, sessionInfo));
+                }
+                return failedIds.iterator();
+            } catch (IOException e) {
+                throw new RepositoryException(e);
+            } catch (DavException e) {
+                throw ExceptionConverter.generate(e);
+            }
+        } else {
+            // TODO
+            throw new UnsupportedOperationException("JCR-2104: JSR 283 Versioning. Implementation missing");
+        }
+     * {@inheritDoc}
+     */
+    public void createWorkspace(SessionInfo sessionInfo, String name, String srcWorkspaceName) throws AccessDeniedException, UnsupportedRepositoryOperationException, NoSuchWorkspaceException, RepositoryException {
+        // TODO
+        throw new UnsupportedOperationException("JCR-2003. Implementation missing");
+    }
+
+    /**
+     * {@inheritDoc}
+     */
+    public void deleteWorkspace(SessionInfo sessionInfo, String name) throws AccessDeniedException, UnsupportedRepositoryOperationException, NoSuchWorkspaceException, RepositoryException {
+        // TODO
+        throw new UnsupportedOperationException("JCR-2003. Implementation missing");
+    }
+
+    /**

MOV31 INS31 INS31 MOV29 INS8 INS29 MOV44 INS8 INS29 INS83 INS39 INS42 INS44 INS44 INS44 INS43 INS43 INS43 INS43 INS8 INS29 INS83 INS39 INS42 INS44 INS44 INS43 INS43 INS43 INS43 INS8 INS41 INS65 INS25 INS65 INS43 INS42 INS43 INS42 INS43 INS42 INS42 INS42 INS42 INS42 INS53 INS65 INS43 INS42 INS43 INS42 INS42 INS42 INS42 INS42 INS53 INS32 INS68 INS38 MOV8 MOV8 INS65 INS42 INS42 INS42 INS14 INS65 INS42 INS42 INS14 INS42 INS42 INS42 INS42 INS42 INS9 INS42 INS42 INS69 INS69 INS69 INS69 INS69 INS42 INS43 INS45 INS43 INS45 INS43 INS43 INS43 INS39 INS39 INS42 INS42 INS42 INS42 INS42