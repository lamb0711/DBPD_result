improve memory consumption of the current hierarchy implementation

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@542571 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.jcr2spi.hierarchy.PropertyEntry;
+import org.apache.jackrabbit.jcr2spi.state.PropertyState;
-                PropertyEntry mixins = nodeState.getNodeEntry().getPropertyEntry(QName.JCR_MIXINTYPES);
-                if (mixins != null) {
-                    try {
-                        QValue[] values = mixins.getPropertyState().getValues();
-                        allNtNames = new QName[values.length + 1];
-                        for (int i = 0; i < values.length; i++) {
-                            allNtNames[i] = values[i].getQName();
-                        }
-                        allNtNames[values.length] = primaryType;
-                    } catch (RepositoryException e) {
-                        // ignore
+                try {
+                    PropertyState mixins = nodeState.getPropertyState(QName.JCR_MIXINTYPES);
+                    QValue[] values = mixins.getValues();
+                    allNtNames = new QName[values.length + 1];
+                    for (int i = 0; i < values.length; i++) {
+                        allNtNames[i] = values[i].getQName();
+                    allNtNames[values.length] = primaryType;
+                } catch (RepositoryException e) {
+                    // ignore: apparently no jcr:mixinTypes property exists.
-                String msg = "internal error: encountered invalid registered node type " + ntName;
+                String msg = "Internal error: encountered invalid registered node type " + ntName;

UPD40 MOV8 INS54 MOV8 MOV12 MOV60 MOV41 MOV27 MOV8 MOV60 MOV21 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 INS60 INS43 INS59 INS42 INS42 INS32 UPD45 INS42 INS42 INS40 MOV42 DEL42 DEL43 DEL42 DEL42 DEL32 DEL40 DEL32 DEL59 DEL60 DEL42 DEL33 DEL27 DEL42 DEL32 DEL25 DEL54 DEL8