JCR-926: configuration for data store in repository.xml

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@573209 13f79535-47bb-0310-9956-ffa450edef68

-    private static final String PREFIX = "tempFile:";
+    private static final String PREFIX = "file:";
+    private final boolean temp;
-     * Creates a new instance from a
-     * <code>byte[]</code> array.
+     * Creates a new instance from a stream.
-     * @param data the byte array
-     * @throws IOException 
+     * @param in the input stream
-    private BLOBInTempFile(InputStream in) throws IOException {
+    private BLOBInTempFile(InputStream in, boolean temp) throws IOException {
+        this.temp = temp;
-    
+
-     * Creates a new instance from a
-     * <code>in[]</code> stream.
+     * Creates a new instance from file.
+     *
+     * @param in the input stream
+     */    
+    private BLOBInTempFile(File file, boolean temp) {
+        this.file = file;
+        this.length = file.length();
+        this.temp = temp;
+    }
+
+    /**
+     * Creates a new instance from a stream.
-    static BLOBInTempFile getInstance(InputStream in) throws IOException {
-        return new BLOBInTempFile(in);
+    static BLOBInTempFile getInstance(InputStream in, boolean temp) throws IOException {
+        return new BLOBInTempFile(in, temp);
+     * Creates a new instance from a file.
+     *
+     * @param file the file
+     */    
+    static BLOBInTempFile getInstance(File file, boolean temp) throws IOException {
+        return new BLOBInTempFile(file, temp);
+    }    
+    
+    /**
-        file.delete();
-        length = -1;
-        file = null;
+        if (temp) {
+            delete(true);
+        }

MOV31 INS23 INS31 INS31 INS83 INS83 INS39 INS59 INS44 INS29 UPD83 INS42 INS44 INS44 INS44 INS29 INS83 INS43 INS42 INS44 INS44 INS43 INS8 MOV29 INS83 INS39 INS42 INS8 UPD45 INS42 INS39 INS42 INS21 INS65 INS65 INS43 INS42 INS39 INS42 INS39 INS42 INS65 INS65 INS42 INS43 INS42 INS39 INS42 INS42 INS41 INS25 UPD66 UPD42 UPD66 INS7 INS66 INS42 INS66 INS42 INS7 UPD66 INS66 INS42 INS66 INS42 INS14 INS42 INS8 INS22 INS42 INS22 INS42 INS22 INS32 INS22 INS42 INS42 INS43 INS42 INS42 INS21 INS52 INS42 INS52 INS42 INS52 INS42 INS42 INS42 INS52 INS42 INS42 INS32 INS42 INS9 DEL66 DEL42 DEL66 DEL65 DEL39 DEL42 DEL42 DEL42 DEL32 DEL42 DEL34 DEL38 DEL42 DEL33 DEL66