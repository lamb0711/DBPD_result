- [JCR-134] extensibility patch for DavResourceImpl
- moving JcrConstants.java to commons
- fixing minor import issues
- readding lost stuff
- adding proper shutdown to RepositoryStartupServlet.java

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@190721 13f79535-47bb-0310-9956-ffa450edef68

+    private String pathPrefix;
-	String pathPrefix = getInitParameter(INIT_PARAM_PREFIX);
+	pathPrefix = getInitParameter(INIT_PARAM_PREFIX);
+     * Returns true if the preconditions are met. This includes validation of
+     * {@link WebdavRequest#matchesIfHeader(DavResource) If header} and validation
+     * of {@link org.apache.jackrabbit.webdav.transaction.TransactionConstants#HEADER_TRANSACTIONID
+     * TransactionId header}. This method will also return false if the requested
+     * resource lays within a differenct workspace as is assigned to the repository
+     * session attached to the given request.
-     * @param request
-     * @param resource
-     * @return
+     * @see AbstractWebdavServlet#isPreconditionValid(WebdavRequest, DavResource)
-     * {@inheritDoc}
+     * Returns the <code>DavSessionProvider</code>
+     *
+     * @return server
+     * @see AbstractWebdavServlet#getDavSessionProvider()
-    public DavSessionProvider getSessionProvider() {
+    public DavSessionProvider getDavSessionProvider() {
-     * {@inheritDoc}
+     * Throws <code>UnsupportedOperationException</code>.
+     *
+     * @see AbstractWebdavServlet#setDavSessionProvider(DavSessionProvider)
+     */
+    public void setDavSessionProvider(DavSessionProvider davSessionProvider) {
+        throw new UnsupportedOperationException("Not implemented. DavSession(s) are provided by the 'JCRWebdavServer'");
+    }
+
+    /**
+     * Returns the <code>DavLocatorFactory</code>
+     *
+     * @see AbstractWebdavServlet#getLocatorFactory()
+        if (locatorFactory == null) {
+            locatorFactory = new DavLocatorFactoryImpl(pathPrefix);
+        }
-     * {@inheritDoc}
+     * Sets the <code>DavLocatorFactory</code>
+     *
+     * @see AbstractWebdavServlet#setLocatorFactory(DavLocatorFactory)
+     */
+    public void setLocatorFactory(DavLocatorFactory locatorFactory) {
+        this.locatorFactory = locatorFactory;
+    }
+
+    /**
+     * Returns the <code>DavResourceFactory</code>. 
+     *
+     * @see AbstractWebdavServlet#getResourceFactory()
+        if (resourceFactory == null) {
+            resourceFactory = new DavResourceFactoryImpl(txMgr, subscriptionMgr);
+        }
+     * Sets the <code>DavResourceFactory</code>.
+     *
+     * @see AbstractWebdavServlet#setResourceFactory(org.apache.jackrabbit.webdav.DavResourceFactory)
+     */
+    public void setResourceFactory(DavResourceFactory resourceFactory) {
+        this.resourceFactory = resourceFactory;
+    }
+
+    /**

INS23 INS31 INS31 INS31 INS83 MOV43 INS59 UPD42 INS29 INS83 INS39 INS42 INS44 INS8 INS8 INS29 INS83 INS39 INS42 INS44 INS8 INS8 INS29 INS83 INS39 INS42 INS44 INS8 INS42 INS21 INS65 UPD65 INS65 INS65 INS65 INS65 INS65 INS43 INS42 INS53 INS65 INS65 INS25 MOV41 INS65 INS65 INS43 INS42 INS21 INS65 INS65 INS25 MOV41 INS65 INS65 INS43 INS42 INS21 INS7 INS66 INS65 INS66 INS66 INS65 INS66 INS66 INS66 INS68 INS66 INS66 INS68 INS66 INS68 INS42 INS14 INS66 INS68 INS27 INS8 INS66 INS68 INS42 INS7 INS66 INS68 INS27 INS8 INS66 INS68 INS42 INS7 INS42 MOV32 INS68 INS66 INS67 INS66 INS42 INS42 INS69 INS69 INS42 INS42 INS42 INS42 INS69 INS43 INS45 INS42 INS42 INS42 INS33 INS21 INS42 INS42 INS69 INS22 INS42 INS42 INS42 INS42 INS33 INS21 INS42 INS42 INS69 INS22 INS42 INS42 INS42 INS69 INS40 INS42 INS43 INS43 INS43 INS42 INS7 INS43 INS52 INS42 INS7 INS43 INS52 INS42 INS43 INS42 INS42 INS42 INS42 INS14 INS42 INS42 INS14 INS40 INS42 INS43 INS42 INS43 INS42 INS42 INS42 INS42 DEL42 DEL59 DEL60 DEL42 DEL65 DEL42 DEL65 DEL65 DEL65 DEL65 DEL65 DEL8 DEL65 DEL65 DEL8