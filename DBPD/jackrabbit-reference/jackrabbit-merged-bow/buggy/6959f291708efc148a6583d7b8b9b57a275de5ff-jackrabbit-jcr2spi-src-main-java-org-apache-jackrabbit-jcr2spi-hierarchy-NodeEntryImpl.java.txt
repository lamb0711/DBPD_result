JCR-1231 - Unneeded call to getPropertyInfo upon creating a new NodeState

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@597424 13f79535-47bb-0310-9956-ffa450edef68

-        return internalAddPropertyEntry(propName);
+        return internalAddPropertyEntry(propName, true);
+     * @param notifySpecial
-    private PropertyEntry internalAddPropertyEntry(Name propName) {
+    private PropertyEntry internalAddPropertyEntry(Name propName, boolean notifySpecial) {
-        if (StateUtility.isUuidOrMixin(propName)) {
+        if (notifySpecial && StateUtility.isUuidOrMixin(propName)) {
-                addPropertyEntry(propName);
+                // TODO: check again.
+                // addPropertyEntries is used by WorkspaceItemStateFactory upon
+                // creating a NodeState, in which case the uuid/mixins are set
+                // anyway and not need exists to explicitely load the corresponding
+                // property state in order to retrieve the values.
+                internalAddPropertyEntry(propName, false);
-                    internalAddPropertyEntry(eventName);
+                    internalAddPropertyEntry(eventName, true);
-                    internalAddPropertyEntry(eventName);
+                    internalAddPropertyEntry(eventName, true);

INS44 INS65 INS39 INS42 INS42 INS27 INS9 INS42 MOV32 INS9 INS9 UPD42 INS9