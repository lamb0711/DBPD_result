JCR-1605 RepositoryLock does not work on NFS sometimes (configurable repository lock)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@744956 13f79535-47bb-0310-9956-ffa450edef68

-public class RepositoryLock {
+public class RepositoryLock implements RepositoryLockMechanism {
-    private final File directory;
+    private File directory;
-    private final File file;
+    private File file;
-    private final String identifier;
+    private String identifier;
-     * The file lock. Used to ensure exlusive lockin across process boundaries.
+     * The file lock. Used to ensure exclusive locking across process boundaries.
+    public RepositoryLock() {
+        // used by the factory
+    }
+    
-     * Creates a lock instance for the given directory path. An instantiated
-     * lock still needs to be explicitly acquired using the {@link #acquire()}
-     * method.
-     *
+     * Create a new RepositoryLock object and initialize it.
+     * @deprecated 
+     * This constructor is deprecated; use the default constructor
+     * and {@link #init(String)} instead.
+     * 
+        init(path);
+    }
+    
+    /**
+     * Initialize the instance for the given directory path. The lock still needs to be 
+     * explicitly acquired using the {@link #acquire()} method.
+     *
+     * @param path directory path
+     * @throws RepositoryException if the canonical path of the directory
+     *                             can not be determined
+     */
+    public void init(String path) throws RepositoryException {

INS43 INS31 INS31 INS42 INS83 INS42 INS8 INS29 INS83 INS42 INS44 INS43 INS8 INS39 UPD42 INS65 INS65 INS65 INS65 INS43 INS42 INS42 INS21 UPD66 INS66 INS66 INS66 INS66 INS65 INS66 INS42 INS66 INS42 INS66 INS66 INS42 INS32 UPD66 UPD66 UPD66 INS68 INS42 INS42 INS42 INS69 INS43 INS42 DEL83 DEL83 DEL83