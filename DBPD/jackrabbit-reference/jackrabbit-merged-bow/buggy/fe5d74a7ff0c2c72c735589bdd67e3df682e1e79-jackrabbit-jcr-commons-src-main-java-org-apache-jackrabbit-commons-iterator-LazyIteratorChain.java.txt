JCR-2726: Make collecting group membership information lazy

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@989102 13f79535-47bb-0310-9956-ffa450edef68

+    private Boolean hasNext;
-        while ((currentIterator == null || !currentIterator.hasNext()) && iterators.hasNext()) {
-            currentIterator = iterators.next();
+        // Memoizing the result of hasNext is crucial to performance when recursively
+        // traversing tree structures.
+        if (hasNext == null) {
+            while ((currentIterator == null || !currentIterator.hasNext()) && iterators.hasNext()) {
+                currentIterator = iterators.next();
+            }
+            hasNext = currentIterator != null && currentIterator.hasNext();
-        return currentIterator != null && currentIterator.hasNext();
+        return hasNext;
+            hasNext = null;

INS23 INS83 INS43 INS59 INS8 INS42 INS42 INS25 INS41 INS27 MOV8 INS42 INS42 INS33 INS21 INS21 INS7 INS7 INS42 MOV27 INS42 INS33 DEL41