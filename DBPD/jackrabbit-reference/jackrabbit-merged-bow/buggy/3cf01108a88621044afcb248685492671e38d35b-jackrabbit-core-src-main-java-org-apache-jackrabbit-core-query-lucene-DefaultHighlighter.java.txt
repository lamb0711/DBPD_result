JCR-859: rep:excerpt() may return malformed XML

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@531165 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.util.Text;
-                    sb.append(cbuf, 0, surround - skippedChars);
+                    sb.append(Text.encodeIllegalXMLCharacters(
+                            new String(cbuf, 0, surround - skippedChars)));
-            sb.append(cbuf, skippedChars, cbuf.length - skippedChars);
+            sb.append(Text.encodeIllegalXMLCharacters(
+                    new String(cbuf, skippedChars, cbuf.length - skippedChars)));
-                sb.append(cbuf, 0, EOF ? skip : (surround - skippedChars));
+                sb.append(Text.encodeIllegalXMLCharacters(
+                        new String(cbuf, 0, EOF ? skip : (surround - skippedChars))));

INS26 INS40 INS32 INS42 INS42 INS14 INS32 INS43 INS42 INS42 MOV27 INS42 INS42 MOV32 INS42 UPD42 UPD42 INS14 INS32 INS43 INS42 INS34 MOV16 INS42 INS42 INS14 INS42 INS43 INS42 INS34 MOV27 INS42 DEL42 DEL34 DEL42 DEL42 DEL42 DEL34