JCR-2255  activity storage path


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@803470 13f79535-47bb-0310-9956-ffa450edef68

-    /**
-     * Persistent root node of the version histories.
-     */
-    protected NodeStateEx historyRoot;
+    protected final NodeId historiesId;
-    /**
-     * Persistent root node of the activities.
-     */
-    protected NodeStateEx activitiesRoot;
+    protected final NodeId activitiesId;
-    public InternalVersionManagerBase(NodeTypeRegistry ntReg) {
+    protected InternalVersionManagerBase(NodeTypeRegistry ntReg,
+                                         NodeId historiesId,
+                                         NodeId activitiesId) {
+        this.historiesId = historiesId;
+        this.activitiesId = activitiesId;
-    //-------------------------------------------------------< InternalVersionManager >
+//-------------------------------------------------------< InternalVersionManager >
-            NodeStateEx parent = getParentNode(historyRoot, uuid, null);
+            NodeStateEx parent = getParentNode(getHistoryRoot(), uuid, null);
+     * returns the id of the version history root node
+     *
+     * @return the id of the version history root node
+     */
+    abstract protected NodeStateEx getHistoryRoot();
+
+    /**
+     * returns the id of the activities root node
+     *
+     * @return the id of the activities root node
+     */
+    abstract protected NodeStateEx getActivitiesRoot();
+
+
+    /**
-            NodeStateEx parent = getParentNode(historyRoot, uuid, null);
+            NodeStateEx parent = getParentNode(getHistoryRoot(), uuid, null);
-            NodeStateEx parent = getParentNode(historyRoot, uuid, NameConstants.REP_VERSIONSTORAGE);
+            NodeStateEx parent = getParentNode(getHistoryRoot(), uuid, NameConstants.REP_VERSIONSTORAGE);
-            NodeStateEx parent = getParentNode(activitiesRoot, activityId.toString(), NameConstants.REP_ACTIVITIES);
+            NodeStateEx parent = getParentNode(getActivitiesRoot(), activityId.toString(), NameConstants.REP_ACTIVITIES);
-                if (parent.getChildNodes().length == 0 && !parentId.equals(activitiesRoot.getNodeId())) {
+                if (parent.getChildNodes().length == 0 && !parentId.equals(activitiesId)) {
+     * @param created optional created date.

INS23 INS23 INS31 INS31 INS83 INS83 INS43 INS59 INS83 INS83 INS43 INS59 UPD83 INS44 INS44 INS29 INS83 INS83 MOV43 INS42 INS29 INS83 INS83 MOV43 INS42 INS42 INS42 INS42 INS42 INS43 INS42 INS43 INS42 INS21 INS21 INS65 UPD65 MOV65 INS65 UPD65 MOV65 INS65 INS42 INS42 INS7 INS7 INS66 UPD66 INS66 UPD66 INS42 INS66 INS22 INS42 INS22 INS42 INS52 INS42 INS52 INS42 INS32 INS32 INS32 INS32 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 DEL29 DEL83 DEL42 DEL59 DEL23 DEL29 DEL83 DEL42 DEL59 DEL23 DEL42 DEL32