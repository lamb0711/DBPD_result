minor improvement

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1022857 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.security.authorization.PrivilegeRegistry;
-import java.util.Arrays;
-        
+
+    /**
+     * The system session used to register an event listener and process the
+     * events as well as collect AC entries.
+     */
+
+    /**
+     * The root id.
+     */
+
+    private final PrivilegeRegistry privilegeRegistry;
-    private final ACLEditor systemEditor;
-       
+    /**
+     * Standard JCR name form of the {@link #N_POLICY} constant.
+     */
-     * @param systemEditor
-    protected EntryCollector(SessionImpl systemSession, ACLEditor systemEditor, NodeId rootID) throws RepositoryException {
+    protected EntryCollector(SessionImpl systemSession, NodeId rootID) throws RepositoryException {
-        this.systemEditor = systemEditor;
+
+        privilegeRegistry = new PrivilegeRegistry(systemSession);
+    @Override
-        List<AccessControlEntry> entries = new ArrayList(userAces.size() + groupAces.size());
+        List<AccessControlEntry> entries = new ArrayList<AccessControlEntry>(userAces.size() + groupAces.size());
-            entries = Arrays.asList(systemEditor.getACL(aclNode).getAccessControlEntries());
+            entries = new ACLTemplate(aclNode, privilegeRegistry).getEntries();
-            notifyListeners(new AccessControlModifications(modMap));
+            notifyListeners(new AccessControlModifications<NodeId>(modMap));

MOV26 UPD40 INS29 INS29 UPD43 INS29 MOV21 INS78 INS65 INS65 UPD42 UPD42 INS65 INS42 INS66 INS66 INS66 INS66 INS65 INS66 INS67 INS42 INS14 INS42 INS43 INS42 INS74 INS42 MOV43 INS43 INS42 INS14 UPD42 MOV42 INS74 INS43 INS42 INS42 MOV43 INS43 INS42 INS42 DEL42 DEL65 DEL42 DEL43 DEL42 DEL44 DEL52 DEL42 DEL22 DEL42 DEL42 DEL42 DEL42 DEL42 DEL42 DEL32 DEL32