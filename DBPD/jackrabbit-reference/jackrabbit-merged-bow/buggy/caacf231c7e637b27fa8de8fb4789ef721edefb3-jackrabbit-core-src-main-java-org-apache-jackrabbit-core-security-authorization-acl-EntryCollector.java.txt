JCR-3395 : separate entries used for permission eval from ACEs exposed in JCR

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1370139 13f79535-47bb-0310-9956-ffa450edef68

-import javax.jcr.security.AccessControlEntry;
-    protected List<AccessControlEntry> collectEntries(NodeImpl node, EntryFilter filter) throws RepositoryException {
-        LinkedList<AccessControlEntry> userAces = new LinkedList<AccessControlEntry>();
-        LinkedList<AccessControlEntry> groupAces = new LinkedList<AccessControlEntry>();
+    protected List<Entry> collectEntries(NodeImpl node, EntryFilter filter) throws RepositoryException {
+        LinkedList<Entry> userAces = new LinkedList<Entry>();
+        LinkedList<Entry> groupAces = new LinkedList<Entry>();
-                filterEntries(filter, new ACLTemplate(aclNode, null).getEntries(), userAces, groupAces);
+                filterEntries(filter, Entry.readEntries(aclNode, null), userAces, groupAces);
-        List<AccessControlEntry> entries = new ArrayList<AccessControlEntry>(userAces.size() + groupAces.size());
+        List<Entry> entries = new ArrayList<Entry>(userAces.size() + groupAces.size());
-    private static void filterEntries(EntryFilter filter, List<AccessControlEntry> aces,
-                                      LinkedList<AccessControlEntry> userAces,
-                                      LinkedList<AccessControlEntry> groupAces) {
+    private static void filterEntries(EntryFilter filter, List<Entry> aces,
+                                      LinkedList<Entry> userAces,
+                                      LinkedList<Entry> groupAces) {
-        List<AccessControlEntry> aces;
+        List<Entry> aces;
-            aces = new ACLTemplate(aclNode, node.getPath()).getEntries();
+            aces = Entry.readEntries(aclNode, node.getPath());
-        private final List<AccessControlEntry> aces;
+        private final List<Entry> aces;
-        Entries(List<AccessControlEntry> aces, NodeId nextId) {
+        Entries(List<Entry> aces, NodeId nextId) {
-        List<AccessControlEntry> getACEs() {
+        List<Entry> getACEs() {

MOV44 UPD74 UPD43 UPD74 UPD74 UPD42 UPD74 UPD42 UPD74 UPD74 UPD42 UPD74 UPD74 UPD74 UPD43 UPD43 UPD43 UPD74 UPD43 UPD74 UPD43 UPD43 UPD43 UPD43 UPD42 UPD42 UPD42 UPD43 UPD42 UPD43 UPD42 UPD42 UPD74 UPD42 UPD74 UPD42 UPD74 UPD42 UPD42 UPD43 UPD43 UPD43 UPD42 UPD42 UPD42 INS42 INS42 INS42 MOV32 INS42 INS42 INS42 INS33 DEL40 DEL26 DEL42 DEL43 DEL42 DEL33 DEL14 DEL42 DEL42 DEL43 DEL42 DEL14 DEL42