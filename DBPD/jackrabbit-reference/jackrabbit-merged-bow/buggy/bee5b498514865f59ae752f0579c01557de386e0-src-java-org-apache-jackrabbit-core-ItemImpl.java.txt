1) fixing bug reported by oliver kiessler: 
"target node of REFERENCE property does not exist"

2) hasorderablechildnodes flag in node type definition was ignored

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@153046 13f79535-47bb-0310-9956-ffa450edef68

-                        NodeReferencesId id = new NodeReferencesId(uuid);
+                        NodeReferencesId refsId = new NodeReferencesId(uuid);
+                        NodeId targetId = new NodeId(uuid);
-                        if (!itemMgr.itemExists(id)) {
+                        if (!itemMgr.itemExists(targetId)) {
-                        NodeImpl target = (NodeImpl) itemMgr.getItem(id);
+                        NodeImpl target = (NodeImpl) itemMgr.getItem(targetId);
-                        if (dirtyNodeRefs.containsKey(id)) {
-                            refs = (NodeReferences) dirtyNodeRefs.get(id);
+                        if (dirtyNodeRefs.containsKey(refsId)) {
+                            refs = (NodeReferences) dirtyNodeRefs.get(refsId);
-                                refs = stateMgr.getNodeReferences(id);
+                                refs = stateMgr.getNodeReferences(refsId);
-                                String msg = itemMgr.safeGetJCRPath(id)
+                                String msg = itemMgr.safeGetJCRPath(targetId)
-                            dirtyNodeRefs.put(id, refs);
+                            dirtyNodeRefs.put(refsId, refs);
-                            NodeState parentState = null;
+                            NodeState parentState;

INS60 INS43 INS59 MOV43 UPD42 INS42 INS42 INS14 UPD42 INS43 INS42 UPD42 MOV43 INS42 UPD42 UPD42 UPD42 UPD42 UPD42 DEL33