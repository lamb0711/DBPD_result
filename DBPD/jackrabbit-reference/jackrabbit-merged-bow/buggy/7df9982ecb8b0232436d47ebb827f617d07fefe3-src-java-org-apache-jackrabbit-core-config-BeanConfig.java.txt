Refactoring step 7 (JCR-53)
 - Added the new FileSystemConfig object
 - Added an init() step to keep the constructors and parsing code simple
 - Moved file handling and workspace creation back to RepositoryConfig
 - Added and improved lots of javadocs
 - Fixed property problems (new Property(p) != (Property) p.clone())
 - Many minor changes


git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@156418 13f79535-47bb-0310-9956-ffa450edef68

-        this.properties = new Properties(properties);
+        this.properties = (Properties) properties.clone();
-     * @throws ClassNotFoundException if the bean class is not found
-     * @throws InstantiationException if the bean could not be instantiated
-     * @throws IllegalAccessException if the bean methods are protected
+     * @throws ConfigurationException on bean configuration errors
-    public Object newInstance()
-            throws ClassNotFoundException, InstantiationException,
-            IllegalAccessException {
-        Object object = Class.forName(className).newInstance();
-        BeanMap map = new BeanMap(object);
-        Iterator iterator = map.keyIterator();
-        while (iterator.hasNext()) {
-            String name = (String) iterator.next();
-            String value = properties.getProperty(name);
-            if (value != null) {
-                map.put(name, properties.getProperty(name));
+    public Object newInstance() throws ConfigurationException {
+        try {
+            Object object = Class.forName(getClassName()).newInstance();
+            BeanMap map = new BeanMap(object);
+            Iterator iterator = map.keyIterator();
+            while (iterator.hasNext()) {
+                String name = (String) iterator.next();
+                String value = properties.getProperty(name);
+                if (value != null) {
+                    map.put(name, properties.getProperty(name));
+                }
+            return object;
+        } catch (ClassNotFoundException e) {
+            throw new ConfigurationException(
+                    "Configured bean implementation class " + getClassName()
+                    + " was not found.", e);
+        } catch (InstantiationException e) {
+            throw new ConfigurationException(
+                    "Configured bean implementation class " + getClassName()
+                    + " can not be instantiated.", e);
+        } catch (IllegalAccessException e) {
+            throw new ConfigurationException(
+                    "Configured bean implementation class " + getClassName()
+                    + " is protected.", e);
-        return object;

INS43 INS8 INS42 INS54 UPD42 UPD66 MOV8 INS12 INS12 INS12 INS11 INS44 INS8 INS44 INS8 INS44 INS8 MOV43 INS32 MOV43 INS42 INS53 MOV43 INS42 INS53 MOV43 INS42 INS53 INS42 INS42 INS14 INS14 INS14 INS43 INS27 INS42 INS43 INS27 INS42 INS43 INS27 INS42 INS32 INS42 INS45 INS32 INS45 INS42 INS45 INS32 INS45 INS42 INS45 INS32 INS45 UPD42 MOV42 INS42 INS42 INS42 DEL42 DEL14 DEL42 DEL66 DEL65 DEL42 DEL66 DEL65