JCR-3000 SQL2 Join with OR clause still has some issues

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1138141 13f79535-47bb-0310-9956-ffa450edef68

-                    + " ms. fetched" + rightRows.size() + " rows.");
+                    + " ms. fetched " + rightRows.size() + " rows.");
-            leftRows.addAll(buildLeftRowsJoin(csi.getLeftInnerConstraints(),
-                    comparator, printIndentation + printIndentStep));
-            leftRows.addAll(buildLeftRowsJoin(csi.getRightInnerConstraints(),
-                    comparator, printIndentation + printIndentStep));
+            if (csi.getLeftInnerConstraints().isHasLeftConstraints()) {
+                leftRows.addAll(buildLeftRowsJoin(
+                        csi.getLeftInnerConstraints(), comparator,
+                        printIndentation + printIndentStep));
+            }
+            if (csi.getRightInnerConstraints().isHasLeftConstraints()) {
+                leftRows.addAll(buildLeftRowsJoin(
+                        csi.getRightInnerConstraints(), comparator,
+                        printIndentation + printIndentStep));
+            }
+        
-            rightRows.addAll(buildRightRowsJoin(csi.getLeftInnerConstraints(),
-                    rightConstraints, ignoreWhereConstraints, comparator,
-                    printIndentation + printIndentStep));
-            rightRows.addAll(buildRightRowsJoin(csi.getRightInnerConstraints(),
-                    rightConstraints, ignoreWhereConstraints, comparator,
-                    printIndentation + printIndentStep));
+                rightRows.addAll(buildRightRowsJoin(
+                        csi.getLeftInnerConstraints(), rightConstraints,
+                        ignoreWhereConstraints, comparator, printIndentation
+                                + printIndentStep));
+                rightRows.addAll(buildRightRowsJoin(
+                        csi.getRightInnerConstraints(), rightConstraints,
+                        ignoreWhereConstraints, comparator, printIndentation
+                                + printIndentStep));
-        sb.append("SQL2 JOIN left constraint: ");
+        sb.append("SQL2 JOIN left constraint:  ");

INS25 INS25 UPD45 INS32 INS8 INS32 INS8 INS32 INS42 MOV21 INS32 INS42 MOV21 UPD45 INS42 INS42 INS42 INS42