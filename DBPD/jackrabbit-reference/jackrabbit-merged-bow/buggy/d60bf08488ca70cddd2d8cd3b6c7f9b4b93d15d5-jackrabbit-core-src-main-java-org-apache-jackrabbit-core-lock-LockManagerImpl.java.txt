JCR-1590: JSR 283: Locking

More code cleanup: Inline LockToken into LockInfo and make LockInfo member variables private.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@803535 13f79535-47bb-0310-9956-ffa450edef68

-                reapplyLock(LockToken.parse(s));
+                reapplyLock(s);
-    private void reapplyLock(LockToken lockToken) {
+    private void reapplyLock(String lockToken) {
-            NodeImpl node = (NodeImpl)
-                sysSession.getItemManager().getItem(lockToken.getId());
-            Path path = getPath(sysSession, lockToken.getId());
+            NodeId id = LockInfo.parseLockToken(lockToken);
+            NodeImpl node = (NodeImpl) sysSession.getItemManager().getItem(id);
+            Path path = getPath(sysSession, id);
-            InternalLockInfo info = new InternalLockInfo(lockToken, false,
+            InternalLockInfo info = new InternalLockInfo(
+                    id, false,
-                writer.write(info.getLockToken().toString());
+                writer.write(info.getLockToken());
-        InternalLockInfo info = new InternalLockInfo(new LockToken(node.getNodeId()),
-                isSessionScoped, isDeep, lockOwner, timeoutHint);
+        InternalLockInfo info = new InternalLockInfo(
+                node.getNodeId(), isSessionScoped, isDeep, lockOwner, timeoutHint);
-            if (info.deep && element.hasPath(path)
+            if (info.isDeep() && element.hasPath(path)
-                getSessionLockManager(session).lockTokenAdded(
-                        info.getLockToken().toString());
+                getSessionLockManager(session).lockTokenAdded(info.getLockToken());
-            getSessionLockManager(session).lockTokenRemoved(
-                    info.getLockToken().toString());
+            getSessionLockManager(session).lockTokenRemoved(info.getLockToken());
-        writeLockProperties(node, info.lockOwner, info.deep);
+        writeLockProperties(node, info.getLockOwner(), info.isDeep());
-            LockToken lockToken = LockToken.parse(lt);
+            NodeId id = LockInfo.parseLockToken(lt);
-            NodeImpl node = (NodeImpl)
-                this.sysSession.getItemManager().getItem(lockToken.getId());
+            NodeImpl node = (NodeImpl) sysSession.getItemManager().getItem(id);
-            LockToken lockToken = LockToken.parse(lt);
+            NodeId id = LockInfo.parseLockToken(lt);
-            NodeImpl node = (NodeImpl) this.sysSession.getItemManager()
-                    .getItem(lockToken.getId());
+            NodeImpl node = (NodeImpl) sysSession.getItemManager().getItem(id);
-        public InternalLockInfo(LockToken lockToken, boolean sessionScoped,
+        public InternalLockInfo(NodeId lockToken, boolean sessionScoped,
-        public InternalLockInfo(LockToken lockToken, boolean sessionScoped,
+        public InternalLockInfo(NodeId lockToken, boolean sessionScoped,
-                    session.removeLockToken(getLockToken().toString());
+                    session.removeLockToken(getLockToken());
-            InternalLockInfo info = new InternalLockInfo(new LockToken(nodeId), false, isDeep, lockOwner);
+            InternalLockInfo info = new InternalLockInfo(nodeId, false, isDeep, lockOwner);

UPD43 UPD42 UPD43 UPD43 INS60 INS32 INS32 UPD42 UPD42 INS43 INS59 MOV43 MOV32 MOV32 MOV32 INS42 INS42 INS42 INS42 UPD43 UPD43 MOV43 MOV43 INS42 INS42 INS32 INS32 MOV32 UPD42 UPD42 UPD42 UPD42 UPD42 INS42 INS42 INS42 MOV43 UPD42 MOV42 UPD42 MOV32 MOV32 INS42 INS42 MOV32 MOV32 UPD42 UPD42 UPD42 UPD42 MOV43 MOV43 MOV42 MOV42 UPD42 MOV42 UPD42 INS42 MOV32 UPD42 UPD42 MOV42 UPD42 MOV42 INS42 INS42 MOV32 MOV32 UPD42 INS42 DEL42 DEL42 DEL32 DEL42 DEL32 DEL42 DEL32 DEL42 DEL42 DEL32 DEL42 DEL43 DEL14 DEL40 DEL42 DEL32 DEL42 DEL32 DEL40 DEL40 DEL52 DEL42 DEL22 DEL42 DEL32 DEL52 DEL42 DEL22 DEL42 DEL32 DEL42 DEL42 DEL32 DEL42 DEL43 DEL14