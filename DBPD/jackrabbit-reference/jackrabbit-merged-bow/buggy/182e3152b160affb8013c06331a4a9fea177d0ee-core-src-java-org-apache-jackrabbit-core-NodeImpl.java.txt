fixing another concurrency issue that could lead to inconsistent repository content

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@264785 13f79535-47bb-0310-9956-ffa450edef68

-    protected void makePersistent() {
+    protected void makePersistent() throws InvalidItemStateException {
+            // check staleness of transient state first
+            if (transientState.isStale()) {
+                String msg = safeGetJCRPath()
+                        + ": the node cannot be saved because it has been modified externally.";
+                log.debug(msg);
+                throw new InvalidItemStateException(msg);
+            }

INS43 INS42 INS25 INS32 INS8 INS42 INS42 INS60 INS21 INS53 INS43 INS59 INS32 INS14 INS42 INS42 INS27 INS42 INS42 INS42 INS43 INS42 INS32 INS45 INS42 INS42