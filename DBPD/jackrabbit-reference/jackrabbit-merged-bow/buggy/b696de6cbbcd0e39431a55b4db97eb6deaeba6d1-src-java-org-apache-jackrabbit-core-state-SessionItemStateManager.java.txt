misc. small changes for better performance

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@56379 13f79535-47bb-0310-9956-ffa450edef68

-    private final HierarchyManager hierMgr;
+    private HierarchyManager hierMgr;
+     * En-/Disable chaching of path values.
+     * <p/>
+     * Please keep in mind that the cache of <code>Path</code>s is not automatically
+     * updated when the underlying hierarchy is changing. Therefore it should only be
+     * turned on with caution and in special situations (usually only locally
+     * within a narrow scope) where the underlying hierarchy is not expected to
+     * change.
+     *
+     * @param enable
+     */
+    public void enablePathCaching(boolean enable) {
+        if (enable) {
+            if (!(hierMgr instanceof CachingHierarchyManager)) {
+                hierMgr = new CachingHierarchyManager(hierMgr);
+            }
+        } else {
+            if (hierMgr instanceof CachingHierarchyManager) {
+                CachingHierarchyManager chm = (CachingHierarchyManager) hierMgr;
+                chm.clearCache();
+                hierMgr = chm.unwrap();
+            }
+        }
+    }
+
+    /**
+     *
-        VirtualItemStateProvider[] provs = new VirtualItemStateProvider[virtualProviders.length+1];
+        VirtualItemStateProvider[] provs = new VirtualItemStateProvider[virtualProviders.length + 1];
-        for (int i=0; i<virtualProviders.length; i++) {
+        for (int i = 0; i < virtualProviders.length; i++) {
+     *
-        for (int i=0; i<virtualProviders.length; i++) {
+        for (int i = 0; i < virtualProviders.length; i++) {

INS31 INS29 INS83 INS39 INS42 INS44 INS8 INS65 INS65 INS39 INS42 INS25 INS66 INS66 INS66 INS66 INS66 INS66 INS66 INS42 INS42 INS8 INS8 INS25 INS25 INS38 INS8 INS62 INS8 INS36 INS21 INS42 INS43 INS60 INS21 INS21 INS62 INS7 INS42 INS43 INS59 INS32 INS7 INS42 INS43 INS42 INS14 INS42 INS42 INS11 INS42 INS42 INS42 INS32 INS42 INS43 INS42 INS43 INS42 INS42 INS42 INS42 INS42 DEL83