Redesign of query index to allow for generations of PersistentIndex instances. Indexing a lot of content is now faster and pauses during indexing are less frequent. At the same time less lucene IndexReader/Writer changes occur.

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@160385 13f79535-47bb-0310-9956-ffa450edef68

-            indexWriter.minMergeDocs = minMergeDocs;
-            indexWriter.maxMergeDocs = maxMergeDocs;
-            indexWriter.mergeFactor = mergeFactor;
-            indexWriter.setUseCompoundFile(useCompoundFile);
-            indexWriter.infoStream = STREAM_LOGGER;
+            // immediately close, now that index has been created
+            indexWriter.close();
+            indexWriter = null;
-     * After commit both <code>IndexReader</code> and <code>IndexWriter</code>
-     * are released.
+        // if index is not locked there are no pending changes
+        if (!IndexReader.isLocked(getDirectory())) {
+            return;
+        }
+

INS25 INS38 INS8 INS32 INS41 INS42 INS42 INS32 UPD42 UPD42 INS33 INS42 DEL40 DEL42 DEL7 DEL21 DEL40 DEL42 DEL7 DEL21 DEL40 DEL42 DEL7 DEL21 DEL42 DEL40 DEL66 DEL66