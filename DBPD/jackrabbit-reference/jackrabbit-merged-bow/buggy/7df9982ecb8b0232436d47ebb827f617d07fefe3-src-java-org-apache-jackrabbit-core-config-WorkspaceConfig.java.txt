Refactoring step 7 (JCR-53)
 - Added the new FileSystemConfig object
 - Added an init() step to keep the constructors and parsing code simple
 - Moved file handling and workspace creation back to RepositoryConfig
 - Added and improved lots of javadocs
 - Fixed property problems (new Property(p) != (Property) p.clone())
 - Many minor changes


git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@156418 13f79535-47bb-0310-9956-ffa450edef68

- * A <code>WorkspaceConfig</code> ...
+ * Workspace configuration. This configuration class is used to
+ * create configured workspace objects.
+ * <p>
+ * The contained configuration information are: the home directory and name
+ * of the workspace, and the file system, the persistence manager, and the
+ * search index configuration. The search index is an optional part of the
+ * configuration.
-     * workspace home directory
+     * Workspace home directory.
-    private String wspHomeDir;
+    private final String home;
-     * virtual file system where the workspace stores meta data etc.
+     * Workspace name.
-    private FileSystem wspFS;
+    private final String name;
-     * workspace name
+     * Workspace file system configuration.
-    private String wspName;
+    private FileSystemConfig fsc;
-     * configuration for the persistence manager
+     * Workspace persistence manager configuration.
-    private BeanConfig pmc;
+    private PersistenceManagerConfig pmc;
-     * configuration for the search manager
+     * Workspace search index configuration.
-    private SearchConfig searchConfig;
+    private SearchConfig sc;
-    public WorkspaceConfig(String home, String name, FileSystem fs, BeanConfig pmc, SearchConfig sc) {
-        this.wspHomeDir = home;
-        this.wspName = name;
-        this.wspFS = fs;
+    /**
+     * Creates a workspace configuration object.
+     *
+     * @param home home directory
+     * @param name workspace name
+     * @param fsc file system configuration
+     * @param pmc persistence manager configuration
+     * @param sc search index configuration
+     */
+    public WorkspaceConfig(
+            String home, String name, FileSystemConfig fsc,
+            PersistenceManagerConfig pmc, SearchConfig sc) {
+        this.home = home;
+        this.name = name;
+        this.fsc = fsc;
-        this.searchConfig = sc;
+        this.sc = sc;
-     * Returns the home directory of the workspace.
+     * Initializes the workspace file system and search index implementations.
-     * @return the home directory of the workspace
+     * @throws ConfigurationException on initialization errors
+     */
+    public void init() throws ConfigurationException {
+        fsc.init();
+        sc.init();
+    }
+
+    /**
+     * Returns the workspace home directory.
+     *
+     * @return workspace home directory
-        return wspHomeDir;
+        return home;
-        return wspName;
+        return name;
-     * Returns the virtual file system where the workspace stores global state.
+     * Returns the workspace file system implementation.
-     * @return the virtual file system where the workspace stores global state
+     * @return file system implementation
-        return wspFS;
+        return fsc.getFileSystem();
-     * Returns the configuration of the persistence manager.
+     * Returns the workspace persistence manager configuration.
-     * @return the <code>PersistenceManagerConfig</code> for this workspace
+     * @return persistence manager configuration
-        return new PersistenceManagerConfig(pmc);
+        return pmc;
-     * Returns the configuration of the search manager.
-     * Returns <code>null</code> if no search manager is configured.
+     * Returns the workspace search index configuration. Returns
+     * <code>null</code> if a search index has not been configured.
-     * @return the <code>SearchConfig</code> for this workspace
+     * @return search index configuration, or <code>null</code>
-        return searchConfig;
+        return sc;

INS31 INS83 INS83 MOV43 INS43 UPD43 INS29 INS29 INS83 INS39 INS42 INS43 INS8 INS66 UPD66 INS66 INS66 INS66 INS66 INS66 UPD42 UPD42 INS42 UPD42 UPD42 UPD42 INS65 INS65 INS65 INS65 INS65 INS65 UPD43 UPD42 MOV43 INS65 INS65 INS42 INS21 INS21 UPD66 UPD66 UPD66 UPD66 UPD66 INS66 INS42 INS66 INS42 INS66 INS42 INS66 INS42 INS66 INS42 INS66 UPD42 INS66 INS42 INS66 INS32 INS32 UPD66 UPD66 UPD42 UPD42 UPD66 UPD66 INS32 UPD66 UPD66 INS42 UPD66 UPD66 UPD66 UPD42 UPD42 INS42 INS42 INS42 INS42 INS42 INS42 UPD42 UPD42 UPD42 UPD42 DEL42 DEL43 DEL42 DEL43 DEL42 DEL42 DEL14