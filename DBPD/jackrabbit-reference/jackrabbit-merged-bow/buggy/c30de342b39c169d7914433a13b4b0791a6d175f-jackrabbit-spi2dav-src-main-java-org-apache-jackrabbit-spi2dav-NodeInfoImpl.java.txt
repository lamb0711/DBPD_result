JCR-2453 - Break the spi2dav dependency to jcr-server

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1002639 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.webdav.jcr.nodetype.NodeTypeProperty;
-import org.apache.jackrabbit.webdav.jcr.ItemResourceConstants;
+import org.apache.jackrabbit.commons.webdav.JcrRemotingConstants;
+import org.apache.jackrabbit.commons.webdav.NodeTypeUtil;
+import java.util.Collection;
-import java.util.Set;
-        DavProperty<?> indexProp = propSet.get(ItemResourceConstants.JCR_INDEX);
+        DavProperty<?> indexProp = propSet.get(JcrRemotingConstants.JCR_INDEX_LN, ItemResourceConstants.NAMESPACE);
-            if (propSet.contains(ItemResourceConstants.JCR_PRIMARYNODETYPE)) {
-                Iterator<String> it = new NodeTypeProperty(propSet.get(ItemResourceConstants.JCR_PRIMARYNODETYPE)).getNodeTypeNames().iterator();
+            DavProperty<?> prop = propSet.get(JcrRemotingConstants.JCR_PRIMARYNODETYPE_LN, ItemResourceConstants.NAMESPACE);
+            if (prop != null) {
+                Iterator<String> it = NodeTypeUtil.ntNamesFromXml(prop.getValue()).iterator();
-            if (propSet.contains(ItemResourceConstants.JCR_MIXINNODETYPES)) {
-                Set<String> mixinNames = new NodeTypeProperty(propSet.get(ItemResourceConstants.JCR_MIXINNODETYPES)).getNodeTypeNames();
+
+            prop = propSet.get(JcrRemotingConstants.JCR_MIXINNODETYPES_LN, ItemResourceConstants.NAMESPACE);
+            if (prop != null) {
+                Collection<String> mixinNames = NodeTypeUtil.ntNamesFromXml(prop.getValue());

MOV26 UPD40 UPD40 UPD40 INS60 INS21 INS40 UPD40 INS74 INS59 INS27 INS7 INS27 INS43 INS76 INS42 INS32 INS42 INS33 INS42 INS32 INS42 INS33 INS42 INS42 INS42 INS40 INS40 INS42 INS42 INS40 INS40 UPD74 UPD43 UPD42 INS42 INS42 INS32 INS42 INS42 INS32 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 UPD42 MOV42 DEL42 DEL42 DEL40 DEL32 DEL42 DEL43 DEL40 DEL32 DEL14 DEL42 DEL42 DEL42 DEL40 DEL32 DEL42 DEL43 DEL40 DEL32 DEL14 DEL42