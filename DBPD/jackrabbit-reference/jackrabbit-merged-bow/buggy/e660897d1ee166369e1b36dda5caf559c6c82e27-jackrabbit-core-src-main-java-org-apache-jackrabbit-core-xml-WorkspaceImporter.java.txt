JCR-1593 JSR 283: Simple versioning
JCR-2058 JSR 283: VersionManager and new versioning methods


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@765556 13f79535-47bb-0310-9956-ffa450edef68

-        if (ent.includesNodeType(NameConstants.MIX_VERSIONABLE)) {
+        if (ent.includesNodeType(NameConstants.MIX_SIMPLE_VERSIONABLE)) {
-            // jcr:versionHistory
-            conditionalAddProperty(
-                    node, NameConstants.JCR_VERSIONHISTORY,
-                    PropertyType.REFERENCE, false, historyId);
-
-            // jcr:baseVersion
-            conditionalAddProperty(
-                    node, NameConstants.JCR_BASEVERSION,
-                    PropertyType.REFERENCE, false, versionId);
-
-            // jcr:predecessors
-            conditionalAddProperty(
-                    node, NameConstants.JCR_PREDECESSORS,
-                    PropertyType.REFERENCE, true, versionId);
-
+            
+            // set extra properties only for full versionable nodes
+            if (ent.includesNodeType(NameConstants.MIX_VERSIONABLE)) {
+                // jcr:versionHistory
+                conditionalAddProperty(
+                        node, NameConstants.JCR_VERSIONHISTORY,
+                        PropertyType.REFERENCE, false, historyId);
+
+                // jcr:baseVersion
+                conditionalAddProperty(
+                        node, NameConstants.JCR_BASEVERSION,
+                        PropertyType.REFERENCE, false, versionId);
+
+                // jcr:predecessors
+                conditionalAddProperty(
+                        node, NameConstants.JCR_PREDECESSORS,
+                        PropertyType.REFERENCE, true, versionId);
+            }

INS32 INS42 INS42 INS40 INS25 MOV32 INS8 MOV21 MOV21 MOV21