Refactoring

- separate hierarchy from ItemStates
- remove ItemStateManager
- move all hierarchy related classes to a separate package ('hierarchy')
- allow loading of deep Item without loading ancestors
- consequently item definition is only built upon usage, since parent is needed.
- minor fixes with adding/removing mixin-nodetypes

Consequences for SPI interfaces:

- SPI impl must be able to deal with both proper itemID and path, since jcr2spi
  might not be aware of a uniqueID defined with a parent node.

- ItemInfo.getPath added, in order to be able to built the missing hierarchy
  entries if a deep Item identified by uniqueID (plus ev. path) is loaded

- LockInfo.getNodeId added, in order to be able to determine the lock-holding node.




git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@506927 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.jcr2spi.hierarchy.HierarchyManager;
-import org.apache.jackrabbit.jcr2spi.state.ItemStateManager;
-     * The item state manager of the session that executes this query.
+     * The hierarchy manager of the session that executes this query.
-    private final ItemStateManager itemStateManager;
+    private final HierarchyManager hierarchyManager;
-     * @param itemStateManager the item state manager of that session.
+     * @param hierarchyMgr     the HierarchyManager of that session.
-                     ItemManager itemMgr, ItemStateManager itemStateManager,
+                     ItemManager itemMgr, HierarchyManager hierarchyManager,
-        this.itemStateManager = itemStateManager;
+        this.hierarchyManager = hierarchyManager;
+     * @param hierarchyManager
-                     ItemManager itemMgr, ItemStateManager itemStateManager,
+                     ItemManager itemMgr, HierarchyManager hierarchyManager,
-        this.itemStateManager = itemStateManager;
+        this.hierarchyManager = hierarchyManager;
-        return new QueryResultImpl(itemManager, itemStateManager, qI, nsResolver);
+        return new QueryResultImpl(itemManager, hierarchyManager, qI, nsResolver);

MOV26 UPD40 UPD43 UPD42 UPD42 UPD43 UPD42 INS65 UPD43 UPD42 UPD66 UPD42 UPD66 UPD42 INS42 UPD42 UPD42 UPD42 UPD42 UPD42 UPD42