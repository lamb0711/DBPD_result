JCR-1972: Preserving UUID and document version history on repository migration

Add the new NodeImpl.checkin(Calendar) and VersionManagerImpl.checkin(String, Calendar)signatures based on contribution by Paco Avila.


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@800483 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.Calendar;
+        return checkin(absPath, null);
+    }
+
+    /**
+     * Creates a new version of the node at the given path.
+     *
+     * @param absPath node path
+     * @param created create time of the new version,
+     *                or <code>null</code> for the current time
+     * @return new version
+     * @throws RepositoryException if the version can not be created
+     */
+    public Version checkin(String absPath, Calendar created)
+            throws RepositoryException {
-                ItemValidator.CHECK_LOCK | ItemValidator.CHECK_HOLD | ItemValidator.CHECK_PENDING_CHANGES_ON_NODE,
+                ItemValidator.CHECK_LOCK | ItemValidator.CHECK_HOLD
+                | ItemValidator.CHECK_PENDING_CHANGES_ON_NODE,
-        NodeId baseId = checkoutCheckin(state, true, false);
+        NodeId baseId = checkoutCheckin(state, true, false, created);
-        checkoutCheckin(state, false, true);
+        checkoutCheckin(state, false, true, null);
-        NodeId baseId = checkoutCheckin(state, true, true);
+        NodeId baseId = checkoutCheckin(state, true, true, null);

INS26 INS40 INS31 MOV29 INS83 MOV43 INS42 MOV44 MOV43 INS8 INS29 INS43 INS44 INS44 INS43 INS41 INS65 INS65 INS65 INS65 INS65 INS42 INS43 INS42 INS43 INS42 INS42 INS32 INS66 INS42 INS66 INS42 INS66 INS66 INS66 INS42 INS66 INS42 INS42 INS42 INS42 INS33 INS33 INS42 INS33