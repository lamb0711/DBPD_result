fixed bug that occured when calling Node.setProperty, specifying a non-existing property and an illegal value: 

exception was thrown but property had nevertheless been created with null value

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@106099 13f79535-47bb-0310-9956-ffa450edef68

-        return transientStateMgr.hasItemStateInAttic(id)
-                || transientStateMgr.hasItemState(id)
-                || persistentStateMgr.hasItemState(id)
-                || hasVirtualItemState(id);
+	// first check if the specified item has been transiently removed
+	if (transientStateMgr.hasItemStateInAttic(id)) {
+	    /**
+	     * check if there's new transient state for the specified item
+	     * (e.g. if a property with name 'x' has been removed and a new
+	     * property with same name has been created);
+	     */
+	    return transientStateMgr.hasItemState(id);
+	}
+
+	// check if there's transient state for the specified item
+	if (transientStateMgr.hasItemState(id)) {
+	    return true;
+	}
+
+	// check if there is a virtual state for the specified item
+	for (int i = 0; i < virtualProviders.length; i++) {
+	    if (virtualProviders[i].hasItemState(id)) {
+		return true;
+	    }
+	}
+
+	// check if there's persistent state for the specified item
+	if (persistentStateMgr.hasItemState(id)) {
+	    return true;
+	}
+
+	return false;

INS8 INS25 INS25 INS24 INS25 INS41 MOV32 INS8 INS32 INS8 INS58 INS27 INS37 INS8 MOV32 INS8 INS9 INS41 INS42 INS42 INS42 INS41 INS39 INS59 INS42 INS40 INS42 INS25 INS41 MOV32 INS9 INS42 INS34 INS32 INS8 INS9 INS2 UPD42 MOV42 MOV42 INS41 INS42 INS42 INS9 DEL32 DEL27 DEL41 DEL8