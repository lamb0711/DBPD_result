port to jcr api v0.16.4.1

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@165156 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.core.value.ValueHelper;
+import org.apache.jackrabbit.core.value.InternalValue;
+import org.apache.jackrabbit.core.value.ValueHelper;
-import org.apache.jackrabbit.core.value.InternalValue;
-import org.apache.jackrabbit.core.value.ValueHelper;
-                throw new ConstraintViolationException(
-                        mixinName + " can not be removed: the node is being referenced"
+                throw new ConstraintViolationException(mixinName + " can not be removed: the node is being referenced"
-     * @throws VersionException if this node is not checked-out
-     * @throws LockException if this node is locked by somebody else
+     * @throws VersionException    if this node is not checked-out
+     * @throws LockException       if this node is locked by somebody else
-     *
+        // check state of this instance
+        sanityCheck();
-            throw new ConstraintViolationException("source and destination have to be different");
+            // there's nothing to do
+            return;
-            throw new ItemNotFoundException(safeGetJCRPath() + " has no child node with name " + srcName);
+            throw new ItemNotFoundException(safeGetJCRPath()
+                    + " has no child node with name " + srcName);
-            throw new ItemNotFoundException(safeGetJCRPath() + " has no child node with name " + destName);
+            throw new ItemNotFoundException(safeGetJCRPath()
+                    + " has no child node with name " + destName);
-            String msg = safeGetJCRPath() + ": cannot change child node ordering of a checked-in node";
+            String msg = safeGetJCRPath()
+                    + ": cannot change child node ordering of a checked-in node";
-            String msg = safeGetJCRPath() + ": cannot change child node ordering of a protected node";
+            String msg = safeGetJCRPath()
+                    + ": cannot change child node ordering of a protected node";
-    private void internalMerge(
-            SessionImpl srcSession, List failedIds,
-            boolean bestEffort, boolean removeExisting, boolean replaceExisting)
+    private void internalMerge(SessionImpl srcSession, List failedIds,
+                               boolean bestEffort, boolean removeExisting, boolean replaceExisting)
-                            throw new ItemExistsException(
-                                    "Unable to restore node, item already exists outside of restored tree: "
+                            throw new ItemExistsException("Unable to restore node, item already exists outside of restored tree: "
-                        throw new ItemExistsException(
-                                "Unable to restore node, item already exists outside of restored tree: "
+                        throw new ItemExistsException("Unable to restore node, item already exists outside of restored tree: "

MOV26 MOV26 INS21 UPD66 UPD66 INS32 INS42 INS41 DEL40 DEL26 DEL42 DEL43 DEL45 DEL14 DEL53