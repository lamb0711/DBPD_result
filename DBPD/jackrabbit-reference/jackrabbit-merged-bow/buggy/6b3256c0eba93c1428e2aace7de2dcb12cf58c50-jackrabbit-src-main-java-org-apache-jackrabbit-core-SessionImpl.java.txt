Locking and XA
- Introduce internal XA resources
- Add rollback thread that runs when transaction timeout has expired
- Make lock's live attribute transaction-aware
- Make NodeImpl's internalSetProperty protected again 



git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@365558 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.core.observation.EventStateCollection;
-        versionMgr = rep.getVersionManager();
+        versionMgr = createVersionManager(rep);
-     *
+     * Create the version manager. If we are not using XA, we may safely use
+     * the repository version manager.
+     * @return version manager
+     */
+    protected VersionManager createVersionManager(RepositoryImpl rep)
+            throws RepositoryException {
+        
+        return rep.getVersionManager();
+    }
+
+    /**
-     * Return the lock manager for this session. In a non-transactional
-     * environment, this is simply the lock manager shared by all sessions
-     * on this workspace.
+     * Return the lock manager for this session.
-     * @throws RepositoryException if an error occurs

INS31 INS29 INS83 INS43 INS42 INS44 INS43 INS8 INS65 INS65 INS42 INS43 INS42 INS42 INS41 INS66 INS66 INS66 INS42 MOV32 UPD66 INS32 INS42 INS42 DEL40 DEL26 DEL66 DEL66 DEL42 DEL66 DEL65