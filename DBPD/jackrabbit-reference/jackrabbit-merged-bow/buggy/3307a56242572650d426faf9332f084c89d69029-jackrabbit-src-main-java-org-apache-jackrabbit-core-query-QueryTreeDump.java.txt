JCR-247: Child axis support for XPath predicates

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@477599 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.name.Path;
-        buffer.append(" Prop=").append(node.getPropertyName());
+        buffer.append(" Path=");
+        Path relPath = node.getRelativePath();
+        if (relPath == null) {
+            buffer.append(".");
+        } else {
+            Path.PathElement[] elements = relPath.getElements();
+            String slash = "";
+            for (int i = 0; i < elements.length; i++) {
+                buffer.append(slash);
+                slash = "/";
+                if (node.getReferencesProperty() && i == elements.length - 1) {
+                    buffer.append("@");
+                }
+                buffer.append(elements[i]);
+            }
+        }
-        buffer.append(" Prop=" + node.getProperty());
+        buffer.append(" Prop=");
+        Path relPath = node.getRelativePath();
+        if (relPath == null) {
+            buffer.append(relPath);
+        } else {
+            Path.PathElement[] elements = relPath.getElements();
+            String slash = "";
+            for (int i = 0; i < elements.length; i++) {
+                buffer.append(slash);
+                slash = "/";
+                if (i == elements.length - 1) {
+                    buffer.append("@");
+                }
+                buffer.append(elements[i]);
+            }
+        }

INS26 INS40 INS8 MOV60 MOV21 MOV21 INS21 INS60 INS25 MOV21 MOV21 MOV41 MOV21 INS60 INS25 INS32 INS43 INS59 INS27 INS8 INS8 MOV32 INS43 INS59 INS27 INS8 INS8 INS42 INS42 INS45 INS42 INS42 INS32 INS42 INS33 INS21 INS60 INS60 INS24 INS42 INS42 INS32 INS42 INS33 INS21 INS60 INS60 INS24 INS42 INS42 INS32 INS5 INS59 INS43 INS59 INS58 INS27 INS37 INS8 INS42 INS42 INS32 INS5 INS59 INS43 INS59 INS58 INS27 INS37 INS8 INS42 INS42 INS45 INS43 INS85 INS42 INS32 INS42 INS42 INS45 INS39 INS59 INS42 INS40 INS42 INS21 INS21 INS25 INS21 MOV42 MOV42 INS42 INS43 INS85 INS42 INS32 INS42 INS42 INS45 INS39 INS59 INS42 INS40 INS42 INS21 INS21 INS25 INS21 INS40 INS42 INS42 INS42 INS34 INS32 INS7 INS27 INS8 INS32 INS40 INS42 INS42 INS42 INS34 INS32 INS7 INS27 INS8 INS32 INS42 INS42 INS42 INS42 INS45 INS32 INS27 INS21 INS42 INS42 INS2 UPD42 MOV42 UPD42 MOV42 INS42 INS42 INS45 INS42 INS27 INS21 INS42 INS42 INS2 INS42 INS42 INS42 INS27 INS32 INS42 INS42 INS40 INS34 INS32 INS42 INS42 INS40 INS34 INS42 INS42 INS45 INS42 INS42 INS45 DEL8 DEL42 DEL42 DEL42 DEL32 DEL32 DEL45 DEL32 DEL27 DEL32 DEL21