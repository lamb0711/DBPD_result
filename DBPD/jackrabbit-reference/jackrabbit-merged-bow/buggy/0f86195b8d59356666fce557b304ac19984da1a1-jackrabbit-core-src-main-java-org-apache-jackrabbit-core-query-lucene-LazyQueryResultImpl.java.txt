JCR-1073: Added getTotalSize() to LazyQueryResultImpl

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@572889 13f79535-47bb-0310-9956-ffa450edef68

-    private static final Logger log = LoggerFactory.getLogger(QueryResultImpl.class);
+    private static final Logger log = LoggerFactory.getLogger(LazyQueryResultImpl.class);
-            int start = resultNodes.size() + invalid;
+            int start = resultNodes.size() + invalid + (int)offset;
-                        if (i < offset) {
-                            invalid++;
-                        } else {
-                            resultNodes.add(new ScoreNode(id, result.score(i)));
-                        }
+                        resultNodes.add(new ScoreNode(id, result.score(i)));
+    
+    /**
+     * Returns the total number of hits. This is the number of results you
+     * will get get if you don't set any limit or offset. Keep in mind that this
+     * number may get smaller if nodes are found in the result set which the
+     * current session has no permission to access.
+     */
+    public int getTotalSize() {
+        return numResults - invalid;
+    }
-            int totalSize = numResults - invalid;
+            int totalSize = getTotalSize();
-                return totalSize;
+                return totalSize - offset;

INS31 MOV8 INS29 INS83 INS39 INS42 INS8 MOV25 MOV60 MOV25 MOV25 MOV60 INS54 INS65 INS41 MOV8 MOV12 MOV8 INS66 INS66 INS66 INS66 MOV27 UPD43 MOV21 MOV25 MOV60 MOV60 INS24 UPD42 MOV58 MOV27 MOV37 MOV8 INS32 MOV60 INS54 INS42 INS27 INS11 MOV8 MOV12 INS42 INS42 INS39 INS42 MOV32 MOV8 MOV21 MOV21 MOV37 DEL42 DEL42 DEL27 DEL25 DEL54 DEL24 DEL54 DEL8 DEL42