JCR-1104 : JSR 283 support (security work in progress)

- user API: improve creation of new users
- user API: add distinction between declared and indirect group membership
- user Impl: move group membership to authorizable node type
- javadoc
- minor fixes/improvements

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@653726 13f79535-47bb-0310-9956-ffa450edef68

-            cryptedPassword = crypt(algorithm, password);
+            cryptedPassword = crypt(password, algorithm);
-        if (userId == null || userId.length() == 0) {
-            throw new IllegalArgumentException();
-        }
-        if (password == null) {
-            throw new IllegalArgumentException();
+        if (userId == null || userId.length() == 0 || password == null) {
+            throw new IllegalArgumentException("Invalid userID or password. Neither may be null, the userID must have a length > 0.");
-            cryptedPassword = crypt(algorithm, password);
+            cryptedPassword = crypt(password, algorithm);
-     * @return true if {@link SimpleCredentials#getUserID() UserID}
-     *              and {@link SimpleCredentials#getPassword() Password} match
+     * @return true if {@link SimpleCredentials#getUserID() UserID} and
+     * {@link SimpleCredentials#getPassword() Password} match.
-                return crypt(algorithm, toMatch).equals(cryptedPassword);
+                return crypt(toMatch, algorithm).equals(cryptedPassword);
-                return crypt(cryptedPassword, algr).equals(toMatch);
+                return crypt(algr, cryptedPassword).equals(toMatch);
-    private static String crypt(String algorithm, String pwd)
+    private static String crypt(String pwd, String algorithm)

MOV44 INS27 UPD66 UPD66 INS27 MOV27 INS27 INS27 INS42 INS33 INS32 INS34 INS45 INS42 INS42 INS42 INS42 INS42 INS42 DEL42 DEL42 DEL33 DEL27 DEL42 DEL42 DEL32 DEL34 DEL27 DEL27 DEL42 DEL43 DEL14 DEL53 DEL8 DEL25 DEL42 DEL42 DEL42