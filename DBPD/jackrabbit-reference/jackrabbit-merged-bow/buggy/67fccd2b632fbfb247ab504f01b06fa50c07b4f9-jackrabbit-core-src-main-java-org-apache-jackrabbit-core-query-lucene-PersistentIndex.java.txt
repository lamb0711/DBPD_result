JCR-1747: org.apache.jackrabbit.core.query.lucene.SearchIndex with in-memory lucene index

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@718218 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.lucene.store.FSDirectory;
-import org.apache.lucene.store.NativeFSLockFactory;
+import org.apache.jackrabbit.core.query.lucene.directory.DirectoryManager;
-import java.io.File;
-     * Creates a new <code>PersistentIndex</code> based on the file system
-     * <code>indexDir</code>.
+     * Creates a new <code>PersistentIndex</code>.
+     *
-     * @param indexDir the directory to store the index.
+     * @param directoryManager the directory manager.
-    PersistentIndex(String name, File indexDir, Analyzer analyzer,
+    PersistentIndex(String name, Analyzer analyzer,
-                    IndexingQueue indexingQueue)
+                    IndexingQueue indexingQueue,
+                    DirectoryManager directoryManager)
-        super(analyzer, similarity, FSDirectory.getDirectory(indexDir, new NativeFSLockFactory(indexDir)),
+        super(analyzer, similarity, directoryManager.getDirectory(name),
-            IndexMigration.migrate(this, indexDir);
+            IndexMigration.migrate(this, directoryManager);

MOV26 UPD40 MOV44 MOV65 UPD43 UPD42 UPD66 UPD42 UPD66 UPD42 UPD42 UPD42 UPD42 DEL40 DEL26 DEL40 DEL26 DEL66 DEL42 DEL43 DEL42 DEL14