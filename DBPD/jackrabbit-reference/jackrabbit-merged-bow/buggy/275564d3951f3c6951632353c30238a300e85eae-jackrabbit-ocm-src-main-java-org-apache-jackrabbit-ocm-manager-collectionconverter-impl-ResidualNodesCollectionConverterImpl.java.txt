- working on JCR-1339 : better support for Map. It is important to define an ID field in the class used for the Map elements. This ID will be used as a key in the map. 
- Rename ManagedHashMap into ManageableHashMap in ordrer to follow the same naming convention.
- Now, it is not necessary to define the ElementClassName if the Collection or the Map are parametrized like List<MyClass>

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@646938 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.ocm.manager.collectionconverter.ManageableCollectionUtil;
+import org.apache.jackrabbit.ocm.manager.collectionconverter.ManageableObjectsUtil;
+import org.apache.jackrabbit.ocm.manager.collectionconverter.ManageableMap;
+import org.apache.jackrabbit.ocm.manager.collectionconverter.ManageableObjects;
-        ManageableCollection collection) {
+        ManageableObjects objects) {
-        if (!(collection instanceof Map)) {
+        if (!(objects instanceof Map)) {
-        Map map = (Map) collection;
+        Map map = (Map) objects;
-            ManageableCollection collection) throws RepositoryException {
+            ManageableObjects objects) throws RepositoryException {
-        if (!(collection instanceof Map)) {
+        if (!(objects instanceof Map)) {
-        Map map = (Map) collection;
+        Map map = (Map) objects;
-    protected ManageableCollection doGetCollection(Session session,
+    protected ManageableObjects doGetCollection(Session session,
-            ManageableCollection collection = ManageableCollectionUtil.getManageableCollection(collectionFieldClass);
+            ManageableObjects objects = ManageableObjectsUtil.getManageableObjects(collectionFieldClass);
-                if (collection instanceof Map) {
+                if (objects instanceof Map) {
-                    ((Map) collection).put(name, item);
-                } else {
-                    collection.addObject(item);
+                    ((Map) objects).put(name, item);
+                }
+                else {
+                	if (objects instanceof ManageableCollection)
+                        ((ManageableCollection)objects).addObject(item);
+               	   else
+               	   {
+               		String name = node.getName();
+               		((ManageableMap)objects).addObject(name, item);
+               	   }
+            return objects;
-            return collection;

INS26 INS26 UPD40 INS40 INS40 INS43 UPD43 UPD42 UPD43 UPD42 INS42 UPD42 MOV43 UPD42 MOV43 MOV43 UPD42 MOV43 UPD42 INS43 UPD42 UPD42 UPD42 INS42 UPD42 UPD42 UPD42 INS8 UPD42 INS25 INS62 INS21 MOV8 INS42 MOV43 INS32 INS60 INS36 INS42 INS42 INS43 INS59 UPD42 INS11 INS42 INS42 INS32 INS36 INS42 MOV43 INS42 INS42 INS42 INS11 INS43 INS42 INS42 DEL42