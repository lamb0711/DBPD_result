JCR-619: CacheManager (Memory Management in Jackrabbit)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@475223 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.core.persistence.PersistenceManager;
+import org.apache.jackrabbit.core.cluster.UpdateEventChannel;
+import org.apache.jackrabbit.core.cluster.UpdateEventListener;
+import org.apache.jackrabbit.core.persistence.PersistenceManager;
+import org.apache.jackrabbit.core.state.ItemState;
+import org.apache.jackrabbit.core.state.ItemStateCacheFactory;
+import org.apache.jackrabbit.core.state.ItemStateListener;
-import org.apache.jackrabbit.core.state.ItemStateListener;
-import org.apache.jackrabbit.core.state.ItemState;
-import org.apache.jackrabbit.core.cluster.UpdateEventChannel;
-import org.apache.jackrabbit.core.cluster.UpdateEventListener;
-                              NodeId rootParentId) throws RepositoryException {
+                              NodeId rootParentId,
+                              ItemStateCacheFactory cacheFactory) throws RepositoryException {
-                    new VersionItemStateManager(pMgr, rootId, ntReg);
+                    new VersionItemStateManager(pMgr, rootId, ntReg, cacheFactory);
-            stateMgr = new LocalItemStateManager(sharedStateMgr, escFactory);
+            stateMgr = new LocalItemStateManager(sharedStateMgr, escFactory, cacheFactory);
-                                       NodeTypeRegistry ntReg)
+                                       NodeTypeRegistry ntReg,
+                                       ItemStateCacheFactory cacheFactory)
-            super(persistMgr, rootNodeId, ntReg, false);
+            super(persistMgr, rootNodeId, ntReg, false, cacheFactory);

MOV26 MOV26 MOV26 MOV26 MOV26 INS26 INS40 INS44 INS43 INS42 INS44 INS42 INS43 INS42 INS42 INS42 INS42 INS42