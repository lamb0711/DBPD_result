- AccessManager: added method canAccess(String wspName) to check authorization for specific workspace

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@157086 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.ArrayList;
-            // update operation failed, cancel all modifications
+                // update operation failed, cancel all modifications
+        // check authorization for specified workspace
+        if (!session.getAccessManager().canAccess(srcWorkspace)) {
+            throw new AccessDeniedException("not authorized to access " + srcWorkspace);
+        }
+
-        // aquire session on other workspace (throws NoSuchWorkspaceException)
+        // acquire session on other workspace (throws NoSuchWorkspaceException)
+        // check authorization for specified workspace
+        if (!session.getAccessManager().canAccess(srcWorkspace)) {
+            throw new AccessDeniedException("not authorized to access " + srcWorkspace);
+        }
+
-        // aquire session on other workspace (throws NoSuchWorkspaceException)
+        // acquire session on other workspace (throws NoSuchWorkspaceException)
+
-            // update operation failed, cancel all modifications
+                // update operation failed, cancel all modifications
-        // @todo filter workspaces according to access rights
-        return session.getWorkspaceNames();
+        // filter workspaces according to access rights
+        ArrayList list = new ArrayList();
+        String names[] = session.getWorkspaceNames();
+        for (int i = 0; i < names.length; i++) {
+            if (session.getAccessManager().canAccess(names[i])) {
+                list.add(names[i]);
+            }
+        }
+
+        return (String[]) list.toArray(new String[list.size()]);
-/*
+
-*/
-        throw new RepositoryException("not yet implemented");

INS26 INS40 INS25 INS25 INS60 INS60 INS24 INS60 INS41 INS38 INS8 INS38 INS8 INS43 INS59 INS43 INS59 INS58 INS27 INS37 INS8 INS11 INS43 INS59 INS14 INS32 INS53 INS32 INS53 INS42 INS42 INS14 INS42 INS42 INS85 MOV32 INS39 INS59 INS42 INS40 INS42 INS25 INS5 INS32 INS42 INS42 INS14 INS43 INS42 INS32 INS32 INS32 INS42 INS42 INS14 INS32 INS42 INS42 INS14 INS43 INS42 INS34 INS32 INS8 INS43 INS85 INS42 INS42 INS3 UPD43 MOV43 INS42 INS52 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS43 INS27 INS42 INS42 INS43 INS27 INS42 INS32 INS42 INS2 INS21 INS42 INS5 INS32 UPD42 INS42 INS45 INS42 INS42 INS45 INS42 INS42 INS42 INS42 INS42 INS32 INS43 INS85 INS42 INS42 INS42 INS42 INS2 INS42 INS42 INS42 DEL45 DEL14 DEL53