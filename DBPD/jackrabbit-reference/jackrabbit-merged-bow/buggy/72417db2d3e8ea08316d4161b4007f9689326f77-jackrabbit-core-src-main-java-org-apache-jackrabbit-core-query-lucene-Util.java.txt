JCR-1104: JSR 283 support
- query (work in progress)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@643414 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.lucene.search.Query;
+import org.apache.lucene.search.TermQuery;
+import org.apache.lucene.index.Term;
+
+    /**
+     * Depending on the index format this method returns a query that matches
+     * all nodes that have a property with a given <code>name</code>.
+     *
+     * @param name    the property name.
+     * @param version the index format version.
+     * @return Query that matches all nodes that have a property with the given
+     *         <code>name</code>.
+     */
+    public static Query createMatchAllQuery(String name, IndexFormatVersion version) {
+        if (version.getVersion() >= IndexFormatVersion.V2.getVersion()) {
+            // new index format style
+            return new TermQuery(new Term(FieldNames.PROPERTIES_SET, name));
+        } else {
+            return new MatchAllQuery(name);
+        }
+    }

INS26 INS26 INS26 INS40 INS40 INS40 INS31 INS29 INS83 INS83 INS43 INS42 INS44 INS44 INS8 INS65 INS65 INS65 INS65 INS42 INS43 INS42 INS43 INS42 INS25 INS66 INS66 INS42 INS66 INS42 INS66 INS66 INS66 INS42 INS42 INS27 INS8 INS8 INS32 INS32 INS41 INS41 INS42 INS42 INS40 INS42 INS14 INS14 INS43 INS14 INS43 INS42 INS42 INS43 INS40 INS42 INS42 INS42