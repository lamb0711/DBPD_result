JCR-2887 : Split PrivilegeRegistry in a per-session manager instance and a repository level registry [work in progress]
JCR-2774 : Access control for repository level API operations


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1177668 13f79535-47bb-0310-9956-ffa450edef68

-import java.util.Map;
-import java.util.Set;
+import org.apache.commons.collections.map.LRUMap;
+import org.apache.jackrabbit.spi.Path;
-
-import org.apache.commons.collections.map.LRUMap;
-import org.apache.jackrabbit.spi.Path;
+import java.util.Map;
+import java.util.Set;
-                result = buildResult(absPath);
+                if (absPath == null) {
+                    result = buildRepositoryResult();
+                } else {
+                    result = buildResult(absPath);
+                }
-     *
+     * Retrieve the result for the specified path.
+     * 
+     * Retrieve the result for repository level operations.
+     *
+     * @return The result instance for those permissions and privileges granted
+     * for repository level operations.
+     * @throws RepositoryException
+     */
+    protected abstract Result buildRepositoryResult() throws RepositoryException;
+
+    /**
+     * Retrieve the privilege manager.
-     * @return
+     * @return An instance of privilege manager.
+     * @throws javax.jcr.RepositoryException If an error occurs.
-

MOV26 MOV26 MOV26 MOV26 INS31 INS29 INS83 INS83 INS43 INS42 INS43 INS65 INS65 INS65 INS65 INS42 INS42 INS65 INS65 INS66 INS66 INS66 INS66 INS42 INS66 INS66 INS40 INS66 INS25 INS27 INS8 INS8 INS42 INS33 INS21 MOV21 INS7 INS42 INS32 INS42