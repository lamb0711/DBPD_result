JCR-2268 Generify Security API


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@806534 13f79535-47bb-0310-9956-ffa450edef68

+import java.security.Principal;
+import java.util.Iterator;
+import java.util.LinkedHashSet;
+import java.util.Map;
+import java.util.Set;
+
+import javax.jcr.RepositoryException;
+import javax.jcr.Session;
+import javax.jcr.observation.Event;
+import javax.jcr.observation.EventIterator;
+import javax.jcr.observation.EventListener;
+
-import org.apache.commons.collections.set.ListOrderedSet;
-import javax.jcr.RepositoryException;
-import javax.jcr.Session;
-import javax.jcr.observation.Event;
-import javax.jcr.observation.EventIterator;
-import javax.jcr.observation.EventListener;
-import java.security.Principal;
-import java.util.Iterator;
-import java.util.Set;
-
-    private final LRUMap membershipCache;
+    private final Map<String, Set<Principal>> membershipCache;
-        Set mship;
+        Set<Principal> mship;
-            mship = (Set) membershipCache.get(userPrincipal.getName());
+            mship = membershipCache.get(userPrincipal.getName());
-    private Set collectGroupMembership(Principal princ) {
-        Set membership = new ListOrderedSet();
+    private Set<Principal> collectGroupMembership(Principal princ) {
+        Set<Principal> membership = new LinkedHashSet<Principal>();
-                    Iterator itr = auth.memberOf();
+                    Iterator<Group> itr = auth.memberOf();
-                        Group group = (Group) itr.next();
+                        Group group = itr.next();
-                // everyone will not be found by the usermanager -> extra test
+                // everyone will not be found by the user manager -> extra test

MOV26 MOV26 MOV26 MOV26 MOV26 MOV26 MOV26 MOV26 MOV26 INS26 UPD40 INS40 INS74 INS74 INS43 INS43 INS74 MOV43 INS43 UPD42 MOV42 INS42 MOV43 INS43 INS74 INS42 INS74 INS42 MOV43 INS43 MOV43 INS43 INS42 INS42 INS74 MOV32 INS43 INS43 UPD42 MOV42 INS42 INS74 MOV43 MOV43 MOV43 MOV32 DEL43 DEL11 DEL43 DEL11