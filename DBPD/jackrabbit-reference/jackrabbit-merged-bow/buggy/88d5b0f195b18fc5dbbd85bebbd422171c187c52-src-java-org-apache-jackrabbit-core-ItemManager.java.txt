

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@76003 13f79535-47bb-0310-9956-ffa450edef68

-     * Creates a new per-workspace instance <code>ItemManager</code> instance.
+     * Creates a new per-session instance <code>ItemManager</code> instance.
-        // setup item cache with soft references to items
-        itemCache = new ReferenceMap(ReferenceMap.HARD, ReferenceMap.SOFT);
+        // setup item cache with weak references to items
+        itemCache = new ReferenceMap(ReferenceMap.HARD, ReferenceMap.WEAK);
+    /**
+     * Disposes this <code>ItemManager</code> and frees resources.
+     */
+    void dispose() {
+        itemCache.clear();
+    }
+
+        // check sanity of session
+        session.sanityCheck();
+
+        // check sanity of session
+        session.sanityCheck();
+
+        // check sanity of session
+        session.sanityCheck();
+
+        // check sanity of session
+        session.sanityCheck();
+
+        // check sanity of session
+        session.sanityCheck();
+

INS31 INS29 INS39 INS42 INS8 INS65 INS21 INS21 INS21 INS21 INS21 INS21 UPD66 INS66 INS32 INS32 INS32 INS32 INS32 INS32 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 INS42 UPD40