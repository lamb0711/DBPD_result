work in progress

- replace ItemImpl by Item in ItemManager interface and adjust
  usages.
- change all setters on ItemState and derived classes from public to
  package private
- NodeState: use collection return value instead of set/list whereever possible
- WorkspaceManager: put ItemStateFactory to a separate class and
  remove unused inner class NodeReferenceImpl 
- add methods to NodeState/PropertyState that avoids return a null
  QItemDefinition and remove corresponding methods from NodeTypeManagerImpl
- remove ItemDefinitionManager.
- VersionHistoryImpl: add safety check if cne for root version really exists
- Fix ImporterImpl: ItemState.getDefinition() may return 'null' value.
  use method instead, that sets the definition if it is still missing.
- javadoc and code formatting


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@430031 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.Collection;
-            NodeState vState = vhState.getChildNodeEntry(QName.JCR_ROOTVERSION, Path.INDEX_DEFAULT).getNodeState();
-            return (Version) itemMgr.getItem(vState);
+            if (vhState.hasChildNodeEntry(QName.JCR_ROOTVERSION)) {
+                NodeState vState = vhState.getChildNodeEntry(QName.JCR_ROOTVERSION, Path.INDEX_DEFAULT).getNodeState();
+                return (Version) itemMgr.getItem(vState);
+            } else {
+                String msg = "Unexpected error: VersionHistory state does not contain a root version child node entry.";
+                log.error(msg);
+                throw new RepositoryException(msg);
+            }
-        Set labelQNames = labelNodeState.getPropertyNames();
+        Collection labelQNames = labelNodeState.getPropertyNames();

INS26 INS40 INS8 UPD43 INS25 UPD42 INS32 MOV8 INS8 INS42 INS42 INS40 INS60 INS21 INS53 INS43 INS59 INS32 INS14 INS42 INS42 INS45 INS42 INS42 INS42 INS43 INS42 INS42