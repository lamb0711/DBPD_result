adding Locking support contributed by Dominique Pfister

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@156949 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.lock.LockManager;
+     * The <code>LockManager</code> for this <code>Workspace</code>
+     */
+    protected LockManager lockMgr;
+
+    /**
-            PathNotFoundException, RepositoryException {
+            PathNotFoundException, LockException, RepositoryException {
-        // @todo check locked-status
+        // check lock status
+        getLockManager().checkLock(destParentPath, session);
+    /**
+     * Return the lock manager for this workspace. If not already done, creates
+     * a new instance.
+     *
+     * @return lock manager for this workspace
+     * @throws RepositoryException if an error occurs
+     */
+    public synchronized LockManager getLockManager() throws RepositoryException {
+
+        // check state of this instance
+        sanityCheck();
+
+        if (lockMgr == null) {
+            lockMgr = rep.getLockManager(wspConfig.getName());
+        }
+        return lockMgr;
+    }
+
-        // @todo check locked-status
+        // check locked-status
+        getLockManager().checkLock(destParentPath, session);
