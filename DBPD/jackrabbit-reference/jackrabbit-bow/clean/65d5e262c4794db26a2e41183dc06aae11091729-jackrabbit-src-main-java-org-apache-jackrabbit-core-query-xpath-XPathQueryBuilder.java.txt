JCR-473 Some enhancements to jackrabbit commons (fixed some deprecated calls)


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@421219 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.name.NameFormat;
-    private static Map parsers = new ReferenceMap(ReferenceMap.WEAK, ReferenceMap.WEAK);
+    private static final Map parsers = new ReferenceMap(ReferenceMap.WEAK, ReferenceMap.WEAK);
-        QueryRootNode root = new XPathQueryBuilder(statement, resolver).getRootNode();
-        return root;
+        return new XPathQueryBuilder(statement, resolver).getRootNode();
-                        QName nt = QName.fromJCRName(ntName, resolver);
+                        QName nt = NameFormat.parse(ntName, resolver);
-                        QName name = ISO9075.decode(QName.fromJCRName(child.getValue(), resolver));
+                        QName name = ISO9075.decode(NameFormat.parse(child.getValue(), resolver));
-                        QName name = ISO9075.decode(QName.fromJCRName(child.getValue(), resolver));
+                        QName name = ISO9075.decode(NameFormat.parse(child.getValue(), resolver));
-                        QName name = ISO9075.decode(QName.fromJCRName(child.getValue(), resolver));
+                        QName name = ISO9075.decode(NameFormat.parse(child.getValue(), resolver));
-                        QName name = ISO9075.decode(QName.fromJCRName(child.getValue(), resolver));
+                        QName name = ISO9075.decode(NameFormat.parse(child.getValue(), resolver));
-                        QName name = ISO9075.decode(QName.fromJCRName(child.getValue(), resolver));
+                        QName name = ISO9075.decode(NameFormat.parse(child.getValue(), resolver));
-                        QName name = ISO9075.decode(QName.fromJCRName(child.getValue(), resolver));
+                        QName name = ISO9075.decode(NameFormat.parse(child.getValue(), resolver));
-     * @return
+     * @return the path qurey node
-     * @return
+     * @return the function node
-            if (FN_NOT.toJCRName(resolver).equals(fName)
-                    || FN_NOT_10.toJCRName(resolver).equals(fName)) {
+            if (NameFormat.format(FN_NOT, resolver).equals(fName)
+                    || NameFormat.format(FN_NOT_10, resolver).equals(fName)) {
-            } else if (XS_DATETIME.toJCRName(resolver).equals(fName)) {
+            } else if (NameFormat.format(XS_DATETIME, resolver).equals(fName)) {
-            } else if (JCR_CONTAINS.toJCRName(resolver).equals(fName)) {
+            } else if (NameFormat.format(JCR_CONTAINS, resolver).equals(fName)) {
-            } else if (JCR_LIKE.toJCRName(resolver).equals(fName)) {
+            } else if (NameFormat.format(JCR_LIKE, resolver).equals(fName)) {
-            } else if (FN_TRUE.toJCRName(resolver).equals(fName)) {
+            } else if (NameFormat.format(FN_TRUE, resolver).equals(fName)) {
-            } else if (FN_FALSE.toJCRName(resolver).equals(fName)) {
+            } else if (NameFormat.format(FN_FALSE, resolver).equals(fName)) {
-            } else if (FN_POSITION.toJCRName(resolver).equals(fName)) {
+            } else if (NameFormat.format(FN_POSITION, resolver).equals(fName)) {
-            } else if (FN_FIRST.toJCRName(resolver).equals(fName)) {
+            } else if (NameFormat.format(FN_FIRST, resolver).equals(fName)) {
-            } else if (FN_LAST.toJCRName(resolver).equals(fName)) {
+            } else if (NameFormat.format(FN_LAST, resolver).equals(fName)) {
-            } else if (JCR_DEREF.toJCRName(resolver).equals(fName)) {
+            } else if (NameFormat.format(JCR_DEREF, resolver).equals(fName)) {
-                                    name = ISO9075.decode(QName.fromJCRName(value, resolver));
+                                    name = ISO9075.decode(NameFormat.parse(value, resolver));
-            } else if (JCR_SCORE.toJCRName(resolver).equals(fName)) {
+            } else if (NameFormat.format(JCR_SCORE, resolver).equals(fName)) {
-                propName.substring(0, propName.length() - 1);
+                propName = propName.substring(0, propName.length() - 1);
-            QName name = ISO9075.decode(QName.fromJCRName(propName, resolver));
+            QName name = ISO9075.decode(NameFormat.parse(propName, resolver));
