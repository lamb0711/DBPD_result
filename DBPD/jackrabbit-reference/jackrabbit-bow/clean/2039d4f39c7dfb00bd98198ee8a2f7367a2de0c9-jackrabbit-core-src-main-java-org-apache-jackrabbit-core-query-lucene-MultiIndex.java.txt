JCR-1854: Use Journal as index redo log when available
- introduce a factory for redo logs
- expose ConsistencyCheck on SearchIndex

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@803825 13f79535-47bb-0310-9956-ffa450edef68

+     * The redo log factory
+     */
+    private final RedoLogFactory redoLogFactory;
+
+    /**
+        this.redoLogFactory = handler.getRedoLogFactory();
-        this.redoLog = RedoLog.create(indexDir, indexNames.getGeneration());
+        this.redoLog = redoLogFactory.createRedoLog(this);
+     * Runs a consistency check on this multi index.
+     *
+     * @return the consistency check.
+     * @throws IOException if an error occurs while running the check.
+     */
+    ConsistencyCheck runConsistencyCheck() throws IOException {
+        return ConsistencyCheck.run(this,
+                handler.getContext().getItemStateManager());
+    }
+
+    /**
+     * @return the base directory of the index.
+     */
+    Directory getDirectory() {
+        return indexDir;
+    }
+
+    /**
+     * @return the current generation of the index names.
+     */
+    long getIndexGeneration() {
+        return indexNames.getGeneration();
+    }
+
+    /**
-                redoLog = RedoLog.create(indexDir, indexNames.getGeneration());
+                redoLog = redoLogFactory.createRedoLog(this);
