Work in progress
- Make sure there is a subscription on the server before a batch is submitted. Otherwise observation events for the batch are not accessible anymore.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@482636 13f79535-47bb-0310-9956-ffa450edef68

+import javax.jcr.Repository;
+        checkSessionInfo(sessionInfo);
-        // send batched information
+        // make sure we have a subscription on the server before we
+        // submit the batch
+        if (((SessionInfoImpl) batchImpl.sessionInfo).getSubscriptionId() == null
+                && "true".equals(getRepositoryDescriptors().get(Repository.OPTION_OBSERVATION_SUPPORTED))) {
+            getEvents(batchImpl.sessionInfo, 0, new EventFilter[0]);
+        }        // send batched information
