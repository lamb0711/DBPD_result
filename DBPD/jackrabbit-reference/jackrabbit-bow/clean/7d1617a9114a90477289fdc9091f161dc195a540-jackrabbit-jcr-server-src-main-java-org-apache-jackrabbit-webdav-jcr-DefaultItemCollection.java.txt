JCR-3830 : Allow for privilege discovery in jcr-server

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1640531 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.webdav.jcr.security.JcrUserPrivilegesProperty;
+import org.apache.jackrabbit.webdav.jcr.security.JcrSupportedPrivilegesProperty;
+import org.apache.jackrabbit.webdav.jcr.security.SecurityUtils;
+import org.apache.jackrabbit.webdav.security.SecurityConstants;
+                } else if (SecurityConstants.SUPPORTED_PRIVILEGE_SET.equals(name)) {
+                    prop = new JcrSupportedPrivilegesProperty(getRepositorySession(), n.getPath()).asDavProperty();
+                } else if (SecurityConstants.CURRENT_USER_PRIVILEGE_SET.equals(name)) {
+                    prop = new JcrUserPrivilegesProperty(getRepositorySession(), n.getPath()).asDavProperty();
+            if (SecurityUtils.supportsAccessControl(getRepositorySession())) {
+                names.add(SecurityConstants.SUPPORTED_PRIVILEGE_SET);
+                names.add(SecurityConstants.CURRENT_USER_PRIVILEGE_SET);
+            }
