work in progress

- RepositoryService.lock -> add return value
- Merge-Operation, VersionManager: merge returns failed-Ids
- LockManager: lock returns lockInfo
- javadoc, todos

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@478581 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.jcr2spi.observation.InternalEventListener;
+import org.apache.jackrabbit.spi.IdIterator;
-    private final InternalEventListener eventListener;
-    private Merge(NodeState nodeState, String srcWorkspaceName, boolean bestEffort, InternalEventListener eventListener) {
+    private IdIterator failedIds = null;
+
+    private Merge(NodeState nodeState, String srcWorkspaceName, boolean bestEffort) {
-        this.eventListener = eventListener;
-    public InternalEventListener getEventListener() {
-        return eventListener;
+    public void setFailedIds(IdIterator failedIds) {
+        if (failedIds == null) {
+            throw new IllegalArgumentException("IdIterator must not be null.");
+        }
+        if (this.failedIds != null) {
+            throw new IllegalStateException("Merge operation has already been executed -> FailedIds already set.");
+        }
+        this.failedIds = failedIds;
+    public IdIterator getFailedIds() {
+        if (failedIds == null) {
+            throw new IllegalStateException("Merge operation has not been executed yet.");
+        }
+        return failedIds;
+    }
-    public static Operation create(NodeState nodeState, String srcWorkspaceName, boolean bestEffort, InternalEventListener eventListener) {
-        return new Merge(nodeState, srcWorkspaceName, bestEffort, eventListener);
+    public static Merge create(NodeState nodeState, String srcWorkspaceName, boolean bestEffort) {
+        return new Merge(nodeState, srcWorkspaceName, bestEffort);
