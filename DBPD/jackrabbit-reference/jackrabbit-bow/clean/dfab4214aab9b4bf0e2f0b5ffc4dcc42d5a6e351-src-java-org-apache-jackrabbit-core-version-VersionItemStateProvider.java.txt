- rearranging structure of versioning (will corrupt versioned data)
- adding observation of version storage (work in progress)


git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@159366 13f79535-47bb-0310-9956-ffa450edef68

-                state = new VersionHistoryNodeState(this, (InternalVersionHistory) vi, rootNodeId.getUUID());
+                InternalVersionHistory vh = (InternalVersionHistory) vi;
+                state = new VersionHistoryNodeState(this, vh, rootNodeId.getUUID());
-                String uuid = UUID.randomUUID().toString();
-                VersionLabelsNodeState vlns = new VersionLabelsNodeState(this, (InternalVersionHistory) vi, state.getUUID(), uuid);
+                String uuid = vh.getVersionLabelsUUID();
+                VersionLabelsNodeState vlns = new VersionLabelsNodeState(this, vh, state.getUUID(), uuid);
-                // todo: do not read frozen stuff from frozen node instance here, rather put to version
-                //state.setPropertyValue(JCR_FROZENUUID, InternalValue.create(v.getFrozenNode().getFrozenUUID()));
-                //state.setPropertyValue(JCR_FROZENPRIMARYTYPE, InternalValue.create(v.getFrozenNode().getFrozenPrimaryType()));
-                //state.setPropertyValues(JCR_FROZENMIXINTYPES, PropertyType.NAME, InternalValue.create(v.getFrozenNode().getFrozenMixinTypes()));
-                //state.setPropertyValues(JCR_VERSIONLABELS, PropertyType.STRING, InternalValue.create(v.getLabels()));
