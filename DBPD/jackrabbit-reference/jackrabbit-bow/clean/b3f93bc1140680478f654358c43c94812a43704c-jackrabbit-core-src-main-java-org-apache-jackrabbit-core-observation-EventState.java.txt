JCR-2744: Avoid element arrays in PathImpl

Use relative paths instead of path elements in event states

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@997227 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.spi.commons.name.PathBuilder;
-import org.apache.jackrabbit.spi.commons.conversion.MalformedPathException;
-    private final Path.Element childRelPath;
+    private final Path childRelPath;
-                       NodeId childId, Path.Element childPath, Name nodeType,
+                       NodeId childId, Path childPath, Name nodeType,
-                                            Path.Element childPath,
+                                            Path childPath,
-                                            Path.Element childPath,
+                                            Path childPath,
-                                              Path.Element childPath,
+                                              Path childPath,
-                                              Path.Element childPath,
+                                              Path childPath,
-                                       Path.Element childPath,
+                                       Path childPath,
-
-    public static EventState nodeMoved(NodeId parentId,
-                                       Path destPath,
-                                       NodeId childId,
-                                       Path srcPath,
-                                       Name nodeType,
-                                       Set<Name> mixins,
-                                       Session session,
-                                       boolean external)
+    public static EventState nodeMovedWithInfo(
+            NodeId parentId, Path destPath, NodeId childId, Path srcPath,
+            Name nodeType, Set<Name> mixins, Session session, boolean external)
-                    childId, destPath.getNameElement(), nodeType, mixins,
+                    childId, destPath, nodeType, mixins,
-                                           Path.Element destChildPath,
-                                           Path.Element srcChildPath,
-                                           Path.Element beforeChildPath,
+                                           Path destChildPath,
+                                           Path srcChildPath,
+                                           Path beforeChildPath,
-        EventState es = nodeMoved(parentId, parentPath, childId, destChildPath,
-               nodeType, mixins, session, external);
+        EventState es = nodeMoved(
+                parentId, parentPath, childId, destChildPath,
+                nodeType, mixins, session, external);
-                                           Path.Element childPath,
+                                           Path childPath,
-                                           Path.Element childPath,
+                                           Path childPath,
-                                             Path.Element childPath,
+                                             Path childPath,
-                                             Path.Element childPath,
+                                             Path childPath,
-                                             Path.Element childPath,
+                                             Path childPath,
-                                             Path.Element childPath,
+                                             Path childPath,
-     * @return the <code>Path.Element</code> associated with this event.
+     * @return the <code>Path</code> associated with this event.
-    public Path.Element getChildRelPath() {
+    public Path getChildRelPath() {
-     * Creates an internal path value from the given path <code>element</code>.
+     * Creates an internal path value from the given path.
-     * @param element the path element.
-     * @return an internal value wrapping the path element.
+     * @param path the path
+     * @return an internal value wrapping the path
-    private static InternalValue createValue(Path.Element element) {
-        PathBuilder builder = new PathBuilder();
-        builder.addFirst(element);
-        try {
-            return InternalValue.create(builder.getPath());
-        } catch (MalformedPathException e) {
-            // this exception is only thrown when number of element is zero
-            throw new InternalError();
-        }
+    private static InternalValue createValue(Path path) {
+        return InternalValue.create(path);
