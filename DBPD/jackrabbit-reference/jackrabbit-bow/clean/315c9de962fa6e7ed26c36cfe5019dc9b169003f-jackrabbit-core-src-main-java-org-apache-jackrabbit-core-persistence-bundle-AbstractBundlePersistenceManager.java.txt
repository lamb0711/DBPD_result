JCR-3185: refactor consistency checks in BundleDBPersistenceManager into a standalone class that could be re-used for other PMs

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1221428 13f79535-47bb-0310-9956-ffa450edef68

+import javax.jcr.RepositoryException;
+import org.apache.jackrabbit.core.persistence.check.ConsistencyChecker;
+import org.apache.jackrabbit.core.persistence.check.ConsistencyReport;
-    PersistenceManager, CachingPersistenceManager, IterablePersistenceManager, CacheAccessListener {
+    PersistenceManager, CachingPersistenceManager, IterablePersistenceManager, CacheAccessListener, ConsistencyChecker {
-     * This implementation does nothing.
-     *
+        try {
+            ConsistencyCheckerImpl cs = new ConsistencyCheckerImpl(this);
+            cs.check(uuids, recursive, fix);
+        } catch (RepositoryException ex) {
+            log.error("While running consistency check.", ex);
+        }
+    }
+
+    /**
+     * {@inheritDoc}
+     */
+    public ConsistencyReport check(String[] uuids, boolean recursive, boolean fix) throws RepositoryException {
+        ConsistencyCheckerImpl cs = new ConsistencyCheckerImpl(this);
+        return cs.check(uuids, recursive, fix);
