JCR-2887 : Split PrivilegeRegistry in a per-session manager instance and a repository level registry [work in progress]
JCR-2774 : Access control for repository level API operations


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1177668 13f79535-47bb-0310-9956-ffa450edef68

+    public void checkRepositoryPermission(int permissions) throws AccessDeniedException, RepositoryException {
+        if (!isGranted((ItemId) null, permissions)) {
+            throw new AccessDeniedException("Access denied");
+        }
+    }
+
+    /**
+     * {@inheritDoc}
+     */
-        Path path = resolver.getQPath(absPath);
-        if (!path.isAbsolute()) {
-            throw new RepositoryException("Absolute path expected. Found: " + absPath);
-        }
+        if (absPath != null) {
+            Path path = resolver.getQPath(absPath);
+            if (!path.isAbsolute()) {
+                throw new RepositoryException("Absolute path expected. Found: " + absPath);
+            }
-        if (hierMgr.resolveNodePath(path) == null) {
-            throw new PathNotFoundException(absPath);
+            if (hierMgr.resolveNodePath(path) == null) {
+                throw new PathNotFoundException(absPath);
+            }
