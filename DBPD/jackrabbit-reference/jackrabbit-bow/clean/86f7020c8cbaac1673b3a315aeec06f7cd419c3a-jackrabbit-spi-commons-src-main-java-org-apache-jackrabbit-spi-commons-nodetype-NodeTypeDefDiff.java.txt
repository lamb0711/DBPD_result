JCR-3112: NodeTypeDefDiff.PropDefDiff.init() constraints change check bugs

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1182929 13f79535-47bb-0310-9956-ffa450edef68

-                    if (set2.containsAll(set1)) {
-                        // new set is a superset of old set
-                        // => constraints have been removed
-                        // (TRIVIAL change, since constraints are OR'ed)
+                    if (set2.isEmpty()) {
+                        // all existing constraints have been cleared
+                        // => TRIVIAL change
+                        type = TRIVIAL;
+                    } else if (set1.isEmpty()) {
+                        // constraints have been set on a previously unconstrained property
+                        // => MAJOR change
+                        type = MAJOR;
+                    } else if (set2.containsAll(set1)) {
+                        // new set is a superset of old set,
+                        // i.e. constraints have been weakened
+                        // (since constraints are OR'ed)
+                        // => TRIVIAL change
-                        // modifications are considered a MAJOR change.
+                        // such modifications are considered a MAJOR change.
