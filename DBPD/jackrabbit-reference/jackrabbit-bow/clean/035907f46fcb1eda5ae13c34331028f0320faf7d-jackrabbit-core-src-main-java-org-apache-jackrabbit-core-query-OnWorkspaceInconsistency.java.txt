JCR-2651 Add a OnWorkspaceInconsistency with logging only

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@953585 13f79535-47bb-0310-9956-ffa450edef68

+    /**
+     * An handler that simply logs the path of the parent node and the name
+     * of the missing child node
+     */
+    public static final OnWorkspaceInconsistency LOG = new OnWorkspaceInconsistency("log") {
+
+        public void handleMissingChildNode(NoSuchItemStateException exception,
+                                           QueryHandler handler,
+                                           Path path,
+                                           NodeState node,
+                                           ChildNodeEntry child)
+                throws RepositoryException, ItemStateException {
+            NamePathResolver resolver = new DefaultNamePathResolver(
+                    handler.getContext().getNamespaceRegistry());
+            log.error("Node {} ({}) has missing child '{}' ({})",
+                    new Object[]{
+                        resolver.getJCRPath(path),
+                        node.getNodeId(),
+                        resolver.getJCRName(child.getName()),
+                        child.getId()
+                    } + ". Please run a consistency check on this workspace!");
+        }
+    };
+
+        INSTANCES.put(LOG.name, LOG);
