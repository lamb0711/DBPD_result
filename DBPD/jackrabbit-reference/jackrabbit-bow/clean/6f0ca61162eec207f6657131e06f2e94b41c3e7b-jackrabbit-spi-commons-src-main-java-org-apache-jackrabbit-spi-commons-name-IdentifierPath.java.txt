JCR-2744: Avoid element arrays in PathImpl

Replace the inner PathImpl class in PathFactoryImpl with the new path classes.

Minor fixes and tweaks to the way in which especially identifier-based paths are handled.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@995735 13f79535-47bb-0310-9956-ffa450edef68

-    private final IdentifierElement element;
+    private final Element element;
-    public IdentifierPath(IdentifierElement element) {
+    public IdentifierPath(Element element) {
+        assert element != null;
+        assert element.denotesIdentifier();
+        } else if (degree > 0) {
+            throw new RepositoryException(
+                    "Cannot construct ancestor path from an identifier");
-            Path ancestor = this;
-            while (degree-- > 0) {
-                ancestor = new ParentPath(ancestor);
-            }
-            return ancestor;
+            return this;
+    //--------------------------------------------------------------< Object >
+
+    public final boolean equals(Object that) {
+        if (this == that) {
+            return true;
+        } else if (that instanceof IdentifierPath) {
+            IdentifierPath path = (IdentifierPath) that;
+            return element.equals(path.element);
+        } else {
+            return false;
+        }
+    }
+
+    public final int hashCode() {
+        return element.hashCode();
+    }
+
