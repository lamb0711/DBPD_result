JCR-2280: Lazy initialize ItemDefinition

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@808815 13f79535-47bb-0310-9956-ffa450edef68

-    private NodeDefinition getDefinition(NodeState state)
+    NodeDefinition getDefinition(NodeState state)
+        if (state.getId().equals(rootNodeId)) {
+            // special handling required for root node
+            return rootNodeDef;
+        }
+
-    private PropertyDefinition getDefinition(PropertyState state)
+    PropertyDefinition getDefinition(PropertyState state)
-        ItemId id = state.getId();
-        if (id.equals(rootNodeId)) {
-            // special handling required for root node
-            data = new NodeData((NodeState) state, rootNodeDef);
-        } else if (state.isNode()) {
+        if (state.isNode()) {
-            data = new NodeData(nodeState, getDefinition(nodeState));
+            data = new NodeData(nodeState, this);
-            data = new PropertyData(propertyState, getDefinition(propertyState));
+            data = new PropertyData(propertyState, this);
