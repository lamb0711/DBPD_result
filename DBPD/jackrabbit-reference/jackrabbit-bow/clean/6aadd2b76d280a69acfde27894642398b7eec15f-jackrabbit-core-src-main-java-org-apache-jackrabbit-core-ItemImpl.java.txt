JCR-890: concurrent read-only access to a session

Turn setProperty() into a SessionOperation

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@957491 13f79535-47bb-0310-9956-ffa450edef68

+    /**
+     * Checks the status of this item.
+     *
+     * @throws RepositoryException if this item no longer exists
+     */
+    protected void itemSanityCheck() throws RepositoryException {
+        // check status of this item for read operation
+        final int status = data.getStatus();
+        if (status == STATUS_DESTROYED || status == STATUS_INVALIDATED) {
+            throw new InvalidItemStateException(
+                    "Item does not exist anymore: " + id);
+        }
+    }
+
