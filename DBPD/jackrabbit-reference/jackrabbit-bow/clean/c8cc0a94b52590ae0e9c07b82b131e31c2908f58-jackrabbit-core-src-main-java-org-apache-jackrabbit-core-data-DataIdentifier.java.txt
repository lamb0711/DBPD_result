JCR-3534 - applied patch which adds ReferenceBinary API and implementation

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1480574 13f79535-47bb-0310-9956-ffa450edef68

-public final class DataIdentifier implements Serializable {
+public class DataIdentifier implements Serializable {
-     * Array of hexadecimal digits.
-     */
-    private static final char[] HEX = "0123456789abcdef".toCharArray();
-
-    /**
+     * Binary reference, or {@code null}.
+     */
+    private final String reference;
+
+    /**
+     * Creates a data identifier from the given string.
+     *
+     * @param identifier data identifier
+     * @param reference binary reference, or {@code null}
+     */
+    public DataIdentifier(String identifier, String reference) {
+        this.identifier = identifier;
+        this.reference = reference;
+    }
+
+    /**
-        this.identifier = identifier;
+        this(identifier, null);
-     * Creates a data identifier from the hexadecimal string
-     * representation of the given bytes.
+     * Returns a secure reference to the identified binary, or {@code null}
+     * if no such reference is available.
-     * @param identifier data identifier
+     * @return binary reference, or {@code null}
-    public DataIdentifier(byte[] identifier) {
-        char[] buffer = new char[identifier.length * 2];
-        for (int i = 0; i < identifier.length; i++) {
-            buffer[2 * i] = HEX[(identifier[i] >> 4) & 0x0f];
-            buffer[2 * i + 1] = HEX[identifier[i] & 0x0f];
-        }
-        this.identifier = new String(buffer);
+    public String getReference() {
+        return reference;
