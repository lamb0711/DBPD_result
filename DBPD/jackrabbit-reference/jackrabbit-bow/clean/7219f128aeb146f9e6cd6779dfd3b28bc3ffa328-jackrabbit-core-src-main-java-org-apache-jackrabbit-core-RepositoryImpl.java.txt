JCR-1441 - Support workspace event listeners that will be created/registered on initialization time


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@633546 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.config.EventListenerConfig;
+        
+        // create and register user-defined event listeners
+        EventListenerConfig[] elcs = wspInfo.config.getEventListenersConfig();
+        if (elcs != null) {
+            for (int i = 0; i < elcs.length; i++) {
+                EventListenerConfig elc = elcs[i];
+                
+                try {
+                    EventListener el = elcs[i].createEventListener();
+                    wsp.getObservationManager().addEventListener(el, 
+                            elc.getEventTypes(), elc.getAbsPath(), elc.isDeep(),
+                            elc.getUUID(), elc.getNodeTypeName(), elc.isNoLocal());
+                } catch (RepositoryException e) {
+                    log.error("Unable to create and register event listener: " +
+                            elc.getClassName() + ": " + e.getMessage(), e);
+                }
+            }
+        }
