JCR-1672: Adding Event interface and isLocal()

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@677261 13f79535-47bb-0310-9956-ffa450edef68

+     * Is this a local event listener
+     */
+    private final boolean isLocalEventListener;
+    /**
-                                 Set denied) {
+                                 Set denied,
+                                 boolean isLocalEventListener) {
+        this.isLocalEventListener = isLocalEventListener;
-            // check denied set
-            if (denied == null || !denied.contains(state.getTargetId())) {
-                try {
-                    next = filter.blocks(state) ? null : new EventImpl(filter.getSession(), state);
-                } catch (RepositoryException e) {
-                    log.error("Exception while applying filter.", e);
+            if ( !state.isExternal() || !isLocalEventListener ) {
+                // check denied set
+                if (denied == null || !denied.contains(state.getTargetId())) {
+                    try {
+                        next = filter.blocks(state) ? null : new EventImpl(filter.getSession(), state);
+                    } catch (RepositoryException e) {
+                        log.error("Exception while applying filter.", e);
+                    }
