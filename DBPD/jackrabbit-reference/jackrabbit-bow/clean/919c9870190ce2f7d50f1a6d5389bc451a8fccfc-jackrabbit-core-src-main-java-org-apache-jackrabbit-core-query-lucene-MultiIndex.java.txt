JCR-3162 Index update overhead on cluster slave due to JCR-905
 - rollback

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1214749 13f79535-47bb-0310-9956-ffa450edef68

+        IndexingQueueStore store = new IndexingQueueStore(indexDir);
+
-        this.indexingQueue = new IndexingQueue(new IndexingQueueStore(indexDir));
+        this.indexingQueue = new IndexingQueue(store);
-        Iterator<IndexInfo> iterator = indexNames.iterator();
-        while (iterator.hasNext()) {
-            IndexInfo info = iterator.next();
+        for (Iterator<?> it = indexNames.iterator(); it.hasNext(); ) {
+            IndexInfo info = (IndexInfo) it.next();
-                checkIndexingQueue(true);
-                safeFlush();
+                scheduleFlushTask();
-                scheduleFlushTask();
-        int volatileIndexDocuments = volatileIndex.getNumDocuments();
-        if (volatileIndexDocuments > 0) {
+        if (volatileIndex.getNumDocuments() > 0) {
-            log.debug("Committed in-memory index containing {} documents in {}ms.", volatileIndexDocuments, time);
+            log.debug("Committed in-memory index in " + time + "ms.");
-
+    
