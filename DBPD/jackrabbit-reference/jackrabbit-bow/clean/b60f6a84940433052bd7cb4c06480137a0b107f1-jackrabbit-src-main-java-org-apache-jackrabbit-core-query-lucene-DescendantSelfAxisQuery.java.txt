

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@371520 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.Map;
+import java.util.HashMap;
+     * Default score is 1.0f.
+     */
+    private static final Float DEFAULT_SCORE = new Float(1.0f);
+
+    /**
+         * Map that contains the scores for the sub hits. To save memory
+         * only scores that are not equal to 1.0f are put to this map.
+         * <p/>
+         * key=[Integer] id of selected document from sub query<br>
+         * value=[Float] score for that document
+         */
+        private final Map scores = new HashMap();
+
+        /**
-            return 1.0f;
+            Float score = (Float) scores.get(new Integer(nextDoc));
+            if (score == null) {
+                score = DEFAULT_SCORE;
+            }
+            return score.floatValue();
+                            if (score != DEFAULT_SCORE.floatValue()) {
+                                scores.put(new Integer(doc), new Float(score));
+                            }
