JCR-1598: Problematic exception handling in Jackrabbit WebApp 

Added a ServletExceptionWithCause utility class and used it to properly capture chained exceptions.

Minor improvements in exception and log messages.


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@691632 13f79535-47bb-0310-9956-ffa450edef68

-                            log.error("Error while opening bootstrap properties: {}", e.toString());
-                            throw new ServletException("Error while opening bootstrap properties: " + e.toString());
+                            throw new ServletExceptionWithCause(
+                                    "Bootstrap configuration not found: " + bstrp, e);
-                        log.error("Error while loading bootstrap properties: {}", e.toString());
-                        throw new ServletException("Error while loading bootstrap properties: " + e.toString());
+                        throw new ServletExceptionWithCause(
+                                "Bootstrap configuration failure: " + bstrp, e);
-                log.error("Repository acesss configuration is not valid.");
-                throw new ServletException("Repository access configuration is not valid.");
+                throw new ServletException(
+                        "Repository access configuration is not valid.");
-            log.error("Error while retrieving repository using JNDI (name=" + repositoryName + "): " + e);
+            log.error("Error while retrieving repository using JNDI (name={})", repositoryName, e);
-        log.info("  trying to retrieve repository using rmi. uri=" + rmiURI);
+        log.info("  trying to retrieve repository using rmi. uri={}", rmiURI);
-        } catch (NoClassDefFoundError e) {
-            log.error("Unable to locate RMI ClientRepositoryFactory. jcr-rmi.jar missing? " + e.toString());
-            return null;
-        } catch (Exception e) {
-            log.error("Unable to locate RMI ClientRepositoryFactory. jcr-rmi.jar missing?" + e.toString());
+        } catch (Throwable e) {
+            log.error("Unable to locate RMI ClientRepositoryFactory. Is jcr-rmi.jar missing?", e);
-            log.error("Error while retrieving repository using RMI: " + e);
+            log.error("Error while retrieving repository using RMI: {}", rmiURI, e);
-                    log.debug("Got Repository from ServletContext attribute '" + repositoryContextAttributeName + "'");
+                    log.debug("Got Repository from ServletContext attribute '{}'", repositoryContextAttributeName);
-                    log.debug("ServletContext attribute '" + repositoryContextAttributeName + "' does not provide a Repository");
+                    log.debug("ServletContext attribute '{}' does not provide a Repository", repositoryContextAttributeName);
