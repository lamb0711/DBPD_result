JCR-2094: Use an enumeration for QOM operators

Use the Operator enumeration in spi-commons

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@770682 13f79535-47bb-0310-9956-ffa450edef68

-    private static final Set<String> VALID_OPERATORS = new HashSet<String>();
-
-        VALID_OPERATORS.add(QueryObjectModelConstants.JCR_OPERATOR_EQUAL_TO);
-        VALID_OPERATORS.add(QueryObjectModelConstants.JCR_OPERATOR_GREATER_THAN);
-        VALID_OPERATORS.add(QueryObjectModelConstants.JCR_OPERATOR_GREATER_THAN_OR_EQUAL_TO);
-        VALID_OPERATORS.add(QueryObjectModelConstants.JCR_OPERATOR_LESS_THAN);
-        VALID_OPERATORS.add(QueryObjectModelConstants.JCR_OPERATOR_LESS_THAN_OR_EQUAL_TO);
-        VALID_OPERATORS.add(QueryObjectModelConstants.JCR_OPERATOR_LIKE);
-        VALID_OPERATORS.add(QueryObjectModelConstants.JCR_OPERATOR_NOT_EQUAL_TO);
-
-     * @param operand1 the first operand; non-null
-     * @param operator the operator; either <ul> <li>{@link #JCR_OPERATOR_EQUAL_TO},</li>
+     * @param left the first operand; non-null
+     * @param operatorName the operator; either <ul> <li>{@link #JCR_OPERATOR_EQUAL_TO},</li>
-     * @param operand2 the second operand; non-null
+     * @param right the second operand; non-null
-    public Comparison comparison(DynamicOperand operand1,
-                                 String operator,
-                                 StaticOperand operand2)
+    public Comparison comparison(
+            DynamicOperand left, String operatorName, StaticOperand right)
-        if (operand1 == null || operand2 == null) {
-            // TODO: correct exception?
-            throw new RepositoryException("operands must not be null");
+        if (!(left instanceof DynamicOperandImpl)) {
+            throw new RepositoryException("Invalid left operand: " + left);
-        if (!VALID_OPERATORS.contains(operator)) {
-            // TODO: correct exception?
-            throw new RepositoryException("invalid operator");
+        if (!(right instanceof StaticOperandImpl)) {
+            throw new RepositoryException("Invalid right operand: " + right);
-        if (operand1 instanceof DynamicOperandImpl
-                && operand2 instanceof StaticOperandImpl) {
-            return new ComparisonImpl(resolver,
-                    (DynamicOperandImpl) operand1,
-                    operator,
-                    (StaticOperandImpl) operand2);
-        } else {
-            throw new RepositoryException("Unknown operand implementation");
-        }
+
+        return new ComparisonImpl(
+                resolver,
+                (DynamicOperandImpl) left,
+                Operator.getOperatorByName(operatorName),
+                (StaticOperandImpl) right);
