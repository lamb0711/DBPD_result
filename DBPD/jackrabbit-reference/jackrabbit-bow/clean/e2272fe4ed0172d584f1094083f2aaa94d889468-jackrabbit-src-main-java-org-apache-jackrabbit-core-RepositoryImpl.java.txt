JCR-539: Concurrent Repository.login() throws IllegalStateException

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@430373 13f79535-47bb-0310-9956-ffa450edef68

+            // check initialize status
+            try {
+                initLock.readLock().acquire();
+            } catch (InterruptedException e) {
+                throw new RepositoryException("Unable to aquire read lock.", e);
+            }
+            try {
+                if (initialized) {
+                    // already initialized, we're done
+                    return false;
+                }
+            } finally {
+                initLock.readLock().release();
+            }
+
+            // workspace info was not initialized, now check again with write lock
-                    // already initialized, we're done
+                    // already initialized, some other thread was quicker, we're done
