JCR-2140 Configurations and Baselines


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@796586 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.Set;
-    public InternalConfiguration createConfiguration(Session session,
-                                                     final NodeId rootId,
-                                                     final InternalBaseline baseline)
+    public NodeId createConfiguration(Session session, final NodeId rootId)
-                return internalCreateConfiguration(rootId, baseline);
+                return internalCreateConfiguration(rootId);
-        return new InternalConfigurationImpl(this, state);
+        return state.getNodeId();
+    }
+
+    /**
+     * {@inheritDoc}
+     */
+    public InternalBaseline checkin(Session session,
+                                    final InternalConfiguration config,
+                                    final Set<NodeId> baseVersions)
+            throws RepositoryException {
+        return (InternalBaseline)
+                escFactory.doSourced((SessionImpl) session, new SourcedTarget() {
+            public Object run() throws RepositoryException {
+                return internalCheckin((InternalConfigurationImpl) config, baseVersions);
+            }
+        });
