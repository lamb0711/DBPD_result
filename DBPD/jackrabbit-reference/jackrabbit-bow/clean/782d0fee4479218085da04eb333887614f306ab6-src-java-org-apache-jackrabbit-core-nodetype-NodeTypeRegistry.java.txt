fixed bug in node type validation: added check that auto-create properties & child nodes specify a type

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@155625 13f79535-47bb-0310-9956-ffa450edef68

+            // check that auto-created properties specify a type
+            if (pd.getRequiredType() == PropertyType.UNDEFINED
+                    && pd.isAutoCreate()) {
+                String msg = "[" + name + "#" + pd.getName()
+                        + "] auto-created properties must specify a type";
+                log.debug(msg);
+                throw new InvalidNodeTypeDefException(msg);
+            }
+            // check that auto-created child-nodes specify a default primary type
+            if (cnd.getDefaultPrimaryType() == null
+                    && cnd.isAutoCreate()) {
+                String msg = "[" + name + "#" + cnd.getName()
+                        + "] auto-created child-nodes must specify a default primary type";
+                log.debug(msg);
+                throw new InvalidNodeTypeDefException(msg);
+            }
