JCR-2064 Add new JSR283 features to CND reader/writer
JCR-2153 Introduce QValueConstraint and change return type of QPropertyDefinition.getValueConstraints()
JCR-2158 Consolidate CND related classes from SPI and Core


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@785777 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.spi.QValueConstraint;
+import org.apache.jackrabbit.spi.commons.nodetype.constraint.ValueConstraint;
-    private final String[] valueConstraints;
+    private final QValueConstraint[] valueConstraints;
-    private final Name[] availableQueryOperators;
+    private final String[] availableQueryOperators;
-            valueConstraints = new String[0];
+            valueConstraints = QValueConstraint.EMPTY_ARRAY;
-            List vc = new ArrayList();
+            List<QValueConstraint> vc = new ArrayList<QValueConstraint>();
-                int constType = (requiredType == PropertyType.REFERENCE
-                        || requiredType == PropertyType.WEAKREFERENCE) ?  PropertyType.NAME : requiredType;
-                if (constType == PropertyType.NAME || constType == PropertyType.PATH) {
-                   qValue = ValueFormat.getQValue(qValue, constType, resolver, qValueFactory).getString();
-                }
-                vc.add(qValue);
+                vc.add(ValueConstraint.create(requiredType, qValue));
-            valueConstraints = (String[]) vc.toArray(new String[vc.size()]);
+            valueConstraints = vc.toArray(new QValueConstraint[vc.size()]);
-            availableQueryOperators = new Name[0];
+            availableQueryOperators = new String[0];
-            List names = new ArrayList();
+            List<String> names = new ArrayList<String>();
-                Name n = resolver.getQName(str);
-                names.add(n);
+                names.add(str);
-            availableQueryOperators = (Name[]) names.toArray(new Name[names.size()]);
+            availableQueryOperators = names.toArray(new String[names.size()]);
-    public String[] getValueConstraints() {
+    public QValueConstraint[] getValueConstraints() {
-    public Name[] getAvailableQueryOperators() {
+    public String[] getAvailableQueryOperators() {
