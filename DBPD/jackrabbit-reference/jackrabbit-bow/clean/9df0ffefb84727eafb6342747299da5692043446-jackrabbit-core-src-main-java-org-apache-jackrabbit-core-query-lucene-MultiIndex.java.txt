JCR-863: Use FileLock for locking instead of empty file

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@587450 13f79535-47bb-0310-9956-ffa450edef68

-                    indexNames.getName(i), sub, false,
+                    indexNames.getName(i), sub,
-     * @param create    if the index that is opened should delete existing index
-     *                  data.
-    synchronized PersistentIndex getOrCreateIndex(String indexName, boolean create)
+    synchronized PersistentIndex getOrCreateIndex(String indexName)
-        PersistentIndex index = new PersistentIndex(indexName, sub, create,
+        PersistentIndex index = new PersistentIndex(indexName, sub,
-            executeAndLog(new CreateIndex(getTransactionId(), index.getName(), false));
+            executeAndLog(new CreateIndex(getTransactionId(), index.getName()));
-            CreateIndex create = new CreateIndex(getTransactionId(), null, true);
+            CreateIndex create = new CreateIndex(getTransactionId(), null);
-            PersistentIndex idx = index.getOrCreateIndex(indexName, false);
+            PersistentIndex idx = index.getOrCreateIndex(indexName);
-         * Indicates if the index is forced to be created. That is, existing
-         * index data is deleted.
-         */
-        private final boolean create;
-
-        /**
-         * @param create        if <code>true</code> existing index data is
-         *                      overwritten.
-        CreateIndex(long transactionId, String indexName, boolean create) {
+        CreateIndex(long transactionId, String indexName) {
-            this.create = create;
-            // -> don't create index, simply open it.
-            return new CreateIndex(transactionId, arguments, false);
+            return new CreateIndex(transactionId, arguments);
-            PersistentIndex idx = index.getOrCreateIndex(indexName, create);
+            PersistentIndex idx = index.getOrCreateIndex(indexName);
-                PersistentIndex idx = index.getOrCreateIndex(indexName, false);
+                PersistentIndex idx = index.getOrCreateIndex(indexName);
-            PersistentIndex persistentIndex = index.getOrCreateIndex(targetIndex, true);
+            PersistentIndex persistentIndex = index.getOrCreateIndex(targetIndex);
