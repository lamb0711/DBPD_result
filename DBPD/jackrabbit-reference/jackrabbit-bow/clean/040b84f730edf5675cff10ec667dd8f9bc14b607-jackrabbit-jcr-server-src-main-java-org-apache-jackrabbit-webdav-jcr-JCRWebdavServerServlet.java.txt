JCR-3027 - apply modified patch (original author: chad davis)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1151397 13f79535-47bb-0310-9956-ffa450edef68

+     * Optional 'concurrency-level' parameter defining the concurrency level
+     * within the jcr-server. If the parameter is omitted the internal default
+     * value (50) is used.
+     */
+    public final static String INIT_PARAM_CONCURRENCY_LEVEL = "concurrency-level";
+
+    /**
-            server = new JCRWebdavServer(repository, getSessionProvider());
+            String cl = getInitParameter(INIT_PARAM_CONCURRENCY_LEVEL);
+            if (cl != null) {
+                try {
+                    server = new JCRWebdavServer(repository, getSessionProvider(), Integer.parseInt(cl));
+                } catch (NumberFormatException e) {
+                    log.debug("Invalid value '" + cl+ "' for init-param 'concurrency-level'. Using default instead.");
+                    server = new JCRWebdavServer(repository, getSessionProvider());
+                }
+            } else {
+                server = new JCRWebdavServer(repository, getSessionProvider());
+            }
-     * @param request
+     * @param request The webdav request
+     * @param ctx The servlet context.
+     *
+     * @return the JCR repository to be used by this servlet
