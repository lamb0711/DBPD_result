JCR-3950: fix XSS vulnerability in DirListingExportHandler


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1732436 13f79535-47bb-0310-9956-ffa450edef68

-     * Replaces illegal XML characters in the given string by their corresponding
-     * predefined entity references.
+     * Replaces XML characters in the given string that might need escaping
+     * as XML text or attribute
+        return encodeMarkupCharacters(text, false);
+    }
+
+    /**
+     * Replaces HTML characters in the given string that might need escaping
+     * as HTML text or attribute
+     *
+     * @param text text to be escaped
+     * @return a string
+     */
+    public static String encodeIllegalHTMLCharacters(String text) {
+        return encodeMarkupCharacters(text, true);
+    }
+
+    private static String encodeMarkupCharacters(String text, boolean isHtml) {
-                buf.append("&apos;");
+                buf.append(isHtml ? "&#39;" : "&apos;");
