work in progress

- HierarchyManager: changes methods to take ItemState instead of ItemId
- HierarchyManager: remove log-utility methods (saveGetJCRPath)
- HierarchyManager: remove CachingHierachyManager. not used
- ItemManager: changes methods to take ItemState instead of ItemId
- ItemStateValidator: remove utility methods not related to validation
- new class LogUtil that provides static saveGetJCRPath methods previously
  present on HierarchyManager, ItemStateValidator
- NodeState: add method 'getPropertyEntries()'
- create interface ChildPropertyEntry
- let PropertyReference implement ChildPropertyEntry

TODO: query/NodeIteratorImpl needs to be fixed. 


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@429652 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.spi.NodeId;
+import org.apache.jackrabbit.name.Path;
+import org.apache.jackrabbit.name.NamespaceResolver;
+import org.apache.jackrabbit.jcr2spi.HierarchyManager;
+import org.apache.jackrabbit.jcr2spi.util.LogUtil;
+import org.apache.jackrabbit.jcr2spi.state.ItemState;
+import javax.jcr.PathNotFoundException;
+import javax.jcr.RepositoryException;
+
+    // TODO to be removed after ID refactoring completed
+
+    /**
+     * 
+     * @param nodePath
+     * @param hierMgr
+     * @param nsResolver
+     * @return
+     * @throws PathNotFoundException
+     * @throws RepositoryException
+     */
+    protected static NodeId getNodeId(Path nodePath, HierarchyManager hierMgr, NamespaceResolver nsResolver) throws PathNotFoundException, RepositoryException {
+        ItemState itemState = hierMgr.getItemState(nodePath);
+        if (!itemState.isNode()) {
+            throw new PathNotFoundException(LogUtil.safeGetJCRPath(nodePath, nsResolver));
+        }
+        return (NodeId)itemState.getId();
+    }
