Apply modified patch for JCR-1740 ( Make ObjectIterator implement RangeIterator interface ) provided by Sergey Nebolsin

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@697453 13f79535-47bb-0310-9956-ffa450edef68

- * mapped objects. Note, though, that this iterator may not return the same
- * number of objects as the underlying node iterator as not all nodes may
- * successfully be mapped to objects. Any problems mapping nodes to objects are
- * logged at INFO level.
+ * mapped objects.
-
-    private static final Log log = LogFactory.getLog(ObjectIterator.class);
-
-    private Object nextResult;
-	
-		
-		// get first result
-        seek();
-
+    /**
+     * @see java.util.Iterator#hasNext()
+     */
-        return nextResult != null;
+        return nodeIterator.hasNext();
+    /**
+     * @see java.util.Iterator#next() 
+     */
-        if (nextResult == null) {
-            throw new NoSuchElementException();
+        try {
+            Node node = nodeIterator.nextNode();
+            return objectConverter.getObject(session, node.getPath());
+        } catch (RepositoryException re) {
+            throw new org.apache.jackrabbit.ocm.exception.RepositoryException("Repository access issue trying to map node to an object", re);
-
-        Object result = nextResult;
-        seek();
-        return result;
-
+    /**
+     * This Iterator implementation does not support removing elements, therefore
+     * this method always throws a <code>UnsupportOperationException</code>.
+     *
+     * @see java.util.Iterator#next()
+     */
-    private void seek() {
-        while (nodeIterator.hasNext()) {
-            try {
-                Node node = nodeIterator.nextNode();
-                Object value = objectConverter.getObject(session, node.getPath());
-                if (value != null) {
-                    nextResult = value;
-                    return;
-                }
-            } catch (RepositoryException re) {
-                log.info("Repository access issue trying to map node to an object", re);
-            } catch (ObjectContentManagerException ocme) {
-                log.info("Mapping Failure", ocme);
-            } catch (Throwable t) {
-                log.info("Unexpected Problem while trying to map a node to an object", t);
-            }
-        }
-
-        // no more results
-        nextResult = null;
-    }
-
+    /**
+     * @see javax.jcr.RangeIterator#skip(long)
+     */
+    /**
+     * @see javax.jcr.RangeIterator#getSize()
+     */
+    /**
+     * @see javax.jcr.RangeIterator#getPosition()
+     */
