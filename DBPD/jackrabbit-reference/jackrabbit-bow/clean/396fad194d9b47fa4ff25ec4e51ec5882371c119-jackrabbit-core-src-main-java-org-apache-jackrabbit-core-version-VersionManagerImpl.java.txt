JCR-314: Fine grained locking in SharedItemStateManager

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@605173 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.state.ISMLocking;
-                              ItemStateCacheFactory cacheFactory) throws RepositoryException {
+                              ItemStateCacheFactory cacheFactory,
+                              ISMLocking ismLocking) throws RepositoryException {
-            sharedStateMgr = createItemStateManager(pMgr, rootId, ntReg, cacheFactory);
+            sharedStateMgr = createItemStateManager(pMgr, rootId, ntReg, cacheFactory, ismLocking);
+     * @param ismLocking    the ISM locking implementation
-                                                             ItemStateCacheFactory cacheFactory)
+                                                             ItemStateCacheFactory cacheFactory,
+                                                             ISMLocking ismLocking)
-        return new VersionItemStateManager(pMgr, rootId, ntReg, cacheFactory);
+        return new VersionItemStateManager(pMgr, rootId, ntReg, cacheFactory, ismLocking);
