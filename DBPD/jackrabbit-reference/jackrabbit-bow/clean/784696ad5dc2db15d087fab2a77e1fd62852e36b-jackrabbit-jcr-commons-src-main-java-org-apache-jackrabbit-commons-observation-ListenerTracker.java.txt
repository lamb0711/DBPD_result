JCR-4013: Calculate eventConsumerTimeRatio for entire time series

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1759268 13f79535-47bb-0310-9956-ffa450edef68

-                double consumerTime = sum(eventConsumerTime.getValuePerSecond());
-                double producerTime = sum(eventProducerTime.getValuePerSecond());
+                double consumerTime = sum(eventConsumerTime);
+                double producerTime = sum(eventProducerTime);
-    private static long sum(long[] values) {
+    private static long sum(TimeSeriesRecorder timeSeries) {
+        long missingValue = timeSeries.getMissingValue();
+        long sum = 0;
+        sum += sum(timeSeries.getValuePerSecond(), missingValue);
+        sum += sum(timeSeries.getValuePerMinute(), missingValue);
+        sum += sum(timeSeries.getValuePerHour(), missingValue);
+        sum += sum(timeSeries.getValuePerWeek(), missingValue);
+        return sum;
+    }
+
+    private static long sum(long[] values, long missing) {
-            sum += v;
+            if (v != missing) {
+                sum += v;
+            }
