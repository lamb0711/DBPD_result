JCR-1775: Transaction-safe versioning

Inlined BatchedItemOperations.getOrCreateVersionHistory as it was already reduced to a single statement.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@702426 13f79535-47bb-0310-9956-ffa450edef68

+                    VersionManager manager = session.getVersionManager();
-                        VersionHistory vh = getOrCreateVersionHistory(newState);
+                        VersionHistory vh =
+                            manager.getVersionHistory(session, newState);
-                        VersionHistory vh = getOrCreateVersionHistory(newState);
+                        VersionHistory vh =
+                            manager.getVersionHistory(session, newState);
-                        VersionHistory vh = getOrCreateVersionHistory(newState);
+                        VersionHistory vh =
+                            manager.getVersionHistory(session, newState);
-     * Returns the version history of the given node state. A new
-     * version history will be created if doesn't exist yet.
-     *
-     * @param node node state
-     * @return the version history of the target node state
-     * @throws RepositoryException if an error occurs
-     */
-    private VersionHistory getOrCreateVersionHistory(NodeState node)
-            throws RepositoryException {
-        return session.getVersionManager().getVersionHistory(session, node);
-    }
-
-    /**
