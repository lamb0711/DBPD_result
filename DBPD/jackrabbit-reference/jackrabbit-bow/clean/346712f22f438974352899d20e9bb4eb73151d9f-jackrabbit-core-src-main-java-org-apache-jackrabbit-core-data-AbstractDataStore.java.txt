JCR-3534: Efficient copying of binaries across repositories with the same data store

Change getIdentifierFromReference() to getRecordFromReference() to avoid problems with a previously valid reference pointing to a record that has already been removed.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1484444 13f79535-47bb-0310-9956-ffa450edef68

-    public DataIdentifier getIdentifierFromReference(String reference) {
-        int colon = reference.indexOf(':');
-        if (colon != -1) {
-            DataIdentifier identifier =
-                    new DataIdentifier(reference.substring(0, colon));
-            if (reference.equals(getReferenceFromIdentifier(identifier))) {
-                return identifier;
+    public DataRecord getRecordFromReference(String reference)
+            throws DataStoreException {
+        if (reference != null) {
+            int colon = reference.indexOf(':');
+            if (colon != -1) {
+                DataIdentifier identifier =
+                        new DataIdentifier(reference.substring(0, colon));
+                if (reference.equals(getReferenceFromIdentifier(identifier))) {
+                    return getRecordIfStored(identifier);
+                }
