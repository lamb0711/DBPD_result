JCR-3830 : Allow for privilege discovery in jcr-server

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1640531 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.webdav.DavCompliance;
-import org.apache.jackrabbit.webdav.DavCompliance;
-import org.apache.jackrabbit.webdav.jcr.property.JcrDavPropertyNameSet;
-import org.apache.jackrabbit.webdav.observation.ObservationConstants;
-import org.apache.jackrabbit.webdav.observation.ObservationResource;
-import org.apache.jackrabbit.webdav.observation.SubscriptionManager;
-import org.apache.jackrabbit.webdav.observation.Subscription;
-import org.apache.jackrabbit.webdav.observation.SubscriptionInfo;
-import org.apache.jackrabbit.webdav.observation.EventDiscovery;
-import org.apache.jackrabbit.webdav.property.DefaultDavProperty;
-import org.apache.jackrabbit.webdav.property.HrefProperty;
+import org.apache.jackrabbit.webdav.jcr.property.JcrDavPropertyNameSet;
+import org.apache.jackrabbit.webdav.observation.EventDiscovery;
+import org.apache.jackrabbit.webdav.observation.ObservationConstants;
+import org.apache.jackrabbit.webdav.observation.ObservationResource;
+import org.apache.jackrabbit.webdav.observation.Subscription;
+import org.apache.jackrabbit.webdav.observation.SubscriptionInfo;
+import org.apache.jackrabbit.webdav.observation.SubscriptionManager;
-import org.apache.jackrabbit.webdav.security.CurrentUserPrivilegeSetProperty;
-import org.apache.jackrabbit.webdav.security.Privilege;
-import org.apache.jackrabbit.webdav.security.SecurityConstants;
+import org.apache.jackrabbit.webdav.property.DefaultDavProperty;
+import org.apache.jackrabbit.webdav.property.HrefProperty;
-import java.util.ArrayList;
-import java.util.List;
-            } else if (SecurityConstants.CURRENT_USER_PRIVILEGE_SET.equals(name)) {
-                // TODO complete set of properties defined by RFC 3744
-                Privilege[] allPrivs = new Privilege[] {PRIVILEGE_JCR_READ,
-                        PRIVILEGE_JCR_ADD_NODE,
-                        PRIVILEGE_JCR_SET_PROPERTY,
-                        PRIVILEGE_JCR_REMOVE};
-                List<Privilege> currentPrivs = new ArrayList<Privilege>();
-                for (Privilege priv : allPrivs) {
-                    try {
-                        String path = getLocator().getRepositoryPath();
-                        getRepositorySession().hasPermission(path, priv.getName());
-                        currentPrivs.add(priv);
-                    } catch (RepositoryException e) {
-                        // ignore
-                        log.debug(e.toString());
-                    }
-                }
-                prop =  new CurrentUserPrivilegeSetProperty(currentPrivs.toArray(new Privilege[currentPrivs.size()]));
