JCR-1839: Introduce Event.getDate()

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@713076 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.core.cluster.LockEventListener;
-    public void externalUpdate(ChangeLog changes, List events)
+    public void externalUpdate(ChangeLog changes, List events, long timestamp)
-        clusterEvents.add(new UpdateEvent(changes, events));
+        clusterEvents.add(new UpdateEvent(changes, events, timestamp));
+         * Timestamp when the changes in this update event occured.
+         */
+        private final long timestamp;
+
+        /**
+         * @param timestamp time when the changes in this event occured.
-        public UpdateEvent(ChangeLog changes, List events) {
+        public UpdateEvent(ChangeLog changes, List events, long timestamp) {
+            this.timestamp = timestamp;
+        public long getTimestamp() {
+            return timestamp;
+        }
+
+        /**
+         * {@inheritDoc}
+         */
-            return changes.hashCode() ^ events.hashCode();
+            return changes.hashCode() ^ events.hashCode() ^ (int) (timestamp ^ (timestamp >>> 32));
-                    SimpleEventListener.equals(events, other.events);
+                    SimpleEventListener.equals(events, other.events) &&
+                    timestamp == other.timestamp;
