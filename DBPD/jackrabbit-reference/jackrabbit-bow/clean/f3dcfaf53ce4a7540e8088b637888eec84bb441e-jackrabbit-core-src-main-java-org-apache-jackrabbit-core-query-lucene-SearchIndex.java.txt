JCR-1169 Distribution of commons classes (adjust jackrabbit-core)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@590014 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.name.NoPrefixDeclaredException;
-import org.apache.jackrabbit.name.QName;
-import org.apache.jackrabbit.name.NameFormat;
+import org.apache.jackrabbit.conversion.NamePathResolver;
+import org.apache.jackrabbit.spi.Name;
+import org.apache.jackrabbit.name.NameConstants;
+import javax.jcr.NamespaceException;
-        = Collections.unmodifiableList(Arrays.asList(new QName[]{
-            QName.NT_CHILDNODEDEFINITION,
-            QName.NT_FROZENNODE,
-            QName.NT_NODETYPE,
-            QName.NT_PROPERTYDEFINITION,
-            QName.NT_VERSION,
-            QName.NT_VERSIONEDCHILD,
-            QName.NT_VERSIONHISTORY,
-            QName.NT_VERSIONLABELS,
-            QName.REP_NODETYPES,
-            QName.REP_SYSTEM,
-            QName.REP_VERSIONSTORAGE,
+        = Collections.unmodifiableList(Arrays.asList(new Name[]{
+            NameConstants.NT_CHILDNODEDEFINITION,
+            NameConstants.NT_FROZENNODE,
+            NameConstants.NT_NODETYPE,
+            NameConstants.NT_PROPERTYDEFINITION,
+            NameConstants.NT_VERSION,
+            NameConstants.NT_VERSIONEDCHILD,
+            NameConstants.NT_VERSIONHISTORY,
+            NameConstants.NT_VERSIONLABELS,
+            NameConstants.REP_NODETYPES,
+            NameConstants.REP_SYSTEM,
+            NameConstants.REP_VERSIONSTORAGE,
-            QName.NT_BASE,
-            QName.MIX_REFERENCEABLE
+            NameConstants.NT_BASE,
+            NameConstants.MIX_REFERENCEABLE
+     * The name and path resolver used internally.
+     */
+    private NamePathResolver npResolver;
+
+    /**
-        
+        npResolver = NamePathResolverImpl.create(nsMappings);
+
-                                  QName[] orderProps,
+                                  Name[] orderProps,
-    protected SortField[] createSortFields(QName[] orderProps,
+    protected SortField[] createSortFields(Name[] orderProps,
-            if (QName.JCR_SCORE.equals(orderProps[i])) {
+            if (NameConstants.JCR_SCORE.equals(orderProps[i])) {
-                    prop = NameFormat.format(orderProps[i], getNamespaceMappings());
-                } catch (NoPrefixDeclaredException e) {
+                    prop = npResolver.getJCRName(orderProps[i]);
+                } catch (NamespaceException e) {
