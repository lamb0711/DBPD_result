JCR-2113 : JSR 283 Access Control Management (contribution by Alfusainey Jallow)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1656464 13f79535-47bb-0310-9956-ffa450edef68

+import java.security.Principal;
+import javax.jcr.RepositoryException;
+import javax.jcr.Session;
+import org.apache.jackrabbit.test.NotExecutableException;
+    private static final String PROP_ACCESSCONTROL_PROVIDER_CLASS = "org.apache.jackrabbit.jcr2spi.AccessControlProvider.class";
+
+    private static final String PROP_PROTECTED_ITEM_REMOVE_CLASS = "org.apache.jackrabbit.server.ProtectedItemRemoveHandler.class";
+
-    private static final String ACCESS_CONTROL_PROVIDER_PROPERTIES = "accessControlProvider.properties";
+    private final String acProviderImplClass;
-    // TODO
-    private static final String PROPERTIES_PROTECTED_ITEM_REMOVE_HANDLERS= "protectedHandlers.properties";
-    
+    private final String protectedRemoveImplClass;
+
+        acProviderImplClass = env.getProperty(PROP_ACCESSCONTROL_PROVIDER_CLASS);
+        protectedRemoveImplClass = env.getProperty(PROP_PROTECTED_ITEM_REMOVE_CLASS);
-            ServletHolder holder = new ServletHolder(
-                    new JcrRemotingServlet() {
-                        protected Repository getRepository() {
-                            return repository;
-                        }
-                    });
-            holder.setInitParameter(
-                    JCRWebdavServerServlet.INIT_PARAM_RESOURCE_PATH_PREFIX,
-                    "");
-            holder.setInitParameter(
-                    JCRWebdavServerServlet.INIT_PARAM_MISSING_AUTH_MAPPING,
-                    "");
-            holder.setInitParameter(JcrRemotingServlet.INIT_PARAM_PROTECTED_HANDLERS_CONFIG, 
-                    PROPERTIES_PROTECTED_ITEM_REMOVE_HANDLERS);
+            ServletHolder holder = new ServletHolder(new JcrRemotingServlet() {
+                protected Repository getRepository() {
+                    return repository;
+                }
+            });
+            holder.setInitParameter(JCRWebdavServerServlet.INIT_PARAM_RESOURCE_PATH_PREFIX, "");
+            holder.setInitParameter(JCRWebdavServerServlet.INIT_PARAM_MISSING_AUTH_MAPPING, "");
+            holder.setInitParameter(JcrRemotingServlet.INIT_PARAM_PROTECTED_HANDLERS_CONFIG, protectedRemoveImplClass);
-                String uri = "http://localhost:" + connector.getLocalPort() + "/";
+
+                String uri = "http://localhost:" + connector.getLocalPort() + "/";
+
-                // TODO
-                parameters.put(ACCESS_CONTROL_PROVIDER_PROPERTIES, "accessControlProvider.properties");
-                
+                parameters.put(PROP_ACCESSCONTROL_PROVIDER_CLASS, acProviderImplClass);
+
+    @Override
+    public Principal getKnownPrincipal(Session session) throws RepositoryException {
+        // TODO
+        return new Principal() {
+            @Override
+            public String getName() {
+                return "everyone";
+            }
+        };
+    }
+
+    @Override
+    public Principal getUnknownPrincipal(Session session) throws RepositoryException, NotExecutableException {
+        // TODO
+        return new Principal() {
+            @Override
+            public String getName() {
+                return "unknownPrincipal";
+            }
+        };
+    }
+
-
