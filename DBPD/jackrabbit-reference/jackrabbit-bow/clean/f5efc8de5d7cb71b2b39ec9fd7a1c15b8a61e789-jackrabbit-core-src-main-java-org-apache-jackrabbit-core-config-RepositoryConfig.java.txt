JCR-555: Improved reusability of the JCA package

Merge the classpath: repository config code from jca to core. Streamline the remaining jca code.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@923678 13f79535-47bb-0310-9956-ffa450edef68

+
+        ClassLoader loader = RepositoryImpl.class.getClassLoader();
+        String resource = REPOSITORY_XML;
+        } else if (conf.startsWith("classpath:")) {
+            loader = Thread.currentThread().getContextClassLoader();
+            resource = conf.substring("classpath:".length());
+            conf = new File(dir, REPOSITORY_XML).getPath();
-        File xml = new File(conf);
-        installRepositorySkeleton(xml, dir);
+        File xml = new File(conf);
+        installRepositorySkeleton(dir, xml, loader, resource);
-        installRepositorySkeleton(xml, dir);
+        installRepositorySkeleton(
+                dir, xml,
+                RepositoryImpl.class.getClassLoader(), REPOSITORY_XML);
-    private static void installRepositorySkeleton(File xml, File dir)
+    private static void installRepositorySkeleton(
+            File dir, File xml, ClassLoader loader, String resource)
-                InputStream input =
-                    RepositoryImpl.class.getResourceAsStream(REPOSITORY_XML);
+                InputStream input = loader.getResourceAsStream(resource);
