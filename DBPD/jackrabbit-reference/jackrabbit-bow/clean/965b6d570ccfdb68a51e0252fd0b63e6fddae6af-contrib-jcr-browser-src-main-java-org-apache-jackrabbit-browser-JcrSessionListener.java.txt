synchronize session as proposed by jukka
rename login filter to jcrloginfilter.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@478012 13f79535-47bb-0310-9956-ffa450edef68

-import java.io.ByteArrayInputStream;
-import java.util.Properties;
-
-import javax.jcr.Repository;
-import javax.naming.InitialContext;
-	private static Repository repository;
-
-	public static Repository getRepository() {
-		if (repository == null) {
-			try {
-				InitialContext ctx = new InitialContext();
-				String jndiAddress = (String) ctx
-						.lookup("java:comp/env/jcr/jndi/address");
-				String jndiProperties = (String) ctx
-						.lookup("java:comp/env/jcr/jndi/properties");
-				Properties properties = new Properties();
-				properties.load(new ByteArrayInputStream(jndiProperties
-						.getBytes()));
-				InitialContext repoCtx = new InitialContext(properties);
-				repository = (Repository) repoCtx.lookup(jndiAddress);
-			} catch (Exception e) {
-				throw new IllegalStateException(
-						"unable to retrieve repository. ", e);
-			}
-		}
-		return repository;
-	}
-
