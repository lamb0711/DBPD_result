JCR-3369: Garbage collector improvements
- applying patch from Mete Atamel

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1356612 13f79535-47bb-0310-9956-ffa450edef68

+     * Log interval for item state exceptions.
+     */
+    private static final int ITEM_STATE_EXCEPTION_LOG_INTERVAL_MILLIS = 60 * 1000;
+
+    /**
+     * Last time-stamp item state exception was logged with a stacktrace. 
+     */
+    private long itemStateExceptionLogTimestamp = 0;
+
+    /**
-            String msg = "failed to retrieve state of intermediary node";
-            log.debug(msg);
+            String msg = "failed to retrieve state of intermediary node for entry: " 
+                    + entry.getId() + ", path: " + path.getString();
+            logItemStateException(msg, e);
+     * Helper method to log item state exception with stack trace every so often.
+     * 
+     * @param logMessage log message
+     * @param e item state exception
+     */
+    private void logItemStateException(String logMessage, ItemStateException e) {
+        long now = System.currentTimeMillis();
+        if ((now - itemStateExceptionLogTimestamp) >= ITEM_STATE_EXCEPTION_LOG_INTERVAL_MILLIS) {
+            itemStateExceptionLogTimestamp = now;
+            log.debug(logMessage, e);
+        } else {
+            log.debug(logMessage);
+        }
+    }
+
+    /**
