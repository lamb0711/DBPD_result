JCR-337 - Remove jcr dependency from dav-library
JCR-343 - Report#init limits the Report interface to DeltaV compliant resources
JCR-340 - ValuesProperty missing property type information
JCR-342 - DavResource#getDavSession() missing
JCR-344 - DeltaVResource lists MKWORKSPACE in the method constant.
JCR-345 - DavException does not allow to specify an exception cause

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@385540 13f79535-47bb-0310-9956-ffa450edef68

-import javax.jcr.Session;
+        JcrDavSession.checkImplementation(request.getDavSession());
+        JcrDavSession session = (JcrDavSession)request.getDavSession();
-        DavSession session = request.getDavSession();
+        JcrDavSession.checkImplementation(session);
+        JcrDavSession sessionImpl = (JcrDavSession)session;
-            resource = createResourceForItem(locator, session);
+            resource = createResourceForItem(locator, sessionImpl);
-                resource =  new RootCollection(locator, session, this);
+                resource =  new RootCollection(locator, sessionImpl, this);
-		// todo: is this correct?
-		resource = new VersionControlledItemCollection(locator, session, this, null);
+                // todo: is this correct?
+                resource = new VersionControlledItemCollection(locator, sessionImpl, this, null);
-     * @param session
+     * @param sessionImpl
-    private DavResource createResourceForItem(DavResourceLocator locator, DavSession session) throws RepositoryException {
+    private DavResource createResourceForItem(DavResourceLocator locator, JcrDavSession sessionImpl) throws RepositoryException, DavException {
-        Item item = getItem(session, locator);
+        Item item = getItem(sessionImpl, locator);
-                resource = new VersionItemCollection(locator, session, this, item);
+                resource = new VersionItemCollection(locator, sessionImpl, this, item);
-                resource = new VersionHistoryItemCollection(locator, session, this, item);
+                resource = new VersionHistoryItemCollection(locator, sessionImpl, this, item);
-                resource =  new RootItemCollection(locator, session, this, item);
+                resource =  new RootItemCollection(locator, sessionImpl, this, item);
-                resource = new VersionControlledItemCollection(locator, session, this, item);
+                resource = new VersionControlledItemCollection(locator, sessionImpl, this, item);
-            resource = new DefaultItemResource(locator, session, this, item);
+            resource = new DefaultItemResource(locator, sessionImpl, this, item);
-    private Item getItem(DavSession davSession, DavResourceLocator locator) throws PathNotFoundException, RepositoryException {
-        Session s = davSession.getRepositorySession();
-        return s.getItem(locator.getJcrPath());
+    private Item getItem(JcrDavSession sessionImpl, DavResourceLocator locator)
+        throws PathNotFoundException, RepositoryException {
+        return sessionImpl.getRepositorySession().getItem(locator.getRepositoryPath());
