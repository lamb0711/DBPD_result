JCR-2762: Optimize bundle serialization

Remove duplicate code in ItemStateBinding by merging readID to readNodeId and writeID to writeNodeId.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1002606 13f79535-47bb-0310-9956-ffa450edef68

-        state.setParentId(readID(in));
+        state.setParentId(readNodeId(in));
-            NodeId parentId = readID(in);
+            NodeId parentId = readNodeId(in);
-                state.addShare(readID(in));
+                state.addShare(readNodeId(in));
-        writeID(out, state.getParentId());
+        writeNodeId(out, state.getParentId());
-            writeID(out, entry.getId());  // uuid
+            writeNodeId(out, entry.getId());  // uuid
-            writeID(out, iter.next());
+            writeNodeId(out, iter.next());
-    public void writeNodeId(DataOutputStream out, String id) throws IOException {
+    public void writeNodeId(DataOutputStream out, NodeId id) throws IOException {
-            out.write(new NodeId(id).getRawBytes());
+            out.write(id.getRawBytes());
-     * Deserializes a NodeID
-     * @param in the input stream
-     * @return the uuid
-     * @throws IOException in an I/O error occurs.
-     */
-    public NodeId readID(DataInputStream in) throws IOException {
-        if (in.readBoolean()) {
-            byte[] bytes = new byte[16];
-            int pos = 0;
-            while (pos < 16) {
-                pos += in.read(bytes, pos, 16 - pos);
-            }
-            return new NodeId(bytes);
-        } else {
-            return null;
-        }
-    }
-
-    /**
-     * Serializes a node id
-     * @param out the output stream
-     * @param id the id
-     * @throws IOException in an I/O error occurs.
-     */
-    public void writeID(DataOutputStream out, NodeId id) throws IOException {
-        if (id == null) {
-            out.writeBoolean(false);
-        } else {
-            out.writeBoolean(true);
-            out.write(id.getRawBytes());
-        }
-    }
-
-    /**
-        writeID(out, id.getParentId());
+        writeNodeId(out, id.getParentId());
