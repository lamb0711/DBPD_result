- fixing latest locking issues
- fixing version items refresh

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@157083 13f79535-47bb-0310-9956-ffa450edef68

-    protected void removeChildProperty(QName propName) throws RepositoryException {
+    public void removeChildProperty(QName propName) throws RepositoryException {
-        Lock lock = lockMgr.lock(this, isDeep, isSessionScoped);
-
-        try {
-            internalSetProperty(JCR_LOCKOWNER,
-                    InternalValue.create(session.getUserId()));
-            internalSetProperty(JCR_LOCKISDEEP,
-                    InternalValue.create(isDeep));
-            save();
-
-        } catch (RepositoryException e) {
-
-            // An error occurred, so remove lock
-            lockMgr.unlock(this);
-            throw e;
-        }
-        return lock;
+        return lockMgr.lock(this, isDeep, isSessionScoped);
-
-        removeChildProperty(JCR_LOCKOWNER);
-        removeChildProperty(JCR_LOCKISDEEP);
-        save();
