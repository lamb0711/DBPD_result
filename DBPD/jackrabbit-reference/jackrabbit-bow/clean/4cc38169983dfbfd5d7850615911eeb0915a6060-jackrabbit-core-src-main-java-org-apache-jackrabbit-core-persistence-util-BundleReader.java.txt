JCR-2762: Optimize bundle serialization

Move the binding version byte to the constructor for easier extensibility

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1005820 13f79535-47bb-0310-9956-ffa450edef68

+    private final int version;
+
+     * @throws IOException if an I/O error occurs.
-    public BundleReader(BundleBinding binding, InputStream stream) {
+    public BundleReader(BundleBinding binding, InputStream stream)
+            throws IOException {
+        this.version = in.readUnsignedByte();
-        // read version and primary type...special handling
-        int index = in.readInt();
-
-        // get version
-        int version = (index >> 24) & 0xff;
-        index &= 0x00ffffff;
-        String uri = binding.nsIndex.indexToString(index);
+        // read primary type...special handling
+        int a = in.readUnsignedByte();
+        int b = in.readUnsignedByte();
+        int c = in.readUnsignedByte();
+        String uri = binding.nsIndex.indexToString(a << 16 | b << 8 | c);
