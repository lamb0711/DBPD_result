#0000 - avoid NPE upon Restore.persisted in case of a 
        Workspace.restore.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@508431 13f79535-47bb-0310-9956-ffa450edef68

+            NodeEntry entry;
-                NodeEntry root = nodeState.getNodeEntry();
-                while (root.getParent() != null) {
-                    root = root.getParent();
+                // -> start searching root-entry from any version-entry or
+                //    from the given nodestate
+                entry = (nodeState == null) ? versionStates[0].getNodeEntry() : nodeState.getNodeEntry();
+                while (entry.getParent() != null) {
+                    entry = entry.getParent();
-                root.invalidate(true);
-                nodeState.getHierarchyEntry().invalidate(true);
+                entry = nodeState.getNodeEntry();
+            entry.invalidate(true);
