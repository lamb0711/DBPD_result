JCR-890: concurrent read-only access to a session

Remove the SessionImpl reference to NodeTypeInstanceHandler

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@985833 13f79535-47bb-0310-9956-ffa450edef68

+import javax.jcr.RepositoryException;
+
+import org.apache.jackrabbit.core.state.PropertyState;
+     * Sets the system-generated or node type -specified default values
+     * of the given property. If such values are not specified, then the
+     * property is not modified.
+     *
+     * @param property property state
+     * @param parent parent node state
+     * @param def property definition
+     * @param userId user identifier associated with the current session
+     * @throws RepositoryException if the default values could not be created
+     */
+    public void setDefaultValues(
+            PropertyState property, NodeState parent, QPropertyDefinition def)
+            throws RepositoryException {
+        InternalValue[] values =
+            computeSystemGeneratedPropertyValues(parent, def);
+        if (values == null && def.getDefaultValues() != null) {
+            values = InternalValue.create(def.getDefaultValues());
+        }
+        if (values != null) {
+            property.setValues(values);
+        }
+    }
+
+    /**
