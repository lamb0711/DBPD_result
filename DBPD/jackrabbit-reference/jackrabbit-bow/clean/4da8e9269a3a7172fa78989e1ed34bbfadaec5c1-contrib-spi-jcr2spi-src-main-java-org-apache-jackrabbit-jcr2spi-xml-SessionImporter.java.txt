work in progress

- operations: rename getAffectedIds to getAffectedStates
- operations: return ItemState params instead of ids whereever possible and
  let OperationVisitor deal with all kind of issues arising with SPI ids.
- AddNode/AddProperty operations: don't list state to be created as affected. Not required since operations are collected upon refresh/save, in which case a 'new' item can never be the starting point.
- transient move: let parent NodeState handle the move/renaming of child states
- transient reorder: let parent NodeState handle the reorder logic
- NodeState: remove unused methods and mark setParent private
- NodeImpl: protected getNodeId() no more used by subclasses in version package.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@431887 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.spi.PropertyId;
-                    PropertyId newPId = session.getIdFactory().createPropertyId(parent.getNodeId(), newName);
-                    Operation ap = AddProperty.create(newPId, conflicting.getType(), propDef, conflicting.getValues());
+                    Operation ap = AddProperty.create(parent, newName, conflicting.getType(), propDef, conflicting.getValues());
-            NodeId newId = session.getIdFactory().createNodeId(nodeInfo.getUUID());
-            Operation an = AddNode.create(parent, nodeInfo.getName(), nodeInfo.getNodeTypeName(), newId);
+            Operation an = AddNode.create(parent, nodeInfo.getName(), nodeInfo.getNodeTypeName(), nodeInfo.getUUID());
-            PropertyId mixinPId = session.getIdFactory().createPropertyId(childState.getNodeId(), QName.JCR_MIXINTYPES);
-            Operation sm = SetMixin.create(mixinPId, nodeInfo.getMixinNames());
+            Operation sm = SetMixin.create(childState, nodeInfo.getMixinNames());
-     * @param nodeState
+     * @param parentState
-            PropertyId newPId = session.getIdFactory().createPropertyId(parentState.getNodeId(), propName);
-            Operation ap = AddProperty.create(newPId, targetType, def, values);
+            Operation ap = AddProperty.create(parentState, propName, targetType, def, values);
