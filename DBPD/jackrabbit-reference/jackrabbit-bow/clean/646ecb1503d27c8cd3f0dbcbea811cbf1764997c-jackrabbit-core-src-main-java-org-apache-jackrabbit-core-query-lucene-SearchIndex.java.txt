JCR-952: Support lower and upper case functions in "order by" clause

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1051916 13f79535-47bb-0310-9956-ffa450edef68

-     * @param resultFetchHint a hint on how many results should be fetched.
-     * @return the query hits.
+     * @param orderFuncs      functions for the properties for sort order. 
+     * @param resultFetchHint a hint on how many results should be fetched.  @return the query hits.
-                                             long resultFetchHint)
+                                             String[] orderFuncs, long resultFetchHint)
-        Sort sort = new Sort(createSortFields(orderProps, orderSpecs));
+        Sort sort = new Sort(createSortFields(orderProps, orderSpecs, orderFuncs));
+     * @param orderFuncs the functions for the properties. 
-                                           boolean[] orderSpecs) {
+                                           boolean[] orderSpecs, String[] orderFuncs) {
-                sortFields.add(new SortField(orderProps[i].getString(), scs, !orderSpecs[i]));
+                if ("upper-case".equals(orderFuncs[i])) {
+                    sortFields.add(new SortField(orderProps[i].getString(), new UpperCaseSortComparator(scs), !orderSpecs[i]));
+                } else if ("lower-case".equals(orderFuncs[i])) {
+                    sortFields.add(new SortField(orderProps[i].getString(), new LowerCaseSortComparator(scs), !orderSpecs[i]));
+                } else {
+                    sortFields.add(new SortField(orderProps[i].getString(), scs, !orderSpecs[i]));
+                }
