JCR-2003: JCR2SPI / SPI: Add support for JCR 2.0

- initial implementation for Node.setPrimaryType. untested server-side part (spi2dav/spi2davex)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@779476 13f79535-47bb-0310-9956-ffa450edef68

+            } else if (JcrConstants.JCR_PRIMARYTYPE.equals(propName)) {
+                setPrimaryType(parent, extractValuesFromRequest(targetPath));
+    private static void setPrimaryType(Node n, Value[] values) throws RepositoryException, DiffException {
+        if (values.length == 1) {
+            String ntName = values[0].getString();
+            if (!ntName.equals(n.getPrimaryNodeType().getName())) {
+                n.setPrimaryType(ntName);
+            } // else: same primaryType as before -> nothing to do.
+        } else {
+            throw new DiffException("Invalid diff: jcr:primarytype cannot have multiple values, nor can it's value be removed.");
+        }
+    }
+
