JCR-1154: Throw DataStoreException instead of IOException

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@591286 13f79535-47bb-0310-9956-ffa450edef68

-     * @throws IOException if the record could not be created
+     * @throws DataStoreException if the record could not be created
-    public DataRecord addRecord(InputStream input) throws IOException {
-        File temporary = newTemporaryFile();
+    public DataRecord addRecord(InputStream input) throws DataStoreException {
+        File temporary = null;
+            temporary = newTemporaryFile();
-            throw new IOException(DIGEST + " not available: " + e.getMessage());
+            throw new DataStoreException(DIGEST + " not available", e);
+        } catch (IOException e) {
+            throw new DataStoreException("Could not add record", e);
-            temporary.delete();
+            if (temporary != null) {
+                temporary.delete();
+            }
-        File temporary = File.createTempFile(TMP, null, directory);
-        return temporary;
+        return File.createTempFile(TMP, null, directory);
