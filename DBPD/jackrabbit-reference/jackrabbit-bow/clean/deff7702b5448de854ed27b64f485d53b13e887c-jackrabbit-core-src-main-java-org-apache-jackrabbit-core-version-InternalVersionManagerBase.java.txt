JCR-3393: InternalVersionManagerBase.calculateCheckinVersionName may fail with NPE on broken versioning persistence

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1362924 13f79535-47bb-0310-9956-ffa450edef68

+
+        if (history == null) {
+            String message = "Node " + node.getNodeId() + " has no version history";
+            log.error(message);
+            throw new VersionException(message);
+        }
+
+                if (pred == null) {
+                    String message = "Could not instantiate InternalVersion for nodeId " + value.getNodeId() + " (VHR + " + history.getId() + ", node " + node.getNodeId() + ")";
+                    log.error(message);
+                    throw new VersionException(message);
+                }
+
+        if (best == null) {
+            String message = "Could not find 'best' predecessor node for " + node.getNodeId();
+            log.error(message);
+            throw new VersionException(message);
+        }
+
