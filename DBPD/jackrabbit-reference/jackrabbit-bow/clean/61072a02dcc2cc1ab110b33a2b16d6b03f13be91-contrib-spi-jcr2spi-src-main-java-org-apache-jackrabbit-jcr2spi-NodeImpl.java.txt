- Replace NodeState.getChildNodeEntry(NodeId) with NodeState.getChildNodeEntry(NodeState)
- Replace NodeState.reorderChildNodeEntries(NodeId, NodeId) with NodeState.reorderChildNodeEntries(NodeState, NodeState)
- ReorderNodes operation now works with NodeStates instead of NodeIds.
- Simplify NodeImpl.getQName()

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@431904 13f79535-47bb-0310-9956-ffa450edef68

-        Operation op = ReorderNodes.create(getNodeState(), srcName, beforeName);
+        Operation op = null;
+        try {
+            op = ReorderNodes.create(getNodeState(), srcName, beforeName);
+        } catch (NoSuchItemStateException e) {
+            throw new ItemNotFoundException(e.getMessage(), e);
+        } catch (ItemStateException e) {
+            throw new RepositoryException("Unable to reorder nodes: " + e.getMessage(), e);
+        }
-        ChildNodeEntry parentEntry = parentState.getChildNodeEntry(getNodeId());
+        ChildNodeEntry parentEntry = parentState.getChildNodeEntry(getNodeState());
+        if (parentEntry == null) {
+            String msg = "Unable to retrieve index for: " + safeGetJCRPath();
+            throw new RepositoryException(msg);
+        }
-        NodeState parentState = getNodeState().getParent();
-        if (parentState == null) {
+        if (getNodeState().getParent() == null) {
-        ChildNodeEntry entry = parentState.getChildNodeEntry(getNodeId());
-        if (entry == null) {
-            String msg = "Failed to retrieve qualified name of Node " + getNodeId();
-            log.debug(msg);
-            throw new RepositoryException(msg);
-        }
-        return entry.getName();
+        return getNodeState().getName();
