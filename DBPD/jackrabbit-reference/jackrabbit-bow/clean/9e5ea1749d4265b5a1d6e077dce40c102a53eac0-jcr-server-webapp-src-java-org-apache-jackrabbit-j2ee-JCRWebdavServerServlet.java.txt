JCR-337 - Remove jcr dependency from dav-library
JCR-343 - Report#init limits the Report interface to DeltaV compliant resources
JCR-340 - ValuesProperty missing property type information
JCR-342 - DavResource#getDavSession() missing
JCR-344 - DeltaVResource lists MKWORKSPACE in the method constant.
JCR-345 - DavException does not allow to specify an exception cause

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@385540 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.webdav.jcr.JcrDavSession;
+import org.apache.jackrabbit.webdav.DavException;
+import javax.jcr.Session;
-	// set resource path prefix
+        // set resource path prefix
-        String wsName = request.getDavSession().getRepositorySession().getWorkspace().getName();
-        if (!resource.getLocator().isSameWorkspace(wsName)) {
+        try {
+            Session repositorySesssion = JcrDavSession.getRepositorySession(request.getDavSession());
+            String wsName = repositorySesssion.getWorkspace().getName();
+            if (!resource.getLocator().isSameWorkspace(wsName)) {
+                return false;
+            }
+        } catch (DavException e) {
+            log.error(e);
+
-     * Returns the <code>DavResourceFactory</code>. 
+     * Returns the <code>DavResourceFactory</code>.
