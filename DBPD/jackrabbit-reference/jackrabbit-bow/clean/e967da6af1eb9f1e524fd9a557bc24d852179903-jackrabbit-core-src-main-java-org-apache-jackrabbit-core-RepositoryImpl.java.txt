JCR-954: Allow to disable referential integrity checking for workspace
    - Added protected RepositoryImpl.setReferentialIntegrityChecking method
      and supporting functionality in SharedItemStateManager
    - Based on patches by Przemo Pakulski

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@632738 13f79535-47bb-0310-9956-ffa450edef68

+    /**
+     * Enables or disables referential integrity checking for given workspace.
+     * Disabling referential integrity checks can result in a corrupted
+     * workspace, and thus this feature is only available to customized
+     * implementations that subclass RepositoryImpl.
+     *
+     * @see https://issues.apache.org/jira/browse/JCR-954
+     * @param workspace name of the workspace
+     * @param enabled <code>true</code> to enable integrity checking (default),
+     *                <code>false</code> to disable it
+     * @throws RepositoryException if an error occurs
+     */
+    protected void setReferentialIntegrityChecking(
+            String workspace, boolean enabled) throws RepositoryException {
+        SharedItemStateManager manager = getWorkspaceStateManager(workspace);
+        manager.setCheckReferences(enabled);
+    }
+
