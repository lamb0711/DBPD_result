JCR-1245: JCR2SPI: Use namespace decl. present in imported xml to resolve Name/Path values

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@599366 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.conversion.NamePathResolver;
+import org.apache.jackrabbit.conversion.DefaultNamePathResolver;
+import org.apache.jackrabbit.conversion.ParsingPathResolver;
+import org.apache.jackrabbit.spi.PathFactory;
-    private final NameResolver nameResolver;
+    private final NamePathResolver resolver;
-                         NamespaceRegistry nsReg, NameFactory nameFactory) {
+                         NamespaceRegistry nsReg, NameFactory nameFactory,
+                         PathFactory pathFactory) {
-        nameResolver = new ParsingNameResolver(nameFactory, nsContext);
+        NameResolver nr = new ParsingNameResolver(nameFactory, nsContext);
+        resolver = new DefaultNamePathResolver(nr, new ParsingPathResolver(pathFactory, nr));
-                targetHandler = new SysViewImportHandler(importer, nsContext, nameResolver);
+                targetHandler = new SysViewImportHandler(importer, resolver);
-                targetHandler = new DocViewImportHandler(importer, nsContext, nameResolver, nameFactory);
+                targetHandler = new DocViewImportHandler(importer, resolver, nameFactory);
