JCR-2640: Internal repository context

Use the RepositoryContext to track the ItemStateCacheFactory instance.
Remove the RepositoryImpl member variables from SessionImpl and WorkspaceImpl.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@948874 13f79535-47bb-0310-9956-ffa450edef68

-     * the repository that issued this session
-     */
-    protected final RepositoryImpl rep;
-
-    /**
-        this.rep = repositoryContext.getRepository();
-        AMContext ctx = new AMContext(new File(rep.getConfig().getHomeDir()),
+        AMContext ctx = new AMContext(
+                new File(repositoryContext.getRepository().getConfig().getHomeDir()),
-        return rep.createSession(newSubject, workspaceName);
+        return repositoryContext.getWorkspaceManager().createSession(
+                newSubject, workspaceName);
-        final GarbageCollector gc = rep.createDataStoreGarbageCollector();
+        final GarbageCollector gc =
+            repositoryContext.getRepository().createDataStoreGarbageCollector();
-        return rep;
+        return repositoryContext.getRepository();
