JCR-333 NodeTypeDef depends on supertype ordering

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@384271 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.HashSet;
-    private QName defaultPrimaryType = null;
+    private QName defaultPrimaryType;
-    private QName[] requiredPrimaryTypes = new QName[] { QName.NT_BASE };
+    private HashSet requiredPrimaryTypes;
-    private boolean allowsSameNameSiblings = false;
+    private boolean allowsSameNameSiblings;
-    private NodeDefId id = null;
+    private NodeDefId id;
+        defaultPrimaryType = null;
+        requiredPrimaryTypes = new HashSet();
+        requiredPrimaryTypes.add(QName.NT_BASE);
+        allowsSameNameSiblings = false;
+        id = null;
-        // reset id field in order to force lazy recomputation of identifier
-        id = null;
-        this.requiredPrimaryTypes = requiredPrimaryTypes;
+        // reset id field in order to force lazy recomputation of identifier
+        id = null;
+        this.requiredPrimaryTypes.clear();
+        this.requiredPrimaryTypes.addAll(Arrays.asList(requiredPrimaryTypes));
-        return requiredPrimaryTypes;
+        if (requiredPrimaryTypes.isEmpty()) {
+            return QName.EMPTY_ARRAY;
+        }
+        return (QName[]) requiredPrimaryTypes.toArray(
+                new QName[requiredPrimaryTypes.size()]);
-                    && Arrays.equals(requiredPrimaryTypes, other.requiredPrimaryTypes)
+                    && requiredPrimaryTypes.equals(other.requiredPrimaryTypes)
