JCR-2715: Improved join query performance

Implement also same, child and descendant node join conditions.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1025644 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.ArrayList;
+import java.util.HashSet;
-        // TODO Auto-generated method stub
-        return Collections.emptyList();
+        Set<String> paths = new HashSet<String>();
+        for (Row row : leftRows) {
+            paths.addAll(getLeftValues(row));
+        }
+
+        List<Constraint> constraints = new ArrayList<Constraint>();
+        for (String path: paths) {
+            if (rightSelectors.contains(childSelector)) {
+                constraints.add(factory.childNode(childSelector, path));
+            } else {
+                constraints.add(factory.sameNode(parentSelector, path));
+            }
+        }
+        return constraints;
