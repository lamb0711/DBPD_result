JCR-307: improved performance when handling nodes with large number of child node entries
- reimplemented NodeState.ChildNodeEntries
- made ChildNodeEntry immutable again
- avoided unnecessary object creation when de-/serializing child node entries

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@373551 13f79535-47bb-0310-9956-ffa450edef68

-            char[] chars = new char[UUID_FORMATTED_LENGTH];
-            for (int i = 0, j = 0; i < 16; i++) {
-                chars[j++] = hexDigits[(rawBytes[i] >> 4) & 0x0f];
-                chars[j++] = hexDigits[rawBytes[i] & 0x0f];
-                if (i == 3 || i == 5 || i == 7 || i == 9) {
-                    chars[j++] = '-';
-                }
-            }
-            stringValue = new String(chars);
+            stringValue = bytesToString(rawBytes);
+
+    /** XXX begin modification by stefan@apache.org */
+    public static String bytesToString(byte[] bytes) {
+        if (bytes.length != UUID_BYTE_LENGTH) {
+            throw new IllegalArgumentException();
+        }
+        char[] chars = new char[UUID_FORMATTED_LENGTH];
+        for (int i = 0, j = 0; i < UUID_BYTE_LENGTH; i++) {
+            chars[j++] = hexDigits[(bytes[i] >> 4) & 0x0f];
+            chars[j++] = hexDigits[bytes[i] & 0x0f];
+            if (i == 3 || i == 5 || i == 7 || i == 9) {
+                chars[j++] = '-';
+            }
+        }
+        return new String(chars);
+    }
+
+    public static byte[] stringToBytes(String uuid) {
+        if (uuid.length() != UUID_FORMATTED_LENGTH) {
+            throw new IllegalArgumentException();
+        }
+        byte[] ba = new byte[UUID_BYTE_LENGTH];
+        for (int i = 0, j = 0; i < UUID_FORMATTED_LENGTH; i += 2) {
+            if (i == FORMAT_POSITION1 || i == FORMAT_POSITION2
+                    || i == FORMAT_POSITION3 || i == FORMAT_POSITION4) {
+                // skip '-'
+                i++;
+            }
+            ba[j++] = (byte) Integer.parseInt(uuid.substring(i, i + 2), 16);
+        }
+        return ba;
+    }
+    /** XXX end modification by stefan@apache.org */
