JCR-313: More javadocs.
Added a DatabasePersistenceManager.closeConnection() method to simplify the DerbyPersistenceManager shutdown sequence.

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@386845 13f79535-47bb-0310-9956-ffa450edef68

+import java.sql.Connection;
-        initialized = false;
-    //---------------------------------< SimpleDbPersistenceManager overrides >
-    /**
-     * {@inheritDoc}
-     * <p/>
-     * Overridden in order to properly shutdown the embedded Derby database.
-     */
-    public synchronized void close() throws Exception {
-        if (!initialized) {
-            throw new IllegalStateException("not initialized");
-        }
+    //------------------------------------------< DatabasePersistenceManager >
+    /**
+     * Closes the given connection by shutting down the embedded Derby
+     * database.
+     *
+     * @param connection database connection
+     * @throws SQLException if an error occurs
+     * @see DatabasePersistenceManager#closeConnection(Connection)
+     */
+    protected void closeConnection(Connection connection) throws SQLException {
-        String url = con.getMetaData().getURL();
+        String url = connection.getMetaData().getURL();
-        con.setAutoCommit(true);
-
-        // call base class implementation
-        super.close();
+        connection.setAutoCommit(true);
