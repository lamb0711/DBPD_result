JCR-442: Committed Nicolas' latest contrib/backup changes (patch-backup-060728.txt) with some modifications.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@426435 13f79535-47bb-0310-9956-ffa450edef68

+import java.io.IOException;
+
+import javax.jcr.LoginException;
+import javax.jcr.RepositoryException;
+import javax.jcr.Session;
+import javax.jcr.SimpleCredentials;
+
- * The constructor is called when instantiating the specific backup resource class through ManagerBackup.
+ * The constructor is called when instantiating the specific backup resource class through BackupManager.
+    Session session;
+     * @throws RepositoryException 
+     * @throws LoginException 
-    public Backup(RepositoryImpl repo, BackupConfig conf) {
+    //TODO Useful?
+    public Backup(RepositoryImpl repo, BackupConfig conf) throws LoginException, RepositoryException {
+        this.session = this.repo.login(
+                new SimpleCredentials(this.conf.getLogin(), this.conf.getPassword().toCharArray()));
+        
+        
+    }
+    
+    public void init(RepositoryImpl repo, BackupConfig conf) throws LoginException, RepositoryException {
+        this.repo = repo;
+        this.conf = conf;
+        this.session = this.repo.login(
+                new SimpleCredentials(this.conf.getLogin(), this.conf.getPassword().toCharArray()));
-     * Each ResourceBackup is responsible to handle backup of their content + configuration
+     * Each ResourceBackup is responsible to handle the backup.
+     * 
+     * We use file when we cannot assume anything on the size of the data or we know it's big. When
+     * we know the data is small we store it in RAM.
+     * 
+     *  
-    public abstract void backup(BackupIOHandler h);
+    public abstract void backup(BackupIOHandler h) throws RepositoryException, IOException;
-	
+    public Session getSession() {
+        return this.session;
+    }
+
+    //TODO call sesssion.logout or useless?
+    
