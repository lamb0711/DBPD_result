JCR-442: Committed Nicolas' latest contrib/backup changes (patch-backup-060719.txt)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@423575 13f79535-47bb-0310-9956-ffa450edef68

-import java.io.FileNotFoundException;
-    RepositoryBackup backup;
+    ManagerBackup backup;
+     * @throws IllegalAccessException 
+     * @throws InstantiationException 
+     * @throws ClassNotFoundException 
+     * @throws SizeException 
-    public static void main(String[] args) throws RepositoryException, AccessDeniedException, IOException {
+    public static void main(String[] args) throws RepositoryException, AccessDeniedException, IOException, ClassNotFoundException, InstantiationException, IllegalAccessException, SizeException {
-
-            if (args[i].equals("--size") && !(h != null)){
-            	
-            	Integer max = (new Integer(args[i+ 1]));
-                h.setMaxFileSize(max.intValue());        	
-            }
-            if (args[i].equals("--size") && !(h != null)){
+            if (args[i].equals("--size") && (h != null)){
-            if (args[i].equals("--conf") && !(h != null)){
+            if (args[i].equals("--conf")){
-    	LaunchBackup launch = new LaunchBackup(repoConfFile, home, confFile);
+    	LaunchBackup launch = null;
-					launch.backup(h);    		   		
+                launch = new LaunchBackup(repoConfFile, home, confFile); 
+                launch.backup(h);
+	    	        launch = new LaunchBackup();
-			launch.shutdown();
+			if (launch !=null)
+			    launch.shutdown();
-     * @throws FileNotFoundException 
+     * @throws IllegalAccessException 
+     * @throws InstantiationException 
+     * @throws ClassNotFoundException 
+     * @throws SizeException 
+     * @throws IOException 
-    public LaunchBackup(String repoConfFile, String home, String backupConfFile) throws RepositoryException, FileNotFoundException {
+    public LaunchBackup(String repoConfFile, String home, String backupConfFile) throws RepositoryException, ClassNotFoundException, InstantiationException, IllegalAccessException, SizeException, IOException {
+       
-		this.conf = BackupConfig.create(xml, home);
-		this.backup =  RepositoryBackup.create(this.conf);
+		this.conf = BackupConfig.create(xml);
+		this.backup =  ManagerBackup.create(this.repo, this.conf);
+    
+    /**
+     * Used for restore operations only
+     *
+     */
+
+    public LaunchBackup() {
+        // TODO Auto-generated constructor stub
+    }
+
+
-    * @param BackupIOHandler h a reference wher to backup
+    * @param BackupIOHandler h a reference where to backup
-        this.backup.backup(h);
+         this.backup.backup(h);
-    	this.backup.restore(h);
+        this.backup.restore(h);
