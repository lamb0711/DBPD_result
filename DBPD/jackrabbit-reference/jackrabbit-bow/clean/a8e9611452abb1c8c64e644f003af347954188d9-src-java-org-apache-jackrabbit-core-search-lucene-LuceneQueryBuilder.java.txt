- Removed interface EventDispatcher. not used anymore.
- Adapted implementation of path handling in search to use regular term queries instead of a filter -> scales better.
- Changed notion of TEST_ROOT in test classes to also include the root slash.

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@51875 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.Path;
-        String path = node.getPath();
+        PathQuery pathQuery = null;
-            path = nsMappings.translatePropertyName(node.getPath(),
-                    session.getNamespaceResolver());
+            // FIXME what about relative path?
+            Path p = Path.create(node.getPath(),
+                    session.getNamespaceResolver(), false);
+            pathQuery = new PathQuery(p, nsMappings, node.getType());
-        PathFilter filter = new PathFilter(path, node.getType());
-        return new PathFilterQuery((Query) data, new PackageFilter(filter));
+        if (pathQuery != null && pathQuery.getClauses().length > 0) {
+            BooleanQuery combined = new BooleanQuery();
+            combined.add(pathQuery, true, false);
+            combined.add((Query) data, true, false);
+            return combined;
+        } else {
+            return data;
+        }
