JCR-2087 Upgrade to Java 5 as the base platform

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@771693 13f79535-47bb-0310-9956-ffa450edef68

-    protected Map inUse = Collections.synchronizedMap(new WeakHashMap());
+    protected Map<DataIdentifier, WeakReference<DataIdentifier>> inUse = 
+        Collections.synchronizedMap(new WeakHashMap<DataIdentifier, WeakReference<DataIdentifier>>());
-    protected List temporaryInUse = Collections.synchronizedList(new ArrayList());
+    protected List<String> temporaryInUse = Collections.synchronizedList(new ArrayList<String>());
-            ArrayList touch = new ArrayList();
-            for (Iterator it = new ArrayList(inUse.keySet()).iterator(); it.hasNext();) {
-                DataIdentifier identifier = (DataIdentifier) it.next();
+            ArrayList<String> touch = new ArrayList<String>();
+            ArrayList<DataIdentifier> ids = new ArrayList<DataIdentifier>(inUse.keySet());
+            for (DataIdentifier identifier: ids) {
-            Iterator it = touch.iterator();
-            while (it.hasNext()) {
-                String key = (String) it.next();
+            for (String key : touch) {
-    public Iterator getAllIdentifiers() throws DataStoreException {
+    public Iterator<DataIdentifier> getAllIdentifiers() throws DataStoreException {
-        ArrayList list = new ArrayList();
+        ArrayList<DataIdentifier> list = new ArrayList<DataIdentifier>();
-        ArrayList list = connectionPool.getAll();
-        for (int i = 0; i < list.size(); i++) {
-            ConnectionRecoveryManager conn = (ConnectionRecoveryManager) list.get(i);
+        ArrayList<ConnectionRecoveryManager> list = connectionPool.getAll();
+        for (ConnectionRecoveryManager conn : list) {
-        inUse.put(identifier, new WeakReference(identifier));
+        inUse.put(identifier, new WeakReference<DataIdentifier>(identifier));
