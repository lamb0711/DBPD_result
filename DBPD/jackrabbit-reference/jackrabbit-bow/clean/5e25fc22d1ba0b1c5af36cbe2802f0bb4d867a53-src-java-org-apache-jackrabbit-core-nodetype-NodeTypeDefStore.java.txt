porting jackrabbit to v0.16.2 of jsr170 spec 
(work in progress...)

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@148894 13f79535-47bb-0310-9956-ffa450edef68

+    private static final String PRIMARYITEMNAME_ATTRIBUTE = "primaryItemName";
-    private static final String PRIMARYITEM_ATTRIBUTE = "primaryItem";
+        // primaryItemName
+        String primaryItemName = ntElem.getAttributeValue(PRIMARYITEMNAME_ATTRIBUTE);
+        if (primaryItemName != null && primaryItemName.length() > 0) {
+            try {
+                ntDef.setPrimaryItemName(QName.fromJCRName(primaryItemName, nsResolver));
+            } catch (BaseException e) {
+                String msg = "invalid serialized node type definition [" + sntName + "]: invalid primaryItemName: " + primaryItemName;
+                log.error(msg, e);
+                throw new InvalidNodeTypeDefException(msg, e);
+            }
+        }
+
-            // primaryItem
-            String primaryItem = elem.getAttributeValue(PRIMARYITEM_ATTRIBUTE);
-            if (primaryItem != null && primaryItem.length() > 0) {
-                pd.setPrimaryItem(Boolean.valueOf(primaryItem).booleanValue());
-            }
-            // primaryItem
-            String primaryItem = elem.getAttributeValue(PRIMARYITEM_ATTRIBUTE);
-            if (primaryItem != null && primaryItem.length() > 0) {
-                cnd.setPrimaryItem(Boolean.valueOf(primaryItem).booleanValue());
-            }
+            // primaryItemName
+            String primaryItemName = ntd.getPrimaryItemName() == null ? "" : ntd.getPrimaryItemName().toJCRName(nsResolver);
+            ntElem.setAttribute(PRIMARYITEMNAME_ATTRIBUTE, primaryItemName);
+
-                // primaryItem
-                elem.setAttribute(PRIMARYITEM_ATTRIBUTE, Boolean.toString(pd.isPrimaryItem()));
-                // primaryItem
-                elem.setAttribute(PRIMARYITEM_ATTRIBUTE, Boolean.toString(nd.isPrimaryItem()));
