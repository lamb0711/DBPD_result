JCR-1309 Refactor DBMS support for JNDI datasources

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@613914 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.persistence.bundle.util.ConnectionFactory;
+
-import java.sql.DriverManager;
+import javax.jcr.RepositoryException;
+
+ * JNDI can be used to get the connection. In this case, use the javax.naming.InitialContext as the driver,
+ * and the JNDI name as the URL. If the user and password are configured in the JNDI resource,
+ * they should not be configured here. Example JNDI settings:
+ * <pre>
+ * &lt;param name="driver" value="javax.naming.InitialContext" />
+ * &lt;param name="url" value="java:comp/env/jdbc/Test" />
+ * </pre>
-    protected Connection getConnection() throws ClassNotFoundException, SQLException {
-        Class.forName(driver);
-        return DriverManager.getConnection(url, user, password);
+    protected Connection getConnection() throws RepositoryException, SQLException {
+        return ConnectionFactory.getConnection(driver, url, user, password);
