JCR-2699: Improve read/write concurrency

Drop read synchronization from bundle PMs based on pooled databases or the filesystem.

Also remove the existsBundle() method as even the exists() methods use loadBundle() nowadays to better prime the bundle cache.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1004184 13f79535-47bb-0310-9956-ffa450edef68

-     * Checks if a bundle exists in the underlying system.
-     *
-     * @param id the node id of the bundle
-     * @return <code>true</code> if the bundle exists;
-     *         <code>false</code> otherwise.
-     * @throws ItemStateException if an error while checking occurs.
-     */
-    protected abstract boolean existsBundle(NodeId id)
-            throws ItemStateException;
-
-    /**
-     * Gets the bundle for the given node id.
+     * Gets the bundle for the given node id. Read/write synchronization
+     * happens higher up at the SISM level, so we don't need to worry about
+     * conflicts here.
-            synchronized (this) {
-                bundle = loadBundle(id);
-                if (bundle != null) {
-                    bundle.markOld();
-                    bundles.put(id, bundle, bundle.getSize());
-                } else {
-                    bundles.put(id, MISSING, 16);
-                }
+            bundle = loadBundle(id);
+            if (bundle != null) {
+                bundle.markOld();
+                bundles.put(id, bundle, bundle.getSize());
+            } else {
+                bundles.put(id, MISSING, 16);
