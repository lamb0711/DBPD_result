JCR-1104: JSR 283 support
- JQOM test cases and some first bug fixes ;)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@573164 13f79535-47bb-0310-9956-ffa450edef68

+    private static final BitSet VALID_ORDERS = new BitSet();
+
+
+        VALID_ORDERS.set(QueryObjectModelConstants.ORDER_ASCENDING);
+        VALID_ORDERS.set(QueryObjectModelConstants.ORDER_DESCENDING);
+        if (source == null) {
+            // TODO: correct exception?
+            throw new RepositoryException("source must not be null");
+        }
-        if (!(constraint instanceof ConstraintImpl)) {
+        if (constraint != null && !(constraint instanceof ConstraintImpl)) {
-        OrderingImpl[] ords = null;
+        OrderingImpl[] ords;
+        } else {
+            ords = OrderingImpl.EMPTY_ARRAY;
-        ColumnImpl[] cols = null;
+        ColumnImpl[] cols;
+        } else {
+            cols = ColumnImpl.EMPTY_ARRAY;
-        return new FullTextSearchImpl(resolver, null,
-                checkPropertyName(propertyName),
+        QName propName = null;
+        if (propertyName != null) {
+            propName = checkPropertyName(propertyName);
+        }
+        return new FullTextSearchImpl(resolver, null, propName,
+        QName propName = null;
+        if (propertyName != null) {
+            propName = checkPropertyName(propertyName);
+        }
-                checkSelectorName(selectorName),
-                checkPropertyName(propertyName),
+                checkSelectorName(selectorName), propName,
