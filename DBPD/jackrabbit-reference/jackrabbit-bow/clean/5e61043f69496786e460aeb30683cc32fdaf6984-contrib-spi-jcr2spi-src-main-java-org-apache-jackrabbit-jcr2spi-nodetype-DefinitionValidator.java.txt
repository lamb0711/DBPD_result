work in progress

- SPI: replace String/Stream for values by QValue interface
- SPI: add factory for QValue
  > adjust commons and add implementation
  > adjust usages of former QValue object with jcr2spi, spi2dav
- RepositoryService.getChildInfos returns Iterator instead of Collection
- spi2dav: add implementation for new query interfaces

- TODO: 
  improve conversion of jcr-value to q-value and vice-versa




git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@497885 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.value.QValue;
+import org.apache.jackrabbit.spi.QValue;
-import java.io.InputStream;
-import java.io.IOException;
-            QValue[] defVals = getQValues(pd);
+            QValue[] defVals = pd.getDefaultValues();
-
-    private static QValue[] getQValues(QPropertyDefinition propDef) throws RepositoryException {
-        int reqType = propDef.getRequiredType();
-        // if no default values are specified, need to return null.
-        QValue[] ivs = null;
-        if (reqType == PropertyType.BINARY) {
-            InputStream[] dfv = propDef.getDefaultValuesAsStream();
-            if (dfv != null) {
-                ivs = new QValue[dfv.length];
-                for (int i = 0; i < dfv.length; i++) {
-                    try {
-                        ivs[i] = QValue.create(dfv[i]);
-                    } catch (IOException e) {
-                        String msg = "[" + propDef.getQName() + "] error while reading binary default values.";
-                        throw new RepositoryException(msg);
-                    }
-                }
-            }
-        } else {
-            String[] dfv = propDef.getDefaultValues();
-            if (dfv != null) {
-                ivs = new QValue[dfv.length];
-                if (reqType == PropertyType.UNDEFINED) {
-                    reqType = PropertyType.STRING;
-                }
-                for (int i = 0; i < dfv.length; i++) {
-                    ivs[i] = QValue.create(dfv[i], reqType);
-                }
-            }
-        }
-        return ivs;
-    }
