JCR-3209: introduce a JCR<->DAV lock token mapper

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1233544 13f79535-47bb-0310-9956-ffa450edef68

-        String token = lock.getLockToken();
-        if (token == null && lock.isSessionScoped()
-                && lock.isLockOwningSession()) {
-            // special handling for session scoped locks that are owned by the
-            // current session but never expose their token with jsr 283.
-            try {
-                token = lock.getNode().getIdentifier();
-            } catch (RepositoryException e) {
-                // should never get here
-                log.warn("Unexpected error while retrieving node identifier for building a DAV specific lock token.",e.getMessage());
-            }
+        try {
+            return LockTokenMapper.getDavLocktoken(lock);
+        } catch (RepositoryException e) {
+            // should never get here
+            log.warn("Unexpected error while retrieving node identifier for building a DAV specific lock token.",
+                    e.getMessage());
+            return null;
-        // default behaviour: just return the token exposed by the lock.
-        return token;
