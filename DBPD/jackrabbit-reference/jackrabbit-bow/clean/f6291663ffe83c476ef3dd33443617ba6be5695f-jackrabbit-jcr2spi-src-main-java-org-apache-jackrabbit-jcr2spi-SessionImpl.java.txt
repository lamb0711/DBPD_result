JCR-2028: JSR 283 JCR Path

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@772659 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.spi.commons.conversion.IdentifierResolver;
+import org.apache.jackrabbit.spi.commons.conversion.MalformedPathException;
-        npResolver = new DefaultNamePathResolver(this, true);
+        IdentifierResolver idResolver = new IdResolver();
+        npResolver = new DefaultNamePathResolver(this, idResolver, true);
-
+
+    //--------------------------------------------------------------------------
+    /**
+     * Inner class implementing the <code>IdentifierResolver</code> interface
+     */
+    private final class IdResolver implements IdentifierResolver {
+
+        //---------------------------------------------< IdentifierResolver >---
+        /**
+         * @see IdentifierResolver#getPath(String)
+         */
+        public Path getPath(String identifier) throws MalformedPathException {
+            try {
+                NodeId id = getIdFactory().createNodeId(identifier);
+                return getHierarchyManager().getNodeEntry(id).getPath();
+            } catch (RepositoryException e) {
+                throw new MalformedPathException("Invalid identifier '" + identifier + "'.");
+            }
+        }
+
+        /**
+         * @see IdentifierResolver#checkFormat(String)
+         */
+        public void checkFormat(String identifier) throws MalformedPathException {
+            try {
+                NodeId id = getIdFactory().createNodeId(identifier);
+            } catch (Exception e) {
+                throw new MalformedPathException("Invalid identifier '" + identifier + "'.");
+            }
+        }
+    }
