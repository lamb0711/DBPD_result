JCR-1104 - JSR 283 support
- shareble nodes (work in progress)
- clone to same workspace only allowed when removeExisting==false
- remove trailing whitespace

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@642270 13f79535-47bb-0310-9956-ffa450edef68

-    
+
-     * 
+     *
-     * 
+     *
-        
+
-            // same as current workspace: is allowed for mix:shareable nodes
-            return internalClone(srcAbsPath, destAbsPath);
+            // clone to same workspace is allowed for mix:shareable nodes,
+            // but only if removeExisting is false
+            if (!removeExisting) {
+                return internalClone(srcAbsPath, destAbsPath);
+            }
+            // same as current workspace
+            String msg = srcWorkspace + ": illegal workspace (same as current)";
+            log.debug(msg);
+            throw new RepositoryException(msg);
