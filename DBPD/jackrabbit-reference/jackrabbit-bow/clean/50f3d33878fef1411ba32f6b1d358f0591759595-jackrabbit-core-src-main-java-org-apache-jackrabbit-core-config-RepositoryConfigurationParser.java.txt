JCR-3420: Improving Jackrabbit integration within OSGi and other managed environment
delegate instance creation to a bean factory 
Thanks Chetan Mehrotra for the patch

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1383976 13f79535-47bb-0310-9956-ffa450edef68

+    protected BeanFactory beanFactory = new SimpleBeanFactory();
+
+    protected BeanConfigVisitor configVisitor = new NoOpConfigVisitor();
+
+        cfg.setInstanceFactory(beanFactory);
+        configVisitor.visit(cfg);
+        cfg.setInstanceFactory(beanFactory);
+        configVisitor.visit(cfg);
-                        String className = getAttribute((Element) child, CLASS_ATTRIBUTE);
-                        BeanConfig bc = new BeanConfig(className, parseParameters((Element) child));
+                        BeanConfig bc = parseBeanConfig((Element) child);
+
+    public void setBeanFactory(BeanFactory beanFactory) {
+        this.beanFactory = beanFactory;
+    }
+
+    public void setConfigVisitor(BeanConfigVisitor configVisitor) {
+        this.configVisitor = configVisitor;
+    }
