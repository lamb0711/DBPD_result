JCR-890: concurrent read-only access to a session

Turn Session.move() into a SessionOperation

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@957589 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.core.lock.LockManager;
-import org.apache.jackrabbit.core.retention.RetentionRegistry;
-     * hierarchy manager used for generating error msg's
-     * that contain human readable paths
-     *
-     * @see #safeGetJCRPath(ItemId)
-     */
-    protected final HierarchyManager hierMgr;
-
-    /**
-     *
-     */
-    protected final LockManager lockMgr;
-
-    protected final RetentionRegistry retentionReg;
-
-    /**
-        this.hierMgr = sessionContext.getHierarchyManager();
-        this.lockMgr = sessionContext.getSessionImpl().getLockManager();
-        this.retentionReg = sessionContext.getSessionImpl().getRetentionRegistry();
-        lockMgr.checkLock(node);
+        sessionContext.getSessionImpl().getLockManager().checkLock(node);
-        return retentionReg.hasEffectiveHold(path, checkParent);
+        return sessionContext.getSessionImpl().getRetentionRegistry().hasEffectiveHold(path, checkParent);
-        return retentionReg.hasEffectiveRetention(path, checkParent);
+        return sessionContext.getSessionImpl().getRetentionRegistry().hasEffectiveRetention(path, checkParent);
-            return safeGetJCRPath(hierMgr.getPath(id));
+            return safeGetJCRPath(
+                    sessionContext.getHierarchyManager().getPath(id));
