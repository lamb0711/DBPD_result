- handle absolute paths in addnode, copy and move commands
- add setnamespaceprefix command
- lookup jcr session in httpsession in jcrcommandservlet

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@477140 13f79535-47bb-0310-9956-ffa450edef68

-import javax.jcr.Node;
+import javax.jcr.Item;
- * Rename a <code>Node<code>
+ * Rename a <code>Node<code><br>
+ * The persistent flag indicates whether to use the session or the workspace 
+ * to perform the move command
+    /** persistent key */
+    private String persistentKey = "persistent";
+
+        boolean persistent = Boolean.valueOf(
+                (String) ctx.get(this.persistentKey)).booleanValue();
+
-        Node nodeFrom = CommandHelper.getNode(ctx, from);
-        if (nodeFrom.getDepth() == 1) {
-            s.move(nodeFrom.getPath(), "/" + to);
+        Item itemFrom = CommandHelper.getItem(ctx, from);
+        if (itemFrom.getDepth() == 1) {
+            if (persistent) {
+                s.getWorkspace().move(itemFrom.getPath(), "/" + to);
+            } else {
+                s.move(itemFrom.getPath(), "/" + to);
+            }
-            s.move(nodeFrom.getPath(), nodeFrom.getParent().getPath() + "/"
-                    + to);
+            if (persistent) {
+                s.getWorkspace().move(itemFrom.getPath(),
+                        itemFrom.getParent().getPath() + "/" + to);
+            } else {
+                s.move(itemFrom.getPath(), itemFrom.getParent().getPath() + "/"
+                        + to);
+            }
-     *        the destination path key to set
+     *            the destination path key to set
-     *        the source path key to set
+     *            the source path key to set
+
+    public String getPersistentKey() {
+        return persistentKey;
+    }
+
+    public void setPersistentKey(String persistentKey) {
+        this.persistentKey = persistentKey;
+    }
