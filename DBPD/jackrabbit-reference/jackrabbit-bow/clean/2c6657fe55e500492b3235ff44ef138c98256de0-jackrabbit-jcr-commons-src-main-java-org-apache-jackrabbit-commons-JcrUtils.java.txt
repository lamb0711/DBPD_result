JCR-4015: jackrabbit-jcr-commons JcrUtils.getOrCreateByPath fails if session is not allowed to read root

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1759607 13f79535-47bb-0310-9956-ffa450edef68

+        } else if (!absolutePath.startsWith("/")) {
+            throw new IllegalArgumentException("not an absolute path: " + absolutePath);
+        } else {
+            // find deepest existing parent node
+            String path = absolutePath;
+            int currentIndex = path.lastIndexOf('/');
+            String existingPath = null;
+            while (currentIndex > 0 && existingPath == null) {
+                path = path.substring(0, currentIndex);
+                if (session.nodeExists(path)) {
+                    existingPath = path;
+                } else {
+                    currentIndex = path.lastIndexOf('/');
+                }
+            }
+            // create path relative to the root node
+            return getOrCreateByPath(existingPath == null ? session.getRootNode() : session.getNode(existingPath),
+                    absolutePath.substring(currentIndex + 1), createUniqueLeaf, intermediateNodeType, nodeType, autoSave);
-        // create path relative to the root node
-        return getOrCreateByPath(session.getRootNode(), absolutePath.substring(1),
-                createUniqueLeaf, intermediateNodeType, nodeType, autoSave);
