JCR-1104: JSR 283 support (work in progress...)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@572978 13f79535-47bb-0310-9956-ffa450edef68

+     * Package-private low-level helper method returning all
+     * <code>AbstractLockInfo</code>s associated with the specified
+     * session.
+     * @param session session
+     * @return an array of <code>AbstractLockInfo</code>s
+     */
+    AbstractLockInfo[] getLockInfos(final SessionImpl session) {
+        final ArrayList infos = new ArrayList();
+        lockMap.traverse(new PathMap.ElementVisitor() {
+            public void elementVisited(PathMap.Element element) {
+                LockInfo info = (LockInfo) element.get();
+                if (info.isLive() && info.getLockHolder().equals(session)) {
+                    infos.add(info);
+                }
+            }
+        }, false);
+        return (AbstractLockInfo[]) infos.toArray(new AbstractLockInfo[infos.size()]);
+    }
+
+    /**
+     */
+    public Lock[] getLocks(SessionImpl session) throws RepositoryException {
+
+        acquire();
+
+        AbstractLockInfo infos[] = getLockInfos(session);
+
+        try {
+            Lock[] locks = new Lock[infos.length];
+            for (int i = 0; i < infos.length; i++) {
+                AbstractLockInfo info = infos[i];
+                Node holder = (Node) session.getItemManager().getItem(info.getId());
+                locks[i] = new LockImpl(info, holder);
+            }
+            return locks;
+        } finally {
+            release();
+        }
+    }
+
+    /**
+     * {@inheritDoc}
