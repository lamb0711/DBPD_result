- resolving TODOs (retrieve group by ID)
- improved NodeResolver (replacing SessionImpl by Session/NamePathResolver pair)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@641898 13f79535-47bb-0310-9956-ffa450edef68

-            session.getWorkspace().getQueryManager();
-            nr = new IndexNodeResolver(session);
+            nr = new IndexNodeResolver(session, session);
-            nr = new TraversingNodeResolver(session);
+            nr = new TraversingNodeResolver(session, session);
-            // TODO: TOBEFIXED. should rather search for node with escaped(id) == Node.getName
-            String principalName = getGroupPrincipalName(id);
-            n = (NodeImpl) authResolver.findNode(P_PRINCIPAL_NAME, principalName, NT_REP_GROUP);
+            Name nodeName = session.getQName(id);
+            n = (NodeImpl) authResolver.findNode(nodeName, NT_REP_GROUP);
-            // TODO: replace separator by "_" (see above)
-            groupID = escHint + "_GR_" + i;
+            groupID = escHint + "_" + i;
-    /**
-     * TODO: Remove method as soon as searching group-by-id is fixed (see above).
-     */
-    private static String getGroupPrincipalName(String groupId) {
-        int pos = groupId.lastIndexOf("_GR_");
-        String pName = (pos > -1) ? groupId.substring(0, pos) : groupId;
-        return Text.unescapeIllegalJcrChars(pName);
-    }
-
