JCR-2076: JSR 283: Joins
- orderings (work in progress)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@783337 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.spi.NameFactory;
+import org.apache.jackrabbit.spi.commons.name.NameFactoryImpl;
+import org.apache.jackrabbit.spi.commons.conversion.IllegalNameException;
+     * The index internal namespace mappings.
+     */
+    private final NamespaceMappings nsMappings;
+
+    public LengthSortComparator(NamespaceMappings nsMappings) {
+        this.nsMappings = nsMappings;
+    }
+
+    /**
-        return new Comparator(reader, fieldname);
+        NameFactory factory = NameFactoryImpl.getInstance();
+        try {
+            return new Comparator(reader,
+                    nsMappings.translateName(factory.create(fieldname)));
+        } catch (IllegalNameException e) {
+            throw Util.createIOException(e);
+        }
-            String namedLength = FieldNames.createNamedLength(propertyName, 0);
+            String namedLength = FieldNames.createNamedValue(propertyName, "");
