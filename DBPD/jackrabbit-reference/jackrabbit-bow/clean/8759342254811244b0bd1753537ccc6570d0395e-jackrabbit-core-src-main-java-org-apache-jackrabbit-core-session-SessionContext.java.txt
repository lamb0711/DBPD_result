JCR-890: concurrent read-only access to a session

Move ValueFactory into SessionContext.


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@985269 13f79535-47bb-0310-9956-ffa450edef68

+import javax.jcr.ValueFactory;
+import org.apache.jackrabbit.core.value.ValueFactoryImpl;
+     * The value factory of this session
+     */
+    private final ValueFactory valueFactory;
+
+    /**
-        this.nodeTypeManager = new NodeTypeManagerImpl(
-                repositoryContext.getNodeTypeRegistry(), session,
-                repositoryContext.getDataStore());
+        this.valueFactory =
+            new ValueFactoryImpl(session, repositoryContext.getDataStore());
+        this.nodeTypeManager = new NodeTypeManagerImpl(this);
+     * Returns the value factory of this session.
+     *
+     * @return value factory
+     */
+    public ValueFactory getValueFactory() {
+        return valueFactory;
+    }
+
+    /**
