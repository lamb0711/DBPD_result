JCR-996 Name and Path interfaces in SPI
JCR-1169 Distribution of commons classes


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@586065 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.name.Path;
+import org.apache.jackrabbit.name.PathFactoryImpl;
+import org.apache.jackrabbit.name.PathBuilder;
-import org.apache.jackrabbit.name.QName;
-import org.apache.jackrabbit.name.MalformedPathException;
-import org.apache.jackrabbit.name.NamespaceResolver;
-import org.apache.jackrabbit.name.NameFormat;
-import org.apache.jackrabbit.name.NameException;
+import org.apache.jackrabbit.spi.Name;
+import org.apache.jackrabbit.spi.PathFactory;
+import org.apache.jackrabbit.conversion.NamePathResolver;
+import org.apache.jackrabbit.conversion.NameException;
+    protected PathFactory getPathFactory() {
+        return PathFactoryImpl.getInstance();
+    }
-     * @param nsResolver the namespace resolver in use.
+     * @param resolver
-    public NodeId createNodeId(Node node, NamespaceResolver nsResolver)
+    public NodeId createNodeId(Node node, NamePathResolver resolver)
-        Path.PathBuilder builder = new Path.PathBuilder();
+        PathBuilder builder = new PathBuilder();
-                    builder.addFirst(QName.ROOT);
+                    builder.addRoot();
-                    QName name;
+                    Name name;
-                        name = NameFormat.parse(node.getName(), nsResolver);
+                        name = resolver.getQName(node.getName());
-            try {
-                return createNodeId(uniqueId, builder.getPath());
-            } catch (MalformedPathException e) {
-                throw new RepositoryException(e.getMessage(), e);
-            }
+            return createNodeId(uniqueId, builder.getPath());
-     * @param nsResolver the namespace resolver in use.
+     * @param resolver
-                                       NamespaceResolver nsResolver)
+                                       NamePathResolver resolver)
-        NodeId nodeId = createNodeId(parent, nsResolver);
+        NodeId nodeId = createNodeId(parent, resolver);
-        QName name;
+        Name name;
-            name = NameFormat.parse(jcrName, nsResolver);
+            name = resolver.getQName(jcrName);
