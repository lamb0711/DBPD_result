JCR-2635 : Disable Users

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@984395 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.PropertyImpl;
+    /**
+     * @see User#disable(String)
+     */
+    public void disable(String reason) throws RepositoryException {
+        if (isAdmin()) {
+            throw new RepositoryException("The administrator user cannot be disabled.");
+        }
+        if (reason == null) {
+            if (isDisabled()) {
+                // enable the user again.
+                PropertyImpl disableProp = getNode().getProperty(P_DISABLED);
+                userManager.removeProtectedItem(disableProp, getNode());
+            } // else: nothing to do.
+        } else {
+            Value v = getSession().getValueFactory().createValue(reason);
+            userManager.setProtectedProperty(getNode(), P_DISABLED, v);
+        }
+    }
+
+    /**
+     * @see User#isDisabled()
+     */
+    public boolean isDisabled() throws RepositoryException {
+        return getNode().hasProperty(P_DISABLED);
+    }
+
+    /**
+     * @see User#getDisabledReason()
+     */
+    public String getDisabledReason() throws RepositoryException {
+        if (isDisabled()) {
+            return getNode().getProperty(P_DISABLED).getString();
+        } else {
+            return null;
+        }
+    }
+
