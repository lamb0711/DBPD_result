JCR-2238: Binary throws NullPointerException

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@802676 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.value.BinaryImpl;
-                return new BinaryValueImpl(((InternalValue) qvalue).getBLOBFileValue());
+                return new BinaryValueImpl(((InternalValue) qvalue).getBLOBFileValue().copy());
+    public Binary createBinary(InputStream stream) throws RepositoryException {
+        try {
+            QValue value = getQValueFactory().create(stream);
+            if (value instanceof InternalValue) {
+                return ((InternalValue) value).getBLOBFileValue();
+            } else {
+                return new BinaryImpl(stream);
+            }
+        } catch (IOException e) {
+            throw new RepositoryException(e);
+        }
+    }
+
+            } else if (binary instanceof BLOBFileValue) {
+                return new BinaryValueImpl(((BLOBFileValue) binary).copy());
