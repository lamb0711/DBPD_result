JCR-1296: Exception may get lost in WorkspaceManager.OperationVisitorImpl.execute()

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@609938 13f79535-47bb-0310-9956-ffa450edef68

+            RepositoryException ex = null;
+            } catch (RepositoryException e) {
+                ex = e;
-                    service.submit(batch);
+                    try {
+                        // submit must be called even in case there is an
+                        // exception to give the service a chance to clean
+                        // up the batch
+                        service.submit(batch);
+                    } catch (RepositoryException e) {
+                        if (ex == null) {
+                            ex = e;
+                        } else {
+                            log.warn("Exception submitting batch", e);
+                        }
+                    }
+            if (ex != null) {
+                throw ex;
+            }
