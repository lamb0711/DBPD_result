- sync (effective node type cache)
- loading of node types that have a reference to each other failed.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@518926 13f79535-47bb-0310-9956-ffa450edef68

-        Map validDefs = new HashMap(validatedDefs);
+        Map tmpMap = new HashMap(validatedDefs);
+        for (Iterator it = ntDefs.iterator(); it.hasNext();) {
+            QNodeTypeDefinition ntd = (QNodeTypeDefinition) it.next();
+            tmpMap.put(ntd.getQName(), ntd);
+        }
+
-                if (validDefs.keySet().containsAll(ntd.getDependencies())) {
-                    EffectiveNodeType ent = validateNodeTypeDef(ntd, validDefs);
-                    // keep track of validated definitions and eff. nodetypes
-                    if (!validDefs.containsKey(ntd.getQName())) {
-                        validDefs.put(ntd.getQName(), ntd);
-                    }
+                Collection dependencies = ntd.getDependencies();
+                if (tmpMap.keySet().containsAll(dependencies)) {
+                    EffectiveNodeType ent = validateNodeTypeDef(ntd, tmpMap);
