JCR-3093 : Inconsistency between Session.getProperty and Node.getProperty for binary values

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1182419 13f79535-47bb-0310-9956-ffa450edef68

-                if (JCR_LENGTH.equals(name) && !isMultiple()) {
-                    long length = p.getLength();
-                    prop = new DefaultDavProperty<String>(JCR_LENGTH, String.valueOf(length), true);
-                } else if (JCR_LENGTHS.equals(name) && isMultiple()) {
-                    prop = new LengthsProperty(p.getLengths());
+                if (isMultiple()) {
+                    if (JCR_LENGTHS.equals(name)) {
+                        prop = new LengthsProperty(p.getLengths());
+                    }
+                } else {
+                    if (JCR_LENGTH.equals(name)) {
+                        long length = p.getLength();
+                        prop = new DefaultDavProperty<String>(JCR_LENGTH, String.valueOf(length), true);
+                    } else if (JCR_GET_STRING.equals(name) && p.getType() != PropertyType.BINARY) {
+                        // getstring property is only created for single value
+                        // non-binary jcr properties
+                        prop = new DefaultDavProperty<String>(JCR_GET_STRING, p.getString(), true);
+                    }
