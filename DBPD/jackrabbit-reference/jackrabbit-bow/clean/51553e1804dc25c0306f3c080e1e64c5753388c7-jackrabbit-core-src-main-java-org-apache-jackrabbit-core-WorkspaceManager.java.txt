JCR-2746: Sleep in possibly endless loop in ObservationDispatcher

Move the sleep to the end of SessionState.perform() after all the relevant locks have been released

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1000950 13f79535-47bb-0310-9956-ffa450edef68

-import javax.jcr.AccessDeniedException;
+import org.apache.jackrabbit.core.observation.ObservationDispatcher;
+    // FIXME: This is a too low-level method. Refactor...
+    public ObservationDispatcher getObservationDispatcher(String workspaceName)
+            throws NoSuchWorkspaceException, RepositoryException {
+        return repository.getObservationDispatcher(workspaceName);
+    }
+
