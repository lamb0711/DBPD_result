JCR-2085: move security tests to jackrabbit-jcr-tests; extend RepositoryStub so that it can provide instances of Principal.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@772171 13f79535-47bb-0310-9956-ffa450edef68

+import java.security.Principal;
+import java.security.acl.Group;
+import org.apache.jackrabbit.test.NotExecutableException;
+    @Override
+    public Principal getKnownPrincipal(Session session) throws RepositoryException {
+        
+        Principal knownPrincipal = null;
+        
+        if (session instanceof SessionImpl) {
+            for (Principal p : ((SessionImpl)session).getSubject().getPrincipals()) {
+                if (! (p instanceof Group)) {
+                    knownPrincipal = p;
+                }
+            }
+        }
+        
+        if (knownPrincipal != null) {
+            return knownPrincipal;
+        }
+        else {
+            throw new RepositoryException("no applicable principal found");
+        }
+    }
+
+    private static Principal UNKNOWN_PRINCIPAL = new Principal() {
+        public String getName() {
+            return "an_unknown_user";
+        }
+    };
+    
+    @Override
+    public Principal getUnknownPrincipal(Session session) throws RepositoryException, NotExecutableException {
+        return UNKNOWN_PRINCIPAL;
+    }
+
