JCR-1589: JSR 283 Retention & Hold Management

- replace public constructor by static create
- replace spi-commons dependency from create method by usage of Session

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@752115 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.spi.commons.conversion.DefaultNamePathResolver;
+import javax.jcr.Session;
-    
-    public RetentionPolicyImpl(String jcrName, NameResolver resolver) throws IllegalNameException, NamespaceException {
-        this(resolver.getQName(jcrName), null, resolver);
+
+    /**
+     * Creates a new <code>RetentionPolicy</code> that can be applied to a
+     * <code>Node</code> using {@link org.apache.jackrabbit.api.jsr283.retention.RetentionManager#setRetentionPolicy(String, org.apache.jackrabbit.api.jsr283.retention.RetentionPolicy)}.
+     *
+     * @param jcrName The name of the policy. It must be a valid JCR name.
+     * @param session The editing <code>Session</code> from which the retention
+     * manager will be obtained.
+     * @return a new <code>RetentionPolicy</code>
+     * @throws RepositoryException If the jcr name isn't valid or if same other
+     * error occurs.
+     */
+    public static RetentionPolicy createRetentionPolicy(String jcrName, Session session) throws RepositoryException {
+        NameResolver resolver;
+        if (session instanceof NameResolver) {
+            resolver = (NameResolver) session;
+        } else {
+            resolver = new DefaultNamePathResolver(session);
+        }
+        return new RetentionPolicyImpl(jcrName, null, resolver);
-    
+
