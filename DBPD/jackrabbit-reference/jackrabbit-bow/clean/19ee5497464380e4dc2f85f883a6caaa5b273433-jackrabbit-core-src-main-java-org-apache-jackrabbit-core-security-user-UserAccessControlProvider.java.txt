JCR-2887 : Split PrivilegeRegistry in a per-session manager instance and a repository level registry [work in progress]

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1082239 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.Collections;
+import java.util.HashSet;
-    private int getPrivilegeBits(String privName) throws RepositoryException {
-        PrivilegeManagerImpl impl = (PrivilegeManagerImpl) ((JackrabbitWorkspace) session.getWorkspace()).getPrivilegeManager();
-        return impl.getBits(new String[] {privName});
-    }
-
+        private int getPrivilegeBits(String privName) throws RepositoryException {
+            PrivilegeManagerImpl impl = getPrivilegeManagerImpl();
+            return impl.getBits(new Privilege[] {impl.getPrivilege(privName)});
+        }
+
+        @Override
+        protected PrivilegeManagerImpl getPrivilegeManagerImpl() throws RepositoryException {
+            return (PrivilegeManagerImpl) ((JackrabbitWorkspace) session.getWorkspace()).getPrivilegeManager();
+        }
+
