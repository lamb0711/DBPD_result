JCR-3206 JSR-283 support for RMI / Implementation of the missing versioning parts

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1377571 13f79535-47bb-0310-9956-ffa450edef68

-import javax.jcr.RepositoryException;
-import org.apache.jackrabbit.rmi.server.security.ServerAccessControlPolicyIterator;
+import org.apache.jackrabbit.rmi.server.security.ServerAccessControlPolicyIterator;
-            List eventList = new ArrayList();
-            while (events.hasNext()) {
-                try {
-                    Event event = events.nextEvent();
-                    eventList.add(new ServerEventCollection.ServerEvent(
-                        event.getType(), event.getPath(), event.getUserID(),
-                        this));
-                } catch (RepositoryException re) {
-                    throw new RemoteException(re.getMessage(), re);
-                }
-            }
-            remoteEvents = (RemoteEventCollection.RemoteEvent[]) eventList.toArray(new RemoteEventCollection.RemoteEvent[eventList.size()]);
+			List<ServerEventCollection.ServerEvent> eventList = new ArrayList<ServerEventCollection.ServerEvent>();
+			while (events.hasNext()) {
+				Event event = events.nextEvent();
+				eventList
+						.add(new ServerEventCollection.ServerEvent(event, this));
+			}
+            remoteEvents = eventList.toArray(new RemoteEventCollection.RemoteEvent[eventList.size()]);
-    public RemoteVersionManager getRemoteVersionManager(
+    public RemoteVersionManager getRemoteVersionManager(Session session,
-        return new ServerVersionManager(versionManager, this);
+        return new ServerVersionManager(session, versionManager, this);
