JCR-619: CacheManager (Memory Management in Jackrabbit)

applied patch that fixes dead lock issue

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@475735 13f79535-47bb-0310-9956-ffa450edef68

-        log.info("resizeAll size="+ caches.size());
+        log.info("resizeAll size=" + caches.size());
-        for (Iterator it = caches.keySet().iterator(); it.hasNext();) {
-            list.add(it.next());
+        synchronized (caches) {
+            for (Iterator it = caches.keySet().iterator(); it.hasNext();) {
+                list.add(it.next());
+            }
-    public synchronized void add(Cache cache) {
-        caches.put(cache, null);
+    public void add(Cache cache) {
+        synchronized (caches) {
+            caches.put(cache, null);
+        }
-    public synchronized void remove(Cache cache) {
-        caches.remove(cache);
+    public void remove(Cache cache) {
+        synchronized (caches) {
+            caches.remove(cache);
+        }
