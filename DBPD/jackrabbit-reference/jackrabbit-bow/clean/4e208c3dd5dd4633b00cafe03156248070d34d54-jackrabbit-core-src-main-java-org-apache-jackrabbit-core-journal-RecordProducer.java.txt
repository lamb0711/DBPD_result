JCR-749 Add mysql ddl for clustering (DatabaseJournal)
JCR-756 Concurrent add/remove child node operations in a cluster may corrupt repository
JCR-757 Allow multiple producers to feed/consume journal


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@509624 13f79535-47bb-0310-9956-ffa450edef68

-package org.apache.jackrabbit.core.cluster;
+package org.apache.jackrabbit.core.journal;
- * Contains definitions common to both <code>RecordInput</code> and
- * <code>RecordOutput</code>.
+ * Produces new records that can be appended to the journal.
-interface Record {
+public interface RecordProducer {
-     * Indicator for a literal UUID.
+     * Append a record. This operation implicitely locks the journal revision
+     * and must be followed by either {@link Record#update} or {@link Record#cancelUpdate}.
+     * on the record returned.
+     *
+     * @return appended record
+     * @throws JournalException if an error occurs
-    public static final byte UUID_LITERAL = 'L';
-
-    /**
-     * Indicator for a UUID index.
-     */
-    public static final byte UUID_INDEX = 'I';
-}
+    public Record append() throws JournalException;
+}
