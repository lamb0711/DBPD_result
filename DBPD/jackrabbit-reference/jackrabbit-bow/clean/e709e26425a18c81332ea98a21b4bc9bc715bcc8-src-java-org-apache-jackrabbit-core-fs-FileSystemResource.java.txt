Jira issue JCR-14: {XML|Object}PersistenceManager.destroy(*) may fail 

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@55854 13f79535-47bb-0310-9956-ffa450edef68

+     * Deletes this resource.
+     * Same as <code>{@link #delete(false)}</code>.
+     *
+     * Deletes this resource.
+     *
+     * @param pruneEmptyParentDirs if <code>true</code>, empty parent folders will
+     *                             automatically be deleted
+     * @see FileSystem#deleteFile
+     */
+    public void delete(boolean pruneEmptyParentDirs) throws FileSystemException {
+        fs.deleteFile(path);
+        if (pruneEmptyParentDirs) {
+            // prune empty parent folders
+            String parentDir = FileSystemPathUtil.getParentDir(path);
+            while (!parentDir.equals(FileSystem.SEPARATOR)
+                    && fs.exists(parentDir)
+                    && !fs.hasChildren(parentDir)) {
+                fs.deleteFolder(parentDir);
+                parentDir = FileSystemPathUtil.getParentDir(parentDir);
+            }
+        }
+    }
+
+    /**
