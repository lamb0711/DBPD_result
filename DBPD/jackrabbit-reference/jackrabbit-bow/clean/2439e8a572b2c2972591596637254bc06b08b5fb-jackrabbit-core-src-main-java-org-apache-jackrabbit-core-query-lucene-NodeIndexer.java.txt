JCR-677: Do not fulltext index jcr:uuid property

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@487585 13f79535-47bb-0310-9956-ffa450edef68

-                addStringValue(doc, fieldName, internalValue);
+                // do not fulltext index jcr:uuid String
+                boolean tokenize = !name.equals(QName.JCR_UUID);
+                addStringValue(doc, fieldName, internalValue, tokenize);
+     * @deprecated Use {@link #addStringValue(Document, String, Object, boolean)
+     *             addStringValue(Document, String, Object, boolean)} instead.
+        addStringValue(doc, fieldName, internalValue, true);
+    }
+
+    /**
+     * Adds the string value to the document both as the named field and
+     * optionally for full text indexing if <code>tokenized</code> is
+     * <code>true</code>.
+     *
+     * @param doc           The document to which to add the field
+     * @param fieldName     The name of the field to add
+     * @param internalValue The value for the field to add to the document.
+     * @param tokenized     If <code>true</code> the string is also tokenized
+     *                      and fulltext indexed.
+     */
+    protected void addStringValue(Document doc, String fieldName, Object internalValue, boolean tokenized) {
-        // also create fulltext index of this value
-        doc.add(new Field(FieldNames.FULLTEXT,
-                stringValue,
-                Field.Store.NO,
-                Field.Index.TOKENIZED,
-                Field.TermVector.NO));
-        // create fulltext index on property
-        int idx = fieldName.indexOf(':');
-        fieldName = fieldName.substring(0, idx + 1)
-                + FieldNames.FULLTEXT_PREFIX + fieldName.substring(idx + 1);
-        doc.add(new Field(fieldName, stringValue,
-                Field.Store.NO,
-                Field.Index.TOKENIZED,
-                Field.TermVector.NO));
+        if (tokenized) {
+            // also create fulltext index of this value
+            doc.add(new Field(FieldNames.FULLTEXT,
+                    stringValue,
+                    Field.Store.NO,
+                    Field.Index.TOKENIZED,
+                    Field.TermVector.NO));
+            // create fulltext index on property
+            int idx = fieldName.indexOf(':');
+            fieldName = fieldName.substring(0, idx + 1)
+                    + FieldNames.FULLTEXT_PREFIX + fieldName.substring(idx + 1);
+            doc.add(new Field(fieldName, stringValue,
+                    Field.Store.NO,
+                    Field.Index.TOKENIZED,
+                    Field.TermVector.NO));
+        }
