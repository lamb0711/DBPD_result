JCR-617 CachingHieraarchyManager may serve moved items


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@470745 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.core.ZombieHierarchyManager;
+import org.apache.jackrabbit.core.ZombieHierarchyManager;
+import java.io.PrintStream;
+import java.util.ArrayList;
+import java.util.Collection;
+import java.util.Collections;
+import java.util.Iterator;
+import java.util.List;
+
-import java.io.PrintStream;
-import java.util.ArrayList;
-import java.util.Collections;
-import java.util.Iterator;
-import java.util.List;
-import java.util.Collection;
-     * @param rootNodeId
-     * @param stateMgr
-     * @param nsResolver
+     * @param rootNodeId the root node id
+     * @param stateMgr the local item state manager
+     * @param nsResolver the namespace resolver
+    public void nodeModified(NodeState state) {
+        if (state.getContainer() == this || !transientStore.contains(state.getId())) {
+            dispatcher.notifyNodeModified(state);
+        }
+    }
+
+    /**
+     * {@inheritDoc}
+     * <p/>
+     * Pass notification to listeners if a transient state was modified
+     * or if the local state is not overlayed.
+     */
