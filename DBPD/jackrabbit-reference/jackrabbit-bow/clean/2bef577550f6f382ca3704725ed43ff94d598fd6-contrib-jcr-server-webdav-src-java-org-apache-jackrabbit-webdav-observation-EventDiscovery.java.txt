JCR-258 - remove JDOM dependency from jcr-server contribution
JCR-295 - usage of Cache-Control header 
JCR-297 - log output while parsing xml
minor consistency issues and improvements

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@368683 13f79535-47bb-0310-9956-ffa450edef68

-import org.jdom.Element;
+import org.apache.jackrabbit.webdav.xml.XmlSerializable;
+import org.apache.jackrabbit.webdav.xml.DomUtil;
+import org.w3c.dom.Element;
+import org.w3c.dom.Document;
+import java.util.Iterator;
-public class EventDiscovery implements ObservationConstants {
+public class EventDiscovery implements ObservationConstants, XmlSerializable {
-    public void addEventBundle(Element eventBundle) {
+    public void addEventBundle(EventBundle eventBundle) {
+     * @see org.apache.jackrabbit.webdav.xml.XmlSerializable#toXml(Document)
+     * @param document
-    public Element toXml() {
-        Element ed = new Element(XML_EVENTDISCOVERY, NAMESPACE);
-        ed.addContent(bundles);
+    public Element toXml(Document document) {
+        Element ed = DomUtil.createElement(document, XML_EVENTDISCOVERY, NAMESPACE);
+        Iterator it = bundles.iterator();
+        while (it.hasNext()) {
+            EventBundle bundle = (EventBundle)it.next();
+            ed.appendChild(bundle.toXml(document));
+        }
+
