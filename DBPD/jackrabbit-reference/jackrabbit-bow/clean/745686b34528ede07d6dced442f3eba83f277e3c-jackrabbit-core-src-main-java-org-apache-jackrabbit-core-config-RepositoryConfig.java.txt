JCR-2870: Transient Repository cannot be used more than once when configured with DataSources

Patch by Chris Schmidt.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1065622 13f79535-47bb-0310-9956-ffa450edef68

+     * Creates a repository configuration object based on an existing configuration. The factories
+     * contained within the configuration will be newly initialized, but all other information
+     * will be the same.
+     *
+     * @param config repository configuration to create the new instance from
+     * @return repository configuration
+     * @throws ConfigurationException on configuration errors
+     */
+    public static RepositoryConfig create(RepositoryConfig config) throws ConfigurationException
+    {
+        RepositoryConfig copiedConfig = new RepositoryConfig(config.home, config.sec, config.fsf,
+                config.workspaceDirectory, config.workspaceConfigDirectory, config.defaultWorkspace,
+                config.workspaceMaxIdleTime, config.template, config.vc, config.qhf, config.cc,
+                config.dsf, config.rlf, config.dsc, new ConnectionFactory(), config.parser);
+        copiedConfig.init();
+        return copiedConfig;
+    }
+
+    /**
