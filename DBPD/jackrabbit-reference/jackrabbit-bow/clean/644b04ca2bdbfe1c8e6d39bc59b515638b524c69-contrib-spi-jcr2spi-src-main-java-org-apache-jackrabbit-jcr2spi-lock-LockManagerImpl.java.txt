work in progress

- RepositoryService.lock -> add return value
- Merge-Operation, VersionManager: merge returns failed-Ids
- LockManager: lock returns lockInfo
- javadoc, todos

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@478581 13f79535-47bb-0310-9956-ffa450edef68

-        Operation op = LockOperation.create(wspNodeState, isDeep, isSessionScoped);
+        LockOperation op = LockOperation.create(wspNodeState, isDeep, isSessionScoped);
-        Lock lock = new LockImpl(new LockState(wspNodeState), lhNode);
+        Lock lock = new LockImpl(new LockState(wspNodeState, op.getLockInfo()), lhNode);
-        private LockState(NodeState lockHoldingState) throws LockException, RepositoryException {
+        private LockState(NodeState lockHoldingState, LockInfo lockInfo)
+            throws LockException, RepositoryException{
-            // retrieve lock info from wsp-manager, in order to get the complete
-            // lockInfo including lock-token, which is not available from the
-            // child properties nor from the original lock request.
-            this.lockInfo = wspManager.getLockInfo(lockHoldingState.getNodeId());
+            if (lockInfo == null) {
+                // retrieve lock info from wsp-manager, in order to get the complete
+                // lockInfo including lock-token, which is not available from the
+                // child properties nor from the original lock request.
+                this.lockInfo = wspManager.getLockInfo(lockHoldingState.getNodeId());
+            } else {
+                this.lockInfo = lockInfo;
+            }
+        private LockState(NodeState lockHoldingState) throws LockException, RepositoryException {
+            this(lockHoldingState, null);
+        }
+
