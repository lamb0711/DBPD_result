JCR-2140 Configurations and Baselines


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@796586 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.Set;
-    public InternalConfiguration createConfiguration(Session session,
-                                                     NodeId rootId,
-                                                     InternalBaseline baseline)
+    public NodeId createConfiguration(Session session, NodeId rootId)
-            NodeStateEx state = internalCreateConfiguration(rootId, baseline);
+            NodeStateEx state = internalCreateConfiguration(rootId);
-            return config;
+            return config.getId();
-            return vMgr.createConfiguration(session, rootId, baseline);
+            return vMgr.createConfiguration(session, rootId);
+        }
+    }
+
+    /**
+     * {@inheritDoc}
+     */
+    public InternalBaseline checkin(Session session,
+                                    InternalConfiguration config,
+                                    Set<NodeId> baseVersions)
+            throws RepositoryException {
+        if (isInXA()) {
+            InternalBaseline version = internalCheckin((InternalConfigurationImpl) config, baseVersions);
+            xaItems.put(version.getId(), version);
+            return version;
+        } else {
+            return vMgr.checkin(session, config, baseVersions);
