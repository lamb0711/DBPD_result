JCR-2085: test case (TCK) maintenance for JCR 2.0
- length tests for DECIMAL, URI and WEAKREFERENCE

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@784117 13f79535-47bb-0310-9956-ffa450edef68

-import javax.jcr.ValueFactory;
+import javax.jcr.PropertyType;
+import javax.jcr.RepositoryException;
+import org.apache.jackrabbit.core.value.ValueFactoryImpl;
+import org.apache.jackrabbit.spi.QValueFactory;
-            ValueFactory vf = context.getSession().getValueFactory();
+            ValueFactoryImpl vf = (ValueFactoryImpl) context.getSession().getValueFactory();
+            QValueFactory qvf = vf.getQValueFactory();
-                lengths[i] = vf.createValue(Util.getLength(values[i]));
+                long len;
+                int type = values[i].getType();
+                try {
+                    if (type == PropertyType.NAME) {
+                        len = vf.createValue(qvf.create(values[i].getName())).getString().length();
+                    } else if (type == PropertyType.PATH) {
+                        len = vf.createValue(qvf.create(values[i].getPath())).getString().length();
+                    } else {
+                        len = Util.getLength(values[i]);
+                    }
+                } catch (RepositoryException e) {
+                    throw Util.createIOException(e);
+                }
+                lengths[i] = vf.createValue(len);
