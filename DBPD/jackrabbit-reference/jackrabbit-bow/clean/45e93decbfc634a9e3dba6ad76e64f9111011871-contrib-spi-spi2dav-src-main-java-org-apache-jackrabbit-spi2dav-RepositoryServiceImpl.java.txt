ImportXML: uuidbehavior not transported

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@522969 13f79535-47bb-0310-9956-ffa450edef68

+
+        DavMethod method = null;
+
-                    DavMethod method = (DavMethod) it.next();
+                    method = (DavMethod) it.next();
-            throw ExceptionConverter.generate(e);
+            throw ExceptionConverter.generate(e, method);
+        method.addRequestHeader(ItemResourceConstants.IMPORT_UUID_BEHAVIOR, Integer.valueOf(uuidBehaviour).toString());
-            // TODO: ev. evaluate response ??? change return type of RepositoryService.resolveMergeConflict()?
+            String uri = getItemUri(targetId, sessionInfo);
-                String uri = getItemUri(targetId, sessionInfo);
+                if (method.getStatusCode() == DavServletResponse.SC_PRECONDITION_FAILED) {
+                    throw new InvalidItemStateException("Unable to persist transient changes.");
+                }
-
