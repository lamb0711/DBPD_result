JCR-2087 Upgrade to Java 5 as the base platform
minor improvement



git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@788012 13f79535-47bb-0310-9956-ffa450edef68

-    private final Map acProviders = new HashMap();
+    private final Map<String, AccessControlProvider> acProviders = new HashMap();
-        for (int i = 0; i < moduleConfig.length; i++) {
-            if (moduleConfig[i].containsKey(LoginModuleConfig.PARAM_ADMIN_ID)) {
-                adminId = moduleConfig[i].getProperty(LoginModuleConfig.PARAM_ADMIN_ID);
+        for (Properties props : moduleConfig) {
+            if (props.containsKey(LoginModuleConfig.PARAM_ADMIN_ID)) {
+                adminId = props.getProperty(LoginModuleConfig.PARAM_ADMIN_ID);
-            if (moduleConfig[i].containsKey(LoginModuleConfig.PARAM_ANONYMOUS_ID)) {
-                anonymousId = moduleConfig[i].getProperty(LoginModuleConfig.PARAM_ANONYMOUS_ID);
+            if (props.containsKey(LoginModuleConfig.PARAM_ANONYMOUS_ID)) {
+                anonymousId = props.getProperty(LoginModuleConfig.PARAM_ANONYMOUS_ID);
-        for (int i = 0; i < moduleConfig.length; i++) {
-            principalProviderRegistry.registerProvider(moduleConfig[i]);
+        for (Properties props : moduleConfig) {
+            principalProviderRegistry.registerProvider(props);
-            AccessControlProvider prov = (AccessControlProvider) acProviders.remove(workspaceName);
+            AccessControlProvider prov = acProviders.remove(workspaceName);
-            Iterator itr = acProviders.values().iterator();
+            Iterator<AccessControlProvider> itr = acProviders.values().iterator();
-                ((AccessControlProvider) itr.next()).close();
+                itr.next().close();
-            String msg = "Failed to instantiate AccessManager (" + amConfig.getClassName() + ")";
+            String clsName = (amConfig == null) ? "-- missing access manager configuration --" : amConfig.getClassName();
+            String msg = "Failed to instantiate AccessManager (" + clsName + ")";
-            AccessControlProvider provider = (AccessControlProvider) acProviders.get(workspaceName);
+            AccessControlProvider provider = acProviders.get(workspaceName);
