JCR-926: configuration for data store in repository.xml

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@573209 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.config.DataStoreConfig;
-import org.apache.jackrabbit.core.data.FileDataStore;
+import org.apache.jackrabbit.core.value.InternalValue;
-        dataStore =
-            new FileDataStore(new File(repConfig.getHomeDir(), "datastore"));        
+        
+        if (repConfig.getDataStoreConfig() != null) {
+            assert InternalValue.USE_DATA_STORE;
+            dataStore = createDataStore();
+        } else {
+            dataStore = null;            
+        }
+    
+    /**
+     * Create a data store object using the data store configuration.
+     *
+     * @return the data store object
+     */
+    protected DataStore createDataStore() throws RepositoryException {
+        DataStoreConfig dsc = repConfig.getDataStoreConfig();
+        DataStore dataStore = (DataStore) dsc.newInstance();
+        dataStore.init(repConfig.getHomeDir());
+        return dataStore;
+    }
