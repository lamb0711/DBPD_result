work in progress

- add 'isSessionScoped' to LockInfo and RepositoryService.lock
- add index to NodeInfo
- evaluate EventIds upon call to getId, getParentId
- convert Method-Not-Allowed to ConstraintViolation

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@467911 13f79535-47bb-0310-9956-ffa450edef68

-     * @see RepositoryService#lock(SessionInfo, NodeId, boolean)
+     * @see RepositoryService#lock(SessionInfo, NodeId, boolean, boolean)
-    public EventIterator lock(SessionInfo sessionInfo, NodeId nodeId, boolean deep) throws UnsupportedRepositoryOperationException, LockException, AccessDeniedException, InvalidItemStateException, RepositoryException {
+    public EventIterator lock(SessionInfo sessionInfo, NodeId nodeId, boolean deep, boolean sessionScoped) throws UnsupportedRepositoryOperationException, LockException, AccessDeniedException, InvalidItemStateException, RepositoryException {
-            LockMethod method = new LockMethod(uri, Scope.EXCLUSIVE, Type.WRITE,
+            Scope scope = (sessionScoped) ? ItemResourceConstants.EXCLUSIVE_SESSION : Scope.EXCLUSIVE;
+            LockMethod method = new LockMethod(uri, scope, Type.WRITE,
