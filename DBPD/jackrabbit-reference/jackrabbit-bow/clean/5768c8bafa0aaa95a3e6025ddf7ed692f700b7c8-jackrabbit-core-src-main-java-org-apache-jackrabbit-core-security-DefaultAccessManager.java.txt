JCR-2291 Issues with compiled permissions of ACL provider


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@810941 13f79535-47bb-0310-9956-ffa450edef68

-
-        int bits = acProvider.compilePermissions(principals).getPrivileges(resolver.getQPath(absPath));
-        return (bits == PrivilegeRegistry.NO_PRIVILEGE) ?
-                new Privilege[0] :
-                privilegeRegistry.getPrivileges(bits);
+        CompiledPermissions perms = acProvider.compilePermissions(principals);
+        try {
+            int bits = perms.getPrivileges(resolver.getQPath(absPath));
+            return (bits == PrivilegeRegistry.NO_PRIVILEGE) ?
+                    new Privilege[0] :
+                    privilegeRegistry.getPrivileges(bits);
+        } finally {
+            perms.close();
+        }
