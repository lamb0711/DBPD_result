JCR-2065 use the internal CND file for builtin nodetypes


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@763248 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.nodetype.compact.CompactNodeTypeDefReader;
+import org.apache.jackrabbit.core.nodetype.compact.ParseException;
+import org.apache.jackrabbit.spi.commons.name.NameConstants;
+import java.io.Reader;
+import java.util.Iterator;
+     * Loads node types from a CND stream.
+     * 
+     * @param in reader containing the nodetype definitions
+     * @param systemId optional name of the stream
+     *
+     * @throws IOException if an I/O error during reading occurrs
+     * @throws InvalidNodeTypeDefException if the CND cannot be parsed
+     */
+    public void loadCND(Reader in, String systemId)
+            throws IOException, InvalidNodeTypeDefException {
+        try {
+            CompactNodeTypeDefReader r = new CompactNodeTypeDefReader(in, systemId);
+            Iterator iter = r.getNodeTypeDefs().iterator();
+            while (iter.hasNext()) {
+                add((NodeTypeDef) iter.next());
+            }
+        } catch (ParseException e) {
+            throw new InvalidNodeTypeDefException("Unable to parse CND stream.", e);
+        }
+    }
+
+    /**
