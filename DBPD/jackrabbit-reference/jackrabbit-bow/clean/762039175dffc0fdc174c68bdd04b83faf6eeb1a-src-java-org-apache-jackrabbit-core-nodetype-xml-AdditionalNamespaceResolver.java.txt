JCR-54: Refactoring^2, taking full advantage of the DOMBuilder and DOMWalker utility classes.

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@160450 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.Enumeration;
-import org.apache.jackrabbit.core.Constants;
-import org.w3c.dom.Attr;
-import org.w3c.dom.Element;
-import org.w3c.dom.NamedNodeMap;
-     * Creates a namespace resolver using the namespaces declared
-     * in the given XML element.
+     * Creates a namespace resolver using the namespaces defined in
+     * the given prefix-to-URI property set.
-     * @param element XML element
+     * @param namespaces namespace properties
-    public AdditionalNamespaceResolver(Element element) {
-        NamedNodeMap attributes = element.getAttributes();
-        for (int i = 0; i < attributes.getLength(); i++) {
-            Attr attribute = (Attr) attributes.item(i);
-            if (Constants.NS_XMLNS_PREFIX.equals(attribute.getPrefix())) {
-                addNamespace(attribute.getLocalName(), attribute.getValue());
-            }
+    public AdditionalNamespaceResolver(Properties namespaces) {
+        Enumeration prefixes = namespaces.propertyNames();
+        while (prefixes.hasMoreElements()) {
+            String prefix = (String) prefixes.nextElement();
+            addNamespace(prefix, namespaces.getProperty(prefix));
-        addNamespace(Constants.NS_EMPTY_PREFIX, Constants.NS_DEFAULT_URI);
+        addNamespace("", "");
