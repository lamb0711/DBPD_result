JCR-2076: JSR 283: QOM and SQL2
- orderings (work in progress)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@784061 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.lucene.search.Sort;
-                                        Sort sort,
+                                        Ordering[] orderings,
-        return new FilterMultiColumnQueryHits(query.execute(
-                searcher, sort, resultFetchHint)) {
+        MultiColumnQueryHits hits = new FilterMultiColumnQueryHits(query.execute(
+                searcher, orderings, resultFetchHint)) {
+        if (orderings.length > 0 && hits.getSelectorNames().length > 1) {
+            // subsequent ordering is only needed
+            // when there is more than one column
+            hits = new SortedMultiColumnQueryHits(hits, orderings, searcher.getIndexReader());
+        }
+        return hits;
