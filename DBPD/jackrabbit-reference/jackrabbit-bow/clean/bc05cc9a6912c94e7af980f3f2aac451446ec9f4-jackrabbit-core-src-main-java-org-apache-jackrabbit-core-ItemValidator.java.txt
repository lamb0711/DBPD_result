JCR-1775: Transaction-safe versioning

Modified the NodeTypeRegistry.getEffectiveNodeType method to simplify calling code that always starts with the primary type name and a set of mixin types.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@701127 13f79535-47bb-0310-9956-ffa450edef68

-     * @param nodeState
+     * @param state
-    public EffectiveNodeType getEffectiveNodeType(NodeState nodeState)
+    public EffectiveNodeType getEffectiveNodeType(NodeState state)
-        // mixin types
-        Set set = nodeState.getMixinTypeNames();
-        Name[] types = new Name[set.size() + 1];
-        set.toArray(types);
-        // primary type
-        types[types.length - 1] = nodeState.getNodeTypeName();
-            return ntReg.getEffectiveNodeType(types);
+            return ntReg.getEffectiveNodeType(
+                    state.getNodeTypeName(), state.getMixinTypeNames());
-                    + safeGetJCRPath(nodeState.getNodeId());
+                    + safeGetJCRPath(state.getNodeId());
