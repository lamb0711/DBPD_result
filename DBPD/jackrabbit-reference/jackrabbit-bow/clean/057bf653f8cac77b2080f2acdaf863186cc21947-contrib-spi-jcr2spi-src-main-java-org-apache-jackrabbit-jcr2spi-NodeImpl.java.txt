work in progress

- remove NodeState.getPropertyId and replace by getPropertyState
- use ChildNodeEntry.getNodeState
- consequently remove utility methods getNodeState, getPropertyState on
  ItemStateValidator, that converted ItemStateExceptions to RepositoryExc.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@429269 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.jcr2spi.state.PropertyState;
+import org.apache.jackrabbit.jcr2spi.state.NoSuchItemStateException;
-        // retrieve id of state that has been created during execution of AddNode        
+        // retrieve id of state that has been created during execution of AddNode
-        PropertyId propId = getNodeState().getPropertyId(qName);
-            return (Property) itemMgr.getItem(propId);
+            PropertyState pState = getNodeState().getPropertyState(qName);
+            return (Property) itemMgr.getItem(pState.getId());
+        } catch (NoSuchItemStateException e) {
+            throw new PathNotFoundException(qName.toString());
+        } catch (ItemStateException e) {
+            String msg = "Error while accessing property " + qName.toString();
+            throw new RepositoryException(msg, e);
-                    return getNodeState().getPropertyId(propName);
+                    try {
+                        return getNodeState().getPropertyState(propName).getPropertyId();
+                    } catch (ItemStateException e) {
+                        // should not occur due, since existance has been checked
+                        throw new RepositoryException(e);
+                    }
