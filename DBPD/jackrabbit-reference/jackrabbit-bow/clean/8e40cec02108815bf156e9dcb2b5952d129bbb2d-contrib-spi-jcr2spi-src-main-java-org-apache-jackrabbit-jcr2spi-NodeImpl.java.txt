div

- get rid of rootId stored with ISM, HierarchyManagers etc.
- remove corresponding method with WorkspaceManager and WorkspaceImpl

jcr2spi/state/ItemState

- move parent field from Node/PropertyState to ItemState
- move idFactory field from NodeState to ItemState
- let PropertyState build its id instead of calling parentstate method.
- minor reordering of status related methods
- remove modCount and its usage

jcr2spi/state/ItemStateManager

- add method getRootNode()

jcr2spi/security/AccessManager

- replace ItemId by ItemState

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@431352 13f79535-47bb-0310-9956-ffa450edef68

-        // check if root node
+
+        // special treatment for root node
-        return getNodeState().getNodeId().getUUID();
+        return getNodeId().getUUID();
+
+
-            session.getVersionManager().resolveMergeConflict(getNodeId(), (NodeId) ((VersionImpl)version).getId(), done);
+            NodeId versionId = ((VersionImpl)version).getNodeId();
+            session.getVersionManager().resolveMergeConflict(getNodeId(), versionId, done);
-            session.getVersionManager().restore(nodeId, (NodeId) ((VersionImpl)version).getId(), removeExisting);
+            NodeId versionId = ((VersionImpl)version).getNodeId();
+            session.getVersionManager().restore(nodeId, versionId, removeExisting);
-        NodeId nodeId = getNodeState().getNodeId();
-        ChildNodeEntry entry = parentState.getChildNodeEntry(nodeId);
+        ChildNodeEntry entry = parentState.getChildNodeEntry(getNodeId());
-            String msg = "Failed to retrieve qualified name of Node " + nodeId;
+            String msg = "Failed to retrieve qualified name of Node " + getNodeId();
-     * Return the id of this <code>Node</code>.
+     * Return the id of this <code>Node</code>. Protected for usage within
+     * <code>VersionImpl</code> and <code>VersionHistoryImpl</code>.
-    private NodeId getNodeId() {
+    protected NodeId getNodeId() {
