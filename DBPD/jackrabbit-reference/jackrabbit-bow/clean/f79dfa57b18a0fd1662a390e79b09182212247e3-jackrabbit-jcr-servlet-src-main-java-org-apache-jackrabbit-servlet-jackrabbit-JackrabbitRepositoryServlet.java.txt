JCR-3040: JMX Stats for the Session

Make repository statistics available to a webapp

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1181745 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.api.JackrabbitRepository;
+import org.apache.jackrabbit.core.RepositoryContext;
+ *   <dt>org.apache.jackrabbit.core.RepositoryContext</dt>
+ *   <dd>
+ *     Name of the servlet context attribute to put the internal
+ *     component context of the repository in. The default value is
+ *     "<code>org.apache.jackrabbit.core.RepositoryContext</code>".
+ *   </dd>
-    private JackrabbitRepository repository;
+    private RepositoryContext context;
-            repository = RepositoryImpl.create(RepositoryConfig.create(
+            context = RepositoryContext.create(RepositoryConfig.create(
+
+            String name = RepositoryContext.class.getName();
+            getServletContext().setAttribute(
+                    getInitParameter(name, name), context);
-        repository.shutdown();
+        context.getRepository().shutdown();
-        return repository;
+        return context.getRepository();
