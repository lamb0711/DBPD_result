JCR-2744: Avoid element arrays in PathImpl

Add new Path iplementation classes.

Change Path.getDepth() to return 0 for an identifier, as that's better in line with the way the depth of a relative path is handled.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@995712 13f79535-47bb-0310-9956-ffa450edef68

-            try {
-                return (isAbsolute() && !denotesIdentifier()) ? getDepth() : -1;
-            } catch (RepositoryException e) {
-                // never gets here.
-                return -1;
-            }
+            return (isAbsolute() && !denotesIdentifier()) ? getDepth() : -1;
-        public int getDepth() throws RepositoryException {
-            if (denotesIdentifier()) {
-                throw new RepositoryException(
-                        "Cannot determine depth of an identifier based path: " + this);
-            }
+        public int getDepth() {
-                    // don't count root/current element.
+                    // don't count root/identifier/current element.
+            // make sure both paths are either identifier-based or not
+            if (denotesIdentifier() != other.denotesIdentifier()) {
+                throw new RepositoryException(
+                        "Cannot compare paths: " + this + " vs. " + other);
+            }
