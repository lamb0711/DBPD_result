JCR-131: simplifying internal data model (NodeState) by limiting a node to *one* parent



git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@191499 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.ZombieHierarchyManager;
+import org.apache.jackrabbit.core.Path;
+import javax.jcr.ItemNotFoundException;
+import javax.jcr.RepositoryException;
+    ZombieHierarchyManager zombieHierMgr;
+
-                resolver,
-                new AtticItemStateManager(changes));
+                resolver);
+        zombieHierMgr =
+                new ZombieHierarchyManager(rootNodeUUID, provider,
+                        new AtticItemStateManager(changes), resolver);
+    }
+
+    /**
+     * Same as {@link #getPath(ItemId)}} except that the <i>old</i> path is
+     * returned in case of a moved/removed item.
+     *
+     * @param id
+     * @return
+     * @throws ItemNotFoundException
+     * @throws RepositoryException
+     */
+    public Path getZombiePath(ItemId id)
+            throws ItemNotFoundException, RepositoryException {
+        return zombieHierMgr.getPath(id);
-         * Returns an {@link ItemState} it is found in the deleted map of the
+         * Returns an {@link ItemState} if it is found in the deleted map of the
