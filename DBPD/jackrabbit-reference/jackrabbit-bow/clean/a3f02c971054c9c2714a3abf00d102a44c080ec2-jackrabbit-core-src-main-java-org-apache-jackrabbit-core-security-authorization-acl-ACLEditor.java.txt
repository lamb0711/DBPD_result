JCR-2700 : Allow for wildcard restriction in resource-based ACEs

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@983906 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.api.security.JackrabbitAccessControlEntry;
+import org.apache.jackrabbit.core.security.authorization.AccessControlEntryImpl;
+import java.util.Set;
-                        privilegeRegistry, session.getValueFactory());
+                        privilegeRegistry, session.getValueFactory(), session);
-            JackrabbitAccessControlEntry ace = (JackrabbitAccessControlEntry) entry;
+            AccessControlEntryImpl ace = (AccessControlEntryImpl) entry;
+
+            // store the restrictions:
+            Set<Name> restrNames = ace.getRestrictions().keySet();
+            for (Name restrName : restrNames) {
+                Value value = ace.getRestriction(restrName);
+                setProperty(aceNode, restrName, value);
+            }
