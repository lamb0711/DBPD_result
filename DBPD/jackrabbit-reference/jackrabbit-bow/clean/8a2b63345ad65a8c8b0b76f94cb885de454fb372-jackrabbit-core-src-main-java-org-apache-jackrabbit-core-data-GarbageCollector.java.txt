JCR-2241 Data Store: garbage collection should ignore removed properties

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@801901 13f79535-47bb-0310-9956-ffa450edef68

+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
+    /** logger instance */
+    private static final Logger LOG = LoggerFactory.getLogger(GarbageCollector.class);
+
-                if (p.getType() == PropertyType.BINARY) {
-                    if (n.hasProperty("jcr:uuid")) {
-                        rememberNode(n.getProperty("jcr:uuid").getString());
-                    } else {
-                        rememberNode(n.getPath());
+                try {
+                    if (p.getType() == PropertyType.BINARY) {
+                        if (n.hasProperty("jcr:uuid")) {
+                            rememberNode(n.getProperty("jcr:uuid").getString());
+                        } else {
+                            rememberNode(n.getPath());
+                        }
+                        if (p.getDefinition().isMultiple()) {
+                            p.getLengths();
+                        } else {
+                            p.getLength();
+                        }
-                    if (p.getDefinition().isMultiple()) {
-                        p.getLengths();
-                    } else {
-                        p.getLength();
-                    }
+                } catch (InvalidItemStateException e) {
+                    LOG.debug("Property removed concurrently - ignoring", e);
-            // the property may have been removed in the meantime - ignore
+            LOG.debug("Node removed concurrently - ignoring", e);
-            // the item may have been removed in the meantime - ignore
+            LOG.debug("Node removed concurrently - ignoring", e);
