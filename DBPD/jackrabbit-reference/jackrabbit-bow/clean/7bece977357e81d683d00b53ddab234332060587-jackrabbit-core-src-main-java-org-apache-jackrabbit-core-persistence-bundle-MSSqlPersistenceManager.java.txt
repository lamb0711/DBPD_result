JCR-1295: Tablespace (Filegroup) support for MS SQL Server
    - Tablespace support for MS SQL bundle pm and journal
    - Based on a patch from Vijai Kalyan

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@610214 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.core.persistence.PMContext;
+import org.apache.jackrabbit.util.Text;
+ * <li>&lt;param name="{@link #setTableSpace(String) tableSpace}" value=""/>
+    /** the MS SQL table space to use */
+    protected String tableSpace = "";
+
+    public MSSqlPersistenceManager() {
+        setDriver("com.microsoft.sqlserver.jdbc.SQLServerDriver");
+        setSchema("mssql");
+    }
+
+    protected String createSchemaSQL(String sql) {
+        return Text.replace(
+                super.createSchemaSQL(sql), "${tableSpace}", tableSpace);
+    }
+
-     * {@inheritDoc}
+     * Returns the configured MS SQL table space.
+     * 
+     * @return the configured MS SQL table space.
-    public void init(PMContext context) throws Exception {
-        // init default values
-        if (getDriver() == null) {
-            setDriver("com.microsoft.sqlserver.jdbc.SQLServerDriver");
+    public String getTableSpace() {
+        return tableSpace;
+    }
+
+    /**
+     * Sets the MS SQL table space.
+     * 
+     * @param tableSpace the MS SQL table space.
+     */
+    public void setTableSpace(String tableSpace) {
+        if (tableSpace != null && tableSpace.length() > 0) {
+            this.tableSpace = "on " + tableSpace.trim();
+        } else {
+            this.tableSpace = "";
-        if (getSchema() == null) {
-            setSchema("mssql");
-        }
-        super.init(context);
