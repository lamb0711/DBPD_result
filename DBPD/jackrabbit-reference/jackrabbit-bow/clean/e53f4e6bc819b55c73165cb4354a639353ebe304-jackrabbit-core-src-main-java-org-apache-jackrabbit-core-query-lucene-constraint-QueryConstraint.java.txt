JCR-2085: test case (TCK) maintenance for JCR 2.0
- move ValueFactory field to AbstractJCRTest
- more QOM tests
- use RepositoryException instead of IOException in constraints

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@784760 13f79535-47bb-0310-9956-ffa450edef68

-import java.util.BitSet;
+import java.util.Map;
+import java.util.HashMap;
-     * The bitset with the matching document numbers.
+     * Map of document numbers with their respective score value that match the
+     * query constraint.
-    private BitSet matches;
+    private Map<Integer, Float> matches;
-        return matches.get(sn.getDoc(context.getIndexReader()));
+        Float score = matches.get(sn.getDoc(context.getIndexReader()));
+        if (score != null) {
+            sn.setScore(score);
+        }
+        return score != null;
-                matches = new BitSet();
+                matches = new HashMap<Integer, Float>();
-                    matches.set(sn.getDoc(reader));
+                    matches.put(sn.getDoc(reader), sn.getScore());
