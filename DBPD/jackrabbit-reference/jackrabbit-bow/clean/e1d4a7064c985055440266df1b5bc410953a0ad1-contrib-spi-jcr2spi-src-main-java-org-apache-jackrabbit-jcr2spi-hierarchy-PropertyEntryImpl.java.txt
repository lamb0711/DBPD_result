JCR-996 Name and Path interfaces in SPI
JCR-1169 Distribution of commons classes


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@586065 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.name.QName;
-import org.apache.jackrabbit.name.Path;
-import org.apache.jackrabbit.name.MalformedPathException;
+import org.apache.jackrabbit.spi.Name;
+import org.apache.jackrabbit.spi.Path;
-    private PropertyEntryImpl(NodeEntryImpl parent, QName name, EntryFactory factory) {
+    private PropertyEntryImpl(NodeEntryImpl parent, Name name, EntryFactory factory) {
-    static PropertyEntry create(NodeEntryImpl parent, QName name, EntryFactory factory) {
+    static PropertyEntry create(NodeEntryImpl parent, Name name, EntryFactory factory) {
-        try {
-            Path.PathBuilder builder = new Path.PathBuilder();
-            builder.addAll(parent.buildPath(workspacePath).getElements());
-            // add property name to parent path
-            builder.addLast(getQName());
-
-            return builder.getPath();
-        } catch (MalformedPathException e) {
-            String msg = "Failed to build path of " + this;
-            throw new RepositoryException(msg, e);
-        }
+        Path parentPath = parent.buildPath(workspacePath);
+        return factory.getPathFactory().create(parentPath, getName(), true);
-        return factory.getIdFactory().createPropertyId(parent.getId(), getQName());
+        return factory.getIdFactory().createPropertyId(parent.getId(), getName());
-        return factory.getIdFactory().createPropertyId(parent.getWorkspaceId(), getQName());
+        return factory.getIdFactory().createPropertyId(parent.getWorkspaceId(), getName());
-            parent.internalRemovePropertyEntry(getQName());
+            parent.internalRemovePropertyEntry(getName());
