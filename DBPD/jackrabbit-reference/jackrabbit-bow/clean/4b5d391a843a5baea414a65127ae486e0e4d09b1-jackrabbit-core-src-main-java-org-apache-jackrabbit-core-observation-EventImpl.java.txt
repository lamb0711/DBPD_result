JCR-1904: Event user data

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@724300 13f79535-47bb-0310-9956-ffa450edef68

+     * The user data associated with this event.
+     */
+    private final String userData;
+
+    /**
+     * @param userData   the user data associated with this event.
-    EventImpl(SessionImpl session, EventState eventState, long timestamp) {
+    EventImpl(SessionImpl session, EventState eventState,
+              long timestamp, String userData) {
+        this.userData = userData;
+    /**
+     * {@inheritDoc}
+     */
+    public String getUserData() {
+        return userData;
+    }
+
+            sb.append(", Timestamp: ").append(timestamp);
+            sb.append(", UserData: ").append(userData);
-        return eventState.hashCode() ^ session.hashCode();
+        int h = eventState.hashCode() ^ new Long(timestamp).hashCode() ^ session.hashCode();
+        if (userData != null) {
+            h = h ^ userData.hashCode();
+        }
+        return h;
-                    && this.session.equals(other.session);
+                    && this.session.equals(other.session)
+                    && this.timestamp == other.timestamp
+                    && equals(this.userData, other.userData);
+
+    /**
+     * Returns <code>true</code> if the objects are equal or both are
+     * <code>null</code>; otherwise returns <code>false</code>.
+     *
+     * @param o1 an object.
+     * @param o2 another object.
+     * @return <code>true</code> if equal; <code>false</code> otherwise.
+     */
+    private static boolean equals(Object o1, Object o2) {
+        if (o1 == null) {
+            return o2 == null;
+        } else {
+            return o1.equals(o2);
+        }
+    }
