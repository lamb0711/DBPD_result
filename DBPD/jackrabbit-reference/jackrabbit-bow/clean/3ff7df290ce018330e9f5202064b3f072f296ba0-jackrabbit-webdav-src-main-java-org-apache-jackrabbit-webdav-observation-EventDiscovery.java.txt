JCR-4064: Refactor WebDAV related code out of HttpClient3-specific classes for better future re-use

use separate classes for XML parsing/serialization

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1771999 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.webdav.xml.ElementIterator;
+
+    /**
+     * Build a <code>EventDiscovery</code> from the specified xml element.
+     *
+     * @param eventDiscoveryElement
+     * @return new <code>EventDiscovery</code> instance.
+     * @throws IllegalArgumentException if the given document is <code>null</code>
+     * or does not provide the required element.
+     */
+    public static EventDiscovery createFromXml(Element eventDiscoveryElement) {
+        if (!DomUtil.matches(eventDiscoveryElement, XML_EVENTDISCOVERY, ObservationConstants.NAMESPACE)) {
+            throw new IllegalArgumentException(
+                    "{" + ObservationConstants.NAMESPACE + "}" + XML_EVENTDISCOVERY + " element expected, but got: {"
+                            + eventDiscoveryElement.getNamespaceURI() + "}" + eventDiscoveryElement.getLocalName());
+        }
+        EventDiscovery eventDiscovery = new EventDiscovery();
+        ElementIterator it = DomUtil.getChildren(eventDiscoveryElement, XML_EVENTBUNDLE, ObservationConstants.NAMESPACE);
+        while (it.hasNext()) {
+            final Element ebElement = it.nextElement();
+            EventBundle eb = new EventBundle() {
+                public Element toXml(Document document) {
+                    return (Element) document.importNode(ebElement, true);
+                }
+            };
+            eventDiscovery.addEventBundle(eb);
+        }
+        return eventDiscovery;
+    }
