JCR-2836: Unclosed threads in Jackrabbit

Merge all timers into a single repository-wide timer instance and arrange for it to be cancelled when the repository is shutdown.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1055071 13f79535-47bb-0310-9956-ffa450edef68

-     * Create a global timer for all transaction contexts.
+     * Timer for all transaction contexts.
-    private static final Timer TIMER = new Timer(true);
+    private final Timer timer;
-    public TransactionContext(Xid xid, InternalXAResource[] resources, int timeout) {
+    public TransactionContext(
+            Xid xid, InternalXAResource[] resources,
+            int timeout, Timer timer) {
+        this.timer = timer;
-        TIMER.schedule(this, timeout * 1000, Integer.MAX_VALUE);
+        timer.schedule(this, timeout * 1000, Integer.MAX_VALUE);
