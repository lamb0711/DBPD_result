- Add support for element test in XPath as an alternative for predicate with @jcr:primaryType expression.
- Test cases for element test.

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@158751 13f79535-47bb-0310-9956-ffa450edef68

+     * QName for element function.
+     */
+    static final QName FN_ELEMENT = new QName("", "element");
+
+    /**
+            case JJTELEMENTNAMEORWILDCARD:
+                if (queryNode.getType() == QueryNode.TYPE_LOCATION) {
+                    SimpleNode child = (SimpleNode) node.jjtGetChild(0);
+                    if (child.getId() != JJTANYNAME) {
+                        createNodeTest(child, queryNode);
+                    }
+                }
+                break;
+            case JJTTYPENAME:
+                if (queryNode.getType() == QueryNode.TYPE_LOCATION) {
+                    LocationStepQueryNode loc = (LocationStepQueryNode) queryNode;
+                    String ntName = ((SimpleNode) node.jjtGetChild(0)).getValue();
+                    try {
+                        QName nt = QName.fromJCRName(ntName, resolver);
+                        NodeTypeQueryNode nodeType = new NodeTypeQueryNode(loc, nt);
+                        loc.addPredicate(nodeType);
+                    } catch (IllegalNameException e) {
+                        exceptions.add(new InvalidQueryException("Not a valid name: " + ntName));
+                    } catch (UnknownPrefixException e) {
+                        exceptions.add(new InvalidQueryException("Unknown prefix in name: " + ntName));
+                    }
+                }
+                break;
-            if (child.getId() == JJTQNAME) {
+            if (child.getId() == JJTQNAME || child.getId() == JJTQNAMEFORITEMTYPE) {
