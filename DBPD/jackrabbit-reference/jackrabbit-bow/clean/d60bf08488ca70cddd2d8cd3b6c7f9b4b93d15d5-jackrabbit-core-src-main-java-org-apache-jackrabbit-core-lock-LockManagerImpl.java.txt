JCR-1590: JSR 283: Locking

More code cleanup: Inline LockToken into LockInfo and make LockInfo member variables private.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@803535 13f79535-47bb-0310-9956-ffa450edef68

-                reapplyLock(LockToken.parse(s));
+                reapplyLock(s);
-    private void reapplyLock(LockToken lockToken) {
+    private void reapplyLock(String lockToken) {
-            NodeImpl node = (NodeImpl)
-                sysSession.getItemManager().getItem(lockToken.getId());
-            Path path = getPath(sysSession, lockToken.getId());
+            NodeId id = LockInfo.parseLockToken(lockToken);
+            NodeImpl node = (NodeImpl) sysSession.getItemManager().getItem(id);
+            Path path = getPath(sysSession, id);
-            InternalLockInfo info = new InternalLockInfo(lockToken, false,
+            InternalLockInfo info = new InternalLockInfo(
+                    id, false,
-                writer.write(info.getLockToken().toString());
+                writer.write(info.getLockToken());
-        InternalLockInfo info = new InternalLockInfo(new LockToken(node.getNodeId()),
-                isSessionScoped, isDeep, lockOwner, timeoutHint);
+        InternalLockInfo info = new InternalLockInfo(
+                node.getNodeId(), isSessionScoped, isDeep, lockOwner, timeoutHint);
-            if (info.deep && element.hasPath(path)
+            if (info.isDeep() && element.hasPath(path)
-                getSessionLockManager(session).lockTokenAdded(
-                        info.getLockToken().toString());
+                getSessionLockManager(session).lockTokenAdded(info.getLockToken());
-            getSessionLockManager(session).lockTokenRemoved(
-                    info.getLockToken().toString());
+            getSessionLockManager(session).lockTokenRemoved(info.getLockToken());
-        writeLockProperties(node, info.lockOwner, info.deep);
+        writeLockProperties(node, info.getLockOwner(), info.isDeep());
-            LockToken lockToken = LockToken.parse(lt);
+            NodeId id = LockInfo.parseLockToken(lt);
-            NodeImpl node = (NodeImpl)
-                this.sysSession.getItemManager().getItem(lockToken.getId());
+            NodeImpl node = (NodeImpl) sysSession.getItemManager().getItem(id);
-            LockToken lockToken = LockToken.parse(lt);
+            NodeId id = LockInfo.parseLockToken(lt);
-            NodeImpl node = (NodeImpl) this.sysSession.getItemManager()
-                    .getItem(lockToken.getId());
+            NodeImpl node = (NodeImpl) sysSession.getItemManager().getItem(id);
-        public InternalLockInfo(LockToken lockToken, boolean sessionScoped,
+        public InternalLockInfo(NodeId lockToken, boolean sessionScoped,
-        public InternalLockInfo(LockToken lockToken, boolean sessionScoped,
+        public InternalLockInfo(NodeId lockToken, boolean sessionScoped,
-                    session.removeLockToken(getLockToken().toString());
+                    session.removeLockToken(getLockToken());
-            InternalLockInfo info = new InternalLockInfo(new LockToken(nodeId), false, isDeep, lockOwner);
+            InternalLockInfo info = new InternalLockInfo(nodeId, false, isDeep, lockOwner);
