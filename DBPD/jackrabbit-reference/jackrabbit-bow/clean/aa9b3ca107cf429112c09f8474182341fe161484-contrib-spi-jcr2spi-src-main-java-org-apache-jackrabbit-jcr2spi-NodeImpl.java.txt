work in progress

- replace ItemState.getParentId by ItemState.getParentState

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@429288 13f79535-47bb-0310-9956-ffa450edef68

-        NodeId parentId = getItemState().getParentId();
-        if (parentId == null) {
+        NodeState parentState = getItemState().getParentState();
+        if (parentState == null) {
-        return (Node) itemMgr.getItem(parentId);
+        return (Node) itemMgr.getItem(parentState.getNodeId());
-        NodeId parentId = getItemState().getParentId();
-        if (parentId == null) {
+        NodeState parentState = getItemState().getParentState();
+        if (parentState == null) {
-        try {
-            NodeState parent = (NodeState) itemStateMgr.getItemState(parentId);
-            ChildNodeEntry parentEntry = parent.getChildNodeEntry(getNodeId());
-            return parentEntry.getIndex();
-        } catch (ItemStateException ise) {
-            // should never get here...
-            String msg = "internal error: failed to determine index";
-            log.error(msg, ise);
-            throw new RepositoryException(msg, ise);
-        }
+        ChildNodeEntry parentEntry = parentState.getChildNodeEntry(getNodeId());
+        return parentEntry.getIndex();
