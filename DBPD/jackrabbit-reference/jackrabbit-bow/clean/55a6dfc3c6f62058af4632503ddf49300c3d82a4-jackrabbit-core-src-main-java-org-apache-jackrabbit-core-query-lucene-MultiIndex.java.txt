JCR-2836: Unclosed threads in Jackrabbit

Merge all timers into a single repository-wide timer instance and arrange for it to be cancelled when the repository is shutdown.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1055071 13f79535-47bb-0310-9956-ffa450edef68

-     * Timer to schedule flushes of this index after some idle time.
-     */
-    private final Timer flushTimer = new Timer(true);
-
-    /**
-     * Task that is periodically called by {@link #FLUSH_TIMER} and checks
+     * Task that is periodically called by the repository timer for checking
-        for (Iterator it = indexNames.iterator(); it.hasNext(); ) {
+        for (Iterator<?> it = indexNames.iterator(); it.hasNext(); ) {
-            flushTimer.cancel();
-        flushTimer.schedule(flushTask, 0, 1000);
+        handler.getContext().getTimer().schedule(flushTask, 0, 1000);
