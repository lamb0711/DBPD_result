JCR-3884 Add handler to handle webdav based DELETE requests


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1686293 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.server.io.DeleteContextImpl;
+import org.apache.jackrabbit.server.io.DeleteManager;
+        DeleteManager dm = config.getDeleteManager();
+        dm.delete(new DeleteContextImpl(getJcrSession()), member);
+        // make sure, non-jcr locks are removed, once the removal is completed
-            String itemPath = member.getLocator().getRepositoryPath();
-            Item memItem = getJcrSession().getItem(itemPath);
-            if (memItem instanceof Node) {
-                ((Node)memItem).removeShare();
-            } else {
-                memItem.remove();
-            }
-            getJcrSession().save();
-
-            // make sure, non-jcr locks are removed, once the removal is completed
-            try {
-                if (!isJcrLockable()) {
-                    ActiveLock lock = getLock(Type.WRITE, Scope.EXCLUSIVE);
-                    if (lock != null) {
-                        lockManager.releaseLock(lock.getToken(), member);
-                    }
+            if (!isJcrLockable()) {
+                ActiveLock lock = getLock(Type.WRITE, Scope.EXCLUSIVE);
+                if (lock != null) {
+                    lockManager.releaseLock(lock.getToken(), member);
-            } catch (DavException e) {
-                // since check for 'locked' exception has been performed before
-                // ignore any error here
-        } catch (RepositoryException e) {
-            throw new JcrDavException(e);
+        } catch (DavException e) {
+            // since check for 'locked' exception has been performed before
+            // ignore any error here
