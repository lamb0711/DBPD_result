fixing export: endPrefixMapping event was never generated

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@155688 13f79535-47bb-0310-9956-ffa450edef68

+        // start document and declare namespaces
-        // namespace declarations
-        documentPrefixMappings();
-        // start serializing node and sub tree
+        startNamespaceDeclarations();
+
+        // serialize node and subtree
+        // clear namespace declarations and end document 
+        endNamespaceDeclarations();
-     * @throws javax.jcr.RepositoryException
-     * @throws org.xml.sax.SAXException
+     * @throws RepositoryException
+     * @throws SAXException
-    protected void documentPrefixMappings() throws RepositoryException, SAXException {
-        // namespace declarations
+    protected void startNamespaceDeclarations()
+            throws RepositoryException, SAXException {
+        // start namespace declarations
+     * @throws RepositoryException
+     * @throws SAXException
+     */
+    protected void endNamespaceDeclarations()
+            throws RepositoryException, SAXException {
+        // end namespace declarations
+        String[] prefixes = session.getNamespacePrefixes();
+        for (int i = 0; i < prefixes.length; i++) {
+            contentHandler.endPrefixMapping(prefixes[i]);
+        }
+    }
+
+    /**
