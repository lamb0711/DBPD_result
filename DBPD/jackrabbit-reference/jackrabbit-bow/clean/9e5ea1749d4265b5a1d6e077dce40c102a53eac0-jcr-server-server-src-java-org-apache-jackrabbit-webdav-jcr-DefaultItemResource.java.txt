JCR-337 - Remove jcr dependency from dav-library
JCR-343 - Report#init limits the Report interface to DeltaV compliant resources
JCR-340 - ValuesProperty missing property type information
JCR-342 - DavResource#getDavSession() missing
JCR-344 - DeltaVResource lists MKWORKSPACE in the method constant.
JCR-345 - DavException does not allow to specify an exception cause

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@385540 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.value.ValueHelper;
-import org.apache.jackrabbit.webdav.DavSession;
-    public DefaultItemResource(DavResourceLocator locator, DavSession session,
+    public DefaultItemResource(DavResourceLocator locator, JcrDavSession session,
-            int type = prop.getType();
+            int defaultType = prop.getType();
+            ValuesProperty vp = new ValuesProperty(property, defaultType);
-                String strVal = (property.getValue() != null) ? String.valueOf(property.getValue()) : "";
-                Value val = ValueHelper.deserialize(strVal, type, false);
-                prop.setValue(val);
+                prop.setValue(vp.getJcrValue(vp.getValueType()));
-                prop.setValue(new ValuesProperty(property).getValues(prop.getType()));
+                prop.setValue(vp.getJcrValues());
-        } catch (IllegalArgumentException e) {
-            throw new DavException(DavServletResponse.SC_BAD_REQUEST, e.getMessage());
-                    properties.add(new DefaultDavProperty(JCR_VALUE, ValueHelper.serialize(prop.getValue(), false)));
+                    properties.add(new ValuesProperty(prop.getValue()));
