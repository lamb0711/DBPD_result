JCR-3478 Partial search terms matching fails when there is a lot of matching content outside the query's scope

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1418236 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.lucene.search.PhraseQuery;
-            relevantTerms.add(filteredTerms.toArray(new Term[] {}));
+            if (q instanceof PhraseQuery) {
+                // inline the terms, basically a 'must all' condition
+                relevantTerms.add(filteredTerms.toArray(new Term[] {}));
+            } else {
+                // each possible term gets a new slot
+                for (Term t : filteredTerms) {
+                    relevantTerms.add(new Term[] { t });
+                }
+            }
