JCR-3549: URIResolverImpl needs to handle absolute paths in addition to absolute URIs


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1461613 13f79535-47bb-0310-9956-ffa450edef68

+import java.net.URISyntaxException;
-                            uriBuffer.append(ms.getResponses()[0].getHref());
-                            cache.add(ms.getResponses()[0].getHref(), uuidId);
+                            String absoluteUri = resolve(wspUri, ms.getResponses()[0].getHref());
+                            uriBuffer.append(absoluteUri);
+                            cache.add(absoluteUri, uuidId);
+                    } catch (URISyntaxException e) {
+                        throw new RepositoryException(e.getMessage());
+    /**
+     * Resolve the given href obtained from multistatus against base URI
+     */
+    private static String resolve(String wspUri, String href) throws URISyntaxException {
+        java.net.URI base = new java.net.URI(wspUri);
+        java.net.URI rel = new java.net.URI(href);
+        return base.resolve(rel).toASCIIString();
+    }
+
