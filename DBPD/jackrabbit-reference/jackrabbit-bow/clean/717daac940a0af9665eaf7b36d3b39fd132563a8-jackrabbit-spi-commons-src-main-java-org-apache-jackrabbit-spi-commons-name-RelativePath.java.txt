JCR-2744: Avoid element arrays in PathImpl

Use new path construction mechanisms in PathBuilder and PathFactoryImpl

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@995787 13f79535-47bb-0310-9956-ffa450edef68

-    public final Path subPath(int from, int to) throws RepositoryException {
+    public final Path subPath(int from, int to) {
-        } else if (!isNormalized()) {
-            throw new RepositoryException(
-                    "Path " + this + " is not normalized");
-            // this is only case where parent can be null
+            // this is only case where parent can be null (from = 0, to = 1)
-        } else if (from < to - 1) {
-            return createPath(parent.subPath(from, to - 1), getNameElement());
-            return createPath(null, getNameElement());
+            Element element = getNameElement();
+            if (from < to - 1) {
+                return parent.subPath(from, to - 1).resolve(element);
+            } else if (element.denotesName()) {
+                return new NamePath(null, element);
+            } else if (element.denotesParent()) {
+                return new ParentPath(null);
+            } else if (element.denotesCurrent()) {
+                return new CurrentPath(null);
+            } else {
+                throw new IllegalStateException(
+                        "Unknown path element type: " + element);
+            }
