JCR-1024: Only load root node definition when required

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@555290 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.spi.QNodeDefinition;
-        QNodeDefinition rootNodeDef = service.getNodeDefinition(sessionInfo, service.getRootId(sessionInfo));
-        ntRegistry = createNodeTypeRegistry(rootNodeDef, nsRegistry);
+        ntRegistry = createNodeTypeRegistry(nsRegistry);
-        definitionProvider = createDefinitionProvider(rootNodeDef, getEffectiveNodeTypeProvider());
+        definitionProvider = createDefinitionProvider(getEffectiveNodeTypeProvider());
-     * @param descriptors
-     * @throws RepositoryException
-    private NodeTypeRegistry createNodeTypeRegistry(QNodeDefinition rootNodeDef, NamespaceRegistry nsRegistry) {
+    private NodeTypeRegistry createNodeTypeRegistry(NamespaceRegistry nsRegistry) {
-        return NodeTypeRegistryImpl.create(ntst, rootNodeDef, nsRegistry);
+        return NodeTypeRegistryImpl.create(ntst, nsRegistry);
-     * @param rootDefinition
-    private ItemDefinitionProvider createDefinitionProvider(QNodeDefinition rootDefinition, EffectiveNodeTypeProvider entProvider) {
-        return new ItemDefinitionProviderImpl(rootDefinition, entProvider, service, sessionInfo);
+    private ItemDefinitionProvider createDefinitionProvider(EffectiveNodeTypeProvider entProvider) {
+        return new ItemDefinitionProviderImpl(entProvider, service, sessionInfo);
