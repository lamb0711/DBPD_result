Make CachingHierarchyManager and LockManager dumpable to print layout of internal path maps


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@486534 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.util.Dumpable;
+import java.io.PrintStream;
-        implements NodeStateListener {
+        implements NodeStateListener, Dumpable {
+     * Dump contents of path map and elements included to <code>PrintStream</code> given.
+     *
+     * @param ps print stream to dump to
+     */
+    public void dump(final PrintStream ps) {
+        pathCache.traverse(new PathMap.ElementVisitor() {
+            public void elementVisited(PathMap.Element element) {
+                StringBuffer line = new StringBuffer();
+                for (int i = 0; i < element.getDepth(); i++) {
+                    line.append("--");
+                }
+                line.append(element.getName());
+                int index = element.getIndex();
+                if (index != 0 && index != 1) {
+                    line.append('[');
+                    line.append(index);
+                    line.append(']');
+                }
+                line.append("  ");
+                line.append(element.get());
+                ps.println(line.toString());
+            }
+        }, true);
+    }
+
+    /**
