JCR-4536: spi2dav: allow disabling cert and host name checks for TLS connections (also adds test coverage for proxy config)

patch by Konrad Windszus (kwin)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1879988 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.spi2dav.ConnectionOptions;
- * for creating {@link RepositoryServiceImpl} instances.
+ * for creating {@link RepositoryServiceImpl} instances which communicate via <a href="https://jackrabbit.apache.org/archive/wiki/JCR/RemoteAccess_115513494.html#RemoteAccess-DavEx">DavEx</a>.
+ * All parameter keys defined in this class and in addition the ones from {@link ConnectionOptions} 
+ * are supported as arguments for {@link #createRepositoryService(Map)}.
+     * Rather use {@link ConnectionOptions#PARAM_MAX_CONNECTIONS} instead.
-        int maximumHttpConnections = 0;
-            // max connections config
-            param = parameters.get(PARAM_MAX_CONNECTIONS);
-            if (param != null) {
-                try {
-                    maximumHttpConnections = Integer.parseInt(param.toString());
-                } catch ( NumberFormatException e ) {
-                    // using default
-                }
-            }
-
-        if (maximumHttpConnections > 0) {
-            return new RepositoryServiceImpl(uri, workspaceNameDefault, brc, itemInfoCacheSize, maximumHttpConnections);
-        } else {
-            return new RepositoryServiceImpl(uri, workspaceNameDefault, brc, itemInfoCacheSize);
-        }
+        return new RepositoryServiceImpl(uri, workspaceNameDefault, brc, itemInfoCacheSize, ConnectionOptions.fromServiceFactoryParameters(parameters));
