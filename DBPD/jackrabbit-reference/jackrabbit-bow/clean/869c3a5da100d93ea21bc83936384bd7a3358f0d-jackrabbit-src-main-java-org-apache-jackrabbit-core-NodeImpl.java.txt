JCR-423 Node.restore() fails for existing non-versioned OPV=Version child nodes

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@398968 13f79535-47bb-0310-9956-ffa450edef68

-                if (n.getDefinition().getOnParentVersion() == OnParentVersionAction.COPY
-                        || n.getDefinition().getOnParentVersion() == OnParentVersionAction.VERSION) {
-                    // only remove OPV=Copy or OPV=Version nodes
+                if (n.getDefinition().getOnParentVersion() == OnParentVersionAction.COPY) {
+                    // only remove OPV=Copy nodes
-                    if (n.getParent().isSame(this)) {
-                        // so order at end
-                        // orderBefore(n.getName(), "");
-                    } else if (removeExisting) {
+                    if (removeExisting) {
+                    } else if (n.getParent().isSame(this)) {
+                        n.internalRemove(true);
-                } else {
+                }
+                if (!itemMgr.itemExists(nodeId)) {
