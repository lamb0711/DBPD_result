JCR-1590: JSR 283: Locking

- move lock token handling from Session to LockManager.java
- add more tests
- adjust tests in jcr2spi 

TODO:
- sessionscoped locks still expose the lock token
- fixing that needs some more adjustments in jcr2spi and the spi
- timeout handling

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@736658 13f79535-47bb-0310-9956-ffa450edef68

- * @see org.apache.jackrabbit.api.jsr283.Workspace#getLockManager()
+ * @see javax.jcr.Workspace#getLockManager()
-        // TODO
-        throw new UnsupportedRepositoryOperationException("Not yet implemented");
+        if (!lockTokens.contains(lockToken)) {
+            systemLockMgr.lockTokenAdded(session, lockToken);
+        } else {
+            log.debug("Lock token already present with session -> no effect.");
+        }
-        // TODO
-        throw new UnsupportedRepositoryOperationException("Not yet implemented");
+        if (lockTokens.contains(lockToken)) {
+            systemLockMgr.lockTokenRemoved(session, lockToken);
+        } else {
+            throw new LockException("Lock token " + lockToken + " not present with session.");
+        }
+     *
+     * @param lockToken
+     * @return
+     */
+    boolean lockTokenAdded(String lockToken) {
+        synchronized (lockTokens) {
+            return lockTokens.add(lockToken);
+        }
+    }
+
+    /**
+     * 
+     * @param lockToken
+     * @return
+     */
+    boolean lockTokenRemoved(String lockToken) {
+        synchronized (lockTokens) {
+            return lockTokens.remove(lockToken);
+        }
+    }
+
+    /**
