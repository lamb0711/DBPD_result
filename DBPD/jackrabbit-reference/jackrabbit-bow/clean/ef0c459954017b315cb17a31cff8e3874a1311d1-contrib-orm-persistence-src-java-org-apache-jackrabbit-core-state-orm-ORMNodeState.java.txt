applied patch supplied by serge as-is


git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@202167 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.core.state.NodeState.PropertyEntry;
-        Iterator propertyEntryIter = state.getPropertyEntries().iterator();
-        while (propertyEntryIter.hasNext()) {
-            PropertyEntry curPropertyEntry = (PropertyEntry) propertyEntryIter.next();
-            log.debug("propertyEntry " + curPropertyEntry.getName());
-            ORMPropertyEntry propertyEntry = new ORMPropertyEntry(this, curPropertyEntry, uuid);
+        Iterator propertyNameIter = state.getPropertyNames().iterator();
+        while (propertyNameIter.hasNext()) {
+            QName curPropertyName = (QName) propertyNameIter.next();
+            log.debug("propertyEntry " + curPropertyName);
+            ORMPropertyEntry propertyEntry = new ORMPropertyEntry(this, curPropertyName, uuid);
-        Iterator parentIter = state.getParentUUIDs().iterator();
-        while (parentIter.hasNext()) {
-            String parentId = (String) parentIter.next();
-            getParentUUIDs().add(new ORMNodeParent(this, uuid, parentId));
-        }
-            state.addPropertyEntry(QName.valueOf(curPropertyEntry.getName()));
+            state.addPropertyName(QName.valueOf(curPropertyEntry.getName()));
-        Iterator parentUUIDIter = getParentUUIDs().iterator();
-        List nParentUUIDs = new ArrayList();
-        while (parentUUIDIter.hasNext()) {
-            ORMNodeParent curNodeParent = (ORMNodeParent) parentUUIDIter.next();
-            nParentUUIDs.add(curNodeParent.getParentUUID());
-        }
-        state.setParentUUIDs(nParentUUIDs);
