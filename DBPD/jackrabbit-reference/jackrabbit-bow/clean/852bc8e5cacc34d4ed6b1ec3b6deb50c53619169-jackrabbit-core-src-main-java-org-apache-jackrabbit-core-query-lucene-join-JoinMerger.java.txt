JCR-2715: Improved join query performance

Add support for offset and limit on join queries.
Better handling of queries with too many or clauses.
Various smaller improvements.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1024211 13f79535-47bb-0310-9956-ffa450edef68

-            RowIterator leftRows, RowIterator rightRows)
+            RowIterator leftRows, RowIterator rightRows, long offset, long limit)
+        while ((offset-- > 0 || limit == 0) && joinRows.hasNext()) {
+            joinRows.nextRow();
+        }
+        if (limit > 0) {
+            List<Row> rows = new ArrayList<Row>((int) limit);
+            for (int i = 0; i < limit && joinRows.hasNext(); i++) {
+                rows.add(joinRows.nextRow());
+            }
+            joinRows = new RowIteratorAdapter(rows);
+        }
-    public abstract Constraint getRightJoinConstraint(List<Row> leftRows)
+    public abstract List<Constraint> getRightJoinConstraints(List<Row> leftRows)
