JCR-2170: Remove PropDefId and NodeDefId
- merged changes from sandbox branch

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@816343 13f79535-47bb-0310-9956-ffa450edef68

-import java.util.List;
-import java.util.ArrayList;
+import java.util.Set;
+import java.util.HashSet;
+import org.apache.jackrabbit.spi.commons.name.NameConstants;
-    private List<Name> requiredPrimaryTypes;
+    private Set<Name> requiredPrimaryTypes = new HashSet<Name>();
-        if (requiredPrimaryTypes == null) {
-            requiredPrimaryTypes = new ArrayList<Name>();
-        }
-        if (names == null) {
-            requiredPrimaryTypes = null;
-        } else {
-            requiredPrimaryTypes = new ArrayList<Name>(Arrays.asList(names));
+        requiredPrimaryTypes.clear();
+        if (names != null) {
+            requiredPrimaryTypes.addAll(Arrays.asList(names));
-        if (requiredPrimaryTypes == null) {
-            return null;
+        if (requiredPrimaryTypes.isEmpty()) {
+            return new Name[]{NameConstants.NT_BASE};
-        return new QNodeDefinitionImpl(getName(), getDeclaringNodeType(), getAutoCreated(), getMandatory(), getOnParentVersion(), getProtected(), getDefaultPrimaryType(), getRequiredPrimaryTypes(), getAllowsSameNameSiblings());
+        return new QNodeDefinitionImpl(getName(), getDeclaringNodeType(),
+                getAutoCreated(), getMandatory(), getOnParentVersion(),
+                getProtected(), getDefaultPrimaryType(),
+                getRequiredPrimaryTypes(), getAllowsSameNameSiblings());
