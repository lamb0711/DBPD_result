JCR-890: concurrent read-only access to a session

Inline NodeTypeInstanceHandler into NodeState to avoid the extra instance variable in SessionImpl

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@985273 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.spi.QPropertyDefinition;
+import javax.jcr.RepositoryException;
+     * Sets the system-generated or node type -specified default values
+     * of this property. If such values are not specified, then this property
+     * is not modified.
+     * 
+     * @param parent parent node state
+     * @param def property definition
+     * @param userId user identifier associated with the current session
+     * @throws RepositoryException if the default values could not be created 
+     */
+    public void setDefaultValues(
+            NodeState parent, QPropertyDefinition def, String userId)
+            throws RepositoryException {
+        InternalValue[] values = parent.computeGeneratedValues(def, userId);
+        if (values == null) {
+            values = InternalValue.create(def.getDefaultValues());
+        }
+        if (values != null) {
+            setValues(values);
+        }
+    }
+
+    /**
