JCR-2106 SystemSessions created for GarbageCollector are not logged out

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@773555 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.SessionListener;
-    public GarbageCollector(SessionImpl session, IterablePersistenceManager[] list, Session[] sessionList) {
+    public GarbageCollector(final SessionImpl session, IterablePersistenceManager[] list, final Session[] sessionList) {
+        
+        // log out each session as soon as the main session logs out
+        session.addListener(new SessionListener() {
+            public void loggedOut(SessionImpl session) {
+                for (Session s: sessionList) {
+                    s.logout();
+                }
+            }
+            public void loggingOut(SessionImpl session) {
+            }
+        });
