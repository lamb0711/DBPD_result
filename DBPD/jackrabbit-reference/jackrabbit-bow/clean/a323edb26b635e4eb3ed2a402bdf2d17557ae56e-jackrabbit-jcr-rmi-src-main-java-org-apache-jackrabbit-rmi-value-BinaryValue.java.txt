JCR-665 RMI: Property.getValue() fails with EOFException after many reads


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@483415 13f79535-47bb-0310-9956-ffa450edef68

-     * @throws IOException If an error occurrs writing the binary data.
+     * @throws IOException If an error occurs writing the binary data.
-            out.writeInt(bytes);
-            out.write(buffer, 0, bytes);
+            if (bytes > 0) {
+                // just to ensure that no 0 is written
+                out.writeInt(bytes);
+                out.write(buffer, 0, bytes);
+            }
+        // close stream
+        stream.close();
-     * @throws IOException If an error occurrs reading the binary data.
+     * @throws IOException If an error occurs reading the binary data.
