- adapting to latest jackrabbit changes

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@209471 13f79535-47bb-0310-9956-ffa450edef68

-                AbstractImportCommand.mkDirs(context, parentNode, Text.makeValidJCRPath(entry.getName()));
+                AbstractImportCommand.mkDirs(context, parentNode, makeValidJCRPath(entry.getName()));
-                String path = Text.makeValidJCRPath(entry.getName());
+                String path = makeValidJCRPath(entry.getName());
-                subctx.setSystemId(Text.getLabel(path));
+                subctx.setSystemId(Text.getName(path));
+
+    /**
+     * Creates a valid jcr label from the given one
+     *
+     * @param label
+     * @return
+     */
+    public static String makeValidJCRPath(String label) {
+        StringBuffer ret = new StringBuffer(label.length());
+        for (int i=0; i<label.length(); i++) {
+            char c = label.charAt(i);
+            if (c=='*' || c=='\'' || c=='\"') {
+                c='_';
+            } else if (c=='[') {
+                c='(';
+            } else if (c==']') {
+                c=')';
+            }
+            ret.append(c);
+        }
+        return ret.toString();
+    }
+
+
