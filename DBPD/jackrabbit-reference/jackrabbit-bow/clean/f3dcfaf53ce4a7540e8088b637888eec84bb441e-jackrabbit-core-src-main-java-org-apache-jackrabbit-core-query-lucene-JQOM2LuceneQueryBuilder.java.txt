JCR-1169 Distribution of commons classes (adjust jackrabbit-core)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@590014 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.name.NameFormat;
-import org.apache.jackrabbit.name.QName;
-import org.apache.jackrabbit.name.Path;
-import org.apache.jackrabbit.name.PathFormat;
+import org.apache.jackrabbit.spi.Name;
+import org.apache.jackrabbit.spi.Path;
+import org.apache.jackrabbit.name.NameConstants;
+import org.apache.jackrabbit.conversion.NamePathResolver;
+     * NamePathResolver to map namespace mappings to internal prefixes
+     */
+    private final NamePathResolver npResolver;
+
+    /**
-     * queries. Key=QName (selectorName).
+     * queries. Key=Name (selectorName).
+        this.npResolver = NamePathResolverImpl.create(nsMappings);
-                stringValue = nsMappings.translatePropertyName(
-                        v.getString(), session.getNamespaceResolver());
+                Name n = session.getQName(v.getString());
+                stringValue = nsMappings.translatePropertyName(n);
-                Path p = PathFormat.parse(v.getString(), session.getNamespaceResolver());
-                stringValue = PathFormat.format(p, nsMappings);
+                Path p = session.getQPath(v.getString());
+                stringValue = npResolver.getJCRPath(p);
-                String propName = NameFormat.format(node.getPropertyQName(), nsMappings);
+                String propName = npResolver.getJCRName(node.getPropertyQName());
-            QName propName = node.getPropertyQName();
+            Name propName = node.getPropertyQName();
-        String propName = NameFormat.format(node.getPropertyQName(), nsMappings);
+        String propName = npResolver.getJCRName(node.getPropertyQName());
-        String mixinTypesField = NameFormat.format(QName.JCR_MIXINTYPES, nsMappings);
-        String primaryTypeField = NameFormat.format(QName.JCR_PRIMARYTYPE, nsMappings);
+        String mixinTypesField = npResolver.getJCRName(NameConstants.JCR_MIXINTYPES);
+        String primaryTypeField = npResolver.getJCRName(NameConstants.JCR_PRIMARYTYPE);
-                            NameFormat.format(node.getNodeTypeQName(), nsMappings)));
+                            npResolver.getJCRName(node.getNodeTypeQName())));
-                            NameFormat.format(node.getNodeTypeQName(), nsMappings)));
+                            npResolver.getJCRName(node.getNodeTypeQName())));
-                    String ntName = nsMappings.translatePropertyName(nt.getName(),
-                            session.getNamespaceResolver());
+                    Name n = session.getQName(nt.getName());
+                    String ntName = nsMappings.translatePropertyName(n);
