JCR-3658: MembershipCache not consistently synchronized

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1519376 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.security.SystemPrincipal;
-        /* shortcut if the subject contains the AdminPrincipal in which case
-           the userID is already known. */
+        // shortcut if the subject contains the AdminPrincipal or
+        // SystemPrincipal in which cases the userID is already known.
+        } else if (!subject.getPrincipals(SystemPrincipal.class).isEmpty()) {
+            // system session does not have a userId
+            return null;
+
