assert that versionState used for restore/merge is obtained from the hierarchy belonging to 'this' session.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@515161 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.jcr2spi.version.VersionImpl;
-        if (version instanceof VersionImpl) {
-            NodeState versionState = ((NodeImpl)version).getNodeState();
-            session.getVersionManager().resolveMergeConflict(getNodeState(), versionState, done);
-        } else {
-            throw new RepositoryException("Incompatible Version object: " + version.getPath());
-        }
+        NodeState versionState = session.getVersionState(version);
+        session.getVersionManager().resolveMergeConflict(getNodeState(), versionState, done);
-        if (version instanceof VersionImpl) {
-            NodeState versionState = ((NodeImpl)version).getNodeState();
-            session.getVersionManager().restore(targetNode.getNodeState(), relQPath, versionState, removeExisting);
-        } else {
-            throw new RepositoryException("Incompatible Version object: " + version.getPath());
-        }
+        NodeState versionState = session.getVersionState(version);
+        session.getVersionManager().restore(targetNode.getNodeState(), relQPath, versionState, removeExisting);
