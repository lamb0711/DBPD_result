JCR-178: Allow concurrent index updates and queries

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@232801 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.Iterator;
+     * Updates the index in an atomic operation. Some nodes may be removed and
+     * added again in the same updateNodes() call, which is equivalent to an
+     * node update.
+     *
+     * @param remove Iterator of uuid <code>String</code>s of nodes to delete
+     * @param add    Iterator of <code>NodeState</code> instance to add to the
+     *               index.
+     * @throws RepositoryException if an error occurs while indexing a node.
+     * @throws IOException if an error occurs while updating the index.
+     */
+    void updateNodes(Iterator remove, Iterator add)
+            throws RepositoryException, IOException;
+
+    /**
