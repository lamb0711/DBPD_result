Upgraded to Lucene 1.4.3 and implemented order by in queries

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@148868 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.NoPrefixDeclaredException;
+import org.apache.lucene.search.SortField;
+import org.apache.lucene.search.Sort;
-        /*
-            sortFields[i] = new SortField(orderProps[i], SortField.STRING, !ascending);
+            String prop = null;
+            try {
+                prop = orderProps[i].toJCRName(nsMappings);
+            } catch (NoPrefixDeclaredException e) {
+                // will never happen
+            }
+            sortFields[i] = new SortField(prop, SortField.STRING, !orderSpecs[i]);
-*/
+
-            hits = persistentIndex.getIndexSearcher().search(query
-                    /*, new Sort(sortFields) */);
+            if (sortFields.length > 0) {
+                hits = persistentIndex.getIndexSearcher().search(query,
+                        new Sort(sortFields));
+            } else {
+                hits = persistentIndex.getIndexSearcher().search(query);
+            }
