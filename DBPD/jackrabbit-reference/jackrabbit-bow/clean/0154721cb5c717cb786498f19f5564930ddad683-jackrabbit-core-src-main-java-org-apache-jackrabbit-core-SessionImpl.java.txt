JCR-2895 - SessionImpl#getSubject() should return an unmodifiable subject

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1072069 13f79535-47bb-0310-9956-ffa450edef68

-                getSubject(),
+                subject,
-     * Returns the <code>Subject</code> associated with this session.
+     * Returns a read only copy of the <code>Subject</code> associated with this
+     * session.
-     * @return the <code>Subject</code> associated with this session
+     * @return a read only copy of <code>Subject</code> associated with this session
-        return subject;
+        Subject readOnly = new Subject(true, subject.getPrincipals(), subject.getPublicCredentials(), subject.getPrivateCredentials());
+        return readOnly;
-        Subject old = getSubject();
-        Subject newSubject = new Subject(old.isReadOnly(), old.getPrincipals(), old.getPublicCredentials(), old.getPrivateCredentials());
+        Subject newSubject = new Subject(subject.isReadOnly(), subject.getPrincipals(), subject.getPublicCredentials(), subject.getPrivateCredentials());
