JCR-2423: Make Jackrabbit repository DTD easier to extend

Add hooks that make it easier for subclasses to customize the config parsing.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@887168 13f79535-47bb-0310-9956-ffa450edef68

+import org.xml.sax.EntityResolver;
+import org.xml.sax.ErrorHandler;
+     * Returns the error handler to be used when parsing configuration
+     * documents. Subclasses can override this method to provide custom
+     * error handling.
+     *
+     * @since Apache Jackrabbit 2.0
+     * @return error handler
+     */
+    protected ErrorHandler getErrorHandler() {
+        return new ConfigurationErrorHandler();
+    }
+
+    /**
+     * Returns the entity resolver to be used when parsing configuration
+     * documents. Subclasses can override this method to provide custom
+     * entity resolution rules.
+     *
+     * @since Apache Jackrabbit 2.0
+     * @return error handler
+     */
+    protected EntityResolver getEntityResolver() {
+        return ConfigurationEntityResolver.INSTANCE;
+    }
+
+    /**
+     * A post-processing hook for the parsed repository or workspace
+     * configuration documents. This hook makes it possible to make custom
+     * DOM modifications for backwards-compatibility or other reasons.
+     *
+     * @since Apache Jackrabbit 2.0
+     * @param document the parsed configuration document
+     * @return the configuration document after any modifications
+     */
+    protected Document postParseModificationHook(Document document) {
+        return document;
+    }
+
+    /**
-     * @param validate wheter the XML should be validated
+     * @param validate whether the XML should be validated
-                builder.setErrorHandler(new ConfigurationErrorHandler());
+                builder.setErrorHandler(getErrorHandler());
-            builder.setEntityResolver(ConfigurationEntityResolver.INSTANCE);
+            builder.setEntityResolver(getEntityResolver());
-            return document.getDocumentElement();
+            return postParseModificationHook(document).getDocumentElement();
