JCR-411: Binding repository to a nameserver with RegistryHelper causes failure on lookup.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@397583 13f79535-47bb-0310-9956-ffa450edef68

+import javax.jcr.RepositoryException;
+    /**
+     * Creates an initialized BindableRepository instance using the given
+     * configuration information and puts it in {@link #cache}.
+     *
+     * @param configFilePath repository configuration file path
+     * @param repHomeDir     repository home directory path
+     * @return initialized repository instance
+     * @throws RepositoryException if the repository cannot be created
+     */
+    static BindableRepository createInstance(String configFilePath, String repHomeDir)
+            throws RepositoryException {
+        BindableRepository rep = BindableRepository.create(configFilePath, repHomeDir);
+        cache.put(rep.getReference(), rep);
+        return rep;
+    }
+
-                    BindableRepository rep = BindableRepository.create(configFilePath, repHomeDir);
-                    cache.put(ref, rep);
-                    return rep;
+                    return createInstance(configFilePath, repHomeDir);
