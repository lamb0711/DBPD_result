JCR-3140 : Add configurable hook for password validation

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1199635 13f79535-47bb-0310-9956-ffa450edef68

-            onCreate(user);
+            onCreate(user, password);
-     * tasks associated with the creation of the new authorizable before the
+     * tasks associated with the creation of the new user before the
-     * @param authorizable The new authorizable.
+     * @param user The new user.
+     * @param pw The password.
-    void onCreate(Authorizable authorizable) throws RepositoryException {
+    private void onCreate(User user, String pw) throws RepositoryException {
-            action.onCreate(authorizable, session);
+            action.onCreate(user, pw, session);
+        }
+    }
+
+    /**
+     * Let the configured <code>AuthorizableAction</code>s perform additional
+     * tasks associated with the creation of the new group before the
+     * corresponding new node is persisted.
+     *
+     * @param group The new group.
+     * @throws RepositoryException If an exception occurs.
+     */
+    private void onCreate(Group group) throws RepositoryException {
+        for (AuthorizableAction action : authorizableActions) {
+            action.onCreate(group, session);
+    /**
+     * Let the configured <code>AuthorizableAction</code>s perform additional
+     * tasks associated with password changing of a given user before the
+     * corresponding property is being changed.
+     *
+     * @param user The target user.
+     * @param password The new password.
+     * @throws RepositoryException If an exception occurs.
+     */
+    void onPasswordChange(User user, String password) throws RepositoryException {
+        for (AuthorizableAction action : authorizableActions) {
+            action.onPasswordChange(user, password, session);
+        }
+    }
+
