JCR-805: Introduce a temprary cache for intermediate query results

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@520878 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.commons.collections.map.LRUMap;
-import java.util.WeakHashMap;
+import java.util.HashMap;
-     * Simple result cache for previously calculated hits.
-     * key=IndexReader value=Map{key=String:range,value=BitSet:hits}
-     */
-    private static final Map cache = new WeakHashMap();
-
-    /**
-            synchronized (cache) {
-                Map m = (Map) cache.get(reader);
+            PerQueryCache cache = PerQueryCache.getInstance();
+            Map m = (Map) cache.get(RangeQueryScorer.class, reader);
-                    m = new LRUMap(10);
-                    cache.put(reader, m);
+                m = new HashMap();
+                cache.put(RangeQueryScorer.class, reader, m);
-            }
-            synchronized (resultMap) {
+
-        }
