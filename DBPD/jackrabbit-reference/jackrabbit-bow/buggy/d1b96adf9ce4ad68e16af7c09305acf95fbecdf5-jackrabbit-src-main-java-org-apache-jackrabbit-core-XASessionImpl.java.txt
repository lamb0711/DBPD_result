JCR-619: CacheManager (Memory Management in Jackrabbit)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@475223 13f79535-47bb-0310-9956-ffa450edef68

-         * entire transaction from deadlocks (see JCR-335) 
+         * entire transaction from deadlocks (see JCR-335)
-        return new XAVersionManager(vMgr, rep.getNodeTypeRegistry(), this);
+        return new XAVersionManager(vMgr, rep.getNodeTypeRegistry(), this, rep.getItemStateCacheFactory());
+     * {@inheritDoc}
+     */
+    public synchronized void logout() {
+        super.logout();
+        // dispose the caches
+        try {
+            ((XAVersionManager)versionMgr).close();
+        } catch(Exception e) {
+            log.warn("error while closing XAVersionManager", e);
+        }
+    }
+
+    /**
