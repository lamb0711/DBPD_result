JCR-2640: Internal repository context

Decouple SessionImpl from the details of workspace and data store handling in RepositoryImpl.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@948851 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.core.SessionImpl;
-import org.apache.jackrabbit.core.SessionListener;
-    private SessionListener sessionListener;
-     * @param session the session that created this object (optional)
-            DataStore dataStore, SessionImpl session,
-            IterablePersistenceManager[] list, Session[] sessionList) {
+            DataStore dataStore, IterablePersistenceManager[] list,
+            Session[] sessionList) {
-
-        if (session != null) {
-            // Auto-close if the main session logs out
-            this.sessionListener = new SessionListener() {
-                public void loggedOut(SessionImpl session) {
-                }
-                public void loggingOut(SessionImpl session) {
-                    close();
-                }
-            };
-            session.addListener(sessionListener);
-        }
