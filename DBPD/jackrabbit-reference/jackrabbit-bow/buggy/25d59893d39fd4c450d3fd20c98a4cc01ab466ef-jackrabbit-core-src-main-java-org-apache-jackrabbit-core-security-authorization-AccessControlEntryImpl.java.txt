JCR-1588: Access Control

- use valuefactory from session rather that ValueFactoryImpl

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@758265 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.value.ValueFactoryImpl;
-    private static final ValueFactory VALUE_FACTORY = ValueFactoryImpl.getInstance();
-
+     * Value factory
+     */
+    private final ValueFactory valueFactory;
+
+    /**
-        this(principal, privileges, true, null);
+        this(principal, privileges, true, null, null);
+     * @param valueFactory the value factory.
-                                     boolean isAllow, Map restrictions)
+                                     boolean isAllow, Map restrictions, ValueFactory valueFactory)
+        this.valueFactory = valueFactory;
+        
-                    value = ValueHelper.copy((Value) v, VALUE_FACTORY);
+                    value = ValueHelper.copy((Value) v, valueFactory);
-
+    
-            return ValueHelper.copy((Value) restrictions.get(restrictionName), VALUE_FACTORY);
+            return ValueHelper.copy((Value) restrictions.get(restrictionName), valueFactory);
