JCR-1904: Event user data

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@724300 13f79535-47bb-0310-9956-ffa450edef68

+import javax.jcr.RepositoryException;
+
-        return new EventStateCollection(this, session, pathPrefix);
+        String userData = null;
+        try {
+            userData = ((ObservationManagerImpl) session.getWorkspace().getObservationManager()).getUserData();
+        } catch (RepositoryException e) {
+            // should never happen because this
+            // implementation supports observation
+        }
+        return new EventStateCollection(this, session, pathPrefix, userData);
-        dispatch(events.getEvents(), events.getSession(), events.getPathPrefix());
+        dispatch(events.getEvents(), events.getSession(),
+                events.getPathPrefix(), events.getUserData());
+     * @param userData the user data
-    public void dispatch(List eventList, SessionImpl session, Path pathPrefix) {
+    public void dispatch(List eventList, SessionImpl session,
+                         Path pathPrefix, String userData) {
-                    new EventStateCollection(disp[i], session, pathPrefix);
+                    new EventStateCollection(disp[i], session,
+                            pathPrefix, userData);
