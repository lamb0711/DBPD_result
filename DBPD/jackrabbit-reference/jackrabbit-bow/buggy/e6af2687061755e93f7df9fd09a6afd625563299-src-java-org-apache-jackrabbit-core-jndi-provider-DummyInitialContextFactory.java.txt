- simplified version manager
- fixing context factory

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@123974 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.HashMap;
+    private static HashMap contexts = new HashMap();
-        return new DummyContext(environment);
+
+	String url = (String) environment.get(Context.PROVIDER_URL);
+	if (url==null) {
+	    throw new NamingException("Unable to create context. Environment is missing a " + Context.PROVIDER_URL);
+	}
+
+	synchronized (DummyInitialContextFactory.contexts) {
+	    DummyContext ctx = (DummyContext) contexts.get(url);
+	    if (ctx==null) {
+		ctx = new DummyContext(environment);
+		contexts.put(url, ctx);
+	    }
+	    return ctx;
+	}
