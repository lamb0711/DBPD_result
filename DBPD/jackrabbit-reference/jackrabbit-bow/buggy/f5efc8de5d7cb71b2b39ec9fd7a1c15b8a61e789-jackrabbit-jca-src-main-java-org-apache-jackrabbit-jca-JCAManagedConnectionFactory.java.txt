JCR-555: Improved reusability of the JCA package

Merge the classpath: repository config code from jca to core. Streamline the remaining jca code.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@923678 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.HashMap;
+import java.util.Map;
+import org.apache.jackrabbit.commons.JcrUtils;
-     * Home directory.
+     * Repository parameters.
-    private String homeDir;
-
-    /**
-     * Config file.
-     */
-    private String configFile;
+    private final Map<String, String> parameters = new HashMap<String, String>();
+     * Return the repository URI.
+     */
+    public String getRepositoryURI() {
+        return parameters.get(JcrUtils.REPOSITORY_URI);
+    }
+
+    /**
+     * Set the repository URI.
+     */
+    public void setRepositoryURI(String uri) {
+        parameters.put(JcrUtils.REPOSITORY_URI, uri);
+    }
+
+    /**
-        return homeDir;
+        return parameters.get("org.apache.jackrabbit.repository.home");
-    public void setHomeDir(String homeDir) {
-        this.homeDir = homeDir;
+    public void setHomeDir(String home) {
+        parameters.put("org.apache.jackrabbit.repository.home", home);
-        return configFile;
+        return parameters.get("org.apache.jackrabbit.repository.conf");
-    public void setConfigFile(String configFile) {
-        this.configFile = configFile;
+    public void setConfigFile(String conf) {
+        parameters.put("org.apache.jackrabbit.repository.conf", conf);
-                    if (equals(cri, otherCri)) {
+                    if (cri == otherCri || (cri != null && cri.equals(otherCri))) {
-        int result = homeDir != null ? homeDir.hashCode() : 0;
-        result = 37 * result + (configFile != null ? configFile.hashCode() : 0);
-        return result;
+        return parameters.hashCode();
-        return equals(homeDir, o.homeDir)
-            && equals(configFile, o.configFile);
-    }
-
-    /**
-     * Return true if equals.
-     */
-    private boolean equals(Object o1, Object o2) {
-        if (o1 == o2) {
-            return true;
-        } else if ((o1 == null) || (o2 == null)) {
-            return false;
-        } else {
-            return o1.equals(o2);
-        }
+        return parameters.equals(o.parameters);
-            // Check the home directory
-            if ((homeDir == null) || homeDir.equals("")) {
-                throw new ResourceException("Property 'homeDir' not set");
-            }
-
-            // Check the config file
-            if ((configFile == null) || configFile.equals("")) {
-                throw new ResourceException("Property 'configFile' not set");
-            }
-
-                repository = mgr.createRepository(homeDir, configFile);
+                repository = mgr.createRepository(parameters);
-        mgr.autoShutdownRepository(homeDir, configFile);
+        mgr.autoShutdownRepository(parameters);
