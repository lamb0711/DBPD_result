JCR-2887 : Split PrivilegeRegistry in a per-session manager instance and a repository level registry [work in progress]
JCR-2774 : Access control for repository level API operations


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1177668 13f79535-47bb-0310-9956-ffa450edef68

-        if (AccessControlConstants.N_POLICY.equals(protectedParent.getQName())
-                && protectedParent.isNodeType(AccessControlConstants.NT_REP_ACL)) {
+        if (isPolicyNode(protectedParent)) {
+    private static boolean isPolicyNode(NodeImpl node) throws RepositoryException {
+        Name nodeName = node.getQName();
+        return (AccessControlConstants.N_POLICY.equals(nodeName) || AccessControlConstants.N_REPO_POLICY.equals(nodeName))
+                && node.isNodeType(AccessControlConstants.NT_REP_ACL);
+    }
+
