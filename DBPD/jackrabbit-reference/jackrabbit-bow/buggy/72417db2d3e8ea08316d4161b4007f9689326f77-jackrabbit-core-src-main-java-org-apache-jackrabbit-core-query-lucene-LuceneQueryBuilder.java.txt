JCR-1104: JSR 283 support
- query (work in progress)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@643414 13f79535-47bb-0310-9956-ffa450edef68

-                Query refPropQuery = createMatchAllQuery(refProperty);
+                Query refPropQuery = Util.createMatchAllQuery(refProperty, indexFormatVersion);
-                        query = createMatchAllQuery(field);
+                        query = Util.createMatchAllQuery(field, indexFormatVersion);
-                    notQuery.add(createMatchAllQuery(field), Occur.SHOULD);
+                    notQuery.add(Util.createMatchAllQuery(field, indexFormatVersion), Occur.SHOULD);
-                    notQuery.add(createMatchAllQuery(field), Occur.SHOULD);
+                    notQuery.add(Util.createMatchAllQuery(field, indexFormatVersion), Occur.SHOULD);
-                    query = new NotQuery(createMatchAllQuery(field));
+                    query = new NotQuery(Util.createMatchAllQuery(field, indexFormatVersion));
-                    query = createMatchAllQuery(field);
+                    query = Util.createMatchAllQuery(field, indexFormatVersion);
-                    query = createMatchAllQuery(field);
+                    query = Util.createMatchAllQuery(field, indexFormatVersion);
-
-    /**
-     * Depending on the index format this method returns
-     * a query that matches all nodes that have a property named 'field'
-     *
-     * @param field
-     * @return Query that matches all nodes that have a property named 'field'
-     */
-    private Query createMatchAllQuery(String field) {
-        if (indexFormatVersion.getVersion() >= IndexFormatVersion.V2.getVersion()) {
-            // new index format style
-            return new TermQuery(new Term(FieldNames.PROPERTIES_SET, field));
-        } else {
-            return new MatchAllQuery(field);
-        }
-    }
