JCR-3476 only extract binary values when parser supports extracting them

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1416552 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.tika.mime.MediaType;
+     * The media types supported by the parser used.
+     */
+    private Set<MediaType> supportedMediaTypes;
+
+    /**
-     * using the {@link #extractor}.
+     * using the {@link #parser}.
-            if (type != null) {
+            if (type != null && isSupportedMediaType(type.getString())) {
-     * @deprecated Use {@link #addStringValue(Document, String, Object, boolean)
+     * @deprecated Use {@link #addStringValue(Document, String, String, boolean)
-     * @deprecated use {@link #addStringValue(Document, String, Object, boolean, boolean, float, boolean)} instead.
+     * @deprecated use {@link #addStringValue(Document, String, String, boolean, boolean, float, boolean)} instead.
+     * Returns <code>true</code> if the provided type is among the types
+     * supported by the Tika parser we are using.
+     *
+     * @param type  the type to check.
+     * @return whether the type is supported by the Tika parser we are using.
+     */
+    protected boolean isSupportedMediaType(final String type) {
+        if (supportedMediaTypes == null) {
+            supportedMediaTypes = parser.getSupportedTypes(null);
+        }
+        return supportedMediaTypes.contains(MediaType.parse(type));
+    }
+
+    /**
