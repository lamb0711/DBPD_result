JCR-3816: [aws-ext]S3DS not able update lastModified of record > 5GB
JCR-3817: [jackrabbit-aws-ext] Performance of operation degrades while running DS GC

Applying patch from Shashank Gupta

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1632482 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.core.data.AsyncUploadCallback;
-import org.apache.jackrabbit.core.data.Backend;
-import org.apache.jackrabbit.core.data.CachingDataStore;
-import org.apache.jackrabbit.core.data.DataIdentifier;
-import org.apache.jackrabbit.core.data.DataStoreException;
-
+    
+    private CachingDataStore store;
+        this.store = store;
-            if (timestamp < min) {
+            if (timestamp < min && !store.isInUse(identifier)
+                && store.confirmDelete(identifier)) {
+    
+    @Override
+    public void touch(DataIdentifier identifier, long minModifiedDate) {
+        timeMap.put(identifier, System.currentTimeMillis());
+    }
+
+    @Override
+    public void touchAsync(DataIdentifier identifier, long minModifiedDate,
+            AsyncTouchCallback callback) {
+        timeMap.put(identifier, System.currentTimeMillis());
+        callback.onSuccess(new AsyncTouchResult(identifier));
+    }
