- comitting latest changes from angela
- adding configuration for authorization header behaviour

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@159798 13f79535-47bb-0310-9956-ffa450edef68

-     * A session will not be available if credentials can not be found
-     * in the request (meaning that the  request has not been
-     * authenticated).
+     * A session will not be available if an exception is thrown.
-     * @throws DavException if a problem occurred while obtaining the
-     * session
+     * @throws DavException if a problem occurred while obtaining the session
-            Credentials creds = RepositoryAccessServlet.getCredentialsFromHeader(request.getHeader(DavConstants.HEADER_AUTHORIZATION));
-            if (creds == null) {
-                // generate anonymous login to gain write access
-                creds = new SimpleCredentials("anonymous", "anonymous".toCharArray());
-            }
+            // extract credentials from the auth header. depending of the
+            // configuration of the RepositoryAccessServlet, this could also
+            // throw a login excetpion.
+            Credentials creds = RepositoryAccessServlet.getCredentialsFromHeader(
+                    request.getHeader(DavConstants.HEADER_AUTHORIZATION));
+
+            // login to repository
+        } catch (LoginException e) {
+	    throw new JcrDavException(e);
