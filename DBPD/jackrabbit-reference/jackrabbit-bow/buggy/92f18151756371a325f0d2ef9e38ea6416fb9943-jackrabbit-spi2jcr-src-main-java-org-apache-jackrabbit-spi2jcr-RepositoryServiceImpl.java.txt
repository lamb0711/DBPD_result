JCR-2076: JSR 283: QOM and SQL2
- jcr2spi, spi2dav, spi2jcr implementation (work in progress)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@789307 13f79535-47bb-0310-9956-ffa450edef68

-        return new QueryInfoImpl(query.execute(), idFactory,
+        return new QueryInfoImpl(query, query.execute(), idFactory,
-            for (Iterator<String> it = values.keySet().iterator(); it.hasNext();) {
-                String varName = it.next();
-                Value value = ValueFormat.getJCRValue(values.get(varName), sInfo.getNamePathResolver(), sInfo.getSession().getValueFactory());
-                query.bindValue(varName, value);
+            for (Map.Entry<String, QValue> entry : values.entrySet()) {
+                Value value = ValueFormat.getJCRValue(entry.getValue(), sInfo.getNamePathResolver(), sInfo.getSession().getValueFactory());
+                query.bindValue(entry.getKey(), value);
-        return new QueryInfoImpl(query.execute(), idFactory,
+        return new QueryInfoImpl(query, query.execute(), idFactory,
