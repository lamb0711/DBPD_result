- fixed JCR-47: Node.setProperty(String, String) does not convert values
- fixed QName and Path: namespace prefix must be valid XML NCName
- optimized NodeImpl.internalIsCheckedOut()


git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@154846 13f79535-47bb-0310-9956-ffa450edef68

-        return setProperty(name, values, PropertyType.STRING);
+        /**
+         * if the target property is not of type STRING then a
+         * best-effort conversion is tried
+         */
+        return setProperty(name, values, PropertyType.UNDEFINED);
+        /**
+         * if the target property is not of type STRING then a
+         * best-effort conversion is tried
+         */
-        PropertyImpl prop = getOrCreateProperty(name, PropertyType.STRING, false, status);
+        PropertyImpl prop = getOrCreateProperty(name, PropertyType.UNDEFINED, false, status);
+        /**
+         * try shortcut first: 
+         * if current node is 'new' we can safely consider it checked-out
+         * since otherwise it would had been impossible to add it in the first
+         * place
+         */
+        if (isNew()) {
+            return true;
+        }
+
