JCR-1152: JCR2SPI: use own ValueFactory, wrapping the SPI's QValueFactory: spi-commons: add implementations of ValueFactory wrapping QValueFactory and Value wrapping a QValue. QValueFactoryImpl: Fix conversions that weren't called before. ValueFormat: take advantage of known ValueFactory/Value implementations.


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@590140 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.value.ValueFactoryQImpl;
+    private final ValueFactory valueFactory;
+
+        // build ValueFactory
+        valueFactory = new ValueFactoryQImpl(config.getRepositoryService().getQValueFactory(), npResolver);
+
-        return config.getValueFactory(getNamePathResolver());
+        return valueFactory;
