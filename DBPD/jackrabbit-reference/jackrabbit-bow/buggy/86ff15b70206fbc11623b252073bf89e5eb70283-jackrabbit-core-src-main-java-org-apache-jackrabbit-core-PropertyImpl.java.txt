JCR-926: BLOBFileValue and InternalValue refactoring, improved garbage collector for the global data store

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@570336 13f79535-47bb-0310-9956-ffa450edef68

+            value = InternalValue.createTemporary(stream);
+                Value jcrValue = value.toJCRValue(session.getNamespaceResolver());
-                        new BLOBFileValue(stream), reqType,
-                        ValueFactoryImpl.getInstance());
-                value = InternalValue.create(targetVal, session.getNamespaceResolver());
-            } else {
-                // no type conversion required
-                value = InternalValue.create(stream);
+                        jcrValue, reqType, ValueFactoryImpl.getInstance());
+                value = InternalValue.create(targetVal, session.getNamespaceResolver(), rep.getDataStore());
