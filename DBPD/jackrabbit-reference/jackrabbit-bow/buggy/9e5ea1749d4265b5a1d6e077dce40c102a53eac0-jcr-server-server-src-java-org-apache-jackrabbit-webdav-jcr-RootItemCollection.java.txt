JCR-337 - Remove jcr dependency from dav-library
JCR-343 - Report#init limits the Report interface to DeltaV compliant resources
JCR-340 - ValuesProperty missing property type information
JCR-342 - DavResource#getDavSession() missing
JCR-344 - DeltaVResource lists MKWORKSPACE in the method constant.
JCR-345 - DavException does not allow to specify an exception cause

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@385540 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.webdav.DavSession;
- *
- * @todo currently the jcr root node is the same for all workspace resources... this is wrong...
+//todo currently the jcr root node is the same for all workspace resources... this is wrong...
-    protected RootItemCollection(DavResourceLocator locator, DavSession session,
+    protected RootItemCollection(DavResourceLocator locator, JcrDavSession session,
-                try {
+            try {
-                    NamespaceRegistry nsReg = getRepositorySession().getWorkspace().getNamespaceRegistry();
-                    String[] registeredPrefixes = nsReg.getPrefixes();
-                    for (int i = 0; i < registeredPrefixes.length; i++) {
-                        String prfx = registeredPrefixes[i];
+                NamespaceRegistry nsReg = getRepositorySession().getWorkspace().getNamespaceRegistry();
+                String[] registeredPrefixes = nsReg.getPrefixes();
+                for (int i = 0; i < registeredPrefixes.length; i++) {
+                    String prfx = registeredPrefixes[i];
-                            // prefix not present amongst the new values any more > unregister
-                            nsReg.unregisterNamespace(prfx);
+                        // prefix not present amongst the new values any more > unregister
+                        nsReg.unregisterNamespace(prfx);
-                            // present with same uri-value >> no action required
+                        // present with same uri-value >> no action required
-                        }
-
-                    // try to register any prefix/uri pair that has a changed uri or
-                    // it has not been present before.
-                Iterator prefixIt = changes.keySet().iterator();
-                    while (prefixIt.hasNext()) {
-                        String prefix = (String)prefixIt.next();
-                    String uri = (String)changes.get(prefix);
-                        nsReg.registerNamespace(prefix, uri);
-                    }
-                } catch (RepositoryException e) {
-                    throw new JcrDavException(e);
-            } else {
+
+                // try to register any prefix/uri pair that has a changed uri or
+                // it has not been present before.
+                Iterator prefixIt = changes.keySet().iterator();
+                while (prefixIt.hasNext()) {
+                    String prefix = (String)prefixIt.next();
+                    String uri = (String)changes.get(prefix);
+                    nsReg.registerNamespace(prefix, uri);
+                }
+            } catch (RepositoryException e) {
+                throw new JcrDavException(e);
+            }
+        } else {
