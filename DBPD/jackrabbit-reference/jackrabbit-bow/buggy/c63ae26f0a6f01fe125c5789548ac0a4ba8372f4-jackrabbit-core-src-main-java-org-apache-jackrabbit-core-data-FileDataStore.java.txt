JCR-2087 Upgrade to Java 5 as the base platform

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@771693 13f79535-47bb-0310-9956-ffa450edef68

-    protected Map inUse = Collections.synchronizedMap(new WeakHashMap());
+    protected Map<DataIdentifier, WeakReference<DataIdentifier>> inUse = 
+        Collections.synchronizedMap(new WeakHashMap<DataIdentifier, WeakReference<DataIdentifier>>());
-        inUse.put(identifier, new WeakReference(identifier));
+        inUse.put(identifier, new WeakReference<DataIdentifier>(identifier));
-            File[] list = file.listFiles();
-            for (int i = 0; i < list.length; i++) {
-                count += deleteOlderRecursive(list[i], min);
+            for (File f: file.listFiles()) {
+                count += deleteOlderRecursive(f, min);
+            
-    private void listRecursive(List list, File file) {
-        File[] l = file.listFiles();
-        for (int i = 0; l != null && i < l.length; i++) {
-            File f = l[i];
-            if (f.isDirectory()) {
-                listRecursive(list, f);
-            } else {
-                list.add(f);
+    private void listRecursive(List<File> list, File file) {
+        File[] files = file.listFiles();
+        if (files != null) {
+            for (File f : files) {
+                if (f.isDirectory()) {
+                    listRecursive(list, f);
+                } else {
+                    list.add(f);
+                }
-    public Iterator getAllIdentifiers() {
-        ArrayList files = new ArrayList();
+    public Iterator<DataIdentifier> getAllIdentifiers() {
+        ArrayList<File> files = new ArrayList<File>();
-        ArrayList identifiers = new ArrayList();
-        for (int i = 0; i < files.size(); i++) {
-            File f = (File) files.get(i);
+        ArrayList<DataIdentifier> identifiers = new ArrayList<DataIdentifier>();
+        for (File f: files) {
