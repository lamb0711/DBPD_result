JCR-1564: JSR 283 namespace handling
    - Removed caching and listening of namespace registry in jcr2spi
      as AbstractSession already caches namespaces and JSR 283 removes
      the need to notify sessions about global namespace remappings

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@655573 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.spi.commons.namespace.AbstractNamespaceResolver;
-import org.apache.jackrabbit.spi.commons.namespace.NamespaceListener;
+import java.util.Collection;
+
-public class NamespaceRegistryImpl extends AbstractNamespaceResolver
-    implements NamespaceRegistry {
+public class NamespaceRegistryImpl implements NamespaceRegistry {
-    private final NamespaceCache nsCache;
-     * @param nsCache
-    public NamespaceRegistryImpl(NamespaceStorage storage,
-                                 NamespaceCache nsCache) {
-        // listener support in AbstractNamespaceResolver is not needed
-        // because we delegate listeners to NamespaceCache
-        super(false);
+    public NamespaceRegistryImpl(NamespaceStorage storage) {
-        this.nsCache = nsCache;
+
-        nsCache.registerNamespace(storage, prefix, uri);
+        storage.registerNamespace(prefix, uri);
-        nsCache.unregisterNamespace(storage, prefix);
+        storage.unregisterNamespace(prefix);
-        return nsCache.getPrefixes(storage);
+        Collection prefixes = storage.getRegisteredNamespaces().keySet();
+        return (String[]) prefixes.toArray(new String[prefixes.size()]);
-        return nsCache.getURIs(storage);
+        Collection uris = storage.getRegisteredNamespaces().values();
+        return (String[]) uris.toArray(new String[uris.size()]);
-            return nsCache.getURI(storage, prefix);
+            return storage.getURI(prefix);
-            return nsCache.getPrefix(storage, uri);
+            return storage.getPrefix(uri);
-    //-----------------------< AbstractNamespaceResolver >----------------------
-
-    /**
-     * Unregister on <code>NamespaceCache</code>.
-     * @param listener the namespace listener.
-     */
-    public void removeListener(NamespaceListener listener) {
-        nsCache.removeListener(listener);
-    }
-
-    /**
-     * Register on <code>NamespaceCache</code>.
-     * @param listener the namespace listener.
-     */
-    public void addListener(NamespaceListener listener) {
-        nsCache.addListener(listener);
-    }
