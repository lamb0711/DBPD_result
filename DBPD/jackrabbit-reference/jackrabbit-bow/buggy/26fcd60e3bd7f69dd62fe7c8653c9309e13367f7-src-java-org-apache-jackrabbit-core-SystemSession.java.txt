AccessManager implementation configurable in repository.xml

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@155930 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.security.AMContext;
-import org.apache.jackrabbit.core.security.SimpleAccessManager;
+     * @throws RepositoryException
-                                                HierarchyManager hierMgr) {
-        //return new SystemAccessManager(subject, hierMgr);
-        return super.createAccessManager(subject, hierMgr);
+                                                HierarchyManager hierMgr)
+            throws RepositoryException {
+        /**
+         * use own AccessManager implementation rather than relying on
+         * configurable AccessManager to handle SystemPrincipal privileges
+         * correctly
+         */
+        return new SystemAccessManager();
+        //return super.createAccessManager(subject, hierMgr);
-    private class SystemAccessManager extends SimpleAccessManager {
+    private class SystemAccessManager implements AccessManager {
-        SystemAccessManager(Subject subject, HierarchyManager hierMgr) {
-            super(subject, hierMgr);
+        SystemAccessManager() {
+
+        /**
+         * @see AccessManager#init(AMContext)
+         */
+        public void init(AMContext context) throws Exception {
+            // nop
+        }
+
+        /**
+         * @see AccessManager#close()
+         */
+        public void close() throws Exception {
+            // nop
+        }
