- adapted versioning again to spec 0.15
- added VirtualItemStateManager for reflecting virtual content


git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@55615 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.core.NodeImpl;
+import org.apache.jackrabbit.core.*;
+import org.apache.jackrabbit.core.state.NodeState;
-import javax.jcr.Session;
+import javax.jcr.nodetype.NodeDef;
-public class VersionImpl extends NodeWrapper implements Version {
+public class VersionImpl extends NodeImpl implements Version {
-     * Creates a new version implementation
-     *
+     * creates a new version node
+     * @param itemMgr
+     * @param id
+     * @param state
+     * @param definition
+     * @param listeners
-    protected VersionImpl(Session session, InternalVersion version)
+    protected VersionImpl(ItemManager itemMgr, SessionImpl session, NodeId id,
+                       NodeState state, NodeDef definition,
+                       ItemLifeCycleListener[] listeners, InternalVersion version)
-        super((NodeImpl) session.getNodeByUUID(version.getUUID()));
+        super(itemMgr, session, id, state, definition, listeners);
-            ret[i] = new VersionImpl(unwrap().getSession(), suc[i]);
+            ret[i] = (Version) session.getNodeByUUID(suc[i].getId());
-            ret[i] = new VersionImpl(unwrap().getSession(), pred[i]);
+            ret[i] = (Version) session.getNodeByUUID(pred[i].getId());
-        return version.getUUID();
+        return version.getId();
-            return ((VersionImpl) otherItem).version.getUUID().equals(version.getUUID());
+            return ((VersionImpl) otherItem).version.getId().equals(version.getId());
+
