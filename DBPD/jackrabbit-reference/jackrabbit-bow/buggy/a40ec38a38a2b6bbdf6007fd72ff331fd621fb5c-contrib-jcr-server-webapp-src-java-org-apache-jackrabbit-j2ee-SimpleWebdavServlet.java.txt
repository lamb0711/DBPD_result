- adjusting to jackrabbit/commons changes
- removing static variables from servlets

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@215952 13f79535-47bb-0310-9956-ffa450edef68

+import javax.servlet.ServletContext;
+    public static final String CTX_ATTR_RESOURCE_PATH_PREFIX = "jcr.webdav.resourcepath";
+
-     * the repository prefix retrieved from config
+     * the resource path prefix
-    private static String resourcePathPrefix;
+    private String resourcePathPrefix;
-    private static Catalog chainCatalog;
+    private Catalog chainCatalog;
-    private static String authenticate_header;
+    private String authenticate_header;
+        getServletContext().setAttribute(CTX_ATTR_RESOURCE_PATH_PREFIX, resourcePathPrefix);
-    public static String getPathPrefix() {
+    public String getPathPrefix() {
+     * Returns the configured path prefix
+     *
+     * @return resourcePathPrefix
+     * @see #INIT_PARAM_RESOURCE_PATH_PREFIX
+     */
+    public static String getPathPrefix(ServletContext ctx) {
+        return (String) ctx.getAttribute(CTX_ATTR_RESOURCE_PATH_PREFIX);
+    }
+
+    /**
-     * @see RepositoryAccessServlet#getCredentialsFromHeader(String)
+     * @see RepositoryAccessServlet#getCredentialsFromHeader(ServletContext, String)
-                    return RepositoryAccessServlet.getCredentialsFromHeader(request.getHeader(DavConstants.HEADER_AUTHORIZATION));
+                    return RepositoryAccessServlet.getCredentialsFromHeader(getServletContext(), request.getHeader(DavConstants.HEADER_AUTHORIZATION));
-     * @see RepositoryAccessServlet#getRepository()
+     * @see RepositoryAccessServlet#getRepository(ServletContext)
-            repository = RepositoryAccessServlet.getRepository();
+            repository = RepositoryAccessServlet.getRepository(getServletContext());
