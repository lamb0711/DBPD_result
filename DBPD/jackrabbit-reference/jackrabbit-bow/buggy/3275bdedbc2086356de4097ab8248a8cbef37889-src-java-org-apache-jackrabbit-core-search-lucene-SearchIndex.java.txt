JCR-105: QueryHandler.init() should take a context argument

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@161056 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.search.QueryHandlerContext;
-            index = new MultiIndex(getFileSystem(),
-                    this, getItemStateProvider(), getRootUUID());
+            QueryHandlerContext context = getContext();
+            index = new MultiIndex(context.getFileSystem(), this,
+                    context.getItemStateManager(), context.getRootUUID());
-        return new QueryImpl(session, itemMgr, this, getPropertyTypeRegistry(), statement, language);
+        return new QueryImpl(session, itemMgr, this,
+                getContext().getPropertyTypeRegistry(), statement, language);
+        getContext().destroy();
-        return NodeIndexer.createDocument(node, getItemStateProvider(), nsMappings);
+        return NodeIndexer.createDocument(node, getContext().getItemStateManager(),
+                nsMappings);
