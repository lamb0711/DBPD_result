JCR-160: Query index not in sync with workspace
- A possible commit.lock is now also removed on startup. Previously only a write.lock was removed.
- An integrity check is run if the search index detects a commit or write lock on startup. This check removes nodes from the index that are not available anymore through the ItemStateManager.
- Applying the redo log on startup is now more failsafe.

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@216142 13f79535-47bb-0310-9956-ffa450edef68

-            throw new RepositoryException("Error while indexing node: " + node.getUUID(), e);
+            throwRepositoryException(e);
-            throw new RepositoryException("Error while indexing node: " + node.getUUID(), e);
+            throwRepositoryException(e);
-                throw new RepositoryException("Error while indexing node: " + node.getUUID(), e);
+                throwRepositoryException(e);
-                throw new RepositoryException("Error while indexing node: " + node.getUUID(), e);
+                throwRepositoryException(e);
+     * Wraps the exception <code>e</code> into a <code>RepositoryException</code>
+     * and throws the created exception.
+     *
+     * @param e the base exception.
+     */
+    private void throwRepositoryException(Exception e)
+            throws RepositoryException {
+        String msg = "Error while indexing node: " + node.getUUID() + " of " +
+                "type: " + node.getNodeTypeName();
+        throw new RepositoryException(msg, e);
+    }
+
+    /**
