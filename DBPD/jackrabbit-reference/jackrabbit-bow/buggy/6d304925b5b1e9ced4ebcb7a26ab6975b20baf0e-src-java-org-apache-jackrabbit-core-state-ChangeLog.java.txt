Transaction patch submitted by Dominique.
Moved test classes out of api.xa package because the UserTransactionImpl class uses the implementation specifc XASessionImpl class.

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@155314 13f79535-47bb-0310-9956-ffa450edef68

-     * A state has been modified
+     * A state has been modified. If the state is not a new state
+     * (not in the collection of added ones), then disconnect
+     * the local state from its underlying shared state and add
+     * it to the modified states collection.
-     * A state has been deleted
+     * A state has been deleted. If the state is not a new state
+     * (not in the collection of added ones), then disconnect
+     * the local state from its underlying shared state, remove
+     * it from the modified states collection and add it to the
+     * deleted states collection.
-     * Reset this change log, removing all members inside.
+     * Reset this change log, removing all members inside the
+     * maps we built.
-     * Discard all items contained in this change log
-     */
-    public void discard() {
-        Iterator iter = addedStates();
-        while (iter.hasNext()) {
-            ((ItemState) iter.next()).discard();
-        }
-        iter = modifiedStates();
-        while (iter.hasNext()) {
-            ((ItemState) iter.next()).discard();
-        }
-        iter = deletedStates();
-        while (iter.hasNext()) {
-            ((ItemState) iter.next()).discard();
-        }
-        reset();
-    }
-
-    /**
