- fixing duplicated references (JCR-45)

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@157347 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.PropertyId;
+import java.util.ArrayList;
-        vMgr.setItemReferences(item, references);
+        // filter out version storage intern ones
+        ArrayList refs = new ArrayList();
+        Iterator iter = references.iterator();
+        while (iter.hasNext()) {
+            PropertyId id = (PropertyId) iter.next();
+            if (!vMgr.hasItem(id.getParentUUID())) {
+                refs.add(id);
+            }
+        }
+        vMgr.setItemReferences(item, refs);
