JCR-2003: JCR2SPI / SPI: Add support for JCR 2.0

- initial implementation for Node.setPrimaryType
   needs more careful testing in case of 
   > changing node definition
   > batch utilities present in spi-commons

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@779227 13f79535-47bb-0310-9956-ffa450edef68

+    public void setPrimaryType(NodeId nodeId, Name primaryNodeTypeName) throws RepositoryException {
+        recording.add(new SetPrimaryType(nodeId, primaryNodeTypeName));
+    }
+
-        private final Name[] mixinNodeTypeIds;
+        private final Name[] mixinNodeTypeNames;
-        SetMixins(NodeId nodeId, Name[] mixinNodeTypeIds) {
+        SetMixins(NodeId nodeId, Name[] mixinNodeTypeNames) {
-            this.mixinNodeTypeIds = mixinNodeTypeIds;
+            this.mixinNodeTypeNames = mixinNodeTypeNames;
-            batch.setMixins(nodeId, mixinNodeTypeIds);
+            batch.setMixins(nodeId, mixinNodeTypeNames);
+        }
+    }
+
+    private static class SetPrimaryType implements Operation {
+
+        private final NodeId nodeId;
+
+        private final Name primaryNodeTypeName;
+
+        SetPrimaryType(NodeId nodeId, Name primaryNodeTypeName) {
+            this.nodeId = nodeId;
+            this.primaryNodeTypeName = primaryNodeTypeName;
+        }
+
+        /**
+         * {@inheritDoc}
+         */
+        public void replay(Batch batch) throws RepositoryException {
+            batch.setPrimaryType(nodeId, primaryNodeTypeName);
