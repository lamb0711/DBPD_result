changing config of test repository
fixing Workspace.getQueryManager() according to latest spec      

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@151338 13f79535-47bb-0310-9956-ffa450edef68

-import org.xml.sax.XMLReader;
+import org.xml.sax.XMLReader;
-     * @throws RepositoryException if a workspace with the given name
-     *                             already exists or if another error occurs
+     * @throws RepositoryException   if a workspace with the given name
+     *                               already exists or if another error occurs
-    public QueryManager getQueryManager() throws RepositoryException {
+    public synchronized QueryManager getQueryManager() throws RepositoryException {
+            SearchManager searchManager;
-                SearchManager searchManager = rep.getSearchManager(wspConfig.getName());
+                searchManager = rep.getSearchManager(wspConfig.getName());
-                    throw new UnsupportedOperationException("No search manager configured for this workspace.");
+                    String msg = "no search manager configured for this workspace";
+                    log.error(msg);
+                    throw new RepositoryException(msg);
-                queryManager = new QueryManagerImpl(session, session.getItemManager(), searchManager);
-            } catch (NoSuchWorkspaceException e) {
+            } catch (NoSuchWorkspaceException nswe) {
+                // should never get here
-                log.error(msg, e);
-                return null;
-            } catch (RepositoryException e) {
-                String msg = "internal error: failed to instantiate query manager";
-                log.error(msg, e);
-                return null;
+                log.error(msg, nswe);
+                throw new RepositoryException(msg, nswe);
+            queryManager = new QueryManagerImpl(session, session.getItemManager(), searchManager);
