JCR-623 - Clustering
+ Transmit namespace registrations
+ Transmit nodetype registrations


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@482707 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.nodetype.NodeTypeDef;
+import org.apache.jackrabbit.core.nodetype.compact.CompactNodeTypeDefReader;
+import org.apache.jackrabbit.core.nodetype.compact.ParseException;
+import java.io.StringReader;
+import java.util.List;
-     * @return string
+     * @return string or <code>null</code>
-        return in.readUTF();
+        boolean isNull = in.readBoolean();
+        if (isNull) {
+            return null;
+        } else {
+            return in.readUTF();
+        }
+     * Read a <code>NodeTypeDef</code>
+     */
+    public NodeTypeDef readNodeTypeDef() throws IOException, ParseException {
+        checkOpen();
+
+        StringReader sr = new StringReader(readString());
+
+        CompactNodeTypeDefReader reader = new CompactNodeTypeDefReader(sr, "(internal)");
+        List ntds = reader.getNodeTypeDefs();
+        if (ntds.size() != 1) {
+            throw new IOException("Expected one node type definition: got " + ntds.size());
+        }
+        return (NodeTypeDef) ntds.get(0);
+    }
+
+
+
+    /**
