minor improvement

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1022857 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.security.authorization.PrivilegeRegistry;
-import java.util.Arrays;
-        
+
+    /**
+     * The system session used to register an event listener and process the
+     * events as well as collect AC entries.
+     */
+
+    /**
+     * The root id.
+     */
+
+    private final PrivilegeRegistry privilegeRegistry;
-    private final ACLEditor systemEditor;
-       
+    /**
+     * Standard JCR name form of the {@link #N_POLICY} constant.
+     */
-     * @param systemEditor
-    protected EntryCollector(SessionImpl systemSession, ACLEditor systemEditor, NodeId rootID) throws RepositoryException {
+    protected EntryCollector(SessionImpl systemSession, NodeId rootID) throws RepositoryException {
-        this.systemEditor = systemEditor;
+
+        privilegeRegistry = new PrivilegeRegistry(systemSession);
+    @Override
-        List<AccessControlEntry> entries = new ArrayList(userAces.size() + groupAces.size());
+        List<AccessControlEntry> entries = new ArrayList<AccessControlEntry>(userAces.size() + groupAces.size());
-            entries = Arrays.asList(systemEditor.getACL(aclNode).getAccessControlEntries());
+            entries = new ACLTemplate(aclNode, privilegeRegistry).getEntries();
-            notifyListeners(new AccessControlModifications(modMap));
+            notifyListeners(new AccessControlModifications<NodeId>(modMap));
