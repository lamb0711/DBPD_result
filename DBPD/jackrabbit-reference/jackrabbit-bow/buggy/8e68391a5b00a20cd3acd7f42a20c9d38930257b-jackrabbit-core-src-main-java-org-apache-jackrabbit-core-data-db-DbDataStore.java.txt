JCR-2576 DbInputStream does not support mark()/reset() when exhausted.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@924769 13f79535-47bb-0310-9956-ffa450edef68

-    
+
-    
+
-    
+
-    protected Map<DataIdentifier, WeakReference<DataIdentifier>> inUse = 
+    protected Map<DataIdentifier, WeakReference<DataIdentifier>> inUse =
-    
+
-        TempFileInputStream fileInput = null;
+        InputStream fileInput = null;
-            while(true) {
+            while (true) {
-                fileInput = new TempFileInputStream(temp);
+                fileInput = new BufferedInputStream(new TempFileInputStream(temp));
-    
+
-    
+
-     * 
+     *
-     * @throws DataStoreException if the data store could not be accessed, 
+     * @throws DataStoreException if the data store could not be accessed,
-     */    
+     */
-                stream = new TempFileInputStream(temp);
+                stream = new BufferedInputStream(new TempFileInputStream(temp));
-    
+
-            throw convert("Can not init data store, driver=" + driver + " url=" + url + " user=" + user + 
+            throw convert("Can not init data store, driver=" + driver + " url=" + url + " user=" + user +
-     * 
+     *
-     * 
+     *
-     * ${tablePrefix}: tablePrefix plus schemaObjectPrefix as set in the configuration 
+     * ${tablePrefix}: tablePrefix plus schemaObjectPrefix as set in the configuration
-     * Get the table prefix. 
+     * Get the table prefix.
-    
+
-     * 
+     *
-     * 
+     *
-    }    
+    }
