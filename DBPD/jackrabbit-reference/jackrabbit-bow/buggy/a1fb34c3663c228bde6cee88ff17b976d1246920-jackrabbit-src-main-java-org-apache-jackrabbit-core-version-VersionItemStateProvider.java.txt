JCR-414 jcr:successors property not persisted correctly within a transaction

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@398589 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.core.PropertyId;
-import org.apache.jackrabbit.core.state.PropertyState;
-import org.apache.jackrabbit.core.value.InternalValue;
-
-            // special check for successors
-            if (item instanceof PropertyState) {
-                PropertyState prop = (PropertyState) item;
-                if (prop.getName().equals(QName.JCR_SUCCESSORS)) {
-                    try {
-                        InternalVersion v = vMgr.getVersion(prop.getParentId());
-                        if (v != null) {
-                            InternalVersion[] succs = v.getSuccessors();
-                            InternalValue[] succV = new InternalValue[succs.length];
-                            for (int i = 0; i < succs.length; i++) {
-                                succV[i] = InternalValue.create(succs[i].getId().getUUID());
-                            }
-                            prop.setValues(succV);
-                        }
-                    } catch (RepositoryException e) {
-                        log.warn("Unable to resolve jcr:successors property for " + id);
-                    }
-                }
-            }
-     * called by the version manager when a dynamic property needs to be
-     * invalidated.
-     *
-     * @param id
-     */
-    synchronized void onPropertyChanged(PropertyId id) {
-        ItemState item = (ItemState) items.get(id);
-        if (item != null) {
-            item.discard();
-        }
-    }
-
-    /**
