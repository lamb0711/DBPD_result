JCR-1397: Allow query results with unknown size

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@629145 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.lucene.search.Hits;
-import org.apache.lucene.search.IndexSearcher;
+     * @param session the session that executes the query.
-    public QueryHits executeQuery(AbstractQueryImpl queryImpl,
+    public QueryHits executeQuery(SessionImpl session,
+                                  AbstractQueryImpl queryImpl,
-        SortField[] sortFields = createSortFields(orderProps, orderSpecs);
+
+        Sort sort = new Sort(createSortFields(orderProps, orderSpecs));
-        IndexSearcher searcher = new IndexSearcher(reader);
-        Hits hits;
-        if (sortFields.length > 0) {
-            hits = searcher.search(query, new Sort(sortFields));
-        } else {
-            hits = searcher.search(query);
-        }
-        return new QueryHits(hits, reader);
+        return new JackrabbitIndexSearcher(session, reader).execute(query, sort);
