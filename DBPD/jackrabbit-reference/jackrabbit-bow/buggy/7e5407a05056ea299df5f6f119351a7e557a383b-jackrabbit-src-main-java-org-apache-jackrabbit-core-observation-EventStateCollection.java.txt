[JCR-317] replace UUID strings by UUID classes in NodeId, etc..

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@378221 13f79535-47bb-0310-9956-ffa450edef68

-     * @param rootNodeUUID the UUID of the root node.
+     * @param rootNodeId   the id of the root node.
-    public void createEventStates(String rootNodeUUID, ChangeLog changes, ItemStateManager provider) throws ItemStateException {
+    public void createEventStates(NodeId rootNodeId, ChangeLog changes, ItemStateManager provider) throws ItemStateException {
-                new ChangeLogBasedHierarchyMgr(rootNodeUUID, provider, changes,
+                new ChangeLogBasedHierarchyMgr(rootNodeId, provider, changes,
-         * childNodeRemoved event is fired before a childNodeAdded event.  
+         * childNodeRemoved event is fired before a childNodeAdded event.
-                    String oldParentUUID = n.getOverlayedState().getParentUUID();
-                    String newParentUUID = n.getParentUUID();
-                    if (newParentUUID != null &&
-                            !oldParentUUID.equals(newParentUUID)) {
+                    NodeId oldParentId = n.getOverlayedState().getParentId();
+                    NodeId newParentId = n.getParentId();
+                    if (newParentId != null &&
+                            !oldParentId.equals(newParentId)) {
-                            oldParent = (NodeState) changes.get(new NodeId(oldParentUUID));
+                            oldParent = (NodeState) changes.get(oldParentId);
-                            oldParent = (NodeState) provider.getItemState(new NodeId(oldParentUUID));
+                            oldParent = (NodeState) provider.getItemState(oldParentId);
-                        Path newPath = getPath(n.getId(), hmgr);
-                        Path oldPath = getZombiePath(n.getId(), hmgr);
+                        Path newPath = getPath(n.getNodeId(), hmgr);
+                        Path oldPath = getZombiePath(n.getNodeId(), hmgr);
-                            events.add(EventState.childNodeRemoved(oldParentUUID,
+                            events.add(EventState.childNodeRemoved(oldParentId,
-                                    n.getUUID(),
+                                    n.getNodeId(),
-                            NodeState newParent = (NodeState) changes.get(new NodeId(newParentUUID));
+                            NodeState newParent = (NodeState) changes.get(newParentId);
-                            events.add(EventState.childNodeAdded(newParentUUID,
+                            events.add(EventState.childNodeAdded(newParentId,
-                                    n.getUUID(),
+                                    n.getNodeId(),
-                            if (state.getParentUUID() != null) {
-                                parent = (NodeState) changes.get(new NodeId(state.getParentUUID()));
+                            if (state.getParentId() != null) {
+                                parent = (NodeState) changes.get(state.getParentId());
-                                if (child.getUUID().equals(n.getUUID())) {
+                                if (child.getId().equals(n.getNodeId())) {
-                                events.add(EventState.childNodeRemoved(parent.getUUID(),
+                                events.add(EventState.childNodeRemoved(parent.getNodeId(),
-                                        n.getUUID(),
+                                        n.getNodeId(),
-                                events.add(EventState.childNodeAdded(parent.getUUID(),
+                                events.add(EventState.childNodeAdded(parent.getNodeId(),
-                                        n.getUUID(),
+                                        n.getNodeId(),
-                        Path parentPath = getPath(n.getId(), hmgr);
+                        Path parentPath = getPath(n.getNodeId(), hmgr);
-                        NodeState.ChildNodeEntry entry = overlayed.getChildNodeEntry(child.getUUID());
+                        NodeState.ChildNodeEntry entry = overlayed.getChildNodeEntry(child.getId());
-                            throw new ItemStateException("Unable to retrieve old child index for item: " + child.getUUID());
+                            throw new ItemStateException("Unable to retrieve old child index for item: " + child.getId());
-                        events.add(EventState.childNodeRemoved(n.getUUID(),
+                        events.add(EventState.childNodeRemoved(n.getNodeId(),
-                                child.getUUID(),
+                                child.getId(),
-                        events.add(EventState.childNodeAdded(n.getUUID(),
+                        events.add(EventState.childNodeAdded(n.getNodeId(),
-                                child.getUUID(),
+                                child.getId(),
-                NodeState parent = (NodeState) provider.getItemState(new NodeId(state.getParentUUID()));
+                NodeState parent = (NodeState) provider.getItemState(state.getParentId());
-                events.add(EventState.propertyChanged(state.getParentUUID(),
+                events.add(EventState.propertyChanged(state.getParentId(),
-                NodeState parent = (NodeState) provider.getItemState(new NodeId(n.getParentUUID()));
+                NodeState parent = (NodeState) provider.getItemState(n.getParentId());
-                events.add(EventState.childNodeRemoved(n.getParentUUID(),
+                events.add(EventState.childNodeRemoved(n.getParentId(),
-                        n.getUUID(),
+                        n.getNodeId(),
-                    NodeState n = (NodeState) changes.get(new NodeId(state.getParentUUID()));
+                    NodeState n = (NodeState) changes.get(state.getParentId());
-                    events.add(EventState.propertyRemoved(state.getParentUUID(),
+                    events.add(EventState.propertyRemoved(state.getParentId(),
-                NodeId parentId = new NodeId(n.getParentUUID());
+                NodeId parentId = n.getParentId();
-                Path path = getPath(n.getId(), hmgr);
-                events.add(EventState.childNodeAdded(n.getParentUUID(),
+                Path path = getPath(n.getNodeId(), hmgr);
+                events.add(EventState.childNodeAdded(parentId,
-                        n.getUUID(),
+                        n.getNodeId(),
-                NodeState n = (NodeState) changes.get(new NodeId(state.getParentUUID()));
+                NodeState n = (NodeState) changes.get(state.getParentId());
-                events.add(EventState.propertyAdded(state.getParentUUID(),
+                events.add(EventState.propertyAdded(state.getParentId(),
-            String msg = "Item " + node.getId() + " has unknown node type: " + node.getNodeTypeName();
+            String msg = "Item " + node.getNodeId() + " has unknown node type: " + node.getNodeTypeName();
