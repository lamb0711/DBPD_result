JCR-962: Deadlocks in ConcurrentVersioningWithTransactionsTest

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@551877 13f79535-47bb-0310-9956-ffa450edef68

-         * transactions. Because some resources depend on each other, there is
-         * also a workspace scoped lock resource inserted, that guards the
-         * entire transaction from deadlocks (see JCR-335)
+         * transactions. Some resources depend on each other, therefore you
+         * should only change the sequence if you know what you are doing!
+         *
+         * There are two artificial resources on the version manager (begin and
+         * end), which handle locking of the version manager. The begin resource
+         * acquires the write lock on the version manager in its prepare method,
+         * while the end resource releases the write lock in either commit or
+         * rollback. Please note that the write lock is only acquired if there
+         * is someting to commit by the version manager.
+         * For further information see JCR-335 and JCR-962.
-            ((XAWorkspace) wsp).getXAResourceBegin(),
+            versionMgr.getXAResourceBegin(),
-            ((XAWorkspace) wsp).getXAResourceEnd()
+            versionMgr.getXAResourceEnd()
