JCR-2028: JSR 283 JCR Path

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@772659 13f79535-47bb-0310-9956-ffa450edef68

+import javax.jcr.ValueFactory;
-     * The QValue factory.
-     */
-    private static final QValueFactory QVALUE_FACTORY = QValueFactoryImpl.getInstance();
-
-    /**
+                    ValueFactory valueFactory,
-        this.valueFactory = new ValueFactoryQImpl(QVALUE_FACTORY, resolver);
+        if (valueFactory instanceof ValueFactoryQImpl) {
+            this.valueFactory = (ValueFactoryQImpl) valueFactory;
+        } else {
+            QValueFactory qvf = QValueFactoryImpl.getInstance();
+            this.valueFactory = new ValueFactoryQImpl(qvf, resolver);
+        }
-                    QValue p = QVALUE_FACTORY.create(hmgr.getPath(sn[0].getNodeId()));
+                    QValue p = valueFactory.getQValueFactory().create(hmgr.getPath(sn[0].getNodeId()));
