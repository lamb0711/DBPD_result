JCR-2415: Update Lucene to 3.0
- Merge all from JCR-2415-lucene-3.0 at 1064038 (reintegration)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1064058 13f79535-47bb-0310-9956-ffa450edef68

+@SuppressWarnings("serial")
-    protected Weight createWeight(Searcher searcher) throws IOException {
+    public Weight createWeight(Searcher searcher) throws IOException {
-    public class QueryHitsQueryWeight implements Weight {
+    public class QueryHitsQueryWeight extends Weight {
-        public Scorer scorer(IndexReader reader) throws IOException {
+        public Scorer scorer(IndexReader reader, boolean scoreDocsInOrder,
+                boolean topScorer) throws IOException {
-        private final Iterator docs;
+        private final Iterator<Integer> docs;
-        /**
-         * {@inheritDoc}
-         */
-        public boolean next() throws IOException {
-            if (docs.hasNext()) {
-                currentDoc = (Integer) docs.next();
-                return true;
+        @Override
+        public int nextDoc() throws IOException {
+            if (currentDoc == NO_MORE_DOCS) {
+                return currentDoc;
-            return false;
-        }
-        /**
-         * {@inheritDoc}
-         */
-        public int doc() {
+            currentDoc = docs.hasNext() ? docs.next() : NO_MORE_DOCS;
-        /**
-         * {@inheritDoc}
-         */
+        @Override
+        public int docID() {
+            return currentDoc == null ? -1 : currentDoc;
+        }
+
+        @Override
-        /**
-         * {@inheritDoc}
-         */
-        public boolean skipTo(int target) throws IOException {
+        @Override
+        public int advance(int target) throws IOException {
+            if (currentDoc == NO_MORE_DOCS) {
+                return currentDoc;
+            }
+
-                if (!next()) {
-                    return false;
+                if (nextDoc() == NO_MORE_DOCS) {
+                    return NO_MORE_DOCS;
-            } while (target > doc());
-            return true;
+            } while (target > docID());
+            return docID();
-        /**
-         * {@inheritDoc}
-         */
-        public Explanation explain(int doc) throws IOException {
-            return new Explanation();
-        }
