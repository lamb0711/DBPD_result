JCR-258 - remove JDOM dependency from jcr-server contribution
JCR-295 - usage of Cache-Control header 
JCR-297 - log output while parsing xml
minor consistency issues and improvements

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@368683 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.webdav.xml.DomUtil;
-import org.jdom.Element;
+import org.w3c.dom.Element;
+import org.w3c.dom.Document;
-import java.util.*;
+import java.util.List;
+import java.util.ArrayList;
+import java.util.Iterator;
+// todo: find proper solution for transporting search results...
-                    String txt = ((Element)el).getText();
-                    if (JCR_NAME.getName().equals(((Element)el).getName())) {
+                    String txt = DomUtil.getText((Element)el);
+                    if (JCR_NAME.getName().equals(((Element)el).getLocalName())) {
-                    } else if (JCR_VALUE.getName().equals(((Element)el).getName())) {
+                    } else if (JCR_VALUE.getName().equals(((Element)el).getLocalName())) {
-                    } else if (JCR_TYPE.getName().equals(((Element)el).getName())) {
+                    } else if (JCR_TYPE.getName().equals(((Element)el).getLocalName())) {
-            new IllegalArgumentException("SearchResultProperty requires a set of 'dcr:name','dcr:value' and 'dcr:type' xml elements.");
+            new IllegalArgumentException("SearchResultProperty requires a list of 'dcr:name','dcr:value' and 'dcr:type' xml elements.");
+
-     * Return the value of this webdav property i.e. an list of xml
-     * {@link Element}s. For every value in the query result row represented by
-     * this webdav property a dcr:name, dcr:value and dcr:type element is created.
+     * Same as {@link #getValues()}
+     *
+     * @return Array of JCR Value object
+     */
+    public Object getValue() {
+        return values;
+    }
+
+    /**
+     * Return the xml representation of this webdav property. For every value in
+     * the query result row a dcr:name, dcr:value and dcr:type element is created.
-     * @return value of this webdav property consisting of an list of xml elements.
-     * @see org.apache.jackrabbit.webdav.property.DavProperty#getValue()
+     * @see org.apache.jackrabbit.webdav.xml.XmlSerializable#toXml(org.w3c.dom.Document)
-    public Object getValue() {
-        List value = new ArrayList();
+    public Element toXml(Document document) {
+        Element elem = getName().toXml(document);
-            value.add(JCR_NAME.toXml().setText(propertyName));
-            value.add(JCR_VALUE.toXml().setText(valueStr));
-            value.add(JCR_TYPE.toXml().setText(type));
+            Element child = JCR_NAME.toXml(document);
+            DomUtil.setText(child, propertyName);
+            elem.appendChild(child);
+
+            child = JCR_VALUE.toXml(document);
+            DomUtil.setText(child, valueStr);
+            elem.appendChild(child);
+
+            child = JCR_TYPE.toXml(document);
+            DomUtil.setText(child, type);
+            elem.appendChild(child);
-        return value;
+        return elem;
