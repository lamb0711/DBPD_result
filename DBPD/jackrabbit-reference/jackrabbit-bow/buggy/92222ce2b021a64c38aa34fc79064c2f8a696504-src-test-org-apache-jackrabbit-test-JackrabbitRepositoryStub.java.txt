changed configuration layout and bootstrapping of repository:
- added jndi support
- workspace configuration is now separated from repository config
  

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@54857 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.core.RepositoryFactory;
+import org.apache.jackrabbit.core.jndi.RegistryHelper;
+import org.apache.jackrabbit.core.config.RepositoryConfig;
+import org.apache.jackrabbit.core.RepositoryImpl;
+import javax.naming.InitialContext;
+import javax.naming.NamingException;
-     * Property for the repositry name
+     * Property for the repository name (used for jndi lookup)
-    public static final String PROP_REPOSITRY_HOME = "org.apache.jackrabbit.repository.home";
+    /**
+     * Property for the repository configuration file (used for repository instantiation)
+     */
+    public static final String PROP_REPOSITORY_CONFIG = "org.apache.jackrabbit.repository.config";
+    /**
+     * Property for the repository home directory (used for repository instantiation)
+     */
+    public static final String PROP_REPOSITORY_HOME = "org.apache.jackrabbit.repository.home";
-    private RepositoryFactory factory;
-
-     * The default repository name is 'localfs'.
+     * The default repository name is 'repo'.
-                String repName = environment.getProperty(PROP_REPOSITORY_NAME, "localfs");
-                String repHome = environment.getProperty(PROP_REPOSITRY_HOME);
-                factory = RepositoryFactory.create(repHome + "/config.xml", repHome);
-                repository = factory.getRepository(repName);
+                String repName = environment.getProperty(PROP_REPOSITORY_NAME, "repo");
+                String repConfig = environment.getProperty(PROP_REPOSITORY_CONFIG);
+                String repHome = environment.getProperty(PROP_REPOSITORY_HOME);
+/*
+                RepositoryConfig repConf = RepositoryConfig.create(repConfig, repHome);
+                repository = RepositoryImpl.create(repConf);
+*/
+                InitialContext ctx = new InitialContext();
+                RegistryHelper.registerRepository(ctx, "repo", repConfig, repHome, true);
+                repository = (Repository) ctx.lookup("repo");
+/*
-                        factory.shutdown();
+                        repository.shutdown();
+*/
+            } catch (NamingException e) {
+                throw new RepositoryStubException(e.toString());
