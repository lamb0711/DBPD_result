- fixing JCR-41 (warn messages during checkin/checkout)

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@153406 13f79535-47bb-0310-9956-ffa450edef68

-    private NativeItemStateManager stateMgr;
+    private LocalItemStateManager stateMgr;
+
+    /**
+     * the persistence manager
+     */
+    private PersistenceManager pMgr;
-            this.stateMgr = new NativeItemStateManager(pMgr, PERSISTENT_ROOT_ID.getUUID(), ntReg);
+            //this.stateMgr = new NativeItemStateManager(pMgr, PERSISTENT_ROOT_ID.getUUID(), ntReg);
+            this.pMgr = pMgr;
+            SharedItemStateManager sharedStateMgr = new SharedItemStateManager(pMgr, PERSISTENT_ROOT_ID.getUUID(), ntReg);
+            stateMgr = new LocalItemStateManager(sharedStateMgr);
-        this.stateMgr.persistMgr.close();
+        this.pMgr.close();
-                PropertyState ps = stateMgr.getPropertyState(new PropertyId(state.getUUID(), PROPNAME_VERSIONABLE_ID));
+                PropertyState ps = (PropertyState) stateMgr.getItemState(new PropertyId(state.getUUID(), PROPNAME_VERSIONABLE_ID));
