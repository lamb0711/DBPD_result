[JCR-175] Contrib JCR-Server: enable PROPPATCH for simple-davresource
[JCR-174] Contrib JCR-Server: improve handing of strong etags

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@230679 13f79535-47bb-0310-9956-ffa450edef68

+        internalSetProperty(property);
+        complete();
+    }
+
+    /**
+     * Internal method that performs the setting or adding of properties
+     *
+     * @param property
+     * @throws DavException
+     * @see #setProperty(DavProperty)
+     * @see #alterProperties(DavPropertySet, DavPropertyNameSet)
+     */
+    private void internalSetProperty(DavProperty property) throws DavException {
-            complete();
-
+     * Loops over the given <code>Set</code>s and alters the properties accordingly.
+     * Changes are persisted at the end only according to the rules defined with
+     * the {@link #complete()} method.
+     *
+     * @param setProperties
+     * @param removePropertyNames
+     * @throws DavException
+     * @see DavResource#alterProperties(DavPropertySet, DavPropertyNameSet)
+     */
+    public void alterProperties(DavPropertySet setProperties,
+                                DavPropertyNameSet removePropertyNames)
+        throws DavException {
+
+        // altering any properties fails if an attempt is made to remove a property
+        if (removePropertyNames != null && !removePropertyNames.isEmpty()) {
+            throw new DavException(DavServletResponse.SC_FORBIDDEN);
+        }
+
+        // only set/add >> existance of resource is checked inside internal method
+        DavPropertyIterator setIter = setProperties.iterator();
+        while (setIter.hasNext()) {
+            DavProperty prop = setIter.nextProperty();
+            internalSetProperty(prop);
+        }
+        complete();
+    }
+
+    /**
