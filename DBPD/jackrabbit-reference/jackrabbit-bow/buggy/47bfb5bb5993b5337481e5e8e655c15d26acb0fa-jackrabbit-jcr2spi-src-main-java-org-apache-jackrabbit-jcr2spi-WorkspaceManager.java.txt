JCR-2113 : WIP (Contribution by Alfusainey Jallow)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1640892 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.jcr2spi.config.RepositoryConfig;
+import org.apache.jackrabbit.jcr2spi.security.authorization.AccessControlProvider;
+import org.apache.jackrabbit.jcr2spi.security.authorization.AccessControlProviderStub;
+    private final RepositoryConfig config;
-    private final CacheBehaviour cacheBehaviour;
-    private final int pollTimeout;
+    private AccessControlProvider acProvider;
+
-    public WorkspaceManager(RepositoryService service, SessionInfo sessionInfo,
-                            CacheBehaviour cacheBehaviour, int pollTimeout,
-                            boolean observationSupported)
+    public WorkspaceManager(RepositoryConfig config, SessionInfo sessionInfo, boolean observationSupported)
-        this.service = service;
+        this.config = config;
+        this.service = config.getRepositoryService();
-        this.cacheBehaviour = cacheBehaviour;
-        this.pollTimeout = pollTimeout;
+        CacheBehaviour cacheBehaviour = config.getCacheBehaviour();
+    /**
+     * Locates and instantiates an AccessControlProvider implementation.
+     * @return      an access control manager provider.  
+     * @throws      RepositoryException
+     */
+    public AccessControlProvider getAccessControlProvider() throws RepositoryException {
+        if (acProvider == null) {
+            acProvider = AccessControlProviderStub.newInstance(config, service);
+        }
+        return acProvider;
+    }
+
-            changeFeed = createChangeFeed(pollTimeout, observationSupported);
+            changeFeed = createChangeFeed(config.getPollTimeout(), observationSupported);
-        InternalEventListener listener = new HierarchyEventListener(this, hierarchyMgr, cacheBehaviour);
+        InternalEventListener listener = new HierarchyEventListener(this, hierarchyMgr, config.getCacheBehaviour());
