JCR-926: configuration for data store in repository.xml

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@573209 13f79535-47bb-0310-9956-ffa450edef68

-    private static final String PREFIX = "tempFile:";
+    private static final String PREFIX = "file:";
+    private final boolean temp;
-     * Creates a new instance from a
-     * <code>byte[]</code> array.
+     * Creates a new instance from a stream.
-     * @param data the byte array
-     * @throws IOException 
+     * @param in the input stream
-    private BLOBInTempFile(InputStream in) throws IOException {
+    private BLOBInTempFile(InputStream in, boolean temp) throws IOException {
+        this.temp = temp;
-    
+
-     * Creates a new instance from a
-     * <code>in[]</code> stream.
+     * Creates a new instance from file.
+     *
+     * @param in the input stream
+     */    
+    private BLOBInTempFile(File file, boolean temp) {
+        this.file = file;
+        this.length = file.length();
+        this.temp = temp;
+    }
+
+    /**
+     * Creates a new instance from a stream.
-    static BLOBInTempFile getInstance(InputStream in) throws IOException {
-        return new BLOBInTempFile(in);
+    static BLOBInTempFile getInstance(InputStream in, boolean temp) throws IOException {
+        return new BLOBInTempFile(in, temp);
+     * Creates a new instance from a file.
+     *
+     * @param file the file
+     */    
+    static BLOBInTempFile getInstance(File file, boolean temp) throws IOException {
+        return new BLOBInTempFile(file, temp);
+    }    
+    
+    /**
-        file.delete();
-        length = -1;
-        file = null;
+        if (temp) {
+            delete(true);
+        }
