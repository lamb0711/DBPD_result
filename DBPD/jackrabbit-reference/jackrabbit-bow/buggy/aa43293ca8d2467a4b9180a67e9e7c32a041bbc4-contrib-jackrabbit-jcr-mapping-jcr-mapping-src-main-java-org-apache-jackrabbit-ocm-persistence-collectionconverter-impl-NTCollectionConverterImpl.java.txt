bug fix for issues JCR-882 & JCR-921

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@547884 13f79535-47bb-0310-9956-ffa450edef68

-        Class elementClass = ReflectionUtils.forName(collectionDescriptor.getElementClassName());
-        Iterator children = this.getCollectionNodes(session, parentNode,
-                elementClassDescriptor.getJcrNodeType()).iterator();
-
+        //Class elementClass = ReflectionUtils.forName(collectionDescriptor.getElementClassName());
+        Collection nodes = this.getCollectionNodes(session, parentNode, elementClassDescriptor.getJcrNodeType());
+        
+        if (nodes == null)
+        {
+        	return null;
+        }
+        
+        Iterator children = nodes.iterator();
-        return collectionNodes;
+        if (collectionNodes.size() == 0)
+        {
+        	return null; 
+        }
+        else
+        {
+            return collectionNodes;
+        }
-        Iterator nodeIterator = this.getCollectionNodes(session, parentNode, itemNodeType).iterator();
+        Collection nodes = this.getCollectionNodes(session, parentNode, itemNodeType);
+        if (nodes == null) return;
+        	
+        Iterator nodeIterator = nodes.iterator();
