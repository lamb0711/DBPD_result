work in progress

- operations: rename getAffectedIds to getAffectedStates
- operations: return ItemState params instead of ids whereever possible and
  let OperationVisitor deal with all kind of issues arising with SPI ids.
- AddNode/AddProperty operations: don't list state to be created as affected. Not required since operations are collected upon refresh/save, in which case a 'new' item can never be the starting point.
- transient move: let parent NodeState handle the move/renaming of child states
- transient reorder: let parent NodeState handle the reorder logic
- NodeState: remove unused methods and mark setParent private
- NodeImpl: protected getNodeId() no more used by subclasses in version package.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@431887 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.spi.NodeId;
+import org.apache.jackrabbit.jcr2spi.state.NodeState;
-    private final NodeId versionHistoryId;
-    private final NodeId versionId;
+    private final NodeState versionHistoryState;
+    private final NodeState versionState;
-    private RemoveLabel(NodeId versionHistoryId, NodeId versionId, QName label) {
-        this.versionHistoryId = versionHistoryId;
-        this.versionId = versionId;
+    private RemoveLabel(NodeState versionHistoryState, NodeState versionState, QName label) {
+        this.versionHistoryState = versionHistoryState;
+        this.versionState = versionState;
+
+        // TODO: add affected states. required?
-    public NodeId getVersionHistoryId() {
-        return versionHistoryId;
+    public NodeState getVersionHistoryState() {
+        return versionHistoryState;
-    public NodeId getVersionId() {
-        return versionId;
+    public NodeState getVersionState() {
+        return versionState;
-     * @param versionHistoryId
-     * @param versionId
+     * @param versionHistoryState
+     * @param versionState
-     * @param moveLabel
-    public static Operation create(NodeId versionHistoryId, NodeId versionId, QName label) {
-        return new RemoveLabel(versionHistoryId, versionId, label);
+    public static Operation create(NodeState versionHistoryState, NodeState versionState, QName label) {
+        return new RemoveLabel(versionHistoryState, versionState, label);
