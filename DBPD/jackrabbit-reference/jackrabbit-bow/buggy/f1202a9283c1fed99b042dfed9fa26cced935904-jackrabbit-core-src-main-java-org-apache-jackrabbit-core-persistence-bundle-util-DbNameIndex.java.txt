JCR-815 SQLException with OracleBundle PM in name index


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@523272 13f79535-47bb-0310-9956-ffa450edef68

- *
+ * <p/>
+ * <p/>
+ * Due to a bug with oracle that treats empty strings a null values
+ * (see JCR-815), all empty strings are replaced by a ' '. since names never
+ * start with a space, this it not problematic yet.
-            int idx = getIndex(string);
+            String dbString = string.length() == 0 ? " " : string;
+            int idx = getIndex(dbString);
-                idx = insertString(string);
+                idx = insertString(dbString);
+            if (s.equals(" ")) {
+                s = "";
+            }
-     * Retrieves the string from the database for the givein index.
+     * Retrieves the string from the database for the given index.
-    private String getString(int index) {
+    protected String getString(int index) {
