JCR-2199: Improvements to user management

- change content structure to allow for fast lookup by ID
- groupID: unescaped before being exposed in the API.
- adjust defautl ac-provider on the security workspace according to the new structure
- same for impl tests
- extend security config. user mgr impl defines a couple of config options

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@794702 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.config.BeanConfig;
-    // TODO: should rather be placed in the core.security package. However protected access to SystemSession required to move here.
-    protected UserManagerImpl createUserManager(SessionImpl session)
-            throws RepositoryException {
-
-        return new UserManagerImpl(session, adminId);
+    protected UserManagerImpl createUserManager(SessionImpl session) throws RepositoryException {
+        BeanConfig umc = repository.getConfig().getSecurityConfig().getSecurityManagerConfig().getUserManagerConfig();
+        Properties config = null;
+        if (umc != null) {
+            // TODO: deal with other umgr implementations.
+            String clName = umc.getClassName();
+            if (clName != null && !(UserManagerImpl.class.getName().equals(clName) || clName.length() == 0)) {
+                log.warn("Unsupported custom UserManager implementation: '" + clName + "' -> Ignored.");
+            }
+            config = umc.getParameters();
+        }
+        return new UserManagerImpl(session, adminId, config);
