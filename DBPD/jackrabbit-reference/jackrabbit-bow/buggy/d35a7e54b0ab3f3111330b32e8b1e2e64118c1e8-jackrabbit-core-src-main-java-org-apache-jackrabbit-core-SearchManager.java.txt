JCR-890: concurrent read-only access to a session

Use the SessionContext and SessionOperations in search

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@983708 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.session.SessionContext;
-     * @param session   the session of the user executing the query.
-     * @param itemMgr   the item manager of the user executing the query. Needed
-     *                  to return <code>Node</code> instances in the result
-     *                  set.
+     * @param sessionContext component context of the current session
-    public Query createQuery(SessionImpl session,
-                             ItemManager itemMgr,
-                             String statement,
-                             String language,
-                             Node node)
+    public Query createQuery(
+            SessionContext sessionContext,
+            String statement, String language, Node node)
-        query.init(session, itemMgr, handler, statement, language, node);
+        query.init(sessionContext, handler, statement, language, node);
-     * @param session   the session of the user executing the query.
+     * @param sessionContext component context of the current session
-    public QueryObjectModel createQueryObjectModel(SessionImpl session,
-                                                   QueryObjectModelTree qomTree,
-                                                   String langugage,
-                                                   Node node)
+    public QueryObjectModel createQueryObjectModel(
+            SessionContext sessionContext, QueryObjectModelTree qomTree,
+            String langugage, Node node)
-        qom.init(session, session.getItemManager(), handler, qomTree, langugage, node);
+        qom.init(sessionContext, handler, qomTree, langugage, node);
