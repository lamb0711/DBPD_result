JCR-2107: JSR 283 Query (work in progress)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@783005 13f79535-47bb-0310-9956-ffa450edef68

+     * @see RepositoryService#executeQuery(SessionInfo, String, String, Map, long, long)
+     */
+    public QueryInfo executeQuery(SessionInfo sessionInfo, String statement, String language, Map namespaces, long limit, long offset) throws RepositoryException {
+        SearchMethod method = null;
+        try {
+            String uri = uriResolver.getWorkspaceUri(sessionInfo.getWorkspaceName());
+            SearchInfo sInfo = new SearchInfo(language,
+                    Namespace.EMPTY_NAMESPACE, statement, namespaces);
+            
+            sInfo.setNumberResults(limit);
+            sInfo.setOffset(offset);
+
+            method = new SearchMethod(uri, sInfo);
+            getClient(sessionInfo).executeMethod(method);
+            method.checkSuccess();
+
+            MultiStatus ms = method.getResponseBodyAsMultiStatus();
+            NamePathResolver resolver = getNamePathResolver(sessionInfo);
+            return new QueryInfoImpl(ms, sessionInfo, uriResolver, resolver, valueFactory, getQValueFactory());
+        } catch (IOException e) {
+            throw new RepositoryException(e);
+        } catch (DavException e) {
+            throw ExceptionConverter.generate(e);
+        }  finally {
+            if (method != null) {
+                method.releaseConnection();
+            }
+        }
+    }
+
+    /**
