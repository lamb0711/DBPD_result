JCR-1169 Distribution of commons classes (adjust jackrabbit-core)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@590014 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.name.NoPrefixDeclaredException;
-import org.apache.jackrabbit.name.Path;
-import org.apache.jackrabbit.name.QName;
-import org.apache.jackrabbit.name.NameFormat;
-import org.apache.jackrabbit.name.PathFormat;
+import org.apache.jackrabbit.conversion.NamePathResolver;
+import org.apache.jackrabbit.spi.Path;
+import org.apache.jackrabbit.spi.Name;
+import org.apache.jackrabbit.name.NameConstants;
+     * Name and Path resolver.
+     */
+    protected final NamePathResolver resolver;
+
+    /**
+        this.resolver = NamePathResolverImpl.create(mappings);
-                String name = NameFormat.format(child.getName(), mappings);
+                String name = resolver.getJCRName(child.getName());
-        } catch (NoPrefixDeclaredException e) {
+        } catch (NamespaceException e) {
-            QName propName = (QName) it.next();
+            Name propName = (Name) it.next();
-    private void addMVPName(Document doc, QName name) {
+    private void addMVPName(Document doc, Name name) {
-            String propName = NameFormat.format(name, mappings);
+            String propName = resolver.getJCRName(name);
-        } catch (NoPrefixDeclaredException e) {
+        } catch (NamespaceException e) {
-    private void addValue(Document doc, InternalValue value, QName name) {
+    private void addValue(Document doc, InternalValue value, Name name) {
-            fieldName = NameFormat.format(name, mappings);
-        } catch (NoPrefixDeclaredException e) {
+            fieldName = resolver.getJCRName(name);
+        } catch (NamespaceException e) {
-                    if (name.equals(QName.JCR_UUID)) {
+                    if (name.equals(NameConstants.JCR_UUID)) {
-                        name.equals(QName.JCR_PRIMARYTYPE) ||
-                        name.equals(QName.JCR_MIXINTYPES)) {
+                        name.equals(NameConstants.JCR_PRIMARYTYPE) ||
+                        name.equals(NameConstants.JCR_MIXINTYPES)) {
-    private void addPropertyName(Document doc, QName name) {
+    private void addPropertyName(Document doc, Name name) {
-            fieldName = NameFormat.format(name, mappings);
-        } catch (NoPrefixDeclaredException e) {
+            fieldName = resolver.getJCRName(name);
+        } catch (NamespaceException e) {
-            String jcrData = mappings.getPrefix(QName.NS_JCR_URI) + ":data";
+            String jcrData = mappings.getPrefix(Name.NS_JCR_URI) + ":data";
-            InternalValue typeValue = getValue(QName.JCR_MIMETYPE);
+            InternalValue typeValue = getValue(NameConstants.JCR_MIMETYPE);
-                InternalValue encodingValue = getValue(QName.JCR_ENCODING);
+                InternalValue encodingValue = getValue(NameConstants.JCR_ENCODING);
-    protected InternalValue getValue(QName name) throws ItemStateException {
+    protected InternalValue getValue(Name name) throws ItemStateException {
-            pathString = PathFormat.format(path, mappings);
-        } catch (NoPrefixDeclaredException e) {
+            pathString = resolver.getJCRPath(path);
+        } catch (NamespaceException e) {
-        QName qualiName = (QName) internalValue;
+        Name qualiName = (Name) internalValue;
-    protected boolean isIndexed(QName propertyName) {
+    protected boolean isIndexed(Name propertyName) {
-    protected boolean isIncludedInNodeIndex(QName propertyName) {
+    protected boolean isIncludedInNodeIndex(Name propertyName) {
-    protected float getPropertyBoost(QName propertyName) {
+    protected float getPropertyBoost(Name propertyName) {
