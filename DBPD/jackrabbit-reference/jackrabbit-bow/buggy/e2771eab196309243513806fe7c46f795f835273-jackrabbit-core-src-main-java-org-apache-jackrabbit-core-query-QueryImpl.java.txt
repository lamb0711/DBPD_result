JCR-890: concurrent read-only access to a session

Turn Query.execute() and related methods into SessionOperations

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@983909 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.session.SessionOperation;
-import org.apache.jackrabbit.spi.commons.conversion.NamePathResolver;
-import org.apache.jackrabbit.spi.commons.conversion.NameResolver;
-        QueryResult result = query.execute(offset, limit);
+        QueryResult result = sessionContext.getSessionState().perform(
+                new SessionOperation<QueryResult>() {
+                    public QueryResult perform(SessionContext context)
+                            throws RepositoryException {
+                        return query.execute(offset, limit);
+                    }
+                });
