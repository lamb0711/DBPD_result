JCR-2887 : Split PrivilegeRegistry in a per-session manager instance and a repository level registry [work in progress]

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1072154 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.WorkspaceImpl;
-import org.apache.jackrabbit.core.security.authorization.PrivilegeRegistry;
+import org.apache.jackrabbit.core.security.authorization.PrivilegeManager;
-    private final PrivilegeRegistry privilegeRegistry;
-            // TODO: review and find better solution
-            privilegeRegistry = new PrivilegeRegistry(session);
-        return new ACLTemplate(aclNode, privilegeRegistry);
+        return new ACLTemplate(aclNode);
+            PrivilegeManager privMgr = ((WorkspaceImpl) session.getWorkspace()).getPrivilegeManager();
-                        privilegeRegistry, session.getValueFactory(), session);
+                        privMgr, session.getValueFactory(), session);
