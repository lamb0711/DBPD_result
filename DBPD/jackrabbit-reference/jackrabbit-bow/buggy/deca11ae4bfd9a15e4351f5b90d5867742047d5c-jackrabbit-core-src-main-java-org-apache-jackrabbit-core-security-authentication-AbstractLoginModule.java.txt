JCR-2603: DefaultLoginModule performs anonymous login in case of unsupported Credentials implementation

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@933922 13f79535-47bb-0310-9956-ffa450edef68

-        // check the availability of Credentials
+        // check the availability and validity of Credentials
+        } else {
+            if (supportsCredentials(creds)) {
+                sharedState.put(KEY_CREDENTIALS, credentials);
+            } else {
+                log.debug("Unsupported credentials implementation : " + creds.getClass().getName());
+                return false;
+            }
+        
-     * Therefore the credentials are searchred as follows:
+     * Therefore the credentials are retrieved as follows:
-                Credentials creds = callback.getCredentials();
-                if (null != creds) {
-                    if (supportsCredentials(creds)) {
-                       credentials = creds;
-                    }
-                    if (credentials != null) {
-                        sharedState.put(KEY_CREDENTIALS, credentials);
-                    }
-                }
+                credentials = callback.getCredentials();
