JCR-1765: Config: make all elements in the security configuration optional

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@704324 13f79535-47bb-0310-9956-ffa450edef68

+        if (systemSession instanceof SessionImpl) {
+            SessionImpl sImpl = (SessionImpl) systemSession;
+            userAdminGroup = (configuration.containsKey(USER_ADMIN_GROUP_NAME)) ? configuration.get(USER_ADMIN_GROUP_NAME).toString() : USER_ADMIN_GROUP_NAME;
+            groupAdminGroup = (configuration.containsKey(GROUP_ADMIN_GROUP_NAME)) ? configuration.get(GROUP_ADMIN_GROUP_NAME).toString() : GROUP_ADMIN_GROUP_NAME;
-         if (systemSession instanceof SessionImpl) {
-             SessionImpl sImpl = (SessionImpl) systemSession;
-             userAdminGroup = (configuration.containsKey(USER_ADMIN_GROUP_NAME)) ? configuration.get(USER_ADMIN_GROUP_NAME).toString() : USER_ADMIN_GROUP_NAME;
-             groupAdminGroup = (configuration.containsKey(GROUP_ADMIN_GROUP_NAME)) ? configuration.get(GROUP_ADMIN_GROUP_NAME).toString() : GROUP_ADMIN_GROUP_NAME;
+            // make sure the groups exist (and ev. create them).
+            UserManager uMgr = sImpl.getUserManager();
+            if (!initGroup(uMgr, userAdminGroup)) {
+                log.warn("Unable to initialize User admininistrator group -> no user admins.");
+                userAdminGroup = null;
+            }
+            if (!initGroup(uMgr, groupAdminGroup)) {
+                log.warn("Unable to initialize Group admininistrator group -> no group admins.");
+                groupAdminGroup = null;
+            }
-             // make sure the groups exist (and ev. create them).
-             UserManager uMgr = sImpl.getUserManager();
-             if (!initGroup(uMgr, userAdminGroup)) {
-                 log.warn("Unable to initialize User admininistrator group -> no user admins.");
-                 userAdminGroup = null;
-             }
-             if (!initGroup(uMgr, groupAdminGroup)) {
-                 log.warn("Unable to initialize Group admininistrator group -> no group admins.");
-                 groupAdminGroup = null;
-             }
-
-             usersPath = sImpl.getQPath(USERS_PATH);
-             groupsPath = sImpl.getQPath(GROUPS_PATH);
-         } else {
-             throw new RepositoryException("SessionImpl (system session) expected.");
-         }
-     }
+            usersPath = sImpl.getQPath(USERS_PATH);
+            groupsPath = sImpl.getQPath(GROUPS_PATH);
+        } else {
+            throw new RepositoryException("SessionImpl (system session) expected.");
+        }
+    }
-            Path abs2Path = path.subPath(0, 4);
+            Path abs2Path = (4 > path.getLength()) ? null : path.subPath(0, 4);
-                            // default: other events are not relevant.
+                                // default: other events are not relevant.
