JCR-907: Create HTML excerpt provider

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@537155 13f79535-47bb-0310-9956-ffa450edef68

-    public static final String EMPTY_EXCERPT = "<excerpt/>";
-
-     * @param tvec         the term position vector for this hit
-     * @param queryTerms   the query terms.
-     * @param text         the original text that was used to create the tokens.
-     * @param prepend      the string used to prepend a highlighted token, for
-     *                     example <tt>&quot;&lt;b&gt;&quot;</tt>
-     * @param append       the string used to append a highlighted token, for
-     *                     example <tt>&quot;&lt;/b&gt;&quot;</tt>
-     * @param maxFragments the maximum number of fragments
-     * @param surround     the maximum number of chars surrounding a highlighted
-     *                     token
+     * @param tvec          the term position vector for this hit
+     * @param queryTerms    the query terms.
+     * @param text          the original text that was used to create the
+     *                      tokens.
+     * @param excerptStart  this string is prepended to the excerpt
+     * @param excerptEnd    this string is appended to the excerpt
+     * @param fragmentStart this string is prepended to every fragment
+     * @param fragmentEnd   this string is appended to the end of every
+     *                      fragement.
+     * @param hlStart       the string used to prepend a highlighted token, for
+     *                      example <tt>&quot;&lt;b&gt;&quot;</tt>
+     * @param hlEnd         the string used to append a highlighted token, for
+     *                      example <tt>&quot;&lt;/b&gt;&quot;</tt>
+     * @param maxFragments  the maximum number of fragments
+     * @param surround      the maximum number of chars surrounding a
+     *                      highlighted token
-                                   String prepend,
-                                   String append,
+                                   String excerptStart,
+                                   String excerptEnd,
+                                   String fragmentStart,
+                                   String fragmentEnd,
+                                   String hlStart,
+                                   String hlEnd,
-        return mergeFragments(offsets, new StringReader(text), prepend,
+        return mergeFragments(offsets, new StringReader(text), excerptStart,
+                excerptEnd, fragmentStart, fragmentEnd, hlStart, hlEnd,
+                maxFragments, surround);
+    }
+
+    /**
+     * @param tvec         the term position vector for this hit
+     * @param queryTerms   the query terms.
+     * @param text         the original text that was used to create the tokens.
+     * @param prepend      the string used to prepend a highlighted token, for
+     *                     example <tt>&quot;&lt;b&gt;&quot;</tt>
+     * @param append       the string used to append a highlighted token, for
+     *                     example <tt>&quot;&lt;/b&gt;&quot;</tt>
+     * @param maxFragments the maximum number of fragments
+     * @param surround     the maximum number of chars surrounding a highlighted
+     *                     token
+     * @return a String with text fragments where tokens from the query are
+     *         highlighted
+     */
+    public static String highlight(TermPositionVector tvec,
+                                   Set queryTerms,
+                                   String text,
+                                   String prepend,
+                                   String append,
+                                   int maxFragments,
+                                   int surround)
+            throws IOException {
+        return highlight(tvec, queryTerms, text, START_EXCERPT, END_EXCERPT,
+                START_FRAGMENT_SEPARATOR, END_FRAGMENT_SEPARATOR, prepend,
-                                         String prefix,
-                                         String suffix,
+                                         String excerptStart,
+                                         String excerptEnd,
+                                         String fragmentStart,
+                                         String fragmentEnd,
+                                         String hlStart,
+                                         String hlEnd,
-            return EMPTY_EXCERPT;
+            return excerptStart + excerptEnd;
-        StringBuffer sb = new StringBuffer(START_EXCERPT);
+        StringBuffer sb = new StringBuffer(excerptStart);
-                    sb.append(END_FRAGMENT_SEPARATOR);
+                    sb.append(fragmentEnd);
-            sb.append(START_FRAGMENT_SEPARATOR);
+            sb.append(fragmentStart);
-                sb.append(prefix);
+                sb.append(hlStart);
-                sb.append(suffix);
+                sb.append(hlEnd);
-                sb.append(END_FRAGMENT_SEPARATOR);
+                sb.append(fragmentEnd);
-        sb.append(END_EXCERPT);
+        sb.append(excerptEnd);
