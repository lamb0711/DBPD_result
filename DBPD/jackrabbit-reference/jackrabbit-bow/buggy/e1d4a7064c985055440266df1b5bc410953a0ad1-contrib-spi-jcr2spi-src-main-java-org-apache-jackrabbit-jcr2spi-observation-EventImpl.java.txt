JCR-996 Name and Path interfaces in SPI
JCR-1169 Distribution of commons classes


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@586065 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.name.NoPrefixDeclaredException;
-import org.apache.jackrabbit.name.PathFormat;
-import org.apache.jackrabbit.name.NamespaceResolver;
+import org.apache.jackrabbit.conversion.NamePathResolver;
-    private final NamespaceResolver nsResolver;
+    private final NamePathResolver resolver;
-     * @param nsResolver <code>NamespaceResolver</code> attached to the session
-     * of the registerd <code>EventListener</code>, where this <code>Event</code>
-     * will be delivered to.
+     * @param resolver
-    EventImpl(NamespaceResolver nsResolver, org.apache.jackrabbit.spi.Event event) {
-        this.nsResolver = nsResolver;
+    EventImpl(NamePathResolver resolver, org.apache.jackrabbit.spi.Event event) {
+        this.resolver = resolver;
-        try {
-            return PathFormat.format(event.getQPath(), nsResolver);
-        } catch (NoPrefixDeclaredException e) {
-            String msg = "internal error: encountered unregistered namespace in path";
-            log.debug(msg);
-            throw new RepositoryException(msg, e);
-        }
+        return resolver.getJCRPath(event.getPath());
