JCR-2762: Optimize bundle serialization

Avoid the extra byte in front of many names by writing out explicit counts before mixin types and properties.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1022909 13f79535-47bb-0310-9956-ffa450edef68

-     * Creates a property state from the values of this bundle
-     * @param pMgr the persistence manager
-     * @param name the name of the new property
-     * @return the new property state
-     */
-    public PropertyState createPropertyState(PersistenceManager pMgr, Name name) {
-        PropertyEntry p = getPropertyEntry(name);
-        if (p == null) {
-            return null;
-        }
-        PropertyState ps = pMgr.createNew(new PropertyId(id, name));
-        ps.setMultiValued(p.isMultiValued());
-        ps.setType(p.getType());
-        ps.setValues(p.getValues());
-        ps.setModCount(p.getModCount());
-        return ps;
-    }
-
-    /**
+        assert !NameConstants.JCR_PRIMARYTYPE.equals(entry.getName());
+        assert !NameConstants.JCR_MIXINTYPES.equals(entry.getName());
+        assert !NameConstants.JCR_UUID.equals(entry.getName());
-        return properties.containsKey(name)
-                || name.equals(NameConstants.JCR_PRIMARYTYPE)
-                || (isReferenceable && name.equals(NameConstants.JCR_UUID))
-                || (mixinTypeNames.size() > 0 && name.equals(NameConstants.JCR_MIXINTYPES));
+        return properties.containsKey(name);
