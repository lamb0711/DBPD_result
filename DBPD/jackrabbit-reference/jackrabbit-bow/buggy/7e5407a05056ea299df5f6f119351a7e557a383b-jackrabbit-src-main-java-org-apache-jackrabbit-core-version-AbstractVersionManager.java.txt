[JCR-317] replace UUID strings by UUID classes in NodeId, etc..

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@378221 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.core.NodeId;
+import org.apache.jackrabbit.core.SessionImpl;
-    public InternalVersion getVersion(String uuid) throws RepositoryException {
-        return (InternalVersion) getItem(uuid);
+    public InternalVersion getVersion(NodeId id) throws RepositoryException {
+        return (InternalVersion) getItem(id);
-    public InternalVersionHistory getVersionHistory(String uuid)
+    public InternalVersionHistory getVersionHistory(NodeId id)
-        return (InternalVersionHistory) getItem(uuid);
+        return (InternalVersionHistory) getItem(id);
-    public boolean hasVersionHistory(String id) {
+    public boolean hasVersionHistory(NodeId id) {
-    public boolean hasVersion(String id) {
+    public boolean hasVersion(NodeId id) {
-        String vhId = getVersionHistoryId(node);
+        NodeId vhId = getVersionHistoryId(node);
-        return (VersionHistory) session.getNodeByUUID(vhId);
+        return (VersionHistory) ((SessionImpl) session).getNodeById(vhId);
-     * @param uuid uuid of item
+     * @param id the id of the item
-    protected abstract InternalVersionItem getItem(String uuid)
+    protected abstract InternalVersionItem getItem(NodeId id)
-     * @param uuid uuid of item
+     * @param id the id of the item
-    protected abstract boolean hasItem(String uuid);
+    protected abstract boolean hasItem(NodeId id);
-            String uuid = node.getUUID();
+            String uuid = node.getNodeId().getUUID().toString();
-                    this, root, UUID.randomUUID().toString(), historyNodeName, node);
+                    this, root, new NodeId(UUID.randomUUID()), historyNodeName, node);
-    String getVersionHistoryId(NodeState node) throws RepositoryException {
+    NodeId getVersionHistoryId(NodeState node) throws RepositoryException {
-        String uuid = node.getUUID();
+        String uuid = node.getNodeId().getUUID().toString();
-        return n.getNode(historyNodeName, 1).getUUID();
+        return n.getNode(historyNodeName, 1).getNodeId();
-            preds[i] = history.getVersion(values[i].getString());
+            preds[i] = history.getVersion(NodeId.valueOf(values[i].getString()));
