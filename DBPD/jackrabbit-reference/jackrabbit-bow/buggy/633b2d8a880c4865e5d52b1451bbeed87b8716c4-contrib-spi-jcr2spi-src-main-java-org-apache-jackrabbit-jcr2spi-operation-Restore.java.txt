fixed: move, reorder (work in progress)
fixed: locktoken transfer
fixed: recursive transient removal of invalidated tree fails (restoreTests)
improve: simplify usage of workspace operations
fixed: store original itemId with transient operations in order to properly reflect the changelog upon batch creation
fixed: workspace import doesn't invalidate
fixed: session import uuid handling




git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@513279 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.spi.NodeId;
-     * Returns state or the closest existing state of the restore target or
+     * Returns id of state or the closest existing state of the restore target or
-    public NodeState getNodeState() {
-        return nodeState;
+    public NodeId getNodeId() {
+        return (nodeState == null) ? null : nodeState.getNodeId();
-    public NodeState[] getVersionStates() {
-        return versionStates;
+    public NodeId[] getVersionIds() {
+        NodeId[] versionIds = new NodeId[versionStates.length];
+        for (int i = 0; i < versionStates.length; i++) {
+            versionIds[i] = versionStates[i].getNodeId();
+        }
+        return versionIds;
-            throw new IllegalArgumentException("Neither nodeId nor versionState must be null.");
+            throw new IllegalArgumentException("Neither nodeState nor versionState must be null.");
-        if (versionStates == null) {
+        if (versionStates == null || versionStates.length == 0) {
