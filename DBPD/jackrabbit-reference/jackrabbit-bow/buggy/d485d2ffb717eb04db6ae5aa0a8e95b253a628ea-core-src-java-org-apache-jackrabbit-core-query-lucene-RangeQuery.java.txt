JCR-111: org.apache.lucene.search.BooleanQuery$TooManyClauses when using '>' operator
- Use lucene RangeQuery implementation whenever possible.

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@210089 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.lucene.search.BooleanQuery;
+     * Tries to rewrite this query into a standard lucene RangeQuery.
+     * This rewrite might fail with a TooManyClauses exception. If that
+     * happens, we use our own implementation.
+     *
+     * @param reader the index reader.
+     * @return the rewritten query or this query if rewriting is not possible.
+     * @throws IOException if an error occurs.
+     */
+    public Query rewrite(IndexReader reader) throws IOException {
+        Query stdRangeQueryImpl
+                = new org.apache.lucene.search.RangeQuery(lowerTerm, upperTerm, inclusive);
+        try {
+            return stdRangeQueryImpl.rewrite(reader);
+        } catch (BooleanQuery.TooManyClauses e) {
+            // failed, use own implementation
+            return this;
+        }
+    }
+
+    /**
