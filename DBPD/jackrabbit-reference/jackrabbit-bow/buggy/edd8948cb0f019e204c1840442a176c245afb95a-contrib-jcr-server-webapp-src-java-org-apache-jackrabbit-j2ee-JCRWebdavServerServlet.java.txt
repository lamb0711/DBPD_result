JCR-249, JCR-253

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@331281 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.server.CredentialsProvider;
+import org.apache.jackrabbit.server.BasicCredentialsProvider;
-import javax.servlet.http.HttpServletRequest;
-import javax.jcr.Credentials;
-import javax.jcr.LoginException;
+    /** the 'missing-auth-mapping' init parameter */
+    public final static String INIT_PARAM_MISSING_AUTH_MAPPING = "missing-auth-mapping";
+
-        CredentialsProvider cp = new CredentialsProvider() {
-            public Credentials getCredentials(HttpServletRequest request) throws LoginException, ServletException {
-                return RepositoryAccessServlet.getCredentialsFromHeader(ctx, request.getHeader(DavConstants.HEADER_AUTHORIZATION));
-            }
-        };
-
-	server = new JCRWebdavServer(repository, new SessionProviderImpl(cp));
+	server = new JCRWebdavServer(repository, new SessionProviderImpl(
+                new BasicCredentialsProvider(
+                        getInitParameter(INIT_PARAM_MISSING_AUTH_MAPPING)))
+        );
-     * resource lays within a differenct workspace as is assigned to the repository
+     * resource resides within a differenct workspace as is assigned to the repository
