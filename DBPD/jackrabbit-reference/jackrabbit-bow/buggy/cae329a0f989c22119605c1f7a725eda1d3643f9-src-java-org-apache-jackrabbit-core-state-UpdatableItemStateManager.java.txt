reworked transaction support, contributed by dominique

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@151380 13f79535-47bb-0310-9956-ffa450edef68

- * An update operation started inside an <code>ItemStateManager</code>
+ * Identifies an <code>ItemStateManager</code> that allows updating
+ * items.
-public interface UpdateOperation {
+public interface UpdatableItemStateManager extends ItemStateManager {
+
+    /**
+     * Start an edit operation on items inside this manager. This
+     * allows calling the operations defined below. At the end of
+     * this operation, either {@link #update} or {@link #cancel}
+     * must be invoked.
+     * @throws ItemStateException if the manager is already inside
+     *         edit mode.
+     */
+    public void edit() throws ItemStateException;
-     * End this update operation. This will save all items
+     * Cancel an update operation. This will undo all changes
+     * made to objects inside this item state manager.
+     */
+    public void cancel();
+
+    /**
+     * End an update operation. This will save all items
-     * @throws ItemStateException if the update operation failed
+     * @throws ItemStateException if the operation failed
-    public void end() throws ItemStateException;
+    public void update() throws ItemStateException;
