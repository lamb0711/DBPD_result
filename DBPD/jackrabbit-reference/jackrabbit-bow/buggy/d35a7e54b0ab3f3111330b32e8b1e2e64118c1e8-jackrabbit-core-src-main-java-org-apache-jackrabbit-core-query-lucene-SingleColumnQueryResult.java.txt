JCR-890: concurrent read-only access to a session

Use the SessionContext and SessionOperations in search

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@983708 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.core.ItemManager;
-import org.apache.jackrabbit.core.SessionImpl;
-import org.apache.jackrabbit.core.security.AccessManager;
-import org.apache.jackrabbit.spi.commons.query.qom.ColumnImpl;
+import org.apache.jackrabbit.core.session.SessionContext;
+import org.apache.jackrabbit.spi.commons.query.qom.ColumnImpl;
-    public SingleColumnQueryResult(SearchIndex index,
-                                   ItemManager itemMgr,
-                                   SessionImpl session,
-                                   AccessManager accessMgr,
-                                   AbstractQueryImpl queryImpl,
-                                   Query query,
-                                   SpellSuggestion spellSuggestion,
-                                   ColumnImpl[] columns,
-                                   Path[] orderProps,
-                                   boolean[] orderSpecs,
-                                   boolean documentOrder,
-                                   long offset,
-                                   long limit) throws RepositoryException {
-        super(index, itemMgr, session, accessMgr, queryImpl, spellSuggestion,
+    public SingleColumnQueryResult(
+            SearchIndex index, SessionContext sessionContext,
+            AbstractQueryImpl queryImpl, Query query,
+            SpellSuggestion spellSuggestion, ColumnImpl[] columns,
+            Path[] orderProps, boolean[] orderSpecs, boolean documentOrder,
+            long offset, long limit) throws RepositoryException {
+        super(index, sessionContext, queryImpl, spellSuggestion,
-        return index.executeQuery(session, queryImpl, query,
+        return index.executeQuery(
+                sessionContext.getSessionImpl(), queryImpl, query,
