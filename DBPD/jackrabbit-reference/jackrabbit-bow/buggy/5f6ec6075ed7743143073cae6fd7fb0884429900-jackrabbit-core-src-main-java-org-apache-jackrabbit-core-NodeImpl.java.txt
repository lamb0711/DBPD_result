JCR-1538: [patch] add toString for NodeImpl and PropertyImpl

Type-specific toString() on all ItemImpl descendants

Use the toString() method instead of safeGetPath() in diagnostics.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@698402 13f79535-47bb-0310-9956-ffa450edef68

-                    + state.getNodeTypeName() + "' of node " + safeGetJCRPath());
+                    + state.getNodeTypeName() + "' of " + this);
-            String msg = "failed to resolve path " + relPath + " relative to " + safeGetJCRPath();
+            String msg = "failed to resolve path " + relPath + " relative to " + this;
-            String msg = "failed to resolve path " + relPath + " relative to " + safeGetJCRPath();
+            String msg = "failed to resolve path " + relPath + " relative to " + this;
-            String msg = "failed to add property " + name + " to "
-                    + safeGetJCRPath();
+            String msg = "failed to add property " + name + " to " + this;
-            String msg = "failed to add child node " + name + " to "
-                    + safeGetJCRPath();
+            String msg = "failed to add child node " + name + " to " + this;
-            String msg = "failed to remove property " + propName + " of "
-                    + safeGetJCRPath();
+            String msg = "failed to remove property " + propName + " of " + this;
-            String msg = "failed to remove child " + nodeName + " of "
-                    + safeGetJCRPath();
+            String msg = "failed to remove child " + nodeName + " of " + this;
-            String msg = "failed to remove child " + nodeName + " of "
-                    + safeGetJCRPath();
+            String msg = "failed to remove child " + nodeName + " of " + this;
-            String msg = "failed to resolve path " + relPath + " relative to "
-                    + safeGetJCRPath();
+            String msg =
+                "failed to resolve path " + relPath + " relative to " + this;
-            String msg = safeGetJCRPath()
-                    + ": cannot add a child to a checked-in node";
+            String msg = this + ": cannot add a child to a checked-in node";
-            String msg = "internal error: invalid path " + safeGetJCRPath();
+            String msg = "internal error: invalid path " + this;
-            String msg = safeGetJCRPath() + ": cannot add a child to a protected node";
+            String msg = this + ": cannot add a child to a protected node";
-            String msg = "internal error: failed to build effective node type for node "
-                    + safeGetJCRPath();
+            String msg = "Failed to build effective node type for " + this;
-            log.debug(safeGetJCRPath() + " (" + id + "): there's no transient state to persist");
+            log.debug(this + " (" + id + "): there's no transient state to persist");
-                String msg = safeGetJCRPath()
-                        + ": the node cannot be saved because it has been modified externally.";
+                String msg =
+                    this + ": the node cannot be saved because it has been"
+                    + " modified externally.";
-            String msg = safeGetJCRPath() + ": cannot add a mixin node type to a checked-in node";
+            String msg = this + ": cannot add a mixin node type to a checked-in node";
-            String msg = safeGetJCRPath() + ": cannot add a mixin node type to a protected node";
+            String msg = this + ": cannot add a mixin node type to a protected node";
-            String msg = safeGetJCRPath()
-                    + ": cannot remove a mixin node type from a checked-in node";
+            String msg =
+                this + ": cannot remove a mixin node type from a checked-in node";
-            String msg = safeGetJCRPath()
-                    + ": cannot remove a mixin node type from a protected node";
+            String msg =
+                this + ": cannot remove a mixin node type from a protected node";
-            String msg = safeGetJCRPath()
-                    + ": cannot set property of a checked-in node";
+            String msg = this + ": cannot set property of a checked-in node";
-            String msg = safeGetJCRPath() + ": cannot add node to a checked-in node";
+            String msg = this + ": cannot add node to a checked-in node";
-                    "child node ordering not supported on node "
-                    + safeGetJCRPath());
+                    "child node ordering not supported on " + this);
-            throw new ItemNotFoundException(safeGetJCRPath()
-                    + " has no child node with name " + name);
+            throw new ItemNotFoundException(
+                    this + " has no child node with name " + name);
-            throw new ItemNotFoundException(safeGetJCRPath()
-                    + " has no child node with name " + name);
+            throw new ItemNotFoundException(
+                    this + " has no child node with name " + name);
-            String msg = safeGetJCRPath()
-                    + ": cannot change child node ordering of a checked-in node";
+            String msg =
+                this + ": cannot change child node ordering of a checked-in node";
-            String msg = safeGetJCRPath()
-                    + ": cannot change child node ordering of a protected node";
+            String msg =
+                this + ": cannot change child node ordering of a protected node";
-            throw new ItemNotFoundException(safeGetJCRPath()
-                    + ": no child node entry with id " + id);
+            throw new ItemNotFoundException(
+                    this + ": no child node entry with id " + id);
-            String msg = "internal error: invalid path " + safeGetJCRPath();
+            String msg = "internal error: invalid path " + this;
-            String msg = safeGetJCRPath()
-                    + ": cannot add a child to a checked-in node";
+            String msg = this + ": cannot add a child to a checked-in node";
-            String msg = safeGetJCRPath() + ": cannot add a child to a protected node";
+            String msg = this + ": cannot add a child to a protected node";
-            String msg = "failed to list the child nodes of " + safeGetJCRPath();
+            String msg = "failed to list the child nodes of " + this;
-            String msg = "failed to list the child nodes of " + safeGetJCRPath();
+            String msg = "failed to list the child nodes of " + this;
-            String msg = "failed to list the child properties of " + safeGetJCRPath();
+            String msg = "failed to list the child properties of " + this;
-            String msg = "failed to list the child properties of " + safeGetJCRPath();
+            String msg = "failed to list the child properties of " + this;
-                    throw new ItemNotFoundException(safeGetJCRPath());
+                    throw new ItemNotFoundException("Node not found: " + this);
-            String msg = "Node at " + safeGetJCRPath() + " is not shareable.";
+            String msg = this + " is not shareable.";
-            String msg = safeGetJCRPath() + ": Node is already checked-in. ignoring.";
+            String msg = this + ": Node is already checked-in. ignoring.";
-            String msg = "Unable to checkin node. Node has pending changes: " + safeGetJCRPath();
+            String msg = "Unable to checkin node. Node has pending changes: " + this;
-            String msg = safeGetJCRPath() + ": Node is already checked-out. ignoring.";
+            String msg = this + ": Node is already checked-out. ignoring.";
-            String msg = "Unable to perform versioning operation on non versionable node: " + safeGetJCRPath();
+            String msg =
+                "Unable to perform a versioning operation on"
+                + " a non versionable node: " + this;
-                String msg = "Unable to merge nodes. Violating versions. " + safeGetJCRPath();
+                String msg =
+                    "Unable to merge nodes. Violating versions. " + this;
-            String msg = "Unable to finish merge. Node has pending changes: " + safeGetJCRPath();
+            String msg =
+                "Unable to finish merge. Node has pending changes: " + this;
-            String msg = "Unable to finish merge. Node is checked-in: " + safeGetJCRPath();
+            String msg = "Unable to finish merge. Node is checked-in: " + this;
-            String msg = "Unable to finish merge. Specified version is not in jcr:mergeFailed property: " + safeGetJCRPath();
+            String msg =
+                "Unable to finish merge. Specified version is not in"
+                + " jcr:mergeFailed property: " + this;
-                            throw new ItemExistsException("Unable to update node: " + dstNode.safeGetJCRPath());
+                            throw new ItemExistsException("Unable to update item: " + dstNode);
-                throw new ItemExistsException("Unable to restore version of " + safeGetJCRPath() + ". UUID changed.");
+                throw new ItemExistsException("Unable to restore version of " + this + ". UUID changed.");
-            throw new ItemExistsException("Unable to restore version of " + safeGetJCRPath() + ". PrimaryType changed.");
+            throw new ItemExistsException("Unable to restore version of " + this + ". PrimaryType changed.");
-                            throw new ItemExistsException("Unable to restore node, item already exists outside of restored tree: "
-                                    + existing.safeGetJCRPath());
+                            throw new ItemExistsException(
+                                    "Unable to restore node, item already"
+                                    + " exists outside of restored tree: "
+                                    + existing);
-                        throw new ItemExistsException("Unable to restore node, item already exists outside of restored tree: "
-                                + n.safeGetJCRPath());
+                        throw new ItemExistsException(
+                                "Unable to restore node, item already exists"
+                                + " outside of restored tree: " + n);
-                        log.error("Error while restoring node: " + e.toString());
-                        log.error("  child path: " + restoredChild.safeGetJCRPath());
+                        log.error("Error while restoring node: " + e);
+                        log.error("  child path: " + restoredChild);
-            String msg = "Unable to lock node. Node has pending changes: " + safeGetJCRPath();
+            String msg = "Unable to lock node. Node has pending changes: " + this;
-            throw new LockException("Node not locked: " + safeGetJCRPath());
+            throw new LockException("New node can not be locked: " + this);
-            String msg = "Unable to unlock node. Node has pending changes: " + safeGetJCRPath();
+            String msg = "Unable to unlock node. Node has pending changes: " + this;
-            String msg = "Unable to perform locking operation on non-lockable node: "
-                    + safeGetJCRPath();
+            String msg =
+                "Unable to perform a locking operation on"
+                + " a non-lockable node: " + this;
-            String msg = safeGetJCRPath() + ": cannot set primary type of a checked-in node";
+            String msg = this + ": cannot set primary type of a checked-in node";
-            String msg = safeGetJCRPath() + ": cannot set primary type of a protected node";
+            String msg = this + ": cannot set primary type of a protected node";
-            String msg = safeGetJCRPath() + ": no applicable definition found in parent node's node type";
+            String msg = this + ": no applicable definition found in parent node's node type";
+
+    //--------------------------------------------------------------< Object >
+
+    /**
+     * Return a string representation of this node for diagnostic purposes.
+     *
+     * @return "node /path/to/item"
+     */
+    public String toString() {
+        return "node " + super.toString();
+    }
+
