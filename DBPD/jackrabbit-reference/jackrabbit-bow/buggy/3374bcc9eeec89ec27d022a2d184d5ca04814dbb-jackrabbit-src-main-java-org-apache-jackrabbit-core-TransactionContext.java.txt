JCR-447 deadlock on concurrent commit/locking

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@410655 13f79535-47bb-0310-9956-ffa450edef68

-        Thread rollbackThread = new Thread(this, "RollbackThread");
-        rollbackThread.start();
-
+            // force immediate rollback on error.
+            try {
+                rollback();
+            } catch (XAException e) {
+                /* ignore */
+            }
+
+        // start rollback thread in case the commit is never issued
+        new Thread(this, "RollbackThread").start();
