JCR-106: Minimize use of fields in lucene index

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@161425 13f79535-47bb-0310-9956-ffa450edef68

-     * The name of the reference property as multi value.
-     */
-    private final String refPropertyMV;
-
-    /**
-        String[] nameParts = refProperty.split(":");
-        this.refPropertyMV = nameParts[0] + ":" + FieldNames.MVP_PREFIX + nameParts[1];
-            // @todo implement properly
-            return 0;
+            return 1.0f;
-            // @todo implement properly
-            return 0;
+            return 1.0f;
-            // @todo implement properly
-        public void score(HitCollector hc) throws IOException {
-            calculateChildren();
-
-            int next = hits.nextSetBit(0);
-            while (next > -1) {
-                hc.collect(next, 1.0f);
-                // move to next doc
-                next = hits.nextSetBit(next + 1);
-            }
-        }
-
-        /**
-         * {@inheritDoc}
-         */
-            // todo implement
-                    String targetUUID = reader.document(i).get(refProperty);
-                    if (targetUUID != null) {
-                        uuids.add(targetUUID);
-                    }
-                    // also find multiple values
-                    String[] targetUUIDs = reader.document(i).getValues(refPropertyMV);
-                    if (targetUUIDs != null) {
-                        for (int j = 0; j < targetUUIDs.length; j++) {
-                            uuids.add(targetUUIDs[j]);
+                    String[] values = reader.document(i).getValues(FieldNames.PROPERTIES);
+                    String prefix = FieldNames.createNamedValue(refProperty, "");
+                    for (int v = 0; v < values.length; v++) {
+                        if (values[v].startsWith(prefix)) {
+                            uuids.add(values[v].substring(prefix.length()));
