JCR-2113 : WIP (Contribution by Alfusainey Jallow)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1640892 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.webdav.DavException;
+import org.apache.jackrabbit.webdav.DavServletResponse;
+import org.apache.jackrabbit.webdav.property.DavProperty;
+import org.w3c.dom.Element;
+import java.util.ArrayList;
+import java.util.Collection;
+    public SupportedPrivilegeSetProperty(DavProperty<?> p) throws DavException {
+        super(SecurityConstants.SUPPORTED_PRIVILEGE_SET, true);
+        if (!SecurityConstants.SUPPORTED_PRIVILEGE_SET.equals(getName())) {
+            throw new DavException(DavServletResponse.SC_BAD_REQUEST, "DAV:supported-privilege-set expected.");
+        }
+
+        List<SupportedPrivilege> supportedPrivs = new ArrayList<SupportedPrivilege>();
+        
+        for (Object obj : Collections.singletonList(p.getValue())) {
+            if (p instanceof Element) {
+                supportedPrivs.add(SupportedPrivilege.getSupportedPrivilege((Element) p));
+            } else if (obj instanceof Collection) {
+                for (Object entry : ((Collection<?>) obj)) {
+                    if (entry instanceof Element) {
+                        supportedPrivs.add(SupportedPrivilege.getSupportedPrivilege((Element) entry));
+                    }
+                }
+            }
+        }
+        supportedPrivileges = supportedPrivs.toArray(new SupportedPrivilege[supportedPrivs.size()]);
+    }
+
