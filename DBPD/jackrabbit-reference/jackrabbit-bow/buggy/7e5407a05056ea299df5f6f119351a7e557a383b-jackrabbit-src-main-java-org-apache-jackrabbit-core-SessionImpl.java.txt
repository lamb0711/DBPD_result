[JCR-317] replace UUID strings by UUID classes in NodeId, etc..

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@378221 13f79535-47bb-0310-9956-ffa450edef68

+import org.apache.jackrabbit.uuid.UUID;
-        return new SessionItemStateManager(rep.getRootNodeUUID(),
+        return new SessionItemStateManager(rep.getRootNodeId(),
-                ntMgr.getRootNodeDefinition(), rep.getRootNodeUUID());
+                ntMgr.getRootNodeDefinition(), rep.getRootNodeId());
-        
+
+        return getNodeByUUID(UUID.fromString(uuid));
+    }
+
+    /**
+     * {@inheritDoc}
+     */
+    public Node getNodeByUUID(UUID uuid) throws ItemNotFoundException, RepositoryException {
+        NodeImpl node = getNodeById(new NodeId(uuid));
+        if (node.isNodeType(QName.MIX_REFERENCEABLE)) {
+            return node;
+        } else {
+            // there is a node with that uuid but the node does not expose it
+            throw new ItemNotFoundException(uuid.toString());
+        }
+    }
+
+    /**
+     * {@inheritDoc}
+     */
+    public NodeImpl getNodeById(NodeId id) throws ItemNotFoundException, RepositoryException {
-            NodeImpl node = (NodeImpl) getItemManager().getItem(new NodeId(uuid));
-            if (node.isNodeType(QName.MIX_REFERENCEABLE)) {
-                return node;
-            } else {
-                // there is a node with that uuid but the node does not expose it
-                throw new ItemNotFoundException(uuid);
-            }
+            return (NodeImpl) getItemManager().getItem(id);
-            throw new ItemNotFoundException(uuid);
+            throw new ItemNotFoundException(id.toString());
-        String targetUUID = ((NodeState) targetNode.getItemState()).getUUID();
+        NodeId targetId = targetNode.getNodeId();
-            destParentNode.renameChildNode(srcName.getName(), index, targetUUID, destName.getName());
+            destParentNode.renameChildNode(srcName.getName(), index, targetId, destName.getName());
-            targetState.setParentUUID(destParentNode.internalGetUUID());
+            targetState.setParentId(destParentNode.getNodeId());
-            destParentState.addChildNodeEntry(destName.getName(), targetUUID);
+            destParentState.addChildNodeEntry(destName.getName(), targetId);
