JCR-1605 RepositoryLock does not work on NFS sometimes (configurable repository lock)

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@744956 13f79535-47bb-0310-9956-ffa450edef68

-public class RepositoryLock {
+public class RepositoryLock implements RepositoryLockMechanism {
-    private final File directory;
+    private File directory;
-    private final File file;
+    private File file;
-    private final String identifier;
+    private String identifier;
-     * The file lock. Used to ensure exlusive lockin across process boundaries.
+     * The file lock. Used to ensure exclusive locking across process boundaries.
+    public RepositoryLock() {
+        // used by the factory
+    }
+    
-     * Creates a lock instance for the given directory path. An instantiated
-     * lock still needs to be explicitly acquired using the {@link #acquire()}
-     * method.
-     *
+     * Create a new RepositoryLock object and initialize it.
+     * @deprecated 
+     * This constructor is deprecated; use the default constructor
+     * and {@link #init(String)} instead.
+     * 
+        init(path);
+    }
+    
+    /**
+     * Initialize the instance for the given directory path. The lock still needs to be 
+     * explicitly acquired using the {@link #acquire()} method.
+     *
+     * @param path directory path
+     * @throws RepositoryException if the canonical path of the directory
+     *                             can not be determined
+     */
+    public void init(String path) throws RepositoryException {
