JCR-1664: JNDI Referencable Issues

Avoid issues with the ordering of the JNDI configuration options by
including the entire Reference instance within BindableRepository.

Also, streamlined the JNDI classes a bit by using the AbstractRepository base class and the JackrabbitRepository interface, and by inlining many of the static methods that weren't being used outside the jndi package.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@681031 13f79535-47bb-0310-9956-ffa450edef68

+import javax.jcr.Repository;
+import javax.naming.Reference;
+import javax.naming.StringRefAddr;
+
+import org.apache.jackrabbit.api.JackrabbitRepository;
- * methods for binding and unbinding Jackarbbit repositories to and
+ * methods for binding and unbinding Jackrabbit repositories to and
+        Reference reference = new Reference(
+                Repository.class.getName(),
+                BindableRepositoryFactory.class.getName(),
+                null); // no classpath defined
+        reference.add(new StringRefAddr(
+                BindableRepository.CONFIGFILEPATH_ADDRTYPE, configFilePath));
+        reference.add(new StringRefAddr(
+                BindableRepository.REPHOMEDIR_ADDRTYPE, repHomeDir));
+
-        Object obj = BindableRepositoryFactory.createInstance(configFilePath, repHomeDir);
+        Object obj = new BindableRepositoryFactory().getObjectInstance(
+                reference, null, null, null);
-        ((BindableRepository) ctx.lookup(name)).shutdown();
+        ((JackrabbitRepository) ctx.lookup(name)).shutdown();
+
