JCR-2050: Optimize refresh operations

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@771280 13f79535-47bb-0310-9956-ffa450edef68

-import org.slf4j.Logger;
-import org.slf4j.LoggerFactory;
-import org.apache.jackrabbit.spi.Name;
-import org.apache.jackrabbit.spi.Path;
-import org.apache.jackrabbit.spi.ChildInfo;
-import org.apache.jackrabbit.spi.NodeId;
-import org.apache.jackrabbit.jcr2spi.state.Status;
-import org.apache.commons.collections.list.AbstractLinkedList;
-
-import javax.jcr.RepositoryException;
-import javax.jcr.ItemNotFoundException;
-import java.util.Iterator;
-import java.util.List;
-import java.util.NoSuchElementException;
-import java.util.ArrayList;
-import java.util.ConcurrentModificationException;
-import java.util.Map;
-import java.util.HashMap;
-import java.util.Collections;
+import java.util.ArrayList;
+import java.util.Collections;
+import java.util.ConcurrentModificationException;
+import java.util.HashMap;
+import java.util.Iterator;
+import java.util.List;
+import java.util.Map;
+import java.util.NoSuchElementException;
+
+import javax.jcr.ItemNotFoundException;
+import javax.jcr.RepositoryException;
+
+import org.apache.commons.collections.list.AbstractLinkedList;
+import org.apache.jackrabbit.jcr2spi.state.Status;
+import org.apache.jackrabbit.spi.ChildInfo;
+import org.apache.jackrabbit.spi.Name;
+import org.apache.jackrabbit.spi.NodeId;
+import org.apache.jackrabbit.spi.Path;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
-    private int status = STATUS_OK;
-        return (status == STATUS_OK && complete) ||
+        return (parent.getStatus() != Status.INVALIDATED && complete) ||
-     * @see ChildNodeEntries#invalidate()
-     */
-    public void invalidate() {
-        this.status = STATUS_INVALIDATED;
-    }
-
-    /**
-        status = STATUS_OK;
