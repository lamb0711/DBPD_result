JCR-2886 : Add SessionImpl#isAdminOrSystem

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@1072095 13f79535-47bb-0310-9956-ffa450edef68

-import org.apache.jackrabbit.core.security.principal.AdminPrincipal;
-import javax.security.auth.Subject;
-     * @param itemMgr {@link org.apache.jackrabbit.core.ItemManager} of the passed
-     *                <code>Session</code>.
+     * @param clusterNode
-     *                              or <code>itemMgr</code> is <code>null</code>.
+     *                              or <code>clusterNode</code> is <code>null</code>.
-        Subject subject = session.getSubject();
-        if (subject.getPrincipals(AdminPrincipal.class).isEmpty()) {
-            throw new RepositoryException("Only administrator session may " +
-                    "access EventJournal");
+        if (!session.isAdmin()) {
+            throw new RepositoryException("Only administrator session may access EventJournal");
