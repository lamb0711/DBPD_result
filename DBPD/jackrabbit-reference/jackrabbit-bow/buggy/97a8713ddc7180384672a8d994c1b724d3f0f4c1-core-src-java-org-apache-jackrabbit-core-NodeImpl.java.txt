Fixed JCR-155 and JCR-207


git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@279325 13f79535-47bb-0310-9956-ffa450edef68

+        if (isNew()) {
+            throw new LockException("Node not locked: " + safeGetJCRPath());
+        }
+
-        if (!isNodeType(MIX_LOCKABLE)) {
-            // a node that is not lockable never holds a lock
+        if (!isNodeType(MIX_LOCKABLE) || isNew()) {
+            // a node that is new or not lockable never holds a lock
+        if (isNew()) {
+            return false;
+        }
+
+        if (isNew()) {
+            // a new node must not be checked
+            return;
+        }
+
