- AccessManager: added method canAccess(String wspName) to check authorization for specific workspace

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@157086 13f79535-47bb-0310-9956-ffa450edef68

+import java.util.ArrayList;
-            // update operation failed, cancel all modifications
+                // update operation failed, cancel all modifications
+        // check authorization for specified workspace
+        if (!session.getAccessManager().canAccess(srcWorkspace)) {
+            throw new AccessDeniedException("not authorized to access " + srcWorkspace);
+        }
+
-        // aquire session on other workspace (throws NoSuchWorkspaceException)
+        // acquire session on other workspace (throws NoSuchWorkspaceException)
+        // check authorization for specified workspace
+        if (!session.getAccessManager().canAccess(srcWorkspace)) {
+            throw new AccessDeniedException("not authorized to access " + srcWorkspace);
+        }
+
-        // aquire session on other workspace (throws NoSuchWorkspaceException)
+        // acquire session on other workspace (throws NoSuchWorkspaceException)
+
-            // update operation failed, cancel all modifications
+                // update operation failed, cancel all modifications
-        // @todo filter workspaces according to access rights
-        return session.getWorkspaceNames();
+        // filter workspaces according to access rights
+        ArrayList list = new ArrayList();
+        String names[] = session.getWorkspaceNames();
+        for (int i = 0; i < names.length; i++) {
+            if (session.getAccessManager().canAccess(names[i])) {
+                list.add(names[i]);
+            }
+        }
+
+        return (String[]) list.toArray(new String[list.size()]);
-/*
+
-*/
-        throw new RepositoryException("not yet implemented");
