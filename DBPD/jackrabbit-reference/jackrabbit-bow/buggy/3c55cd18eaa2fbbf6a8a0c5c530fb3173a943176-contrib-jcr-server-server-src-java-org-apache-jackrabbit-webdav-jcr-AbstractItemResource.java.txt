[JCR-175] Contrib JCR-Server: enable PROPPATCH for simple-davresource
[JCR-174] Contrib JCR-Server: improve handing of strong etags

git-svn-id: https://svn.apache.org/repos/asf/incubator/jackrabbit/trunk@230679 13f79535-47bb-0310-9956-ffa450edef68

-        DavResourceLocator destPath = destination.getLocator();
-        if (!getLocator().isSameWorkspace(destPath)) {
+        DavResourceLocator destLocator = destination.getLocator();
+        if (!getLocator().isSameWorkspace(destLocator)) {
-        if (!(destination instanceof AbstractItemResource)) {
-            throw new DavException(DavServletResponse.SC_FORBIDDEN, "Cannot copy a resource that does not represent a repository item.");
-        }
-
-            AbstractItemResource destResource = (AbstractItemResource) destination;
-            String destResourcePath = destResource.getResourcePath();
-                workspace.copy(getResourcePath(), destResourcePath);
+                workspace.copy(getResourcePath(), destination.getResourcePath());
-                Workspace destWorkspace = destResource.getRepositorySession().getWorkspace();
-                destWorkspace.copy(workspace.getName(), getResourcePath(), destResourcePath);
+                log.error("Copy between workspaces is not yet implemented (src: '" + getHref() + "', dest: '" + destination.getHref() + "')");
+                throw new DavException(DavServletResponse.SC_NOT_IMPLEMENTED);
-                ExportViewReport.EXPORTVIEW_REPORT,
+                // add href-property for the items parent unless its the root item
+                if (item.getDepth() > 0) {
+                    String parentHref = getLocatorFromResourcePath(item.getParent().getPath()).getHref(true);
+                    properties.add(new HrefProperty(JCR_PARENT, parentHref, false));
+                }
+                // should not get here
-
+            
