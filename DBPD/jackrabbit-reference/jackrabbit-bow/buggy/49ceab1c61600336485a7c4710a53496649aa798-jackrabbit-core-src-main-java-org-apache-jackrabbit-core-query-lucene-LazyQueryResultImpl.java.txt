JCR-820: Add support for query result highlighting
- initial version

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@523251 13f79535-47bb-0310-9956-ffa450edef68

+     * The excerpt provider or <code>null</code> if none was created yet.
+     */
+    private ExcerptProvider excerptProvider;
+
+    /**
-        return new RowIteratorImpl(getNodeIterator(), selectProps, resolver);
+        if (excerptProvider == null) {
+            try {
+                excerptProvider = index.createExcerptProvider(query);
+            } catch (IOException e) {
+                throw new RepositoryException(e);
+            }
+        }
+        return new RowIteratorImpl(getNodeIterator(),
+                selectProps, resolver, excerptProvider);
