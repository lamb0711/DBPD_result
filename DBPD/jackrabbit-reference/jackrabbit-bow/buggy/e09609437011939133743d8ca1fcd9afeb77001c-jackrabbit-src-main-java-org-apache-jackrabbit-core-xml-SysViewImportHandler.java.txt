JCR-325: Applied the xml-refactoring.patch that puts the PropInfo instances in charge of applying the imported property values to content nodes.

git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@387961 13f79535-47bb-0310-9956-ffa450edef68

-    private AppendableValue currentPropValue;
+    private BufferedStringValue currentPropValue;
-        Importer.NodeInfo node = new Importer.NodeInfo();
-        node.setName(state.nodeName);
-        node.setNodeTypeName(state.nodeTypeName);
+        QName[] mixinNames = null;
-            QName[] mixins = (QName[]) state.mixinNames.toArray(new QName[state.mixinNames.size()]);
-            node.setMixinNames(mixins);
+            mixinNames = (QName[]) state.mixinNames.toArray(
+                    new QName[state.mixinNames.size()]);
+        NodeId id = null;
-            node.setId(NodeId.valueOf(state.uuid));
+            id = NodeId.valueOf(state.uuid);
+        NodeInfo node =
+            new NodeInfo(state.nodeName, state.nodeTypeName, mixinNames, id);
-                importer.startNode(node, state.props, nsContext);
+                importer.startNode(node, state.props);
-                    Importer.PropInfo pi = (Importer.PropInfo) iter.next();
-                    disposePropertyValues(pi);
+                    PropInfo pi = (PropInfo) iter.next();
+                    pi.dispose();
-            currentPropValue = new BufferedStringValue();
+            currentPropValue = new BufferedStringValue(nsContext);
-                AppendableValue val = (AppendableValue) currentPropValues.get(0);
+                BufferedStringValue val = (BufferedStringValue) currentPropValues.get(0);
-                    AppendableValue val =
-                            (AppendableValue) currentPropValues.get(i);
+                    BufferedStringValue val =
+                            (BufferedStringValue) currentPropValues.get(i);
-                AppendableValue val = (AppendableValue) currentPropValues.get(0);
+                BufferedStringValue val = (BufferedStringValue) currentPropValues.get(0);
-                Importer.PropInfo prop = new Importer.PropInfo();
-                prop.setName(currentPropName);
-                prop.setType(currentPropType);
-                prop.setValues((Importer.TextValue[])
-                        currentPropValues.toArray(new Importer.TextValue[currentPropValues.size()]));
+                PropInfo prop = new PropInfo(
+                        currentPropName, currentPropType,
+                        (TextValue[]) currentPropValues.toArray(
+                                new TextValue[currentPropValues.size()]));
