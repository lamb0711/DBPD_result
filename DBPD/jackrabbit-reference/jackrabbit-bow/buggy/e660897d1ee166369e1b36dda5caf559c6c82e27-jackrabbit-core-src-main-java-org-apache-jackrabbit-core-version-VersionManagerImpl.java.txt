JCR-1593 JSR 283: Simple versioning
JCR-2058 JSR 283: VersionManager and new versioning methods


git-svn-id: https://svn.apache.org/repos/asf/jackrabbit/trunk@765556 13f79535-47bb-0310-9956-ffa450edef68

-                String histUUID = node.getProperty(NameConstants.JCR_VERSIONHISTORY).getString();
-                return checkin((InternalVersionHistoryImpl)
-                        getVersionHistory(NodeId.valueOf(histUUID)), node);
+                InternalVersionHistory vh;
+                if (node.isNodeType(NameConstants.MIX_VERSIONABLE)) {
+                    // in full versioning, the history id can be retrieved via
+                    // the property
+                    String histUUID = node.getProperty(NameConstants.JCR_VERSIONHISTORY).getString();
+                    vh = getVersionHistory(NodeId.valueOf(histUUID));
+                    return checkin((InternalVersionHistoryImpl) vh, node, false);
+                } else {
+                    // in simple versioning the history id needs to be calculated
+                    vh = getVersionHistoryOfNode(node.getNodeId());
+                    return checkin((InternalVersionHistoryImpl) vh, node, true);
+                }
